commit adf791bd0c2829aa41a66b218617937d0e059e14
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Tue Jun 15 08:17:47 2004 -0700

    Linux 2.6.7

commit 0e662d3aa5a29ac3943e35652e8ed9dfff33cf20
Merge: d860a0a... f344ba4...
Author: David S. Miller <davem@kernel.bkbits.net>
Date:   Tue Jun 15 08:04:05 2004 -0700

    Merge davem@nuts.davemloft.net:/disk1/BK/sparc-2.6
    into kernel.bkbits.net:/home/davem/sparc-2.6

commit d860a0ad215965ab03fe497889fe2e1a4ede3765
Author: John Rose <johnrose@austin.ibm.com>
Date:   Tue Jun 15 06:19:55 2004 -0700

    [PATCH] insert_resource fix
    
    I noticed that insert_resource() incorrectly handles the case of an
    existing parent resource with the same ending address as a newly added
    child.  This results in incorrect nesting, like the following:
    
    	# cat /proc/ioports
    	<snip>
    	002f0000-002fffff : PCI Bus #48
    	  00200000-002fffff : /pci@800000020000003
    	</snip>
    
    Signed-off-by: John Rose <johnrose@austin.ibm.com>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit 46d73aed122fd0113437bf25c6231de7119717be
Author: Bartlomiej Zolnierkiewicz <b.zolnierkiewicz@elka.pw.edu.pl>
Date:   Tue Jun 15 06:19:44 2004 -0700

    [PATCH] ide: check no. of sectors for in/out commands in ide_diag_taskfile()
    
    Make sure that number of sectors != 0 for in/out command before sending
    it to drive.  Remove no longer needed checks from flagged_* PIO handlers.
    
    Signed-off-by: Bartlomiej Zolnierkiewicz <bzolnier@elka.pw.edu.pl>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit 18bf941f39dbf0362733a344dd06cbbac906c066
Author: Bartlomiej Zolnierkiewicz <b.zolnierkiewicz@elka.pw.edu.pl>
Date:   Tue Jun 15 06:19:32 2004 -0700

    [PATCH] ide: kill task_[un]map_rq()
    
    PIO handlers under CONFIG_IDE_TASKFILE_IO=n are never used for bio
    based requests (rq->bio is always NULL) so we can use rq->buffer
    directly instead of calling ide_[un]map_buffer().
    
    Signed-off-by: Bartlomiej Zolnierkiewicz <bzolnier@elka.pw.edu.pl>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit 559f1686ca516ed6e6c32334ae6c00cfc46c3bc6
Author: Bartlomiej Zolnierkiewicz <b.zolnierkiewicz@elka.pw.edu.pl>
Date:   Tue Jun 15 06:19:21 2004 -0700

    [PATCH] ide: tiny task_mulout_intr() (CONFIG_IDE_TASKFILE_IO=n) cleanup
    
    - merge status checking code for rq->current_nr_sectors
      and !rq->current_nr_sectors cases
    - remove !rq->bio check as it is always true
    
    Signed-off-by: Bartlomiej Zolnierkiewicz <bzolnier@elka.pw.edu.pl>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit 47d35d55094a468055faa58a97bafabd1550eee1
Author: Bartlomiej Zolnierkiewicz <b.zolnierkiewicz@elka.pw.edu.pl>
Date:   Tue Jun 15 06:19:10 2004 -0700

    [PATCH] ide: cleanup taskfile PIO handlers (CONFIG_IDE_TASKFILE_IO=n)
    
    These handlers are nowadays used only for REQ_DRIVE_TASKFILE
    requests (rq->bio is always NULL) which aren't retried et all so
    remove code 'rewinding' rq->current_nr_sectors and some FIXMEs.
    
    Signed-off-by: Bartlomiej Zolnierkiewicz <bzolnier@elka.pw.edu.pl>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit e4df35a014ffe5b764246c0d351727d9652e8931
Author: Bartlomiej Zolnierkiewicz <b.zolnierkiewicz@elka.pw.edu.pl>
Date:   Tue Jun 15 06:18:59 2004 -0700

    [PATCH] ide: fix REQ_DRIVE_* requests error handling in ide-scsi
    
    If REQ_DRIVE_* request fails ide_end_drive_cmd() should be called
    for it not ->end_request().  This was broken by 2.6.5, fix it.
    
    Signed-off-by: Bartlomiej Zolnierkiewicz <bzolnier@elka.pw.edu.pl>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit e3cff1620af2bf2b949a431441fce7c4c5f5be25
Author: Bartlomiej Zolnierkiewicz <b.zolnierkiewicz@elka.pw.edu.pl>
Date:   Tue Jun 15 06:18:48 2004 -0700

    [PATCH] ide: fix ide-cd to not retry REQ_DRIVE_TASKFILE requests
    
    'cat /proc/ide/hdx/identify' generates REQ_DRIVE_TASKFILE request
    (for WIN_PIDENTIFY command) even for devices controlled by ide-cd.
    All other drivers don't try to retry such requests.
    
    Acked by Jens.
    
    Signed-off-by: Bartlomiej Zolnierkiewicz <bzolnier@elka.pw.edu.pl>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit a161c036110a7b8d3bb7312f01e77054410fe7c0
Author: Bartlomiej Zolnierkiewicz <b.zolnierkiewicz@elka.pw.edu.pl>
Date:   Tue Jun 15 06:18:37 2004 -0700

    [PATCH] ide: remove ALTERNATE_STATE_DIAGRAM_MULTI_OUT from ide-taskfile.c
    
    First introduced in 2.4.19/2.5.3 as ALTSTAT_SCREW_UP, never used.
    
    Signed-off-by: Bartlomiej Zolnierkiewicz <bzolnier@elka.pw.edu.pl>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit e6f099503dd952c8ac99ee315ec3cedcff9280ae
Author: Bartlomiej Zolnierkiewicz <b.zolnierkiewicz@elka.pw.edu.pl>
Date:   Tue Jun 15 06:18:26 2004 -0700

    [PATCH] ide: ide-pnp update
    
    - do not unregister ide-pnp driver while detaching random
      IDE device from random IDE device driver if IDE is modular
      (somebody added this in 2.3.51)
    - clear 'hw_regs_t hw' allocated from stack
    - mark idepnp_init() with __init
    - use ide_std_init_ports() instead of ide_setup_ports()
    
    Signed-off-by: Bartlomiej Zolnierkiewicz <bzolnier@elka.pw.edu.pl>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit 39dff54f259b7cad01c0912fa32699b91081c8fa
Author: Bartlomiej Zolnierkiewicz <b.zolnierkiewicz@elka.pw.edu.pl>
Date:   Tue Jun 15 06:18:15 2004 -0700

    [PATCH] ide: ide-proc fix for m68k
    
    From: Geert Uytterhoeven <geert@linux-m68k.org>
    
    The IDE sparse fixups cause 2 warnings (unused variables `val' and
    `reg') on m68k and APUS.  However, the reason why this code was
    commented out is gone.  So just remove the special case.
    
    Signed-off-by: Bartlomiej Zolnierkiewicz <bzolnier@elka.pw.edu.pl>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit 8f969a52b1d1b869e25a56ba4204fd6f9b189fa5
Author: Bartlomiej Zolnierkiewicz <b.zolnierkiewicz@elka.pw.edu.pl>
Date:   Tue Jun 15 06:18:03 2004 -0700

    [PATCH] ide: kill some useless headers for PCI drivers
    
    They are only included from these drivers.
    
    While at it:
    - remove redundant ide_pci_device_t tables
    - add DECLARE_CS_DEV() (cs5520)
    - remove duplicate DISPLAY_SC1200_TIMINGS define (sc1200)
    - remove unused SIIMAGE_BUFFERED_TASKFILE, SII_DEBUG
      and siiprintk() defines + add DECLARE_SII_DEV() (siimage)
    - remove unused SLC90E66_DEBUG_DRIVE_INFO define (slc90e66)
    
    Signed-off-by: Bartlomiej Zolnierkiewicz <bzolnier@elka.pw.edu.pl>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit cdbe72683bfab3f52a44bae317a13d442b32f452
Author: Bartlomiej Zolnierkiewicz <b.zolnierkiewicz@elka.pw.edu.pl>
Date:   Tue Jun 15 06:17:51 2004 -0700

    [PATCH] ide: PCI hotplugging fixes
    
    Extracted from the Debian kernel package
    (original patch is from Herbert Xu).
    
    Signed-off-by: Bartlomiej Zolnierkiewicz <bzolnier@elka.pw.edu.pl>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit f344ba4994aac4c6789131f447b7892830cfdf6f
Author: David S. Miller <davem@nuts.davemloft.net>
Date:   Tue Jun 15 06:05:46 2004 -0700

    [SPARC]: Report si_addr in SIGINFO more accurately.

commit f5aa8cc60bfce5879c9559322731c6b61a35c060
Merge: 2f5bf69... b3dea13...
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Tue Jun 15 05:05:37 2004 -0700

    Merge http://linux-watchdog.bkbits.net/linux-2.6-watchdog
    into ppc970.osdl.org:/home/torvalds/v2.6/linux

commit 2f5bf694967abc8769d5d41f1200c6ab9a9a59c2
Merge: fc73143... e2fca85...
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Tue Jun 15 04:58:30 2004 -0700

    Merge bk://bk.arm.linux.org.uk/linux-2.6-serial
    into ppc970.osdl.org:/home/torvalds/v2.6/linux

commit e2fca8512d0841b8d93928c80f863a4da25794d3
Author: Russell King <rmk@flint.arm.linux.org.uk>
Date:   Tue Jun 15 19:54:59 2004 +0100

    [SERIAL] Fix missing __devexit_p
    
    Thanks to Ivan Kokshaysky for spotting this.

commit fc731434e3b64b69f36d5249402e93f932187c0b
Merge: a63a10f... 70efd5e...
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Tue Jun 15 04:55:48 2004 -0700

    Merge bk://bk.arm.linux.org.uk/linux-2.6-pcmcia
    into ppc970.osdl.org:/home/torvalds/v2.6/linux

commit 70efd5e43ce002e213cf2541bac051473d045f3f
Author: Russell King <rmk@flint.arm.linux.org.uk>
Date:   Tue Jun 15 17:10:47 2004 +0100

    [PCMCIA] Add TI1620 device IDs and tell yenta about it.

commit a63a10fe155fa77569dabb2b88804528137929da
Merge: 71279d2... 81a50e4...
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Tue Jun 15 04:49:34 2004 -0700

    Merge bk://cifs.bkbits.net/linux-2.5cifs
    into ppc970.osdl.org:/home/torvalds/v2.6/linux

commit 81a50e442b27a4b230227f73d2de86df4b30dfe7
Merge: 50df063... d31ea43...
Author: Steve French <stevef@stevef95.austin.ibm.com>
Date:   Tue Jun 15 05:42:31 2004 -0500

    Merge bk://cifs.bkbits.net/linux-2.5cifs
    into stevef95.austin.ibm.com:/home/stevef/linux-2.5cifs

commit d31ea4355a01b884f82d624e97cd5f34636e9ded
Author: Steve French <stevef@stevef95.austin.ibm.com>
Date:   Tue Jun 15 04:53:23 2004 -0500

    Fix i_size corruption in case of overlapped readdir changing cached file size and local cached write extending file

commit 71279d2bf78ec4f7026531e85b36c1d3d7fcb4c2
Author: Andi Kleen <ak@suse.de>
Date:   Mon Jun 14 18:01:58 2004 -0700

    [PATCH] x86-64: Fix use of uninitialized memory in ioremap
    
    From: "Siddha, Suresh B" <suresh.b.siddha@intel.com>
    From: "Kamble, Nitin A" <nitin.a.kamble@intel.com>
    
    Fix use of uninitialized memory in x86-64 ioremap
    
    This caused BUGs at bootup for some people.

commit 50df063c42bcd5c515514adfd40622d9269d924c
Author: Steve French <stevef@smfhome.smfdom>
Date:   Mon Jun 14 12:08:09 2004 -0500

    fix fealist struct (xattr support part 3)
    
    Signed-off-by: Steve French (sfrench@us.ibm.com)

commit b8622ab60f3d9d0551aefe50b95c7578e8ed90f8
Author: Chris Wright <chrisw@osdl.org>
Date:   Mon Jun 14 09:04:02 2004 -0700

    [PATCH] __user annotation for selinux_shm_shmat
    
    Add proper __user annotation to selinux_shm_shmat.
    
    From: Mika Kukkonen <mika@osdl.org>
    Signed-off-by: Chris Wright <chrisw@osdl.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit eb0c66a53df8454ff685b1f3662c6385e609a06a
Author: Chris Wright <chrisw@osdl.org>
Date:   Mon Jun 14 09:03:51 2004 -0700

    [PATCH] __user annotation for dummy_shm_shmat
    
    Add proper __user annotation to dummy_shm_shmat.
    
    Signed-off-by: Chris Wright <chrisw@osdl.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit 20f284b9b64cd23b3e9e1e045797887b197231f4
Author: Chris Wright <chrisw@osdl.org>
Date:   Mon Jun 14 09:03:40 2004 -0700

    [PATCH] __user annotation for shm_shmat hook declaration
    
    Add proper __user annotation for shm_shmat hook in security.h.
    
    From: Mika Kukkonen <mika@osdl.org>
    Signed-off-by: Chris Wright <chrisw@osdl.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit 5b2785a167df52499abd52accdcb3a4c9d74451c
Author: Chris Wedgwood <cw@f00f.org>
Date:   Mon Jun 14 09:01:29 2004 -0700

    [PATCH] stat nlink resolution fix
    
    Some filesystems can get overflows when their link-count exceeds
    65534.  This patch increases the kernels internal resolution for this
    and also has a check for the old-system call paths to return and error
    (-EOVERFLOW) as required (as suggested by Al Viro).
    
    Signed-off-by: Chris Wedgwood <cw@f00f.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit 2f3600ceb38a78a9d7c050ab5250d378f7490c56
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Mon Jun 14 08:33:16 2004 -0700

    Revert wakeup-affinity fixes
    
    This patch results in too much idle time under certain
    loads, and while that is being looked into we're better
    off just reverting the change.
    
    Cset exclude: nickpiggin@yahoo.com.au[torvalds]|ChangeSet|20040605175839|02419

commit 98a394311bc43a4e1ede4c8920cf8ffdfab4033f
Merge: 3b89d48... 158cb90...
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Mon Jun 14 08:29:37 2004 -0700

    Merge bk://kernel.bkbits.net/davem/net-2.6
    into ppc970.osdl.org:/home/torvalds/v2.6/linux

commit 3b89d48658555dc3ebfe7d7af0a25f0b3e0a19f1
Merge: 864cb43... 292670c...
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Mon Jun 14 08:28:00 2004 -0700

    Merge bk://kernel.bkbits.net/davem/sparc-2.6
    into ppc970.osdl.org:/home/torvalds/v2.6/linux

commit 864cb43e38bfaff2c36485bbee8b14360aa429bd
Merge: 89a9555... dca8ede...
Author: David S. Miller <davem@kernel.bkbits.net>
Date:   Mon Jun 14 04:00:40 2004 -0700

    Merge davem@nuts.davemloft.net:/disk1/BK/sparc-2.6
    into kernel.bkbits.net:/home/davem/sparc-2.6

commit 158cb909d603304add502d835ee7113d8335f787
Author: Harald Welte <laforge@netfilter.org>
Date:   Mon Jun 14 03:30:31 2004 -0700

    [NETFILTER]: Prevent orphan expectations.
    
    This patch fixes orphaned expectations, which can occur when helpers create
    expectations for unconfirmed conntracks and the packet is dropped before
    the conntrack is confirmed.
    
    Signed-off-by: Phil Oester <kernel@linuxace.com>
    Signed-off-by: Harald Welte <laforge@netfilter.org>
    Signed-off-by: David S. Miller <davem@redhat.com>

commit 9a8d198e1416774cb3ec3270fc0694df64fdee44
Author: Harald Welte <laforge@netfilter.org>
Date:   Mon Jun 14 03:28:58 2004 -0700

    [NETFILTER]: Don't assign new helper after NAT when there are already expectations present.
    
    Tracked down by Raivis Bucis <raivis@mt.lv>
    
    This patch fixes an oops while listing /proc/net/ip_conntrack.
    
    When a helper sets up expectations based on the first packet (tftp),
    NAT can still change the packet and cause conntrack to look for a new helper
    based on the new tuple. When no helper is found, expectant->helper will be
    NULL, which leads to an oops in print_expect().
    
    Only assign a new helper in ip_conntrack_alter_reply() if there are no
    expectations.
    
    Signed-off-by: Patrick McHardy <kaber@trash.net>
    Signed-off-by: Harald Welte <laforge@netfilter.org>
    Signed-off-by: David S. Miller <davem@redhat.com>

commit b8138a9e0c41865df56b4870817d36ca99dba4b1
Author: Harald Welte <laforge@netfilter.org>
Date:   Mon Jun 14 03:25:21 2004 -0700

    [NETFILTER]: Missing skb->len check in ip_conntrack_proto_tcp.c:tcp_packet().
    
    Signed-off-by: Patrick McHardy <kaber@trash.net>
    Signed-off-by: Harald Welte <laforge@netfilter.org>
    Signed-off-by: David S. Miller <davem@redhat.com>

commit d56159f6e8c80cf6d5a178a8a3a721a384e34453
Author: Hideaki Yoshifuji <yoshfuji@linux-ipv6.org>
Date:   Mon Jun 14 03:09:47 2004 -0700

    [IPV6] IPSEC: fix double kfree_skb() in error path. (reported by Ken-ichirou MATSUZAWA <chamas@h4.dion.ne.jp>)
    
    Signed-off-by: Yoshifuji Hideaki <yoshfuji@linux-ipv6.org>
    Signed-off-by: David S. Miller <davem@redhat.com>

commit 292670c74b48c4bc7749c9944462da570074c0cf
Merge: 6acd292... ca36f40...
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Mon Jun 14 02:21:46 2004 -0700

    Merge bk://bk.arm.linux.org.uk/linux-2.6-rmk
    into ppc970.osdl.org:/home/torvalds/v2.6/linux

commit ca36f40d0b5aa2fdae6128236c13635bc1ed1066
Author: Russell King <rmk@flint.arm.linux.org.uk>
Date:   Tue Jun 15 02:06:07 2004 +0100

    [ARM] Resurect EBSA110 machine class.
    
    This fixes build errors in EBSA110, and updates the default
    configuration.

commit 6acd292f96a82796a6313f1d5a26ca0e0f851809
Merge: b982274... 9b3747c...
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Sun Jun 13 23:22:09 2004 -0700

    Merge bk://linux-dj.bkbits.net/cpufreq
    into ppc970.osdl.org:/home/torvalds/v2.6/linux

commit 9b3747c70a080dae2c3fc5337d7ca4ae732e7b91
Merge: d56e8b5... fff4f98...
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Sun Jun 13 23:17:58 2004 -0700

    Merge http://jfs.bkbits.net/linux-2.5
    into ppc970.osdl.org:/home/torvalds/v2.6/linux

commit d56e8b5c5800c95d4281e90f93a67aba5fc6ee1b
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Jun 13 23:16:49 2004 -0700

    [PATCH] ppc64: fix out_be64
    
    From: Benjamin Herrenschmidt <benh@kernel.crashing.org>
    
    Patch fixes out_be64 implementation on ppc64 along with a glich in out_be32
    (inconsistent) use of barrier.
    
    Signed-off-by: Roland Dreier <roland@topspin.com>
    Signed-off-by: Benjamin Herrenschmidt <benh@kernel.crashing.org>
    Signed-off-by: Andrew Morton <akpm@osdl.org>

commit 1dadd0fcef678c7d3df2eaadf112a3d8d2b30132
Author: Randy Dunlap <rddunlap@osdl.org>
Date:   Sun Jun 13 23:16:38 2004 -0700

    [PATCH] Sparse fix to mm/vmscan.c
    
    Nick changed shrink_cache() to void, but one call was missed.
    
    From: Mika Kukkonen <mika@osdl.org>
    Signed-off-by: Randy Dunlap <rddunlap@osdl.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit 5241cac5c1d66b32652fbdc412115b27f6b95e0f
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Jun 13 23:16:27 2004 -0700

    [PATCH] Fix nfs writepage behaviour
    
    From: Nick Piggin <nickpiggin@yahoo.com.au>
    
    nfs_writepage() refuses to write back mapped pages at all on the page
    reclaim path, causing systems to get locked up when there's a lot of dirty
    mmapped data around.  The patch changes NFS so that it will start I/O
    against these pages.
    
    The code as it stands is designed to defer writeout to pdflush which can do
    larger, more efficient I/Os.  But there shouldn't be much traffic by this
    path, and going slow is better than not going at all.
    
    Patch originally from Trond.
    
    Signed-off-by: Trond Myklebust <trond.myklebust@fys.uio.no>
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit dca8ede41e938a013f2a6f9e31861af49af5aa7b
Author: Andi Kleen <ak@suse.de>
Date:   Sun Jun 13 23:06:51 2004 -0700

    [PATCH] Fix x86-64 VIA systems with IOMMU debug
    
    VIA chipsets are broken and don't work with IOMMU enabled. For some mysterious
    reason (the IOMMU logic is actually in the CPU) they manage to corrupt all
    data going through the aperture to PCI devices.
    
    There was a workaround previously that enabled the slower softmmu when VIA is
    detected on the normal IOMMU path (when there is more than 3GB of memory). But
    CONFIG_IOMMU_DEBUG took a short cut that was not handled, which ended up with
    VIA systems not booting when this option is enabled.
    
    This patch enables the workaround with CONFIG_IOMMU_DEBUG/iommu=force too

commit c902e4cd3abe4f7cd1a1acf6418fcfa8e175615b
Merge: efe00e6... 6d1bb7f...
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Sun Jun 13 23:04:26 2004 -0700

    Merge bk://kernel.bkbits.net/davem/tg3-2.6
    into ppc970.osdl.org:/home/torvalds/v2.6/linux

commit 6f0601899d8a48bc9c37e98d77e67b0ded79d7f4
Merge: efe00e6... 05a46cc...
Author: Steve French <cifs.adm@hostme.bitkeeper.com>
Date:   Sun Jun 13 20:17:12 2004 -0700

    Merge bk://linux.bkbits.net/linux-2.5
    into hostme.bitkeeper.com:/repos/c/cifs/linux-2.5cifs

commit b982274d97de87688c1da6deef480fa2cef20c1c
Merge: ea59d34... 1a9325f...
Author: Dave Jones <davej@delerium.codemonkey.org.uk>
Date:   Mon Jun 14 00:12:36 2004 +0100

    Merge delerium.codemonkey.org.uk:/mnt/data/src/bk/bk-linus
    into delerium.codemonkey.org.uk:/mnt/data/src/bk/cpufreq

commit 05a46cc882e5c013145d6e906c545772e5699738
Author: Steve French <stevef@smfhome1.smfdom>
Date:   Sun Jun 13 15:07:58 2004 -0500

    fix listxattr error path
    
    Signed-off-by: Steve French (sfrench@us.ibm.com)

commit c1f8b62904237884b1960cdeaced2b4c15d8fb88
Author: Steve French <stevef@smfhome1.smfdom>
Date:   Sun Jun 13 15:04:43 2004 -0500

    do not filemap_fdatawrite when reconnecting in write to avoid potential deadlock
    
    Signed-off-by: Steve French (sfrench@us.ibm.com)

commit e70aaeb1b55b2db4a3b746d636292b3f240e22e4
Author: Steve French <stevef@smfhome.smfdom>
Date:   Sun Jun 13 11:10:19 2004 -0500

    lock session when reconnecting so we do not oops in retrying sendmsg
    
    Signed-off-by: Steve French (sfrench@us.ibm.com)

commit efe00e6a270ac56f4f08d68ee1c37a7940683420
Merge: ea59d34... f23ac28...
Author: Linus Torvalds <torvalds@evo.osdl.org>
Date:   Sun Jun 13 03:07:49 2004 -0700

    Merge bk://bk.linux1394.org/ieee1394-2.6
    into evo.osdl.org:/home/torvalds/v2.6/linux

commit f23ac28cce00cf88bcf3294668ff4eba1a5c0fae
Author: Ben Collins <bcollins@debian.org>
Date:   Sun Jun 13 07:07:40 2004 -0400

    ohci1394: Fix incorrect HPSB_WARNING to HPSB_ERR
    
    Signed-off-by: Ben Collins <bcollins@debian.org>

commit bbf1aca994ed238793851ac60388fcff3ee3f080
Author: Ben Collins <bcollins@debian.org>
Date:   Sun Jun 13 02:22:13 2004 -0400

    ieee1394: Revision sync
    
    Signed-off-by: Ben Collins <bcollins@debian.org>

commit 39af034538e5007a87e6690dab3216953fdd1170
Author: Ben Collins <bcollins@debian.org>
Date:   Sun Jun 13 02:18:14 2004 -0400

    ohci1394: Handle invalid max-packet-size.
    
    Signed-off-by: Ben Collins <bcollins@debian.org>

commit 83b06d6014a869573bd511fb35751b7b24cbf84a
Author: Ben Collins <bcollins@debian.org>
Date:   Sun Jun 13 02:16:14 2004 -0400

    ieee1394: Handle swsusp better in kernel threads.
    
    Submitted-by: Pavel Machek <pavel@ucw.cz>
    Signed-off-by: Ben Collins <bcollins@debian.org>

commit 128b3af41ae1e757820fcf80856d96ee7396a5a2
Author: Ben Collins <bcollins@debian.org>
Date:   Sun Jun 13 02:13:46 2004 -0400

    ieee1394: Fix possible NULL ptr dereference with calls to find_ctx()
    
    Submitted-by: Hiromasa YOSHIMOTO <yosimoto@limu.is.kyushu-u.ac.jp>
    Signed-off-by: Ben Collins <bcollins@debian.org>

commit 26a3e565e6aa064d53afa1925769c1ac1895cab2
Author: Ben Collins <bcollins@debian.org>
Date:   Sun Jun 13 02:11:37 2004 -0400

    ieee1394: CSR1212 Extended ROM bug fixes
    
      - Use vmalloc instead of kmalloc
      - Change delayed_reset_bus() to operate in a work_queue instead of a timer
        interrupt.
      - Fix hpsb_allocate_and_register_addrspace() to not allocate space on top
        of already allocated space.
      - Fix problems in csr1212.c filling ConfigROM images when extend ROMs are
        present.
    
    Signed-off-by: Steve Kinneberg <kberg@linux1394.org>
    Signed-off-by: Ben Collins <bcollins@debian.org>

commit 89a955508dee596ed236d716056d544bc99a1974
Merge: 6e04296... ea59d34...
Author: David S. Miller <davem@nuts.davemloft.net>
Date:   Sat Jun 12 21:15:00 2004 -0700

    Merge nuts.davemloft.net:/disk1/BK/sparcwork-2.6
    into nuts.davemloft.net:/disk1/BK/sparc-2.6

commit ea59d34d21dd793a2500c61834c17fe89afe12bf
Author: Benjamin Herrenschmidt <benh@kernel.crashing.org>
Date:   Sat Jun 12 19:10:34 2004 -0700

    [PATCH] ppc64: Add definition for Apple Xserve G5 motherboard
    
    This adds the definition for Apple XServe G5 motherboard to the
    pmac_feature support file.

commit fa469929d0e225cecd58f4e366f1f3f006223a8e
Merge: 992d6a3... bbf1aca...
Author: Linus Torvalds <torvalds@evo.osdl.org>
Date:   Sat Jun 12 18:58:35 2004 -0700

    Merge bk://bk.linux1394.org/ieee1394-2.6
    into evo.osdl.org:/home/torvalds/v2.6/linux

commit b3dea13aa93a358c15543b303ff7beb7163e0e53
Author: Wim Van Sebroeck <wim@iguana.be>
Date:   Sun Jun 13 02:49:41 2004 +0200

    [WATCHDOG] pcwd_usb.c-single_open+set_heartbeat+init-patch
    
    - /dev/watchdog is single open only: make sure that the bit that
    prevents a second open is cleared as the last instruction of the
    release code
    - Change the way we set the original heartbeat code
    - Make sure that /dev/temperature get's registered before /dev/watchdog

commit 71eba4abe1f9a01dc475d949bea2e080e572eed3
Author: Wim Van Sebroeck <wim@iguana.be>
Date:   Sun Jun 13 02:44:36 2004 +0200

    [WATCHDOG] pcwd_pci.c-single_open+set_heartbeat+init-patch
    
    - /dev/watchdog is single open only: make sure that the bit that
    prevents a second open is cleared as the last instruction of the
    release code
    - Change the way we set the original heartbeat
    - Make sure that /dev/temperature get's registered before /dev/watchdog

commit a943a2b2db4743ca19946ac883d20b4d30b562fd
Author: Wim Van Sebroeck <wim@iguana.be>
Date:   Sun Jun 13 02:37:11 2004 +0200

    [WATCHDOG] v2.6.6 pcwd.c-keepalive+single_open-patch
    
    - Make pcwd_keepalive return 0 on success.
    - /dev/watchdog is single open only: make sure that the atomic that
    prevents a second open is cleared only as the last instruction of the
    release code.

commit 992d6a321b721d76547633e920844020ef72278a
Merge: bd8f391... 0daefd1...
Author: Linus Torvalds <torvalds@evo.osdl.org>
Date:   Sat Jun 12 17:11:26 2004 -0700

    Merge bk://kernel.bkbits.net/davem/net-2.6
    into evo.osdl.org:/home/torvalds/v2.6/linux

commit bd8f39173522712582cdac6eb48b0bc71b43c28c
Merge: 2437333... 1b66a76...
Author: Linus Torvalds <torvalds@evo.osdl.org>
Date:   Sat Jun 12 16:59:39 2004 -0700

    Merge bk://gkernel.bkbits.net/net-drivers-2.6
    into evo.osdl.org:/home/torvalds/v2.6/linux

commit 1b66a76f174f40b6d8aac9fa95f498fc053c561d
Merge: 56d1317... 1b26d7a...
Author: Linus Torvalds <torvalds@evo.osdl.org>
Date:   Sat Jun 12 16:57:45 2004 -0700

    Merge bk://bk.arm.linux.org.uk/linux-2.6-rmk
    into evo.osdl.org:/home/torvalds/v2.6/linux

commit 56d1317d8467d7f5cfc30955faf98161ae521d18
Author: Kenneth W. Chen <kenneth.w.chen@intel.com>
Date:   Sat Jun 12 16:49:20 2004 -0700

    [PATCH] ia64: fix race in fsys_bubble_down to avoid fp-register corruption
    
    The fast system-call fall-back-path has a race: it reads PSR, modifies
    some bits, then writes back the new PSR.  Unfortunately, the contents
    of PSR may change between reading and writing it.  For example, an
    interrupt could occur which could trigger a context-switch.  The
    context-switch might in turn flush the floating-point-high (FPH)
    partition to memory, clear PSR.MFH, and set PSR.DFH.  To prevent this
    race, the patch below turns off PSR.I before reading PSR.
    
    This fixes a floating-point corruption problem that was observed on a
    system with a libc which has the fast system-call support enabled.
    
    The performance impact is minimal (on the order of a handful of cycles).
    
    Signed-off-by: Kevin Tian <kevin.tian@intel.com>
    Signed-off-by: Ken Chen <kenneth.w.chen@intel.com>
    Signed-off-by: Asit Mallick <asit.k.mallick@intel.com>
    Signed-off-by: David Mosberger <davidm@hpl.hp.com>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit d1da42b42a0c683b6595905885a28de36c2e184e
Author: Andrew Morton <akpm@osdl.org>
Date:   Sat Jun 12 16:45:58 2004 -0700

    [PATCH] ramdisk: buffer_uptodate fix
    
    I waffled over this for ages.  On balance, I think it's best to mark those
    bh's as uptodate.
    
    And on reflection, I'm not sure why we go bringing ramdisk blockdev pages
    uptodate all over the place anyway.  But ramdisk is weird and it passes
    testing.  Let those dogs sleep.
    
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit 39ecf09b9565b074ad14499a2c91285835c6292f
Author: Andrew Morton <akpm@osdl.org>
Date:   Sat Jun 12 16:45:44 2004 -0700

    [PATCH] sparse fix for void return in selinux/hooks.c
    
    From: Chris Wright <chrisw@osdl.org>
    
      CHECK   security/selinux/hooks.c
    security/selinux/hooks.c:1383:34: warning: return expression in void function
    security/selinux/hooks.c:3548:30: warning: return expression in void function
      CC      security/selinux/hooks.o
    
    From: Mika Kukkonen <mika@osdl.org>
    Signed-off-by: Chris Wright <chrisw@osdl.org>
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit d0d0061c24e49ba3f90efc281b4c28d5515795d0
Author: Andrew Morton <akpm@osdl.org>
Date:   Sat Jun 12 16:45:29 2004 -0700

    [PATCH] s390: tape driver changes
    
    From: Martin Schwidefsky <schwidefsky@de.ibm.com>
    
    From: Stefan Bader <shbader@de.ibm.com>
    
    tape driver changes:
     - Create seperate debug areas for core and discipline modules.
    
    Signed-off-by: Martin Schwidefsky <schwidefsky@de.ibm.com>
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit 70553da90758e62229190bc49cc30a0cd03252ed
Author: Andrew Morton <akpm@osdl.org>
Date:   Sat Jun 12 16:45:15 2004 -0700

    [PATCH] s390: qeth network driver
    
    From: Martin Schwidefsky <schwidefsky@de.ibm.com>
    
    From: Frank Pavlic <pavlic@de.ibm.com>
    From: Thomas Spatzier <tspat@de.ibm.com>
    
    qeth network driver changes:
     - Use correct request length in arp/snmp requests.
     - Simplify handling of empty vs. primed buffers.
    
    Signed-off-by: Martin Schwidefsky <schwidefsky@de.ibm.com>
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit 55de14a7463b58469031bc3ff50828d848b4bc78
Author: Andrew Morton <akpm@osdl.org>
Date:   Sat Jun 12 16:45:01 2004 -0700

    [PATCH] s390: xpram device driver
    
    From: Martin Schwidefsky <schwidefsky@de.ibm.com>
    
    xpram device driver changes:
     - Allocate request queue with blk_alloc_queue.
    
    Signed-off-by: Martin Schwidefsky <schwidefsky@de.ibm.com>
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit 67574175683ee3a924f538e4b97373368b45ec12
Author: Andrew Morton <akpm@osdl.org>
Date:   Sat Jun 12 16:44:47 2004 -0700

    [PATCH] s390: common i/o layer
    
    From: Martin Schwidefsky <schwidefsky@de.ibm.com>
    
    From: Cornelia Huck <cohuck@de.ibm.com>
    
    Common i/o layer changes:
     - Remove bogus defines.
     - Fix length of strncmp on bus id.
    
    Signed-off-by: Martin Schwidefsky <schwidefsky@de.ibm.com>
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit d844492603a335329ff041dd0e376687b52c7a28
Author: Andrew Morton <akpm@osdl.org>
Date:   Sat Jun 12 16:44:32 2004 -0700

    [PATCH] s390: cleanup string functions
    
    From: Martin Schwidefsky <schwidefsky@de.ibm.com>
    
    Cleanup s390* string functions.  This replaces the 31/64 bit assembler
    files (strcmp[64].S, strcpy[64].S & strncpy[64].S) with a single string.c
    file that uses some inline assemblies to issue the string instructions.  In
    addition some more of the generic string function got an architecture
    dependent implementation.
    
    Signed-off-by: Martin Schwidefsky <schwidefsky@de.ibm.com>
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit 1f51543491b08e2187fefe4a07f1829a9b1d5247
Author: Andrew Morton <akpm@osdl.org>
Date:   Sat Jun 12 16:44:00 2004 -0700

    [PATCH] s390: simplify single stepped svc code
    
    From: Martin Schwidefsky <schwidefsky@de.ibm.com>
    
    From: Martin Schwidefsky <schwidefsky@de.ibm.com>
    
    Introduce a TIF_SINGLE_STEP bit that causes do_debugger_trap to get called
    at the end of a system call.  This way some code duplication in the program
    check handler can get removed.
    
    Signed-off-by: Martin Schwidefsky <schwidefsky@de.ibm.com>
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit d815049106528797f66a6097cff29b724b4bcb3d
Author: Andrew Morton <akpm@osdl.org>
Date:   Sat Jun 12 16:43:46 2004 -0700

    [PATCH] s390: speedup strn{cpy,len}_from_user.
    
    From: Martin Schwidefsky <schwidefsky@de.ibm.com>
    
    From: Martin Schwidefsky <schwidefsky@de.ibm.com>
    
    Speedup strncpy_from_user and strnlen_from_user by using the search string
    instruction in the secondary space mode.
    
    Signed-off-by: Martin Schwidefsky <schwidefsky@de.ibm.com>
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit 94a091cff347c619190d4ef30dcaad479a2fc783
Author: Andrew Morton <akpm@osdl.org>
Date:   Sat Jun 12 16:43:29 2004 -0700

    [PATCH] s390: improve memory detection logic
    
    From: Martin Schwidefsky <schwidefsky@de.ibm.com>
    
    From: Guillaume Morin <guillaume@morinfr.org>
    
    This patch improves the memory detection logic.  It detects any amount of
    holes in the memory layout up to MEMORY_CHUNK blocks of available memory.
    
    Signed-off-by: Martin Schwidefsky <schwidefsky@de.ibm.com>
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit 564252a2c10ebbc97d6fdbeaac665305e2f66d1a
Author: Andrew Morton <akpm@osdl.org>
Date:   Sat Jun 12 16:43:15 2004 -0700

    [PATCH] sparse: __user annotations for s390 drivers
    
    From: Arnd Bergmann <arnd@arndb.de>
    
    This should catch almost all s390 device drivers
    
    Signed-off-by: Arnd Bergmann <arnd@arndb.de>
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit 37dbd1af5a6a9f36982e92c9a8b48e059e2d086e
Author: Andrew Morton <akpm@osdl.org>
Date:   Sat Jun 12 16:42:57 2004 -0700

    [PATCH] sparse: user annotations for s390 architecture
    
    From: Arnd Bergmann <arnd@arndb.de>
    
    Lots of trivial changes to make sparse happy on s390 arch code, mostly
    __user annotations.
    
    Signed-off-by: Arnd Bergmann <arnd@arndb.de>
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit d4cdd4876500ee3095bc6795bc72c5c9d498d727
Author: Andrew Morton <akpm@osdl.org>
Date:   Sat Jun 12 16:42:42 2004 -0700

    [PATCH] i4l: Tigerjet 320 chipset fix
    
    From: Karsten Keil <kkeil@suse.de>
    
    Solves a endless IRQ loop for Tigerjet 320 based ISDN cards.
    
    Signed-off-by: Karsten Keil <kkeil@suse.de>
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit 1971e72b069bbe722fd0e396ef974929293ef6d0
Author: Andrew Morton <akpm@osdl.org>
Date:   Sat Jun 12 16:42:28 2004 -0700

    [PATCH] ncpfs MAINTAINERS update
    
    From: Jorn Engel <joern@wohnheim.fh-wedel.de>
    
    Remove Volker as an NCP maintainer, he hasn't touched it in about 7 or
    8 years, according to himself.  Volker has acked this change.
    
    Signed-off-by: JÃ¶rn Engel <joern@wohnheim.fh-wedel.de>
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit 92b65511861887687acc9137cb7ebbdba4493175
Author: Andrew Morton <akpm@osdl.org>
Date:   Sat Jun 12 16:42:15 2004 -0700

    [PATCH] dup_mmap() memory accounting fix
    
    From: Hugh Dickins <hugh@veritas.com>
    
    Oleg's patch was good in that exit_mmap usually does the un-accounting; but
    dup_mmap still needs its own un-accounting for the case when it has charged
    for a vma, but error before it's inserted into child mm's list.
    
    Signed-off-by: Hugh Dickins <hugh@veritas.com>
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit 0d39f73b023650abfbda99a5ff17e309c7d522e7
Author: Andrew Morton <akpm@osdl.org>
Date:   Sat Jun 12 16:42:00 2004 -0700

    [PATCH] spoll_create size check
    
    From: Davide Libenzi <davidel@xmailserver.org>
    
    This is a sanity check on the size parameter.  Nothing explodes w/out, but
    the conversion to unsigned simply triggers a big allocation.
    
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit efa7ca06476c7ec41712ddb46d39d7b38deae5c6
Author: Andrew Morton <akpm@osdl.org>
Date:   Sat Jun 12 16:41:45 2004 -0700

    [PATCH] fix the exit-vs-timer race fix
    
    As Roland McGrath <roland@redhat.com> points out, we need to zero
    task->it_virt_value to prevent timer-based signal delivery, not
    ->it_virt_incr.
    
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit 9566ad6513cd968273b8d45d38f40f544da4d224
Author: Andrew Morton <akpm@osdl.org>
Date:   Sat Jun 12 16:41:31 2004 -0700

    [PATCH] es7000plat.c warning fix
    
    Lack of argument decls causes this warning:
    
    arch/i386/mach-generic/../mach-es7000/es7000plat.c:53: warning: function declaration isn't a prototype
    
    Let's stick the extern declaration in a header, which is where they always
    should be.
    
    Cc: "Brown, Len" <len.brown@intel.com>
    Cc: "Protasevich, Natalie" <Natalie.Protasevich@UNISYS.com>
    
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit 942f5de49374d5470074d8e6c2dd86e02a7a12f1
Author: Andrew Morton <akpm@osdl.org>
Date:   Sat Jun 12 16:41:17 2004 -0700

    [PATCH] fix modprobe_path and hotplug_path sizes and sysctl
    
    From: Andy Whitcroft <apw@shadowen.org>
    
    Both modprobe_path and hotplug_path are arbitrarily sized at 256 bytes and
    that size is also expressed directly in the sysctl code.  It seems
    reasonable to define a standard length and use that for consitancy.  This
    patch introduces the constant KMOD_PATH_LEN and uses that.
    
    Signed-off-by: Andy Whitcroft <apw@shadowen.org>
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit 7f94e2a677d0630019883a132d60b55036ebc31c
Author: Andrew Morton <akpm@osdl.org>
Date:   Sat Jun 12 16:41:03 2004 -0700

    [PATCH] Update Documentation/filesystems/Locking
    
    From: Anton Altaparmakov <aia21@cam.ac.uk>
    
    A filesystem's ->writepage() implementation nowadays must run either
    redirty_page_for_writepage() or the combination of set_page_writeback()/
    end_page_writeback().  Failure to do so leaves the page itself marked clean
    but it is tagged as dirty in the radix tree (PAGECACHE_TAG_DIRTY).  This
    incoherency can lead to all sorts of hard-to-debug problems in the
    filesystem like having dirty inodes at umount and losing written data.
    
    The patch updates Documentation/filesystems/Locking to reflect this
    requirement.
    
    Signed-off-by: Anton Altaparmakov <aia21@cantab.net>
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit aa1df6ca57369989eb4b860e3f182a7e07077069
Author: Andrew Morton <akpm@osdl.org>
Date:   Sat Jun 12 16:40:49 2004 -0700

    [PATCH] sync_inodes_sb() stack reduction
    
    Reduce stack consumption in sync_inodes_sb() via read_page_state().
    
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit 973a48508863c6827fae0bf700173597b1cf9a36
Author: Andrew Morton <akpm@osdl.org>
Date:   Sat Jun 12 16:40:35 2004 -0700

    [PATCH] page-writeback.c: use read_page_state()
    
    Use the new read_page_state() in page-writeback.c to avoid large on-stack
    structures.
    
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit a73973069fe77b82ed7004a79fac87179e6ea56e
Author: Andrew Morton <akpm@osdl.org>
Date:   Sat Jun 12 16:40:21 2004 -0700

    [PATCH] vmscan.c: use read_page_state()
    
    Use the new read_page_state() in vmscan.c to avoid large on-stack structures.
    
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit 0c7d503fa84762eadaa6ea64b39f1d8f5e3e1277
Author: Andrew Morton <akpm@osdl.org>
Date:   Sat Jun 12 16:40:07 2004 -0700

    [PATCH] Implement read_page_state
    
    struct page_state is large (148 bytes) and we put them on the stack in awkward
    code paths (page reclaim...)
    
    So implement a simple read_page_state() which can be used to pluck out a
    single member from the all-cpus page_state accumulators.
    
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit 72a9defa9a4fda3a4e1f9ed67b74a11e756cc3cc
Author: Andrew Morton <akpm@osdl.org>
Date:   Sat Jun 12 16:39:53 2004 -0700

    [PATCH] vmscan.c: struct scan_control
    
    From: Nick Piggin <nickpiggin@yahoo.com.au>
    
    Replace lots of parameters to functions in mm/vmscan.c with a structure
    struct scan_control.
    
    Signed-off-by: Nick Piggin <nickpiggin@yahoo.com.au>
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit 690c9c04f9797a5708c9eaae118b08c9977753ee
Author: Andrew Morton <akpm@osdl.org>
Date:   Sat Jun 12 16:39:39 2004 -0700

    [PATCH] vmscan.c: move ->writepage invocation into its own function
    
    From: Nick Piggin <nickpiggin@yahoo.com.au>
    
    Move the invocation of ->writepage for to-be-reclaimed pages into
    its own function "pageout".
    
    From: Nikita Danilov <nikita@namesys.com>
    with small changes from Nick Piggin
    
    Signed-off-by: Nick Piggin <nickpiggin@cyberone.com.au>
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit 06bc9f5edd7a957a75d9dc1f6de8c48630580387
Author: Andrew Morton <akpm@osdl.org>
Date:   Sat Jun 12 16:39:25 2004 -0700

    [PATCH] vmscan: try harder for GFP_NOFS allocators
    
    Page reclaim bales out very early if reclaim isn't working out for !__GFP_FS
    allocation attempts.
    
    It was a fairly arbitrary thing in the first place and chances are the caller
    will simply retry the allocation or will do something which is disruptive to
    userspace.  So remove that code and do much more scanning.
    
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit 961caf47918340aea55aa2ca9b68e7f1c8d91ca6
Author: Andrew Morton <akpm@osdl.org>
Date:   Sat Jun 12 16:39:11 2004 -0700

    [PATCH] vmscan: handle synchronous writepage()
    
    Teach page reclaim to understand synchronous ->writepage implementations.
    
    If ->writepage completed I/O prior to returning we can proceed to reclaim the
    page without giving it another trip around the LRU.
    
    This is beneficial for ramdisk-backed S_ISREG files: we can reclaim the file's
    pages as fast as the ramdisk driver needs to allocate them and this prevents
    I/O errors due to OOM in rd_blkdev_pagecache_IO().
    
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit 2c38ac911b5edfb8f6933aeb1b98d39603da26a1
Author: Andrew Morton <akpm@osdl.org>
Date:   Sat Jun 12 16:38:57 2004 -0700

    [PATCH] NUMAQ kconfig fix
    
    NUMA-Q requires CONFIG_NUMA and CONFIG_DISCONTIGMEM to build.
    
    Cc: Martin J. Bligh <mbligh@aracnet.com>
    
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit 43d874b05e6b97d2ba7a84451ffe309de60044bb
Author: Andrew Morton <akpm@osdl.org>
Date:   Sat Jun 12 16:38:43 2004 -0700

    [PATCH] voyager linkage fix
    
    From: William Lee Irwin III <wli@holomorphy.com>
    
    Voyager doesn't support HT, so smp_num_siblings doesn't exist.
    
    Cc: James Bottomley <James.Bottomley@SteelEye.com>
    
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit dd4f28e047d2c87787ef917651a55166ede56003
Author: Andrew Morton <akpm@osdl.org>
Date:   Sat Jun 12 16:38:26 2004 -0700

    [PATCH] Voyager doesn't support MCE
    
    From: William Lee Irwin III <wli@holomorphy.com>
    
    Voyager doesn't compile any of the APIC or IO-APIC -related code in
    arch/i386/kernel/ at all -- so it's a logical impossibility that this could
    ever work.
    
    Cc: James Bottomley <James.Bottomley@SteelEye.com>
    
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit 18961740cf716a3b68c342056a30e35b3abb7fc5
Author: Andrew Morton <akpm@osdl.org>
Date:   Sat Jun 12 16:38:11 2004 -0700

    [PATCH] numaq mempolicy.c build fix
    
    From: William Lee Irwin III <wli@holomorphy.com>
    
    mm/mempolicy.c: In function `verify_pages':
    mm/mempolicy.c:246: warning: implicit declaration of function `kmap_atomic'
    mm/mempolicy.c:249: warning: implicit declaration of function `kunmap_atomic'
    
    pte_offset_map() invokes kmap_atomic() via macro, without including the
    required header.
    
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit eb2d73fcd584cc64008fb326738b7b26ba1bec41
Author: Andrew Morton <akpm@osdl.org>
Date:   Sat Jun 12 16:37:58 2004 -0700

    [PATCH] Fix exception trace printing on x86-64
    
    From: Andi Kleen <ak@suse.de>
    
    Originally by Juergen Kreileder, changed by me.
    
    The test for unhandled signals was wrong.  Correct it.  This helps Java
    users, who would see bogus printks in their kernel logs previously.
    
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit 848f12d66b3e0ea8c59eca34b5605d4ae5b6470a
Author: Andrew Morton <akpm@osdl.org>
Date:   Sat Jun 12 16:37:44 2004 -0700

    [PATCH] s390: fix kmem_bufctl_t definition
    
    From: Arnd Bergmann <arnd@arndb.de>
    
    On s390, kmem_bufctl_t was added inside of an #ifdef, breaking
    64 bit builds.
    
    Signed-off-by: Arnd Bergmann <arnd@arndb.de>
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit 7278aee30bbc2d7abce83bb0874d48b534ba2e9f
Author: Andrew Morton <akpm@osdl.org>
Date:   Sat Jun 12 16:37:29 2004 -0700

    [PATCH] More fixes for the x86-64 machine check handler
    
    From: Andi Kleen <ak@suse.de>
    
    Fix more bad issues in the x86-64 machine check handler.
    
    - Actually test status after reading it from the register, not before.
    
    - Check the UC bit instead of the PCC bit to detect the bank which caused
      the exception.
    
    - Add tolerant==3 level for easier testing. This will avoid any panics.
    
    - Don't threat bank overflows as fatal - they must have come from a non
      fatal exception, which should not cause a panic.
    
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit a3efe8ce9136e9179d5831cd82400da644a9fdca
Author: Andrew Morton <akpm@osdl.org>
Date:   Sat Jun 12 16:37:12 2004 -0700

    [PATCH] define for_each_cpu_mask() for uniprocessor
    
    From: Bruno Ducrot <poup@poupinou.org>
    
    I'm trying to replace for_each_cpu() with for_each_cpu_mask() in
    arch/i386/kernel/cpu/cpufreq/p4-clockmod.c
    
    Unfortunately, though, davej pointed me that for_each_cpu_mask() is not
    defined in -bk if CONFIG_SMP is not defined.
    
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit 34669c6801ae7ccec85d5cc7dcb5f2e8036a440c
Author: Andi Kleen <ak@muc.de>
Date:   Sat Jun 12 16:30:41 2004 -0700

    [PATCH] Fix fwait on x86-64 too
    
    Discard FPU exceptions in exit and execve on x86-64 too.
    
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit 1b26d7ab24978aaeafcb0cb0bca3bcd781e181e2
Author: Tony Lindgren <tony@com.rmk.(none)>
Date:   Sat Jun 12 23:15:57 2004 +0100

    [ARM PATCH] 1905/1: Add OMAP compressed boot debug serial output
    
    Patch from Tony Lindgren
    
    This patch adds OMAP compressed image debug serial output.
    
    This patch contains updates to the following files:
       b/arch/arm/boot/compressed/head.S

commit b3fe2c6630a4da022985887c2b8596a4c43f05df
Author: Tony Lindgren <tony@com.rmk.(none)>
Date:   Sat Jun 12 23:11:28 2004 +0100

    [ARM PATCH] 1908/1: Remove old OMAP header files
    
    Patch from Tony Lindgren
    
    This patch removes the following old files that have been renamed:
       include/asm-arm/arch-omap/omap-h2.h
       include/asm-arm/arch-omap/omap-innovator.h
       include/asm-arm/arch-omap/omap-perseus2.h
    
    The new names for the files are board-*.h.

commit 86b0182d6ae2cb74a849a9ab88d7e1da18e3c6ff
Author: Russell King <rmk@flint.arm.linux.org.uk>
Date:   Sat Jun 12 22:43:21 2004 +0100

    [ARM] Tidy up patch 1925/1
    
    Since each Kconfig file is now bracketed with if ARCH_foo ... endif,
    we can remove the individual "depends on ARCH_foo" clauses against
    each option.

commit 8b5f4469390ceb54bc464b385fd181a8eda2ca92
Author: Andrew Zabolotny <zap@ru.rmk.(none)>
Date:   Sat Jun 12 22:31:57 2004 +0100

    [ARM PATCH] 1925/1: ARM 'System Type' kernel config menu cleanup
    
    Patch from Andrew Zabolotny
    
    This patch makes architecture-specific submenus under
    "System Type" visible only if the corresponding architecture
    is selected via the "ARM System Type" menu. Also comments
    out IDE_POLL in mach-lh7a40x/Kconfig since it is undefined
    and causes warnings during make menuconfig.
    
    Signed-off-by: Andrew Zabolotny <zap@homelink.ru>

commit 6d7cd5161d36e075f25ea26e63547cf55afd79f7
Author: Tony Lindgren <tony@com.rmk.(none)>
Date:   Sat Jun 12 22:27:40 2004 +0100

    [ARM PATCH] 1922/1: OMAP update 2/2: include files (replaces patch 1904/1)
    
    Patch from Tony Lindgren
    
    This patch syncs the mainline kernel with the linux-omap tree.
    The highlights of the patch are:
    - Register name clean-up. Mostly removes _REG from register names
      and replace OMAP1510P1 with OMAP1510. Also moves IO macros
      from hardware.h to io.h (Dirk Behme)
    - Add DMA framebuffer hardware acceleration features (Imre Deak)
    - Fix GPIO code not to do unnecessary address translations
      between physical and virtual addresses (Juha YrjÃ¶lÃ¤)
    - Misc updates, such as OMAP gpio export fixes, additional
      multiplexing settings, include mach-types.h only where needed,
      show OMAP revision early during boot

commit 602ced3e1a170b0d2103c5b56a0aa9a7e1e537e1
Author: Tony Lindgren <tony@com.rmk.(none)>
Date:   Sat Jun 12 22:23:21 2004 +0100

    [ARM PATCH] 1923/1: OMAP update 1/2: arch files (replaces patch 1903/1)
    
    Patch from Tony Lindgren
    
    This patch syncs the mainline kernel with the linux-omap tree.
    The highlights of the patch are:
    - Register name clean-up. Mostly removes _REG from register names
      and replace OMAP1510P1 with OMAP1510. Also moves IO macros
      from hardware.h to io.h (Dirk Behme)
    - Add DMA framebuffer hardware acceleration features (Imre Deak)
    - Fix GPIO code not to do unnecessary address translations
      between physical and virtual addresses (Juha YrjÃ¶lÃ¤)
    - Misc updates, such as OMAP gpio export fixes, additional
      multiplexing settings, include mach-types.h only where needed,
      show OMAP revision early during boot

commit d69c7369f473f8647b31693976dfb2a433ffaae9
Author: Russell King <rmk@flint.arm.linux.org.uk>
Date:   Sat Jun 12 22:13:21 2004 +0100

    [ARM] Update ARM memory layout documentation.
    
    This updates the memory layout documentation to indicate that certain
    areas should remain unused.  It also corrects a few minor errors with
    region end addresses.

commit 2437333545101a9767ed3f0206f212a9794a2db7
Merge: 4c3146e... 15b5479...
Author: Jeff Garzik <jgarzik@pobox.com>
Date:   Sat Jun 12 16:55:12 2004 -0400

    Merge pobox.com:/spare/repo/netdev-2.6/e100
    into pobox.com:/spare/repo/net-drivers-2.6

commit 6774af67055de0e11b1fcca5a5e42f79d0ce3981
Author: Steve French <stevef@smfhome.smfdom>
Date:   Sat Jun 12 09:12:17 2004 -0500

    remove compile warning
    
    Signed-off-by: Steve French (sfrench@us.ibm.com)

commit 15b54794b416b70af3d03de2446c5f696179fa45
Author: Linus Torvalds <torvalds@evo.osdl.org>
Date:   Sat Jun 12 05:29:44 2004 -0700

    sparse cleanup of #include file
    
    sparse tokenizes everything. Including #include
    directives. Which means that it doesn't want to
    see "//" in a include filename, since that's a
    comment outside of a string.
    
    And inside of a string it's too dark to read.

commit 8e24cc7052a9e1082edcd4b9bbb3787858043b37
Author: Linus Torvalds <torvalds@evo.osdl.org>
Date:   Sat Jun 12 05:12:31 2004 -0700

    Fix x86 "clear_cpu()" macro.
    
    We need to clear all exceptions before synchronizing
    with the FPU, since we aren't ready to handle a FP
    exception here and we're getting rid of all FP state.
    
    Special thanks to Alexander Nyberg for reports and
    testing. Alternate patches by Sergey Vlasov and Andi
    Kleen, who both worked on this.
    
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit a44280c6e4c71bdda9aec62b83c8975ffb2c1e8c
Author: Steve French <stevef@smfhome.smfdom>
Date:   Sat Jun 12 05:35:12 2004 -0500

    Extended Attributes part 1
    
    Signed-off-by: Steve French (sfrench@us.ibm.com)

commit 6e04296b6d79c5ca4a68f94ea7439b857f1e2de0
Author: David S. Miller <davem@nuts.davemloft.net>
Date:   Fri Jun 11 23:01:09 2004 -0700

    [SPARC64]: Preemption fixes, use get_cpu() et al. where applicable.

commit 6d1bb7f1a45bb4afeb0992ad8c84e00fe69daa99
Author: David S. Miller <davem@nuts.davemloft.net>
Date:   Fri Jun 11 21:43:36 2004 -0700

    [TG3]: Update driver version and reldate.

commit 4b343d468df71ee500ee25318ac685b57fd60d18
Merge: 981a1ad... 2410759...
Author: David S. Miller <davem@nuts.davemloft.net>
Date:   Fri Jun 11 21:29:29 2004 -0700

    Merge nuts.davemloft.net:/disk1/BK/tg3work-2.6
    into nuts.davemloft.net:/disk1/BK/tg3-2.6

commit 0daefd1704aa5b91ebda33ace6572fda52b89b5e
Merge: 981a1ad... caa702e...
Author: David S. Miller <davem@kernel.bkbits.net>
Date:   Fri Jun 11 21:26:15 2004 -0700

    Merge davem@nuts.davemloft.net:/disk1/BK/net-2.6
    into kernel.bkbits.net:/home/davem/net-2.6

commit 2410759ace8ed2aa42836639d62e69611b5aaaeb
Author: David S. Miller <davem@nuts.davemloft.net>
Date:   Fri Jun 11 21:22:24 2004 -0700

    [TG3]: Chip support update and a power-save bug fix.
    
    1) Add PCI IDs and driver entries for 5789, 5751M and
       5751F chips.  Mark 5751F chips as 10/100 only.
    2) Call pci_restore_state() at beginning of tg3_resume() as
       this helps some chips come out of D3 more cleanly.

commit caa702e20a1a0b974306e29bbbe750bb3e15436d
Author: Hideaki Yoshifuji <yoshfuji@linux-ipv6.org>
Date:   Fri Jun 11 20:52:09 2004 -0700

    [NET]: Add dst->ifdown callback.
    
    Use it to release protocol specific objects that may be
    tied to a dst cache object, at ifdown time.  Currently
    this is used to release ipv4/ipv6 specific device state.

commit c4519d3c33fcca1f9955ed28417efac88702b219
Merge: be76fff... 5d746e6...
Author: David S. Miller <davem@nuts.davemloft.net>
Date:   Fri Jun 11 20:49:04 2004 -0700

    Merge bk://kernel.bkbits.net/acme/net-2.6
    into nuts.davemloft.net:/disk1/BK/net-2.6

commit 5d746e6a331c527a3cdb3cd97056a0303daa6b39
Author: Arnaldo Carvalho de Melo <acme@toy.kerneljanitors.org>
Date:   Fri Jun 11 19:09:38 2004 -0300

    [NET] generalize some simple tcp sk_ack_backlog handling routines
    
    Will be used by the poor cousins, starting with LLC.
    
    Signed-off-by: Arnaldo Carvalho de Melo <acme@conectiva.com.br>

commit 1a9325fb3f679b86005095f49ce1e4956209820e
Author: Dave Jones <davej@redhat.com>
Date:   Fri Jun 11 20:50:39 2004 +0100

    [CPUFREQ] speedstep-ich: SMT/HT support, fix for notify change
    Propagate the notify moving to speedstep-ich, and add SMT (HT)
    awareness to the speedstep-ich.
    
    Patch was written in very large parts by Christian Hoelbling.
    
    Signed-off-by: Dominik Brodowski <linux@brodo.de>
    Signed-off-by: Dave Jones <davej@redhat.com>

commit 03692dda10f820e9427baaa385fbe1529bc9f9e4
Author: Dave Jones <davej@redhat.com>
Date:   Fri Jun 11 20:49:00 2004 +0100

    [CPUFREQ] AMD powernow documentation updates.
    From: Paul Devriendt
    Signed-off-by: Dave Jones <davej@redhat.com>

commit b5e68743f16c3a4c8a2dd2edf0db1d66e69ba666
Author: Dave Jones <davej@redhat.com>
Date:   Fri Jun 11 15:18:54 2004 +0100

    [CPUFREQ] Add missing include to p4-clockmod
    Signed-off-by: Dave Jones <davej@redhat.com>

commit 7c122fca2cb9ebcd50c3e3ed20c78784ebd72359
Author: Dave Jones <davej@redhat.com>
Date:   Fri Jun 11 14:51:48 2004 +0100

    [CPUFREQ] replace for_each_cpu with for_each_cpu_mask in p4-clockmod
    
    From: Bruno Ducrot
    Signed-off-by: Dave Jones <davej@redhat.com>

commit e7bba9c24f4183c8bbde3dece8b782cf9f677adb
Author: Steve French <stevef@stevef95.austin.ibm.com>
Date:   Fri Jun 11 08:15:21 2004 -0500

    Add missing EA info levels
    
    Signed-off-by: Steve French (sfrench@us.ibm.com)

commit d37e1fe93f447dd00e6a9c476de79599dda7be8a
Author: Dave Jones <davej@redhat.com>
Date:   Fri Jun 11 13:13:42 2004 +0100

    [CPUFREQ] small codingstyle fixes
    Signed-off-by: Dave Jones <davej@redhat.com>

commit 96745ae647219e9208845f5ecf3461a154ef163c
Author: Dave Jones <davej@redhat.com>
Date:   Fri Jun 11 13:07:01 2004 +0100

    [CPUFREQ] Detect P4M's in speedstep lib
    From: Christian Hoelbling
    Signed-off-by: Dave Jones <davej@redhat.com>

commit fdaea99639772c2d1a99ab4485d0d7d6084a62cd
Author: Arnaldo Carvalho de Melo <acme@toy.kerneljanitors.org>
Date:   Fri Jun 11 08:04:19 2004 -0300

    [NET] introduce sk_wait_evend and generalise tcp_data_wait
    
    Later patches will make other protocols use sk_wait_data and further generalisations
    of tcp code will use sk_wait_event.
    
    This is again to abstract away more stuff from poor network family writers, like
    the SOCK_ASYNC_WAITDATA, etc.
    
    Signed-off-by: Arnaldo Carvalho de Melo <acme@conectiva.com.br>

commit be76fffcaabefcad2f510c3bcdc4f45a93a022ac
Merge: e9ecb23... fdaea99...
Author: David S. Miller <davem@nuts.davemloft.net>
Date:   Fri Jun 11 02:33:01 2004 -0700

    Merge bk://kernel.bkbits.net/acme/net-2.6
    into nuts.davemloft.net:/disk1/BK/net-2.6

commit 62bbc304ee14a6d7bafd56551ff2ee1182732bee
Author: Steve French <stevef@smfhome1.smfdom>
Date:   Fri Jun 11 04:00:42 2004 -0500

    Handle rename of hardlinked files properly (treat as a noop)
    
    Signed-off-by: Steve French (sfrench@us.ibm.com)

commit e3e741aab47d80d29d244dc48ba221a80281379f
Author: Steve French <stevef@smfhome.smfdom>
Date:   Fri Jun 11 02:32:03 2004 -0500

    flush write behind cached data, for files reopened after session reconnection after session drop
    
    Signed-off-by: Steve French (sfrench@us.ibm.com)

commit f59d3bbe35f6268d729f51be82af8325d62f20f5
Author: Dave Jones <davej@redhat.com>
Date:   Fri Jun 11 00:48:57 2004 +0100

    [CPUFREQ] Fix cpufreq on ARM
    
    cpufreq doesn't appear to initialise on ARM - cpufreq_register_driver()
    fails with -ENODEV.
    
    This appears to be because we register cpus at subsys_initcall() time,
    and cpufreq drivers at arch_initcall() time.  We need cpufreq up and
    running before any drivers are initialised since their timings depend
    on the CPU clock rate.
    
    The following patch appears to fix these problems.
    
    From: Russell King
    Signed-off-by: Dave Jones <davej@redhat.com>

commit 4459527d93ef20182ad2b03b9861f64afffc102a
Author: Dave Jones <davej@redhat.com>
Date:   Fri Jun 11 00:47:04 2004 +0100

    [CPUFREQ] Remove notify in speedstep_set_state [2/2]
    
    Signed-off-by: Bruno Ducrot <ducrot@poupinou.org>
    Signed-off-by: Dave Jones <davej@redhat.com>

commit e4b509c4f5f8a9951a00bde20e768f3c8b76dacd
Author: Dave Jones <davej@redhat.com>
Date:   Fri Jun 11 00:46:01 2004 +0100

    [CPUFREQ] Remove notify in speedstep_set_state [1/2]
    Remove 'notify' in speedstep_set_state for speedstep-lib
    
    Signed-off-by: Bruno Ducrot <ducrot@poupinou.org>
    Signed-off-by: Dave Jones <davej@redhat.com>

commit 5d0e9fbf19837b0cdad7573165ce555f3a6fd86d
Author: Russell King <rmk@flint.arm.linux.org.uk>
Date:   Fri Jun 11 00:44:09 2004 +0100

    [ARM] uaccess.h should include asm/memory.h not asm/arch/memory.h

commit 757a4a23dd347ec758af41bf3c23f02c334c0aeb
Author: Dave Jones <davej@redhat.com>
Date:   Fri Jun 11 00:43:29 2004 +0100

    [CPUFREQ] Limit return value of speedstep_get_state()
    
    Looking around speedstep-smi, there is a lot of call to
    speedstep_get_state() which is used as an index for the array
    speedstep_freqs.  But speedstep_get_state() will return the value of ebx
    after a call to a SMI handler.  It's not safe IMHO.
    
    From: Bruno Ducrot
    Signed-off-by: Dave Jones <davej@redhat.com>

commit fe3e41aa86efa2839120655279e8ee66fcb5fa64
Author: Dave Jones <davej@redhat.com>
Date:   Fri Jun 11 00:39:58 2004 +0100

    [CPUFREQ] Add documentation on AMD powernow drivers
    From Paul Devriendt.
    Signed-off-by: Dave Jones <davej@redhat.com>

commit 95456f9abb945f985c7346eca362aaef8cc5aab5
Author: Dave Jones <davej@redhat.com>
Date:   Fri Jun 11 00:36:43 2004 +0100

    [CPUFREQ] powernow-k8: preempt fix
    
    Pavel's fix for preempt in the suspend scenario.
    The driver protects itself from multiple entry already, and it does not care if
    there is a long delay in the middle of a multi-step transition, so there
    really is no need for it to disable preempt.
    
    Signed-off-by: Dave Jones <davej@redhat.com>

commit b27e807e261926ba7993ca004564db37845ec8b7
Author: Russell King <rmk@flint.arm.linux.org.uk>
Date:   Fri Jun 11 00:34:23 2004 +0100

    [ARM] Clean up io-acorn.
    
    io-acorn.o is not necessary for CLPS711x build - the functions it
    provides are defined as macros in asm/io.h, so they will never be
    referenced.
    
    io-acorn.o only provides insl/outsl, so the half-word IO macros
    within are never used; remove them.

commit 63add93e5a3a2fcc257c4cde73488439ebf97bf6
Author: Dave Jones <davej@redhat.com>
Date:   Fri Jun 11 00:33:54 2004 +0100

    [CPUFREQ] powernow-k8: ignore double lo freq table entries
    
    Ignore two identical low freq entries in the ACPI tables for the powernow-k8
    driver.
    
    Signed-off-by: Dominik Brodowski <linux@brodo.de>
    Signed-off-by: Dave Jones <davej@redhat.com>

commit 39657dde8bcc3288aba3577bc3b6de5d96104cf5
Author: Dave Jones <davej@redhat.com>
Date:   Fri Jun 11 00:32:02 2004 +0100

    [CPUFREQ] convert gx-suspmod MODULE_PARM to module_param
    
    Convert gx-suspmod's MODULE_PARM to module_param.
    
    Signed-off-by: Dominik Brodowski <linux@brodo.de>
    Signed-off-by: Dave Jones <davej@redhat.com>

commit 674a4f2ed8774539a95601df80ed9cc03b3adcd1
Author: Dave Jones <davej@redhat.com>
Date:   Fri Jun 11 00:30:33 2004 +0100

    [CPUFREQ] convert elanfreq MODULE_PARM to module_param
    
    Convert elanfreq's MODULE_PARM to module_param, and warn users that the setup parameter
    "elanfreq" will go away in favor of "elanfreq.max_freq".
    
    Signed-off-by: Dominik Brodowski <linux@brodo.de>
    Signed-off-by: Dave Jones <davej@redhat.com>

commit 861745d15be595f8e0a57b173884fc8f06e32904
Author: Dave Jones <davej@redhat.com>
Date:   Fri Jun 11 00:29:30 2004 +0100

    [CPUFREQ] Cpufreq hotplug
    From: "Pallipadi, Venkatesh" <venkatesh.pallipadi@intel.com>
    
    I was trying to fix this hotplug force migration issue in
    cpu/cpufreq/acpi.c. As you suggested, it made more sense to do this in
    cpufreq.c, so that we need not do this in multiple low level drivers.
    How does this simple patch look. Beyond this, we may have to change some
    documentation, to tell to all low level drivers that they can assume
    hotplug lock will be taken, when they are in the target() routine.
    
    Signed-off-by: Dave Jones <davej@redhat.com>

commit 12097b81f9b8598c62df4bb5218e19ef66a47a99
Author: Russell King <rmk@flint.arm.linux.org.uk>
Date:   Thu Jun 10 23:39:43 2004 +0100

    [ARM] Add ucontext bits for sigaltstack handling.

commit b71554038b4eb48c30a90646732dd920aa9d0685
Author: Arnaldo Carvalho de Melo <acme@toy.kerneljanitors.org>
Date:   Thu Jun 10 16:45:53 2004 -0300

    [NET] generalise tcp_eat_skb into sk_eat_skb
    
    It was already generic, so reflect this in the naming.
    
    Later patches will make it be used in other network families.

commit e9ecb23678b826798d9bbc5f7050d71737557788
Author: Andreas Dilger <adilger@clusterfs.com>
Date:   Thu Jun 10 08:41:36 2004 -0700

    [IPV4]: Fix bug in arp_tables.c fix.

commit f9fa9603f0fa6532a89c30b3a59bd2a904cab777
Merge: b4418fb5a... b715540...
Author: David S. Miller <davem@nuts.davemloft.net>
Date:   Thu Jun 10 08:30:23 2004 -0700

    Merge bk://kernel.bkbits.net/acme/net-2.6
    into nuts.davemloft.net:/disk1/BK/net-2.6

commit 4c3146e0901543e83159719ba812a5140da64279
Author: Scott Feldman <scott.feldman@intel.com>
Date:   Thu Jun 10 11:30:13 2004 -0400

    [PATCH] e100: fix sender hang after tx timeout
    
    * When e100 experiences a transmit timeout, it calls e100_up() to reset
    the device.  e100_up calls netif_start_queue to release any flow block,
    but doesn't reschedule.  This patch unblocks the flow and schedules Tx.
    Jay Vosburgh [fubar@us.ibm.com].
    
    Signed-off-by: scott.feldman@intel.com

commit f690ecaf7914569f174bda5e384c2505cbaa741b
Author: Scott Feldman <scott.feldman@intel.com>
Date:   Thu Jun 10 11:30:04 2004 -0400

    [PATCH] e100: fix skb leak in tx timeout
    
    * If e100 experiences a transmit timeout, and the tx ring is completely
    full at the time, it will leak all of the skbs on the tx ring (because
    extra logic is needed to distinguish ring full from ring empty).  Jay
    Vosburgh [fubar@us.ibm.com].
    
    Signed-off-by: scott.feldman@intel.com

commit 013ae2ddbfa8d150a53e6c1cb9d8c3fc5e124b45
Author: Scott Feldman <scott.feldman@intel.com>
Date:   Thu Jun 10 11:29:56 2004 -0400

    [PATCH] e100: stepping over err return code
    
    * Spotted by Jay Vosburgh [fubar@us.ibm.com].  err return code was getting
    stepped on in the case where we need to report low or no cb resources,
    which in turn messed up the netif_stop_queue logic in xmit_frame.
    
    Signed-off-by: scott.feldman@intel.com

commit b4418fb5ae4e7e6936a7c9a3ece757c47c5983d3
Author: Shirley Ma <mashirle@us.ibm.com>
Date:   Thu Jun 10 08:12:51 2004 -0700

    [IPV6]: Fix ICMP6 type checking tests in ah6.c and esp6.c
    
    Signed-off-by: Shirley Ma <mashirle@us.ibm.com>
    Signed-off-by: David S. Miller <davem@redhat.com>

commit 637575a1a92f776f81920682a2078f5f36250e09
Author: Shirley Ma <xma@us.ibm.com>
Date:   Thu Jun 10 08:08:55 2004 -0700

    [IPV6]: Initialize pmtu/advmss in ndisc dst entries.
    
    When creating dst entry from ndisc, the dst entry of pmtu is not set, and the
    outout for this kind of dst entry is set to ip_output2 instead of ip_output.
    This could lead to send bigger packets through these des entries without
    fragmentation, and uninitialized pmtu could lead the network unreachable.
    
    These problems are easy reproduced when configuring IPSEC for ipv6. IPSEC
    could pick up dst entry created by ndisc as child des entry if ndisc dst
    entry generated earlier. If sending bigger packets through IPSEC, the ip
    output2 will send bigger packets out, the driver will drop these packets on
    receiver side. Also the dst_entry pmtu will be 0, the network is unreachable.
    
    The patch has been tested against 2.6.6. I am not sure why ndisc genereats dst
    entry with output equal to ip6_output2 not ip6_output. If ndisc sends bigger
    packets, it will break also.
    
    Signed-off-by: Shirley Ma <mashirle@us.ibm.com>
    Signed-off-by: David S. Miller <davem@redhat.com>

commit be59ef0371fa1e9c09bb612e31ce314ceb5577d4
Author: David S. Miller <davem@nuts.davemloft.net>
Date:   Thu Jun 10 08:05:19 2004 -0700

    [IPV4]: Fix unaligned accesses in arp_tables.c

commit 95fec628da35d49729521120fec6326b11d361f0
Author: Jesper Juhl <juhl-lkml@dif.dk>
Date:   Thu Jun 10 08:01:57 2004 -0700

    [NET]: Remove junk from packet_mmap.txt

commit 1e4b22635d69586d49c7e2fa2b24fd991b4c3922
Author: Clay Haapala <chaapala@cisco.com>
Date:   Thu Jun 10 07:58:26 2004 -0700

    [CRYPTO]: Fix digest.c kmapping sg entries > page in length.
    
    Below is the patch, against 2.6.7-rc2, to fix crypto/digest.c to do
    multiple kmap()/kunmap() for scatterlist entries which have a size
    greater than a single page, originally found and fixed by
    N.C.Krishna Murthy <krmurthy@cisco.com>.
    
    Signed-off-by: Clay Haapala <chaapala@cisco.com>
    Signed-off-by: David S. Miller <davem@redhat.com>

commit 65cfd02740fa2081c27ba778ff0bfabdbebb1b89
Author: David S. Miller <davem@nuts.davemloft.net>
Date:   Thu Jun 10 07:53:15 2004 -0700

    [TCP]: Receive buffer moderation fixes.
    
    1) Make window clamp follow receive buffer growth so it
       does not limit window advertisements.  Noticed by John
       Heffner and Stephen Hemminger.
    2) Fix rcvmem calculation such that tcp_adv_win_scale is
       taken into account.

commit 7d83dc5e561b47b1656d25a9db3a5dc274619aae
Author: Steve French <stevef@smfhome.smfdom>
Date:   Thu Jun 10 09:19:19 2004 -0500

    Fix sparse tool compile warnings for cifs
    
    Signed-off-by: Steve French (sfrench@us.ibm.com>

commit 7c7f655242def9ddc9c977a701d616fedb6380cc
Merge: 981a1ad... 0a4a753...
Author: David S. Miller <davem@nuts.davemloft.net>
Date:   Wed Jun 9 21:37:20 2004 -0700

    Merge nuts.davemloft.net:/disk1/BK/sparcwork-2.6
    into nuts.davemloft.net:/disk1/BK/sparc-2.6

commit fff4f98ff6300e700589765b49a75645c359b488
Merge: 929ad08... fa2c79c...
Author: Dave Kleikamp <shaggy@austin.ibm.com>
Date:   Wed Jun 9 23:28:16 2004 -0500

    Merge jfs@jfs.bkbits.net:linux-2.5
    into austin.ibm.com:/shaggy/bk/jfs-2.5

commit 981a1ad3f44b6ba1afd9f3a2d4798e19e728acdb
Merge: 290a768... ad18187...
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Wed Jun 9 18:24:04 2004 -0700

    Merge bk://linux-ntfs.bkbits.net/ntfs-2.6
    into ppc970.osdl.org:/home/torvalds/v2.6/linux

commit 290a768a2b866d44b83e2322796ff6633b7b8538
Author: Anton Altaparmakov <aia21@cantab.net>
Date:   Thu Jun 10 15:23:23 2004 +0100

    NTFS: 2.1.14 - Fix an NFSd caused deadlock reported by several users.
    
    - Modify fs/ntfs/ntfs_readdir() to copy the index root attribute value
      to a buffer so that we can put the search context and unmap the mft
      record before calling the filldir() callback.  We need to do this
      because of NFSd which calls ->lookup() from its filldir callback()
      and this causes NTFS to deadlock as ntfs_lookup() maps the mft record
      of the directory and since ntfs_readdir() has got it mapped already
      ntfs_lookup() deadlocks.
    
    Signed-off-by: Anton Altaparmakov <aia21@cantab.net>

commit 62eed9863805fd3daaad4cf050c5eee7297f7e62
Merge: 31ba046... 3c3daf3...
Author: Anton Altaparmakov <aia21@cantab.net>
Date:   Thu Jun 10 11:02:41 2004 +0100

    Merge cantab.net:/home/src/bklinux-2.6
    into cantab.net:/home/src/ntfs-2.6

commit ad1818701d447d5a04b88b50b1e7e29b1f1507d0
Merge: 53c5395... 648e0d2...
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Wed Jun 9 18:22:00 2004 -0700

    Merge bk://drm.bkbits.net/drm-2.6
    into ppc970.osdl.org:/home/torvalds/v2.6/linux

commit 648e0d2a06c2bde87396598657d82a3658523e64
Merge: 3c3daf3... 2a50b4d...
Author: Dave Airlie <airlied@starflyer.(none)>
Date:   Sat Jun 12 15:25:11 2004 +1000

    Merge bk://drm.bkbits.net/drm-2.6
    into starflyer.(none):/home/airlied/drm/drm-2.6

commit 2a50b4d54650b7ccc5cd6e83434cd7563661b1a4
Author: Dave Airlie <airlied@starflyer.(none)>
Date:   Sat Jun 12 15:23:45 2004 +1000

    gamma_dma_priority and gamma_dma_send_buffers both deref d->send_indices
    and/or d->send_sizes.  When these functions are called from gamma_dma,
    these pointers are user pointers and are thus not safe to deref.  This patch
    copies over the pointers inside gamma_dma_priority and
    gamma_dma_send_buffers.
    
    Submitted-by: Robert T. Johnson <rtjohnso@eecs.berkeley.edu>
    Signed-off-by: Dave Airlie <airlied@linux.ie>

commit 53c5395aac99e9a359803c0b26e964b03b5d9fe3
Author: Jens Axboe <axboe@suse.de>
Date:   Wed Jun 9 18:21:19 2004 -0700

    [PATCH] fix ide-cd racy completions
    
    This bug took forever to debug (just ask Ben :-).
    
    When we move the completion event from the failed request to the sense
    request, we risk either the initial complete and then later complete on
    a long gone ->waiting.  I think this business of moving the completion
    structure to the request sense is a bit bogus and always has been, and
    the bug is fixed nicely by just rewriting this logic a bit.  So instead
    we simply unconditionally dequeue the failed request (regardless of
    whether it was REQ_PC or REQ_BLOCK_PC), and pass a reference to it in
    the sense request.  When the sense completes, we call end io on the
    originally failed request (which does the complete() etc).
    
    Signed-off-by: Jens Axboe <axboe@suse.de>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit 96036e97bdd93833ae88fcf9f6fbe0aa701b6d01
Author: Geert Uytterhoeven <geert@linux-m68k.org>
Date:   Wed Jun 9 18:10:50 2004 -0700

    [PATCH] SCSI_DPT_I2O should depend on PCI

commit 929ad084a8436cf65a69a9b8f76236272bfecd9e
Merge: 3c3daf3... b215b03...
Author: Dave Kleikamp <jfs.adm@hostme.bitkeeper.com>
Date:   Wed Jun 9 17:16:42 2004 -0700

    Merge bk://linux.bkbits.net/linux-2.5
    into hostme.bitkeeper.com:/repos/j/jfs/linux-2.5

commit e9b850ebc5aab46cb4f3374f29dfa2b16652e825
Author: Dave Jones <davej@redhat.com>
Date:   Wed Jun 9 22:48:50 2004 +0100

    [CPUFREQ] Fix longhaul's debug printk.
    It printed garbage.
    
    Signed-off-by: Dave Jones <davej@redhat.com>

commit 720a1a7ad65a3fad977f64ec22c9098a2b44ad3f
Author: Dave Jones <davej@redhat.com>
Date:   Wed Jun 9 22:09:04 2004 +0100

    [CPUFREQ] Now that maxmult is a global, don't need to pass it around in longhaul driver
    
    Signed-off-by: Dave Jones <davej@redhat.com>

commit 0a951051080b7a2b3e9b72de66b75571751f5483
Author: Dave Jones <davej@redhat.com>
Date:   Wed Jun 9 22:01:10 2004 +0100

    [CPUFREQ] Reset longhaul to max speed on unload.
    If we don't do this, and the speed was set to the minimum,
    we trigger the lowest==highest assertion on subsequent loads.
    
    Signed-off-by: Dave Jones <davej@redhat.com>

commit 8bb48a1772569aaeb77efb77bede9355fd9bfa02
Author: Arnaldo Carvalho de Melo <acme@conectiva.com.br>
Date:   Wed Jun 9 10:38:52 2004 -0300

    [NET] Introduce sk_reset_timer and sk_stop_timer
    
    This makes the best practices already in place in bluetooth
    and tcp/ip available for all protocols, i.e. references must
    be managed when associating timers with struct sock instances,
    also makes the code a bit more clean.
    
    Signed-off-by: Arnaldo Carvalho de Melo <acme@conectiva.com.br>

commit fa2c79c3514bacb3dfd84591e326a91094f7fc13
Author: Dave Kleikamp <shaggy@austin.ibm.com>
Date:   Wed Jun 9 06:32:52 2004 -0500

    JFS: Better RAS when btstack is overrun
    
    The current warning and/or trap when the btstack is overrun in
    dtSearch or dtReadFirst are not very helpful.  Add code to detect
    the stack overrun earlier, print something useful, and return
    gracefully.
    
    I've found that dbFree being called with blkno == 0 can lead to this
    error, so I put in a specific check for that.
    
    Signed-off-by: Dave Kleikamp <shaggy@austin.ibm.com>

commit 31ba0466b86c6494b59e139ad98b90a32e53fdc1
Merge: 32e5fca... 2e5ae68...
Author: Anton Altaparmakov <aia21@cantab.net>
Date:   Wed Jun 9 11:11:32 2004 +0100

    Merge cantab.net:/home/src/bklinux-2.6
    into cantab.net:/home/src/ntfs-2.6

commit 0a4a75358a03305a53d1db72864f81558b3a7dcb
Merge: 3c3daf3... 2146999...
Author: Keith M. Wesolowski <wesolows@foobazco.org>
Date:   Wed Jun 9 00:29:48 2004 -0700

    Merge foobazco.org:/sources/2.5-bk
    into foobazco.org:/sources/2.5-sparc-todave

commit 21469996d2c685e5e09ed8b79b630309cbb3314c
Author: Keith M. Wesolowski <wesolows@foobazco.org>
Date:   Wed Jun 9 00:08:13 2004 -0700

    [SPARC]: Consolidate pagetable definitions
    
    Software PMD sizes are now the same for 4cdm, so we remove the
    unneeded btfixups and functions, replacing them with macros like
    on every other platform.

commit 3cab729fed5206967e1271f9e0921cb1c7880218
Author: Dave Airlie <airlied@starflyer.(none)>
Date:   Wed Jun 9 17:05:52 2004 +1000

    The dev->devname being passed to request_irq in drm_irq.h is null.
    With the old DRM interface, the devname was set in DRM(setunique),
    but with the current DRM interface >=1.1 the devname is not being
    set in DRM(set_busid).
    
    From: Alan Swanson
    Approved-by: Dave Airlie <airlied@linux.ie>

commit 104360f2cbe23ed6eaf2e1c7329f51f622896e80
Author: Hideaki Yoshifuji <yoshfuji@linux-ipv6.org>
Date:   Tue Jun 8 23:39:40 2004 -0700

    [IPV6]: Add IP6CB.

commit b608d6a2a20546ce5f043bfec79e9f3f26d72fdf
Merge: 3c3daf3... f03795c...
Author: David S. Miller <davem@nuts.davemloft.net>
Date:   Tue Jun 8 23:33:21 2004 -0700

    Merge nuts.davemloft.net:/disk1/BK/network-2.6
    into nuts.davemloft.net:/disk1/BK/net-2.6

commit 3c3daf3149fa00b66580098449ba4d2040e97c09
Merge: 4354cd7... 9b5e78f...
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Tue Jun 8 23:12:24 2004 -0700

    Merge bk://kernel.bkbits.net/davem/sparc-2.6
    into ppc970.osdl.org:/home/torvalds/v2.6/linux

commit dc01af08541d818088705b59f6d42d0ce4a15faa
Author: Keith M. Wesolowski <wesolows@foobazco.org>
Date:   Tue Jun 8 22:58:23 2004 -0700

    [SPARC]: Fix warning for missing struct device

commit 84e23f505191a34e268eaf652bef0b3517f509b5
Author: Keith M. Wesolowski <wesolows@foobazco.org>
Date:   Tue Jun 8 22:57:40 2004 -0700

    [SPARC]: Fix warning for changed section attributes

commit f03795c54c12fc7a6cd9d4562d1add3de3faa6d7
Merge: 9b5e78f... 8bb48a1...
Author: David S. Miller <davem@nuts.davemloft.net>
Date:   Tue Jun 8 22:54:01 2004 -0700

    Merge bk://kernel.bkbits.net/acme/net-2.6
    into nuts.davemloft.net:/disk1/BK/net-2.6

commit 4354cd7714cbd8913e604fa9601d3fc768095ea8
Author: David S. Miller <davem@nuts.davemloft.net>
Date:   Tue Jun 8 20:33:49 2004 -0700

    [SPARC64]: Update defconfig.

commit 9b5e78fc783caae8ce200368a69b4b3287ecbfc4
Author: Andrew Morton <akpm@osdl.org>
Date:   Tue Jun 8 20:13:16 2004 -0700

    [NETFILTER]: Fix arp_tables.c build.
    
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: David S. Miller <davem@redhat.com>

commit 209174ea2d8a176f2de12cd44967a18527656c8d
Merge: 3c68d09... 6aaac55...
Author: David S. Miller <davem@nuts.davemloft.net>
Date:   Tue Jun 8 20:05:21 2004 -0700

    Merge nuts.davemloft.net:/disk1/BK/sparcwork-2.6
    into nuts.davemloft.net:/disk1/BK/sparc-2.6

commit 6aaac55fbc8c5b6991289731f19cd0489403d270
Author: Oleg Nesterov <oleg@tv-sign.ru>
Date:   Tue Jun 8 19:18:25 2004 -0700

    [PATCH] dup_mmap() double memory accounting
    
    dup_mmap() unnecessarily tries to account for memory of the vma's it has
    created if it fails in the middle.
    
    However, that's pointless (and wrong), since the exit_mmap() path called
    through mmput() will do so anyway in the failure path.
    
    Just remove the bogus un-accounting code.

commit 754d4c9b21574371164f4eddf740bcbfdd26db01
Merge: b861162... ce0025e...
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Tue Jun 8 19:07:24 2004 -0700

    Merge bk://cifs.bkbits.net/linux-2.5cifs
    into ppc970.osdl.org:/home/torvalds/v2.6/linux

commit b86116237f0c6ece987c72948096b362f113a65b
Author: Randy Dunlap <rddunlap@osdl.org>
Date:   Tue Jun 8 19:06:39 2004 -0700

    [PATCH] kernel/sysctl annotations for sparse
    
    Add __user annotations to kernel/sysctl.c to satisfy sparse
    for !CONFIG_SYSCTL, !CONFIG_PROC_FS.
    
    Signed-off-by: Randy Dunlap <rddunlap@osdl.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit cfac87f8213f9973442dd3a97dc634115104e6fb
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Tue Jun 8 18:24:19 2004 -0700

    Mark compaq Fibre Channel driver broken.
    
    It puts two 2kB temp areas on the stack, which is
    guaranteed to overflow a 4kB stack if that path
    is ever taken.
    
    Both marked in the source, and both should be easy
    to fix but need testing.
    
    Found by JÃ¶rn Engel.

commit ded1bc6954dab3e741ef14af6ff10025d0146a64
Author: Andrew Morton <akpm@osdl.org>
Date:   Tue Jun 8 18:19:04 2004 -0700

    [PATCH] vga16fb.c: fix bogus mem_start value
    
    From: Herbert Xu <herbert@gondor.apana.org.au>
    
    The recent change to vga16fb's memory mapping that you partially reverted
    is still broken.  In particular, it's setting fix.mem_start to a virtual
    address on i386.  The value of fix.mem_start is meant to be physical.
    
    We could simply apply virt_to_phys to it, but somehow I doubt that is what
    it's meant to do on arm.  So until we hear from someone who knows how it
    works on arm, let's just revert this change.
    
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit 004a2b36a1c16efcd0dc3af4d10f4503a386d26e
Author: Andrew Morton <akpm@osdl.org>
Date:   Tue Jun 8 18:18:53 2004 -0700

    [PATCH] aio.c sparse warning fix
    
    Randy Dunlap <rddunlap@osdl.org> points out that sparse warns about the test
    of an undefined preprocessor identifier.
    
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit b717e21c49b783a1c2065a1179e2741e1096424b
Author: Andrew Morton <akpm@osdl.org>
Date:   Tue Jun 8 18:18:42 2004 -0700

    [PATCH] fix uts sysctl write size
    
    From: Andy Whitcroft <apw@shadowen.org>
    
    The sysctl interfaces for updating the uts entries such as hostname and
    domainname are using the wrong length for these buffers; they are hard
    coded to 64.  Although safe, this artifically limits the size of these
    fields to one less than the true maximum.  This generates an inconsistency
    between the various methods of update for these fields.
    
    # hostname 12345678901234567890123456789012345678901234567890123456789012345
    hostname: name too long
    # hostname 1234567890123456789012345678901234567890123456789012345678901234
    # hostname
    1234567890123456789012345678901234567890123456789012345678901234
    
    # sysctl -w kernel.hostname=1234567890123456789012345678901234567890123456789012345678901234567890
    kernel.hostname = 1234567890123456789012345678901234567890123456789012345678901234567890
    # hostname
    123456789012345678901234567890123456789012345678901234567890123
    #
    
    The error originates from the fact the handler for strings (proc_dostring)
    already allows for the string terminator.  This patch corrects the limit,
    taking the oppotunity to convert to use of sizeof().
    
    Signed-off-by: Andy Whitcroft <apw@shadowen.org>
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit 98218e92ae6a3dee34421dcb354e5540cb0cdc05
Author: Andrew Morton <akpm@osdl.org>
Date:   Tue Jun 8 18:18:31 2004 -0700

    [PATCH] cyclone: PIT sanity checking
    
    From: john stultz <johnstul@us.ibm.com>
    
    In testing for SLES9, we ran across a bug caused by userspace apps poking
    the PIT which caused bad values to be read by the kernel.  This would then
    trigger the lost tick detection code with insane values and would then
    break the SCSI subsystem.
    
    This patch includes the PIT sanity check from the TSC timesource into the
    cyclone timesource code, which catches the bad case described above and
    resolves the issue.
    
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit 515f9252f6c004a1b5b34554e40efaa60379565c
Author: Andrew Morton <akpm@osdl.org>
Date:   Tue Jun 8 18:18:20 2004 -0700

    [PATCH] flush_workqueue locking simplification
    
    From: "Anil" <anil.s.keshavamurthy@intel.com>
    
    We don't need lock_cpu_hotplug()/unlock_cpu_hotplug for singlethreaded
    workqueues.
    
    Signed-off-by: Anil Keshavamurthy <anil.s.keshavamurthy@intel.com>
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit f1b2f7fff5c6e2d784f3f930e11c6bc980613bb0
Author: Andrew Morton <akpm@osdl.org>
Date:   Tue Jun 8 18:18:10 2004 -0700

    [PATCH] s390: add support for 6 system call arguments (FUTEX_CMP_REQUEUE)
    
    From: Martin Schwidefsky <schwidefsky@de.ibm.com>
    
    This patch adds support for 6 system call arguments on s390.  The first
    exploiter of this will be the sys_futex system call for the
    FUTEX_CMP_REQUEUE operation.  The idea is simple: use register %r7 for the
    6th argument.  This can be extended to 7/8/9/...  arguments if there ever
    will be the need for it.  To call the system call function in the kernel
    the additional arguments needs to get stored on the stack.  8 bytes are
    added to the head of struct pt_regs.  %r7 is stored to the additional field
    for all system calls.  The store is hidden in a
    address-generation-interlock slot, it doesn't slow down the system call
    path.
    
    Signed-off-by: Martin Schwidefsky <schwidefsky@de.ibm.com>
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit a57867c3752064d8e9817daabe3ba098c3d93147
Author: Andrew Morton <akpm@osdl.org>
Date:   Tue Jun 8 18:17:58 2004 -0700

    [PATCH] cdrom hardware defect mgt header length
    
    From: Jens Axboe <axboe@suse.de>
    
    cdrom_has_defect_mgt() has the same ->data_len bug - the length field is
    not total length, but the length following that field.  So it should be +
    4, not + 8.  However, just kill the length check.  Comparison of
    feature_code provides enough check.
    
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit 7b6bc1f8b6a92ad77d8859374a5c1c2fee0b74f8
Author: Andrew Morton <akpm@osdl.org>
Date:   Tue Jun 8 18:17:47 2004 -0700

    [PATCH] md: fix BUG in raid6 resync code.
    
    From: NeilBrown <neilb@cse.unsw.edu.au>
    
    This condtion on this loop is primarily to avoid the loop if it doesn't
    appear to be needed.  However it optimises a little too much and there is a
    case where it skips the loop when it is really needed.  This patch fixes
    it.
    
    This is the raid6 version of the recent raid5 resync bugfix.
    
    Signed-off-by: Neil Brown <neilb@cse.unsw.edu.au>
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit 057e4132861a7c1f8b931c5dce1f3c22228cfc56
Author: Andrew Morton <akpm@osdl.org>
Date:   Tue Jun 8 18:17:36 2004 -0700

    [PATCH] __ARCH_WANT_SYS_RT_SIGACTION fix
    
    From: Ivan Kokshaysky <ink@jurassic.park.msu.ru>
    
    Recent syscall stubs cleanup broke alpha, as it has its own version of
    sys_rt_sigaction().  This defines __ARCH_WANT_SYS_RT_SIGACTION for all
    architectures except alpha, sparc and sparc64.
    
    Signed-off-by: Ivan Kokshaysky <ink@jurassic.park.msu.ru>
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit dbe48e4507bcfff88e24d3f57bb4e36b6955eaab
Author: Andrew Morton <akpm@osdl.org>
Date:   Tue Jun 8 18:17:24 2004 -0700

    [PATCH] Disable UDF debugging
    
    From: Andi Kleen <ak@suse.de>
    
    UDF spews out lots of debugging information by default.  Disable that,
    since it doesn't make too much sense for a production kernel.
    
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit fa0389db159ed0702925a6cc891cfc3bce9d5e2b
Author: Andrew Morton <akpm@osdl.org>
Date:   Tue Jun 8 18:17:13 2004 -0700

    [PATCH] Remove unnecessary printk in es7000 code
    
    From: Andi Kleen <ak@suse.de>
    
    This printk is printed by genericarch when your machine is no es7000.  Most
    people don't care about that.  Remove it.
    
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit 48f8d35183cadcbcebeabdc19129c2738d19054b
Author: Andrew Morton <akpm@osdl.org>
Date:   Tue Jun 8 18:17:02 2004 -0700

    [PATCH] more drivers/atm/horizon.c polishing
    
    From: Francois Romieu <romieu@fr.zoreil.com>
    
    - just say no to numbered labels;
    - pci_enable_device can fail so setup_pci_dev() must return a value;
    - propagate existing error codes when possible in do_pci_device()
    - missing pci_disable_device here and there.
    
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit 4d8f6a56d6d49ccf04a79684b42306ba685041b4
Author: Andrew Morton <akpm@osdl.org>
Date:   Tue Jun 8 18:16:51 2004 -0700

    [PATCH] Typo in Documentation/fb/framebuffer.txt
    
    From: Peter Korsgaard <jacmet@sunsite.dk>
    
    Vertical retrace is in lines, not pixels.
    
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit b7d41b55f1848ac1dab59d1ea80366dcbac83bb0
Author: Andrew Morton <akpm@osdl.org>
Date:   Tue Jun 8 18:16:40 2004 -0700

    [PATCH] ext3: journal_flush() needs journal_lock_updates()
    
    We need to take journal_lock_updates() while remounting r/o to prevent a new
    transaction starting while journal_flush() is running.
    
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit 85aeb8a6afef5cf68538c159bf43a6a0607441a3
Author: Andrew Morton <akpm@osdl.org>
Date:   Tue Jun 8 18:16:28 2004 -0700

    [PATCH] runtime selection of CONFIG_PARIDE_EPATC8
    
    From: Christoph Hellwig <hch@lst.de>
    
    drivers/block/paride/epat.c support two slightly different protocol
    variants.  Currently it's compile-time selected by CONFIG_PARIDE_EPATC8,
    but this patch adds a epatc8 module option to allow runtime selection.
    CONFIG_PARIDE_EPATC8 stays for now but I'd like to kill it int 2.7.
    
    The basic patch is from the Debian kernel package (Author unknown) but I
    reworked it a bit.
    
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit 03a6103245d32ba8ce662eab6bc7b371eccada5b
Author: Andrew Morton <akpm@osdl.org>
Date:   Tue Jun 8 18:16:17 2004 -0700

    [PATCH] unalign struct page_state
    
    The ____cacheline_aligned in there is a leftover from before the existence of
    the percpu infrastructure.  It bloats struct page_state and structures which
    contain it enormously, and we use these things on the stack deep in page
    reclaim.
    
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit 7052fc2b6b8167ebdb35b58266089ac869f88454
Author: Andrew Morton <akpm@osdl.org>
Date:   Tue Jun 8 18:16:06 2004 -0700

    [PATCH] writeback_inodes can race with unmount
    
    From: Chris Mason <mason@suse.com>
    
    There's a small window where the filesystem can be unmounted during
    writeback_inodes.  The end result is the iput done by sync_sb_inodes could
    be done after the FS put_super and and the super has been removed from all
    lists.
    
    The fix is to hold the s_umount sem during sync_sb_inodes to make sure
    the FS doesn't get unmounted.
    
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit 9c6b3b51c651986645a2724999cd78464370725e
Author: Andrew Morton <akpm@osdl.org>
Date:   Tue Jun 8 18:15:55 2004 -0700

    [PATCH] ppc64: iSeries vio_dev cleanups
    
    From: Stephen Rothwell <sfr@canb.auug.org.au>
    
    This patch removes the archdata and driver_data members of struct vio_dev
    and uses the platform_data and driver_data members of the embedded struct
    device instead.  I also declared a couple of routines static.
    
    This is part of a work in progress.
    
    Signed-off-by: Stephen Rothwell <sfr@canb.auug.org.au>
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit 4db61881f463ba20b0d37f406147785f3e169164
Author: Andrew Morton <akpm@osdl.org>
Date:   Tue Jun 8 18:15:44 2004 -0700

    [PATCH] ppc32: fix missing option in binutils version check
    
    From: Olaf Hering <olh@suse.de>
    
    The binutils check is bogus, it doesnt work with the just released
    binutils.  A space is needed in the error message.
    
    pomegranate:~# echo dssall | /usr/bin/as -o /tmp/x
    {standard input}: Assembler messages:
    {standard input}:1: Error: Unrecognized opcode: `dssall'
    pomegranate:~# /usr/bin/as -v
    GNU assembler version 2.15.91.0.1 (powerpc-suse-linux) using BFD version 2.15.91.0.1 20040527 (SuSE Linux)
    
    *** 2.6 kernels no longer buildcorrectly with old versions of binutils.
    *** Please upgrade your binutils to 2.12.1 or newer
    make: *** [checkbin] Error 1
    make: Target `all' not remade because of errors.
    
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit 499e2d446f2387894aa334d530c6975c2cb3689f
Author: Andrew Morton <akpm@osdl.org>
Date:   Tue Jun 8 18:15:33 2004 -0700

    [PATCH] speedup flush_workqueue for singlethread_workqueue
    
    From: "Anil" <anil.s.keshavamurthy@intel.com>
    
    In flush_workqueue() for a single_threaded_worqueue case the code flushes the
    same cpu_workqueue_struct for each online_cpu.
    
    Change things so that we only perform the flush once in this case.
    
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit ace476bba6183834fa69451ac052708c012a2203
Author: Andrew Morton <akpm@osdl.org>
Date:   Tue Jun 8 18:15:22 2004 -0700

    [PATCH] jbd: descriptor buffer state fix
    
    Fix a problem discovered by Jeff Mahoney <jeffm@suse.com>, based on an initial
    patch from Chris Mason <mason@suse.com>.
    
    journal_get_descriptor_buffer() is used to obtain a regular old buffer_head
    against the blockdev mapping.  The caller will populate that bh by hand and
    will then submit it for writing.
    
    But there are problems:
    
    a) The function sets bh->b_state nonatomically.  But this buffer is
       accessible to other CPUs via pagecache lookup.
    
    b) The function sets the buffer dirty and then the caller populates it and
       then it is submitted for I/O.  Wrong order: there's a window in which the
       VM could write the buffer before it is fully populated.
    
    c) The function fails to set the buffer uptodate after zeroing it.  And one
       caller forgot to mark it uptodate as well.  So if the VM happens to decide
       to write the containing page back __block_write_full_page() encounters a
       dirty, not uptodate buffer, which is an illegal state.  This was generating
       buffer_error() warnings before we removed buffer_error().
    
       Leaving the buffer not uptodate also means that a concurrent reader of
       /dev/hda1 could cause physical I/O against the buffer, scribbling on what
       we just put in it.
    
       So journal_get_descriptor_buffer() is changed to mark the buffer
       uptodate, under the buffer lock.
    
    I considered changing journal_get_descriptor_buffer() to return a locked
    buffer but there doesn't seem to be a need for this, and both callers end up
    using ll_rw_block() anyway, which requires that the buffer be unlocked again.
    
    Note that the journal_get_descriptor_buffer() callers dirty these buffers with
    set_buffer_dirty().  That's a bit naughty, because it could create dirty
    buffers against a clean page - an illegal state.  They really should use
    mark_buffer_dirty() to dirty the page and inode as well.  But all callers will
    immediately write and clean the buffer anyway, so we can safely leave this
    optimising cheat in place.
    
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit 669be61fe5e5c6caf357103853c922156a271fb6
Author: Andrew Morton <akpm@osdl.org>
Date:   Tue Jun 8 18:15:10 2004 -0700

    [PATCH] wake_up_forked_thread() fix
    
    Spotted by Randy Dunlap - don't try to return something from a void-returning
    function.
    
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit 3c68d090d88867fedd87bc3d5d28a587b22f0ac9
Merge: 2e5ae68... 295b4cb...
Author: David S. Miller <davem@nuts.davemloft.net>
Date:   Tue Jun 8 08:33:40 2004 -0700

    Merge nuts.davemloft.net:/disk1/BK/sparcwork-2.6
    into nuts.davemloft.net:/disk1/BK/sparc-2.6

commit 295b4cb6c6cf36d8a76ae85102571c4d66af6a03
Author: David S. Miller <davem@nuts.davemloft.net>
Date:   Tue Jun 8 08:30:03 2004 -0700

    [SPARC64]: Uninline find_*_bit() like ia64 did.

commit 2e5ae683399600f18c8ec1f473ce902241ff7247
Merge: efc8618... f7979e5...
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Tue Jun 8 07:15:07 2004 -0700

    Merge bk://bk.arm.linux.org.uk/linux-2.6-serial
    into ppc970.osdl.org:/home/torvalds/v2.6/linux

commit f7979e50ddabbecfe1520b944253ff00d3f228d9
Author: Ben Dooks <ben-linux@org.rmk.(none)>
Date:   Wed Jun 9 01:53:39 2004 +0100

    [ARM PATCH] 1919/1: S3C2410 - Serial configuration bugfix (missing SERIAL_CORE_CONSOLE)
    
    Patch from Ben Dooks
    
    Fix missing select of SERIAL_CORE_CONSOLE when selecting the
    S3C2410 serial console support with no other serial console
    selected

commit efc861825ee2e6308af66d63fedf29a2f38c952f
Merge: 2a310a3... b802bd8...
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Tue Jun 8 07:13:24 2004 -0700

    Merge bk://bk.arm.linux.org.uk/linux-2.6-rmk
    into ppc970.osdl.org:/home/torvalds/v2.6/linux

commit b802bd8ca2d5e98e3762dce0eea8af77b80aa649
Author: Marc Singer <elf@com.rmk.(none)>
Date:   Wed Jun 9 02:11:45 2004 +0100

    [ARM PATCH] 1916/1: lh7a40x #5 (1/1) revision B support
    
    Patch from Marc Singer
    
    Small change to support revision B Card Engines.

commit 4bb48aad2b73d4121ef4e3004fce3d54938bf4e5
Author: Marc Singer <elf@com.rmk.(none)>
Date:   Wed Jun 9 02:07:30 2004 +0100

    [ARM PATCH] 1915/1: lh7a40x #4 (1/1) hardware.h bug fix
    
    Patch from Marc Singer
    
    This patch corrects a bug in the register access macros for 16 and 8
    bit accesses.  It also updates the default configuration files for the
    2.6.7 kernel.

commit 09e209dd7a00ac73a09c6267a8a7f32dea7870ae
Author: Ben Dooks <ben-linux@org.rmk.(none)>
Date:   Wed Jun 9 02:03:10 2004 +0100

    [ARM PATCH] 1920/1: S3C2410 - register definition fix
    
    Patch from Ben Dooks
    
    Fix for multiple definition of the same item in the GPIO and IRQ
    register includes

commit 32e5fcaa6619169d447db9fe6dc577278be5fd9b
Author: Anton Altaparmakov <aia21@cantab.net>
Date:   Tue Jun 8 13:36:54 2004 +0100

    NTFS: 2.1.13 - Enable overwriting of resident files and housekeeping of system files.
    - Mark the volume dirty when (re)mounting read-write and mark it clean
      when unmounting or remounting read-only.  If any volume errors are
      found, the volume is left marked dirty to force chkdsk to run.
    - Add code to set the NT4 compatibility flag when (re)mounting
      read-write for newer NTFS versions but leave it commented out for now
      since we do not make any modifications that are NTFS 1.2 specific yet
      and since setting this flag breaks Captive-NTFS which is not nice.
      This code must be enabled once we start writing NTFS 1.2 specific
      changes otherwise Windows NTFS driver might crash / cause corruption.
    - Fix a silly bug that caused a deadlock in ntfs_mft_writepage().
      For inode 0, i.e. $MFT itself, we cannot use ilookup5() from
      there because the inode is already locked by the kernel
      (fs/fs-writeback.c::__sync_single_inode()) and ilookup5() waits
      until the inode is unlocked before returning it and it never gets
      unlocked because ntfs_mft_writepage() never returns.  )-:
      Fortunately, we have inode 0 pinned in icache for the duration
      of the mount so we can access it directly.
    
    Signed-off-by: Anton Altaparmakov <aia21@cantab.net>

commit ec479b0314077cc9602b52eadcaf4a333c4cea17
Merge: 7510c43... 686b4f3...
Author: Anton Altaparmakov <aia21@cantab.net>
Date:   Tue Jun 8 11:06:07 2004 +0100

    Merge cantab.net:/home/src/ntfs-2.6
    into cantab.net:/home/src/ntfs-2.6-devel

commit 2a310a3b9a9f3f84f283883a703e9d858e9689e1
Merge: 03a449e... 056d7d3...
Author: Linus Torvalds <torvalds@evo.osdl.org>
Date:   Tue Jun 8 00:18:34 2004 -0700

    Merge bk://linux-mtd.bkbits.net/sbc8260-2.6
    into evo.osdl.org:/home/torvalds/v2.6/linux

commit 03a449eaa6692295185ef6946d2ad6af98060771
Merge: 3c146e8... 852e225...
Author: David Woodhouse <dwmw2@dwmw2.baythorne.internal>
Date:   Tue Jun 8 21:55:14 2004 +0100

    Merge linux-mtd@bkbits.net:sbc8260-2.6
    into dwmw2.baythorne.internal:/inst/bk/sbc8260-2.6

commit 3c146e8d99310966728e293ecba998f54fc660a4
Author: David Woodhouse <dwmw2@dwmw2.baythorne.internal>
Date:   Tue Jun 8 21:47:33 2004 +0100

    Add WindRiver PowerQUICC II flash map driver

commit fe5d106d42566af4a5047e3853372f72c906b2b5
Author: David Woodhouse <dwmw2@dwmw2.baythorne.internal>
Date:   Tue Jun 8 21:46:28 2004 +0100

    Wind River PowerQUICC II SBC82xx update:
     - Switch to using u-boot bdinfo.
     - Set up CS11 for RTC if the bootloader didn't bother.
     - Set BOOTROM_RESTART_ADDR so machine_restart() actually works.
     - For non-uboot boot, note bus clock is 66MHz on 8265 model.

commit 0a4948e3f752ea29e847deda0ac61c5b52a52563
Merge: e0ec03f... 369a536...
Author: David Woodhouse <dwmw2@dwmw2.baythorne.internal>
Date:   Tue Jun 8 20:55:07 2004 +0100

    Merge linux-mtd@bkbits.net:sbc8260-2.6
    into dwmw2.baythorne.internal:/inst/bk/sbc8260-2.6

commit 056d7d3a6d66660252a90bc07bb866d7496873fa
Author: David Howells <dhowells@redhat.com>
Date:   Mon Jun 7 22:10:44 2004 -0700

    [PATCH] Fix semaphore downgrade_write()
    
    Stop downgrade_write() from under-adjusting the rwsem counter in optimised
    rw-semaphores.
    
    Signed-off-by: David Howells <dhowells@redhat.com>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit 94753ee254f7524e410c3eb5691a7e6062aba29c
Merge: 8db35b8... 9499310...
Author: Linus Torvalds <torvalds@evo.osdl.org>
Date:   Mon Jun 7 21:51:17 2004 -0700

    Merge bk://gkernel.bkbits.net/net-drivers-2.6
    into evo.osdl.org:/home/torvalds/v2.6/linux

commit 8db35b85975b8cc1e1e8c93a67f3d1fd936b62f4
Author: Jesse Brandeburg <jesse.brandeburg@intel.com>
Date:   Tue Jun 8 06:36:38 2004 -0400

    [PATCH] e1000: fix napi crash on ifdown during traffic
    
    Signed off by: Jesse Brandeburg

commit 86b148ceb38f73070f6a4b4041b3b5fcce95e1d2
Author: Andrew Morton <akpm@osdl.org>
Date:   Tue Jun 8 06:33:48 2004 -0400

    [PATCH] Fix tulip deadlocks on device removal
    
    From: Carl-Daniel Hailfinger <c-d.hailfinger.kernel.2004@gmx.net>
    
    Handle going-away devices.

commit aa8c20c244947efd8197a21dbc1603e373c6b89a
Author: Herbert Xu <herbert@gondor.apana.org.au>
Date:   Tue Jun 8 06:32:21 2004 -0400

    [PATCH] Fixed MCA resource bugs in at1700
    
    This patch fixes an incorrect MCA check as well as a leak on probe
    failure in at1700.

commit a7ec2bbb6599b3338f820c0271b46bb01765044e
Author: Herbert Xu <herbert@gondor.apana.org.au>
Date:   Tue Jun 8 06:32:12 2004 -0400

    [PATCH] Fix netdev leak on probe failure in 3c527
    
    This patch frees the netdev on failure in mc32_probe in 3c527.

commit 06d26886f721afe4a698af1acf88d36c6286d681
Author: Alan Cox <alan@redhat.com>
Date:   Tue Jun 8 06:11:12 2004 -0400

    [PATCH] epic100 fixes
    
    "Gee it works better if you turn the chip on before programming it"
    
    The ioctl to ethtool change broke that little detail...
    
    
    I made the changes, Jeff agreed in principle, Red Hat owns them and I know
    no reason they can't be contributed under the GPL v2 or later.
    
    Requires: ethtool change

commit 263aa1575dfb12535b19eae8a9a649a84fe5cd03
Author: Alan Cox <alan@redhat.com>
Date:   Tue Jun 8 06:11:04 2004 -0400

    [PATCH] ethtool power manglement hooks
    
    Several ethernet drivers have been broken by the ethtool support because
    the ioctl code used to power the interface up and down as needed. Rather
    than add this to each driver call Jeff Garzik suggested we add hooks
    for before/after ethtool processing.
    
    This patch implements them which makes fixing the PM stuff easier,
    as the epic100 patch to follow will show. It also cleans up the
    via-velocity driver pm/ethtool logic a great deal. As per Jeff's
    request the before handler is allowed to fail the operation.
    
    --
    
    The contribution herein included is a creation of Red Hat Inc. It is hereby
    submitted under the license of the existing files and as a derivative work
    thereof. I know of no reason for not having the right to submit the
    work herein included.
    
    (Bluff your way in legalese ;))

commit 852e225dfccfcd8c48fdb956de23fb7db5130721
Merge: e0ec03f... 9499310...
Author: David Woodhouse <linux-mtd.adm@hostme.bitkeeper.com>
Date:   Mon Jun 7 21:51:14 2004 -0700

    Merge http://linux.bkbits.net/linux-2.6
    into hostme.bitkeeper.com:/repos/l/linux-mtd/sbc8260-2.6

commit 94993109eaa6b353e29b29f71927c05e4cc02fa4
Author: Michael Hunold <hunold@convergence.de>
Date:   Mon Jun 7 21:31:45 2004 -0700

    [PATCH] Make tda1004x DVB frontend driver work again
    
    Adrian Bunk noticed that the tda1004x DVB frontend driver was broken and
    sent a small patch that at least made the driver work again.
    
    There was a discussion afterwards about the kernel syscall interface,
    but at the end, the tda1004x DVB frontend driver is still non-functional.
    
    This re-applies the temporary band-aid.

commit ce0025ebbefb4be36cdf6782b0127e7dca0fab3d
Merge: d8c2ddb... 369a536...
Author: Steve French <cifs.adm@hostme.bitkeeper.com>
Date:   Mon Jun 7 20:47:04 2004 -0700

    Merge bk://linux.bkbits.net/linux-2.5
    into hostme.bitkeeper.com:/repos/c/cifs/linux-2.5cifs

commit 369a536059fec1a6eef8d7e91cee4f0e9cff7b7b
Author: Paul Mackerras <paulus@samba.org>
Date:   Mon Jun 7 19:27:15 2004 -0700

    [PATCH] Make paca xCurrent field be a pointer
    
    The paca struct contains a pointer to the current task, which is used
    for the `current' macro.  For some reason, this field is a u64, and
    every time we use it we need a cast, because it is really a pointer.
    This patch cleans things up a little by making it a pointer to struct
    task_struct and removing the casts.  It also removes a now-incorrect
    comment which said that r13 contains current (it now holds
    &paca[smp_processor_id()]).
    
    Signed-off-by: Paul Mackerras <paulus@samba.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit eb18549a95857c00bfade5dc0ee672f4e6d94c5d
Author: Paul Mackerras <paulus@samba.org>
Date:   Mon Jun 7 19:27:01 2004 -0700

    [PATCH] Single-stepping emulated instructions
    
    Occasionally the ppc64 kernel emulates a usermode instruction, for
    example in the alignment exception handler.  Kumar Gala pointed out
    (in the context of the ppc32 kernel) that if the instruction was being
    single-stepped, and we end up emulating the instruction, we should
    then send the process a SIGTRAP as if it had not been emulated and the
    process had then taken a single-step exception.  This patch implements
    this for ppc64.
    
    Signed-off-by: Paul Mackerras <paulus@samba.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit f89b51273ef6fb50874b3f2ae5bdcceb1f9b7a8b
Merge: 131ee77... edc3435...
Author: Linus Torvalds <torvalds@evo.osdl.org>
Date:   Mon Jun 7 17:57:50 2004 -0700

    Merge bk://kernel.bkbits.net/davem/net-2.6
    into evo.osdl.org:/home/torvalds/v2.6/linux

commit 131ee776e36a8f67628093aa88e4eeeff5764993
Merge: a6df4e9... 686b4f3...
Author: Linus Torvalds <torvalds@evo.osdl.org>
Date:   Mon Jun 7 17:55:45 2004 -0700

    Merge bk://kernel.bkbits.net/gregkh/linux/usb-fix-2.6
    into evo.osdl.org:/home/torvalds/v2.6/linux

commit d8c2ddb6a729af7dea392cc724b3dcbfef0a87fe
Author: Steve French <stevef@smfhome1.smfdom>
Date:   Mon Jun 7 13:01:51 2004 -0500

    handle partial page update of page in cache that is not uptodate better for the situation in which file is open writeonly
    
    Signed-off-by: Steve French <sfrench@us.ibm.com>

commit e22fe382565235d3b753094b8993004924a946d8
Author: Steve French <stevef@smfhome1.smfdom>
Date:   Mon Jun 7 12:13:21 2004 -0500

    Make stats display more consistent - under /proc/fs/cifs/Stats
    
    Signed-off-by: Steve French <sfrench@us.ibm.com>

commit edc3435b95e4c01a5c055f6231334b338ab8388d
Merge: 686b4f3... e3e77f6...
Author: David S. Miller <davem@kernel.bkbits.net>
Date:   Mon Jun 7 05:09:16 2004 -0700

    Merge davem@nuts.davemloft.net:/disk1/BK/net-2.6
    into kernel.bkbits.net:/home/davem/net-2.6

commit 7510c432947727284efdd1b0f5314507a15f4ec2
Author: Anton Altaparmakov <aia21@cantab.net>
Date:   Mon Jun 7 12:40:50 2004 +0100

    NTFS: Add functions ntfs_{clear,set}_volume_flags(), to modify the volume
          information flags (fs/ntfs/super.c).
    
    Signed-off-by: Anton Altaparmakov <aia21@cantab.net>

commit b9f261803dab8a2bf03e7f432b644b92ff977369
Merge: 08bcc57... 7b0f923...
Author: Anton Altaparmakov <aia21@cantab.net>
Date:   Mon Jun 7 11:43:59 2004 +0100

    Merge cantab.net:/home/src/ntfs-2.6
    into cantab.net:/home/src/ntfs-2.6-devel

commit b20b5ee3ba3739ec5a4ab37d1da5a7805f1c733f
Merge: 665ef08... 686b4f3...
Author: Steve French <cifs.adm@hostme.bitkeeper.com>
Date:   Mon Jun 7 03:06:33 2004 -0700

    Merge bk://linux.bkbits.net/linux-2.5
    into hostme.bitkeeper.com:/repos/c/cifs/linux-2.5cifs

commit 665ef08167cafbde73f57371f3c60e4c76913005
Author: Steve French <stevef@stevef95.austin.ibm.com>
Date:   Mon Jun 7 08:02:58 2004 -0500

    fix up whitespace
    
    Signed-off-by: Steve French <sfrench@us.ibm.com>

commit dbc2f1029635d6a7436f49c8c432e43cf026a118
Author: Steve French <stevef@stevef95.austin.ibm.com>
Date:   Mon Jun 7 07:14:26 2004 -0500

    Add 2 missing kmalloc failure checks during cifs mount time
    
    Signed-off-by: Yury Umanets <torque@ukrpost.net>
    Signed-off-by: Steve French <sfrench@us.ibm.com>

commit f2ba8b3cf3f0557c0fdb756f75267573bd287d72
Author: Steve French <stevef@stevef95.austin.ibm.com>
Date:   Mon Jun 7 05:33:40 2004 -0500

    Fix race in updating tcpStatus field

commit e3e77f6e1974880c44f8c9023b98ccee9f263097
Author: David S. Miller <davem@nuts.davemloft.net>
Date:   Mon Jun 7 02:21:38 2004 -0700

    [NETFILTER]: Put arpt_mutex back into arp_tables.c

commit 81cfe91210a288b8a8ebfeab13f097d26d283d64
Author: Stephen Hemminger <shemminger@osdl.org>
Date:   Mon Jun 7 01:28:12 2004 -0700

    [TCP]: Add receive DRS info to tcp_info.

commit 66b992e8980e74a23edcff47155fd886c62c417a
Author: Stephen Hemminger <shemminger@osdl.org>
Date:   Mon Jun 7 01:27:26 2004 -0700

    [TCP]: Update tcp_get_info() comments in net/tcp.h

commit a6df4e9c07695c3dc62d52bdc4030315ef05ca1b
Author: Duncan Sands <baldrick@free.fr>
Date:   Mon Jun 7 00:21:48 2004 -0700

    [PATCH] USB devio.c: deadlock fix
    
    proc_resetdevice is called with dev->serialize held.
    usb_reset_device takes dev->serialize and then calls
    __usb_reset_device.  To avoid deadlock, proc_resetdevice
    should call __usb_reset_device directly.
    
    Signed-off-by: Duncan Sands <baldrick@free.fr>
    Signed-off-by: Greg Kroah-Hartman <greg@kroah.com>

commit 686b4f3399e5c57651e182f5717af1fc26a39767
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon Jun 7 00:14:47 2004 -0700

    [PATCH] i386 defconfig update
    
    Updates i386 defconfig.  I simply ran `make oldconfig' and selected `m' where
    it was available, otherwise `y'.
    
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit e3d0c70343b6e776cd54b794a08713d463dd94b2
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon Jun 7 00:14:37 2004 -0700

    [PATCH] make buildcheck missing hunk
    
    Forgot to update the top-level makefile to invoke the new reference_init
    script.
    
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit 5bdcd0d5a771ddff271e0f0c08367b32c51dbd8c
Author: Kai Engert <kaie@kuix.de>
Date:   Mon Jun 7 00:08:08 2004 -0700

    [PATCH] USB: enable pwc usb camera driver
    
    The attached patch enables the pwc driver included with kernel 2.6.7-rc2
    
    It also removes the warnings during compilation.
    However, note that I blindly duplicated the release approach used by
    other usb camera drivers, replacing the current no-op.
    
    The driver works for me with a Logitech QuickCam Notebook Pro and
    GnomeMeeting.
    
    
    Signed-off-by: Greg Kroah-Hartman <greg@kroah.com>

commit 08786bea7adf68289deda544de6cad77051c5fe4
Author: Siegfried Hildebrand <siegfried.hildebrand@fernuni-hagen.de>
Date:   Mon Jun 7 00:05:59 2004 -0700

    [PATCH] USB: Fix problems with cyberjack usb-serial-module since kernel 2.6.2
    
    > Send me a patch to back those changes out to fix your device and I'll
    > apply it.  If the author is around to realize this, that should wake
    > them up :)
    
    Ok, here you are! :)
    Attached is a patch for linux-2.6.7-rc2. (though the patch hasn't changed
    since -rc1)
    
    Again a short description:
    (the patch removes most of the changes done in linux-2.6.2)
    1. Removed the local buffer of cyberjack_write, because something goes wrong
    upon a write-request bigger than the buffer. Without this, a write-request
    stalls with error -3.
    2. Removed some usb_clear_halt() lines. Without this, the device doesn't even
    open and returns -7.
    
    It works for my cyberjack pinpad USB card reader on
    - nforce2 chipset
    - VIA KM266 chipset
    - AMD Irongate chipset
    
    Signed-off-by: Greg Kroah-Hartman <greg@kroah.com>

commit 90dedc170f98c16894ab4c1b2828a4b179220d92
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Sun Jun 6 22:08:04 2004 -0700

    Linux 2.6.7-rc3

commit 501a969304c6692cbbc3be8ce9df5fe069c71a85
Author: Vojtech Pavlik <vojtech@suse.cz>
Date:   Mon Jun 7 16:56:10 2004 +0200

    input: Exclude tasklet changes to i8042.c
    
    Signed-off-by: Vojtech Pavlik <vojtech@suse.cz>

commit 1e12aaf08fb1712963a4ac7c8e0ae261ab86bb82
Merge: 7b0f923... 56b3ffe...
Author: Vojtech Pavlik <vojtech@suse.cz>
Date:   Mon Jun 7 15:58:20 2004 +0200

    Merge suse.cz:/home/vojtech/bk/linus
    into suse.cz:/home/vojtech/bk/for-linus

commit ff3c0388c29a85e05f177dd9df658d5e1537ece6
Merge: 6ecc87a... 501a969...
Author: Steve French <cifs.adm@hostme.bitkeeper.com>
Date:   Sun Jun 6 20:16:34 2004 -0700

    Merge bk://linux.bkbits.net/linux-2.5
    into hostme.bitkeeper.com:/repos/c/cifs/linux-2.5cifs

commit 7b0f9236942c0609a752a89f3f02d211c7541d44
Merge: 4ec3792... 55a92a2...
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Sun Jun 6 06:43:33 2004 -0700

    Merge bk://kernel.bkbits.net/davem/sparc-2.6
    into ppc970.osdl.org:/home/torvalds/v2.6/linux

commit 4ec3792aed67a88f4b57b69be9e520ab176fdfe0
Merge: b9371f4... 90ff6d1...
Author: David S. Miller <davem@kernel.bkbits.net>
Date:   Sun Jun 6 06:29:56 2004 -0700

    Merge davem@nuts.davemloft.net:/disk1/BK/net-2.6
    into kernel.bkbits.net:/home/davem/net-2.6

commit 90ff6d1c20cbe1ac5496f32e4952ed490c78efed
Author: Jamal Hadi Salim <hadi@zynx.com>
Date:   Sun Jun 6 06:15:18 2004 -0700

    [NETFILTER]: Small cleanup for {ipt,ip6t,arpt}_find_target
    
    Signed-off-by: Jamal Hadi Salim <hadi@zynx.com>
    Signed-off-by: David S. Miller <davem@redhat.com>

commit 55a92a2bbd294863d2b820816ac1cfb40eafddae
Author: Adam Kropelin <akropel1@rochester.rr.com>
Date:   Sun Jun 6 05:59:45 2004 -0700

    [FB]: Fix uninitialized fb_cmap member in sbuslib.c
    
    When handling FBIOPUTCMAP_SPARC, sbusfb fails to initialize cmap.transp,
    which quickly leads to an oops when fb_set_cmap() dereferences it.
    
    First encountered in Aurora Wombat kernels and seems to afflict mainline
    as well. Patch is against 2.6.7-rc2. xorg still fails to actually get
    anything to display on my CG6, but at least it no longer oopses the kernel.
    
    Signed-off-by: Adam Kropelin <akropel1@rochester.rr.com>
    Signed-off-by: David S. Miller <davem@redhat.com>

commit b9371f43de1086ab8103af8017a3d323f47d463c
Merge: 31c577a... 56e4943...
Author: David S. Miller <davem@kernel.bkbits.net>
Date:   Sun Jun 6 05:45:43 2004 -0700

    Merge davem@nuts.davemloft.net:/disk1/BK/net-2.6
    into kernel.bkbits.net:/home/davem/net-2.6

commit 56e4943c605ef615ae8948953e9f6bbf60abf74e
Author: David S. Miller <davem@nuts.davemloft.net>
Date:   Sun Jun 6 05:40:21 2004 -0700

    [TCP]: Need tcp_get_info decl in net/tcp.h

commit 31c577a150b2778eb550fe1ec8b42d229cb01a70
Merge: fddf736... 1a6cd0c...
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Sun Jun 6 02:31:43 2004 -0700

    Merge bk://bk.arm.linux.org.uk/linux-2.6-rmk
    into ppc970.osdl.org:/home/torvalds/v2.6/linux

commit 1a6cd0c91f6b913908d37f815de35e5e3f411f47
Author: Russell King <rmk@flint.arm.linux.org.uk>
Date:   Sun Jun 6 21:56:06 2004 +0100

    [ARM] Update mach-types.

commit 946d786fb4daa94325233526f4d6acf3bfed79ba
Author: Russell King <rmk@flint.arm.linux.org.uk>
Date:   Sun Jun 6 21:51:46 2004 +0100

    [ARM] Uninline flush_dcache_page()

commit fddf7361101b2c61857ddf81e9ce0fc1c47e05af
Author: Dave Jones <davej@redhat.com>
Date:   Sun Jun 6 01:04:20 2004 -0700

    [PATCH] Fix missing padding in DMI table.
    
    This entry in the DMI blacklist table is missing it's NO_MATCH
    tags, which means the struct gets padded instead of filled with
    the desired NO_MATCH data which is {255, NULL}
    
    Usually not fatal it seems, but there have been numerous cases
    in Red Hat bugzilla where this did get tripped up, and caused
    an immediate reset on these boards. Not fun to track down.
    
    Signed-off-by: Dave Jones <davej@redhat.com>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit 62b748c1ad5014fdbf9952b0fc2f64c1b4fdec7e
Author: Dave Jones <davej@redhat.com>
Date:   Sun Jun 6 01:01:37 2004 -0700

    [PATCH] fix warning in synclink.c
    
    Signed-off-by: Dave Jones <davej@redhat.com>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit 4d6ff21e133757ef7fbb7aa5c3c89710fd559a78
Author: Benjamin Herrenschmidt <benh@kernel.crashing.org>
Date:   Sun Jun 6 00:56:22 2004 -0700

    [PATCH] ppc64: make the TLB flush logic match ppc32
    
    Adds a dummy flush_tlb_page_nohash() called by ptep_set_access_bits(),
    to be used if we ever have a ppc64 CPU with software loaded TLB.
    
    Signed-off-by: Benjamin Herrenschmidt <benh@kernel.crashing.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit 11fd2d3f877b6c6976ae16369c69a897a1db09ba
Author: Benjamin Herrenschmidt <benh@kernel.crashing.org>
Date:   Sun Jun 6 00:56:11 2004 -0700

    [PATCH] ppc32: missed flush_tlb_page_nohash() cases
    
    ARGH. Missed one file. Here is an additional patch (missed tlbflush.h patch)
    
    Sorry.
    
    This adds the definiction of flush_tlb_page_nohash() that was missing
    from the previous patch fixing SW-TLB loaded PPCs
    
    Signed-off-by: Benjamin Herrenschmidt <benh@kernel.crashing.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit 223666271d410d5f7e295ec0cb31dda842ced9bf
Author: Benjamin Herrenschmidt <benh@kernel.crashing.org>
Date:   Sun Jun 6 00:18:49 2004 -0700

    [PATCH] ppc32: Fix CPUs with soft loaded TLB
    
    The recent introduction of ptep_set_access_flags() with the optimisation
    of not flushing the TLB unfortunately broke ppc32 CPUs with no hash
    table.
    
    The data access exception code path in assembly for these doesn't
    properly deal with the case where the TLB entry is present with the
    wrong PAGE_RW and will just call do_page_fault again instead of just
    replacing the TLB entry.
    
    Fixing the asm code for all the different CPU types affected (yah,
    embedded PPCs all have different MMUs =P) is painful and need testing I
    can't do at the moment, so here's a fix that will just flush the TLB
    page when changing the access flags on non-hash based machines.  Please
    apply.
    
    Signed-off-by: Benjamin Herrenschmidt <benh@kernel.crashing.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org

commit 965fd9c7a9f3d40402aa0428c2e8a08d875e2933
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Sat Jun 5 23:26:06 2004 -0700

    rpc: Use proper printk format for size_t argument.

commit 996e0e6e91a37be0135d0f0ed2b6a1a44eff9894
Author: Ingo Molnar <mingo@redhat.com>
Date:   Sat Jun 5 21:35:59 2004 -0700

    [PATCH] sched: honor the "sync" wakeup bit
    
    The scheduler changes had another thing missing: the appreciation of
    sync wakeups.  (I had this in one of the earlier sched-domains cleanup
    patches before but it got lost in the shuffle.)
    
    When a sync waker is waking, we should subtract its load from the
    current load - it will schedule away for sure in the near future.
    That's what the "sync" bit means.
    
    This change is necessary because with the sched-domains balancer we have
    a much more sensitive cpu-load estimator, and in this particular context
    of try_to_wake_up() the sync waker's effect will always be part of the
    load.  Patch against your patch attached.
    
    In my testing there's an additional increase in bw_pipe numbers on a
    dual P2 box, it went from 110-120 MB/sec to 120-130 MB/sec.
    
    Signed-off-by: Ingo Molnar <mingo@elte.hu>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit ca24660ce7d870bcb06092a0880fab61463c4ea5
Merge: 99185c2... a2f5fee...
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Sat Jun 5 21:33:18 2004 -0700

    Merge http://linux-watchdog.bkbits.net/linux-2.6-watchdog
    into ppc970.osdl.org:/home/torvalds/v2.6/linux

commit a2f5fee9649e2f45dbb381a697f01edcf5514eda
Author: Christoph Hellwig <hch@lst.de>
Date:   Mon Jun 7 00:14:22 2004 +0200

    [WATCHDOG] linux/watchdog.h include types.h patch
    
    watchdog.h is using __u8 and __u32 from linux/types.h, so it needs to
    include it.

commit 6ecc87a7b2cdbae0fc1ce2e7495280114d09edff
Merge: 6e7482f... 99185c2...
Author: Steve French <cifs.adm@hostme.bitkeeper.com>
Date:   Sat Jun 5 18:20:56 2004 -0700

    Merge bk://linux.bkbits.net/linux-2.5
    into hostme.bitkeeper.com:/repos/c/cifs/linux-2.5cifs

commit 08bcc575042aab64bcc27c52cf6de0dfafbfbdd3
Merge: 7fdbeba... ffd630e...
Author: Anton Altaparmakov <aia21@cantab.net>
Date:   Sun Jun 6 01:07:20 2004 +0100

    Merge cantab.net:/home/src/ntfs-2.6
    into cantab.net:/home/src/ntfs-2.6-devel

commit 99185c20cfb9c999826fca0cc6476580d0d593af
Merge: ffd630e... e6b6c7e...
Author: David S. Miller <davem@nuts.davemloft.net>
Date:   Sat Jun 5 06:49:47 2004 -0700

    Merge nuts.davemloft.net:/disk1/BK/network-2.6
    into nuts.davemloft.net:/disk1/BK/net-2.6

commit e6b6c7ee2f431639a048e4f929b9c210411089e3
Author: Olaf Hering <olh@suse.de>
Date:   Sat Jun 5 01:55:25 2004 -0700

    [NET]: Fix compat bug in recvmsg/sendmsg wrt MSG_CMSG_COMPAT.

commit 21eca083b28bd98d7b8024188220db507a7fd67d
Author: Jamal Hadi Salim <hadi@cyberus.ca>
Date:   Sat Jun 5 00:41:55 2004 -0700

    [NET]: Add ARPHRD_NONE and use it in tun driver.

commit ffd630eb6004f134d8fb937713fc050a5af71c83
Author: Jens Axboe <axboe@suse.de>
Date:   Fri Jun 4 23:35:07 2004 -0700

    [PATCH] kill drivers/ide TCQ support
    
    Lets just remove it. It's been disabled some time ago, and there's no
    chance of it ever getting resurrected. PATA TCQ has so many technical
    short comings, that it was never really interesting I'm afraid.
    
    Signed-off-by: Jens Axboe <axboe@suse.de>
    Signed-off-by: Bartlomiej Zolnierkiewicz <B.Zolnierkiewicz@elka.pw.edu.pl>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit bb9cdaf2a6d560652705c5653ddf5af1c0aaed3d
Author: Bartlomiej Zolnierkiewicz <b.zolnierkiewicz@elka.pw.edu.pl>
Date:   Fri Jun 4 23:01:52 2004 -0700

    [PATCH] ide: remove dead code from ide-taskfile.c
    
    Remove dead code from task_in_intr() and pre_task_mulout_intr()
    (CONFIG_IDE_TASKFILE_IO=n versions).
    
    Signed-off-by: Bartlomiej Zolnierkiewicz <bzolnier@elka.pw.edu.pl>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit ad9511cbc3d07d60b9bd5af7cbe7a0a0fc36d503
Author: Bartlomiej Zolnierkiewicz <b.zolnierkiewicz@elka.pw.edu.pl>
Date:   Fri Jun 4 23:01:41 2004 -0700

    [PATCH] ide: sanitize __ide_do_rw_disk() debugging code
    
    - move common code to ide_do_rw_disk()
      (+ always print block number and rq->buffer)
    - use pr_debug()
    
    Signed-off-by: Bartlomiej Zolnierkiewicz <bzolnier@elka.pw.edu.pl>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit 68d994ba9e5fe35403b80eaf2b386eabdfdd464f
Author: Bartlomiej Zolnierkiewicz <b.zolnierkiewicz@elka.pw.edu.pl>
Date:   Fri Jun 4 23:01:29 2004 -0700

    [PATCH] ide: remove needless exports
    
    Remove needless exports from ide.c, ide-probe.c and ide-proc.c.
    
    Signed-off-by: Bartlomiej Zolnierkiewicz <bzolnier@elka.pw.edu.pl>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit 7f1d74add33a922da1674f3b78199d09adddbe30
Author: Bartlomiej Zolnierkiewicz <b.zolnierkiewicz@elka.pw.edu.pl>
Date:   Fri Jun 4 23:01:17 2004 -0700

    [PATCH] ide: use try_to_flush_leftover_data() in idedisk_error()
    
    Signed-off-by: Bartlomiej Zolnierkiewicz <bzolnier@elka.pw.edu.pl>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit b53259fa2ee8561e7904dea9cbd40e52a263b134
Author: Bartlomiej Zolnierkiewicz <b.zolnierkiewicz@elka.pw.edu.pl>
Date:   Fri Jun 4 23:01:06 2004 -0700

    [PATCH] ide: remove unused ide_remove_setting() from ide.c
    
    Signed-off-by: Bartlomiej Zolnierkiewicz <bzolnier@elka.pw.edu.pl>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit 8cf715b345651dac31ec7d6451d36bbe06807358
Author: Bartlomiej Zolnierkiewicz <b.zolnierkiewicz@elka.pw.edu.pl>
Date:   Fri Jun 4 23:00:55 2004 -0700

    [PATCH] ide: change CONFIG_IDEDISK_STOKE to a runtime option
    
    From: Christoph Hellwig <hch@lst.de>
    
    To be useful for distribution kernels it needs to be a runtime option.
    The original patch is from Joerg Platte via the Debian kernel package,
    with some adjustments from me (and me too - Bart).
    
    Signed-off-by: Bartlomiej Zolnierkiewicz <bzolnier@elka.pw.edu.pl>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit da5aad2ecc57ce268b3f8421ac5e1cd759982c66
Merge: ee2b072... bbb644a...
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Fri Jun 4 22:53:39 2004 -0700

    Merge bk://kernel.bkbits.net/davem/sparc-2.6
    into ppc970.osdl.org:/home/torvalds/v2.6/linux

commit ee2b072ada7e2e8741609d962dc052ad2283fd90
Merge: ea28298... 619fdb1...
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Fri Jun 4 22:45:44 2004 -0700

    Merge http://lia64.bkbits.net/to-linus-2.5
    into ppc970.osdl.org:/home/torvalds/v2.6/linux

commit 619fdb17a600f3b49a9c467445c6549ad0caa9ba
Merge: 27484da... 4f3951b...
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Fri Jun 4 21:15:37 2004 -0700

    Merge bk://drm.bkbits.net/drm-2.6
    into ppc970.osdl.org:/home/torvalds/v2.6/linux

commit 27484da46703b6f6eb983a9ceef79f58a1cd0e21
Author: Corey Minyard <minyard@acm.org>
Date:   Fri Jun 4 21:05:56 2004 -0700

    [PATCH] Fix ipmi compile failure
    
    Geert Uytterhoeven wrote:
    
      While compiling drivers/char/ipmi/ipmi_si_intf.c in 2.6.6-rc1 on m68k,
      I noticed a missing include (needed for disable_irq_nosync() and
      enable_irq()):
    
      Furthermore none of CONFIG_ACPI_INTERPETER, CONFIG_X86, and CONFIG_PCI
      were set, and thus IPMI_MEM_ADDR_SPACE and IPMI_IO_ADDR_SPACE are not
      defined, but they are used.
    
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit 33ef0d49d2a623e1203f15cbf0d196498e93ec50
Author: Dave Airlie <airlied@linux.ie>
Date:   Fri Jun 4 20:59:21 2004 -0700

    [PATCH] MTD: add st m50fw0* to jedec_probe.c
    
    Adds support to the jedec probe for ST M50FW040, M50FW080 and M50FW016 all
    Firmware hubs for i8x0 chipsets,
    http://www.st.com/stonline/products/families/memories/fl_nor/fl_fwh.htm
    
    Cc: David Woodhouse <dwmw2@infradead.org>
    
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit 81322f8e546b17002f53bee526d6dee3e1c335ea
Author: Corey Minyard <minyard@acm.org>
Date:   Fri Jun 4 20:59:12 2004 -0700

    [PATCH] Fix procfs warnings when removing ipmi_si module
    
    Presently we get procfs warnings from ipmi_si.ko due to its failing to
    remove all of a /proc directory's contents prior to removing that
    directory.
    
    This patch tracks all proc entries for an IPMI interface and unregisters
    them all upon removal.
    
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit be5979d3983449eae6f143e0e03fb4ed333529ab
Author: Benjamin Herrenschmidt <benh@kernel.crashing.org>
Date:   Fri Jun 4 20:59:01 2004 -0700

    [PATCH] Fix DRM mismerge(?)
    
    From: Colin Leroy <colin@colino.net>
    
    Paulus brought this up on IRC, it seems to be a bad DRM merge: The code
    
    #ifndef VMAP_4_ARGS
           if ( dev->agp->cant_use_aperture )
                   return -EINVAL;
    #endif
    
    in DRM(agp_acquire) should be removed altogether in a 2.6 kernel because
    its vmap() takes 4 arguments; however, only the guards seem to have been
    removed, which causes this function to erroneously fail if the AGP aperture
    can't be directly accessed by the CPU.
    
    Signed-off-by: Colin Leroy <colin@colino.net>
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit 4dfd32b643ad65fcbf33c0c8bbc7c7df7b8d9180
Author: Benjamin Herrenschmidt <benh@kernel.crashing.org>
Date:   Fri Jun 4 20:58:50 2004 -0700

    [PATCH] Fix rivafb's OpenFirmware parsing
    
    The attached patch fixes the EDID parsing for PPC on rivafb.  It actually
    finds the EDID info in the OF Tree now.  I grabbed this from BenHs Tree as
    of 2.6.5-rc3.  The current code has no chance to work since it doesn't walk
    the device tree.  This helps rivafb on PPC at least a bit further...
    
    Signed-off-by: Guido Guenther <agx@sigxcpu.org>
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit a2ea2d4ce970a2a59b3d3a7ef5f69d314db69298
Author: Nick Piggin <nickpiggin@yahoo.com.au>
Date:   Fri Jun 4 20:58:39 2004 -0700

    [PATCH] sched: improve wakeup-affinity
    
    David Mosberger noticed bw_pipe was way down on sched-domains kernels on
    SMP systems.
    
    That is due to two things: first, the previous wake-affine logic would
    *always* move a pipe wakee onto the waker's CPU.  With the scheduler
    rework, this was toned down a lot (but extended to all types of wakeups).
    
    One of the ways this was damped was with the logic: don't move the wakee if
    its CPU is relatively idle compared to the waker's CPU.  Without this, some
    workloads would pile everything up onto a few CPUs and get lots of idle
    time.
    
    However, the fix was a bit of a blunt hack: if the wakee runqueue was below
    50% busy, and the waker's was above 50% busy, we wouldn't do the move.  I
    think a better way to capture it is what this patch does: if the wakee
    runqueue is below 100% busy, and the sum of the two runqueue's loads is
    above 100% busy, and the wakee runqueue is less busy than the waker
    runqueue (ie.  CPU utilisation would drop if we do the move), then we don't
    do the move.
    
    After I fixed this, I found things were still getting bounced around quite
    a bit.  The reason is that we were attempting very aggressive idle
    balancing in order to cut down idle time in a dbt2-pgsql workload, which is
    particularly sensitive to idle.
    
    After having Mark Wong (markw@osdl.org) retest this load with this patch,
    it looks like we don't need to be so aggressive.  I'm glad to be rid of
    this because it never sat too well with me.  We should see slightly lower
    cost of schedule and slightly improved cache impact with this change too.
    
    Mark said:
    ---
            This looks pretty good:
    
            metric  kernel
            2334    2.6.7-rc2
            2298    2.6.7-rc2-mm2
            2329    2.6.7-rc2-mm2-sched-more-wakeaffine
    ---
    ie. within the noise.
    
    David said:
    ---
            Oooh, me likeee!
    
            Host                OS  Pipe AF
                                         UNIX
            --------- ------------- ---- ----
            caldera.h   Linux 2.6.6 3424 2057       (plain 2.6.6)
            caldera.h Linux 2.6.7-r 333. 1402       (original 2.6.7-rc1)
            caldera.h Linux 2.6.7-r 3086 4301       (2.6.7-rc1 with your patch)
    
            Pipe-bandwidth is still down about 10% but that may be due to
            unrelated changes (or perhaps warmup effects?).  The AF UNIX bandwidth
            is just mindboggling.  Moreover, with your patch 2.6.7-rc1 shows
            better context-switch times and lower communication latencies (more
            like the numbers you're getting on UP).
    
            So it seems like the overall balance of keeping things on the same CPU
            vs. distributing them across CPUs is improved.
    ---
    
    I also ran some tests on the NUMAQ. kernbench, dbench, hackbench, reaim
    were much the same. tbench was improved, very much so when clients < NR_CPU.
    
    Signed-off-by: Nick Piggin <nickpiggin@yahoo.com.au>
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit a9b7c3577aa273dba2d44a6286cb39dc2b5d3d0e
Author: Neil Brown <neilb@cse.unsw.edu.au>
Date:   Fri Jun 4 20:58:28 2004 -0700

    [PATCH] md: fix BUG in raid5 resync code.
    
    This condtion on this loop is primarily to avoid the loop if it doesn't
    appear to be needed.  However it optimises a little too much and there is a
    case where it skips the loop when it is really needed.  This patch fixes
    it.
    
    Signed-off-by: Neil Brown <neilb@cse.unsw.edu.au>
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit 0c6077193ff244514dba9edc7a7bd204d6ba2165
Author: Jens Axboe <axboe@suse.de>
Date:   Fri Jun 4 20:58:17 2004 -0700

    [PATCH] fix cdrom length check
    
    There's a bad length check in cdrom_get_random_writable(), it's off-by-4
    since fh->data_len is the length of data _after_ that field (which is
    offset 4 bytes in the header).  Check is pretty bogus anyways, so just kill
    it.
    
    Signed-Off-By: Jens Axboe <axboe@suse.de>
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit 15571bd434cdc0566f07899814ea86fc2391bd11
Author: Paul Fulghum <paulkf@microgate.com>
Date:   Fri Jun 4 20:58:06 2004 -0700

    [PATCH] synclink.c driver init modifications
    
    * Fix cleanup on driver init failure (call pci_unregister_driver if
      necessary)
    
    * Keep driver loaded if no hardware found (for dynid support)
    
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit df6a797d31d0918f6707f7d6b163d6b944364e7a
Author: Paul Fulghum <paulkf@microgate.com>
Date:   Fri Jun 4 20:57:56 2004 -0700

    [PATCH] synclink_cs.c driver init modifications
    
    * Fix cleanup on driver init failure
    
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit ef00b707fa209c74542bfb332bcca06c92ded117
Author: Paul Fulghum <paulkf@microgate.com>
Date:   Fri Jun 4 20:57:45 2004 -0700

    [PATCH] synclinkmp.c driver init modifications
    
    * Fix cleanup on driver init failure (call pci_unregister_driver if
      necessary)
    
    * Keep driver loaded if no hardware found (for dynid support)
    
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit 3cc54a3130cb7ae649e98721c8f3f9a78b0b3294
Author: Kevin Corry <kevcorry@us.ibm.com>
Date:   Fri Jun 4 20:57:34 2004 -0700

    [PATCH] dm: dm-ioctl.c: change an int* to a size_t*
    
    dm-ioctl.c: Use a size_t* instead of an int* in list_version_get_needed().
    size_t and int are not the same size on all architectures.
    
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit 8498dc036c3e39f8fa5ca274a51c09ff5fa62b2d
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri Jun 4 20:57:23 2004 -0700

    [PATCH] nfs-direct warning fix
    
    fs/nfs/direct.c: In function `nfs_file_direct_write':
    fs/nfs/direct.c:549: warning: initialization discards qualifiers from pointer target type
    
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit b431aa1834cf7a8b7df591f5f4710d534ea5a1e8
Author: Rusty Russell <rusty@rustcorp.com.au>
Date:   Fri Jun 4 20:57:12 2004 -0700

    [PATCH] fix sysfs node cpumap for large NR_CPUS
    
    As pointed out by Paul Jackson <pj@sgi.com>, sometimes 99 chars is not enough.
    We currently get a page from sysfs: that code should check we haven't overrun
    it.
    
    Signed-off-by: Rusty Russell <rusty@rustcorp.com.au>
    Signed-off-by: Paul Jackson <pj@sgi.com>
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit d4a006b914b7e4f5cf93a02fc6fdcedbccae5608
Author: Andi Kleen <ak@suse.de>
Date:   Fri Jun 4 20:57:01 2004 -0700

    [PATCH] Use KERN_ALERT more for oopses
    
    Often users only report what syslogd reports with KERN_ALERT when a kernel
    crash occurs.  Make an oops print mpre information with that (in particular
    the RIP)
    
    Patch for i386 and x86-64.
    
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit f6a0ebcab2093d6bad49949df0ab055eb47cc07c
Author: Neil Brown <neilb@cse.unsw.edu.au>
Date:   Fri Jun 4 20:56:50 2004 -0700

    [PATCH] md: support reshaping raid1 arrays - adding or removing drives.
    
    This allows the number of "raid_disks" in a raid1 to be changed.
    
    This requires allocating a new pool of "r1bio" structures which a different
    number of bios, suspending IO, and swapping the new pool in place of the old.
    (and a few other related changes).
    
    Signed-off-by: Neil Brown <neilb@cse.unsw.edu.au>
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit f23b262d654bdf04a8d18b7f1d909930cc5695d6
Author: Neil Brown <neilb@cse.unsw.edu.au>
Date:   Fri Jun 4 20:56:39 2004 -0700

    [PATCH] md: allow md arrays to be resized if devices are large enough.
    
    It is possible to have raid1/4/5/6 arrays that do not use all the space on the
    drive.  This can be done explicitly, or can happen info you, one by one,
    replace all the drives with larger devices.
    
    This patch extends the "SET_ARRAY_INFO" ioctl (which previously invalid on
    active arrays) allow some attributes of the array to be changed and implements
    changing of the "size" attribute.
    
    "size" is the amount of each device that is actually used.  If "size" is
    increased, the new space will immediately be "resynced".
    
    Signed-off-by: Neil Brown <neilb@cse.unsw.edu.au>
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit c144ee55581b60759c7a04633b2f34b0779c3dbe
Author: Neil Brown <neilb@cse.unsw.edu.au>
Date:   Fri Jun 4 20:56:27 2004 -0700

    [PATCH] md: abort the resync of raid1 there is only one device.
    
    If raid1 decides it needs to resync it will do so even if there is only one
    working device.  This is pointless.
    
    With this patch we abort resync if there is nowhere to write to.
    
    Signed-off-by: Neil Brown <neilb@cse.unsw.edu.au>
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit 65e01fa2b373ab580cb926a557880714bff20530
Author: Neil Brown <neilb@cse.unsw.edu.au>
Date:   Fri Jun 4 20:56:16 2004 -0700

    [PATCH] md: handle hot-add for arrays with non-persistent superblocks
    
    If the superblock isn't persistent, we shouldn't allow room for it.
    
    From: Paul Clements <Paul.Clements@SteelEye.com>
    Signed-off-by: Neil Brown <neilb@cse.unsw.edu.au>
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit f870229fba606cf89fd912737f8011926697ff14
Author: Neil Brown <neilb@cse.unsw.edu.au>
Date:   Fri Jun 4 20:56:05 2004 -0700

    [PATCH] md: make sure the size of a raid5/6 array is a multiple of the chunk size.
    
    Normally the size is chosen as a multiple of the chunk size, but if the size
    is explicitly chosen, it might not be.  So we force it.
    
    Signed-off-by: Neil Brown <neilb@cse.unsw.edu.au>
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit e0de9abb64264f54cab05ace8980ebb8d917eab5
Author: Neil Brown <neilb@cse.unsw.edu.au>
Date:   Fri Jun 4 20:55:54 2004 -0700

    [PATCH] md: allow an md personality to refuse a hot-remove request.
    
    This isn't really needed at the moment, but it is more consistant with the
    interface and may be needed later.
    
    Signed-off-by: Neil Brown <neilb@cse.unsw.edu.au>
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit 400aa2cc900ae14000586bd3e69747e1f574b07d
Author: Neil Brown <neilb@cse.unsw.edu.au>
Date:   Fri Jun 4 20:55:41 2004 -0700

    [PATCH] md: make sure md_check_recovery will remove a faulty device when ->nr_pending hits 0
    
    md_check_recovery only locks a device and does stuff when it thinks there is a
    real likelyhood that something needs doing.  So the test at the top must cover
    all possibilities.
    
    But it didn't cover the possibility that the last outstanding request on a
    failed device had finished and so the device needed to be removed.
    
    As a result, a failed drive might not get removed from the personalities
    perspective on the array, and so it could never be removed from the array as a
    whole.
    
    With this patch, whenever ->nr_pending hits zero on a faulty device,
    MD_RECOVERY_NEEDED is set so that md_check_recovery will do stuff.
    
    Signed-off-by: Neil Brown <neilb@cse.unsw.edu.au>
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit 5de6af14a337d3cbb79fbcf19cb571b3a5e87224
Author: Neil Brown <neilb@cse.unsw.edu.au>
Date:   Fri Jun 4 20:55:29 2004 -0700

    [PATCH] md: rationalise device selection in md/multipath.
    
    md/multipath has two separate pieces of code for choosing a device to use, one
    when a request is first made and the other when a request is being re-tried
    after failure.  This patch discards multipath_read_balance and uses
    multipath_map in both situations.
    
    Signed-off-by: Neil Brown <neilb@cse.unsw.edu.au>
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit dabb34ef61de8703741a8fcd7372f6b38fc96d86
Author: Neil Brown <neilb@cse.unsw.edu.au>
Date:   Fri Jun 4 20:55:18 2004 -0700

    [PATCH] kNFSd: documentation typo fixes
    
    Fix minor typos.
    
    From: "J. Bruce Fields" <bfields@fieldses.org>
    Signed-off-by: Neil Brown <neilb@cse.unsw.edu.au>
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit e28a69ea84db1926ae79d6f5c51f8de3854d45ad
Author: Neil Brown <neilb@cse.unsw.edu.au>
Date:   Fri Jun 4 20:55:07 2004 -0700

    [PATCH] kNFSd: nfsd4 file creation fix
    
    Fix error return in create.  (See comment in xdr for createtype4 at end of
    rfc3530.)
    
    From: Andy Adamson <andros@citi.umich.edu>
    From: "J. Bruce Fields" <bfields@fieldses.org>
    Signed-off-by: Neil Brown <neilb@cse.unsw.edu.au>
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit 49ed22678434509682da06266eb94468b8b9d862
Author: Neil Brown <neilb@cse.unsw.edu.au>
Date:   Fri Jun 4 20:54:56 2004 -0700

    [PATCH] kNFSd: nfsd4 setclientid fix
    
    Fix a somewhat bizarre corner case in clid processing: a clientid match isn't
    required for case 3.
    
    From: Andy Adamson <andros@citi.umich.edu>
    From: "J. Bruce Fields" <bfields@fieldses.org>
    Signed-off-by: Neil Brown <neilb@cse.unsw.edu.au>
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit e6ad7fd18d1e1171475e2b298bb1cc994d6d93fd
Author: Neil Brown <neilb@cse.unsw.edu.au>
Date:   Fri Jun 4 20:54:45 2004 -0700

    [PATCH] kNFSd: nfsd getattr fix
    
    Oops: we were claiming to support the TIME_CREATE attribute, when we don't
    really.
    
    From: Andy Adamson <andros@citi.umich.edu>
    From: "J. Bruce Fields" <bfields@fieldses.org>
    Signed-off-by: Neil Brown <neilb@cse.unsw.edu.au>
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit 58ad846ff2191e5286db90bbffdc9f8e180553f4
Author: Neil Brown <neilb@cse.unsw.edu.au>
Date:   Fri Jun 4 20:54:34 2004 -0700

    [PATCH] kNFSd: nfsd4_release_lockowner() oops fix
    
    Fix oops in release_lockowner.  We need to break out to two loops, not just
    one, and if the loop finds nothing, 'local' won't be NULL.  So just put the
    body of the 'if' inside the loop.
    
    From: Andy Adamson <andros@citi.umich.edu>
    From: "J. Bruce Fields" <bfields@fieldses.org>
    Signed-off-by: Neil Brown <neilb@cse.unsw.edu.au>
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit 6b8ba437d460b9c920ad52d350bcae14564ce1d7
Author: Neil Brown <neilb@cse.unsw.edu.au>
Date:   Fri Jun 4 20:54:23 2004 -0700

    [PATCH] kNFSd: rsc_lookup simplification
    
    rsc_lookup is a bit complicated: it either takes responsibility for the memory
    pointed to by handle.data and sets handle.data to NULL, or it leaves
    handle.data unchanged, in which case the caller is responsible for freeing
    handle.data.  I forgot that the possibility of inserting a negative cache
    entry into the cache meant that this could happen even when rsc_lookup is
    called with set == 0.
    
    Note that the ip_map code has the same bug, not that it seems to matter much,
    since the memory in question in that case is always just a statically
    allocated string.
    
    From: "J. Bruce Fields" <bfields@fieldses.org>
    Signed-off-by: Neil Brown <neilb@cse.unsw.edu.au>
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit 1e81dda97a2aec1d352bea47ee37e3a43b640bba
Author: Neil Brown <neilb@cse.unsw.edu.au>
Date:   Fri Jun 4 20:54:12 2004 -0700

    [PATCH] kNFSd: gss_svc locking and refcounting fixes
    
    The server sunrpc code should take a reference on the relevant module before
    calling any authentication code.
    
    Also, it looks to me like the table of authops needs some locking.
    
    Finally, gss_svc_init wasn't checking the status of svc_auth_register, and
    gss_svc_shutdown wasn't calling svc_auth_unregister.
    
    From: "J. Bruce Fields" <bfields@fieldses.org>
    Signed-off-by: Neil Brown <neilb@cse.unsw.edu.au>
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit ff0608b56d0a4154cf4a0b077e3eeb81c8337515
Author: Neil Brown <neilb@cse.unsw.edu.au>
Date:   Fri Jun 4 20:54:02 2004 -0700

    [PATCH] kNFSd: nfsd4 xdr name encoding improvements
    
    Encode names directly into xdr buffer; this optimizes out a data copy, reduces
    stack usage, and will make life simpler when doing acls.
    
    From: "J. Bruce Fields" <bfields@fieldses.org>
    Signed-off-by: Neil Brown <neilb@cse.unsw.edu.au>
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit 35407e6ebaecbb141fe14025e92a59fb5c9c6121
Author: Neil Brown <neilb@cse.unsw.edu.au>
Date:   Fri Jun 4 20:53:48 2004 -0700

    [PATCH] kNFSd: nfsd_acceptable() typo fix
    
    there's a small typo in nfsd_acceptable.  It calls
    
    	err = permission(parent->d_inode, S_IXOTH, NULL);
    
    It really wants to use MAY_EXEC instead of S_IXOTH.  Those happen to be the
    same at the moment, but may not do so forever.
    
    From: Olaf Kirch <okir@suse.de>:
    From: "J. Bruce Fields" <bfields@fieldses.org>
    Signed-off-by: Neil Brown <neilb@cse.unsw.edu.au>
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit 5c96dea451931a5869077d4e8e5f3c378c34c75e
Author: Neil Brown <neilb@cse.unsw.edu.au>
Date:   Fri Jun 4 20:53:32 2004 -0700

    [PATCH] kNFSd: exp_find(): remove null pointer check
    
    If ek = exp_find_key() is not an error, then ek->ek_export should be set; no
    point in checking if it's NULL.
    
    From: "J. Bruce Fields" <bfields@fieldses.org>
    Signed-off-by: Neil Brown <neilb@cse.unsw.edu.au>
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit 0b1d57cf7654b6e9b7158ea9711870ab3070a326
Author: Neil Brown <neilb@cse.unsw.edu.au>
Date:   Fri Jun 4 20:53:17 2004 -0700

    [PATCH] kNFSd: Fix nfs3 dentry encoding
    
    The "offset" in an entry in an nfs3 readdir response is 64 bits long and as it
    has only a 32 bit alignment, it fall half in one page of the response and half
    in another.
    
    This patch adds a second offset pointer (offset1) which points to the second
    half in the unusual case of the offset being split between pages, and sets and
    uses it accordingly.
    
    From: Olaf Kirch <okir@suse.de>
    Signed-off-by: Neil Brown <neilb@cse.unsw.edu.au>
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit c6453d0ad865a89e92a13ca21347c227ef009d40
Author: Andreas Dilger <adilger@clusterfs.com>
Date:   Fri Jun 4 20:53:02 2004 -0700

    [PATCH] ext3: htree rename fix
    
    A problem with htree was recently discovered during Lustre testing when
    files were being renamed within the same directory.  In some cases the
    addition of the new name caused a directory block split and the old
    dir_entry was pointing at the wrong entry, and the wrong entry was removed.
    This would seem entirely possible in a Maildir directory, since the MTA
    will be doing a lot of renames within the same directory.
    
    If old_de is pointing to the newly-added entry (i_ino is the same) we end up
    deleting the new entry instead of the old one.  It looks as if the rename
    never happened.  We need to verify that the name we are unlinking is what we
    expect.
    
    If is also possible that old_de is pointing to the now-unused space at the end
    of a newly-split leaf block, so we still need to try ext3_delete_entry()
    (which will skip the stale entry and return ENOENT) instead of just relying on
    the inum + name check.
    
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit 1d90ac58963ccf69ba01690c31aa1e74681cbee2
Author: Hugh Dickins <hugh@veritas.com>
Date:   Fri Jun 4 20:52:50 2004 -0700

    [PATCH] mm: kill missed pte warning
    
    I've seen no warnings, nor heard any reports of warnings, that anon_vma ever
    misses ptes (nor anonmm before it).  That WARN_ON (with its useless stack
    dump) was okay to goad developers into making reports, but would mainly be an
    irritation if it ever appears on user systems: kill it now.
    
    Signed-off-by: Hugh Dickins <hugh@veritas.com>
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit ebd6867f019324dfef20af06a2238c2b37641fa9
Author: Hugh Dickins <hugh@veritas.com>
Date:   Fri Jun 4 20:52:39 2004 -0700

    [PATCH] mm: get_user_pages vs. try_to_unmap
    
    Andrea Arcangeli's fix to an ironic weakness with get_user_pages.
    
    try_to_unmap_one must check page_count against page->mapcount before unmapping
    a swapcache page: because the raised pagecount by which get_user_pages ensures
    the page cannot be freed, will cause any write fault to see that page as not
    exclusively owned, and therefore a copy page will be substituted for it - the
    reverse of what's intended.
    
    rmap.c was entirely free of such page_count heuristics before, I tried hard to
    avoid putting this in.  But Andrea's fix rarely gives a false positive; and
    although it might be nicer to change exclusive_swap_page etc.  to rely on
    page->mapcount instead, it seems likely that we'll want to get rid of
    page->mapcount later, so better not to entrench its use.
    
    Signed-off-by: Hugh Dickins <hugh@veritas.com>
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit a888f1f5a259fc9ee58d207560af30eb81dc220b
Author: Hugh Dickins <hugh@veritas.com>
Date:   Fri Jun 4 20:52:28 2004 -0700

    [PATCH] mm: vma_adjust insert file earlier
    
    For those arches (arm and parisc) which use the i_mmap tree to implement
    flush_dcache_page, during split_vma there's a small window in vma_adjust when
    flush_dcache_mmap_lock is dropped, and pages in the split-off part of the vma
    might for an instant be invisible to __flush_dcache_page.
    
    Though we're more solid there than ever before, I guess it's a bad idea to
    leave that window: so (with regret, it was structurally nicer before) take
    __vma_link_file (and vma_prio_tree_init) out of __vma_link.
    
    vma_prio_tree_init (which NULLs a few fields) is actually only needed when
    copying a vma, not when a new one has just been memset to 0.
    
    __insert_vm_struct is used by nothing but vma_adjust's split_vma case:
    comment it accordingly, remove its mark_mm_hugetlb (it can never create
    a new kind of vma) and its validate_mm (another follows immediately).
    
    Signed-off-by: Hugh Dickins <hugh@veritas.com>
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit e495dd356078eacdc49998ec147e3df227c11ad8
Author: Hugh Dickins <hugh@veritas.com>
Date:   Fri Jun 4 20:52:17 2004 -0700

    [PATCH] mm: vma_adjust adjust_next wrap
    
    Fix vma_adjust adjust_next wrapping: Rajesh V.  pointed out that if end were
    2GB or more beyond next->vm_start (on 32-bit), then next->vm_pgoff would have
    been negatively adjusted.
    
    Signed-off-by: Hugh Dickins <hugh@veritas.com>
    Signed-off-by: Rajesh Venkatasubramanian <vrajesh@umich.edu>
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit ad6e519be1a98976388397325c6e3365e42c4271
Author: Hugh Dickins <hugh@veritas.com>
Date:   Fri Jun 4 20:52:06 2004 -0700

    [PATCH] mm: follow_page invalid pte_page
    
    The follow_page write-access case is relying on pte_page before checking
    pfn_valid: rearrange that - and we don't need three struct page *pages.
    
    (I notice mempolicy.c's verify_pages is also relying on pte_page, but I'll
    leave that to Andi: maybe it ought to be failing on, or skipping over, VM_IO
    or VM_RESERVED vmas?)
    
    Signed-off-by: Hugh Dickins <hugh@veritas.com>
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit e11f2cc49856eabafed09cf30e190646f78b7207
Author: Hugh Dickins <hugh@veritas.com>
Date:   Fri Jun 4 20:51:55 2004 -0700

    [PATCH] mm: swapper_space.i_mmap_nonlinear
    
    Initialize swapper_space.i_mmap_nonlinear, so mapping_mapped reports false on
    it (as it used to do).  Update comment on swapper_space, now more fields are
    used than those initialized explicitly.
    
    Signed-off-by: Hugh Dickins <hugh@veritas.com>
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit e3223421629ec5cd396bc627c25be3ab4c2f32f4
Author: Andi Kleen <ak@suse.de>
Date:   Fri Jun 4 20:51:44 2004 -0700

    [PATCH] More x86-64 bugfixes
    
    This patch fixes the problem some people had with their systems crashing
    early at boot.  Also fix a problem in the LDT/TSS setup noticed by Paul
    Menage.  And some other random fixes.
    
    - Update defconfig
    - Remove some unnecessary printks
    - Enlarge kernel mapping to 40MB
    - Fix acpi=ht (Suresh Siddha)
    - Use KERN_ALERT for more important oops lines
    - Fix LDT/TSS limit (Paul Menage)
    
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit 6e7482fd18541ab76a513c81b52638ec548134cb
Merge: 27a8bba... e1900a1...
Author: Steve French <cifs.adm@hostme.bitkeeper.com>
Date:   Fri Jun 4 15:54:08 2004 -0700

    Merge bk://linux.bkbits.net/linux-2.5
    into hostme.bitkeeper.com:/repos/c/cifs/linux-2.5cifs

commit 4f3951ba2431bce966cb0b6084705f987c7a1bb1
Merge: e1900a1... 7fcd970...
Author: David Airlie <drm.adm@hostme.bitkeeper.com>
Date:   Fri Jun 4 11:44:31 2004 -0700

    Merge http://linux.bkbits.net/linux-2.5
    into hostme.bitkeeper.com:/repos/d/drm/drm-2.6

commit 7fcd9709139b90d8986de11a89def11ca4766647
Merge: 6ad2ec2... a3631e7...
Author: Dave Airlie <airlied@starflyer.(none)>
Date:   Mon Jun 7 14:25:13 2004 +1000

    Merge bk://drm.bkbits.net/drm-2.6
    into starflyer.(none):/home/airlied/drm/drm-2.6

commit a3631e764d8d5841ddac811f903759b0edf106b1
Author: Dave Airlie <airlied@starflyer.(none)>
Date:   Mon Jun 7 14:19:38 2004 +1000

    Remove check that is needed only for 2.4 kernel fixes bug reports on lk.
    
    Signed-off-by: Colin Leroy <colin@colino.net>
    Signed-off-by: Dave Airlie <airlied@linux.ie>

commit 7fdbeba5e0007cad0bf3167c504809de72692e63
Merge: e3353c0... 0badbe1...
Author: Anton Altaparmakov <aia21@cantab.net>
Date:   Fri Jun 4 19:11:15 2004 +0100

    Merge cantab.net:/home/src/ntfs-2.6
    into cantab.net:/home/src/ntfs-2.6-devel

commit e3353c06b159701465ed161c70c8fa147ddab06e
Author: Anton Altaparmakov <aia21@cantab.net>
Date:   Fri Jun 4 18:59:48 2004 +0100

    NTFS: Implement ntfs_mft_writepage() so it now checks if any of the mft
          records in the page are dirty and if so redirties the page and
          returns.  Otherwise it just returns (after doing set_page_writeback(),
          unlock_page(), end_page_writeback() or the radix-tree tag
          PAGECACHE_TAG_DIRTY  remains set even though the page is clean), thus
          alowing the VM to do with the page as it pleases.  Also, at umount
          time, now only throw away dirty mft (meta)data pages if dirty inodes
          are present and ask the user to email us if they see this happening.
    
    Signed-off-by: Anton Altaparmakov <aia21@cantab.net>

commit f7129a805475d7dcb6804d1e0cb31cd316c8f2af
Author: Anton Altaparmakov <aia21@cantab.net>
Date:   Fri Jun 4 18:35:54 2004 +0100

    NTFS: Use set_page_writeback()/end_page_writeback() in ntfs_writepage()
          resident attribute write code path as otherwise the radix-tree tag
          PAGECACHE_TAG_DIRTY remains set even though the page is clean.
    
    Signed-off-by: Anton Altaparmakov <aia21@cantab.net>

commit ea282989103079f2acf1aa11a3f2397154459add
Author: David Mosberger <davidm@tiger.hpl.hp.com>
Date:   Fri Jun 4 08:15:18 2004 -0700

    ia64: Kill unused external declaration of "acpi_legacy_devices".

commit 4245419ad0a059b7b493215fe212eda3c7aa29f9
Author: Keith Owens <kaos@sgi.o>
Date:   Fri Jun 4 07:16:31 2004 -0700

    ia64: work around linker bug
    
    Building 2.6.6-ia64-040521, using GNU ld version 2.14.90.0.4 20030523.
    __gp is sometimes set incorrectly.  Instead of being .got + 0x2000000,
    it is set to .data + 0x2000000, which breaks some LTOFF22 and GPREL22
    entries.
    
    This is non-deterministic, changing the path name to the kernel tree
    which changes the size of some messages in .data is enough to make the
    linker get it right.  Force __gp to be based on .got.
    
    HJ Lu says this is fixed in newer versions of binutils but the work around
    is sensible enough that it is a better solution than forcing everybody
    to upgrade binutils.
    
    Signed-off-by: David Mosberger <davidm@hpl.hp.com>

commit 0d570a578ef9b5259662d7590a352edd5b3ae77a
Author: Stephen Hemminger <shemminger@osdl.org>
Date:   Fri Jun 4 06:57:50 2004 -0700

    [TCP]: Common code for generating tcp_info.

commit bbb644a204ca3ebca09dce03aded646033428664
Merge: c0f100c... e1900a1...
Author: David S. Miller <davem@kernel.bkbits.net>
Date:   Fri Jun 4 03:49:02 2004 -0700

    Merge davem@nuts.davemloft.net:/disk1/BK/sparc-2.6
    into kernel.bkbits.net:/home/davem/sparc-2.6

commit c0f100c21b96964d42800c4acb2d1deda317afae
Author: David S. Miller <davem@nuts.davemloft.net>
Date:   Fri Jun 4 03:34:45 2004 -0700

    [KERNEL]: Some sparse fixes for init/main.c
    
    1) Explicitly cast to __user in syscall invocations
       where we know we are in KERNEL_DS
    2) Explicitly test against zero in assignment expression
       conditional.

commit e2834fd5fa63efe50717cdc5df1c48de7af7e007
Author: David S. Miller <davem@nuts.davemloft.net>
Date:   Fri Jun 4 03:31:24 2004 -0700

    [COMPAT]: Fix some sparse annotations in fs/compat_ioctl.c

commit fc8f9c3a85400a98cde526ab4f9fbc86221f1441
Merge: b4674fe... bb0f5eb...
Author: Anton Altaparmakov <aia21@cantab.net>
Date:   Fri Jun 4 11:23:22 2004 +0100

    Merge cantab.net:/home/src/ntfs-2.6
    into cantab.net:/home/src/ntfs-2.6-devel

commit 3d41fa332f96e2a585b747542dafe09f11e9095c
Author: David S. Miller <davem@nuts.davemloft.net>
Date:   Fri Jun 4 03:12:17 2004 -0700

    [AIO]: Split ki_user_obj into a 2 member union.
    
    This documents how this member is used in two
    ways, 1) as a pointer to a user ioctx and 2)
    as a pointer to a task struct to wake up.

commit dd5d5ea84ad3b30b03eda5da4ed37d7af1274033
Author: David S. Miller <davem@nuts.davemloft.net>
Date:   Fri Jun 4 03:00:16 2004 -0700

    [COMPAT]: Add __user attributes for pointers passed while KERNEL_DS.

commit e1900a196d25dc6b04ff0a01d7553be086cc5058
Author: Paul Mackerras <paulus@samba.org>
Date:   Fri Jun 4 02:53:48 2004 -0700

    [PATCH] ppc32: Fix typo in ppc32 spinlock.h
    
    Brown-paper bag time... I put a typo in the asm for _raw_write_trylock
    (left in a spurious \n\).  This patch fixes it.
    
    Signed-off-by: Paul Mackerras <paulus@samba.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit f29145e2c0d56f32bff207a36138d5b2ee465beb
Merge: eb01308... 9079524...
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Fri Jun 4 02:51:48 2004 -0700

    Merge bk://bk.arm.linux.org.uk/linux-2.6-pcmcia
    into ppc970.osdl.org:/home/torvalds/v2.6/linux

commit 90795241d19947d31c9ea39ecf4f6add051e9f42
Author: Russell King <rmk@flint.arm.linux.org.uk>
Date:   Fri Jun 4 23:21:51 2004 +0100

    [PCMCIA] Add sparse annotations to ds.c

commit 5a4d68e67586c0ac04c0d54a818eba69c09104d4
Author: David S. Miller <davem@nuts.davemloft.net>
Date:   Fri Jun 4 02:51:43 2004 -0700

    [SPARC64]: Tidy asm macros in sfp-util.h

commit eb013086e1ad914488647a5cb7fddeb43e5a17cf
Merge: 25c3412... 52f48d9...
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Fri Jun 4 02:50:11 2004 -0700

    Merge bk://bk.arm.linux.org.uk/linux-2.6-rmk
    into ppc970.osdl.org:/home/torvalds/v2.6/linux

commit 52f48d910128e433a2a99714768ceb3091704778
Author: Toshihiro Kobayashi <toshihiro.kobayashi@com.rmk.(none)>
Date:   Fri Jun 4 22:03:16 2004 +0100

    [ARM PATCH] 1911/1: fix of odd PMD handling in do_translation_fault()
    
    Patch from Toshihiro Kobayashi
    
    do_translation_fault() in arch/arm/mm/fault.c will never resolve odd PMD.
    This patch fixes that problem.

commit 1261c634fa147b18ea79c50960ac9c602251eec5
Author: Catalin Marinas <catalin.marinas@com.rmk.(none)>
Date:   Fri Jun 4 19:54:37 2004 +0100

    [ARM PATCH] 1912/1: Wrong cache aliasing bit check
    
    Patch from Catalin Marinas
    
    arch/arm/mm/mmap.c: arch_get_unamapped_area() checks bit 9 in the cache type register for possible cache aliasing problems. Bit 11 should be checked instead.

commit 80fe944fb4c31180493ceae6f6161c30b34d9b88
Author: David S. Miller <davem@nuts.davemloft.net>
Date:   Fri Jun 4 02:39:36 2004 -0700

    [SPARC64]: Fix compat_sys_wait4 extern decl.

commit 668d8498380b8ccd1b3ad4089964823e6a5bb568
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri Jun 4 02:17:51 2004 -0700

    [PATCH] ia64: uninline find_next_bit on ia64
    
    From: Paul Jackson <pj@sgi.com>
    
    Move the page of code (~700 bytes of instructions) for find_next_bit and
    find_next_zero_bit from inline in include/asm-ia64/bitops.h to a real function
    in arch/ia64/lib/bitops.c, leaving a declaration and macro wrapper behind.
    
    The other arch's with almost this same code might want to also uninline it:
    alpha, parisc, ppc, sh, sparc, sparc64.
    
    These are too big to inline.
    
    Signed-off-by: Paul Jackson <pj@sgi.com>
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: David Mosberger <davidm@hpl.hp.com>

commit 30cf9819f3c62f8be5cbabc652230ca201012a63
Author: Alex Tsariounov <alext@fc.hp.com>
Date:   Fri Jun 4 02:12:27 2004 -0700

    [PATCH] ia64: fix comment-typo in entry.S
    
    Signed-off-by: David Mosberger <davidm@hpl.hp.com>

commit 4ded3438c6d8aeb607815f2f5b89699e88f10d33
Author: Gary Hade <garyhade@us.ibm.com>
Date:   Fri Jun 4 02:11:10 2004 -0700

    [PATCH] ia64: Fix early serial console setup regression on the IBM x450 and x455
    
    This patch removes the ACPI LEGACY_DEVICES IA-PC boot architecture
    flag as a condition for early serial console setup.  This flag may not
    be set on some systems (e.g. IBM x450 and x455) where early serial
    console setup is possible.
    
    Signed-off-by: Gary Hade <garyhade@us.ibm.com>
    Signed-off-by: David Mosberger <davidm@hpl.hp.com>

commit 46f123833b57db43c22e3cf09dc672c92ebaa22e
Author: Alex Williamson <alex.williamson@hp.com>
Date:   Fri Jun 4 02:08:45 2004 -0700

    [PATCH] ia64: setup cpu_to_node for cpus not present
    
    In latest linux-2.5 bitkeeper, if you turn on CONFIG_HOTPLUG_CPU w/
    an NR_CPUS greater than physically presents CPUs, you'll end up taking
    an MCA in __alloc_percpu().  kmem_cache_alloc_node() gets called with a
    node value of -1.  It seems other architectures are defaulting the
    cpu_to_node map to zero for possible, but not present cpus.  Here's a
    trivial patch that does the same for ia64.
    
    Signed-off-by: David Mosberger <davidm@hpl.hp.com>

commit d62379fa33f241ab85103c7811aa4b222c4eb9dd
Merge: 25c3412... 7ac3b33...
Author: David Mosberger <davidm@tiger.hpl.hp.com>
Date:   Fri Jun 4 01:54:38 2004 -0700

    Merge tiger.hpl.hp.com:/data1/bk/vanilla/linux-2.5
    into tiger.hpl.hp.com:/data1/bk/lia64/to-linus-2.5

commit 7ac3b3378c064ddf03b664611715df724698cd49
Author: David Mosberger <davidm@tiger.hpl.hp.com>
Date:   Fri Jun 4 01:44:11 2004 -0700

    ia64: Avoid intermediate-overflows in sched_clock().
    
    Bug reported by Zoran Menyhart.

commit 25c34123c643a667efa5539edda591b9f41603ff
Merge: 686ed0a... a2e2c69...
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Fri Jun 4 01:15:02 2004 -0700

    Merge bk://kernel.bkbits.net/davem/net-2.6
    into ppc970.osdl.org:/home/torvalds/v2.6/linux

commit a2e2c697723905c6fb84207f5771febe5da19510
Author: Alexander Viro <viro@parcelfarce.linux.theplanet.co.uk>
Date:   Fri Jun 4 00:11:24 2004 -0700

    [PATCH] sparse: slip.c annotation

commit 3ca64eb7586acca61f28e33b8fdb1f6defc79c23
Author: Alexander Viro <viro@parcelfarce.linux.theplanet.co.uk>
Date:   Fri Jun 4 00:11:13 2004 -0700

    [PATCH] sparse: depca annotation
    
    ioctl structure annotated

commit 96dff59da696e14e49bb8c45c3e2cf8794a22140
Author: Alexander Viro <viro@parcelfarce.linux.theplanet.co.uk>
Date:   Fri Jun 4 00:11:02 2004 -0700

    [PATCH] sparse: drivers/net/tun.c annotation

commit 090014ee67ea80bfc410ccea0861473b358fe044
Author: Alexander Viro <viro@parcelfarce.linux.theplanet.co.uk>
Date:   Fri Jun 4 00:10:51 2004 -0700

    [PATCH] sparse: the rest of ifr_data cleanups and annotations
    
    	The rest of ->ifr_data cleanups.  A bunch of drivers use address
    of ifr->ifr_ifru, but spell that as &ifr->ifr_data, which expands to
    &ifr->ifr_ifru.ifru_data.  ifr_ifru is a union and in effect they sneak in
    a private field into that union; ifr_ifru.ifru_data is a field in that
    union and it has nothing to do with the things they want to do.  Cleaned
    up by explicit use of &ifr->ifr_ifru.
    
    	Several places where we really use ->ifr_data (i.e. use its value
    and use it as __user pointer) annotated.

commit a086d60f386829bc2bce35201404a4712abd64d7
Author: Alexander Viro <viro@parcelfarce.linux.theplanet.co.uk>
Date:   Fri Jun 4 00:10:38 2004 -0700

    [PATCH] sparse: if_mii() helper (from jgarzik)
    
    From: Jeff Garzik
    
    	Jeff's patch adds a helper for obtaining mii_ioctl_data from ifreq
    and switches drivers to it.  It's almost a "move common expression into
    inline helper", except that instead of
    
    	(struct mii_ioctl_data *)&rq->ifr_ifru.ifru_data
    
    it does
    
    	(struct mii_ioctl_data *)&rq->ifr_ifru
    
    - pointer to union instead of pointer to a field of union that has nothing
    to do with mii_ioctl_data *and* adds confusion by being a pointer itself.

commit 686ed0a0c29f76b7a51da2c7d3b837e0761943a6
Merge: 6781fde... e343efc...
Author: David S. Miller <davem@nuts.davemloft.net>
Date:   Fri Jun 4 00:02:33 2004 -0700

    Merge http://linux-lksctp.bkbits.net/lksctp-2.5.work
    into nuts.davemloft.net:/disk1/BK/net-2.6

commit 6781fdec68c296e45bcb6817857cd95e8305d0d7
Author: Hideaki Yoshifuji <yoshfuji@linux-ipv6.org>
Date:   Thu Jun 3 23:59:50 2004 -0700

    [UDPv4]: Pass correct socket to ip_mc_sf_allow.

commit 1cc5f24fad85ea9859a9f45d9d5361731bd0f098
Author: James Morris <jmorris@redhat.com>
Date:   Thu Jun 3 23:58:09 2004 -0700

    [IPVS]: IPVS needs checksum fixups.
    
    Here's an additional patch for ipvs, which also mangles packets via
    netfilter and was previously depending on the checksum helper in
    nf_hook_slow().
    
    Signed-of-by: James Morris <jmorris@redhat.com>
    Signed-of-by: David S. Miller <davem@redhat.com>

commit 62105cb55074895ce28842428a38d30cfaa279db
Merge: 79c6b7d... b5da32d...
Author: David S. Miller <davem@nuts.davemloft.net>
Date:   Thu Jun 3 23:47:02 2004 -0700

    Merge nuts.davemloft.net:/disk1/BK/network-2.6
    into nuts.davemloft.net:/disk1/BK/net-2.6

commit 79c6b7d3270106aa2a242da0b12a971742fcdac7
Author: Bartlomiej Zolnierkiewicz <b.zolnierkiewicz@elka.pw.edu.pl>
Date:   Thu Jun 3 21:59:56 2004 -0700

    [PATCH] apply nForce2 fixup only if C1 Halt Disconnect is enabled
    
    Some boards don't support C1 Halt Disconnect.
    
    Signed-off-by: Bartlomiej Zolnierkiewicz <bzolnier@elka.pw.edu.pl>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit 27a8bba18579604049c0c011570d8155d4f1456e
Merge: 0badbe1... f60c96b...
Author: Steve French <cifs.adm@hostme.bitkeeper.com>
Date:   Thu Jun 3 19:19:57 2004 -0700

    Merge bk://linux.bkbits.net/linux-2.5
    into hostme.bitkeeper.com:/repos/c/cifs/linux-2.5cifs

commit 0badbe1aaa34db0b8f268408e6a1060c99d3d8b1
Author: Alexander Viro <viro@www.linux.org.uk>
Date:   Thu Jun 3 17:24:16 2004 -0700

    [PATCH] sparse: tpqic annotation

commit 2d0d143068d757ddbbcf5d2248c1ff67191df43c
Author: Alexander Viro <viro@www.linux.org.uk>
Date:   Thu Jun 3 17:24:00 2004 -0700

    [PATCH] sparse: drivers/char/i8 annotation

commit 9e220970c9d55a9c7749cc08310cb9969b1ac450
Author: Alexander Viro <viro@www.linux.org.uk>
Date:   Thu Jun 3 17:23:45 2004 -0700

    [PATCH] sparse: lp annotation

commit 3569e8460a074bd73c8a3662c85172c4b86a7af5
Author: Alexander Viro <viro@www.linux.org.uk>
Date:   Thu Jun 3 17:23:33 2004 -0700

    [PATCH] sparse: misc drivers annotations
    
    assorted minor bits in drivers/* - all independent, but there's
    some limit to splitting stuff...

commit 796c43e56a76258487988a49042f4bad8ec88569
Author: Alexander Viro <viro@www.linux.org.uk>
Date:   Thu Jun 3 17:23:24 2004 -0700

    [PATCH] sparse: ppdev annotation

commit 138b97b63460f0f85dcfbf20a3d658b244456901
Author: Alexander Viro <viro@www.linux.org.uk>
Date:   Thu Jun 3 17:23:12 2004 -0700

    [PATCH] sparse: sonypi annotiation

commit 03ac97d8f0202502eb1a23816228e134037d980c
Author: Alexander Viro <viro@www.linux.org.uk>
Date:   Thu Jun 3 17:23:01 2004 -0700

    [PATCH] sparse: usb/core/devio annotation

commit c6d32902cb31212e0fc467a314b94a2aaf414fb3
Author: Alexander Viro <viro@www.linux.org.uk>
Date:   Thu Jun 3 17:22:50 2004 -0700

    [PATCH] sparse: trivial fs annotations

commit 4bb07ce359a1d2bc9cdc260f2c800958f3b78416
Author: Alexander Viro <viro@www.linux.org.uk>
Date:   Thu Jun 3 17:22:38 2004 -0700

    [PATCH] sparse: synclink annotation

commit 5a6fea0fcee7ec9c485016b82a9ec9fe411f10fd
Author: Alexander Viro <viro@www.linux.org.uk>
Date:   Thu Jun 3 17:22:27 2004 -0700

    [PATCH] sparse: synclink_cs annotation

commit 58d00682786039c36d453e434dcaac99448ba461
Author: Alexander Viro <viro@www.linux.org.uk>
Date:   Thu Jun 3 17:22:16 2004 -0700

    [PATCH] sparse: ide-floppy annotation

commit 236b7066ecfde294591f442aa3fbf71a932042e4
Author: Alexander Viro <viro@www.linux.org.uk>
Date:   Thu Jun 3 17:22:05 2004 -0700

    [PATCH] sparse: misc headers annotations
    
    several pointers in ioctl structures marked as userland ones.
    
    And that's it with this patchset.  A couple more of those and we'll
    be done with the noise warnings ;-)

commit bb0f5eb94a4800f07ff9e5def30f9600ef84e35c
Author: Alexander Viro <viro@parcelfarce.linux.theplanet.co.uk>
Date:   Thu Jun 3 10:39:32 2004 -0700

    [PATCH] sparse: rest of drivers/net annotations in the patchset
    
    s2io.c: bogus initializer ({{"a"},{"b"}} has too many braces for
    two-dimensional array of char - strings are arrays themselves).
    
    de4x5.h: missing __user on a pointer in ioctl structure.
    
    airo.c: cleaned up and fixed procfs ->read() and ->write()

commit 38418a28d88221435d115b6a29fcba007761a2f5
Author: Alexander Viro <viro@parcelfarce.linux.theplanet.co.uk>
Date:   Thu Jun 3 10:39:21 2004 -0700

    [PATCH] sparse: misc scsi annotation
    
    osst.c, st.c, scsi_debug.c annotated.

commit 51a1727571d0e9f03514342399bf02df196a2a52
Author: Alexander Viro <viro@parcelfarce.linux.theplanet.co.uk>
Date:   Thu Jun 3 10:39:10 2004 -0700

    [PATCH] sparse: gdth.c annotation

commit 59a34b75bdadd3171b1a64aa8a93360c79156096
Author: Alexander Viro <viro@parcelfarce.linux.theplanet.co.uk>
Date:   Thu Jun 3 10:38:59 2004 -0700

    [PATCH] sparse: hugetlb sysctl annotation

commit 73a660203f2d0625e1cec41d3d4caf23ecf3be7e
Author: Alexander Viro <viro@parcelfarce.linux.theplanet.co.uk>
Date:   Thu Jun 3 10:38:48 2004 -0700

    [PATCH] sparse: rest of net/* annotations (in this patchset, that is ;-)

commit 9e1b30a366b9dd66b4ff0ce56b243778bc0dddee
Author: Alexander Viro <viro@parcelfarce.linux.theplanet.co.uk>
Date:   Thu Jun 3 10:38:37 2004 -0700

    [PATCH] sparse: selinux annotation
    
    selinuxfs.c annotated

commit 019453ef118791c1b30ca093b7a8f5395d18503d
Author: Alexander Viro <viro@parcelfarce.linux.theplanet.co.uk>
Date:   Thu Jun 3 10:38:29 2004 -0700

    [PATCH] sparse: more wan annotations

commit 53f97fb4cac72e2939f3832816ebe2f10fc5144c
Author: Alexander Viro <viro@parcelfarce.linux.theplanet.co.uk>
Date:   Thu Jun 3 10:38:18 2004 -0700

    [PATCH] sparse: ->ifr_data fixes
    
    	b44.c: ->ioctl() is broken, since it uses &ifr->ifr_data instead of
    ifr->ifr_data itself.  Surprise, surprise, copy_from_user() on that address
    doesn't do any good...
    
    	baycom_epp.c: does get_user() of the first word of structure, then
    immediately does copy_from_user() on the entire thing and completely ignores
    the value read by get_user() (it uses the same value in copied structure
    instead).  Bogus get_user() call removed.

commit ee5cedda959d27baf2749401c78c39a6db818593
Author: Alexander Viro <viro@parcelfarce.linux.theplanet.co.uk>
Date:   Thu Jun 3 10:38:07 2004 -0700

    [PATCH] sparse: ->ifr_data annotation
    
    ->ifr_data users annotated.

commit b4674fe6bab78ff9748ecf3251a20f2eabb4a1c6
Merge: 90fc773... a0f562d...
Author: Anton Altaparmakov <aia21@cantab.net>
Date:   Thu Jun 3 18:10:22 2004 +0100

    Merge cantab.net:/usr/src/ntfs-2.6
    into cantab.net:/usr/src/ntfs-2.6-devel

commit fec498cab4676f8413b8c5a34cb92052d98c8c08
Author: Paul Mackerras <paulus@samba.org>
Date:   Thu Jun 3 08:43:54 2004 -0700

    [PATCH] ppc64: don't clear MSR.RI in do_hash_page_DSI
    
    Some code that is used on iSeries (do_hash_page_DSI in head.S) was
    clearing the RI (recoverable interrupt) bit in the MSR when it
    shouldn't.  We were getting SLB miss interrupts following that which
    were panicking because they appeared to have occurred at a bad place.
    This patch fixes the problem.  In fact it isn't necessary for
    do_hash_page_DSI to do anything to RI, so the patch changes the code
    to not set or clear it.
    
    Signed-off-by: Paul Mackerras <paulus@samba.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit 1e9188c24002a2a01d11499590c95e2e163384eb
Author: Alexander Viro <viro@parcelfarce.linux.theplanet.co.uk>
Date:   Thu Jun 3 08:34:34 2004 -0700

    [PATCH] sparse: mroute annotation

commit d75b0fd4ce8b204805485cc1f0446953b7752ec3
Author: Alexander Viro <viro@parcelfarce.linux.theplanet.co.uk>
Date:   Thu Jun 3 08:34:23 2004 -0700

    [PATCH] sparse: more netfilter annotation

commit 43638f5ef46c15864a8d05604b623bbcbd3fe18e
Author: Alexander Viro <viro@parcelfarce.linux.theplanet.co.uk>
Date:   Thu Jun 3 08:34:12 2004 -0700

    [PATCH] sparse: sctp annotation

commit c277c852f4913336b8f3c47a90d61c30fc7f5a4a
Author: Alexander Viro <viro@parcelfarce.linux.theplanet.co.uk>
Date:   Thu Jun 3 08:34:00 2004 -0700

    [PATCH] sparse: bluetooth annotation

commit b5da32d572fc67bbc7d0fd38445bdf41d4b49eb2
Author: David S. Miller <davem@nuts.davemloft.net>
Date:   Thu Jun 3 08:04:23 2004 -0700

    [NETFILTER]: In ipt_TCPMSS, SYN packets are never hw checksummed.
    
    Signed-off-by: David S. Miller <davem@redhat.com>

commit b0f171707fba2fc73bc104a6a79964c4f0cfc46f
Author: James Morris <jmorris@redhat.com>
Date:   Thu Jun 3 08:03:01 2004 -0700

    [NETFILTER]: Fix checksum bug for multicast/broadcast packets on postrouting hook.
    
    In a nutshell, skb checksum mangling has been removed from
    nf_hook_slow() and pushed up to whatever really needs to do it.
    
    Namely:  NAT, ip_fw_compat, ipt_TCPMSS, IPSec transforms.
    
    skb_checksum_help() has been changed to perform an skb_copy() if needed
    (e.g. the original problem case where bcast/mcast was cloning packets for
    transmission over loopback, changing ip_summed).
    
    Because of the above, the output path has been modified to take into
    account the fact that an skb may need to be changed in some places.  There
    are some minor changes in the routing code to take care of the now
    different input and output function prototypes.  The ipv6 fragmentation
    code has been modified to detect a changed skb.
    
    The rest of the patch (probably the bulk of it) is simply the result of
    changing to double skb pointers.
    
    I've tested this with ipv4, ipv6, ipsec (including xfrm bundles), NAT and
    the original DHCP test case.  Everything seems to be working ok.
    
    Signed-off-by: James Morris <jmorris@redhat.com>
    Signed-off-by: David S. Miller <davem@redhat.com>

commit f9280acd18138f1e1e2e04d49cc9b615dd492e2e
Author: Alexander Viro <viro@parcelfarce.linux.theplanet.co.uk>
Date:   Thu Jun 3 07:43:50 2004 -0700

    [PATCH] sparse: vlan annotation

commit eb3119f9c6cac802e0f80694126495b1bb46e357
Author: Alexander Viro <viro@parcelfarce.linux.theplanet.co.uk>
Date:   Thu Jun 3 07:43:39 2004 -0700

    [PATCH] sparse: irda annotation

commit 717b0cbce0914f5387ae65e6e8243828a54bc083
Author: Alexander Viro <viro@parcelfarce.linux.theplanet.co.uk>
Date:   Thu Jun 3 07:38:06 2004 -0700

    [PATCH] sparse: netlink annotation

commit 076d6e490047b9138678ce018316120e5b88718b
Author: Alexander Viro <viro@parcelfarce.linux.theplanet.co.uk>
Date:   Thu Jun 3 07:37:55 2004 -0700

    [PATCH] sparse: net/bridge annotation
    
    net/bridge partially annotated.
    
    There are nasty problems with net/bridge/netfilter/* and they'll need to
    be dealt with at some point - it mixes kernel and userland pointers a
    lot and while it seems to avoid obvious breakage, it's not a nice code.

commit 5e093b958ffe93019f5afc7ed17ccf6978c50a2e
Author: Alexander Viro <viro@parcelfarce.linux.theplanet.co.uk>
Date:   Thu Jun 3 07:37:44 2004 -0700

    [PATCH] sparse: wanrouter annotation

commit 1cc2d4bd68c95b209fbcacdfa2b903b2265810e1
Author: Alexander Viro <viro@parcelfarce.linux.theplanet.co.uk>
Date:   Thu Jun 3 07:37:33 2004 -0700

    [PATCH] sparse: econet annotation
    
    econet partially annotated.
    
    It's still badly broken - it mixes userland and kernel chunks in the
    same iovec, then does set_fs(KERNEL_FS) and sends that to
    sock_sendmsg().  Do we still want to support that protocol family,
    anyway?

commit e0ec03f4aa2ef5ee5afaf6cc2f679ef8af9263f7
Merge: a0f562d... 7681758...
Author: David Woodhouse <dwmw2@shinybook.infradead.org>
Date:   Thu Jun 3 15:35:05 2004 +0100

    Merge master.kernel.org:/home/torvalds/BK/linux-2.6
    into shinybook.infradead.org:/home/dwmw2/bk/sbc8260-2.6

commit 45e836f6e19400a17092daf5debbde3ddbfabd8b
Author: Alexander Viro <viro@parcelfarce.linux.theplanet.co.uk>
Date:   Thu Jun 3 07:29:23 2004 -0700

    [PATCH] sparse: appletalk annotation

commit 6b464d53f2231e2304e1f74917699c783f2529c4
Author: Alexander Viro <viro@parcelfarce.linux.theplanet.co.uk>
Date:   Thu Jun 3 07:29:13 2004 -0700

    [PATCH] sparse: ipx annotation

commit bd8ef6d35b87444c69277cc4647d24c9c614a089
Author: Alexander Viro <viro@parcelfarce.linux.theplanet.co.uk>
Date:   Thu Jun 3 07:27:41 2004 -0700

    [PATCH] sparse: x25 annotation

commit 6e3a9a7fdf562410a833b6aad5ae93f3ea6726f1
Author: Alexander Viro <viro@parcelfarce.linux.theplanet.co.uk>
Date:   Thu Jun 3 07:27:30 2004 -0700

    [PATCH] sparse: rose annotation

commit e48caf2cb01a87efcdd11fe36614f61c3ffe5741
Author: Alexander Viro <viro@parcelfarce.linux.theplanet.co.uk>
Date:   Thu Jun 3 07:27:19 2004 -0700

    [PATCH] sparse: netrom annotation

commit 4e8a8c6d268f171d868dbeaf7f9366e41f325eae
Author: Alexander Viro <viro@parcelfarce.linux.theplanet.co.uk>
Date:   Thu Jun 3 07:27:08 2004 -0700

    [PATCH] sparse: ax25 annotation

commit 2a55713c21a2ed20de30f0c9a8f8e37fc382708e
Author: Alexander Viro <viro@parcelfarce.linux.theplanet.co.uk>
Date:   Thu Jun 3 07:26:57 2004 -0700

    [PATCH] sparse: decnet annotation

commit 158f9d76bf8becd4a89cf7251a07e2987068981b
Author: Alexander Viro <viro@parcelfarce.linux.theplanet.co.uk>
Date:   Thu Jun 3 07:26:47 2004 -0700

    [PATCH] sparse: coda annotation

commit a247c9ecb3b4f8fa50ac934101edd8451baf97b0
Author: Alexander Viro <viro@parcelfarce.linux.theplanet.co.uk>
Date:   Thu Jun 3 07:02:54 2004 -0700

    [PATCH] sparse: atm annotation - drivers
    
    The rest of ATM annotation: drivers.

commit ad1dc3958e2078381efdd8b0fbe6c44b93759f98
Author: Alexander Viro <viro@parcelfarce.linux.theplanet.co.uk>
Date:   Thu Jun 3 07:02:43 2004 -0700

    [PATCH] sparse: atm annotation (core)
    
    ATM core annotated; ATM drivers will go in the next patch, here we only
    annotated their method prototypes

commit df127be5a6f22fc8b40202f29b4d539cc6ef9353
Merge: 2fd24c2... 1a932f8...
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Thu Jun 3 06:48:12 2004 -0700

    Merge bk://linux-dj.bkbits.net/cpufreq
    into ppc970.osdl.org:/home/torvalds/v2.6/linux

commit 1a932f8e34c740ef880cb46b6d01b5a5067b8625
Author: Dave Jones <davej@redhat.com>
Date:   Fri Jun 4 01:53:06 2004 +0100

    [CPUFREQ] Convert longhaul debug printk to use varargs.
    From: Joe Perches.
    Signed-off-by: Dave Jones <davej@redhat.com>

commit e589bd06a760c923e2a9601e8c0ec90d3090833f
Author: Dave Jones <davej@redhat.com>
Date:   Fri Jun 4 01:46:25 2004 +0100

    [CPUFREQ] Remove bogus longhaul v4
    The code only supports 3 versions, so numbering them 1,2 and 4
    doesn't make a lot of sense.
    Signed-off-by: Dave Jones <davej@redhat.com>

commit 3e5fa20333b5add4d20f522e236d47b40f2dac74
Author: Dave Jones <davej@redhat.com>
Date:   Fri Jun 4 01:44:00 2004 +0100

    [CPUFREQ] Move longhaul multiplier debug printk to somewhere more useful.
    If we abort due to a reserved FSB being found, we probably want to know the multipliers.
    
    Signed-off-by: Dave Jones <davej@redhat.com>

commit cdf589b4f6b99f972114a66842b83caccdfba830
Author: Dave Jones <davej@redhat.com>
Date:   Fri Jun 4 01:42:37 2004 +0100

    [CPUFREQ] Remove duplicate debug printk from longhaul driver.
    Signed-off-by: Dave Jones <davej@redhat.com>

commit 10de3fe5852461aee2a818184e4b6cc9e9678218
Author: Dave Jones <davej@redhat.com>
Date:   Fri Jun 4 01:40:20 2004 +0100

    [CPUFREQ] Unify the EBLCR parsing code in longhaul.
    Signed-off-by: Dave Jones <davej@redhat.com>

commit 4d20dcd21c51bd6dcf325f37dceda713e6665566
Author: Dave Jones <davej@redhat.com>
Date:   Fri Jun 4 01:34:18 2004 +0100

    [CPUFREQ] Document some oddness in the longhaul driver.
    Signed-off-by: Dave Jones <davej@redhat.com>

commit 03f0dd683b82bc90b4ae1cb127230a2439b9920f
Author: Dave Jones <davej@redhat.com>
Date:   Fri Jun 4 01:29:42 2004 +0100

    [CPUFREQ] Remove lots of redundant code from longhaul driver.
    The recent Nehemiah changes introduced lots of stuff that does
    a whole lot of nothing. Nuke it.
    
    Signed-off-by: Dave Jones <davej@redhat.com>

commit f27803af09f1effa9ef1acfbd32b220e68a7eec1
Author: Dave Jones <davej@redhat.com>
Date:   Fri Jun 4 01:24:07 2004 +0100

    [CPUFREQ] Fix powernow-k7 when ACPI_PROCESSOR built as module.
    
    From Herbert Xu
    Signed-off-by: Dave Jones <davej@redhat.com>

commit 024d1f0196a5557f81bcbbb705af2759e3962faf
Author: Dave Jones <davej@redhat.com>
Date:   Fri Jun 4 00:34:21 2004 +0100

    [CPUFREQ] Change longhaul debugging info printk's to dprintk's

commit d5fd9cdb45bb022e0e5a636bd78cc4bd6c2a0608
Author: Dave Jones <davej@redhat.com>
Date:   Thu Jun 3 18:00:55 2004 +0100

    [CPUFREQ] Remove duplicate declaration of debug var from longhaul.
    Spotted by Joe Perches.
    
    I'm surprised gcc didn't at least warn about this.
    
    Signed-off-by: Dave Jones <davej@redhat.com>

commit 308f5c739190d83b748d7d9a73ee3606de53aa89
Merge: 20e743b... 5a9e6dc...
Author: Dave Jones <davej@delerium.codemonkey.org.uk>
Date:   Thu Jun 3 15:23:23 2004 +0100

    Merge bk://linux-dj.bkbits.net/cpufreq
    into delerium.codemonkey.org.uk:/mnt/data/src/bk/cpufreq

commit 2fd24c2d06ac874632ec79da5af1ca85d7f7c49b
Merge: 9d4c0b7... 8a48b71...
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Thu Jun 3 06:40:47 2004 -0700

    Merge bk://kernel.bkbits.net/davem/sparc-2.6
    into ppc970.osdl.org:/home/torvalds/v2.6/linux

commit 8a48b711144785cb5045e6a6a44a1cd368bfdb00
Author: Alexander Viro <viro@parcelfarce.linux.theplanet.co.uk>
Date:   Thu Jun 3 06:38:25 2004 -0700

    [PATCH] drivers/atm/horizon.c delousing
    
    Same as with ambassador.c - same authors, same braindamage.

commit 5917ab47fdced429421c9c98c1304fa6a9490357
Author: Alexander Viro <viro@parcelfarce.linux.theplanet.co.uk>
Date:   Thu Jun 3 06:38:14 2004 -0700

    [PATCH] drivers/atm/ambassador.c delousing
    
    Translated to C.  Original was anything but.
    
    BTW, even if they were writing in Pascal, their use of nested functions
    would be gratuitous for such a situation.

commit 8c8813852f13538df97d04a9c77f5f6b2dbb7033
Author: Alexander Viro <viro@parcelfarce.linux.theplanet.co.uk>
Date:   Thu Jun 3 06:28:37 2004 -0700

    [PATCH] sparse: rest of drivers/block annotation

commit fe2a5a141977885af85fa5413347926c079cfaaa
Author: Alexander Viro <viro@parcelfarce.linux.theplanet.co.uk>
Date:   Thu Jun 3 06:28:26 2004 -0700

    [PATCH] sparse: paride annotation

commit 8a2e7a53e4cab3ce60737e64bc82ecbe976925bd
Author: Alexander Viro <viro@parcelfarce.linux.theplanet.co.uk>
Date:   Thu Jun 3 06:28:16 2004 -0700

    [PATCH] sparse: cpqarray annotation

commit bacd80d45a49d234b20b05c8f9a589fcce14dc9f
Author: Alexander Viro <viro@parcelfarce.linux.theplanet.co.uk>
Date:   Thu Jun 3 06:28:05 2004 -0700

    [PATCH] sparse: cciss annotation
    
    cciss annotated, definition of inlined helpers moved up - before their
    first use.

commit bc6567f9eeb6974b1c667e4052a1f4ffe3fd0e97
Author: Alexander Viro <viro@parcelfarce.linux.theplanet.co.uk>
Date:   Thu Jun 3 06:27:54 2004 -0700

    [PATCH] sparse: DAC960 annotation

commit 5bd049f88006f490a8c8fb438d6a7d7aefebc6b9
Author: Alexander Viro <viro@parcelfarce.linux.theplanet.co.uk>
Date:   Thu Jun 3 06:27:43 2004 -0700

    [PATCH] sparse: drivers/pnp annotation

commit 3e83f872ba330bf2a6701b8a43fdfebf3016bfc4
Author: Alexander Viro <viro@parcelfarce.linux.theplanet.co.uk>
Date:   Thu Jun 3 06:27:32 2004 -0700

    [PATCH] sparse: drivers/md annotation

commit bd12c17ccdda57ca5b484bb7d5290fc754170406
Author: Alexander Viro <viro@parcelfarce.linux.theplanet.co.uk>
Date:   Thu Jun 3 06:27:21 2004 -0700

    [PATCH] sparse: drivers/cdrom annotation

commit 4743adaa809452fd1705f23d72fbf22f3091e223
Author: Alexander Viro <viro@parcelfarce.linux.theplanet.co.uk>
Date:   Thu Jun 3 06:27:10 2004 -0700

    [PATCH] sparse: drivers/cpufreq annotation
    
    drivers/cpufreq annotated

commit 2c37fa03ac935bf5f03d9ae7d7dc61ba4fda151a
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Thu Jun 3 05:54:49 2004 -0700

    sparse: annotate (and comment on) kmod.c user pointer usage
    
    Big comment, because it wasn't clear why this cast was valid.
    
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit 1274bd1e0a9cfaaf18c40983c730badea9f7e733
Author: Alexander Viro <viro@www.linux.org.uk>
Date:   Thu Jun 3 05:41:31 2004 -0700

    [PATCH] sparse: forte annotation
    
    forte annotated

commit a500bcb79f7cfef9f65765dbe9550d69c7151d71
Author: Alexander Viro <viro@www.linux.org.uk>
Date:   Thu Jun 3 05:41:21 2004 -0700

    [PATCH] sparse: msnd annotation
    
    msnd annotated

commit a83d576c4ceb98596debf571d7686533a8e73f57
Author: Alexander Viro <viro@www.linux.org.uk>
Date:   Thu Jun 3 05:41:10 2004 -0700

    [PATCH] sparse: ymfpci annotation
    
    ymfpci annotated

commit 6f7fe3ef16d0674eb5fc80457485f6a314bb5844
Author: Alexander Viro <viro@www.linux.org.uk>
Date:   Thu Jun 3 05:40:59 2004 -0700

    [PATCH] sparse: maestro annotation
    
    maestro annotated

commit b6aef03978475af14dc448c95f48949bc74eb2b5
Author: Alexander Viro <viro@www.linux.org.uk>
Date:   Thu Jun 3 05:40:48 2004 -0700

    [PATCH] sparse: btaudio annotation
    
    btaudio annotated

commit 936f0e7da8c32647eea9cd0e1f9d760688eccc28
Author: Alexander Viro <viro@www.linux.org.uk>
Date:   Thu Jun 3 05:40:37 2004 -0700

    [PATCH] sparse: ad1889 annotation
    
    ad1889 annotated

commit aff8ccb8d2b9b77338c0e5ce327072b716a345bb
Author: Alexander Viro <viro@www.linux.org.uk>
Date:   Thu Jun 3 05:40:27 2004 -0700

    [PATCH] sparse: the rest of sound/* annotation
    
    Remaining bits and pieces in sound/oss annotated.
    
    At that point sound/* is done - we have no noise warnings left there.

commit 239429ed4df62b88b0f418d7e90fd717960684b9
Author: Alexander Viro <viro@www.linux.org.uk>
Date:   Thu Jun 3 05:40:16 2004 -0700

    [PATCH] sparse: maestro3 annotation
    
    maestro3 annotated

commit 746c771e3d70918910900f7982da343aa7ea1462
Author: Alexander Viro <viro@www.linux.org.uk>
Date:   Thu Jun 3 05:40:06 2004 -0700

    [PATCH] sparse: sonicvibes annotation
    
    sonicvibes annotated

commit c0b6b657addb18e69f979a437b42667213121943
Author: Alexander Viro <viro@www.linux.org.uk>
Date:   Thu Jun 3 05:39:55 2004 -0700

    [PATCH] sparse: ali5455 annotation
    
    ali5455 annotated

commit 2e2cb285b7359fc8da707ee478c159d997c318b3
Author: Alexander Viro <viro@www.linux.org.uk>
Date:   Thu Jun 3 05:39:44 2004 -0700

    [PATCH] sparse: cs46xx annotation
    
    cs46xx annotated

commit 35a2f28eeef1378f81107cf41533ec6587f07772
Author: Alexander Viro <viro@www.linux.org.uk>
Date:   Thu Jun 3 05:39:33 2004 -0700

    [PATCH] sparse: i810 annotation
    
    i810 annotated

commit d361e46c25b7ce32ad8b32dae43bc861790c226e
Author: Alexander Viro <viro@www.linux.org.uk>
Date:   Thu Jun 3 05:39:22 2004 -0700

    [PATCH] sparse: rme96xx annotation
    
    rme96xx annotated

commit c55cab848583a831fd6cc7e01b65f7d5fb46efe4
Author: Alexander Viro <viro@parcelfarce.linux.theplanet.co.uk>
Date:   Thu Jun 3 05:39:11 2004 -0700

    [PATCH] sparse: esssolo annotation
    
    esssolo annotated

commit 6c2c695f096d0a38d96667670827d2b5e52fd08c
Author: Alexander Viro <viro@parcelfarce.linux.theplanet.co.uk>
Date:   Thu Jun 3 05:39:00 2004 -0700

    [PATCH] sparse: es1370 annotation
    
    es1370 annotated

commit a2963a6121988e277c50d9cb3c8304832f4f094a
Author: Alexander Viro <viro@parcelfarce.linux.theplanet.co.uk>
Date:   Thu Jun 3 05:38:50 2004 -0700

    [PATCH] sparse: es1371 annotation
    
    es1371 annotated

commit 93e9a5218808151d8810151cdfe51fc2548fdfab
Author: Alexander Viro <viro@parcelfarce.linux.theplanet.co.uk>
Date:   Thu Jun 3 05:38:39 2004 -0700

    [PATCH] sparse: cmpci annotation
    
    cmpci annotated

commit 0dba19d2e840d6295a1a24edf5c215f044449114
Author: Alexander Viro <viro@parcelfarce.linux.theplanet.co.uk>
Date:   Thu Jun 3 05:38:28 2004 -0700

    [PATCH] sparse: cs4281 annotation
    
    cs4281 annotated

commit 861cba552f81b2397c65ae625c15210cf22ac94c
Author: Alexander Viro <viro@parcelfarce.linux.theplanet.co.uk>
Date:   Thu Jun 3 05:38:17 2004 -0700

    [PATCH] sparse: rest of ALSA annotation
    
    The rest of annotation for ALSA drivers; only OSS stuff left to do in
    sound/*

commit b83776febdc25abbf16ea959436ff33b94688515
Author: Alexander Viro <viro@parcelfarce.linux.theplanet.co.uk>
Date:   Thu Jun 3 05:38:05 2004 -0700

    [PATCH] sparse: emu10k1 annotation
    
    emu10k1 annotated.

commit 099a47a26e971e868f2e31f1836a323035d1cde6
Author: Alexander Viro <viro@parcelfarce.linux.theplanet.co.uk>
Date:   Thu Jun 3 05:37:54 2004 -0700

    [PATCH] sparse: rme9652 annotation
    
    Annotated driver and ioctl structure used by it.

commit 2996867de4d3364faa637d85644b108c9e68d4d7
Author: Alexander Viro <viro@parcelfarce.linux.theplanet.co.uk>
Date:   Thu Jun 3 05:37:43 2004 -0700

    [PATCH] sparse: trident annotation
    
    Both ALSA and OSS variants

commit 2b7485b46e34084b5374c85050378ff47020b221
Author: Alexander Viro <viro@parcelfarce.linux.theplanet.co.uk>
Date:   Thu Jun 3 05:37:32 2004 -0700

    [PATCH] sparse: vx annotation
    
    Both PCI and PCMCIA variants of driver annotated

commit 7606f3c86f7d6c51e5140c2bc85cc8c3c4512c48
Author: Alexander Viro <viro@parcelfarce.linux.theplanet.co.uk>
Date:   Thu Jun 3 05:37:22 2004 -0700

    [PATCH] sparse: sb annotation
    
    sb annotation (both ALSA and OSS drivers)

commit f60c96bee7e2b863da0b533ffb900a3629ea0084
Merge: 52e441e... 6675c8e...
Author: Steve French <cifs.adm@hostme.bitkeeper.com>
Date:   Thu Jun 3 04:30:06 2004 -0700

    Merge bk://linux.bkbits.net/linux-2.5
    into hostme.bitkeeper.com:/repos/c/cifs/linux-2.5cifs

commit 5a1c7700d664d88062c69842efd693f5a1aa03af
Author: Alexander Viro <viro@parcelfarce.linux.theplanet.co.uk>
Date:   Thu Jun 3 04:19:22 2004 -0700

    [PATCH] sparse: wavefront annotation
    
    Both ALSA and OSS drivers + wavefront ioctl structure annotated.  NB:
    both should be switched to generic firmware loading - as it is, they are
    using a homegrown and rather ugly variant

commit 76ae908ac866c44a9bf1cda11089f3048d3de93a
Author: Alexander Viro <viro@parcelfarce.linux.theplanet.co.uk>
Date:   Thu Jun 3 04:19:11 2004 -0700

    [PATCH] sparse: sscape annotation

commit 0fff631bd266156b0dcba44b9396f7ba85e8a0f6
Author: Alexander Viro <viro@parcelfarce.linux.theplanet.co.uk>
Date:   Thu Jun 3 04:19:00 2004 -0700

    [PATCH] sparse: sound/isa/gus annotation
    
    GUS annotated.

commit 9d7a2c2dd6bae2ef1347b5eacbeb181773de660a
Author: Alexander Viro <viro@parcelfarce.linux.theplanet.co.uk>
Date:   Thu Jun 3 04:18:49 2004 -0700

    [PATCH] sparse: rest of sound/core
    
    The rest of sond/core annotated; reverted bogus addition of __user in
    snd_seq_kernel_client_ctl() - I should've guessed from the name alone
    ;-)

commit e3b784cf04a45dda32b0dc99ecb7bcfaa06c3d0d
Author: Alexander Viro <viro@parcelfarce.linux.theplanet.co.uk>
Date:   Thu Jun 3 04:18:40 2004 -0700

    [PATCH] sparse: opl annatation
    
    Annotated sound/drivers/opl*

commit 5851bd06d625076f893eb4d40fe776ead1faaecd
Author: Alexander Viro <viro@parcelfarce.linux.theplanet.co.uk>
Date:   Thu Jun 3 04:18:29 2004 -0700

    [PATCH] sparse: sound/core/pcm* annotation
    
    The tricky part here was an iterator that used to take a callback and
    argument for that callback as parameters.  Iterator itself didn't care
    what type that argument had been; it's entirely up to callback.  The
    thing is, two callbacks expect (and get) char __user * while other two
    expect (and also get) char __user **.
    
    Iterator used to use void * as "opaque data"; I've switched it to
    unsigned long.  Note that there was nothing that said "it's a pointer" -
    use of callback that would take e.g.  int is also perfectly legitimate.
    
    The rest is triviali annotation.

commit 9d4c0b74ade6467b973a60df4f2f82f629ba6b54
Merge: 52e441e... 0324132...
Author: David S. Miller <davem@kernel.bkbits.net>
Date:   Thu Jun 3 03:55:46 2004 -0700

    Merge davem@nuts.davemloft.net:/disk1/BK/sparc-2.6
    into kernel.bkbits.net:/home/davem/sparc-2.6

commit e343efc844c23e739673418bde00ee489f97d58e
Author: Sridhar Samudrala <sri@us.ibm.com>
Date:   Thu Jun 3 03:46:29 2004 -0700

    [SCTP] Fix poll() on a 1-1 style socket so that it returns when the
    association is aborted by peer.

commit 2d69d940108de78651b6aa1ff95ed85fce6e0e2f
Author: Arun Sharma <arun.sharma@intel.com>
Date:   Thu Jun 3 03:41:08 2004 -0700

    [PATCH] ia64: disable in-kernel ia32 emulation post Madison
    
    For IPF processors beyond Madison, this patches changes the kernel to
    allow IA-32 application execution exclusively using IA-32EL.
    
    Signed-off-by: Arun Sharma <arun.sharma@intel.com>
    Signed-off-by: David Mosberger <davidm@hpl.hp.com>

commit 985e146fe3a1d4cb721b429dcdc94ffdc1b3af29
Author: Sridhar Samudrala <sri@us.ibm.com>
Date:   Thu Jun 3 03:40:49 2004 -0700

    [SCTP] Fix to wakeup blocking connect() after max INIT retries failed.

commit 386f9ab36538c2842f659634cf2d139b5e3da6c0
Author: Sridhar Samudrala <sri@us.ibm.com>
Date:   Thu Jun 3 03:33:41 2004 -0700

    [SCTP] Fix missing VTAG validation on certain incoming packets.

commit 5dfadd6a810e51bfc65b4fe348798631f829f348
Author: Arun Sharma <arun.sharma@intel.com>
Date:   Thu Jun 3 03:26:51 2004 -0700

    [PATCH] ia64: tighten FPH state context switch check
    
    In the absence of this patch, a process can set it's own mfh bit and
    potentially view another process's high floating point registers. So a
    check is needed.
    
    Signed-off-by: Arun Sharma <arun.sharma@intel.com>
    Signed-off-by: David Mosberger <davidm@hpl.hp.com>

commit 13ee2364e864ab633f7341d2c5b88eb935226b3e
Author: Sridhar Samudrala <sri@us.ibm.com>
Date:   Thu Jun 3 03:26:13 2004 -0700

    [SCTP] Fix the use of cached non-zero vtag in an INIT that is resent
    after a stale cookie error.

commit 7bf4c64289351241e3dcae291bb76360c75e2178
Author: Pat Gefre <pfg@sgi.com>
Date:   Thu Jun 3 03:20:24 2004 -0700

    [PATCH] ia64: for SN2, disable MST errors on probe
    
    Signed-off-by: David Mosberger <davidm@hpl.hp.com>

commit 9d6498b10161644b916d1d38e82f320a13ef4817
Author: Jorge Hernandez-Herrero <jhh@lucent.com>
Date:   Thu Jun 3 03:19:57 2004 -0700

    [SCTP] Fix to not start a new association on a 1-many style sendmsg()
    with MSG_EOF/MSG_ABORT flag and no data.

commit f5dfceb1aeacbed5cb294bc54ae966eb5e134dec
Author: Jorge Hernandez-Herrero <jhh@lucent.com>
Date:   Thu Jun 3 03:16:07 2004 -0700

    [SCTP] Fix to not setup a new association if the endpoint is in
    SHUTDOWN_ACK_SENT state and recognizes that the peer has restarted.

commit 52e441e408d7a585dd12800d239c971c875a2192
Author: Alexander Viro <viro@parcelfarce.linux.theplanet.co.uk>
Date:   Thu Jun 3 02:48:01 2004 -0700

    [PATCH] sparse: annotation of include/sound (generic parts)
    
    Annotated method prototypes, commonly used ioctl-only structures and
    generic helpers.
    
    Instances of methods in drivers are _not_ annotated at that point - they
    will go with driver patches

commit 3f85e843c1b7c30a3767a26b9328dec492012b1c
Author: Alexander Viro <viro@parcelfarce.linux.theplanet.co.uk>
Date:   Thu Jun 3 02:47:51 2004 -0700

    [PATCH] sparse: sound/core annotation - trivial part
    
    Trivial parts of sound/core annotation.

commit e954b6f6756c055e221df4f7ab2d7ef94501a5f4
Author: Alexander Viro <viro@parcelfarce.linux.theplanet.co.uk>
Date:   Thu Jun 3 02:47:39 2004 -0700

    [PATCH] sparse: sound/core/timer.c fix
    
    copy_from_user() where copy_to_user() should've been.  Unfortunately, on
    x86 they are almost identical, so it went unnoticed for quite a while.

commit e29b3d48f5cbaa4fa6255569e3204444fe205661
Author: Alexander Viro <viro@parcelfarce.linux.theplanet.co.uk>
Date:   Thu Jun 3 02:47:28 2004 -0700

    [PATCH] sparse: msnd sound fix
    
    msnd_pinnacle/msnd_classic do copy_{to,from}_user under a spinlock.
    
    Taken out of spinlock (into a temp. buffer). Calls of msnd_fifo_{read,write}
    always go from kernel buffer now, so we can drop the 'int user' argument in
    them _and_ simplify error handling - all errors were from copy_..._user() and
    now these are called directly by dsp_read()/dsp_write().

commit ac1aff9920bd6f8b12972fc376bc41b64fa2cf4e
Author: Alexander Viro <viro@parcelfarce.linux.theplanet.co.uk>
Date:   Thu Jun 3 02:47:17 2004 -0700

    [PATCH] sparse: sound sb fix
    
    	In some cases snd_sb_csp_load() did kmalloc() and copy_from_user()
    under a spinlock.  Split into snd_sb_csp_load() and snd_sb_csp_load_user() -
    ther former always from kernel pointer, the latter - from userland.
    	snd_sb_csp_load_user() doesn't take any locks itself, it just
    does kmalloc, copy_from_user and calls snd_sb_csp_load() to do the rest.

commit a6b0d9d233286121de038470f91034679a73123f
Author: Andrew Morton <akpm@osdl.org>
Date:   Thu Jun 3 02:12:53 2004 -0700

    [PATCH] Add the sixth arg to the sys_futex() prototype.
    
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit 97c5291a64f21a4c1c6ed6ec4422d95f9092c65f
Merge: fef3278... 1b0d7f2...
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Thu Jun 3 02:11:33 2004 -0700

    Merge bk://bk.arm.linux.org.uk/linux-2.6-serial
    into ppc970.osdl.org:/home/torvalds/v2.6/linux

commit 1b0d7f269ef116f676c9d4f7681e17e46498bec5
Author: Ben Dooks <ben-linux@org.rmk.(none)>
Date:   Thu Jun 3 17:34:49 2004 +0100

    [ARM PATCH] 1906/1: S3C2410: serial minor number fix
    
    Patch from Ben Dooks
    
    Fix the minor number of the serial device to be the same
    as the configuration in the 2.4.x series kernels.

commit fef3278f85e189a7206a1ac4fc841aafd0c22339
Merge: 5ab27ef... 25cc28b...
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Thu Jun 3 02:09:47 2004 -0700

    Merge bk://bk.arm.linux.org.uk/linux-2.6-pcmcia
    into ppc970.osdl.org:/home/torvalds/v2.6/linux

commit 25cc28bff22f5b2168b33f8ca1554c3daeb2c07e
Author: Ian Campbell <icampbell@com.rmk.(none)>
Date:   Thu Jun 3 23:13:07 2004 +0100

    [ARM PATCH] 1890/2:  Consolidate CPUFREQ handling in SOC PCMCIA driver
    
    Patch from Ian Campbell
    
    Rediffed against latest BK. Compiles on Assabet and my PXA255
    
    platform. Tested on my 255 platform.

commit 5ab27ef069b7d11104a29b27da0875b9190a5e56
Merge: 8d0a8e9... e7be8ac...
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Thu Jun 3 02:07:03 2004 -0700

    Merge bk://bk.arm.linux.org.uk/linux-2.6-rmk
    into ppc970.osdl.org:/home/torvalds/v2.6/linux

commit 8d0a8e951237568ff64170a6a08be503aff678c4
Author: Nicolas Pitre <nico@org.rmk.(none)>
Date:   Thu Jun 3 22:04:33 2004 +0100

    [ARM PATCH] 1910/1: rework Mainstone and IDP include files
    
    Patch from Nicolas Pitre
    
    Don't include them from hardware.h

commit 8b084b62a8d4396562f5e85e151a2417e4049ad9
Author: Russell King <rmk@flint.arm.linux.org.uk>
Date:   Thu Jun 3 19:01:25 2004 +0100

    [ARM] Don't include lubbock.h in asm/arch/hardware.h
    
    Since asm/arch/hardware.h is included (indirectly) by most kernel
    files, we don't want all these files depending on the individual
    machine support files, especially as only five files really require
    the header.
    
    Instead, explicitly include lubbock.h into files as necessary.

commit 3b229157b19f5439970053fda29a0a2f8dfe4462
Author: Tony Lindgren <tony@com.rmk.(none)>
Date:   Thu Jun 3 17:21:54 2004 +0100

    [ARM PATCH] 1902/1: OMAP update 1/3: entry-armv.S
    
    Patch from Tony Lindgren
    
    Update the IO register names in entry-armv.S

commit 6675c8e14da9f84b9401d10f5aadece88b0179aa
Merge: 727a7f7... 2f09ecb...
Author: Steve French <cifs.adm@hostme.bitkeeper.com>
Date:   Thu Jun 3 02:01:47 2004 -0700

    Merge bk://linux.bkbits.net/linux-2.5
    into hostme.bitkeeper.com:/repos/c/cifs/linux-2.5cifs

commit 2f09ecb45a2bb3c873b9be60dad1317a4795f78f
Author: Steve French <stevef@stevef95.austin.ibm.com>
Date:   Thu Jun 3 07:29:27 2004 -0500

    whitespace and comment cleanup
    
    Signed-off-by: Steve French (sfrench@us.ibm.com)

commit e7be8acdacffb41f69a97a5c4cf479f3067412ff
Author: Paul Mackerras <paulus@samba.org>
Date:   Thu Jun 3 01:06:05 2004 -0700

    [PATCH] ppc32: Fix locks.c properly this time
    
    When I moved the exports into arch/ppc/lib/locks.c, I forgot to
    include module.h, so it doesn't compile (with CONFIG_SMP +
    CONFIG_SPINLOCK_DEBUG).  This patch fixes it.
    
    Signed-off-by: Paul Mackerras <paulus@samba.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit 0324132c0cdc5f27631cb62b419ed5a19e98f74c
Author: David S. Miller <davem@nuts.davemloft.net>
Date:   Thu Jun 3 00:54:24 2004 -0700

    [SPARC64]: Update defconfig.

commit c8402d16b3b7daff751ec8f8f22ba518ffa7dda3
Author: David S. Miller <davem@nuts.davemloft.net>
Date:   Thu Jun 3 00:51:40 2004 -0700

    [SPARC64]: New 6th arg of sys_futex needs sign extension.

commit c84915b3d8afa3ef7fc8f46aaea3c04802a93b28
Author: Christoph Hellwig <hch@lst.de>
Date:   Thu Jun 3 00:44:52 2004 -0700

    [SBUS]: Further cleanup of scsi driver header usage.

commit a750ebf15941ba6c396f307c8e5425c34ea18fb9
Author: Christoph Hellwig <hch@lst.de>
Date:   Thu Jun 3 00:44:08 2004 -0700

    [ATM]: Simplify fore200e DMA macros even further.

commit c0cc37a52aaac2f631f740c15b13fad83b64ea3b
Author: Bartlomiej Zolnierkiewicz <b.zolnierkiewicz@elka.pw.edu.pl>
Date:   Wed Jun 2 23:16:15 2004 -0700

    [PATCH] DMA mode setup fixes for piix.c/ata_piix.c
    
    From: Go Taniguchi <go@turbolinux.co.jp> (Turbolinx Inc.)
    
    Change reg48 and reg54 in 8bit access and remove unused reg44.
    
    Jeff acked ata_piix.c part.
    
    Signed-off-by: Bartlomiej Zolnierkiewicz <bzolnier@elka.pw.edu.pl>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit 727a7f73a46d24f42a33d380a35ef67d18c73217
Author: Russell King <rmk+lkml@arm.linux.org.uk>
Date:   Wed Jun 2 18:26:30 2004 -0700

    [PATCH] Export swapper_space
    
    swapper_space is needed by at least loop/st/sg these days.

commit f80063e9aed834699ee74b7f8a302bd5c4b7fa6e
Author: Paul Mackerras <paulus@samba.org>
Date:   Wed Jun 2 18:22:18 2004 -0700

    [PATCH] ppc32: Reduce WARN_ON(0) to nothing
    
    The last patch I sent means that we have WARN_ON(0) in a couple of
    places when CONFIG_PREEMPT=n.  This patch makes that reduce to
    nothing (rather than a conditional trap on a 0 value), and also makes
    BUG_ON(0) reduce to nothing for completeness.
    
    Signed-off-by: Paul Mackerras <paulus@samba.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit 717f88507446b3ece2a2345469e174453d431d01
Author: Paul Mackerras <paulus@samba.org>
Date:   Wed Jun 2 18:22:08 2004 -0700

    [PATCH] ppc32: Fix preemptible check
    
    Ben H added a check in a couple of places to make sure that we had
    preemption disabled when we call enable_kernel_{fp,altivec}.
    Unfortunately the check he used trips in the case when
    CONFIG_PREEMPT=n.  This patch fixes it by defining a preemptible()
    macro (which reduces to 0 when CONFIG_PREEMPT=n) and doing
    WARN_ON(preemptible()).
    
    Signed-off-by: Paul Mackerras <paulus@samba.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit 9dfbbd917ee79f5bff02e5b67ffc10c526e4a2e3
Author: Paul Mackerras <paulus@samba.org>
Date:   Wed Jun 2 18:21:57 2004 -0700

    [PATCH] ppc32: Make ppc32 PCI code more robust
    
    The main thrust of this patch is to make the ppc32 PCI code more
    robust by checking for bus->resource[] being NULL before using it.  We
    can legitimately get elements of bus->resource being NULL and I have
    actually hit that on some machines.  This patch also allows resources
    starting at 0 to be accepted as assigned (we can and do get PCI
    resources starting at 0 in I/O space on PPC machines) and provides a
    sensible default for the case where Open Firmware doesn't give us a
    bus-range property for a PCI bridge.
    
    Signed-off-by: Paul Mackerras <paulus@samba.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit e7de4bdb173597e615e37c7221ba50051df2fd58
Author: Paul Mackerras <paulus@samba.org>
Date:   Wed Jun 2 18:21:47 2004 -0700

    [PATCH] ppc32: Use -fPIC instead of -mrelocatable-lib
    
    The ppc32 boot code has a couple of files that are executed very early
    on before the kernel is mapped at the address it is linked at.  We
    have been using -mrelocatable-lib to compile these files, but
    apparently -mrelocatable-lib is deprecated and the gcc developers are
    threatening to remove it.  In fact the -fPIC flag does what we need.
    This patch changes -mrelocatable-lib to -fPIC.
    
    Signed-off-by: Paul Mackerras <paulus@samba.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit 27ad14bc3b313e4a625094dc1bf794d842c08040
Author: Paul Mackerras <paulus@samba.org>
Date:   Wed Jun 2 18:21:36 2004 -0700

    [PATCH] ppc32: Suppress bogus info in /proc/ppc_htab on 64-bit cpus
    
    In the ppc32 kernel, we have a /proc/ppc_htab file that trawls through
    the MMU hash table and prints various statistics on it such as percent
    occupancy.  However, the hash table entry format is different on
    64-bit cpus (POWER3, G5) which the ppc32 kernel does support (in
    32-bit mode).
    
    This patch disables the scanning of the MMU hash table and printing of
    the statistics that we get from it on 64-bit cpus.  Since the
    statistics are only for interest, and the ppc32 kernel is being used
    less and less on 64-bit cpus now that the ppc64 kernel is in
    reasonable shape, I didn't think it worth while to add code to deal
    with the 64-bit HPTE format.
    
    Signed-off-by: Paul Mackerras <paulus@samba.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit dcc579a642d9135b68e6f18063fad1aa41c14d70
Author: Paul Mackerras <paulus@samba.org>
Date:   Wed Jun 2 18:21:26 2004 -0700

    [PATCH] ppc32: Don't synchronize in disable_irq() if no handler
    
    This patch is the ppc32 counterpart to a fix that went into
    arch/i386/kernel/irq.c last October.  The bug was noted by Al Viro: if
    no handler exists, and we have IRQ_INPROGRESS set because of an
    earlier irq that got through, synchronize_irq() will end up waiting
    forever.
    
    Signed-off-by: Paul Mackerras <paulus@samba.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit d2b8378d0b3435deeec3ed671e1733bae547fb28
Author: Paul Mackerras <paulus@samba.org>
Date:   Wed Jun 2 18:21:15 2004 -0700

    [PATCH] ppc32: Add _raw_write_trylock
    
    I tried compiling a PPC32 kernel with PREEMPT + SMP and it failed
    because we didn't have a _raw_write_trylock.  This patch adds
    _raw_write_trylock, moves the exports of _raw_*lock from
    arch/ppc/kernel/ppc_ksyms.c to arch/ppc/lib/locks.c, and makes
    __spin_trylock static since it is only used in locks.c.
    
    Signed-off-by: Paul Mackerras <paulus@samba.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit 0ad8699acd245b2a69adf6798dfc58236602a41b
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Wed Jun 2 18:20:09 2004 -0700

    sparse: fix up futex address space warning

commit de9aa967313bcc76b06aafc31f008119f9b716ee
Author: Andrew Morton <akpm@osdl.org>
Date:   Wed Jun 2 18:05:20 2004 -0700

    [PATCH] direct-io invalidation fix
    
    clean_blockdev_aliases() is using the wrong thing to work out how many
    filesystem blocks should be invalidated.  It invalidates too many, which can
    cause live fs metadata buffers to be invalidated when they are pending
    writeout.  It's a filesystem-wrecker, although seems very hard to hit.
    
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit 2ba1bdccac7d4e36a1774b6ce335e95120717999
Author: Andrew Morton <akpm@osdl.org>
Date:   Wed Jun 2 18:05:09 2004 -0700

    [PATCH] bug in sys_io_setup
    
    From: Jerzy Szczepkowski <js189202@zodiac.mimuw.edu.pl>
    
    There is a bug in sys_io_setup().
    
    If ioctx_alloc() succeeds and put_user() fails io_destroy() is called.
    io_destroy() assumes that ioctx->users >= 2 (if context is alive) and calls
    put_ioctx twice, while in this sequence ioctx->users == 1.
    
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit 306ad72c3e474a17b6cbcb8d36a279fbdeae7a73
Author: Andrew Morton <akpm@osdl.org>
Date:   Wed Jun 2 18:04:58 2004 -0700

    [PATCH] Use decimal instead of hex for EDD values
    
    From: "Patrick J. LoPresti" <patl@users.sourceforge.net>
    
    This patch changes default_cylinders, default_heads,
    default_sectors_per_track, legacy_max_cylinder, legacy_max_head,
    legacy_sectors_per_track, and sectors to decimal.
    
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit 6cdb275adc8e8ff3e354b6100ec3da29846a6acf
Author: Andrew Morton <akpm@osdl.org>
Date:   Wed Jun 2 18:04:48 2004 -0700

    [PATCH] Better names for EDD legacy_* fields
    
    From: "Patrick J. LoPresti" <patl@users.sourceforge.net>
    
    Renames legacy_heads to legacy_max_head legacy_sectors to
    legacy_sectors_per_track.
    
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit a3ef80c4af3a7016295ba449d2a844d54293078c
Author: Andrew Morton <akpm@osdl.org>
Date:   Wed Jun 2 18:04:36 2004 -0700

    [PATCH] use c99 struct initializer in hotcpu_notifier
    
    From: Nathan Lynch <nathanl@austin.ibm.com>
    
    The hotcpu_notifier macro does not properly record the given priority in
    the notifier block.  This causes trouble only for callers which specify a
    non-zero priority, of which there are none (yet).
    
    Signed-off-by: Nathan Lynch <nathanl@austin.ibm.com>
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit 43a492884e469dd7ff11466ad2f675bbfaf7d3ae
Author: Andrew Morton <akpm@osdl.org>
Date:   Wed Jun 2 18:04:25 2004 -0700

    [PATCH] ext3_orphan_del may double-decrement bh->b_count
    
    From: Jeff Mahoney <jeffm@suse.com>
    
    Chris Mason and I ran across this one while hunting down another bug.
    
    If ext3_mark_iloc_dirty() fails in ext3_orphan_del() on the outer buffer,
    bh->b_count will be decremented twice.  ext3_mark_iloc_dirty() will brelse
    the buffer, even on error.  ext3_orphan_del() is explicity brelse'ing the
    buffer on error.  Prior to calling ext3_mark_iloc_dirty(), this is the
    correct behavior.
    
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit 86d279de26c3a85199918b8121b49f5f9b67ea6c
Author: Andrew Morton <akpm@osdl.org>
Date:   Wed Jun 2 18:04:14 2004 -0700

    [PATCH] update elilo loader location in Kconfig
    
    From: Matt Tolentino <metolent@snoqualmie.dp.intel.com>
    
    The elilo EFI boot loader has been moved to sourceforge.  So, update the
    location of where one might look for it.
    
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit 75e63bcaac5cf590901372c14e07efd95d5a7f4f
Author: Andrew Morton <akpm@osdl.org>
Date:   Wed Jun 2 18:04:03 2004 -0700

    [PATCH] kill off efi_dir in efi.h
    
    From: Matt Tolentino <metolent@snoqualmie.dp.intel.com>
    
    The /proc support for efi 'stuff' isn't used/needed anymore, yet the
    efi_dir declaration remains.  This removes it.
    
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit e3c59de183690d0449c63ffc904fbe37550e5645
Author: Andrew Morton <akpm@osdl.org>
Date:   Wed Jun 2 18:03:52 2004 -0700

    [PATCH] quota: fix for old quota format
    
    From: Jan Kara <jack@ucw.cz>
    
    Fix a problem in the old quota format when we tried to read quota
    information after the end of quota file (that is correct as it might a user
    with sufficiently large UID which has no limits or usage).
    
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit bd9e2585261136005d9f54bcb6d0a1381ce7856f
Author: Andrew Morton <akpm@osdl.org>
Date:   Wed Jun 2 18:03:41 2004 -0700

    [PATCH] quota: fix writing of quota info
    
    From: Jan Kara <jack@ucw.cz>
    
    Fixes a problem with some quota operations not writing the quota info they
    changed which could later cause that some transaction to use more buffers
    than it had reserved or it could cause corrupted quota files when the
    system was rebooted at the right time.
    
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit 56b32457389a01f6f4b66e2435203eb5e6a17ea8
Author: Andrew Morton <akpm@osdl.org>
Date:   Wed Jun 2 18:03:27 2004 -0700

    [PATCH] s390: network device driver
    
    From: Martin Schwidefsky <schwidefsky@de.ibm.com>
    
    Network driver changes:
     - iucv: Fix special case of a "Connection Pending" interrupt within
       iucv_do_int.
     - netiucv: Revoke broken iucvMagic change for more than one connection.
     - qeth: Fix string parsing in notifier_register attribute function.
     - qeth: Add code for socket ioctl SIOC_QETH_GET_CARD_TYPE.
     - qeth: Fix debug log entry and buffer copy in qeth_snmp_command_cb.
     - qeth: Fix race on qeth_dbf_txt_buf.
    
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit 2f90b74d5501c4ab93ea6904b202ee9d404f8b10
Author: Andrew Morton <akpm@osdl.org>
Date:   Wed Jun 2 18:03:07 2004 -0700

    [PATCH] s390: block device driver
    
    From: Martin Schwidefsky <schwidefsky@de.ibm.com>
    
    block device driver changes:
     - dasd: Fix diag discipline if it is loaded as a module.
     - dcssblk: Replace r/w lock with r/w semaphore to be able to call
       device_register inside a critical section.
     - dcssblk: Fix error handling in write function for dcss "add" attribute.
     - xpram & dcssblk: Fix sanity check for sector number.
    
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit 38eb0df281af2c83a9d7c06eb9c45bd8f6fdfcf3
Author: Andrew Morton <akpm@osdl.org>
Date:   Wed Jun 2 18:02:51 2004 -0700

    [PATCH] s390: common i/o layer
    
    From: Martin Schwidefsky <schwidefsky@de.ibm.com>
    
    Common i/o layer changes:
     - qdio: Lose the adapter lock for thin interrupts to improve performance
       and do unregister of the adapter interrupt handler with rcu.
     - ccwgroup: Fix error handling when creating a ccwgroup device.
     - Convert the slow crw kernel thread to a single threaded workqueue.
     - Use the slow crw workqueue to unregister a subchannel after it was
       found not operational to serialize it with other possible unregister/
       register events coming in via machine checks.
     - Trigger a rescan of the css via the slow path if a missing channel path
       is found in __recover_lost_chpids.
     - Use saner default levels for the debug feature, add some debugging code.
     - Remove request_irq and free_irq stubs.
     - Remove bogus inlines.
    
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit 67e26ddad97a847dfdad69beec8793c601be4391
Author: Andrew Morton <akpm@osdl.org>
Date:   Wed Jun 2 18:02:35 2004 -0700

    [PATCH] s390: core
    
    From: Martin Schwidefsky <schwidefsky@de.ibm.com>
    
    s390 core changes:
     - Make use of the ipte instruction for ptep_set_access_flags
     - Fix atomic64_inc_and_test primitive as well.
     - Fix return type handler for __copy_in_user.
     - New default configuration.
    
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit b2a34aeb575e90d46ec70f481006717bcbb8ace7
Author: Andrew Morton <akpm@osdl.org>
Date:   Wed Jun 2 18:02:18 2004 -0700

    [PATCH] hugetlbpage: reinitialise compound page destructor
    
    From: David Gibson <david@gibson.dropbear.id.au>
    
    Currently the hugepage code stores the hugepage destructor in the mapping
    field of the second of the compound pages.  However, this field is never
    cleared again, which causes tracebacks from free_pages_check() if the
    hugepage is later destroyed by reducing the number in
    /proc/sys/vm/nr_hugepages.  This patch fixes the bug by clearing the
    mapping field when the hugepage is freed.
    
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit 50ce176cea9518621b7c836af0a419d3a0c5e9e7
Author: Andrew Morton <akpm@osdl.org>
Date:   Wed Jun 2 18:02:02 2004 -0700

    [PATCH] direct-io hole fix
    
    From: Chris Mason <mason@suse.com>
    
    When filling holes via DIRECT_IO, we fall back to normal buffered io.  For
    this to work properly, the direct io funcs have to return a value of zero to
    the file write functions, so the file write functions know where to start
    writing.
    
    In some cases, dio->result was getting returned by direct_io_worker, and that
    wasn't always zero, causing some data not to be written.
    
    From: <akpm@osdl.org>:
    
    - Simplify things by setting `ret' later on, fix up subsequent damage to the
      dio_complete() args.
    
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit dde27822586dd7a89c91c66d11878f8e19e6b823
Author: Andrew Morton <akpm@osdl.org>
Date:   Wed Jun 2 18:01:46 2004 -0700

    [PATCH] hugetlbpage msync() fix
    
    From: David Gibson <david@gibson.dropbear.id.au>
    
    Currently, calling msync() on a hugepage area will cause the kernel to blow
    up with a bad_page() (at least on ppc64, but I think the problem will exist
    on other archs too).  The msync path attempts to walk pagetables which may
    not be there, or may have an unusual layout for hugepages.
    
    Lucikly we shouldn't need to do anything for an msync on hugetlbfs beyond
    flushing the cache, so this patch should be sufficient to fix the problem.
    
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit 0af0d78880a6dc12c569931f1b8cb46a4dcecd59
Author: Andrew Morton <akpm@osdl.org>
Date:   Wed Jun 2 18:01:30 2004 -0700

    [PATCH] move #endif to correct place
    
    From: David Mosberger <davidm@napali.hpl.hp.com>
    
    Darrene Williams <dsw@gelato.unsw.edu.au> noticed that the #endif for
    __ARCH_WANT_SYS_SIGPROCMASK was off by one routine.
    
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit 737218657bf72e099eeea1234211a402aea37692
Author: Andrew Morton <akpm@osdl.org>
Date:   Wed Jun 2 18:01:14 2004 -0700

    [PATCH] aio: fix io_getevents() timer expiry setting
    
    From: William Lee Irwin III <wli@holomorphy.com>
    
    start_jiffies was not respected by set_timeout(), which reread jiffies
    instead of respecting what read_events() passed it.  This difference can be
    significant, particularly if the calling process slept during the
    copy_to_user() operation in read_events().  To correct this, this patch
    teaches it to respect its argument, with the additional bonus of converting
    it to use timespec_to_jiffies() instead of open-coding it.
    
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit 93c934c00c41f4cb8d0681d52f393ada7271ca7c
Author: Andrew Morton <akpm@osdl.org>
Date:   Wed Jun 2 18:01:02 2004 -0700

    [PATCH] use const in time.h unit conversion functions
    
    From: William Lee Irwin III <wli@holomorphy.com>
    
    The time conversion functions may have const args, which is in fact useful
    for when they are passed const variables as arguments so as to avoid
    discarding qualifiers from pointer types warnings.  This is a preparatory
    cleanup for a minor aio bugfix.
    
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit f2b7a611f5c9598ff548bb3c39df06913aa2ca39
Author: Andrew Morton <akpm@osdl.org>
Date:   Wed Jun 2 18:00:46 2004 -0700

    [PATCH] mm/oom_kill.c trivial cleanup
    
    From: "Luiz Fernando N. Capitulino" <lcapitulino@prefeitura.sp.gov.br>
    
    Remove duplicated assignment.
    
    Signed-off by: Luiz Capitulino <lcapitulino@prefeitura.sp.gov.br>
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit ac209edbf18de5566cb6fd2cf3ec05bec9cc9f47
Author: Andrew Morton <akpm@osdl.org>
Date:   Wed Jun 2 18:00:30 2004 -0700

    [PATCH] dm: add DM_REMOVE_ALL_32 compat ioctl
    
    From: Marcus Meissner <meissner@suse.de>
    
    Add DM_REMOVE_ALL_32 to the list of compatible ioctls.
    
    Signed-off-By: Marcus Meissner <meissner@suse.de>
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit 65852349721e4e9a941ee42d92c8a7947324771d
Author: Andrew Morton <akpm@osdl.org>
Date:   Wed Jun 2 18:00:14 2004 -0700

    [PATCH] fix possible NULL pointer in fs/ext3/super.c.
    
    From: "Luiz Fernando N. Capitulino" <lcapitulino@prefeitura.sp.gov.br>
    
    In fs/ext3/super.c::ext3_get_journal() at line 1675 `journal' can be NULL,
    but it is not handled right (detect by Coverity's checker).
    
    Signed-off by: Luiz Capitulino <lcapitulino@prefeitura.sp.gov.br>
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit 9b82900ad0e9ae8cac5f04fc6c8e100f94d20b3a
Author: Andrew Morton <akpm@osdl.org>
Date:   Wed Jun 2 17:59:59 2004 -0700

    [PATCH] Fix loop device cache handling
    
    From: Russell King <rmk+lkml@arm.linux.org.uk>
    
    It appears the loop driver has had one flush_dcache_page() call added for
    the case where it writes to the backing device page cache pages.
    
    However, it seems to be missing the call where it writes to its own page
    cache pages.
    
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit eb313b410e0df742ad69f91173e26e356edd0d4f
Author: Andrew Morton <akpm@osdl.org>
Date:   Wed Jun 2 17:59:43 2004 -0700

    [PATCH] sched: balance-on-exec fix
    
    From: Jack Steiner <steiner@sgi.com>
    
    It looks like the call to sched_balance_exec() from do_execve() is in the
    wrong spot.  The code calls sched_balance_exec() before determining whether
    "filename" actually exists.
    
    In many cases, users have several entries in $PATH.  If a full path name is
    not specified on the 'exec" call, the library code iterates thru the files
    in the PATH list until it finds the program.  This can result is numerous
    migrations of the parent process before the program is actually found.
    
    Signed-off-by: Ingo Molnar <mingo@elte.hu>
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit ce247d90f8263304a25e2b5ac61528e4f0b79b5d
Author: Andrew Morton <akpm@osdl.org>
Date:   Wed Jun 2 17:59:32 2004 -0700

    [PATCH] floppy minor number fix
    
    From: Paul Slootman <paul+nospam@wurtel.net>
    
    Correctly set the floppy disk's first minor.
    
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit 863dacddb3d17e76f1345d2e030d6c481b5d62fd
Author: Andrew Morton <akpm@osdl.org>
Date:   Wed Jun 2 17:59:21 2004 -0700

    [PATCH] selinux: check processed security context length
    
    From: Stephen Smalley <sds@epoch.ncsc.mil>
    
    This patch changes security_context_to_sid to check the length of the
    processed security context against the full length of the provided context,
    rejecting any further data.
    
    Signed-off-by: Stephen Smalley <sds@epoch.ncsc.mil>
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit 2d34e81752929b4213e6f151f2b81de170423b8e
Author: Andrew Morton <akpm@osdl.org>
Date:   Wed Jun 2 17:59:10 2004 -0700

    [PATCH] Add reference_init.pl to `make buildcheck' target
    
    `make buildcheck' only checks for calls to linker discarded sections,
    
    reference_init checks for calls to sections discarded at run time, init was
    cloned from discarded.  They are separate because the linker detects the
    discarded case and I did not want to confuse users with messages about init
    text/data while they were fixing the linker errors.
    
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit 18e95846f35549cce65c8edd584ed5ad0fde661e
Author: Andrew Morton <akpm@osdl.org>
Date:   Wed Jun 2 17:58:58 2004 -0700

    [PATCH] partition table validity checking
    
    From: Andries Brouwer <Andries.Brouwer@cwi.nl>
    
    The patch examines a putative partition table, and if that doesnt look like a
    valid partition table it goes away again.
    
    Some devices have partition tables (and there are many styles of such), some
    don't.  Traditionally fixed disks have one, floppies don't.  Nobody knows what
    happens with ZIP disks, USB sticks and other such things.  Both the DOS-type
    partition table, and the "big floppy" whole disk FAT filesystem are common.
    It is undesirable for the kernel to detect partitions where there are none.
    This leads to great confusion, sometimes to kernel crashes.
    
    In the particular case of DOS-type partition tables a partition entry has a
    1-byte field boot_ind that traditionally is 0x80 for the boot partition and 0
    for the other three primary partitions.  Linux does not use this field, and
    one sometimes sees tables with all four entries zero.
    
    The patch tells the kernel not to think that something is a valid DOS-type
    partition table when a value other than 0 or 0x80 is encountered.  I think it
    is a fairly safe change: I do not know of any fdisk-type program that will
    write other values there.
    
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit 1df9796b35c9d4fdb9b0a724d05c41a8962ff393
Author: Andrew Morton <akpm@osdl.org>
Date:   Wed Jun 2 17:58:47 2004 -0700

    [PATCH] ppc64 gives up too quickly on hotplugged cpu
    
    From: Nathan Lynch <nathanl@austin.ibm.com>
    
    On some systems it can take a hotplugged cpu much longer to come up than it
    would at boot.  If the cpu comes up after we've given up on it, it tends to
    die in its first attempt to kmem_cache_alloc (uninitialized percpu data, I
    imagine).
    
    In my experimentation I haven't seen a processor take more than one second
    to become available; the patch waits five seconds just to be safe.
    
    Signed-off-by: Nathan Lynch <nathanl@austin.ibm.com>
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit 0c2aaf205b1aba1f2376fc100daedb3e64c2ba35
Author: Andrew Morton <akpm@osdl.org>
Date:   Wed Jun 2 17:58:36 2004 -0700

    [PATCH] ppc64: update info about available iseries_veth interfaces
    
    From: Olaf Hering <olh@suse.de>
    
    /proc/iSeries/config contains now the number of configured virtual ethernet
    adapters.  AVAILABLE_VETH should only indicate if there is at least one
    interface available, iseries_veth must be loaded in this case.
    
    Printing the entire map will give installers some hints about what
    interface numbers will appear and how the MAC address may look like.
    
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit f4815879030d044aa201b1aedf770396a0bbbafd
Author: Andrew Morton <akpm@osdl.org>
Date:   Wed Jun 2 17:58:25 2004 -0700

    [PATCH] ppc64: kernel Makefile options for $(AS)
    
    From: Olaf Hering <olh@suse.de>
    
    `-64' is no longer a valid option for as.  Pass it `-a64' instead.
    
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit b5f6a5b134c00cebfcf6916fd34561e7814fa956
Author: Andrew Morton <akpm@osdl.org>
Date:   Wed Jun 2 17:58:14 2004 -0700

    [PATCH] ppc32: add "indirect" DCR access, pass 2
    
    From: Matt Porter <mporter@kernel.crashing.org>
    
    DCR number is encoded in mfdcr/mtdcr command itself and this prevents easy
    DCR access when register number is not known on compile time.  This patch
    adds __mfdcr & __mtdcr helpers which use pre-generated mfdcr/mtdcr
    sequences for all possible DCR numbers.  We also use GCC extension
    __builtin_constant_p to optimize cases when DCR number is in fact known
    during compilation.
    
    Signed-off-by: Eugene Surovegin <ebs@ebshome.net>
    Signed-off-by: Matt Porter <mporter@kernel.crashing.org>
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit 114b0865dff32dd82a73d345a3c1907015d08d1f
Author: Andrew Morton <akpm@osdl.org>
Date:   Wed Jun 2 17:58:03 2004 -0700

    [PATCH] shrink_all_memory() fixes
    
    - Off-by-one in balance_pgdat means that we're not scanning the zones all
      the way down to priority=0.
    
    - Always set zone->temp_priority in shrink_caches().  I'm not sure why I had
      the `if (zone->free_pages < zone->pages_high)' test in there, but it's
      preventing us from setting ->prev_priority correctly on the
      try_to_free_pages() path.
    
    - Set zone->prev_priority to the current priority if it's currently a
      "lower" priority.  This allows us to build up the pressure on mapped pages
      on the first scanning pass rather than only on successive passes.
    
    
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit 97e012bbf087abb5dff904aa042eb0a3e5e0bd08
Author: Andrew Morton <akpm@osdl.org>
Date:   Wed Jun 2 17:57:52 2004 -0700

    [PATCH] ramfs o_sync oops fix
    
    Writing to ramfs files with O_SYNC dereferences null in mpage_writepages(),
    due to null a_ops->writepage.  The call path is
    
    	generic_file_aio_write_nolock
    	->generic_osync_inode
    	  ->write_inode_now
    	    ->__writeback_single_inode
    	      ->__sync_single_inode
    	        ->do_writepages
    	          ->mpage_writepages
    
    The best fix for this is to visit all ram-backed filesystems and give them a
    no-op a_ops.writepages.  But baling out if the file is memory-backed is a
    sufficient coverall and is how we handle this in __filemap_fdatawrite().
    
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit 5a9e6dcfb90c8543331f7eca8d8ae3203119462b
Author: Dave Jones <davej@redhat.com>
Date:   Wed Jun 2 23:21:35 2004 +0100

    [CPUFREQ] Consolidate version checking in longhaul_get_cpu_mult
    reduce code duplication.

commit a0f562dfdc13a7108069013566dc9545af713b31
Author: Bartlomiej Zolnierkiewicz <b.zolnierkiewicz@elka.pw.edu.pl>
Date:   Wed Jun 2 09:47:52 2004 -0700

    [PATCH] ide: simplify CONFIG_IDEDMA_ONLYDISK logic a bit
    
    Signed-off-by: Bartlomiej Zolnierkiewicz <bzolnier@elka.pw.edu.pl>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit 8cd6e401f567f68f0bb5f82ca1508099b7857a5d
Author: Bartlomiej Zolnierkiewicz <b.zolnierkiewicz@elka.pw.edu.pl>
Date:   Wed Jun 2 09:47:41 2004 -0700

    [PATCH] ide: remove useless /proc/ide/siimage from siimage.c
    
    It only gives (not mapped in case of MMIO) DMA base addresses.
    The same info is given during driver initialization (if BM-DMA is used)
    or can be obtained from 'lspci -v' output (if MMIO-DMA is used).
    
    Signed-off-by: Bartlomiej Zolnierkiewicz <bzolnier@elka.pw.edu.pl>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit b0134e31c10bd06dc44db6af3aeb1f947e32cf96
Author: Bartlomiej Zolnierkiewicz <b.zolnierkiewicz@elka.pw.edu.pl>
Date:   Wed Jun 2 09:47:30 2004 -0700

    [PATCH] ide: add IDE_ARCH_OBSOLETE_DEFAULTS
    
    per jgarzik's suggestion
    
    Define it in <asm/ide.h> if ide_default_io_base(),
    ide_default_irq() and ide_init_default_irq() are needed.
    
    Signed-off-by: Bartlomiej Zolnierkiewicz <bzolnier@elka.pw.edu.pl>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit 24ec04304182c900b052886811c2e912440d6eee
Author: Bartlomiej Zolnierkiewicz <b.zolnierkiewicz@elka.pw.edu.pl>
Date:   Wed Jun 2 09:47:18 2004 -0700

    [PATCH] ide: use <asm-i386/ide.h> as <asm-x86_64/ide.h>
    
    They are identical (modulo infamous PC9800 stuff).
    
    Acked by Andi.
    
    Signed-off-by: Bartlomiej Zolnierkiewicz <bzolnier@elka.pw.edu.pl>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit 4fe96a221ca6b87f4140aff105a0ac145054aef9
Author: Bartlomiej Zolnierkiewicz <b.zolnierkiewicz@elka.pw.edu.pl>
Date:   Wed Jun 2 09:47:08 2004 -0700

    [PATCH] ide: use generic ide_init_hwif_ports() on m68k
    
    Also print the same warning as on m68k on other archs too.
    
    Signed-off-by: Bartlomiej Zolnierkiewicz <bzolnier@elka.pw.edu.pl>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit 979ac59d656185a01a8149cde5f72c36a9dd75de
Author: Bartlomiej Zolnierkiewicz <b.zolnierkiewicz@elka.pw.edu.pl>
Date:   Wed Jun 2 09:46:57 2004 -0700

    [PATCH] ide: add new nForce IDE/SATA device IDs to amd74xx.c
    
    From: "Brian Lazara" <blazara@nvidia.com>
    
    Add device IDs for new nForce IDE and SATA controllers.  Rename some of
    the existing controller names to correctly match released product names.
    
    Acked by Vojtech.
    
    Signed-off-by: Bartlomiej Zolnierkiewicz <bzolnier@elka.pw.edu.pl>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit 4bedcccc43b4e0424dab04909edf7e64a46b2c34
Author: Bartlomiej Zolnierkiewicz <b.zolnierkiewicz@elka.pw.edu.pl>
Date:   Wed Jun 2 09:46:46 2004 -0700

    [PATCH] ide: merge amd74xx.h into amd74xx.c
    
    While at it add DECLARE_AMD_DEV() and DECLARE_NV_DEV() macros
    (ala piix.h:DECLARE_PIIX_DEV() added by jgarzik).
    
    Acked by Vojtech.
    
    Signed-off-by: Bartlomiej Zolnierkiewicz <bzolnier@elka.pw.edu.pl>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit 757514165925a3fdaaab5c9e0956310a7b07165e
Author: Bartlomiej Zolnierkiewicz <b.zolnierkiewicz@elka.pw.edu.pl>
Date:   Wed Jun 2 09:46:35 2004 -0700

    [PATCH] ide: ide_pci_device_t sanitization
    
    - convert ->isa_ports into ->flags (IDEPCI_FLAG_ISA_PORTS)
    - add IDEPCI_FLAG_{OBS_FORCE_PDC,FORCE_MASTER} flags
      and use them in setup-pci.c
    - use struct pci_dev ->vendor and ->device fields directly
      in generic.c and serverworks.c
    - remove no longer needed debug checks (dev->device != d->device)
    - remove ->vendor and ->device fields from ide_pci_device_t
    - misc cleanups
    
    Signed-off-by: Bartlomiej Zolnierkiewicz <bzolnier@elka.pw.edu.pl>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit 9b541c7b30ee1b060a778a7acc8da6915e25c333
Author: Bartlomiej Zolnierkiewicz <b.zolnierkiewicz@elka.pw.edu.pl>
Date:   Wed Jun 2 09:46:23 2004 -0700

    [PATCH] ide: fix for generic IDE PCI module
    
    Extracted from the Debian kernel package.
    
    Signed-off-by: Bartlomiej Zolnierkiewicz <bzolnier@elka.pw.edu.pl>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit a77870a740d6de49e356d8fcb1e3519da7223de8
Author: Bartlomiej Zolnierkiewicz <b.zolnierkiewicz@elka.pw.edu.pl>
Date:   Wed Jun 2 09:46:12 2004 -0700

    [PATCH] ide: don't put disks in standby mode on halt on Alpha
    
    From: Ivan Kokshaysky <ink@jurassic.park.msu.ru>
    
    Signed-off-by: Bartlomiej Zolnierkiewicz <bzolnier@elka.pw.edu.pl>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit 3626b0451f8fed239af0fd3bd05f5672ebe43b7f
Merge: 10fb048... 71d50c2...
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Wed Jun 2 09:42:49 2004 -0700

    Merge bk://kernel.bkbits.net/davem/net-2.6
    into ppc970.osdl.org:/home/torvalds/v2.6/linux

commit 10fb048406dccbe9f9de05468ba5e71efa6e9932
Merge: c57cd56... 964918f...
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Wed Jun 2 09:41:55 2004 -0700

    Merge bk://kernel.bkbits.net/davem/sparc-2.6
    into ppc970.osdl.org:/home/torvalds/v2.6/linux

commit c57cd56b40fdb2ef055938600785896e0bf6caf5
Merge: e7c0c64... 7896c90...
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Wed Jun 2 08:05:15 2004 -0700

    Merge bk://gkernel.bkbits.net/libata-2.6
    into ppc970.osdl.org:/home/torvalds/v2.6/linux

commit e7c0c64ed2151c74683a9c61deb16012a3563bc1
Merge: 651bea8... af39cd4...
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Wed Jun 2 08:04:21 2004 -0700

    Merge bk://gkernel.bkbits.net/net-drivers-2.6
    into ppc970.osdl.org:/home/torvalds/v2.6/linux

commit 7896c90eb395202931ba7ef4b32c74f884204f3f
Author: Arjan van de Ven <arjanv@redhat.com>
Date:   Wed Jun 2 09:51:11 2004 -0400

    [libata] Use standard headers from include/scsi, not drivers/scsi

commit 20d689fcd43c0ffde34f2a67140c5c6634cddd17
Author: Jeff Garzik <jgarzik@redhat.com>
Date:   Wed Jun 2 09:31:53 2004 -0400

    [libata scsi] ack SYNCHRONIZE CACHE command
    
    When taskfile delivery is improved, we will actually perform
    this command, instead of no-oping it.
    
    For now, this is cosmetic except for removing an annoying message
    that some users see.

commit 1a3a090e78c841c4d90c16eea2c29304405d9df2
Author: Jeff Garzik <jgarzik@redhat.com>
Date:   Wed Jun 2 09:29:00 2004 -0400

    [libata promise] revert broken taskfile delivery change
    
    The ->tf_load and ->exec_command driver hooks were changed to assume
    that PIO was the only type of taskfile ever delivered to these functions.
    This will be true... in the future, but not today.  In other drivers
    this change was not needed, but Promise executes commands differently
    due to its "ATA packet" hardware features, so the Promise drivers need
    this change reverted.
    
    Diagnosis and initial fix by Brad Campbell <brad@wasp.net.au>

commit af39cd4d901e5d3cda04a916e75f1a33cd9386c4
Merge: 2424dc6... b15b915...
Author: Jeff Garzik <jgarzik@redhat.com>
Date:   Wed Jun 2 09:00:10 2004 -0400

    Merge redhat.com:/spare/repo/netdev-2.6/prism54
    into redhat.com:/spare/repo/net-drivers-2.6

commit 2424dc63939fb31ab52d847a39d37d6e0e98a1ec
Author: Krzysztof Halasa <khc@pm.waw.pl>
Date:   Wed Jun 2 08:20:04 2004 -0400

    [PATCH] 2.6 Generic HDLC update
    
    The attached patch updates generic HDLC:
    - fixed some carrier-related problems (Cisco HDLC and FR links could
      report valid link when no carrier was detected at startup).
    - fixed kbuild problems with wanxl firmware (building kernel in separate
      tree). $(src)/wanxlfw.inc is now wanxlfw.inc_shipped.

commit ee4571dbbb56a84ae09bc6f3de05fa382e086061
Author: Paul Mackerras <paulus@samba.org>
Date:   Wed Jun 2 08:14:29 2004 -0400

    [PATCH] ppp ldisc close deadlock prevention
    
    Jeff Garzik writes:
    
    > So what was the resolution of this?
    
    This patch is what we want.  We don't in fact need to do the read
    lock, only the write lock, which is what the original patch did.
    However, we need to do it in ppp_synctty.c as well as ppp_async.c.
    
    Thanks to John K Luebs <jkluebs@luebsphoto.com> for pointing out the
    problem.
    
    Signed-off-by: Paul Mackerras <paulus@samba.org>

commit a74a0064c3813bdb135606e553956c9e7cd0cc0c
Author: Jeff Garzik <jgarzik@redhat.com>
Date:   Wed Jun 2 08:04:40 2004 -0400

    Cset exclude: jgarzik@redhat.com|ChangeSet|20040527204246|14084
    
    Revert CONFIG_NET_GIGE change.
    
    The proper fix is _not_ NET_ETHERNET or default twiddling,
    but better overall organization of the ethernet driver selection,
    which would include not only CONFIG_NET_GIGE but other options as well.
    
    Reverted back to old behavior until a full and complete solution
    appears (and people like it, of course).

commit b15b91519d5ee9f925c9630d272986c936d738fb
Author: Margit Schubert-While <margitsw@t-online.de>
Date:   Wed Jun 2 07:54:58 2004 -0400

    [PATCH] prism54: Add avs header support
    
    * islpci_eth.[c,h], islpci_dev.[c,h], isl_ioctl.[c,h] : added
      support for avs header in monitor mode. Based on the work of
      Antonio Eugenio Burriel <aeb@ryanstudios.com>. Unified packets
      header (rfmon_header and rx_annex) for iwspy.

commit bc154d9dab8dc3279d93a50716ecce0a506d29bc
Author: Margit Schubert-While <margitsw@t-online.de>
Date:   Wed Jun 2 07:54:50 2004 -0400

    [PATCH] prism54: Add iwspy support
    
            * islpci_eth.c, islpci_dev.h, isl_ioctl.c : iwspy support.

commit a266161bebbd553afe1f3cda8207229a378c8b4a
Author: Margit Schubert-While <margitsw@t-online.de>
Date:   Wed Jun 2 07:54:42 2004 -0400

    [PATCH] prism54: Reset card on tx timeout
    
    * islpci_eth.[c,h] islpci_dev.[c,h] : reset card on tx_timeout.
      Patch submited by Denis Vlasenko <vda@port.imtp.ilyichevsk.odessa.ua>

commit b483f7576a1630289aab3c3f051e8f8163d3c8c1
Author: Margit Schubert-While <margitsw@t-online.de>
Date:   Wed Jun 2 07:54:33 2004 -0400

    [PATCH] prism54: Add new private ioctls
    
    * oid_mgt.[c,h] : added type to oids. New functions :
      oid_cpu_to_le(), mgt_le_to_cpu() and mgt_response_to_str().
    
    * isl_ioctl.c : use private sub-ioctls. Added a
      bunch of private sub-ioctls. Removed the le??_to_cpu and
      cpu_to_le??. Give the error code when sending wireless
      events.

commit 9c6c5143c45cbe7d5896eecfc9ad9755919235f7
Author: Margit Schubert-While <margitsw@t-online.de>
Date:   Wed Jun 2 07:54:25 2004 -0400

    [PATCH] prism54: delete cvs tags
    
    * Remove CVS tags from source

commit be0cb2568b0a6eec37b2ba7ad639e6f243e711d2
Author: Herbert Xu <herbert@gondor.apana.org.au>
Date:   Wed Jun 2 07:48:29 2004 -0400

    [PATCH] Check cmd in plip_ioctl
    
    I received a bug report that a PLIP interface was incorrectly identified
    as wireless because plip_ioctl did not check what the value of cmd is
    before processing the request.
    
    This patch fixes exactly that.

commit 86f996c0bef08b809581a8266a8d2c4a99deb4cd
Author: Dave Kleikamp <shaggy@austin.ibm.com>
Date:   Wed Jun 2 06:28:51 2004 -0500

    JFS: Handle out of space errors more gracefully
    
    Signed-off-by: Dave Kleikamp <shaggy@austin.ibm.com>

commit 964918f108a9b0f73e444b99f1447d15491c8075
Author: David S. Miller <davem@nuts.davemloft.net>
Date:   Wed Jun 2 02:14:08 2004 -0700

    [ATM]: fore200e dma direction macro tests no longer needed.

commit 885444168d01415e0f8ab5d8d8aa144c5fd257dc
Author: Tom 'spot' Callaway <tcallawa@redhat.com>
Date:   Wed Jun 2 02:02:20 2004 -0700

    [SBUS]: Stop using drivers/scsi/{scsi,hosts}.h in drivers.

commit 9c5cdec29c051e39aed439ff6c8c38679bf29f37
Author: Christoph Hellwig <hch@lst.de>
Date:   Wed Jun 2 02:01:05 2004 -0700

    [SBUS]: Define dma direction bits in terms of enum dma_data_direction.

commit ffe811b18a3e445c710d275e17b9bb78a7643cde
Author: David S. Miller <davem@nuts.davemloft.net>
Date:   Wed Jun 2 01:58:19 2004 -0700

    [SPARC64]: Kill _exit kernelsyscall stub from unistd.h

commit 018fff9a19f4cde890290a909feb0fbc63c1a5d6
Author: Dave Airlie <airlied@starflyer.(none)>
Date:   Wed Jun 2 18:25:46 2004 +1000

    add R200_EMIT_RB3D_BLENDCOLOR state packet to support GL_EXT_blend_color, GL_EXT_blend_func_separate and GL_EXT_blend_equation_separate on r200
    from Roland Scheidegger
    
    Signed-off-by: Dave Airlie <airlied@linux.ie>

commit de801ff84c593aec65aafc0ff0adc0011293e25c
Author: Dave Airlie <airlied@starflyer.(none)>
Date:   Wed Jun 2 18:17:28 2004 +1000

    fix missing DRM_ERR()s - Eric Anholt
    
    Signed-off-by: Dave Airlie <airlied@linux.ie>

commit b215b03d3e580f3e2d5ca38bf74196cf62f890ab
Merge: 20e743b... 520a9e8...
Author: Dave Kleikamp <jfs.adm@hostme.bitkeeper.com>
Date:   Tue Jun 1 21:36:00 2004 -0700

    Merge bk://linux.bkbits.net/linux-2.5
    into hostme.bitkeeper.com:/repos/j/jfs/linux-2.5

commit 38522bb567710f49ec9df29117d09bded726d81f
Merge: b670ef7... f6b614e...
Author: Dave Jones <davej@delerium.codemonkey.org.uk>
Date:   Wed Jun 2 03:46:03 2004 +0100

    Merge delerium.codemonkey.org.uk:/mnt/nfs/neologic/bar/src/kernel/2.6/trees/bk-linus
    into delerium.codemonkey.org.uk:/mnt/nfs/neologic/bar/src/kernel/2.6/trees/cpufreq

commit 7681758b6ae05f2fbfb33f7301f7d87b49f570b1
Author: David Woodhouse <dwmw2@shinybook.infradead.org>
Date:   Wed Jun 2 03:22:23 2004 +0100

    [PPC sbc82xx] Use mfspr macro for reading PVR in boot setup.

commit 651bea8c072b9ab412719f69a5e76bc91f3124cc
Author: Jeremy Kerr <jeremy@redfishsoftware.com.au>
Date:   Tue Jun 1 17:18:12 2004 -0700

    [PATCH] Fix signal race during process exit
    
    Fix a race identified by Jeremy Kerr <jeremy@redfishsoftware.com.au>: if
    update_process_times() decides to deliver a signal due to process timer
    expiry, it can race with __exit_sighand()'s freeing of task->sighand.
    
    Fix that by clearing the per-process timer state in exit_notify(), while under
    local_irq_disable() and under tasklist_lock.  tasklist_lock provides exclusion
    wrt release_task()'s freeing of task->sighand and local_irq_disable() provides
    exclusion wrt update_process_times()'s inspection of the per-process timer
    state.
    
    We also need to deal with the send_sig() calls in do_process_times() by
    setting rlim_cur to RLIM_INFINITY.
    
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: Jeremy Kerr <jk@ozlabs.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit 8012a7f767b59fca384aad773b0cd87ccecc6ad9
Merge: 2d0fc73... ed97349...
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Tue Jun 1 17:15:49 2004 -0700

    Merge bk://linux-ntfs.bkbits.net/ntfs-2.6
    into ppc970.osdl.org:/home/torvalds/v2.6/linux

commit 5837ea27b39f0827f31acad5f30a1a9a52c1d99b
Merge: 390bb9b... ca2c8ae...
Author: Steve French <stevef@steveft21.ltcsamba>
Date:   Tue Jun 1 14:04:52 2004 -0500

    Merge bk://cifs.bkbits.net/linux-2.5cifs
    into steveft21.ltcsamba:/usr/src/bk/linux-2.5cifs

commit ca2c8ae530d74acf004c73305518e31af8523599
Author: Steve French <stevef@steveft21.ltcsamba>
Date:   Tue Jun 1 13:44:42 2004 -0500

    Initial protocol definitions for cifs dirnotify (directory change notification) support
    
    Signed-off-by: Steve French <sfrench@us.ibm.com>

commit 90fc77386d547fd0d442d25c55b5584b1240c004
Merge: a486aa5... 2d0fc73...
Author: Anton Altaparmakov <aia21@cantab.net>
Date:   Tue Jun 1 19:37:52 2004 +0100

    Merge cantab.net:/home/src/ntfs-2.6
    into cantab.net:/home/src/ntfs-2.6-devel

commit 2d0fc7315ebeb6310e45ec5f522c3487a09ae3a5
Merge: 740dfb4... 20e743b...
Author: Anton Altaparmakov <aia21@cantab.net>
Date:   Tue Jun 1 19:35:37 2004 +0100

    Merge cantab.net:/home/src/bklinux-2.6
    into cantab.net:/home/src/ntfs-2.6

commit a486aa552b55b213578de228e24bbad07db9087c
Author: Anton Altaparmakov <aia21@cantab.net>
Date:   Tue Jun 1 19:00:58 2004 +0100

    NTFS: - Implement fs/ntfs/mft.[hc]::{,__}mark_mft_record_dirty() and make
            fs/ntfs/aops.c::ntfs_writepage() and ntfs_commit_write() use it, thus
            finally enabling resident file overwrite!  (-8  This also includes a
            placeholder for ->writepage (ntfs_mft_writepage()), which for now
            just redirties the page and returns.  Also, at umount time, we for
            now throw away all mft data page cache pages after the last call to
            ntfs_commit_inode() in the hope that all inodes will have been
            written out by then and hence no dirty (meta)data will be lost.  We
            also check for this case and emit an error message telling the user
            to run chkdsk.
          - If the user is trying to enable (dir)atime updates, warn about the
            fact that we are disabling them.
    
    Signed-off-by: Anton Altaparmakov <aia21@cantab.net>

commit 086244810f275b802ab6ff39e325821d2b959e27
Author: Maeda Naoaki <maeda.naoaki@jp.fujitsu.com>
Date:   Tue Jun 1 09:02:05 2004 -0700

    ia64: fix /proc/ioports regression in 2.6.6 on Tiger4
    
    This patch fixes a problem that "cat /proc/ioports" loops
    on some IA64 machines that use quirk_io_region(). The problem
    is caused by redundant resource claim by quirk_io_region()
    and pcibios_fixup_device_resources(). The patch prevents
    this condition and is written by Matthew Wilcox.
    
    Signed-off-by: Maeda Naoaki <maeda.naoaki@jp.fujitsu.com>

commit c282c8971ec62500b922f2032a85efeadfee82cf
Author: David Mosberger <davidm@tiger.hpl.hp.com>
Date:   Tue Jun 1 08:49:16 2004 -0700

    ia64: Add defconfig for Ski simulator (patch by Darren Williams).

commit 06842fd4483bbf8fcf08f5c513ac00756c7df8e8
Author: David Mosberger <davidm@tiger.hpl.hp.com>
Date:   Tue Jun 1 08:47:21 2004 -0700

    Update ia64 linux mailing-list and web-site addresses.

commit 60c22e3fce215069fa8dbe385b5cfb72cadf138c
Author: Darren Williams <dsw@gelato.unsw.edu.au>
Date:   Tue Jun 1 08:40:42 2004 -0700

    ia64: define pending_irq_cpumask in irq.c
    
    This fixes a build-problem with the Ski simulator.  The simulator doesn't
    include iosapic.c and hence pending_irq_cpumask never got defined.

commit 71d50c2bf5af7bdae86a53391fd29028e19d2ec9
Merge: c6e97af... 1db8a26...
Author: David S. Miller <davem@nuts.davemloft.net>
Date:   Tue Jun 1 07:58:12 2004 -0700

    Merge bk://bk.skbuff.net:20607/linux-2.6-ipstats
    into nuts.davemloft.net:/disk1/BK/net-2.6

commit 1db8a26af865333c8ab9a0a846da3c1ef42b9c06
Author: Hideaki Yoshifuji <yoshfuji@linux-ipv6.org>
Date:   Wed Jun 2 12:05:31 2004 +0900

    [IPV4] use ip-independent ipstats_mib to store IPv4 statistics.

commit 84a4a80581a7136e3ea6778c79b7dd4991428e5b
Author: Hideaki Yoshifuji <yoshfuji@linux-ipv6.org>
Date:   Wed Jun 2 10:32:35 2004 +0900

    [IPV6] rename snmp6_ipv6_list to snmp6_ipstats_list.

commit 058caf459f64cd82793442eaf55124cb38f88851
Author: Hideaki Yoshifuji <yoshfuji@linux-ipv6.org>
Date:   Wed Jun 2 10:22:57 2004 +0900

    [IPV{4,6}] introduce ip-independent ipstats_mib based on ipv6_mib.

commit 6e93454761e99a1d90e51cd5be3b8e4b1328360f
Author: Hideaki Yoshifuji <yoshfuji@linux-ipv6.org>
Date:   Wed Jun 2 09:51:12 2004 +0900

    [NET] Introduce and use several common stuff for snmp item list.

commit 7dff71fd415ac1f3c1015bce5f68ef19f79d1e68
Author: Hideaki Yoshifuji <yoshfuji@linux-ipv6.org>
Date:   Wed Jun 2 09:24:48 2004 +0900

    [IPV6] use appropriate __alignof__() for mibs.

commit f6b614e7ca943f2f09188ac0df2fe09bebbdcda5
Author: Dave Jones <davej@redhat.com>
Date:   Tue Jun 1 15:49:42 2004 +0100

    [CPUFREQ] Fix build of longhaul.
    Arjan noted that in some cases, the build fails.
    This should fix it up.

commit b94216257960ee22fbcf76ff425fcd77a1752bb1
Author: David S. Miller <davem@nuts.davemloft.net>
Date:   Tue Jun 1 07:43:05 2004 -0700

    [SPARC64]: Compat syscall overhaul.
    1) Make syscall entry zero-extend all arguments.
    2) Sign extend those needed in sys32.S
    3) Kill the A() AA() macros, replace with compat_ptr() et al.

commit c6e97af66c0528107b17309bb0b4e4c09a16b21b
Author: Hideaki Yoshifuji <yoshfuji@linux-ipv6.org>
Date:   Tue Jun 1 06:21:09 2004 -0700

    [IPV4]: Store idev in routes.

commit 841b4bc260b00afb5e59d38c6cda435b0cc4fe06
Author: PÃ¡draig Brady <p@draigbrady.com>
Date:   Tue Jun 1 11:52:38 2004 +0200

    [WATCHDOG] v2.6.6 w83627hf_wdt.c-patch
    
    Add w83627hf_select_wd_register and w83627hf_unselect_wd_register.
    Add w83627hf_init to fix initialization problem on certain motherboards.
    Make ping and disable code return 0 (int) on success.
    Extract set_heartbeat code to seperate function.

commit ed97349f6cf873aab2ebcbc8d63ed97d5ecf4482
Merge: d95e31c... 04fc514...
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Tue Jun 1 01:18:27 2004 -0700

    Merge bk://bk.arm.linux.org.uk/linux-2.6-rmk
    into ppc970.osdl.org:/home/torvalds/v2.6/linux

commit 04fc51440336e85e5276df58ef90478fd9099138
Author: Russell King <rmk@flint.arm.linux.org.uk>
Date:   Wed Jun 2 00:37:35 2004 +0100

    [ARM] asm_do_IRQ takes an unsigned IRQ number.

commit 0dd9075e95f0635b132fe9fb8b4fdfcc77e76a62
Author: Nicolas Pitre <nico@org.rmk.(none)>
Date:   Wed Jun 2 00:06:35 2004 +0100

    [ARM PATCH] 1896/2: distinguish between memory and LCD clock on PXA
    
    Patch from Nicolas Pitre
    
    [patch rediffed]
    
    On PXA27x the memory and LCd clocks are different.
    Also clean the PXA27x clock code a bit.

commit 9f5740644d9f5e1fa1411d54b29ec67714fd404d
Author: Russell King <rmk@flint.arm.linux.org.uk>
Date:   Tue Jun 1 22:42:35 2004 +0100

    [ARM] Fix missing spinlock initialisation.

commit 8749193e7297a3cae2d59f13e07ca7bb1a3a89bc
Author: Russell King <rmk@flint.arm.linux.org.uk>
Date:   Tue Jun 1 22:36:39 2004 +0100

    [ARM] Update ARM memory region reservations.
    
    Remove 26-bit ARM region reserves.
    
    All region reserves start at PHYS_OFFSET, and we only ever have one,
    so set res_size and reserve the region from PHYS_OFFSET size res_size.
    
    Don't free the .init sections on Integrator/CP - they sit in the SSRAM
    obscured region so we are unable to use them for DMA purposes.

commit d95e31c577cafc14c94910c474c42f346629d0b1
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Mon May 31 23:56:21 2004 -0700

    Add comments on load balancing special cases.
    
    Ingo explains:
    
    The condition is 'impossible', but the whole balancing code is
    (intentionally) a bit racy:
    
                    cpus_and(tmp, group->cpumask, cpu_online_map);
                    if (!cpus_weight(tmp))
                            goto next_group;
    
                    for_each_cpu_mask(i, tmp) {
                            if (!idle_cpu(i))
                                    goto next_group;
                            push_cpu = i;
                    }
    
                    rq = cpu_rq(push_cpu);
                    double_lock_balance(busiest, rq);
                    move_tasks(rq, push_cpu, busiest, 1, sd, IDLE);
    
    in the for_each_cpu_mask() loop we specifically check for each CPU in
    the target group to be idle - so push_cpu's runqueue == busiest [==
    current runqueue] cannot be true because the current CPU is not idle, we
    are running in the migration thread ... But this is not a real problem,
    load-balancing we do in a racy way to reduce overhead [and it's all
    statistics anyway so absolute accuracy is impossible], and active
    balancing itself is somewhat racy due to the migration-thread wakeup
    (and the active_balance flag) going outside the runqueue locks [for
    similar reasons].
    
    so it all looks quite plausible - the normal SMP boxes dont trigger it,
    but Bjorn's 128-CPU setup with a non-trivial domain hiearachy triggers
    it.
    
    Signed-off-by: Ingo Molnar <mingo@elte.hu>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit 810ce4cd6fe48276ec8068135a71ab50193883c7
Author: Bjorn Helgaas <bjorn.helgaas@hp.com>
Date:   Mon May 31 23:40:59 2004 -0700

    [PATCH] active_load_balance() deadlock
    
    active_load_balance() looks susceptible to deadlock when busiest==rq.
    Without the following patch, my 128-way box deadlocks consistently
    during boot-time driver init.

commit 40046d1a42eebbb259a8c4c34864f64b403fc010
Merge: 4bd146f... 841b4bc...
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Mon May 31 23:03:10 2004 -0700

    Merge http://linux-watchdog.bkbits.net/linux-2.6-watchdog
    into ppc970.osdl.org:/home/torvalds/v2.6/linux

commit d10920baac75b812353fefbd6a5ebe7288f66a4a
Author: Herbert Xu <herbert@gondor.apana.org.au>
Date:   Mon May 31 22:35:39 2004 -0700

    [IPSEC]: Fix xfrm_tunnel leak.
    
    Turns out that the IPIP tunnel used by IPCOMP states are only freed
    if the IPCOMP state is deleted by xfrm_state_delete.
    
    This is not the case for all states.  For example, an immature IPCOMP
    state that dies in add_sa will not go through xfrm_state_delete.
    
    The following patch moves the delete_tunnel call into IPCOMP's
    destructor.  I think it makes more sense there as IPCOMP is the
    only user of the tunnel anyway.

commit aaecbc982eebeac729fc56af24134a76953de62b
Author: David S. Miller <davem@nuts.davemloft.net>
Date:   Mon May 31 22:29:20 2004 -0700

    [IPV6]: ndisc_dst_alloc can never get a NULL dev.

commit d6667fe4ad63731210b60d71101720c60acc8c41
Author: Hideaki Yoshifuji <yoshfuji@linux-ipv6.org>
Date:   Mon May 31 22:27:14 2004 -0700

    [IPV6]: Store idev in routes.

commit 4bd146fffe87698377684cf045b481bc464bde22
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Mon May 31 22:13:52 2004 -0700

    Start documenting the sign-off procedure in SubmittingPatches
    
    We already have over 200 sign-off lines in the kernel, so
    let's document the thing, even if discussion may still be
    on-going.

commit 594701016ae33d6deeceb472d5557910dc667ab8
Merge: a7cf3f0... 6cf5f82...
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Mon May 31 21:36:29 2004 -0700

    Merge bk://linux-dj.bkbits.net/agpgart
    into ppc970.osdl.org:/home/torvalds/v2.6/linux

commit 6cf5f82c376907ea8b458030cd0befe52a2b57e6
Merge: b670ef7... 2875ce1...
Author: Dave Jones <davej@delerium.codemonkey.org.uk>
Date:   Tue Jun 1 20:10:55 2004 +0100

    Merge delerium.codemonkey.org.uk:/mnt/nfs/neologic/bar/src/kernel/2.6/trees/bk-linus
    into delerium.codemonkey.org.uk:/mnt/nfs/neologic/bar/src/kernel/2.6/trees/agpgart

commit 2875ce1d4422cc3b1bec5686bc33f053f8d1d6d6
Author: Dave Jones <davej@redhat.com>
Date:   Tue Jun 1 19:39:56 2004 +0100

    [AGPGART] intel-agp: skip non-AGP devices
    From: Matt Domsch.
    The E7205 doesn't have an AGP header, so printing this message is
    pretty much useless.  Also make it KERN_WARNING as well, as it's
    not really worthy of a KERN_ERR

commit 76b92fbd87576ee50135081647dd76fb7ba9819e
Author: Dave Jones <davej@delerium.codemonkey.org.uk>
Date:   Tue Jun 1 19:34:01 2004 +0100

    Cset exclude: davej@redhat.com|ChangeSet|20040523113850|65135

commit eb89c6d40fea7b38f0caf81283ad21eeb14163c0
Author: Dave Jones <davej@redhat.com>
Date:   Tue Jun 1 12:35:02 2004 +0100

    [AGPGART] Improve the resume functions for Intel AGP bridges by restoring config space
    (the bios might not have done that).
    
    From: Arjan van de Ven

commit 595558b05603a9f03e5240f7407a5dbe20afc7d4
Author: Dave Jones <davej@redhat.com>
Date:   Tue Jun 1 11:00:11 2004 +0100

    [AGPGART] Make agp=off work again.
    This option only worked for the amd64 driver.
    On every other driver, the only thing it did was
    make it not printk the banner on startup.

commit 9c0bbb46a0c7daa4e0eb22db3d2cce97546b1916
Author: Dave Jones <davej@redhat.com>
Date:   Tue Jun 1 10:50:18 2004 +0100

    [AGPGART] Fix broken serverworks tlb flush routine.
    This is horribly broken due to a jiffy wrap bug, we never get out of
    the while loop, preventing booting on a kernel with this driver
    compiled in. (See https://bugzilla.redhat.com/bugzilla/show_bug.cgi?id=124495)
    
    The warning message there has never been reported in any bug report
    that google can find, so I'm of the opinion that this driver is trying
    to be too clever for its own good.  Rip out the jiffies logic completely,
    it should be totally unnecessary.

commit a7cf3f04b1124e862a5ef4ae85a3ccf63711745b
Merge: a16b6d1... f6b614e...
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Mon May 31 21:34:45 2004 -0700

    Merge bk://linux-dj.bkbits.net/cpufreq
    into ppc970.osdl.org:/home/torvalds/v2.6/linux

commit 390bb9bab392149c18ad46b8517f5c3a50b3fc17
Merge: 20e743b... 53cb4fe...
Author: Steve French <cifs.adm@hostme.bitkeeper.com>
Date:   Mon May 31 19:17:03 2004 -0700

    Merge bk://linux.bkbits.net/linux-2.5
    into hostme.bitkeeper.com:/repos/c/cifs/linux-2.5cifs

commit a16b6d1372640dfe3b93fcb45c4c02029b06a037
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon May 31 18:52:40 2004 -0700

    [PATCH] radeonfb powerdown doesn't work
    
    From: <fxkuehl@gmx.de>
    
    When I switch the computer to standby with echo -n standby >
    /sys/power/state the radeonfb driver tells me its suspending to state 1 but
    the display does not get turned off.  It turns out to be a small typo in
    drivers/video/aty/radeon_pm.c.
    
    (from http://bugme.osdl.org/show_bug.cgi?id=2758)
    
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit 311a5ffeda8ccb3f1f3840069f37234e043092d4
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon May 31 18:52:29 2004 -0700

    [PATCH] CRIS architecture update
    
    From: "Mikael Starvik" <mikael.starvik@axis.com>
    
    - Lots of fixes from 2.4.
    
    - Updated for 2.6.6.
    
    - Added IDE driver
    
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit 772213c829cd0cd5712bc080fac48c3e84fa0487
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon May 31 18:52:01 2004 -0700

    [PATCH] correct use_mm()/unuse_mm() to use task_lock() to protect ->mm
    
    From: William Lee Irwin III <wli@holomorphy.com>
    
    Split off from suparna's patches:
    
    Correct use_mm()/unuse_mm() to use task_lock() to protect task->mm.
    
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit 7746c15f8bf33bdf459e71678bfc4e21844a7eb7
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon May 31 18:51:50 2004 -0700

    [PATCH] use aio workqueue in fs/aio.c
    
    From: William Lee Irwin III <wli@holomorphy.com>
    
    Minor aio correction split off from suparna's patches:
    
    Use the dedicated aio workqueue, not keventd, in order to isolate the rest
    of the system from aio's demands.
    
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit 11aae24fede553476251821daebd99e2de8b3d62
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon May 31 18:51:39 2004 -0700

    [PATCH] cpqarray.c: seed the random number pool
    
    From: George France <france@handhelds.org>
    
    Teach cpqarray.c to do the add_disk_randomness() thing.
    
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit 1576eb9a22a1b6a911cc9d6c7d2e7df693274923
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon May 31 18:51:28 2004 -0700

    [PATCH] sched: remove noinline workaround
    
    From: Ingo Molnar <mingo@elte.hu>
    
    Now the x86_64 bitop memory clobber problem has been fixed we can remove
    this.
    
    Signed-off-by: Ingo Molnar <mingo@elte.hu>
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit 18241bcbf16e148faf328a7d9df4ea67c62d84f5
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon May 31 18:51:17 2004 -0700

    [PATCH] i386: add missing bitop.h memory clobbers
    
    From: Andi Kleen <ak@muc.de>
    
    Add missing memory clobbers to find_first_bit() and find_first_zero_bit().
    
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit 6d4bf8d1ef2c785d7a056c528ea8ea3608fa9439
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon May 31 18:51:07 2004 -0700

    [PATCH] Fix readahead handling in knfsd
    
    From: NeilBrown <neilb@cse.unsw.edu.au>
    
    The read-ahead structures were not being initialised properly, and were not
    having the use-count decremented after use, making them fairly useless
    (since Apr 2002!).
    
    From: Colin Gibbs <colin@gibbsonline.net>
    Signed-off-by: Neil Brown <neilb@cse.unsw.edu.au>
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit 2b366318f809a544e75751664b058ef159747d2d
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon May 31 18:50:56 2004 -0700

    [PATCH] fix mca procfs stub
    
    From: Christoph Hellwig <hch@lst.de>
    
    
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit 0a0c953047ff606d717a2a90b744a8e8a317e77d
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon May 31 18:50:45 2004 -0700

    [PATCH] linux/timer.h needs linux/stddef.h
    
    From: Christoph Hellwig <hch@lst.de>
    
    timer.h is using NULL and thus needs stddef.h, without it some drivers
    break on alpha.
    
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit f2b112ee3ca50d1474474a0e8ab055f3bf6ba8e3
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon May 31 18:50:34 2004 -0700

    [PATCH] s/tkill/tgkill/ in /** documentation */
    
    From: bert hubert <ahu@ds9a.nl>
    
    Documentation is in fact for tgkill and not for tkill
    
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit d583d3de19acb20667f2355b5e2b54531eb6a62a
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon May 31 18:50:23 2004 -0700

    [PATCH] vesafb: vram boot option the same as 2.4.x
    
    From: Marc-Christian Petersen <m.c.p@kernel.linux-systeme.com>
    
    Give the vesafb `vram' boot option the same (silly) syntax as 2.4 and
    document it.
    
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit 99bbdc992fc14a79a1ac80784d7217b9c4b3f80b
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon May 31 18:50:12 2004 -0700

    [PATCH] Document checkstacks
    
    From: Diego Calleja =?ISO-8859-15?Q?Garc=EDa?= <diegocg@teleline.es>
    
    It'll be much better if the world can know about the existence of
    checkstacks.
    
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit 17bba6c22c99ed3d7ce1418029bc677a2453fbd8
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon May 31 18:50:02 2004 -0700

    [PATCH] pnpbios only makes sense for X86
    
    From: Christoph Hellwig <hch@lst.de>
    
    Extracted from the Debian kernel package
    
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit 3fc90b98f7f243861b1444aef7e620ec183195b8
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon May 31 18:49:51 2004 -0700

    [PATCH] SECURITY_SELINUX depends on NET
    
    From: Adrian Bunk <bunk@fs.tum.de>
    
      LD      .tmp_vmlinux1
    security/built-in.o(.text+0x97e4): In function `selnl_notify':
    : undefined reference to `alloc_skb'
    security/built-in.o(.text+0x988a): In function `selnl_notify':
    : undefined reference to `netlink_broadcast'
    
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit 2e8a8e1e8f4e5d20ac180ab45a36e50199129982
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon May 31 18:49:40 2004 -0700

    [PATCH] POSIX_MQUEUE depends on NET
    
    From: Adrian Bunk <bunk@fs.tum.de>
    
    POSIX_MQUEUE requires netlink.
    
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit 6508dfb8feefa6229db5b4987372fef5c27b19c7
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon May 31 18:49:31 2004 -0700

    [PATCH] md.c message during quiet boot
    
    From: Ingo Molnar <mingo@elte.hu>
    
    the patch below gets rid of a message that gets printed during FC2's quiet
    bootup.
    
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit 0d5ee3edc9e7d8a18d0bab3780ffe48f04073039
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon May 31 18:49:20 2004 -0700

    [PATCH] Missing pop-off in arch/i386/kernel/acpi/wakeup.S
    
    From: <gniibe@m17n.org>
    
    There is a missing pop-off after call of acpi_enter_sleep_state.  On
    success, acpi_enter_sleep_state never returns, but on failure, it will
    cause kernel OOPS.
    
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit d52dcfe5c5fdd8cd4f6183d4632ce44788457d42
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon May 31 18:49:10 2004 -0700

    [PATCH] Support for SC1100
    
    From: David Goodenough <david.goodenough@btconnect.com>
    
    Add PCI device supoprt for the Geode SC1100-based Microtik Routerboard 230.
    
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit df050b72972b171eef7fce7d81b700c9fec74e3d
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon May 31 18:48:58 2004 -0700

    [PATCH] Mark cache_names __initdata
    
    From: Brian Gerst <bgerst@didntduck.org>
    
    We don't need to keep the pointer array around after the caches are
    initialized.  This doesn't affect the actual strings.
    
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit 9b91d73bde9d68800f9e5c338c0cf9d0fe3bc862
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon May 31 18:48:47 2004 -0700

    [PATCH] Add FUTEX_CMP_REQUEUE futex op
    
    From: Jakub Jelinek <jakub@redhat.com>
    
    FUTEX_REQUEUE operation has been added to the kernel mainly to improve
    pthread_cond_broadcast which previously used FUTEX_WAKE INT_MAX op.
    pthread_cond_broadcast releases internal condvar mutex before FUTEX_REQUEUE
    operation, as otherwise the woken up thread most likely immediately sleeps
    again on the internal condvar mutex until the broadcasting thread releases it.
    
    Unfortunately this is racy and causes e.g.
    http://sources.redhat.com/cgi-bin/cvsweb.cgi/libc/nptl/tst-cond16.c?rev=1.1&content-type=text/x-cvsweb-markup&cvsroot=glibc
    to hang on SMP.
    
    http://listman.redhat.com/archives/phil-list/2004-May/msg00023.html contains
    analysis how the hang happens, the problem is if any thread does
    pthread_cond_*wait in between releasing of the internal condvar mutex and
    FUTEX_REQUEUE operation, a wrong thread might be awaken (and immediately go to
    sleep again because it doesn't satisfy conditions for returning from
    pthread_cond_*wait) while the right thread requeued on the associated mutex
    and there would be nobody to wake that thread up.
    
    The patch below extends FUTEX_REQUEUE operation with something FUTEX_WAIT
    already uses:
    
    FUTEX_CMP_REQUEUE is passed an additional argument which is the expected value
    of *futex.  Kernel then while holding the futex locks checks if *futex !=
    expected and returns -EAGAIN in that case, while if it is equal, continues
    with a normal FUTEX_REQUEUE operation.  If the syscall returns -EAGAIN, NPTL
    can fall back to FUTEX_WAKE INT_MAX operation which doesn't have this problem,
    but is less efficient, while in the likely case that nobody hit the (small)
    window the efficient FUTEX_REQUEUE operation is used.
    
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit 673a68e627312d056cadd1e7053a9fc113149333
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon May 31 18:48:36 2004 -0700

    [PATCH] Add watchdog timer to iseries_veth driver
    
    From: David Gibson <david@gibson.dropbear.id.au>
    
    Currently the iSeries virtual ethernet driver has no Tx watchdog timer.
    This makes it vulnerable to clagging up if the other end of connection is
    misbehaving - in particular if it is not giving timely hypervisor level
    acks to our data frams.
    
    This patch adds a watchdog timer which resets the connection to any lpar we
    seem to be having trouble sending to.  With any luck the other end might
    behave better after the reset.  If not, this will at least unclag the queue
    for a while so we can keep talking to the lpars which are behaving
    correctly.
    
    Signed-off-by: David Gibson <david@gibson.dropbear.id.au>
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit dbfd829db92e75e8a3ed0664de01efb6f7b800de
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon May 31 18:48:25 2004 -0700

    [PATCH] ppc64: iseries bolted SLB fix
    
    From: Anton Blanchard <anton@samba.org>
    
    Legacy iseries has problems with the bolted vmalloc patch.  This patch
    disables the optimisation on iseries and creates a slb_add_bolted helper
    function.
    
    Also, while we require all SLB entries to be context switched, we werent
    informing the iseries hypervisor.
    
    Signed-off-by: Anton Blanchard <anton@samba.org>
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit 1348305a129afe22389811e9ac28c4103cc3e7e7
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon May 31 18:48:14 2004 -0700

    [PATCH] ppc64: SLB accounting fix
    
    From: Anton Blanchard <anton@samba.org>
    
    Even though we have a variable containing the number of entries in the SLB,
    we hardwire the value at boot.  We also dont use the variable in the head.S
    fastpath handler.
    
    This patch removes it.
    
    Signed-off-by: Anton Blanchard <anton@samba.org>
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit bfbc3b5f996db1b88c52faec33f33bfa16ac0273
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon May 31 18:48:03 2004 -0700

    [PATCH] ppc64: bolt first vmalloc segment into SLB
    
    From: Anton Blanchard <anton@samba.org>
    
    Based on some profiles we noticed the first vmalloc region was being
    continually cast out and replaced.  All modules end up there so it is one
    of our hottest segments.
    
    This patch bolts the vmalloc region into the second segment.  SLB misses on
    an NFS benchmark were reduced by about 10% with this patch.
    
    Signed-off-by: Anton Blanchard <anton@samba.org>
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit 9e039f5ef0d4e8b95f281822163eeb91262f6aa3
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon May 31 18:47:52 2004 -0700

    [PATCH] ppc64: reset iseries progress indicator on boot
    
    From: Anton Blanchard <anton@samba.org>
    
    Reset the progress indicator on iseries after boot.
    
    Signed-off-by: John Engel <engel@us.ibm.com>
    Signed-off-by: Anton Blanchard <anton@samba.org>
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit 7ce146fc7ed12526635d35772c0ceb06679ef220
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon May 31 18:47:41 2004 -0700

    [PATCH] ppc64: add eeh_add_device_early/late
    
    From: Anton Blanchard <anton@samba.org>
    
    Implement eeh_add_device_early and eeh_add_device_late, required for
    the ppc64 PCI hotplug code.
    
    Signed-off-by: Linas Vepstas <linas@us.ibm.com>
    Signed-off-by: Anton Blanchard <anton@samba.org>
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit b4f4b53f9bcf292197856c21635b22e22be6d583
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon May 31 18:47:31 2004 -0700

    [PATCH] ppc64: iSeries fix virtual ethernet transmit block
    
    From: Stephen Rothwell <sfr@canb.auug.org.au>
    
    This patch fixes the virtual ethernet driver so that it will not block the
    transmit queue indefinitely.  This patch appplies on top of the previous
    patch from Rusty that removed skb_clone.  There is one white space fix in
    hte middle of this - I hope that doesn't offend :-).
    
    Signed-off-by: Stephen Rothwell <sfr@canb.auug.org.au>
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit 6175a4866a5b10cafabf0345f6982ea08e14f710
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon May 31 18:47:20 2004 -0700

    [PATCH] ppc64: iSeries virtual ethernet minor optimisation
    
    From: Stephen Rothwell <sfr@canb.auug.org.au>
    
    This has only been adjusted by me to apply after David Gibson's patch to
    add a watchdog timer.
    
    The iseries_veth driver does skb_clone, it should only need to skb_get,
    which is cheaper.  Should help performance a little.
    
    Signed-off-by: Rusty Russell <rusty@rustcorp.com.au>
    Signed-off-by: Stephen Rothwell <sfr@canb.auug.org.au>
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit 98df7f41641da903a8ae910a0dc31cc199992ec0
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon May 31 18:47:09 2004 -0700

    [PATCH] ppc64: iSeries default config update
    
    From: Stephen Rothwell <sfr@canb.auug.org.au>
    
    This patch brings the iSeries default config up to date and changes some of
    the options to what I use.  These are more sensible options (at least in my
    opinion :-)).  Please apply.
    
    Signed-off-by: Stephen Rothwell <sfr@canb.auug.org.au>
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit 1bd3766b38bdcdb6b69d228b45a6468f21810378
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon May 31 18:46:58 2004 -0700

    [PATCH] radeonfb fix (non-8bpp clear doesn't use palette)
    
    From: Jurriaan <thunder7@xs4all.nl>
    
    I've used this patch since 2.6.5, and other users have confirmed it
    solves their problems.
    
    Basically, when not in 8bpp mode, radeonfb should use the palette when
    clearing a region on screen.  This is how it's done in 2.4 and xfree, also.
    
    Signed-off-by: Jurriaan Kalkman <thunder7@xs4all.nl>
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit f7b634c5e90b37a18ec019fbf906564f2330c959
Author: Paul Mackerras <paulus@samba.org>
Date:   Mon May 31 18:36:07 2004 -0700

    [PATCH] ppc64: fix missing RELOCs, add linux,phandle property
    
    This fixes a couple of bugs in arch/ppc64/kernel/prom.c.  We were
    missing a couple of places where we needed to use RELOC().  I added the
    RELOC in one case, and in the other, moved the variable that we were
    accessing onto the stack (and reduced its size).  (We use the variable
    to get a property value, but we aren't interested in the value, just in
    whether the property exists or not.  Since we pass the size of the
    variable to the OF getprop call, it won't overflow.) The effect of
    missing the RELOCs would be that random memory locations get used on IBM
    pSeries systems (possibly causing random boot failures).
    
    The other thing that this does is add a linux,phandle property to each
    node, containing the phandle for the node, which is the token that OF
    uses to identify the node.  Some nodes reference other nodes by means
    of their phandle.  Without the linux,phandle property, userspace code
    looking at the OF device-tree image in /proc/device-tree has no way of
    knowing which other node is being referenced.
    
    Signed-off-by: Paul Mackerras <paulus@samba.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit 9102d1e21ddb02c1f84998116a341941bb99d5c1
Author: Rusty Russell <rusty@rustcorp.com.au>
Date:   Mon May 31 18:35:56 2004 -0700

    [PATCH] Export kthread primitives
    
    kthreads are not just for breakfast anymore.
    
    Signed-off-by: Rusty Russell <rusty@rustcorp.com.au> (creator)
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit be491baccdb7d44abaf33541d4a45306129cf29e
Author: Andi Kleen <ak@suse.de>
Date:   Mon May 31 18:35:45 2004 -0700

    [PATCH] Fix x86-64 compilation without CONFIG_NUMA
    
    This fixes compilation of x86-64 without CONFIG_NUMA again (got broken
    by the previous patchkit)

commit 5d146f2c456f4bc5e81861eecdc760026560654b
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Mon May 31 18:33:51 2004 -0700

    sparse: use new generic __chk_user_ptr() macro in x86/ppc64/sparc*
    
    Older versions of gcc were unhappy with our previous trick, and
    just separating out the __CHECKER__ case made it much simpler.

commit fc4f76b0cebfd8d371e13e8b375da7f41fc9b87f
Merge: 3ae4c27... d4bcb8a...
Author: David Woodhouse <dwmw2@shinybook.infradead.org>
Date:   Mon May 31 18:51:42 2004 +0100

    Merge

commit 0444d9b3e8570d374a83198229880bf246bb91a1
Author: JÃ¶rn Engel <joern@wohnheim.fh-wedel.de>
Date:   Mon May 31 08:36:02 2004 -0700

    [PATCH] Improve `make checkstack'
    
    On i386, stack usually grows with "sub $0x8,%esp" and shrinks with
    "add $0x8,%esp" respectively.  In some cases, though, stack grows with
    "add $0xffffff80,%esp" and shrinks with "sub $0xffffff80,%esp".
    Obviously, we don't want to miss those cases.
    
    Since in either case add and sub seem to be balanced and contain the
    same parameter, we don't need a second regex.  We simply accept hex
    numbers of up to 8 digits and treat them as negative numbers when the
    sub appears to be a little too high.
    
    ...or so I thought.  But another day of testing proved me wrong again.
    
    Some functions do stuff like "sub $0x10,%esp", ..., "add $0x20,%esp".
    In other words, add and sub are *NOT* balanced.  Manual inspection
    showed that 0x20 is a more realistic number, so I accept either
    variant, just in case.  We pay for this with a bunch of duplicates in
    our output, but that beats missing some stack hogs.
    
    In the long run, this script has to be replaced by gcc options,
    really.  Looking at the result and guessing back is such a stupid
    idea.
    
    Signed-off-by: JÃ¶rn Engel <joern@wohnheim.fh-wedel.de>

commit 53cb4fea69678709549f38d4d363fc107ed1cb0a
Author: Steve French <stevef@smfhome1.smfdom>
Date:   Mon May 31 10:01:23 2004 -0500

    Handle out of memory on allocating dentry or inode during filldir

commit 3ae4c27e2f1e071b0231f24fb9762ae5700177fb
Author: David Woodhouse <dwmw2@shinybook.infradead.org>
Date:   Mon May 31 15:28:44 2004 +0100

    Add support for WindRiver PowerQUICC II.
    
    Code from Guy Streeter <streeter@redhat.com>

commit e13de75abbc63dc7af6a36008710bafb3a98dfbf
Author: Steve French <stevef@smfhome1.smfdom>
Date:   Mon May 31 09:23:23 2004 -0500

    Update cifs change log for cifs 1.17

commit d4bcb8ab79a5d92c461d2fe25b0efb667b3c056f
Author: David Woodhouse <dwmw2@shinybook.infradead.org>
Date:   Mon May 31 15:21:45 2004 +0100

    Fix handle_sysrq() call in PPC 8260 uart driver

commit 063d41950337b122b51486a81c3bc67da6a518ad
Author: Steve French <stevef@smfhome1.smfdom>
Date:   Mon May 31 09:19:47 2004 -0500

    Remove temporary debug message

commit 90afb22fdc656399974b62c2783ec8d9beee9107
Author: Steve French <stevef@smfhome1.smfdom>
Date:   Mon May 31 09:16:30 2004 -0500

    No matter what the blocksize, we are required to use fake blocksize of 512 when calculating
    number of blocks in a file (otherwise this confuses the du command)

commit f8b34d3f72fa29a8045482b33b81669044362a28
Author: David Woodhouse <dwmw2@shinybook.infradead.org>
Date:   Mon May 31 15:16:19 2004 +0100

    PPC 8260 FCC Ethernet: Fix skb leak when TX ring overflows
    
    Patch from Guy Streeter <streeter@redhat.com>
    and/or Peter Barada <pbarada@redhat.com>

commit 2f04699662c662e919ed1934e7b118298130b829
Author: David Woodhouse <dwmw2@shinybook.infradead.org>
Date:   Mon May 31 15:07:48 2004 +0100

    Add PPC 8280 support, calculate core clock frequency.
    
    Patch from Guy Streeter <streeter@redhat.com>

commit 20e743bb39fbfffbdd87223be4af22fc8cd673d8
Merge: f0dcb9b... 7767526...
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Mon May 31 06:47:44 2004 -0700

    Merge bk://gkernel.bkbits.net/net-drivers-2.6
    into ppc970.osdl.org:/home/torvalds/v2.6/linux

commit 7767526086dd1a6698df7dce911e556d615f09db
Author: Matthew Wilcox <willy@debian.org>
Date:   Mon May 31 15:01:40 2004 -0400

    [PATCH] Better tulip handling on PA-RISC
    
    This patch improves some of the handling of PA-RISC tulip cards.
    
     - Introduce HAS_SWAPPED_SEEPROM and NEEDS_FAKE_MEDIA_TABLE
     - Only trigger this code on GSC machines.  The pure PCI machines don't
       have these cards.
     - Allow the chip_name to be overridden in tulip_init_one().
     - Fix some indentation.
     - Handle the output from tulip_read_eeprom() better.

commit c2b08fea38be9f5e65466d25727fe631219b2b20
Author: Krzysztof Halasa <khc@pm.waw.pl>
Date:   Mon May 31 15:01:28 2004 -0400

    [PATCH] Re: [Fwd: [PATCH] Stop queue on close in hdlcdrv]
    
    > From: Ralf Baechle <ralf@linux-mips.org>
    > Subject: [PATCH] Stop queue on close in hdlcdrv
    > To: Jeff Garzik <garzik@gtf.org>
    > Date: Tue, 4 May 2004 13:59:15 +0200
    >
    > The stop method of a driver should ensure queueing is stopped ...
    >
    > diff -u -r1.19 hdlcdrv.c
    > --- suckage/drivers/net/hamradio/hdlcdrv.c 12 Apr 2004 20:23:32 -0000
    
    the above means the following is needed for my drivers - please apply to 2.6:

commit 2c151d833d5ade149579282fc67c2fc2aa91eb55
Author: Christoph Hellwig <hch@lst.de>
Date:   Mon May 31 15:01:17 2004 -0400

    [PATCH] farsync needs <asm/io.h>
    
    i386 gets it implicitly from somewhere but some architectures don't.
    Also move <asm/uaccess.h> down so we have asm after linux headers.

commit 6ed84ee7d7a8acb6f3cc7f82b180333dd30b17a0
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon May 31 15:01:07 2004 -0400

    [PATCH] s2io section fix
    
    s2io_rem_nic() is marked __exit and is being referred to from .data.
    
    Signed-off-by: Andrew Morton <akpm@osdl.org>

commit 76135c52cd0f49c8932a1d99d0905db409bf565f
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon May 31 15:00:56 2004 -0400

    [PATCH] fix net/ixgb/ixgb_main.c warning
    
    From: "Luiz Fernando N. Capitulino" <lcapitulino@prefeitura.sp.gov.br>
    
    drivers/net/ixgb/ixgb_main.c: In function `ixgb_intr':
    drivers/net/ixgb/ixgb_main.c:1593: warning: unused variable `hw'
    (catch by J. Cherry).
    
    This happens because `hw' is only used when CONFIG_IXGB_NAPI is not set.
    As `hw' is used only to have the code readable, we can use it for
    !CONFIG_IXGB_NAPI too.
    
    Signed-off-by: Andrew Morton <akpm@osdl.org>

commit 634a9f3efadbb9cf0acf389ce4719221b33039f0
Merge: d17ae81... 8b24fc9...
Author: Jeff Garzik <jgarzik@redhat.com>
Date:   Mon May 31 14:59:19 2004 -0400

    Merge redhat.com:/spare/repo/linux-2.6
    into redhat.com:/spare/repo/net-drivers-2.6

commit 31661eda3ac06336eca44395213f215079cc2b6d
Author: Steve French <stevef@smfhome1.smfdom>
Date:   Mon May 31 07:31:11 2004 -0500

    cifs_prepare_write fixes to remove problem in which we were not populating page data from the server copy when writing to non-uptodate page

commit f0dcb9baba216ef5f5b4893ccbd6bb3dc3d8c515
Merge: 32360cd... 9b94cba...
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Mon May 31 05:29:47 2004 -0700

    Merge bk://kernel.bkbits.net/davem/sparc-2.6
    into ppc970.osdl.org:/home/torvalds/v2.6/linux

commit 32360cdffd86ce130ea5bc6e39b79dba7ed7c805
Author: David S. Miller <davem@nuts.davemloft.net>
Date:   Mon May 31 05:08:20 2004 -0700

    [SPARC]: First stage of sparc32 sparse work.

commit 9b94cba7734faac3161ceb6d968a160daebe8f11
Merge: 77882f7... 6e3fccf...
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Mon May 31 04:10:55 2004 -0700

    Merge bk://kernel.bkbits.net/davem/bluetooth-2.6
    into ppc970.osdl.org:/home/torvalds/v2.6/linux

commit 5cea11259d19a70c35abcf984cad02be51b8aa48
Merge: 77882f7... ef4c617...
Author: David S. Miller <davem@nuts.davemloft.net>
Date:   Mon May 31 04:03:57 2004 -0700

    Merge nuts.davemloft.net:/disk1/BK/sparcwork-2.6
    into nuts.davemloft.net:/disk1/BK/sparc-2.6

commit 6e3fccfcadcb22a8b7bf93271e3556a9e9bab133
Merge: c517cfc... 130a754...
Author: David S. Miller <davem@kernel.bkbits.net>
Date:   Mon May 31 04:03:02 2004 -0700

    Merge http://linux-mh.bkbits.net/bluetooth-2.6
    into kernel.bkbits.net:/home/davem/bluetooth-2.6

commit 130a75456c1f95d67bc77fbedb3f5d782a479824
Author: Marcel Holtmann <marcel@holtmann.org>
Date:   Tue Jun 1 03:34:49 2004 +0200

    [Bluetooth] Add quirk for broken RTX Telecom based dongles
    
    Some RTX Telecom based USB dongles offer SCO support, but their
    implementation is broken. This patch disables the use of the ISOC
    interface for these devices.

commit 8b553217704b805f4021dfd53dfb534131ccc891
Author: Marcel Holtmann <marcel@holtmann.org>
Date:   Tue Jun 1 03:02:50 2004 +0200

    [Bluetooth] Add dynamic channel allocation for RFCOMM server sockets
    
    If no channel is specified for a RFCOMM server socket, it will search
    for the next free one and automaticly bind to it.
    
    Proposed by Stephen Crane <steve.crane@rococosoft.com>

commit f70c2ac27afca172dd75531c96fc726991448b99
Author: Marcel Holtmann <marcel@holtmann.org>
Date:   Tue Jun 1 02:52:34 2004 +0200

    [Bluetooth] Add dynamic PSM allocation for L2CAP server sockets
    
    If no PSM is specified for a L2CAP server socket, it will search
    for the next free one and automaticly bind to it.
    
    Proposed by Stephen Crane <steve.crane@rococosoft.com>

commit f7679242792ad2affe47e1b394c163009dc4f7d4
Author: Marcel Holtmann <marcel@holtmann.org>
Date:   Tue Jun 1 02:44:36 2004 +0200

    [Bluetooth] Allocate protocol number for HIDP support
    
    This patch allocates the next free protocol number for the upcoming
    HIDP support.

commit 874ccea27a21bd442eab6a31fc366517f7652194
Author: Marcel Holtmann <marcel@holtmann.org>
Date:   Tue Jun 1 02:34:23 2004 +0200

    [Bluetooth] Update Kconfig help entries
    
    This patch updates the address of the BlueZ project and changes
    some wording of the help entries.

commit 5383303e1e74da2a452b8e3cd73111c62d903314
Author: Marcel Holtmann <marcel@holtmann.org>
Date:   Tue Jun 1 02:16:59 2004 +0200

    [Bluetooth] Remove CVS tags and cleanup the code
    
    Since we are using Bitkeeper the CVS tags are useless. This patch
    removes them and makes some whitespace cleanups.

commit 784d9e3432dec7d90afb1ea09b488dc5a856bf1e
Author: Marcel Holtmann <marcel@holtmann.org>
Date:   Tue Jun 1 01:04:38 2004 +0200

    [Bluetooth] Move function exports out of syms.c
    
    With Linux 2.6 there is no need to keep the function exports in a
    central file and thus the use of syms.c makes no real sense. Remove
    it and add the EXPORT_SYMBOL calls to the functions they belong to.

commit 77882f741c3b700a3994eaac358b4d0f58366d02
Merge: 220cf2d... 62bab38...
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Mon May 31 03:30:21 2004 -0700

    Merge bk://bk.arm.linux.org.uk/linux-2.6-pcmcia
    into ppc970.osdl.org:/home/torvalds/v2.6/linux

commit 62bab380c6588be9202ddbcc4647e402a9f89bac
Author: Russell King <rmk@flint.arm.linux.org.uk>
Date:   Mon May 31 13:15:46 2004 +0100

    [PCMCIA] Fix up SOC PCMCIA socket timing calculations
    
    The timing calculations used by the PXA platforms did not always take
    account of the timings handed to us by PCMCIA, and where it did, it
    assumed IO timings for memory windows.
    
    We fix this, and provide a generic function which calculates the
    required timings (in nanoseconds) for IO, memory and attribute
    windows.  The SOC drivers only have to convert this information to
    whatever format the hardware requires to achieve at least these
    timing parameters.

commit 220cf2d8addfefa99a349db36d3d7996b226035b
Merge: 8049c66... ff1457f...
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Mon May 31 03:28:18 2004 -0700

    Merge bk://bk.arm.linux.org.uk/linux-2.6-rmk
    into ppc970.osdl.org:/home/torvalds/v2.6/linux

commit ff1457fc6cf4d5cd0144b9bcc6558d1863433996
Author: Russell King <rmk@flint.arm.linux.org.uk>
Date:   Mon May 31 13:47:23 2004 +0100

    [ARM] Correct permissions on several ARMv6 files.

commit e9849659cab8b8edee4d00eff07041d0d89b9acd
Author: Russell King <rmk@flint.arm.linux.org.uk>
Date:   Mon May 31 13:41:16 2004 +0100

    [ARM] Eliminate meminfo 'end' element
    
    Some machines decided to initialise this element.  It's not necessary
    since find_memend_and_nodes() initialises this itself.  However,
    'end' is not required if we initialise high_memory in this function
    rather than waiting until mem_init() is called.

commit ef4c617acb31eebe7e2438b581fd505f48691b0e
Author: David S. Miller <davem@nuts.davemloft.net>
Date:   Mon May 31 03:09:43 2004 -0700

    [SPARC]: Set sparse arch defines explicitly.

commit 8049c66409a7debcf610cb150900a760d3946abc
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon May 31 02:56:32 2004 -0700

    [PATCH] ppc32: reorg DMA API, add coherent alloc in irq
    
    From: Eugene Surovegin <ebs@ebshome.net>
    
    Put back DECLARE_PCI_UNMAP_???  and friends accidentaly removed during DMA
    API reorganization.
    
    Signed-off-by: Eugene Surovegin <ebs@ebshome.net>
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit 5606f2f285fe6d2648fc3164f40effcd4f18e15f
Merge: c517cfc... 111610a...
Author: David S. Miller <davem@kernel.bkbits.net>
Date:   Mon May 31 02:36:41 2004 -0700

    Merge davem@nuts.davemloft.net:/disk1/BK/sparc-2.6
    into kernel.bkbits.net:/home/davem/sparc-2.6

commit 111610abb9d3a7415755a3131a975f3fbaa14738
Author: David S. Miller <davem@nuts.davemloft.net>
Date:   Mon May 31 02:25:51 2004 -0700

    [SPARC64]: Lots of sparse work for arch/sparc64.

commit c517cfc4ce83032ca3a356ebeb6029d409db1ff8
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Mon May 31 01:18:46 2004 -0700

    sparse: make x86 and ppc64 set the architecture-specific #define's
    explcitly.
    
    sparse doesn't set any arch defines itself.

commit b670ef77777b5e348c75e90027a9983e0465d934
Author: Peter Osterlund <petero2@telia.com>
Date:   Mon May 31 01:11:45 2004 -0700

    [PATCH] Avoid excessive stack usage in NFS
    
    Assigning '*wdata' with a dynamic initializer creates a
    temporary structure copy on the stack, and then the final
    data is initialized with a "memcpy()".
    
    As a result, these NFS functions use more than 800 bytes
    of stack-space.
    
    Changing the code to just do a memset followed by explicit
    initialization of the non-zero member variables takes the
    stack usage down to 36 bytes.
    
    Here is a patch that does exactly that.

commit ab843583d2ac666e40ea5e8e1e0d2d8b0c156ec1
Author: David S. Miller <davem@nuts.davemloft.net>
Date:   Mon May 31 00:44:34 2004 -0700

    [SPARC64]: __volatile --> __volatile__

commit 4b3eb953b835956e4a0fbb594b3c6a81239ec065
Author: David S. Miller <davem@nuts.davemloft.net>
Date:   Mon May 31 00:41:04 2004 -0700

    [SPARC64]: Annotate 64-bit constants with 'UL'

commit b82ea62e6f51088cfe268b6dca98da905661aa42
Author: David S. Miller <davem@nuts.davemloft.net>
Date:   Sun May 30 23:06:15 2004 -0700

    [SPARC64]: Fix NR_IRQS check in hardirq.h

commit 345a8472409935be3341fd95881464a2570f58cf
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Sun May 30 22:35:54 2004 -0700

    ppc64: more user address fixups.
    
    Removed one (harmless) direct user pointer access.

commit 1581e3300e0bcf545f13dc78c278b089c64110a9
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Sun May 30 22:21:49 2004 -0700

    ppc64: add more user annotations to ptrace.c

commit 3cbd4e3873c70088589bc246d16b95355b9dbe8a
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Sun May 30 22:17:16 2004 -0700

    ppc64: fix more user pointers in signal handling

commit d17ae813b50d63b868cfd1cabfc4fd275e11f46f
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Sun May 30 21:19:40 2004 -0700

    sparse: make x86 user pointer checks stricter.
    
    Also use "__force" when forcing the user address to "unsigned long"
    for the address limit check.

commit 0c41bbc86d812a3d095c583e5560d8bc34a411d8
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Sun May 30 20:41:08 2004 -0700

    ppc64: missing __user annotations noticed by stricter checks.

commit 1fbd4d922bd5e889d4a8ad841052ddf9f2caf36c
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Sun May 30 20:39:30 2004 -0700

    ppc64: check more of the user access functions for proper arguments.

commit 77ff9cbccb0e7cc7895d850a4bfd0a9b2b44d702
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Sun May 30 20:38:48 2004 -0700

    sparse: add "__force" type attribute for forcing a cast.

commit 4a5391e7cfd0e26b9b017ea0c81a93d8e1cbe338
Author: Alexander Viro <viro@parcelfarce.linux.theplanet.co.uk>
Date:   Sun May 30 19:59:55 2004 -0700

    [PATCH] sparse: asus_acpi dereference of userland pointers
    
    Direct sscanf() on userland buffer in procfs ->write_proc().  Fixed.

commit 6ad2ec236eb109e34c326f5a7f138b51aad77456
Merge: dfc2505... 018fff9...
Author: David Airlie <drm.adm@hostme.bitkeeper.com>
Date:   Sun May 30 16:08:59 2004 -0700

    Merge http://linux.bkbits.net/linux-2.5
    into hostme.bitkeeper.com:/repos/d/drm/drm-2.6

commit dfc2505c996f871a45be268ae8d3c62840a18569
Author: Alexander Viro <viro@parcelfarce.linux.theplanet.co.uk>
Date:   Sun May 30 10:38:17 2004 -0700

    [PATCH] sparse: reiserfs annotation
    
    Everything straigthforward and takes care of almost all sparse warnings
    in fs/reiserfs/*.

commit 67475a9f0ed5aa7da61006dd3d255d3dccf62aff
Author: Alexander Viro <viro@parcelfarce.linux.theplanet.co.uk>
Date:   Sun May 30 09:17:04 2004 -0700

    [PATCH] trivial annotation for arch/i386/kernel/*
    
    Several places in arch/i386/kernel were still un-annotated - they didn't
    trip copy_.._user(), so they stayed alive.  Caught and killed.
    
    That's not all - there's a big cluster of them in vm86.c, but I haven't
    looked into that code yet.

commit 4b0fece0cebe018519b9da08fd71f02234e2081d
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Sun May 30 08:00:08 2004 -0700

    ppc64: mark the "regshere" marker with proper type information.

commit 006076148886e74c2b5529751aa7281c3d5ee259
Author: Alexander Viro <viro@parcelfarce.linux.theplanet.co.uk>
Date:   Sun May 30 07:35:38 2004 -0700

    [PATCH] sparse alpha: the rest of it
    
    A bunch of "return in void function" dealt with, removed bogus extern
    from definition of __load_new_mm_context(), sanitized fscking ugly
    CROSS_64K() helper (even if sparse doesn't segfault on that anymore,
    it's _still_ fscking ugly).

commit d629752f6f2bd9e8010842d92e8694dd2538549d
Author: Alexander Viro <viro@parcelfarce.linux.theplanet.co.uk>
Date:   Sun May 30 07:34:09 2004 -0700

    [PATCH] sparse alpha: utimes()
    
    	... and that's where I'd found do_utimes() crap before I went
    grepping ;-)

commit 720cc7e3f923d58c4c1c501ce593bdeb9c1355fc
Author: Alexander Viro <viro@parcelfarce.linux.theplanet.co.uk>
Date:   Sun May 30 07:33:58 2004 -0700

    [PATCH] sparse alpha: trivial parts of __user annotation
    
    Trivial stuff in arch/alpha annotated; in two cases of
    osf_proplist_syscall() dereferencing userland pointers replaced with
    get_user

commit 2d6ef4c53e3f42030361cbbb33c187199771eef1
Author: Alexander Viro <viro@parcelfarce.linux.theplanet.co.uk>
Date:   Sun May 30 07:33:47 2004 -0700

    [PATCH] sparse alpha: #if abuses
    
    #if where #ifdef should've been

commit d8ef67d99ac926e1b5a508826fa2e58021bdafde
Author: Alexander Viro <viro@parcelfarce.linux.theplanet.co.uk>
Date:   Sun May 30 07:33:36 2004 -0700

    [PATCH] sparse alpha: long constants
    
    Long constants marked as such

commit 6df77494f3dcef990013a55e43ad92e75e0b1b21
Author: Alexander Viro <viro@parcelfarce.linux.theplanet.co.uk>
Date:   Sun May 30 07:33:26 2004 -0700

    [PATCH] sparse alpha: beginning of __user annotation
    
    Copying primitives annotated.

commit cac8e00942742aaf4a17eb781fca820fca4ec681
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Sun May 30 07:33:10 2004 -0700

    ppc64: more explicitly typed constants

commit 69a6bb32c7d06b4e4455a3654acbf8903e2ba011
Merge: 4e79789... ecf290b...
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Sun May 30 06:31:17 2004 -0700

    Merge bk://kernel.bkbits.net/davem/net-2.6
    into ppc970.osdl.org:/home/torvalds/v2.6/linux

commit 4e79789bc08ac410e14a806069fd7a430981e41c
Merge: ce7c956... 81ade04...
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Sun May 30 06:30:21 2004 -0700

    Merge bk://kernel.bkbits.net/davem/sparc-2.6
    into ppc970.osdl.org:/home/torvalds/v2.6/linux

commit ce7c95667a5688671d9ad05d35bd5df109ca10e2
Merge: 4aae923... ea481f6...
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Sun May 30 06:28:41 2004 -0700

    Merge bk://bk.arm.linux.org.uk/linux-2.6-rmk
    into ppc970.osdl.org:/home/torvalds/v2.6/linux

commit 4aae923415ce97c09f8e64a4c0411e4ccfe421ac
Author: Russell King <rmk@flint.arm.linux.org.uk>
Date:   Sun May 30 16:40:37 2004 +0100

    [ARM] Add two more missing __user annotations for sparse.

commit ea481f6f7b19ed8407d1223f705f37b691108d11
Author: Alexander Viro <viro@parcelfarce.linux.theplanet.co.uk>
Date:   Sun May 30 06:09:42 2004 -0700

    [PATCH] sparse: SIOCGIFCONF handling - the rest of it
    
    Fixed the type of SIOCGIFCONF callback; inet instance was already
    correctly annotated, decnet one was _not_.  Moreover, decnet callback
    needed fixing - dereferencing userland address.

commit eaeaf871396c3e345d293dda3b1b2cd195eadf59
Author: Alexander Viro <viro@parcelfarce.linux.theplanet.co.uk>
Date:   Sun May 30 06:09:31 2004 -0700

    [PATCH] sparse: tty_driver ->write_proc()
    
    Made ->write_proc in tty_driver suitable for procfs write callback

commit 6d7fee2615877bb0f009d9f60cae777b59f40728
Author: Alexander Viro <viro@parcelfarce.linux.theplanet.co.uk>
Date:   Sun May 30 06:09:21 2004 -0700

    [PATCH] sparse: n_tty annotation
    
    n_tty annotated, ldisc_struct ->read() and ->write() got __user
    on their buf argument.

commit 79c58bdef28ae3ea156d840fd84bd0864e1c1dc9
Author: Alexander Viro <viro@parcelfarce.linux.theplanet.co.uk>
Date:   Sun May 30 06:09:10 2004 -0700

    [PATCH] sparse: vt and friends
    
    vt, vt_ioctl, consolemap and selection annotated, struct unimapdesc
    and struct consolefontdesc got __user on their pointer members.

commit f8ee27f6df71a2f3b1dee2114086ad6a934e693c
Author: Alexander Viro <viro@parcelfarce.linux.theplanet.co.uk>
Date:   Sun May 30 06:08:59 2004 -0700

    [PATCH] sparse: tty_ioctl annotation
    
    tty_ioctl.c annotation

commit 1b27246b6500b969146936c2836800bc87627402
Author: Alexander Viro <viro@parcelfarce.linux.theplanet.co.uk>
Date:   Sun May 30 06:08:48 2004 -0700

    [PATCH] sparse: tty_io annotation
    
    tty_io.c annotated

commit 643cd1ae6ed7c3b61fbbbd727b1d601b397c6b6a
Author: Alexander Viro <viro@parcelfarce.linux.theplanet.co.uk>
Date:   Sun May 30 06:08:37 2004 -0700

    [PATCH] sparse: fs/compat.c::copy_iocb() cleanup
    
    That "u64" in there is actually struct iocb __user *.  Changed
    prototype, killed casts in body and caller...

commit 9fe47e69174f33106ad39fea2ccdc33efb294d49
Author: Alexander Viro <viro@parcelfarce.linux.theplanet.co.uk>
Date:   Sun May 30 06:08:26 2004 -0700

    [PATCH] sparse: amd64 - rest
    
    return void in floppy.h and "conditionally long" constants in page.h.
    
    Would be useful to teach as(1) about C notation for long...

commit 1eacdec6b8b4eaa035d9d1e2213c53ac5ade643c
Author: Alexander Viro <viro@parcelfarce.linux.theplanet.co.uk>
Date:   Sun May 30 06:08:15 2004 -0700

    [PATCH] sparse: amd64 - long constants
    
    Long constants marked as such.

commit e7f2954fa37b86f1ab9292e61de506633a434bb9
Author: Alexander Viro <viro@parcelfarce.linux.theplanet.co.uk>
Date:   Sun May 30 06:08:04 2004 -0700

    [PATCH] sparse: amd64 - #if abuse fixes
    
    #if where #ifdef should've been.  Fixed.

commit 908d6d81a909f6b62dab6a2cbb7b828d0016ffc6
Author: Alexander Viro <viro@parcelfarce.linux.theplanet.co.uk>
Date:   Sun May 30 06:07:53 2004 -0700

    [PATCH] sparse: amd64 - more trivial annotations

commit 7c3f26b7d9cba6a5237f9c028fc9df430e1e27ef
Author: Alexander Viro <viro@parcelfarce.linux.theplanet.co.uk>
Date:   Sun May 30 06:07:42 2004 -0700

    [PATCH] sparse: amd64 annotations - trivial part
    
    Annotation of amd64 code - just adding __user where needed...

commit 67e8b28b18250ecad918be23bd0f168a6d684444
Author: Alexander Viro <viro@parcelfarce.linux.theplanet.co.uk>
Date:   Sun May 30 06:07:30 2004 -0700

    [PATCH] sparse: amd64 annotation - beginning
    
    	Annotated basic primitives (copy_.._user, get_user, ...).
    Functions got __user in prototypes, macros (in uaccess.h) got a
    conditional check - see CHECK_UPTR() below.  If you have more elegant
    way to deal with the macros - please, tell.

commit ecf8890448d6c908c8d84e8e9044130b28b91da1
Author: Alexander Viro <viro@parcelfarce.linux.theplanet.co.uk>
Date:   Sun May 30 06:07:19 2004 -0700

    [PATCH] sparse: net/* non-ANSI argument lists

commit 92b7ae572094100988950d2de3b84d1d3fb53906
Author: Alexander Viro <viro@parcelfarce.linux.theplanet.co.uk>
Date:   Sun May 30 06:07:08 2004 -0700

    [PATCH] sparse: more net/* annotation
    
    	Annotation of net/* ...copy... that deals with userland pointers +
    several bits that fell out of previous patch (trivial annotations)

commit babae77f5ec10ce48a494c626af8318063cc4aa4
Author: Alexander Viro <viro@parcelfarce.linux.theplanet.co.uk>
Date:   Sun May 30 06:06:56 2004 -0700

    [PATCH] sparse: trivial part of net/* annotation

commit b623544c9656f026495eeb5dd1e0bb7cb7799f5b
Author: Alexander Viro <viro@parcelfarce.linux.theplanet.co.uk>
Date:   Sun May 30 06:06:44 2004 -0700

    [PATCH] sparse: missed piece of sock_get_timestamp() annotation

commit 722386b96319217ceb58a3c9bd7e82e240c5cf4c
Author: Alexander Viro <viro@parcelfarce.linux.theplanet.co.uk>
Date:   Sun May 30 06:06:33 2004 -0700

    [PATCH] sparse: dev_ioctl() callers
    
    	dev_ioctl() has a __user pointer argument; however, its declaration
    lacks that and callers are also wrong.  Declaration fixed, callers updated.

commit 21a61fb3a5cbde8520ff24bd633a911e7c16410e
Author: Alexander Viro <viro@parcelfarce.linux.theplanet.co.uk>
Date:   Sun May 30 06:06:21 2004 -0700

    [PATCH] sparse: missed setsockopt wrappers
    
    Here's the tail of setsockopt I've missed - for old protocol families we
    have wrappers around those methods.

commit d72e92c65b198230cffdd27fa585d70902e8bae2
Author: Andi Kleen <ak@suse.de>
Date:   Sun May 30 06:01:28 2004 -0700

    [PATCH] Fix compilation on x86-64
    
    I managed to break compilation with my last patch with a last minute edit.

commit ecf290ba84539b84085224e676f078c24ef09b9d
Merge: 5979a91... 59fdc62...
Author: David S. Miller <davem@kernel.bkbits.net>
Date:   Sun May 30 05:22:41 2004 -0700

    Merge davem@nuts.davemloft.net:/disk1/BK/net-2.6
    into kernel.bkbits.net:/home/davem/net-2.6

commit 59fdc62d9ace0b38a81c965629579030b7cfe324
Author: David S. Miller <davem@nuts.davemloft.net>
Date:   Sun May 30 05:12:54 2004 -0700

    [PKT_SCHED]: Missing rta_len init in sch_delay.

commit 81ade048040fdd0be92697324c179eca6c09b963
Merge: 5979a91... 4aaa098...
Author: David S. Miller <davem@kernel.bkbits.net>
Date:   Sun May 30 03:51:09 2004 -0700

    Merge davem@nuts.davemloft.net:/disk1/BK/sparc-2.6
    into kernel.bkbits.net:/home/davem/sparc-2.6

commit 4aaa098f47c16460316015122d9dc8ccdbd850a5
Author: David S. Miller <davem@nuts.davemloft.net>
Date:   Sun May 30 03:43:22 2004 -0700

    [SPARC]: Do tty_flip_buffer_push outside of port lock.

commit c6d6857c6d0afcf5056d1c6ef970d62f8bda69bb
Author: David S. Miller <davem@nuts.davemloft.net>
Date:   Sun May 30 03:39:32 2004 -0700

    [SPARC64]: Update defconfig.

commit 5979a91fa504f251d5bf6b9b3da02dba6b11f435
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Sat May 29 22:50:19 2004 -0700

    ppc64: use "ASM_CONST()" to give proper C type to constants
    that can also be used in assembly language context.
    
    This one fixes the common CPU_FTR_COHERENT_ICACHE warning in
    asm/cacheflush.h.

commit 2e0e3f8a4c09fb4aeb26b833fba8d6a338c5afd6
Author: Andi Kleen <ak@suse.de>
Date:   Sat May 29 21:55:25 2004 -0700

    [PATCH] Really fix empty node 0 on x86-64
    
    x86-64 shares some numa code with i386, and that didn't handle holes in
    the node map properly.  Fix this.

commit be6a14aa510b6bc80faab4a46f636385fac9089a
Author: Andi Kleen <ak@suse.de>
Date:   Sat May 29 21:55:13 2004 -0700

    [PATCH] x86-64 update
    
    Add accumulated bug fixes for x86-64 and some minor cleanups.
    
     - Add ptep_set_access_flags from i386
     - Change memory text mapping to 10MB from 40MB to make alias window
       smaller
     - Disable change_page_attr for kernel mapoing for now (wrong, but the
       other code also doesn't work)
     - Add .bss.page_aligned and align interrupt/exception stacks (idea from
       Matt Mackall)
     - Protect sysenter MSR setup against missing registers.
     - Set mce tolerance level to 1 (panic instead of deadlock)
     - Fix cross 4GB bug in find_first_bit (Michael Matz)
     - Add missing memory clobbers in bitops.h (Suresh B.  Siddha)
     - Check kernel size at boot up
     - Set boot cpu online at boot to fix early printk
     - Fix EFER bit definitions (Dave Jones)
     - Fix comments in 32bit syscall table.
     - Quieten all 32bit syscalls that are unimplemented in 32bit.
     - Various MCE fixes suggested by Eric Morton, David Boles et.al.
       More to come.
     - Quieten some printks
     - Fix cpu online check in msr driver
     - Lower polling interval for machine checks to 5 minutes to avoid
       overrunning the registers.
     - Make memcpy_{from,to}io more compatible with i386 (Roland Dreier)

commit 95d9dbbd94809f7481c3e1001464f202bda178e1
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Sat May 29 21:47:20 2004 -0700

    ppc64: fix untyped large constants so that they don't cause
    sparse to warn about implicit typing.

commit c773633ffb6d51a50fcb80d192a4ab4497d3d899
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Sat May 29 21:10:51 2004 -0700

    Add __user annotations to sock_get_timestamp()

commit 5140ba666487f7627226c727497154da436c58f0
Author: Piotr Kaczuba <pepe@attika.ath.cx>
Date:   Sat May 29 20:32:16 2004 -0700

    [PATCH] make vram boot option actually work
    
    The following patch makes the vram boot option actually be recognized
    and its value assigned to the vram variable.
    
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit 6de482675b48b075c071dcbbab48bffb24a9a3d5
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Sat May 29 09:24:11 2004 -0700

    Linux 2.6.7-rc2

commit bf205ac1ffe2816ce2f55a5f8f4cffbf8738f5cc
Author: Alexander Viro <viro@parcelfarce.linux.theplanet.co.uk>
Date:   Sat May 29 05:36:13 2004 -0700

    [PATCH] sparse: nf_sockopt() annotation
    
    	netfilter set/getsockopt annotated.  That's a continuation of previous
    patch - by now the only remaining place where setsockopt()/getsockopt()
    userland pointers are not traced is vcc_[sg]etsockopt() and down into the
    ATM drivers.  Everything from that area in net/* should be done by now.
    
    	That's pretty much it as far as non-trivial splitting counts; remaining
    patches in net/* are independent, tty and console stuff is also not hard to
    split (not much of it, anyway) and what remains is arch-dependent code for
    alpha and amd64.  Of course there'll be more stuff coming, but as far as I'm
    concerned the rest of my pile is managable - and finally below 200Kb.  That'll
    go tomorrow - right now I'm going down and getting some sleep...

commit 795d12158e51479ecc168328ea0c684b93dd8cb9
Merge: 6f26b80... 7a7ad20...
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Sat May 29 05:33:21 2004 -0700

    Merge Al/Russell fighting over the same __user annotations

commit 7a7ad206dabc19f72ea35e20df69887449388702
Author: Russell King <rmk@flint.arm.linux.org.uk>
Date:   Sat May 29 22:24:42 2004 +0100

    [SERIAL] Fix sparse warnings in serial_core.c
    
    This fixes sparse warnings for the user write method, and the UART
    ioctl functions which copy data to/from userspace.

commit 6f26b809b4690ce623bb9b1b8a2afa889cba3213
Merge: f865915... 926dabe...
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Sat May 29 05:27:15 2004 -0700

    Merge bk://bk.arm.linux.org.uk/linux-2.6-rmk
    into ppc970.osdl.org:/home/torvalds/v2.6/linux

commit 926dabe41adff2e05d576c5c37d733429a5d8c7d
Author: Nicolas Pitre <nico@org.rmk.(none)>
Date:   Sat May 29 22:54:21 2004 +0100

    [ARM PATCH] 1897/1: prevent selecting more than one PXA target
    
    Patch from Nicolas Pitre
    
    ... since this is not supported at the moment and would fail to build.

commit 8b4563979992dc0e3b0d4e4926e655bc2048e499
Author: Nicolas Pitre <nico@org.rmk.(none)>
Date:   Sat May 29 22:50:19 2004 +0100

    [ARM PATCH] 1872/1: base clock difference between PXA25x and PXA27x
    
    Patch from Nicolas Pitre

commit 452995613613eea3a1fb544a7f9c242395f363e6
Author: Nicolas Pitre <nico@org.rmk.(none)>
Date:   Sat May 29 22:41:43 2004 +0100

    [ARM PATCH] 1898/1: fix io_v2p macro on PXA
    
    Patch from Nicolas Pitre
    
    Correcting my own screw-up, found by Ian Campbell.

commit f044e72160a867d1f1cd65fd89261c86cf061e08
Author: Russell King <rmk@flint.arm.linux.org.uk>
Date:   Sat May 29 13:44:29 2004 +0100

    [ARM] Remove obsolete asm-arm/arch-*/keyboard.h

commit f8659154943dac9a188f4cf32b48cd047b567978
Merge: 8dec976... f222a1f...
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Sat May 29 05:25:38 2004 -0700

    Merge bk://bk.arm.linux.org.uk/linux-2.6-pcmcia
    into ppc970.osdl.org:/home/torvalds/v2.6/linux

commit f222a1f84997a00f0200c43cbbde7beaa5a8d0d9
Author: Nicolas Pitre <nico@org.rmk.(none)>
Date:   Sat May 29 23:03:57 2004 +0100

    [ARM PATCH] 1869/1: PCMCIA support for Mainstone
    
    Patch from Nicolas Pitre

commit 3161abde2b5dfd4178f0362fe439d251f9b5ee44
Author: Russell King <rmk@flint.arm.linux.org.uk>
Date:   Sat May 29 13:12:55 2004 +0100

    [ARM] Ensure AMBA devices on Versatile have a correct dma_mask

commit 8dec976d04dca4c7491b7824b1ae8f2870aaeb31
Author: Alexander Viro <viro@parcelfarce.linux.theplanet.co.uk>
Date:   Sat May 29 05:02:23 2004 -0700

    [PATCH] sparse: ->[gs]etsockopt() annotation
    
    	optval (and in case of getsockopt - optlen) made __user, changes
    percolated down into the instances.

commit eb25de276ef2690e79fb8ee1ea54287205b4d324
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Sat May 29 05:00:35 2004 -0700

    Fix up my misedit of Al's good patch. Don't blame Al.

commit 04e3e4abd310413a0ece5b012ec282b08a245b59
Author: Russell King <rmk@flint.arm.linux.org.uk>
Date:   Sat May 29 12:53:46 2004 +0100

    [ARM] Move common definitions to asm/memory.h
    
    Virtually all the architecture specific memory.h files were defining
    the same constants and v<->p translations the same way.  Move them to
    asm/memory.h

commit 7425fae2c6aa45241385dd27bb1ba70966e76c2a
Author: Alexander Viro <viro@parcelfarce.linux.theplanet.co.uk>
Date:   Sat May 29 04:44:03 2004 -0700

    [PATCH] sparse: final bits of compat_ioctl
    
    	ethtool_ioctl() annotated; it would go in the first compat_ioctl
    chunk (trivial ones) if it wouldn't be right after SIOCGIFCONF mess; was
    easier to split in that order...

commit 59e67606af4c4101b10d6954472b7cbe8f1663fd
Author: Alexander Viro <viro@parcelfarce.linux.theplanet.co.uk>
Date:   Sat May 29 04:43:52 2004 -0700

    [PATCH] sparse (compat_ioctl): SIOCGIFCONF
    
    	Switched to compat_alloc_user_space(), killed kmalloc and set_fs(),
    annotated, somewhat cleaned up.

commit 031e22362229eb49e8aff23dc652d0e88d038ce8
Author: Alexander Viro <viro@parcelfarce.linux.theplanet.co.uk>
Date:   Sat May 29 04:43:41 2004 -0700

    [PATCH] sparse (compat_ioctl): fb colourmap stuff
    
    	Similar to previous - annotated, killed helper, made the thing
    type-clean, cleaned up.

commit 6bab544961c7d4b03208124c40dec7984267e6c9
Author: Alexander Viro <viro@parcelfarce.linux.theplanet.co.uk>
Date:   Sat May 29 04:43:31 2004 -0700

    [PATCH] sparse (compat_ioctl): CDROM_SEND_PACKET handling
    
    	annotated, killed useless (and type-buggering - void ** is not
    assignment-compatible with foo **) helper, cleaned up.

commit deb9228d481e769cc0e6223522b0cbf1f4f8d66d
Author: Alexander Viro <viro@parcelfarce.linux.theplanet.co.uk>
Date:   Sat May 29 04:43:20 2004 -0700

    [PATCH] sparse (compat_ioctl): font stuff
    
    	Annotated, cleaned up, wholesale copying of structure with
    subsequeunt casts from hell replaced with get_user()/put_user() on
    the fields we really need.

commit ca8610077049ad98f6169438e08500699a5de78a
Author: Alexander Viro <viro@parcelfarce.linux.theplanet.co.uk>
Date:   Sat May 29 04:43:09 2004 -0700

    [PATCH] sparse (compat_ioctl): blkpg cleanup and annotation
    
    	blkpg ioctls handling switched to compat_alloc_user_space() (instead
    of messing with set_fs()) and annotated.

commit 97d654f7a376331d6599a937e6d8948e55afa1d7
Author: Alexander Viro <viro@parcelfarce.linux.theplanet.co.uk>
Date:   Sat May 29 04:42:59 2004 -0700

    [PATCH] sparse (compat_ioctl): raw_ioctl() fixes
    
    	Whoever had done the translation apparently never heard of
    big-endian boxen.  Replaced the kludge with get_user()/put_user() on
    64bit values.  Note that
    struct raw_config_request
    {
            int     raw_minor;
            __u64   block_major;
            __u64   block_minor;
    };
    has __u64 on _all_ platforms and it is used as an integer in raw.c code.
    The only reason why translation is needed at all is alignment for 64bit
    values; block_major and block_minor themselves should be passed as-is.
    
    	Breakage fixed, entire area annotated.

commit df37a3a3e51b4dec0cbb5c00af2c89006915338a
Author: Alexander Viro <viro@parcelfarce.linux.theplanet.co.uk>
Date:   Sat May 29 04:42:48 2004 -0700

    [PATCH] sparse: compat_ioctl - easy part
    
    	Easy parts of compat_ioctl fixes - pure __user annotation.
    In one place (SG_IO handling) replaced dereference of user pointer
    with put_user() (why whoever had noticed that just put a FIXME instead
    of obvios fix is a mistery...)

commit a9523c1e51789fd425dc915ab4038f9f07e810ab
Author: Alexander Viro <viro@parcelfarce.linux.theplanet.co.uk>
Date:   Sat May 29 02:18:33 2004 -0700

    [PATCH] sparse: fault_in_pages_readable() annotation

commit fa8eda08fd9f5c9282605da5960cc326313b85e3
Author: Alexander Viro <viro@parcelfarce.linux.theplanet.co.uk>
Date:   Sat May 29 02:18:23 2004 -0700

    [PATCH] sparse: misc ->read()/->write() __user annotation
    
    a bunch of trivial ->read() and ->write() instances (and their procfs
    relatives) __user-annotated.  All chunks are independent, but IMO not
    worth splitting.

commit 4d3065044f1794a24a8170b0241f08d718b0ecc2
Author: Alexander Viro <viro@parcelfarce.linux.theplanet.co.uk>
Date:   Sat May 29 02:18:12 2004 -0700

    [PATCH] sparse: bits and pieces
    
    Independent minor bits caught by sparse:
    
     - paride.h mixing void and int in ? :, used always in a void context
       ide-iops.c return insw() - insw is void()
     - scsi/constants.c uses undefined macros in #if; added #define to 0 in
       case that used to leave it undefined
     - usb/host/hcd.h: fixed-point arithmetics in constant
     - fs/exec.c: missing UL on a large constant
     - fs/locks.c: #if where #ifdef should've been
     - fs.h: missing UL on MAX_LFS_FILESIZE in 64bit case

commit 8d6ded5f8ef43dac2c8dde565469c780a2087aa2
Author: Alexander Viro <viro@parcelfarce.linux.theplanet.co.uk>
Date:   Sat May 29 02:18:01 2004 -0700

    [PATCH] sparse: trivial parts of fs/* annotation
    
    	fs/*, fs/proc/*, fs/nfsd/*, fs/autofs4/*
    
    The only interdependent group is the fs/autofs4/* stuff.

commit 83e3aab95b1c99c64e88e4755f1cf7d2fef2a9c6
Author: Alexander Viro <viro@parcelfarce.linux.theplanet.co.uk>
Date:   Sat May 29 02:17:49 2004 -0700

    [PATCH] sparse: aio annotation

commit 990e08a346ad708258dbad85e85236fa75443604
Author: Alexander Viro <viro@www.linux.org.uk>
Date:   Sat May 29 02:17:39 2004 -0700

    [PATCH] sparse: sg.c annotation
    
    rest of pointers in sg ioctl arguments made __user.

commit c8293669a79ad231df763799dbc00d6ac09cddef
Author: Alexander Viro <viro@www.linux.org.uk>
Date:   Sat May 29 02:17:28 2004 -0700

    [PATCH] sparse: scsi_ioctl __user annotation
    
    scsi_ioctl() and scsi_ioctl_send_command() switched to __user *;
    scsi/scsi_ioctl.c annotated.

commit 7e9671c0f2358e083acb2a5ba4fe7d175d3fc8dd
Author: Alexander Viro <viro@www.linux.org.uk>
Date:   Sat May 29 02:17:16 2004 -0700

    [PATCH] sparse: scsi_cmd_ioctl __user annotation
    
    scsi_cmd_ioctl() switched to __user *, block/scsi_ioctl.c annotated.

commit d094cdb29b503602a32a5be2a0f0a0a02e883745
Author: Alexander Viro <viro@www.linux.org.uk>
Date:   Sat May 29 02:17:05 2004 -0700

    [PATCH] sparse: make sg_io_hdr->cmdp a __user pointer
    
    copying moved into sg_io()

commit 140447463910723009b8b03849ad7af94f547e85
Author: Alexander Viro <viro@www.linux.org.uk>
Date:   Sat May 29 02:16:55 2004 -0700

    [PATCH] sparse: kernel/sysctl.c annotation and cleanup

commit 990852fb3ea227cbf98ed43f7a4dc988f08b3ab5
Author: Alexander Viro <viro@www.linux.org.uk>
Date:   Sat May 29 02:16:44 2004 -0700

    [PATCH] sparse: trivial part of cdrom.c annotation

commit 529bbe4687be6c64af4b43e37bd79226fb0989e4
Author: Alexander Viro <viro@www.linux.org.uk>
Date:   Sat May 29 02:16:34 2004 -0700

    [PATCH] sparse: trivial part of drivers/scsi/* annotation

commit 5d5cdc9bf5fd378f5d3fd1b66ff288388b172865
Author: Alexander Viro <viro@www.linux.org.uk>
Date:   Sat May 29 02:16:22 2004 -0700

    [PATCH] sparse: cdrom_generic_command split into kernel/user
    
    The kernel instance (packet_command) has kernel pointers, userland one -
    __user ones. Surprise.

commit 6e5243ccb0f5667e61b068905c461a54c3e92b7f
Author: Alexander Viro <viro@parcelfarce.linux.theplanet.co.uk>
Date:   Sat May 29 00:33:30 2004 -0700

    [PATCH] more sparse checking of do_utimes()
    
    Speaking of conflicts...  Here's another half of a do_utimes() patch,
    same story as on ppc64:

commit 0b973969d3bab5a00e09e2bea379c5da4138ecec
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Sat May 29 00:32:11 2004 -0700

    Add __user pointer annotations to ppc64 code

commit 4be77aab98558b3da12de6edc1a657485d92e9c4
Merge: e873493... 65933b2...
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Fri May 28 23:39:07 2004 -0700

    Merge bk://cifs.bkbits.net/linux-2.5cifs
    into ppc970.osdl.org:/home/torvalds/v2.6/linux

commit e8734933b3733ab5d779b06896afb7cb8d3511d8
Merge: f6677fe... 8455ddd...
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Fri May 28 23:37:49 2004 -0700

    Merge bk://bk.linux1394.org/ieee1394-2.6
    into ppc970.osdl.org:/home/torvalds/v2.6/linux

commit f6677fee6faaee2a9df84d66e5747a14e1e76edb
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Fri May 28 23:33:01 2004 -0700

    adb.c needs <linux/devfs_fs_kernel.h>

commit 462710a0879c6aa63f314a737af4a534526c6e69
Merge: 932e3f9... 6416306...
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Fri May 28 23:26:05 2004 -0700

    Merge bk://kernel.bkbits.net/davem/net-2.6
    into ppc970.osdl.org:/home/torvalds/v2.6/linux

commit 64163067f60b1396c1ee4ae22cc9dd45fce0d197
Merge: 57cbd59... b4bfed9...
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Fri May 28 23:25:16 2004 -0700

    Merge bk://kernel.bkbits.net/davem/sparc-2.6
    into ppc970.osdl.org:/home/torvalds/v2.6/linux

commit 57cbd59b73574a7cadd3de59218fa4467127d4a2
Author: Alexander Viro <viro@parcelfarce.linux.theplanet.co.uk>
Date:   Fri May 28 23:18:42 2004 -0700

    [PATCH] Missed RTC_IRQ patchlet
    
    oh, hell - I missed this one when carving the thing out of big patch ;-/

commit 932e3f9011e930177ab308db24ea78c937506e36
Merge: 4ed5063... 0398562...
Author: David S. Miller <davem@kernel.bkbits.net>
Date:   Fri May 28 23:13:58 2004 -0700

    Merge davem@nuts.davemloft.net:/disk1/BK/net-2.6
    into kernel.bkbits.net:/home/davem/net-2.6

commit f055cb9a57572cf9434e281c71c95bd19dcbff21
Author: Adam Kropelin <akropel1@rochester.rr.com>
Date:   Fri May 28 23:12:44 2004 -0700

    [PATCH] typo in OSS sparse __user annotations
    
    Fix a missing initialization in the sparse __user annotation work for OSS.
    
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit 7060577bcad260ab8f474c29048c0e3b29b58f7a
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Fri May 28 23:11:39 2004 -0700

    Add __user pointer annotations to fs/compat.c

commit 03985627f81a1c7d644f2e762193b9caf0bf727d
Author: David S. Miller <davem@nuts.davemloft.net>
Date:   Fri May 28 23:10:54 2004 -0700

    [NET]: Do net_todo_list empty check under semaphore.

commit 4ed5063556cf0170961f4a09a2cf425c4dfc9a23
Merge: 37dedf0... 324610c...
Author: David S. Miller <davem@kernel.bkbits.net>
Date:   Fri May 28 23:07:59 2004 -0700

    Merge davem@nuts.davemloft.net:/disk1/BK/net-2.6
    into kernel.bkbits.net:/home/davem/net-2.6

commit b4bfed95a1d017d791ad5a98188241e28b2f3de1
Merge: 324610c... 1b87ecf...
Author: David S. Miller <davem@kernel.bkbits.net>
Date:   Fri May 28 22:56:15 2004 -0700

    Merge davem@nuts.davemloft.net:/disk1/BK/sparc-2.6
    into kernel.bkbits.net:/home/davem/sparc-2.6

commit 9c101b04310b7820763bad29c8be5c4ca37e3ec9
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Fri May 28 22:53:47 2004 -0700

    Add __user pointer annotations to arch/ppc64/kernel/sys_ppc32.c
    
    This also fixes a terminally broken sys32_utimes() implementation.

commit b0876e8a0f9798f5fab800896e2dcd55eb577bdc
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Fri May 28 22:52:33 2004 -0700

    Fix sparse complaint about badly typed constant

commit 37dedf026ba7d78ae82fd77c69d047afd69bd327
Author: Herbert Xu <herbert@gondor.apana.org.au>
Date:   Fri May 28 22:46:04 2004 -0700

    [IPSEC]: Fix ref counting in __xfrmN_bundle_create().

commit bc368e8fdc90520a4ddcbcfde35fe3fc2de68c80
Author: Stephen Hemminger <shemminger@osdl.org>
Date:   Fri May 28 22:41:48 2004 -0700

    [NET]: Simplify netdev_sysfs_xxx if SYSFS is not configured.
    
    Don't need all the network sysfs code if CONFIG_SYSFS is not enabled.
    Also:
    	* netdev_sysfs_unregister is declaration mismatch
    	* if netdev_sysfs_register fails print a warning.
    	  Need to still mark it as registered so the unregister_netdevice works,
    	  but we will probably end up leaking memory in that case.

commit 49d989d40e961184e6e89d35513f86e6524bcd4c
Author: Patrick McHardy <kaber@trash.net>
Date:   Fri May 28 22:40:34 2004 -0700

    [IRDA]: Fix NULL-ptr dereference in irlmp_get_saddr().

commit 91f0d73513ba5a0f87cff08851ff0dcd5d9476e6
Author: Patrick McHardy <kaber@trash.net>
Date:   Fri May 28 22:39:03 2004 -0700

    [IPV4]: Fix skb leak in igmpv3_newpack.

commit 4caa1239a1592fa0760b86d73e5d570ed844da59
Author: Patrick McHardy <kaber@trash.net>
Date:   Fri May 28 22:38:17 2004 -0700

    [IPV4,6]: Fix off-by-one in max protocol-type check

commit 39a98687f987026216f2ea5de0592032dc18b600
Author: Patrick McHardy <kaber@trash.net>
Date:   Fri May 28 22:37:22 2004 -0700

    [IPV6]: Fix memory leak in ah6.c

commit 84b6951bb8d1f492cbf326dd5336094d1f107918
Author: Hideaki Yoshifuji <yoshfuji@linux-ipv6.org>
Date:   Fri May 28 22:35:45 2004 -0700

    [NET]: Prevent future missed updates of FOO_MAX macros.

commit 739fc3458663d8bfa6c67492b25deefea396278a
Author: Herbert Xu <herbert@gondor.apana.org.au>
Date:   Fri May 28 22:34:25 2004 -0700

    [AF_KEY]: Set family for state selector.
    
    As the comment in the code suggests, nobody really uses this so nobody
    will notice the difference :) Still, let's make it correct while we're
    at it.

commit 1b87ecf3558093be034484889903dcefc6923823
Author: David S. Miller <davem@nuts.davemloft.net>
Date:   Fri May 28 22:27:54 2004 -0700

    [SPARC64]: compat select and futex need %o4 zero-extended.

commit 88da3d60c29990ffaa65dcf36879d7de3fedff0b
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Fri May 28 22:19:56 2004 -0700

    Add __user annotations to arch/ppc64/kernel/process.c

commit 05ca65c3d27296a668e752894b22faabfbc9ac56
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Fri May 28 22:17:40 2004 -0700

    Add __user annotations to arch/ppc64/kernel/syscalls.c

commit e8259a943068b0f08485e56a04f95b59d07215eb
Author: David S. Miller <davem@nuts.davemloft.net>
Date:   Fri May 28 22:06:39 2004 -0700

    [TCP]: More sysctl tweakings for rcvbuf stuff.
    
    1) Add sysctl to control rcvbuf moderation, off for now.
    2) Set default winscale to zero.

commit 324610cf6bfba877a879bcd68f607e0977a4f993
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Fri May 28 22:00:58 2004 -0700

    Add __user annotations to ppc64 signal.c

commit a2e80cf8d96b767bc62e735c0afcf374eb8f82e5
Author: Alexander Viro <viro@www.linux.org.uk>
Date:   Fri May 28 21:15:01 2004 -0700

    [PATCH] sparse: trivial part of kernel/* __user annotation

commit c4787237d4800bbf8f1cbf758a51b2850552af42
Author: Alexander Viro <viro@www.linux.org.uk>
Date:   Fri May 28 21:14:50 2004 -0700

    [PATCH] sparse: partial mm/* __user annotation

commit 20158e4d89e0ff9280a7f311151e31a2228a6f87
Author: Alexander Viro <viro@www.linux.org.uk>
Date:   Fri May 28 21:14:39 2004 -0700

    [PATCH] sparse: rtc.c __user annotation
    
    Also replacement of #if RTC_IRQ with #ifdef, moved inlined function in
    front of all uses.

commit 9464d6ad993bbda6cb6729d4f0fb875119da639c
Author: Alexander Viro <viro@www.linux.org.uk>
Date:   Fri May 28 21:14:28 2004 -0700

    [PATCH] sparse: trivial part of drivers/ide __user annotation

commit afc11cbca73ef3106fb60d14381de3cc2feee174
Author: Alexander Viro <viro@www.linux.org.uk>
Date:   Fri May 28 21:14:17 2004 -0700

    [PATCH] sparse: ide-proc.c fixes
    
    Fixed dereferencing userland pointers, general idiocy in parsing.

commit 70c7987d068f8d67f342c4b029d4fdb5c1558635
Author: Alexander Viro <viro@www.linux.org.uk>
Date:   Fri May 28 21:14:06 2004 -0700

    [PATCH] sparse: OSS __user annotation
    
    caddr_t is gone (most of the instances were void __user * in disguise,
    the rest - void *)
    
    Fixed b0rken ioctls in mpu401 and pss - they used to dereference
    userland pointers with no checks.

commit aee997162e32f7367aaacdc34d98166117f6e47d
Author: Alexander Viro <viro@www.linux.org.uk>
Date:   Fri May 28 21:13:54 2004 -0700

    [PATCH] sparse: partial serial_core.c __user annotation

commit 7ca9ab3b2be6586dd3799f41d46276be8de4cbaf
Author: Alexander Viro <viro@www.linux.org.uk>
Date:   Fri May 28 21:13:42 2004 -0700

    [PATCH] sparse: drivers/pci __user annotation

commit f49b24c5b79b4ce663f49894efad4e969f426333
Author: Alexander Viro <viro@www.linux.org.uk>
Date:   Fri May 28 21:13:32 2004 -0700

    [PATCH] sparse: partial drivers/input __user annotation

commit 4e46f5c98d059345f5de04a4ec6b883da29a8f3b
Author: Alexander Viro <viro@www.linux.org.uk>
Date:   Fri May 28 21:13:21 2004 -0700

    [PATCH] sparse: trivial part of drivers/block __user annotation

commit e7f962f1abb601bd3a52e89a74f9b1ac3fd9366d
Author: Alexander Viro <viro@www.linux.org.uk>
Date:   Fri May 28 21:13:10 2004 -0700

    [PATCH] sparse: trivial part of drivers/char __user annotation

commit 1c95bb402899abf79da1c6314c0fc95b850d97dc
Author: Alexander Viro <viro@www.linux.org.uk>
Date:   Fri May 28 21:12:58 2004 -0700

    [PATCH] sparse: acpi __user annotation

commit 79f21235ec35e69cff70c5b6914ee020b4e01831
Author: Alexander Viro <viro@www.linux.org.uk>
Date:   Fri May 28 21:12:47 2004 -0700

    [PATCH] sparse: ipc __user annotation

commit ebf392cd3adede7adf10950f48f25766c5adc9df
Author: Alexander Viro <viro@www.linux.org.uk>
Date:   Fri May 28 21:12:36 2004 -0700

    [PATCH] sparse: ext2 __user annotation (ioctl)

commit d608b1b2224c97b7699c5d3e077b7e088ea5e5b7
Author: Alexander Viro <viro@www.linux.org.uk>
Date:   Fri May 28 21:12:25 2004 -0700

    [PATCH] sparse: nfs __user annotation (client only, and not touching RPC)

commit 7a08b07c416d595bbccb1f50af6f59df4c27eda3
Author: Alexander Viro <viro@www.linux.org.uk>
Date:   Fri May 28 21:12:14 2004 -0700

    [PATCH] sparse: parport __user annotation (sysctls)

commit 072ab23d10d2c4e814f12321e613400ae75415c3
Author: Alexander Viro <viro@www.linux.org.uk>
Date:   Fri May 28 21:12:03 2004 -0700

    [PATCH] sparse: oprofile __user annotation

commit da9a37d7b018600424c840694735d0078d7879a2
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 28 20:59:39 2004 -0700

    [PATCH] nfsd: missing dget()
    
    From: Neil Brown <neilb@cse.unsw.edu.au>
    
    The recentish change to fh_compose not consuming a reference to the passed
    dentries missed this needed dget.
    
    Signed-off-by: Neil Brown <neilb@cse.unsw.edu.au>
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit 81e95d97a007544fe8671ef3cf8c70e6d19ab943
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 28 20:59:28 2004 -0700

    [PATCH] vt_ioctl() comment fix
    
    From: <Andries.Brouwer@cwi.nl>
    
    The "Probably init should be changed" happened almost ten years ago.
    
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit e83dd3746c20a6c8b593db062419fca7127e7fb5
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 28 20:59:18 2004 -0700

    [PATCH] CREDITS file update
    
    From: Robert Love <rml@ximian.com>
    
    Update Robert's email address
    
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit 000cf1d7b42d8cf31b1e99fd0d3ac81a03df1bbc
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 28 20:59:07 2004 -0700

    [PATCH] CREDITS file update
    
    From: <Valdis.Kletnieks@vt.edu>
    
    Thomas Dunbar used to be working in one of the Dean's offices here.  He's
    now down the hall from me (and has been for several years, actually).  So
    let's fix the crufty pointers.
    
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit ec9b8ac0808cdcb30c1a34687ad4e9036db60b15
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 28 20:58:56 2004 -0700

    [PATCH] fs/dcache.c: avoid race when updating nr_unused count of unused dentries.
    
    From: NeilBrown <neilb@cse.unsw.edu.au>
    
    d_count == 1 is no guarantee that dentry is on the dentry_unused list, even
    if it has just been incremented inside dcache_lock, as dput can decrement
    at any time.
    
    This test from Greg Banks is much safer, and is more transparently correct.
    
    Cc: Maneesh Soni <maneesh@in.ibm.com>, Dipankar Sarma <dipankar@in.ibm.com>
    From: Greg Banks <gnb@melbourne.sgi.com>
    Signed-off-by: Neil Brown <neilb@cse.unsw.edu.au>
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit 7cd50e492dd69a153a8dfb9eaaf957457a84c373
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 28 20:58:46 2004 -0700

    [PATCH] epoll events send fix
    
    From: Davide Libenzi <davidel@xmailserver.org>
    
    We're now sending epi->event.events while it should be sending
    epi->revents.
    
    Signed-off-by: Davide Libenzi <davidel@xmailserver.org>
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit 7b90d17f78875d305f446881f8af6e9188513a0c
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 28 20:58:35 2004 -0700

    [PATCH] ADT746X MAINTAINERS update
    
    From: Colin Leroy <colin@colino.net>
    
    I'm maintaining this driver i wrote :)
    
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit 3ebe8e854b8a4d33b4c9ecd849cf4d69414b5270
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 28 20:58:24 2004 -0700

    [PATCH] fix unchecked return value in register_disk()
    
    From: "Luiz Fernando N. Capitulino" <lcapitulino@prefeitura.sp.gov.br>
    
    Signed-off-by: Luiz Capitulino <lcapitulino@prefeitura.sp.gov.br>
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit 1775a3e9a95c43558c6faa8e98fdcee5c741f1c7
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 28 20:58:13 2004 -0700

    [PATCH] asm-i386/timer.h docu cleanup
    
    From: Adam Lackorzynski <adam@os.inf.tu-dresden.de>
    
    This patch fixes a typo (intruupt), a possible confusion (ms should be
    microseconds here, not milli), and adds descriptions for the missing
    functions.
    
    Signed-off-by: Adam Lackorzynski <adam@os.inf.tu-dresden.de>
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit 5fcef9cb18491ecec8d8da2663e15a9a787d618d
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 28 20:58:02 2004 -0700

    [PATCH] use SLAB_PANIC for general caches
    
    From: Brian Gerst <bgerst@didntduck.org>
    
    Initialize the general caches using SLAB_PANIC instead of BUG().
    
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit e96b07be6878caf421ecf89a5ce9d92766f9b6a5
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 28 20:57:52 2004 -0700

    [PATCH] dm: change maintainer
    
    From: <thornber@redhat.com>
    
    Change of device-mapper maintainer
    
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit 1421814a2c4cbde447ff780105eeb4f479b2cfda
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 28 20:57:41 2004 -0700

    [PATCH] dm-table.c: proper usage of dm_vcalloc
    
    From: Kevin Corry <kevcorry@us.ibm.com>
    
    dm-table.c: Proper usage of dm_vcalloc. [Dave Olien]
    
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit 111ad9d18344d4aea5a0ea290c315228f6bde7d1
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 28 20:57:30 2004 -0700

    [PATCH] dm: add static and __init qualifiers
    
    From: Kevin Corry <kevcorry@us.ibm.com>
    
    DM: Add static and __init qualifiers. [Dave Olien]
    
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit 52414318a62cba27ea917901f2e68bd2e20444c4
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 28 20:57:19 2004 -0700

    [PATCH] dm-ioctl: replace dm_[add|remove]_wait_queue() with dm_wait_event()
    
    From: Kevin Corry <kevcorry@us.ibm.com>
    
    Some testing of DM multipath has turned up a problem with the DEVICE_WAIT
    command.  In the tests, while performing a DEVICE_WAIT on a multipath device,
    the command sometimes returns immediately, even though the event-number is
    correct and no path-failure has occurred to trigger an event.  The problem was
    tracked down to the call to schedule() in dev_wait(), which would return even
    though it was not woken up by a DM table event.
    
    This patch moves the responsibility for waiting from the ioctl interface into
    the core driver, and uses wait_event_interruptible() instead of relying on
    wait-queues and schedule().
    
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit 0f76498d7ed6e0cf773e00937d000dd0749a31fe
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 28 20:57:09 2004 -0700

    [PATCH] dm.c: free cloned bio on error path
    
    From: Kevin Corry <kevcorry@us.ibm.com>
    
    In __map_bio(), if the target returns an error while mapping the I/O, the
    cloned bio needs to be freed.
    
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit c1d91a0db5267c06bddeec33bce7bb379a0b36cb
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 28 20:56:58 2004 -0700

    [PATCH] dm-ioctl.c: fix off-by-one error
    
    From: Kevin Corry <kevcorry@us.ibm.com>
    
    Fix an OB1 error when calculating an output buffer size, that could cause a
    missing null termininator in the 'list devices' ioctl results.  [Steffan
    Paletta]
    
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit edf6250b4ce9ab44481f597487f688fec8c1a33d
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 28 20:56:47 2004 -0700

    [PATCH] i386: put irq stacks in .bss.page_aligned section
    
    From: Matt Mackall <mpm@selenic.com>
    
    I noticed that my vmlinux BSS had grown from 17k to 45k between 2.6.5 and
    2.6.6.  8k was moving a pair of objects in head.S from the text section to
    bss, 8k was the introduction of IRQ stacks, while the remainder (12k) was
    page alignment slop, some of it spurious.  The following patch brings BSS
    down to the expected 33k.
    
    Throw the IRQ stacks into the page aligned section to avoided wasted BSS
    space.  While we'd expect this to save up to 4k, this saves over 10k of BSS
    here due to gcc3.3 spuriously aligning other objects in the vicinity.
    
    Signed-off-by: Matt Mackall <mpm@selenic.com>
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit 3a76313bfbbd344cd4588da4314901882a609ecf
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 28 20:56:36 2004 -0700

    [PATCH] Add `make checkstack' target
    
    Jorn Engel <joern@wohnheim.fh-wedel.de>
    
    Adds a `make checkstack' target.  This disassembles and parses vmlinux and
    *.ko, generating a sorted list of stack hogs, eg:
    
    0xc0100663 huft_build:                                  1456
    0xc01022d3 huft_build:                                  1456
    0xc0103127 inflate_dynamic:                             1328
    0xc0101487 inflate_dynamic:                             1324
    0xc010131f inflate_fixed:                               1168
    0xc0102fb7 inflate_fixed:                               1168
    0x00000003 sha512_transform:                            984
    0xc024aee3 Vpd:                                         952
    0x00000003 twofish_setkey:                              804
    0x000060c3 isd200_action:                               792
    0x0000e6cb nfsd4_proc_compound:                         760
    0xc0249087 SkPnmiGetStruct:                             712
    ....
    
    
    Supported architectures are alleged to be arm, x86, ia64, mips, mips64, ppc,
    ppc64 and s390x.
    
    
    Signed-off-by: JÃ¶rn Engel <joern@wohnheim.fh-wedel.de>
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit 969d891190f3d95b2f7108c0e2c8c4082f4c9e1c
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 28 20:56:25 2004 -0700

    [PATCH] ppc64: xmon fixes
    
    From: Anton Blanchard <anton@samba.org>
    
    A few xmon fixes:
    
    - Check we have the set-indicator property before calling rtas.
    - We were printing a cpu number in one place with %s, fix.
    
    Signed-off-by: Anton Blanchard <anton@samba.org>
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit cc88f9f97d247b0dbf6d08c7f222790cde67f91c
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 28 20:56:14 2004 -0700

    [PATCH] ppc32: reorg DMA API, add coherent alloc in irq
    
    From: Matt Porter <mporter@kernel.crashing.org>
    
    Reorg PPC DMA API. Use PCI DMA API wrapper and add coherent alloc in irq.
    
    Signed-off-by: Matt Porter <mporter@kernel.crashing.org>
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit 6d1b79f31408235a1ffdb1916a34e7dcb7261f76
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 28 20:41:58 2004 -0700

    [PATCH] ppc32: fix PPC4xx for the handle_page_fault() change
    
    From: Matt Porter <mporter@kernel.crashing.org>
    
    Fixes PPC4xx from the do_page_fault()->handle_page_fault() change.
    
    Signed-off-by: Matt Porter <mporter@kernel.crashing.org>
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit e254e56c77f8068e24a6066f2d293cfe0519d53c
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 28 20:41:47 2004 -0700

    [PATCH] ppc32: ix compiling arch/ppc/8260_io/enet.c
    
    From: Tom Rini <trini@kernel.crashing.org>
    
    When the 826x enet driver was made to call register_netdev/free_netdev,
    no one declared 'err' in the function.
    
    Signed-off-by: Tom Rini <trini@kernel.crashing.org>
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit cb876f0391301de63ee0af201ae85754fcb92281
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 28 20:41:36 2004 -0700

    [PATCH] use new msleep() in ADT746x driver
    
    From: Benjamin Herrenschmidt <benh@kernel.crashing.org>
    
    This patch replaces schedule_timeout() with the new msleep().
    
    Signed-off-by: Benjamin Herrenschmidt <benh@kernel.crashing.org>
    Signed-off-by: Colin Leroy <colin@colino.net>
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit 3285df44443d7dc162e85d7e07d797fd1ddfa238
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 28 20:41:26 2004 -0700

    [PATCH] fix non-existent /dev/adb
    
    From: Benjamin Herrenschmidt <benh@kernel.crashing.org>
    
    This patch fixes the lack of /dev/adb in kernel 2.6.7-rc1.  The call to
    devfs_mk_cdev() has probably been removed too soon.  Hope this one is
    better than the last one ;)
    
    Signed-off-by: Benjamin Herrenschmidt <benh@kernel.crashing.org>
    Signed-off-by: Colin Leroy <colin@colino.net>
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit 320565ce2280c39db059639c6e33912433e63a5c
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 28 20:41:15 2004 -0700

    [PATCH] Fix typo in pmac_zilog
    
    From: Benjamin Herrenschmidt <benh@kernel.crashing.org>
    
    This patch fixes a typo preventing channel B from working on the Rx path of
    pmac zilog (never calling tty_flip_*).  I think I never tested channel B :)
    
    Thanks to Hollis Blanchard for spotting the bug.
    
    Signed-off-by: Benjamin Herrenschmidt <benh@kernel.crashing.org>
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit d80734dae95728a19832d8abb84262b26340d22c
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 28 20:41:04 2004 -0700

    [PATCH] ppc64: remove silly debug path from get_vsid()
    
    From: David Gibson <david@gibson.dropbear.id.au>
    
    Currently the get_vsid() and get_kernel_vsid() functions have a test which
    enables a different VSID algorithm for debugging.  Using a dumb VSID
    algorithm for stressing the hash table is a reasonable debugging tool, but
    switching it at runtime makes no sense at all.  Plus it adds another test
    and memory access to the performance critical SLB miss path.
    
    This patch removes the test, replacing it with a compile time switch.  It
    seems to make a measurable, although small speedup to the SLB miss path
    (maybe 0.5%).
    
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit 9978a575245c1bfad797996a9c57c0af2171d80f
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 28 20:40:53 2004 -0700

    [PATCH] d_bucket initialisation simplification
    
    The recent nfsd fix was too fancy.  When initialising d_bucket to an "invalid"
    value, all we need is a NULL in there.
    
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit 65933b2cd8dc1ca6162807e43a66a52a52367415
Merge: d375152... 05800c0...
Author: Steve French <cifs.adm@hostme.bitkeeper.com>
Date:   Fri May 28 18:40:48 2004 -0700

    Merge bk://linux.bkbits.net/linux-2.5
    into hostme.bitkeeper.com:/repos/c/cifs/linux-2.5cifs

commit 05800c021ee09e2d63f390859aa5972352649655
Author: Steve French <stevef@smfhome1.smfsambadom>
Date:   Fri May 28 14:59:09 2004 -0500

    Missing spin lock init

commit 3b03e33b58441fe6e863f52b1e7e1f56cd313e0b
Author: Anton Altaparmakov <aia21@cantab.net>
Date:   Fri May 28 18:24:23 2004 +0100

    NTFS: Implement ->write_inode (fs/ntfs/inode.c::ntfs_write_inode()) for the
          ntfs super operations.  This gives us inode writing via the VFS inode
          dirty code paths.  Note:  Access time updates are not implemented yet.
    
    Signed-off-by: Anton Altaparmakov <aia21@cantab.net>

commit d375152732448abe375fc34f9c63c16c103ab8a6
Author: Benjamin Herrenschmidt <benh@kernel.crashing.org>
Date:   Fri May 28 07:25:09 2004 -0700

    [PATCH] radeonfb iBook & IGP fixes
    
    This patch to radeonfb fixes support for the latest iBook models along
    with an initialisation problem on some IGP chipsets. Please apply.
    
    Signed-off-by: Benjamin Herrenschmidt <benh@kernel.crashing.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit 06967a16ec66144dca4ec957abfc3cc1af5a8eb6
Author: Anton Altaparmakov <aia21@cantab.net>
Date:   Fri May 28 14:38:37 2004 +0100

    NTFS: Commit open system inodes at umount time.  This should make it
          virtually impossible for sync_mft_mirror_umount() to ever be needed.
    
    Signed-off-by: Anton Altaparmakov <aia21@cantab.net>

commit c7b57c229985e4aa74e09b391db53d8e6c45a5f5
Author: Anton Altaparmakov <aia21@cantab.net>
Date:   Fri May 28 14:29:35 2004 +0100

    NTFS: Implement writing of mft records (fs/ntfs/mft.[hc]), which includes
          keeping the mft mirror in sync with the mft when mirrored mft records
          are written.  The functions are write_mft_record{,_nolock}().  The
          implementation is quite rudimentary for now with lots of things not
          implemented yet but I am not sure any of them can actually occur so
          I will wait for people to hit each one and only then implement it.
    
    Signed-off-by: Anton Altaparmakov <aia21@cantab.net>

commit 740dfb464b3239b4e400c3e81de76aee1939a359
Merge: 076d341... e743bea...
Author: Anton Altaparmakov <aia21@cantab.net>
Date:   Fri May 28 11:52:07 2004 +0100

    Merge cantab.net:/home/src/bklinux-2.6
    into cantab.net:/home/src/ntfs-2.6

commit 8455ddd1f3c3b580d3b472bbb630f2ec86fa7639
Author: Ben Collins <bcollins@debian.org>
Date:   Fri May 28 06:48:36 2004 -0400

    [sbp2]: Fix use-after-free bug.
    
    Signed-off-by: Luiz Capitulino <lcapitulino@prefeitura.sp.gov.br>
    Signed-off-by: Ben Collins <bcollins@debian.org>

commit 8b24fc91b3ccdab08c4db624040de1a917260a71
Author: Jeff Garzik <jgarzik@redhat.com>
Date:   Fri May 28 05:06:14 2004 -0400

    [netdrvr 8139too] remove bogus config option test
    
    8139too should not be testing CONFIG_EMBEDDED.
    
    Thanks to Christoph Hellwig for pointing this out.

commit 49313fb7982c3959f384ca696a001473a5007595
Merge: d3ba3a7... 4b071fb...
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Fri May 28 01:15:40 2004 -0700

    Merge bk://bk.arm.linux.org.uk/linux-2.6-rmk
    into ppc970.osdl.org:/home/torvalds/v2.6/linux

commit 4b071fb7ad6142fc405ac79b64abd0d9a6cb3c9c
Author: Russell King <rmk@flint.arm.linux.org.uk>
Date:   Fri May 28 17:42:38 2004 +0100

    [ARM] Fix sparse complaint
    
    Sparse found an instance where we were directly dereferencing a
    userspace pointer in the signal handling code.  This change
    fixes that.

commit d3ba3a7db662059e277a33f5e20d862957f11065
Merge: 0abcbad... c89122b...
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Fri May 28 01:13:49 2004 -0700

    Merge bk://kernel.bkbits.net/gregkh/linux/pci-2.6
    into ppc970.osdl.org:/home/torvalds/v2.6/linux

commit c89122b1210220c38f86b45010620e7d60775b80
Merge: e9b73ef... a7b2f24...
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Fri May 28 01:11:27 2004 -0700

    Merge bk://kernel.bkbits.net/gregkh/linux/i2c-2.6
    into ppc970.osdl.org:/home/torvalds/v2.6/linux

commit e9b73ef914ff06f23c37ba85a74b7947a3213717
Merge: 3bf8a19... 075769b...
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Fri May 28 01:10:40 2004 -0700

    Merge bk://kernel.bkbits.net/gregkh/linux/usb-2.6
    into ppc970.osdl.org:/home/torvalds/v2.6/linux

commit 3bf8a19831175bca5ba9cc1bacc711085adf2eec
Merge: 4498e9c... 9e6b95c...
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Fri May 28 00:55:12 2004 -0700

    Merge bk://kernel.bkbits.net/gregkh/linux/driver-2.6
    into ppc970.osdl.org:/home/torvalds/v2.6/linux

commit 4498e9cfb8c8779a4b65c533858bcba9abe0532e
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Fri May 28 00:35:14 2004 -0700

    Revert 3c905C initialization changes that cause problems
    
    Cset exclude: akpm@osdl.org[torvalds]|ChangeSet|20040510205830|02933

commit 39941ffaeb6869d61d3dfe671ceccd64fad95bfd
Author: Wim Van Sebroeck <wim@iguana.be>
Date:   Sat May 29 02:18:49 2004 +0200

    [WATCHDOG] v2.6.6 linux/fs.h-patch
    
    From: Christoph Hellwig <hch@lst.de>
    
    All watchdog drivers need linux/fs.h

commit f70c90bf63b5959bcf3078f6a141aca4554a77fd
Author: Sean Young <sean@mess.org>
Date:   Sat May 29 01:59:46 2004 +0200

    [WATCHDOG] v2.6.6 sc520_wdt.c-patch2
    
    This patch also removes the cbar usage which is unnecessary. The MMCR is
    always available at 0xfffef000; there is no need to use the cbar register
    (if mmcr aliasing is enabled, then the MMCR is _also_ available at
    another address set by CBAR).

commit baae0d6b045b117f3d77a2aec5a582eed4916358
Author: Wim Van Sebroeck <wim@iguana.be>
Date:   Sat May 29 01:46:05 2004 +0200

    [WATCHDOG] v2.6.6 sc520_wdt.c-patch1
    
    Clean-up (general stuff: comments, keep module parameters together, ...)
    Added clear definitions for the Watchdog Timer Control Register bits
    Made start, stop and keepalive return 0 if successful
    Fixed nowayout behaviour so that it is consistent with other watchdog drivers
    Fixed release behaviour so that it is consistent with other watchdog drivers
    Added wdt_set_heartbeat function to set the timeout/heartbeat of the watchdog
    Made sure that memory remapping (wdtmrctl) is done before misc_register is started
    MMCR_BASE_DEFAULT was wrong (Bug 2497 reported by Sean Young)
    
    Tested by Sean Young

commit 630fb05eae3975050f5c9508c7213220a45eca67
Author: Wim Van Sebroeck <wim@iguana.be>
Date:   Sat May 29 01:38:43 2004 +0200

    [WATCHDOG] v2.6.6 w83627hf_wdt.c
    
    When drivers starts show the correct watchdog driver info.

commit a7b2f24ac5aea16575a9445375cf7e3f2ec2edf8
Merge: e743bea... 0bfc2c9...
Author: Greg Kroah-Hartman <greg@kroah.com>
Date:   Fri May 28 00:17:05 2004 -0700

    Merge kroah.com:/home/greg/linux/BK/bleed-2.6
    into kroah.com:/home/greg/linux/BK/i2c-2.6

commit 075769bc580040a946804e9c8d1002fa5c300413
Merge: e743bea... 283eb06...
Author: Greg Kroah-Hartman <greg@kroah.com>
Date:   Fri May 28 00:08:27 2004 -0700

    Merge kroah.com:/home/greg/linux/BK/bleed-2.6
    into kroah.com:/home/greg/linux/BK/usb-2.6

commit 7fb199e81aed15244ec2040f204995e42e51177f
Author: Ben Collins <bcollins@debian.org>
Date:   Fri May 28 03:07:17 2004 -0400

    [ieee1394]: Remove unused variable.
    
    Signed-off-by: Ben Collins <bcollins@debian.org>

commit 0bfc2c92a9fb9c5ef6f3293cff7bf905caa56f73
Author: Alexey Fisher <fishor@gmx.net>
Date:   Thu May 27 23:48:49 2004 -0700

    [PATCH] I2C: add max1619 driver
    
    This is a driver for "Remote/Local Temperature Sensor with Dual-Alarm Outputs
    and SMBus Serial Interface" MAX1619. I found this chip an my Laptop SAMSUNG
    NV5000. Daryng I use Linux cooling didn't worked at all, naw  with this
    driwer it's working. I hope  this will be usefool for ather too.
    
    I didn't hade any expiriens with programming, but i didn't wont to wait wann
    some body make it vor me. Jean halped me correrct any mysteiks wich i made.
    Thanks Jaen :)
    
    Signed-off-by: Greg Kroah-Hartman <greg@kroah.com>

commit 0c2bdd29cacca40a4f605ee469cd26de9f3bde00
Author: Jean Delvare <khali@linux-fr.org>
Date:   Thu May 27 23:47:51 2004 -0700

    [PATCH] I2C: i2c-parport: support the ADM1031 evaluation board
    
    The following patch adds support for the ADM1030 and ADM1031 evaluation
    boards to the i2c-parport and i2c-parport-light drivers. They are almost
    compatible with the already supported ADM1025 and ADM1032 boards, except
    that the ADM1032 board needs some pins to be set high to draw its power,
    while the same pins power up heating resistors on the ADM1031 board. I
    considered it was a bit dangerous to do that by default, so I ended up
    with two different device definitions, one with powering pins set, and
    one with these pins cleared.
    
    Signed-off-by: Greg Kroah-Hartman <greg@kroah.com>

commit 2e59e6aab4c19b25ef4f9e1ffbe5621a2ebe02c8
Merge: 5e681ee... ea123a2...
Author: Ben Collins <bcollins@debian.org>
Date:   Fri May 28 02:46:38 2004 -0400

    Merge

commit 0abcbaddc58a3bf9bfa71a5afb93fcbd47954313
Author: Luiz Capitulino <lcapitulino@prefeitura.sp.gov.br>
Date:   Thu May 27 23:37:08 2004 -0700

    [PATCH] PCI: fix pci/probe.c possible NULL pointer.
    
     In drivers/pci/probe.c::pci_scan_bridge() the call for pci_alloc_child_bus()
    can return NULL, but it is not handled by the function (detected by
    Coverity's checker).
    
     The patch bellow fix that returning `max' if we got the NULL, but
    I do not know if it is right. I guess it is, because in that case
    the function will act in the same way as with `pass != 0'.
    
    Signed-off by: Luiz Capitulino <lcapitulino@prefeitura.sp.gov.br>
    Signed-off-by: Greg Kroah-Hartman <greg@kroah.com>

commit e4bbb861d2c89e8b465836402c9b1beb93462888
Author: Todd Rimmer <trimmer@infiniconsys.com>
Date:   Thu May 27 23:36:07 2004 -0700

    [PATCH] PCI: Add InfiniCon PCI ID to pci_ids.h
    
    We would like to have the InfiniCon PCI Vendor ID added to pci_ids.h
    Below is a context diff, which would would greatly appreciate if you
    applied and included in future kernel releases.
    
    Signed-off-by: Greg Kroah-Hartman <greg@kroah.com>

commit ea123a24d3414719bff7e646d04195cdf55e0c39
Author: Ben Collins <bcollins@debian.org>
Date:   Fri May 28 02:33:35 2004 -0400

    [ieee1394]: Fix some possible deadlock conditions.
    
    Submitted-by: Paul Mackerras <paulus@samba.org>
    Signed-off-by: Ben Collins <bcollins@debian.org>

commit 283eb0630681c3f2dd19cc8c1c01b53887045a11
Author: Ian Abbott <abbotti@mev.co.uk>
Date:   Thu May 27 23:28:41 2004 -0700

    [PATCH] USB: ftdi_sio throttling fix
    
    This patch fixes throttling problems in the ftdi_sio driver for the
    2.6 kernel.  The old throttling mechanism (unlinking the read urb)
    often failed to work, and even it did work, would lose any data
    held in the transfer buffer.  The new mechanism presented here is
    based on what the whitehead driver does (defer processing and
    resubmitting of the read urb until unthrottled).
    
    Signed-off-by: Ian Abbott <abbotti@mev.co.uk>
    Signed-off-by: Greg Kroah-Hartman <greg@kroah.com>

commit ae0c1536a7691a5341847fa00c5910b4467f9aaa
Author: Alan Stern <stern@rowland.harvard.edu>
Date:   Thu May 27 23:28:14 2004 -0700

    [PATCH] USB: Use normal return codes for several routines in hub.c
    
    This patch changes the return codes used by hub_port_wait_reset(),
    hub_port_reset(), and hub_port_debounce() in hub.c.  I couldn't stand the
    {-1=error, 0=okay, 1=disconnect} scheme; the meanings seemed arbitrary and
    I constantly forgot which number stood for what status.  The revised code
    uses normal negative error codes, including -ENOTCONN to indicate device
    disconnected, or 0 for success.
    
    Signed-off-by: Greg Kroah-Hartman <greg@kroah.com>

commit 9cd5f336de8e07adc27be91288a429a2832e481b
Author: Ben Collins <bcollins@debian.org>
Date:   Fri May 28 02:26:44 2004 -0400

    [ieee1394]: Cleanup failure handling in ieee1394 and nodemgr.
    
    Submitted-by: Walter Harms <WHarms@bfs.de>
    Submitted-by: Randy.Dunlap <rddunlap@osdl.org>
    Signed-off-by: Ben Collins <bcollins@debian.org>

commit eedf267e9dc220cdd301e5e07676d9013c19fdb1
Author: Ben Collins <bcollins@debian.org>
Date:   Fri May 28 02:24:43 2004 -0400

    [ieee1394]: Delete host timer to avoid crashes in certain conditions.
    
    Submitted-by: Alexandre Oliva <oliva@lsd.ic.unicamp.br>
    Submitted-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: Ben Collins <bcollins@debian.org>

commit 8c04bcdfd4af38c3ddaf210adc36eca8a0b3d9a3
Author: Ben Collins <bcollins@debian.org>
Date:   Fri May 28 02:22:45 2004 -0400

    [ieee1394]: Fix problem with extended ROM regions.
    
    Submitted-by: Steve Kinneberg <kberg@linux1394.org>
    Signed-off-by: Ben Collins <bcollins@debian.org>

commit 0cf472bc54a3ad1c2b7bfead7f01a30f2ae0e784
Author: Ben Collins <bcollins@debian.org>
Date:   Fri May 28 02:18:54 2004 -0400

    [ieee1394]: Kill duplicate atomic.h inclusion.
    
    Submitted-by: Arthur Othieno
    Signed-off-by: Ben Collins <bcollins@debian.org>

commit d3adde04de87bc8d4689d6135ad05310edb1bdd4
Author: Ben Collins <bcollins@debian.org>
Date:   Fri May 28 02:16:45 2004 -0400

    [IEEE1394]: Fix for deadlock condition.
    
    Submitted-by: Jim Radford
    Signed-off-by: Ben Collins <bcollins@debian.org>

commit 9e6b95c3111a427c3991fca727945c4cbcd9b8d4
Author: Todd Poynor <tpoynor@mvista.com>
Date:   Thu May 27 23:13:30 2004 -0700

    [PATCH] Fix for leave-runtime-suspended-devices-off-at-system-resume.patch
    
    A patch to fix my previous
    leave-runtime-suspended-devices-off-at-system-resume patch; the new
    changes save a copy of power.power_state in order to know whether to
    resume a device, independently of mods to that field by a driver suspend
    routine.  This fixes 2.6.7-rc1-mm1 in the same fashion as the updated
    2.6.6 patch sent previously.
    
    Signed-off-by: Greg Kroah-Hartman <greg@kroah.com>

commit 5bb8ea44561b68f63ca01a24dce5e7506d158d32
Merge: e743bea... 3eb68d2...
Author: Greg Kroah-Hartman <greg@kroah.com>
Date:   Thu May 27 22:57:58 2004 -0700

    Merge kroah.com:/home/greg/linux/BK/bleed-2.6
    into kroah.com:/home/greg/linux/BK/driver-2.6

commit f7eb18a7b6b0ccf8b2688d20c72b0110f96d4086
Author: David S. Miller <davem@nuts.davemloft.net>
Date:   Thu May 27 20:33:32 2004 -0700

    [AIRO]: Fix build error.

commit 3eb68d243b32d27362d63fe9a0ce4c1a03a73f7c
Author: Greg Kroah-Hartman <greg@kroah.com>
Date:   Thu May 27 20:31:37 2004 -0700

    Minor coding style fixups in resume code and added a bit of debugging help.
    
    Signed-off-by: Greg Kroah-Hartman <greg@kroah.com>

commit 6e0585680425670be89090568e4864dcbf451a87
Merge: e743bea... db09cd9...
Author: Greg Kroah-Hartman <greg@kroah.com>
Date:   Thu May 27 20:20:42 2004 -0700

    Merge kroah.com:/home/greg/linux/BK/bleed-2.6
    into kroah.com:/home/greg/linux/BK/pci-2.6

commit 5ca5b409b65c243c912621a2aa3264aa07370724
Author: Greg Kroah-Hartman <greg@kroah.com>
Date:   Thu May 27 20:05:31 2004 -0700

    [PATCH] Report which device failed to suspend
    
    Based on a patch from Nickolai Zeldovich <kolya@MIT.EDU> but put into the
    proper place by me.
    
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: Greg Kroah-Hartman <greg@kroah.com>

commit b8ff3f6bdbb479619209c20b1c9c0d0d175d0bf6
Author: Todd Poynor <tpoynor@mvista.com>
Date:   Thu May 27 20:04:44 2004 -0700

    [PATCH] Leave runtime suspended devices off at system resume
    
    Currently all devices are resumed at system resume time, including any
    that were individually powered off ("at runtime") prior to the system
    suspend.  In certain cases it can be nice to force back on individually
    suspended devices, such as the display, but hopefully this policy can be
    left up to userspace power managers; the kernel should probably honor
    the settings previously made by userspace/drivers.  This seems
    preferable to requiring a power-conscious system to re-suspend devices
    after a system resume; furthermore, for certain platforms (such as
    XScale PXA27X) there can be disastrous consequences of powering up
    devices when the system is in a state incompatible with operation of the
    device.
    
    Suggested patch does this:
    
    (1) At system resume, checks power_state to see if the device was
    suspended prior to system suspend, and skips powering on the device if
    so.
    
    (2) Does not re-suspend an already-suspended device at system suspend
    (using a different method than is currently employed, which reorders the
    list, see #3).
    
    (3) Preserves the active/off device list order despite the above changes
    to suspend/resume behavior, to avoid dependency problems that tend to
    occur when the list is reordered.
    
    Signed-off-by: Greg Kroah-Hartman <greg@kroah.com>

commit 98e1a74e3f5033aea114e6facd95cc31c69acee7
Author: Todd Poynor <tpoynor@mvista.com>
Date:   Thu May 27 20:04:18 2004 -0700

    [PATCH] Device runtime suspend/resume fixes
    
    (1) Set device power state at runtime resume (as is done for runtime
    suspend) so that a later suspend does not think the device is still
    suspended (refusing to suspend it again).
    
    (2) Move devices from the active list to the off list only when
    suspending all devices as part of a system suspend, not for runtime
    suspend.  This matches the resume code, which only moves devices from
    off to active during system resume, such that runtime resume currently
    doesn't move the suspended device back to the active list.  (This also
    avoids reordering the device list for runtime suspends; the list is in
    order of registration and suspend/resume works best that way -- granted,
    more sweeping improvements in how device dependencies are accounted for
    in the suspend/resume order are also needed someday.)
    
    Runtime device suspend/resume is in some cases used frequently on
    battery-powered embedded devices, to save additional power and to handle
    device power state interactions with overall system power state on
    certain platforms.
    
    Signed-off-by: Greg Kroah-Hartman <greg@kroah.com>

commit 1828dda11667ee1d7dcf67270496587542597a37
Merge: e743bea... c5dc749...
Author: David S. Miller <davem@nuts.davemloft.net>
Date:   Thu May 27 19:51:20 2004 -0700

    Merge nuts.davemloft.net:/disk1/BK/network-2.6
    into nuts.davemloft.net:/disk1/BK/net-2.6

commit c5dc74915fb541ad17081eb86ce4b1cd2268943e
Author: David S. Miller <davem@nuts.davemloft.net>
Date:   Thu May 27 19:48:19 2004 -0700

    [TCP]: Grow socket receive buffer based upon estimated sender window.

commit e743bea22dc98c9a63fe625fc82d262f32ecc97d
Merge: b803889... 4423afa...
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Thu May 27 10:45:40 2004 -0700

    Merge http://xfs.org:8090/xfs-linux-2.6
    into ppc970.osdl.org:/home/torvalds/v2.6/linux

commit 4423afa0f5bd40822420541dae3fac2eb0e66cf4
Merge: 3d61e38... 4981d87...
Author: Nathan Scott <nathans@sgi.com>
Date:   Sat May 29 08:02:07 2004 +1000

    Merge sgi.com:/source2/linux-2.6 into sgi.com:/source2/xfs-linux-2.6

commit 4981d871a8e70f718054a5b04e1be5af126ef765
Author: Christoph Hellwig <hch@sgi.com>
Date:   Sat May 29 07:45:30 2004 +1000

    [XFS] Don't leak locked pages on readahead failure
    
    SGI Modid: xfs-linux:xfs-kern:172618a

commit 6fc73da07091843369143d561cc5618a4a8e42af
Author: Eric Sandeen <sandeen@sgi.com>
Date:   Sat May 29 07:41:54 2004 +1000

    [XFS] Fix overflow in mapping test at offsets of 2^63-1 bytes
    
    SGI Modid: xfs-linux:xfs-kern:172649a

commit 4d078eba6307f17672561d00b8b6033bc270e745
Author: Steve French <stevef@smfhome1.smfsambadom>
Date:   Thu May 27 12:38:22 2004 -0500

    fix rc mapping on out of memory on mid alloc failure and cleanup dead code

commit b80388950303fe7711554614bd94b6231e937653
Author: David Mosberger <davidm@napali.hpl.hp.com>
Date:   Thu May 27 10:38:21 2004 -0700

    [PATCH] ia64: use new ptep_set_access_flags
    
    ia64: Implement race-free ptep_set_access_flags()
    
    Signed-off-by: davidm@hpl.hp.com
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit 69066ddac818f60a570bb1645861159fbba88acf
Author: Benjamin Herrenschmidt <benh@kernel.crashing.org>
Date:   Thu May 27 10:38:10 2004 -0700

    [PATCH] ppc32: Fix typo in USB sleep code on intrepid based laptops
    
    This fixes a typo in the low level platform code that puts to sleep and
    wakes up the USB cell.  This fixes a problem when pmdisk is used on
    those machines (pmdisk patch not merged yet, soon maybe...)
    
    From: Guido Guenther <agx@sigxcpu.org>
    Signed-off-by: Benjamin Herrenschmidt <benh@kernel.crashing.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit 0e760e3aa7a84b8d1091326137e80c2e9def5fe4
Merge: 81612fc... d913e61...
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Thu May 27 10:35:22 2004 -0700

    Merge bk://gkernel.bkbits.net/net-drivers-2.6
    into ppc970.osdl.org:/home/torvalds/v2.6/linux

commit 7713cd040972106234b5f110c4d20009efbe5711
Author: Steve French <stevef@smfhome1.smfsambadom>
Date:   Thu May 27 11:18:53 2004 -0500

    add additional cifs stats

commit b9c78a05068847c36f0e41b4aaae2fd1f5df44d6
Author: Dave Jones <davej@redhat.com>
Date:   Thu May 27 16:28:39 2004 +0100

    [AGPGART] SIS AGP updates
    
    Signed-off-by: Dave Jones <davej@redhat.com>
    
    From: "Heilmann, Oliver" <Oliver.Heilmann@drkw.com>
    
    * renamed sis_648_enable to sis_delayed_enable and removed chipset
      references
    
    * All chipsets that require the sis delay-hack are listed in
      sis_broken_chipsets (and no other place).
    
    * There are two new module options to force agp3-spec compliant
      initialisation and/or the delay hack.  As I only have a 648FX chipset to
      test on, I figured this might be useful to experiment with on other
      chipsets (i.e.746[FX]).
    
    Basically, if you have an  SiS chipset and your machine freezes when you
    start X, try the -agp_sis_force_delay=1 option. If this fixes your
    problem add your PCI ID to sis_broken_chipsets in sis-agp.c
    Note to 746[FX] people: I'm still not sure what the differences between
    the two 746 versions and the 648 series are. If this patch does not work
    for you try playing with the agp_sis_agp_spec module option. Any
    feedback is greatly appreciated.

commit ba918ede7ffdf50e687afc6b7d9b1cca0c5ac31d
Author: Jeff Garzik <jgarzik@redhat.com>
Date:   Thu May 27 08:59:31 2004 -0400

    [netdrvr e1000] use generic ethtool_ops provided in net/core/ethtool.c

commit d913e61d365025a2ef129a7deff50fbf5d47fe20
Author: Jeff Garzik <jgarzik@redhat.com>
Date:   Thu May 27 08:42:46 2004 -0400

    [netdrvr] Add 'gigabit ethernet' config option

commit 338519f3428ccb180ada7af241dd87c59c07a64f
Author: Dave Jones <davej@redhat.com>
Date:   Thu May 27 13:30:39 2004 +0100

    [CPUFREQ] Make powernow-k7 module parameter not need powernow prefix.
    From: Bruno Ducrot
    
    because powernow_k7.powernow_acpi_force=1 looks silly.

commit 3c7fd9ca851da8057f37bf6854beef2ce8aa05d6
Author: Jeff Garzik <jgarzik@redhat.com>
Date:   Thu May 27 08:22:20 2004 -0400

    [netdrvr ixgb] massive update
    
    Since Intel agreed to submit further updates via broken-up patches
    like they do currently (and admirably) for e1000 and e100, I agreed
    to merge this update to bring the driver up to speed.
    
    Contributed by: Ayyappan.Veeraiyan@intel.com
    
    Changes:
    
    Features implemented
    
    *	Support for new 850nm adapters.
    *	Copyright notice updated to include year 2004.
    *	Fix for "ixgb does not maintain non-default MTU setting across a
    link loss" issue - When link loss happens in non-default MTU
    environment, driver will incorrectly operate with default 1500 MTU
    setting.
    *	Netpoll support added
    *	Ethtool support - status functionality, FlowControl interface,
    Checksum interface, TSO and Scatter Gather interfaces
    *	Race condition fix - Race condition (TX path) exists between
    ixgb_xmit_frame and clean_tx_irq routines in handling the queue.
    * 	Removed dead code segments (#if 0)
    
    
    Performance improvement features
    *	Mod operator usage is removed - used to cause performance
    problems in non-IA architecture based machines
    *	Multiple ICR register read in ISR is avoided
    *	RS bit set on only 'end of packet' TX descriptors - to avoid
    multiple writebacks by controller for packets with multiple descriptors.
    *	RX descriptors prefetch is done - improved 1500 MTU TX
    performance
    
    
    All relevant e1000 driver cleanups ported to ixgb
    *	Valid error propagation in functions ixgb_up, ixgb_probe,
    ixgb_open.
    * 	NAPI code cleanups
    * 	u8, u16 and u32 data types are changed to uint8_t, uint16_t and
    uint32_t respectively. We use these types on our shared code for
    multiple OSes and also to make it uniform with e1000 driver.
    *	Some functions in ixgb_main.c are moved to different location -
    This enables easy porting of e1000 bug fixes to ixgb

commit 207ebf51ab6422c8a68e19ba15add7aa6bc9c330
Merge: 159ea78... 336cb45...
Author: Jeff Garzik <jgarzik@redhat.com>
Date:   Thu May 27 08:05:32 2004 -0400

    Merge redhat.com:/spare/repo/netdev-2.6/via-rhine
    into redhat.com:/spare/repo/net-drivers-2.6

commit 159ea78e39b727263383dd0387c1653d446a96af
Merge: 64de62b... 018713f...
Author: Jeff Garzik <jgarzik@redhat.com>
Date:   Thu May 27 08:04:23 2004 -0400

    Merge redhat.com:/spare/repo/netdev-2.6/sis900
    into redhat.com:/spare/repo/net-drivers-2.6

commit 64de62b43acafc6cb46a08f98388b55874246e95
Merge: ee86da9... 3c08665...
Author: Jeff Garzik <jgarzik@redhat.com>
Date:   Thu May 27 08:03:05 2004 -0400

    Merge redhat.com:/spare/repo/netdev-2.6/pcnet32
    into redhat.com:/spare/repo/net-drivers-2.6

commit ee86da9d6b5ec86c8a2b626f555ef43e3e272944
Merge: a0e8d71... 8a6d6a4...
Author: Jeff Garzik <jgarzik@redhat.com>
Date:   Thu May 27 08:01:48 2004 -0400

    Merge redhat.com:/spare/repo/netdev-2.6/misc
    into redhat.com:/spare/repo/net-drivers-2.6

commit 8a6d6a461d194f19194aee510c7faa1f0611aee2
Merge: 371969b... b5a07f0...
Author: Jeff Garzik <jgarzik@redhat.com>
Date:   Thu May 27 08:00:32 2004 -0400

    Merge redhat.com:/spare/repo/netdev-2.6/farsync
    into redhat.com:/spare/repo/net-drivers-2.6

commit 371969b33214f83d9f62928b2384bf02f391f0c7
Merge: 7991c12... 58de38a...
Author: Jeff Garzik <jgarzik@redhat.com>
Date:   Thu May 27 07:59:32 2004 -0400

    Merge redhat.com:/spare/repo/netdev-2.6/emac
    into redhat.com:/spare/repo/net-drivers-2.6

commit 7991c128119187963e10be7ad2f53d52e4994c38
Merge: b54885f... a1360dd...
Author: Jeff Garzik <jgarzik@redhat.com>
Date:   Thu May 27 07:58:11 2004 -0400

    Merge redhat.com:/spare/repo/netdev-2.6/e1000
    into redhat.com:/spare/repo/net-drivers-2.6

commit b54885f95490a197cb3dc4183e87231c4fb9c186
Merge: 393ce84... 1906bc6...
Author: Jeff Garzik <jgarzik@redhat.com>
Date:   Thu May 27 07:57:09 2004 -0400

    Merge redhat.com:/spare/repo/netdev-2.6/acenic
    into redhat.com:/spare/repo/net-drivers-2.6

commit a0e8d714cd6bc6d8136944d5337ad76e14a24983
Author: Andrew Morton <akpm@osdl.org>
Date:   Thu May 27 07:33:27 2004 -0400

    [PATCH] net/sk98lin: correct buggy VPD in ASUS MB
    
    From: Jeff Lightfoot <jeffml@pobox.com>
    
    The following patch to net/sk98lin/skvpd.c was put together by Marc Bouget,
    mbouget at club-internet.fr.
    
    This patch works around a corrupt EEPROM (VPD?) in the ASUS K8V Deluxe SE
    motherboard ethernet chipset and allows the network driver to work
    correctly.  We have written to ASUS and the sk98lin maintainers but have
    not heard anything back.

commit c5e61695031cebec7ec4e4e05464666067819926
Author: Christoph Hellwig <hch@lst.de>
Date:   Thu May 27 07:15:11 2004 -0400

    sb1000 and wan/sealevel net drivers need to include linux/init.h.

commit 58de38a8f07a54716c101c1bf7227162f0499f17
Author: Matt Porter <mporter@kernel.crashing.org>
Date:   Thu May 27 07:12:36 2004 -0400

    Add new IBM PPC4xx EMAC net driver.

commit 336cb45340f419644c77f9a7de57d6927799acdc
Author: Roger Luethi <rl@hellgate.ch>
Date:   Thu May 27 07:08:08 2004 -0400

    [PATCH] via-rhine: netdev_priv()
    
    Found another patch that should go with this batch:
    
    Switch to netdev_priv(). Fix outdated comment and bump version number
    while we're at it.

commit 5713113c89f22443fdaedf9cb165a970dda5bc85
Author: Roger Luethi <rl@hellgate.ch>
Date:   Thu May 27 07:07:59 2004 -0400

    [PATCH] via-rhine: USE_MEM, USE_IO -> USE_MMIO
    
    Replace USE_MEM and USE_IO with USE_MMIO define.

commit a9227ffd3a0488d53f986b97931fdcbf09e4777c
Author: Roger Luethi <rl@hellgate.ch>
Date:   Thu May 27 07:07:51 2004 -0400

    [PATCH] via-rhine: Whitespace clean-up
    
    - Switch to 8 char tabs.
    - Remove kernel log pointer to the scyld web site -- it's
      a) fairly irrelevant by now and
      b) gone.
    - Remove Emacs Voodoo.
    - More white space clean up, mostly coding style.

commit 1dbdd99da8d0a690014ca5cad7e001a134e927d3
Author: Roger Luethi <rl@hellgate.ch>
Date:   Thu May 27 07:07:42 2004 -0400

    [PATCH] via-rhine: Rename some symbols
    
    This patch renames symbols:
    via_rhine_* -> rhine_*
    struct netdev_private *np -> struct rhine_private *rp

commit d9830352f0550c24a9e90d623534ad5518309c42
Author: Roger Luethi <rl@hellgate.ch>
Date:   Thu May 27 07:07:33 2004 -0400

    [PATCH] via-rhine: Fix force media
    
    Lucas Nussbaum and Dirk Koeppen each found independently that the code
    for forcing media options in via-rhine is borked and suggested the fix
    below. I've been sitting on this way too long because there is more
    badness in the immediate vicinity which needs a bigger surgery.
    
    The second hunk fixes a braino I managed to introduce myself.

commit 076d341a68c9dce4a959d1920639e7fc20c9ca4b
Merge: 39d3ed4... 30eced5...
Author: Anton Altaparmakov <aia21@cantab.net>
Date:   Thu May 27 11:40:23 2004 +0100

    Merge cantab.net:/home/src/bklinux-2.6
    into cantab.net:/home/src/ntfs-2.6

commit 3c08665c2cf6c7ef11ba0000493185665acb8e45
Author: Don Fry <brazilnut@us.ibm.com>
Date:   Thu May 27 06:07:05 2004 -0400

    [PATCH] pcnet32: fix for patch 8 le16_to_cpu
    
    Joe Perches pointed out an error in patch 8.  As I looked at the results
    closer 3 out of 4 looked correct.  This fixes the output for the last
    case.  Output is now the same on IA32 and PPC64 hardware.

commit 7a4904da2948e888cf2f78055114748c7d3330c7
Author: Per Olofsson <pelle@dsv.su.se>
Date:   Thu May 27 06:05:00 2004 -0400

    [netdrvr tulip] new pci id

commit bba55a269a02f0a2bb33a37dc4ff578d25b4fcc5
Author: Stefan Rompf <srompf@isg.de>
Date:   Thu May 27 05:51:22 2004 -0400

    [netdrvr b44] always restore PCI config on resume
    
    the Broadcom BCM4401 driver restores pci configuration on resume only when the
    device is up. On my notebook, this leads to a failure when the device is down
    during the S3 cycle. Short solution for now: Always restore pci config.

commit cb104629ced8a881c69ba3297c08781c16c61705
Author: Steve French <stevef@smfhome1.smfsambadom>
Date:   Thu May 27 04:47:26 2004 -0500

    Add support for cifs per-share statistics, and add corresponding make menuconfig option for cifs statistics

commit a1360dde097250fa395594f0801865d83895916f
Author: Ganesh Venkatesan <ganesh.venkatesan@intel.com>
Date:   Thu May 27 05:44:06 2004 -0400

    [PATCH] e1000 7/7: Support for ethtool msglevel based error
    
    Also included are driver version update and change logs

commit 7190c16a96fb72ceef8a54ceec98ef55ec9057d3
Author: Ganesh Venkatesan <ganesh.venkatesan@intel.com>
Date:   Thu May 27 05:43:57 2004 -0400

    [PATCH] e1000 6/7: ethtool_ops support

commit 8e10115543e8252375208f9a9d8aca537a224722
Author: Ganesh Venkatesan <ganesh.venkatesan@intel.com>
Date:   Thu May 27 05:43:49 2004 -0400

    [PATCH] e1000 4/7: Estimate number of tx descriptors required
    
    Reduce scope of tx_lock

commit 668c0cdbe60272cdda73187456bb825302c4913c
Author: Ganesh Venkatesan <ganesh.venkatesan@intel.com>
Date:   Thu May 27 05:43:40 2004 -0400

    [PATCH] e1000 3/7: Determine link status correctly while using

commit b3a0f5019a6138119891f227dd3c6d24aaf8f55f
Author: Ganesh Venkatesan <ganesh.venkatesan@intel.com>
Date:   Thu May 27 05:43:32 2004 -0400

    [PATCH] e1000 2/7: Workaround for link LED staying ON even when

commit a5f4b1a7a8b2982c86d93726806d6607c8de0bf7
Author: Ganesh Venkatesan <ganesh.venkatesan@intel.com>
Date:   Thu May 27 05:43:24 2004 -0400

    [PATCH] e1000 1/7: Clear Auto-MDIX when the link is forced to

commit 4feb216cf81dbef7742f8285be975b64fe1403eb
Author: Javier Achirica <achirica@telefonica.net>
Date:   Thu May 27 05:33:57 2004 -0400

    [wireless airo] Add RFMON support for MPI and latest Cisco

commit b5a07f07135bab043f98c1cb13ce7901383b5732
Author: Kevin Curtis <kevin.curtis@farsite.co.uk>
Date:   Thu May 27 05:24:17 2004 -0400

    [netdrvr wan] farsync driver update
    
    1) Provides support for new FarSync cards T1U, T2U, T4U and TE1
    2) Provides support for an E1 interface
    3) Provides support for a variant of X.21 that allows transmit and
    receive clocks
    4) Provide a raw socket interface directly to the data from the line.
    5) Improves performance with less time in interrupts and more in BH's

commit d99e292eb07a5780ee8c053896c5d3ba4d14b37f
Author: Don Fry <brazilnut@us.ibm.com>
Date:   Thu May 27 05:12:31 2004 -0400

    [PATCH] pcnet32: avoid timeout with tcpdump
    
    This patch avoids a timeout when entering/exiting promiscuous mode with
    tcpdump.  All pending xmit operations are flushed and if the queue is
    full the timeout will occur.  The wake_queue avoids that timeout.
    Tested ppc64 and ia32.

commit 765c4495f5eb62a0ceffec798b2ead8b6f2d3ebc
Author: Don Fry <brazilnut@us.ibm.com>
Date:   Thu May 27 05:12:23 2004 -0400

    [PATCH] pcnet32: correct printk for big-endian arch
    
    This patch corrects a printk when executed on a big-endian system.  Tested
    ppc64.

commit a8807fa847d1b3414b863ae047ff542e5e6971f1
Author: Don Fry <brazilnut@us.ibm.com>
Date:   Thu May 27 05:12:15 2004 -0400

    [PATCH] pcnet32: fix bogus carrier errors with 79c973
    
    The 79C973 version of the pcnet32 chipset would report all transmit
    operations as being sent with a carrier error.  The root cause was
    writing reserved bits in bcr33.  It caused the 973 to report xmit
    as errors, and caused 975 and 976 to hard hang when reading bcr34.
    
    My thanks to Bruce Penrod for his help in finding the cause of this
    bug.

commit 3385606e378caf6af63f1435e2c60c6a6932a333
Author: Don Fry <brazilnut@us.ibm.com>
Date:   Thu May 27 05:12:06 2004 -0400

    [PATCH] pcnet32: limit frames received during interrupt.
    
    The current code will allow an infinite number of frames to be received
    during one interrupt.  Tested ia32 and ppc64.

commit 5d3c8230eca83afdf49e2c752e395fd650eb28e0
Author: Don Fry <brazilnut@us.ibm.com>
Date:   Thu May 27 05:04:02 2004 -0400

    [PATCH] pcnet32: remove timer and complexity.
    
    This removes the timer I recently added, and the 'ltint' interrupt
    mitigation from the 79C971 and 79C972. It did not improve performance,
    added complexity, and was a bad idea in hind sight.

commit e932fecfa2a696553e9a27dbf1c367e2697ea8b9
Author: Don Fry <brazilnut@us.ibm.com>
Date:   Thu May 27 05:03:48 2004 -0400

    [PATCH] pcnet32: fix boundary comparison bug.
    
    This patch fixes a boundary condition.  It is possible to get an
    interrupt and have the transmit queue completely full.  Without this
    the driver will leak skb's and pci maps (if the arch supports them).

commit 1ac6576887dcc1f88a0a1a9a696f0473b5d91718
Author: Don Fry <brazilnut@us.ibm.com>
Date:   Thu May 27 05:03:35 2004 -0400

    [PATCH] pcnet32: correct 79C976 variant string.
    
    This patch correctly identifies the 79C976 as a PCnet/PRO not a FAST III.

commit ea8cba88d41a28b41a77dfb9ee6b5ad2afdc7f40
Author: Don Fry <brazilnut@us.ibm.com>
Date:   Thu May 27 05:03:22 2004 -0400

    [PATCH] pcnet32: avoid hard hang with some chip variants.
    
    This patch fixes a hard hang with 79C975 and 79C976 chip variants when
    dumping BCR register #34.

commit 741948bcfa9c2a26eb7862c80274ae75e57259af
Author: Don Fry <brazilnut@us.ibm.com>
Date:   Thu May 27 05:03:08 2004 -0400

    [PATCH] pcnet32: add static to two routines.
    
    This patch adds 'static' to two routines.  The prototype has static but
    the instantiation did not.

commit 03838aec4bd555a99258e7bbe723806534c139a1
Author: Rusty Russell <rusty@rustcorp.com.au>
Date:   Thu May 27 04:54:22 2004 -0400

    [PATCH] Fix incorrect but unused define in net_sk_mca.h
    
     From:  Jean Delvare <khali@linux-fr.org>

commit 88ea64c3e3f20d34ad371a192df007734785b814
Author: Rusty Russell <rusty@rustcorp.com.au>
Date:   Thu May 27 04:54:08 2004 -0400

    [PATCH] Update Alfred Arnold contact info
    
     From:  Jean Delvare <khali@linux-fr.org>

commit 393ce840cf979b04fb03dd71df196381839b410b
Author: Paul Mundt <lethal@linux-sh.org>
Date:   Thu May 27 04:53:44 2004 -0400

    [PATCH] Fix 8139too ring size for dreamcast/embedded
    
    Presently 2.6.6 backs out the CONFIG_8139_RXBUF_IDX in favor of using a
    hardcoded 8139_RXBUF_IDX (again). This seems to have been done due to
    some issues occuring with 8139_RXBUF_IDX =3D=3D 3, however (as the Kconfig
    pointed out), we still need 8139_RXBUF_IDX =3D=3D 1 in the CONFIG_SH_DREAMC=
    AST
    case.
    
    The patch which made this change can be seen at:
    
    {MIME-mangled URL}
    
    Before that, CONFIG_8139_RXBUF_IDX was set to 1 both in the
    CONFIG_SH_DREAMCAST and CONFIG_EMBEDDED cases. This patch adds that
    back into the current 8139too.

commit f7c9e1e0ef4b517ea861ab8984f59339acc5a081
Author: Luiz Capitulino <lcapitulino@prefeitura.sp.gov.br>
Date:   Thu May 27 04:52:07 2004 -0400

    [PATCH] fix net/tulip/winbond-840.c warning.

commit 8714c381a31d9123a197c7eb624348df23917be3
Author: Greg Kroah-Hartman <greg@kroah.com>
Date:   Thu May 27 01:48:10 2004 -0700

    Remove the smbios driver as it is not needed.
    
    You can do the same from userspace, and the author requests that the
    driver be deleted from the kernel tree before people start using it.

commit 287e7692900e0288648bdbdffcd551391ab0b585
Merge: 3d61e38... 7177536...
Author: David Mosberger <davidm@tiger.hpl.hp.com>
Date:   Thu May 27 01:45:52 2004 -0700

    Merge

commit 7177536bbb74197b9260774c1daf375f44c3f5e5
Author: Jesse Barnes <jbarnes@engr.sgi.com>
Date:   Thu May 27 00:31:28 2004 -0700

    [PATCH] ia64: don't udelay() in sn_mmiob
    
    sn_mmiob is a lightweight way to ensure PCI write ordering, intended
    to be used as an alternative to doing a PIO read. Unfortunately, with
    the udelay() in there, it ends up being slower than a PCI read on
    small configurations, so remove it in favor of a simple cpu_relax().

commit 2a1ca0d072613abe38a2d03d0885329e730ebd9c
Author: David S. Miller <davem@nuts.davemloft.net>
Date:   Thu May 27 00:07:42 2004 -0700

    [TCP]: Add receiver side RTT estimation.
    
    Based largely upon work by John Heffner.

commit 16da6fae399a55fa60a99b0bb7f5ad19243b60b0
Merge: f2ccfa4... 10b8580...
Author: Steve French <stevef@smfhome.smfdom>
Date:   Thu May 27 01:05:12 2004 -0500

    Merge bk://cifs.bkbits.net/linux-2.5cifs
    into smfhome.smfdom:/home/stevef/linux-2.5cifs

commit d0dd03b12fe927e836cc2e27f8bb768273815442
Author: Bjorn Helgaas <bjorn.helgaas@hp.com>
Date:   Wed May 26 22:00:46 2004 -0700

    [PATCH] ia64: fix hotplug config placement
    
    HOTPLUG_CPU depends on SMP, so why not put it under SMP?

commit 520a9e8ee55e8a1ad2cba89c2748a3b32151dd4a
Merge: 30eced5... e37a8f1...
Author: Dave Kleikamp <shaggy@austin.ibm.com>
Date:   Wed May 26 23:59:02 2004 -0500

    Merge jfs@jfs.bkbits.net:linux-2.5
    into austin.ibm.com:/shaggy/bk/jfs-2.5

commit c8121c4f3a1bc68c2234ec95bd5542ca57d87d51
Author: David Mosberger <davidm@tiger.hpl.hp.com>
Date:   Wed May 26 21:53:19 2004 -0700

    ia64: Reserve syscall # for vserver().

commit e37a8f1f47281c9784d8d69a7d54c0722d87a7db
Author: Dave Kleikamp <shaggy@austin.ibm.com>
Date:   Wed May 26 23:31:09 2004 -0500

    JFS: fix hang in __get_metapage
    
    A previous patch to fix a race introduced a hang if more than one
    thread is waiting for a "stale" metapage.

commit cf8cd3d1c5d3d4053a1a64b04a682537457d42fb
Author: David S. Miller <davem@nuts.davemloft.net>
Date:   Wed May 26 21:17:04 2004 -0700

    Cset exclude: mashirle@us.ibm.com|ChangeSet|20040526204412|10895

commit 81612fc056fc9e6cd2c3efabfafedf850bf1839d
Merge: 1814aa6... 3d61e38...
Author: David S. Miller <davem@nuts.davemloft.net>
Date:   Wed May 26 20:07:06 2004 -0700

    Merge nuts.davemloft.net:/disk1/BK/sparcwork-2.6
    into nuts.davemloft.net:/disk1/BK/sparc-2.6

commit 1814aa682fdbb612cc749c8e27b0287f932041ef
Author: David S. Miller <davem@nuts.davemloft.net>
Date:   Wed May 26 19:49:52 2004 -0700

    [SPARC64]: Export _do_write_trylock to modules.

commit f2ccfa41bc82a7a2820b5494ff9550ee52ea0eaa
Merge: 457e363... 3d61e38...
Author: Steve French <cifs.adm@hostme.bitkeeper.com>
Date:   Wed May 26 18:56:01 2004 -0700

    Merge bk://linux.bkbits.net/linux-2.5
    into hostme.bitkeeper.com:/repos/c/cifs/linux-2.5cifs

commit 3d61e38740b49885e4b13ef6501b9ecc6432e4df
Author: Andrew Morton <akpm@osdl.org>
Date:   Wed May 26 17:36:46 2004 -0700

    [PATCH] nfsd: deleting symlinks over nfs causes oops on unmount
    
    From: "J. Bruce Fields" <bfields@fieldses.org>
    From: Neil Brown <neilb@cse.unsw.edu.au>
    
    This fixes an oops on unmount (failure of the assertation at
    fs/ext3/super.c:421).  Probably reproduceable just by creating and deleting a
    single symlink over nfs and then unmounting the exported filesystem.
    
    Recent change to fh_compose means dentry reference is *not* consumed, and so
    usually has to be explicitly dput afterwards.  One usage was missed in that
    patch, so this dput is needed.
    
    Signed-off-by: Andrew Morton <akpm@osdl.org>

commit 3b15e36b41c2ecf91293ec67ae453fb7199c096e
Author: Andrew Morton <akpm@osdl.org>
Date:   Wed May 26 17:36:36 2004 -0700

    [PATCH] Print backtrace for bad vfree()
    
    From: Andi Kleen <ak@suse.de>
    
    Only the printk alone is not too useful, print the backtrace too.
    
    Signed-off-by: Andrew Morton <akpm@osdl.org>

commit 39d51810effa73a5ed48bc6b81ab35cad4c0c6be
Author: Andrew Morton <akpm@osdl.org>
Date:   Wed May 26 17:36:25 2004 -0700

    [PATCH] swsusp documentation updates
    
    From: Pavel Machek <pavel@ucw.cz>
    
    
    Signed-off-by: Andrew Morton <akpm@osdl.org>

commit faf898a61ca5727d7857fb45407a0de77628f953
Author: Andrew Morton <akpm@osdl.org>
Date:   Wed May 26 17:36:14 2004 -0700

    [PATCH] CPU Hotplug: restore Idle task's priority during CPU_DEAD notification
    
    From: Srivatsa Vaddagiri <vatsa@in.ibm.com>
    
    Fix a CPU Hotplug problem wherein idle task's "->prio" value is not
    restored to MAX_PRIO during CPU_DEAD handling.  Without this patch, once a
    CPU is offlined and then later onlined, it becomes "more or less" useless
    (does not run any task other than its idle task!)
    
    Ingo said:
    
      The __setscheduler() call is (technically) incorrect because in the
      SCHED_NORMAL case the prio should be zero.  So it's a bit cleaner to set up
      the static priority to MAX_PRIO and then revert the policy to SCHED_NORMAL
      via __setscheduler().
    
    Signed-off-by: Ingo Molnar <mingo@elte.hu>
    Signed-off-by: Andrew Morton <akpm@osdl.org>

commit 4ffa43b8c9b91ceda9af8d69b59c1877fe90c35e
Author: Andrew Morton <akpm@osdl.org>
Date:   Wed May 26 17:36:04 2004 -0700

    [PATCH] remove message: POSIX conformance testing by UNIFIX
    
    From: "Randy.Dunlap" <rddunlap@osdl.org>
    
    Remove the outdated "POSIX conformance testing by UNIFIX" message.
    
    There is a general desire to reduce the quantity of noisy and/or
    outdated kernel boot-time messages...
    
    Suggested by Andi Kleen.
    
    Ulrich's (old) comments:
    http://www.nsa.gov/selinux/list-archive/0107/0525.cfm
    
    Certifying Linux (Linux Journal):
    http://www.linuxjournal.com/article.php?sid=0131
    
    Agreed by Tim Bird, no dissenters that I heard of:
    http://marc.theaimsgroup.com/?l=linux-kernel&m=108362954024749&w=2
    
    Signed-off-by: Andrew Morton <akpm@osdl.org>

commit 58e033790ad66b2cf74daef08fa1e7cc158db862
Author: Andrew Morton <akpm@osdl.org>
Date:   Wed May 26 17:35:53 2004 -0700

    [PATCH] wdt.c warning fix
    
    drivers/char/watchdog/wdt.c: In function `wdt_init':
    drivers/char/watchdog/wdt.c:638: warning: label `outrbt' defined but not used
    
    Signed-off-by: Andrew Morton <akpm@osdl.org>

commit 1c211088833a27daa4512348bcae9890e8cf92d4
Author: Andrew Morton <akpm@osdl.org>
Date:   Wed May 26 17:35:42 2004 -0700

    [PATCH] Fix the setting of file->f_ra on block-special files
    
    We need to set file->f_ra _after_ calling blkdev_open(), when inode->i_mapping
    points at the right thing.  And we need to get it from
    inode->i_mapping->host->i_mapping too, which represents the underlying device.
    
    Also, don't test for null file->f_mapping in the O_DIRECT checks.
    
    Signed-off-by: Andrew Morton <akpm@osdl.org>

commit 59a6ce4f0086b52a5e7e8db2c8ed8027e11770e1
Author: Andrew Morton <akpm@osdl.org>
Date:   Wed May 26 17:35:31 2004 -0700

    [PATCH] Set d_bucket correctly for anonymous dentries
    
    From: Neil Brown <neilb@cse.unsw.edu.au>
    
    In researching the oopses reported in bug #2761, Neil came up with:
    
    I have found one problem, but it isn't particularly new and I cannot
     see how it would be related.
    
    When d_alloc_anon creates an anonymous dentry, it is put on a special hash
    chain for anonymous dentries (sb->s_anon), but d_bucket is set to
    
       d_hash(parent, name_hash)
    
    If, when it is eventually moved to a proper name, that hash value is the same
    as the final hash value, it will not be moved to the right bucket, and so it
    not be accessible by name.  This patch should fix it.
    
    
    
    anonymous dentries have their own private hash "bucket" (sb->s_anon) and so
    d_bucket should be set to a unique (impossible) address, else d_move will
    get confused.
    
    Signed-off-by: Neil Brown <neilb@cse.unsw.edu.au>
    Signed-off-by: Andrew Morton <akpm@osdl.org>

commit ab31c400a21269345c285a3fa451227653717feb
Author: Andrew Morton <akpm@osdl.org>
Date:   Wed May 26 17:35:21 2004 -0700

    [PATCH] posix locks oops fix
    
    From: Andreas Gruenbacher <agruen@suse.de>
    
    There is a race between unshare_files() and the following steal_locks().
    As a consequence, steal_locks() may steal some additional FL_POSIX locks
    that don't belong to the current thread.  This triggers a BUG in
    locks_remove_flock().
    
    In detail, the current thread shares its files struct with other threads.
    This causes unshare_files() to associate the current thread with a copy of
    its files_struct.  The copy shares all file objects with the original files
    struct.  In the time between unshare_files() and steal_locks(), another
    thread creates a new file and a FL_POSIX lock on it.  The current thread
    gets into steal_locks() and takes over all FL_POSIX locks that refer to the
    previous files_struct, including the new lock.  We do
    put_files_struct(original files_struct).  This causes the file handle to
    the new file to be closed.  We get into locks_remove_posix() and miss the
    lock, because its fl_owner field now refers to the new files_struct.
    Finally we get into locks_remove_flock(), and stumble upon the lock.
    
    While looking into this bug report I gathered the following data with a
    SUSE kernel (oops and LKCD dump from Chris):
    
    kernel BUG at fs/locks.c:1736!
    invalid operand: 0000 [#1]
    SMP
    CPU:    0
    EIP:    0060:[<c01844fb>]    Tainted: G  U
    EFLAGS: 00010246   (2.6.5-0-testing)
    EIP is at locks_remove_flock+0x8b/0x130
    eax: f7b89998   ebx: f61df3fc   ecx: f61df354   edx: 00000000
    esi: f61df354   edi: f6702b80   ebp: f6179c24   esp: f6179c08
    ds: 007b   es: 007b   ss: 0068
    Process owcimomd (pid: 1713, threadinfo=f6178000 task=f66d0d60)
    Stack: c1e1fdac c1e1fdac f7fe83c0 00000296 f6702b80 f7fe87c0 f61df354 f6179c3c
           c016ce00 f61ddadc f6702b80 00000000 f6703b00 f6179c54 c0168b1f c0000000
           0000026f 00000012 f6703b00 f6179c6c c0124ba7 00000001 f6179e5c f6179d88
    Call Trace:
     [<c016ce00>] __fput+0x30/0x120
     [<c0168b1f>] filp_close+0x4f/0x90
     [<c0124ba7>] put_files_struct+0x67/0xc0
     [<c019d285>] load_elf_binary+0x3f5/0x1596
     [<c018a5af>] update_atime+0x9f/0xc0
     [<c01478fd>] __generic_file_aio_read+0x1cd/0x200
     [<c0145060>] file_read_actor+0x0/0xd0
     [<c01784b7>] search_binary_handler+0x97/0x270
     [<c017a072>] do_execve+0x172/0x200
     [<c0105fb2>] sys_execve+0x32/0x70
     [<c0107e21>] sysenter_past_esp+0x52/0x71
    
    Code: 0f 0b c8 06 eb 74 35 c0 eb db b8 00 e0 ff ff 21 e0 8b 10 8b
    
    put_files_struct+0x67 is equivalent to fs/binfmt_elf.c:681 in 2.6.6
    
    current->files == fl->fl_owner
    fl->fl_file = 0xf6702b80 (a valid struct file)
    
    current->files =
      max_fds=32
      max_fdset=1024
      next_fd=3
      fd=[0xf6927080 0xf6951b80  0xf6951b80 0 ...]
    
    Here's a proposed fix.  As a side effect, steal_locks no longer walks the
    global list of locks, but only the locks of all open inodes.
    
    What are the reasons (other than historic ones) for not getting rid of
    fl_owner and using fl_pid instead, by the way?  I think that would clean up
    the whole mess with file locks a bit.
    
    Signed-off-by: Andrew Morton <akpm@osdl.org>

commit df6d6035eb839968038ee96881abc94271e93841
Author: Andrew Morton <akpm@osdl.org>
Date:   Wed May 26 17:35:10 2004 -0700

    [PATCH] ppc32: fix 'make O=...'
    
    From: Tom Rini <trini@kernel.crashing.org>
    
    Fix arch/ppc/boot/ so that everything now works with 'make O='.
    
    Partially by: Geoffrey LEVAND <geoffrey.levand@am.sony.com>.
    Signed-off-by: Tom Rini <trini@kernel.crashing.org>
    Signed-off-by: Andrew Morton <akpm@osdl.org>

commit 8634c9f3890a1303a6cda110fe2d9094ff451c40
Author: Andrew Morton <akpm@osdl.org>
Date:   Wed May 26 17:34:58 2004 -0700

    [PATCH] ppc64 kernel hackers can't spell
    
    From: Anton Blanchard <anton@samba.org>
    
    From: Dave Hansen
    
    This patch is obviously of the utmost importance.  It probably doesn't matter
    as much for kernel error messages, but one of these mistakes is in a
    user-readable /proc file.
    
    Signed-off-by: Anton Blanchard <anton@samba.org>
    Signed-off-by: Dave Hansen <haveblue@us.ibm.com>
    Signed-off-by: Andrew Morton <akpm@osdl.org>

commit 968df33b7f2309e3a497382aaf5e5d6396358c53
Author: Dave Jones <davej@redhat.com>
Date:   Thu May 27 00:30:23 2004 +0100

    [CPUFREQ] fix panic in powernow_k8_verify on MP but PSB systems.
    
    Instead of -ENODEV; powernow_k8_cpu_init returns 0 if it's running on a MP
    system but PSB BIOS is tried... this causes a panic in
    powernow_k8_verify, as can be seen at
    http://forums.gentoo.org/viewtopic.php?t=177423
    
    Signed-off-by: Dave Jones <davej@redhat.com>
    Signed-off-by: Dominik Brodowski <linux@brodo.de>

commit 10b858012335f05fc1508ec4147d4f38fcf58a8c
Author: Steve French <stevef@smfhome1.smfsambadom>
Date:   Wed May 26 12:47:02 2004 -0500

    Take rename sem (where we can do it safely) when building full paths. We don't try to take the rename sem in cifs_rename of course because the kernel already took it above us, and for the same reason we can not take it in lookup/revalidate, but most everywhere else we build a full path we can safely take it.

commit 39d3ed4dde447fd0bc0931e0e29eab8e0922d9e3
Author: Anton Altaparmakov <aia21@cantab.net>
Date:   Wed May 26 18:32:13 2004 +0100

    NTFS: 2.1.12 release - Fix the second fix to the decompression engine.

commit 457e36327240c835e868a00991193e657668d1ba
Author: Steve French <stevef@stevef95.austin.ibm.com>
Date:   Wed May 26 08:31:27 2004 -0500

    missing init for new request_q

commit 8d46599d4b874c09de25cc64771ca2de909a767b
Author: Steve French <stevef@stevef95.austin.ibm.com>
Date:   Wed May 26 08:07:36 2004 -0500

    fix big endian conversion of file system attribute and device info

commit f120b7b2388b3d6fda7bf0ddc6767249ca7636b3
Author: Steve French <stevef@stevef95.austin.ibm.com>
Date:   Wed May 26 07:39:46 2004 -0500

    Keep number of active (on the network at one time) requests (to a single cifs server) below SMB maxmpx

commit dd76695778b23a2b199ce518c5e17b19f1cff008
Author: Dave Kleikamp <shaggy@austin.ibm.com>
Date:   Wed May 26 06:12:55 2004 -0500

    JFS: check default acl for correctness before setting it
    
    This patch was orignally submitted by Andreas Gruenbacher and modified
    by me.

commit 4da0510fc54dcbe7e3079f74eff31400d3102234
Merge: c85964e... 5e681ee...
Author: Anton Altaparmakov <aia21@cantab.net>
Date:   Wed May 26 10:10:55 2004 +0100

    Merge cantab.net:/home/src/bklinux-2.6
    into cantab.net:/home/src/ntfs-2.6

commit db09cd9024c205db04d64b033cb63f14e871343e
Author: Arjan van de Ven <arjanv@redhat.com>
Date:   Wed May 26 01:37:25 2004 -0700

    [PATCH] PCI: restore pci config space on resume
    
    The patch below enhances the PCI layer with 2 things
    1) enable and busmaster state are stored in the pci device struct
    2) pci config space is stored to the pci device struct
    
    with that, it is possible to make a generic pci resume method that restores
    config space and reenables the device, including busmaster when appropriate.
    
    One can rightfully argue that the driver resume method should do this, and
    yes that is right. So the patch only does it for devices that don't have a
    resume method. Like the main PCI bridge on my testbox of which the bios so
    nicely forgets to restore the bus master bit during resume.. With this patch
    my testbox resumes just fine while it, well, wasn't all too happy as you can
    imagine without a busmaster pci bridge.

commit 4d9d9fa9aa83694cdb96552498d365aee569cca5
Author: David S. Miller <davem@nuts.davemloft.net>
Date:   Wed May 26 01:09:10 2004 -0700

    [TCP]: Add tcp_default_win_scale sysctl.

commit d8777cc13958520f85bbc9a6183e38feb7db595d
Author: David S. Miller <davem@nuts.davemloft.net>
Date:   Wed May 26 00:35:27 2004 -0700

    [TCP]: Kill distance enforcement between tcp_mem[] elements.

commit 018ebb6e8315b8240ac3ef70067aae1453ef278b
Author: David S. Miller <davem@nuts.davemloft.net>
Date:   Wed May 26 00:20:57 2004 -0700

    [SCTP]: Kill 64-bit platform warning.

commit 37a93ba78595c639b1b63980a53e5ebb8af94b33
Merge: 99eee9a... 5e681ee...
Author: Steve French <cifs.adm@hostme.bitkeeper.com>
Date:   Wed May 26 00:17:42 2004 -0700

    Merge bk://linux.bkbits.net/linux-2.5
    into hostme.bitkeeper.com:/repos/c/cifs/linux-2.5cifs

commit 3711eeb85b15ee6e6534239e75925c0334e3d09d
Author: Shirley Ma <mashirle@us.ibm.com>
Date:   Tue May 25 23:55:48 2004 -0700

    [RTNETLINK]: IFA_MAX is wrong.

commit fe2e254cc131b342a75a32b77c04588b40e17eb6
Author: Shirley Ma <mashirle@us.ibm.com>
Date:   Tue May 25 23:44:12 2004 -0700

    [IPV6]: Add new IPv6 MIBs counters support through netlink.
    
    This patch implements both per interface and global new IPv6 MIBs counters
    through netlink based on new IP MIBs draft, 64 bit counters are not supported
    here because of performance issues. It coexists old IPv6 MIBs counters (which
    are through proc file system) for the compatibility.

commit db85e9905622825aff3e661ab9128aab9c72b810
Author: Christophe Saout <christophe@saout.de>
Date:   Tue May 25 23:25:49 2004 -0700

    [CRYPTO]: Fix two scatterwalk problems.
    
    - After calling scatterwalk_copychunks walk_in might point to the next
      page which will break scatterwalk_samebuf (in this case src_p should
      point to tmp_src anyway and scatterwalk_samembuf returns 0).
    
    - scatterwalk_samebuf should also check for equal offsets inside the page
      (just bad for performance in some cases).

commit d1510edaee892d13ea18465253b71fae156d1e52
Author: Shirley Ma <mashirle@us.ibm.com>
Date:   Tue May 25 23:24:17 2004 -0700

    [IPV6]: Fix pmtu check conditions in two spots.

commit a289f49da6bec4f17091ddf1e8e8eaede18ffc18
Author: David S. Miller <davem@nuts.davemloft.net>
Date:   Tue May 25 21:47:49 2004 -0700

    [TG3]: Use HOST TXDs always.

commit 8dba80ce9a280beb854db9c457394c3a9e2b0fd2
Author: David S. Miller <davem@nuts.davemloft.net>
Date:   Tue May 25 21:15:27 2004 -0700

    [SPARC64]: Kill unused var warnings/errors.

commit 30eced598805ef1ef3bc1f88de2fd2fc5e2189e5
Merge: d831e5a... 7c5488f...
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Tue May 25 19:08:10 2004 -0700

    Merge bk://are.twiddle.net/axp-2.6
    into ppc970.osdl.org:/home/torvalds/v2.6/linux

commit d831e5a2ded6f836b7bbf5630915e74938cd5ac6
Merge: 160cc4e... 5209a2a...
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Tue May 25 19:06:26 2004 -0700

    Merge bk://kernel.bkbits.net/davem/net-2.6
    into ppc970.osdl.org:/home/torvalds/v2.6/linux

commit 5209a2ab8d9f548fa38273b466d153832a7dc9cc
Author: Paul Mackerras <paulus@samba.org>
Date:   Tue May 25 19:03:18 2004 -0700

    [PATCH] ppc64: fix nonexistent irq affinity
    
    This fixes a bug where, if we try to set the affinity on an unused
    virtual IRQ number on a logically-partitioned pSeries system, we call
    the firmware with physical IRQ number = -1, which it doesn't like.
    
    With this patch we just ignore the attempt.
    
    Signed-off-by: Paul Mackerras <paulus@samba.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit 865c05da13001b5d16ebe6709afd2ba623d7c8c7
Author: Bartlomiej Zolnierkiewicz <b.zolnierkiewicz@elka.pw.edu.pl>
Date:   Tue May 25 18:30:08 2004 -0700

    [PATCH] ide: use msleep() instead of ide_delay_50ms()
    
    msleep() does msecs to jiffies conversion correctly regardless
    of HZ value and sets the current task's state in a safe way.
    
    Signed-off-by: Bartlomiej Zolnierkiewicz <bzolnier@elka.pw.edu.pl>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit 06be32546e2fb6f01be0ac39b9e2921e063a3924
Author: Bartlomiej Zolnierkiewicz <b.zolnierkiewicz@elka.pw.edu.pl>
Date:   Tue May 25 18:29:57 2004 -0700

    [PATCH] ide: fix ide_delay_50ms() in ide.c to always sleep
    
    Noticed by Christoph Hellwig <hch@lst.de>.
    
    Probably somebody got the logic wrong while adding
    #ifndef CONFIG_BLK_DEV_IDECS back in 2.4.0-test2.
    
    Signed-off-by: Bartlomiej Zolnierkiewicz <bzolnier@elka.pw.edu.pl>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit e59eed78c68673c67bdd0185e3df19ec04df5885
Author: Bartlomiej Zolnierkiewicz <b.zolnierkiewicz@elka.pw.edu.pl>
Date:   Tue May 25 18:29:48 2004 -0700

    [PATCH] ide: missing rq checks in ide-disk
    
    ide-disk only checks for drive->blocked and blk_fs_request() if TASKFILE_IO
    is defined.  Move these checks (and TCQ check too) to upper function.
    
    Signed-off-by: Jens Axboe <axboe@suse.de>
    Signed-off-by: Bartlomiej Zolnierkiewicz <bzolnier@elka.pw.edu.pl>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit 6314b8e29bf462a34dde8f05d3eb1ec1a893a65c
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Tue May 25 17:56:23 2004 -0700

    Split ptep_establish into "establish" and "update_access_flags"
    
    ptep_establish() is used to establish a new mapping at COW time,
    and it always replaces a non-writable page mapping with a totally
    new page mapping that is dirty (and likely writable, although ptrace
    may cause a non-writable new mapping). Because it was nonwritable,
    we don't have to worry about losing concurrent dirty page bit updates.
    
    ptep_update_access_flags() leaves the same page mapping, but updates
    the accessed/dirty/writable bits (it only ever sets them, and never
    removes any permissions). Often easier, but it may race with a dirty
    bit update on another CPU.
    
    Booted on x86 and ppc64.
    
    Signed-off-by: Benjamin Herrenschmidt <benh@kernel.crashing.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit c85964e261490715e8309210987286ab14d5d8b1
Author: Anton Altaparmakov <aia21@cantab.net>
Date:   Tue May 25 18:31:28 2004 +0100

    NTFS: Cleanup dirty ntfs inode handling (fs/ntfs/inode.[hc]) which also
          includes an adapted ntfs_commit_inode() and an implementation of
          ntfs_write_inode() which for now just cleans dirty inodes without
          writing them (it does emit a warning that this is happening).

commit 160cc4eb2faca1bbba2a90da0672152818c208ab
Merge: 5e681ee... fb8c268...
Author: David S. Miller <davem@kernel.bkbits.net>
Date:   Tue May 25 09:14:47 2004 -0700

    Merge davem@nuts.davemloft.net:/disk1/BK/net-2.6
    into kernel.bkbits.net:/home/davem/net-2.6

commit fb8c2688d91d47747f1ef593baf3cd377046216d
Author: Dmitry Torokhov <dtor_core@ameritech.net>
Date:   Tue May 25 09:13:48 2004 -0700

    [NET_SCHED] Do not oops when user tries to attach a filter to a TBF qdisc.
    
    (TBF does not allow attaching filters as it has only one class,
    filter should be attached either to TBF's parent or to its child)

commit 51e645b9abd8d4b53f6b72fe404219c9be6a1cb5
Author: David S. Miller <davem@nuts.davemloft.net>
Date:   Tue May 25 08:52:09 2004 -0700

    [SPARC64]: Move over to HZ==1000.

commit 5e681ee3377fbb5d6ba5a0850189419eb4b8f0a4
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Tue May 25 08:24:29 2004 -0700

    Remove bogus test preprocessor test.
    
    PAGE_SIZE isn't even always defined at this point,
    which makes us test undefined preprocessor symbols.
    
    It so happens that the test works in that case,
    but since the test is a bit pointless in the first
    place...

commit cb0c8b62d24820967c81d37b8f6e4657af43ea5e
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Tue May 25 08:22:33 2004 -0700

    Make constant types explicit, rather than depend on
    some rather subtle C type expansion rules.
    
    This makes sparse happier.

commit d824e08ab076cf58c9b8ccec11817218e1b8d33f
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Tue May 25 08:21:34 2004 -0700

    Don't return void types from void functions.
    
    This helps reduce sparse noise.

commit 7dd7d6f560573930d1e44b9f82b5ebfa932f0c9b
Author: David S. Miller <davem@nuts.davemloft.net>
Date:   Tue May 25 08:04:26 2004 -0700

    [SPARC64]: Update defconfig.

commit 2989ea106150da683f5a5ae8bf48fa03b0414af2
Author: David S. Miller <davem@nuts.davemloft.net>
Date:   Tue May 25 08:01:48 2004 -0700

    [SPARC64]: Implement _raw_spin_lock_flags().

commit 99eee9a8c076e25debd995771a127f4b7da1f641
Merge: a9c2138... 5bdf45f...
Author: Steve French <cifs.adm@hostme.bitkeeper.com>
Date:   Tue May 25 04:36:11 2004 -0700

    Merge bk://linux.bkbits.net/linux-2.5
    into hostme.bitkeeper.com:/repos/c/cifs/linux-2.5cifs

commit 5bdf45fea00673a307218cdb6e9d9a472afe8e7d
Merge: f051a69... e5a0a00...
Author: Steve French <stevef@stevef95.austin.ibm.com>
Date:   Tue May 25 07:37:38 2004 -0500

    Merge bk://cifs.bkbits.net/linux-2.5cifs
    into stevef95.austin.ibm.com:/home/stevef/linux-2.5cifs

commit e5a0a002a28615cb156137b6987e30f3951d467a
Author: Steve French <stevef@stevef95.austin.ibm.com>
Date:   Tue May 25 07:36:24 2004 -0500

    do not log errors on write failures unless debug is on

commit 3e0cae999c4819b1a6692cb154ee99714464b702
Merge: ffcb606... 14bc28a...
Author: Anton Altaparmakov <aia21@cantab.net>
Date:   Tue May 25 11:12:10 2004 +0100

    Merge cantab.net:/home/src/bklinux-2.6
    into cantab.net:/home/src/ntfs-2.6

commit 1d16702f55db1e5ea8dc8876ff55f46d24ee5396
Merge: a4a3f27... a9c2138...
Author: David S. Miller <davem@nuts.davemloft.net>
Date:   Tue May 25 01:17:51 2004 -0700

    Merge nuts.davemloft.net:/disk1/BK/sparcwork-2.6
    into nuts.davemloft.net:/disk1/BK/sparc-2.6

commit a9c2138da65c9399479daa2d91d3c07f48f1b879
Merge: d7afc82... 89de870...
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Tue May 25 00:39:03 2004 -0700

    Merge bk://kernel.bkbits.net/davem/tg3-2.6
    into ppc970.osdl.org:/home/torvalds/v2.6/linux

commit a4a3f276453ce090c73765c38f2cf4a039306cb5
Author: David S. Miller <davem@nuts.davemloft.net>
Date:   Tue May 25 00:01:13 2004 -0700

    [SPARC64]: Implement debugging version of write_trylock().

commit 89de87064af4c0f0015c6e79a0b108ebb2ab9bf0
Merge: 51f1742... d691885...
Author: David S. Miller <davem@kernel.bkbits.net>
Date:   Mon May 24 23:54:42 2004 -0700

    Merge davem@nuts.davemloft.net:/disk1/BK/tg3-2.6
    into kernel.bkbits.net:/home/davem/tg3-2.6

commit d7afc82b9462516450b486ea2acf46958f062401
Merge: 8583974... 87050fa...
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Mon May 24 23:51:20 2004 -0700

    Merge bk://kernel.bkbits.net/davem/net-2.6
    into ppc970.osdl.org:/home/torvalds/v2.6/linux

commit 8583974f03ee95fdb6d3fa0586ed49aaaebf584b
Merge: 3a8a422... 51f1742...
Author: David S. Miller <davem@kernel.bkbits.net>
Date:   Mon May 24 23:37:24 2004 -0700

    Merge davem@nuts.davemloft.net:/disk1/BK/net-2.6
    into kernel.bkbits.net:/home/davem/net-2.6

commit 3a8a4221462b181a8fda956c5835f1ae1b212684
Author: Steven King <sxking@qwest.net>
Date:   Mon May 24 23:09:27 2004 -0700

    [IPSEC]: Fix buglet in AF_KEY spddelete
    
    When trying to spddelete individual entries using setkey, spddelete always
    fails.  The culprit is in net/af_key.c; spdadd sets the family field of the
    selector when creating an entry, but spddelete doesn't when building a
    selector to match for xfrm_policy_bysel.  Trivial fix is to have spddelete
    set the family field in the selector in same way spdadd does.

commit d6918859ae92d58b59d620edf908f0e770ac6648
Author: David S. Miller <davem@nuts.davemloft.net>
Date:   Mon May 24 23:06:21 2004 -0700

    [TG3]: Update driver version and reldate.

commit 87050fae7607166d02c1eaf052f8a55d7eca8e5c
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Mon May 24 23:04:59 2004 -0700

    Introduce architecture-specific "ptep_update_dirty_accessed()"
    helper function to write-back the dirty and accessed bits from
    ptep_establish().
    
    Right now this defaults to the same old "set_pte()" that we've
    always done, except for x86 where we now fix the (unlikely)
    race in updating accessed bits and dropping a concurrent dirty
    bit.

commit bca78c06775a32538080dc88d97af98b018d9ebc
Author: Arthur Kepner <akepner@sgi.com>
Date:   Mon May 24 23:04:23 2004 -0700

    [TG3]: Make sure RX/TX flow control settings actually get set.

commit c9e1750cf60872334f2425848dfc5d3a7dbd323d
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Mon May 24 22:37:15 2004 -0700

    Pass in a "dirty" argument to ptep_establish in
    preparation for pte update race fix.
    
    This does not actually use the information yet, but
    the next few patches will start to put it to some
    good use.

commit d465a6b03fd4e0bbf2961452537fd555fe7ff2cd
Author: Alan Stern <stern@rowland.harvard.edu>
Date:   Mon May 24 22:33:50 2004 -0700

    [PATCH] USB: Gonzo variable renaming in hub.c
    
    As part of the cleanup effort, I wanted to name all the variables in hub.c
    uniformly.  Currently there are different names for the same thing in
    different routines, and the same names are used for different things --
    it's impossible to keep things straight.  I also wanted to step away from
    the deplorable practice of naming everything "dev".  It is not an
    exaggeration that up until relatively recently one of the drivers (not the
    hub driver, fortunately!) contained a line which looked basically like
    this:
    
    	dev->dev.dev = &intf->dev;
    
    If you can make sense out of that, you're a better code reader than I am!
    
    Ranting aside, this patch institutes the following name scheme for local
    variables in hub.c:
    
    	hub:		struct usb_hub
    	hdev:		hub's corresponding struct usb_device
    	hub_dev:	hub interface's embedded struct device
    	udev:		general struct usb_device
    
    There are a couple of genuine code changes hidden in there too.  Just
    trivial things, like creating a local hub_dev variable for use in place of
    &hub->intf->dev.

commit 378ca81302ee908348e1fc8444503eda6c9952e1
Author: Alan Stern <stern@rowland.harvard.edu>
Date:   Mon May 24 22:33:17 2004 -0700

    [PATCH] USB: Make usb_choose_configuration() a separate subroutine
    
    This patch creates a separate subroutine to encapsulate the work required
    in choosing an initial configuration for a device.  In my opinion that
    reflects a policy decision that should be kept apart from all the other
    work involved in creating a new device structure.  The existing code in
    usb_new_device() is simply moved into usb_choose_configuration().

commit ad12579b4020b2a843994ea206f92074c30d8824
Author: Alan Stern <stern@rowland.harvard.edu>
Date:   Mon May 24 22:27:47 2004 -0700

    [PATCH] USB: Add usb_release_address() and move usb_set_address()
    
    This patch adds usb_release_address() as a complement to
    usb_choose_address(), to centralize the work required when freeing an
    allocated device address.  It also moves the usb_set_address() routine
    from usb.c to hub.c -- which is the only place it is ever used -- and
    renames it to hub_set_address().

commit d7a3f44d2387fec1fcd995e2c343c21fc1b0a684
Author: Alan Stern <stern@rowland.harvard.edu>
Date:   Mon May 24 21:50:29 2004 -0700

    [PATCH] USB: Change "driverfs" to "sysfs" in usbcore
    
    Before fixing up the device locking and device reset code, I want to do
    some cleanups of the hub driver and related areas.  This is the first of a
    series of patches for that purpose.
    
    This patch changes all the occurrences of "driverfs" in usbcore to "sysfs"
    -- I just couldn't stand seeing the out-of-date name any more (and I kept
    confusing it with usbfs, don't know why).
    
    Although I did a "bk mv driverfs.c sysfs.c" when creating the patch, the
    exported patch file itself doesn't reflect that very well.  It looks like
    driverfs.c was deleted and sysfs.c created from scratch.  If you prefer, I
    can resubmit this in a slightly different form, with the file name
    unchanged so that you can issue the "bk mv" command in your repository
    after applying the patch.

commit 0c4391c903271f704e0ba27a64232f03ac180cb5
Author: Alan Stern <stern@rowland.harvard.edu>
Date:   Mon May 24 21:38:39 2004 -0700

    [PATCH] USB UHCI: allow URBs to be unlinked when IRQs don't work
    
    A lot of people with USB controllers made by VIA have been suffering from
    the fact that these controllers stop working when they receive a babble
    packet.  In particular, they stop generating interrupt requests.  Since
    the UHCI driver relies on IRQs from the controller for proper timing and
    interlocking of unlink requests, this means that those broken controllers
    will hang the UHCI driver and drivers for any device connected through it.
    
    This patch, written by Herbert Xu, gives the UCHI driver the ability to
    manage the unlink procedure using timer interrupts as well as controller
    interrupts.  (It also fixes a race in the UHCI irq handler.)  Although it
    won't prevent the VIA controllers from flaking out when they encounter
    babble, at least now users will be able to rmmod the uhci-hcd driver and
    then reload it, restoring their systems back to normal operation (until
    the next babble!).
    
    P.S.: Herbert, there's one loose end I still want to tie up.  When the
    controller isn't running (i.e., is suspended) the frame number won't
    change, but unlinks still need to work.  It's a small point, not too
    likely to come up in normal usage.  I'll fix it later on when I update the
    state-changing part of the driver.

commit a8a5d4362269dbe1eb509b68204631c019396596
Author: Alan Stern <stern@rowland.harvard.edu>
Date:   Mon May 24 21:37:59 2004 -0700

    [PATCH] USB: Initially read 9 bytes of config descriptor
    
    This patch reads the full 9 bytes of a configuration descriptor during
    enumeration rather than just the first 8 bytes.  That's how Windows does
    it, and today I ran across a device that doesn't work properly when asked
    to send only 8 bytes worth.  I doubt very much this will cause any
    problems with currently-working devices; since the descriptor itself is 9
    bytes long and since the devices are most likely to expect a 9-byte
    request, anything that can handle an 8-byte request should have no
    difficulty.  (Also, some debugging messages have been slightly improved.)
    
    Incidentally, USB traces taken from Windows 2000 and Windows XP show that
    when those operating systems retrieve a string descriptor during
    enumeration, they do so by requesting a 255-byte transfer.  They do not
    first ask just for the initial 2 bytes (which contain the actual length)
    and then ask for the actual length, which is what we do.  Interestingly,
    back in 2.4 we _did_ do things the same as Windows.

commit ff9f1839239eff8a58ecc822fd40355a755ef69c
Author: Joe Nardelli <jnardelli@infosciences.com>
Date:   Mon May 24 21:31:08 2004 -0700

    [PATCH] USB: visor: Fix Oops on disconnect
    
    This fixes http://bugme.osdl.org/show_bug.cgi?id=2289
    
    This patch has been tweaked by greg@kroah.com

commit 51f17423ad91e33031147336330fa2e5d34e803d
Author: Andi Kleen <ak@muc.de>
Date:   Mon May 24 21:11:46 2004 -0700

    [PATCH] Fix nodemask clearing bug in NUMA API
    
    Fix over long nodemask clearing in get_mem_policy() by using the
    right size for the node mask.

commit e1eaf9491889c413eb42459d3beb280f7c9bddad
Author: Joshua Jackson <linux-kernel@vortech.net>
Date:   Mon May 24 21:04:01 2004 -0700

    [VLAN]: Use KERN_INFO for VLAN_INF.

commit 646b8af19d49dcfe7744ed84708c6afc0464b3d9
Author: Herbert Xu <herbert@gondor.apana.org.au>
Date:   Mon May 24 21:02:48 2004 -0700

    [IPSEC]: Use add_timer() in xfrm_state_find.

commit 5837902683bb3ed8bd1743bb4ad91c74432c1338
Author: Herbert Xu <herbert@gondor.apana.org.au>
Date:   Mon May 24 21:02:07 2004 -0700

    [IPSEC]: Fix outdated comment in __xfrm_state_delete.

commit abcdeaafe6ace8c2d22c0b707edafa6c3caa7202
Author: Herbert Xu <herbert@gondor.apana.org.au>
Date:   Mon May 24 21:01:22 2004 -0700

    [IPSEC]: Do not leak entries in xfrm_state_find.
    
    In xfrm_state_find, the larval state never actually matures with
    Openswan so it only ever gets deleted by the timer which means
    that the time crash can't happen :)  It becomes a (possible) memory
    leak instead.

commit 3a3864130659623505c73e0de471ce390e00236d
Author: Olaf Hering <olh@suse.de>
Date:   Mon May 24 21:00:57 2004 -0700

    [PATCH] USB: out of bounds access in hiddev_cleanup
    
    hiddev_table[] is an array of pointers.  the minor number is used as an
    offset.  hiddev minors start either with zero, or with 96.  If they start
    with 96, the offset must be reduced by HIDDEV_MINOR_BASE because only 16
    minors are available.  unplugging a hiddevice will zero data outside the
    hiddev_table array.
    
    this was spotted by Takashi Iwai.

commit 6dbb845a79b828c5360dec02604d66a547ca2142
Author: James Lamanna <jamesl@appliedminds.com>
Date:   Mon May 24 21:00:18 2004 -0700

    [PATCH] USB: Fix down() in hard IRQ in powermate driver
    
    Fixes this warning:
    
    May 18 06:56:01 Knoppix kernel: Debug: sleeping function called from
    invalid context at include/asm/semaphore.h:119
    May 18 06:56:01 Knoppix kernel: in_atomic():1, irqs_disabled():0
    May 18 06:56:01 Knoppix kernel: Call Trace:
    May 18 06:56:01 Knoppix kernel:  [<c0117083>] __might_sleep+0xb2/0xd3
    May 18 06:56:01 Knoppix kernel:  [<f88b92f4>] powermate_config_complete+0x33/0x77 [powermate]
    May 18 06:56:01 Knoppix kernel:  [<c02c6760>] usb_hcd_giveback_urb+0x25/0x39
    May 18 06:56:01 Knoppix kernel:  [<c02d7194>] uhci_finish_urb+0x54/0xa1
    May 18 06:56:01 Knoppix kernel:  [<c02d7224>] uhci_finish_completion+0x43/0x55
    May 18 06:56:01 Knoppix kernel:  [<c02d737d>] uhci_irq+0xf8/0x179
    May 18 06:56:01 Knoppix kernel:  [<c02c67aa>] usb_hcd_irq+0x36/0x67
    May 18 06:56:01 Knoppix kernel:  [<c01060c6>] handle_IRQ_event+0x3a/0x64
    May 18 06:56:01 Knoppix kernel:  [<c0106479>] do_IRQ+0xb8/0x192
    May 18 06:56:01 Knoppix kernel:  [<c0104850>] common_interrupt+0x18/0x20
    
    Attached patch uses spinlocks instead of a semaphore so that we can't sleep
    when in_atomic().

commit 60a6680d7b51bad4783464db35208bd75fce6882
Author: Stephen Hemminger <shemminger@osdl.org>
Date:   Mon May 24 20:58:43 2004 -0700

    [BRIDGE]: Update bridge.txt
    
    Trent Jarvi <taj@www.linux.org.uk> noticed this.  The file was out of date
    with current web site and maintainer.  Please apply to 2.4 and 2.6.
    
    Signed-off-by: Stephen Hemminger <shemminger@osdl.org>

commit e49d96196594b1b18fc8070d09a5fc75d6d2cdce
Merge: 8abe04b... 14bc28a...
Author: David S. Miller <davem@nuts.davemloft.net>
Date:   Mon May 24 20:54:43 2004 -0700

    Merge nuts.davemloft.net:/disk1/BK/network-2.6
    into nuts.davemloft.net:/disk1/BK/net-2.6

commit 0684d7d9b3d9588b2fb26a3cd568c54c1f5c0d29
Author: Paul Mackerras <paulus@samba.org>
Date:   Mon May 24 20:27:46 2004 -0700

    [PATCH] IRQ stacks for PPC64
    
    Even with a 16kB stack, we have been seeing stack overflows on PPC64
    under stress.  This patch implements separate per-cpu stacks for
    processing interrupts and softirqs, along the lines of the
    CONFIG_4KSTACKS stuff on x86.  At the moment the stacks are still 16kB
    but I hope we can reduce that to 8kB in future.  (Gcc is capable of
    adding instructions to the function prolog to check the stack pointer
    whenever it moves it downwards, and I want to use that when I try
    using 8kB stacks so I can be confident that we aren't overflowing the
    stack.)
    
    Signed-off-by: Paul Mackerras <paulus@samba.org>

commit 8e2fd124458efb089e0abcb5376fbd990315be02
Author: Ingo Molnar <mingo@elte.hu>
Date:   Mon May 24 20:06:18 2004 -0700

    [PATCH] x86-bigsmp: use fixed interrupt delivery
    
    This patch, from Venkatesh Pallipadi, changes x86 IO-APICs to use fixed
    interrupt delivery instead of lowest priority to support larger number
    of CPUs.  Only bigsmp is affected by this cleanup.
    
    From: Venkatesh Pallipadi <venkatesh.pallipadi@intel.com>
    Signed-off-by: Ingo Molnar <mingo@elte.hu>

commit 94003a2af74b3696a042bc4f5984343776502445
Merge: 68da1c2... c50a637...
Author: Nathan Scott <nathans@sgi.com>
Date:   Tue May 25 13:05:20 2004 +1000

    Merge sgi.com:/source2/linux-2.6 into sgi.com:/source2/xfs-linux-2.6

commit c50a6374f27961885a93fbd28dba64b09e69ef60
Author: Nathan Scott <nathans@sgi.com>
Date:   Tue May 25 12:42:26 2004 +1000

    [XFS] Rename a subdirectory to make life easier for people (esp.
    distributors) picking up changes directly from the XFS CVS tree.

commit 9bca388c33915bb35b450b3580c5caae5c7b63ba
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon May 24 18:45:46 2004 -0700

    [PATCH] missing compat ioctl mapping for DM_REMOVE_ALL
    
    Signed-off-by: Marcus Meissner <meissner@suse.de>
    
    Added missing DM_REMOVE_ALL call.

commit 14dadb2b487e980a3362a9fa9cde0e9a950379c3
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon May 24 18:45:35 2004 -0700

    [PATCH] sched_yield() microoptimisation
    
    Signed-off-by: Ingo Molnar <mingo@elte.hu>
    
    We can avoid the local_irq_enable() in sched_yield() because schedule()
    unconditionally enables interrupts anyway.

commit 35834232fbe87e284514e6edcb91d5d4be33da49
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon May 24 18:45:24 2004 -0700

    [PATCH] sched.h comment typo fix
    
    Signed-off-by: Christian Meder <chris@onestepahead.de>
    Signed-off-by: Ingo Molnar <mingo@elte.hu>
    
    sched.h typo fix from Christian Meder.

commit c5c1e586a6bb3f2c35a0d414ce8d6829f0b3969c
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon May 24 18:45:13 2004 -0700

    [PATCH] Subject: Re: Help understanding slow down
    
    Signed-off-by: Ingo Molnar <mingo@elte.hu>
    
    Add a warning that "idle=poll" is a performance hit on hyperthreaded CPUs.

commit 6dc50ae9666e593761af61df6a1b60689c2e40a2
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon May 24 18:45:03 2004 -0700

    [PATCH] No interpretation of HD spindown timeout in laptop mode ACPI binding script.
    
    From: Bart Samwel <bart@samwel.tk>
    
    Currently the ACPI binding script in the Laptop Mode doc always says "20
    seconds" and "2 hours" for the timeouts it uses.  This is incorrect if the
    user changed the config values, so we print something more general.

commit 625ba457febfff0907828a69a3175365d96523ad
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon May 24 18:44:52 2004 -0700

    [PATCH] rmap build fix
    
    From: William Lee Irwin III <wli@holomorphy.com>
    
    PMD_SIZE is not a compile-time constant on sparc.  Use min() in there so
    that the cluster size will be evaluated at runtime if the architecture
    insists on doing that.

commit b1f5c118382ccf205a78f060310f5327fe3bd234
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon May 24 18:44:41 2004 -0700

    [PATCH] ir-kbd-gpio.c build fix
    
    It's initialising slot 24 in two places.  Gerd Knorr <kraxel@bytesex.org> says
    "This one should be 23.".

commit 4991c215a913b26995a690e29fa758e3ba021210
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon May 24 18:44:29 2004 -0700

    [PATCH] Revert bogus x86-64 change
    
    From: Andi Kleen <ak@muc.de>
    
    The 32bit generic nops added with a previous patch to x86-64 alternative()
    are not completely 64bit clean.  This caused crashes in some cases.  This
    patch reverts this broken change.

commit 5ec9222adbece389694f95cd904ccedd745f5575
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon May 24 18:44:14 2004 -0700

    [PATCH] isapnp sb16 virtual pc
    
    From: David Sanders <linux@sandersweb.net>
    
    Patch adds support for the emulated Soundblaster 16 in Virtual PC 2004.

commit 7c5488f08c081ef6f79f31e343ae28f644d42c01
Author: Ivan Kokshaysky <ink@jurassic.park.msu.ru>
Date:   Mon May 24 18:44:10 2004 -0700

    [PATCH] fix PCI bridge swizzle on takara and eiger
    
    This fixes NULL pointer dereference (bus->self) for PCI devices
    on the root bus.
    
    Ivan.

commit 245d91566bec7884548ca22af0a60a2d23503ab6
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon May 24 18:44:01 2004 -0700

    [PATCH] ext2: fix build with DEBUG=y
    
    From: FabF <fabian.frederick@skynet.be>

commit 2097f3a7da5ae7b3880f5f1a650b91fee71e5ab1
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon May 24 18:43:49 2004 -0700

    [PATCH] minor sched.c cleanup
    
    Signed-off-by: Christian Meder <chris@onestepahead.de>
    Signed-off-by: Ingo Molnar <mingo@elte.hu>
    
    The following obviously correct patch from Christian Meder simplifies the
    DELTA() define.

commit c8932afab09c2f7078d66a4a08199c429555020b
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon May 24 18:43:39 2004 -0700

    [PATCH] Really enable NUMA API on x86-64
    
    From: Andi Kleen <ak@muc.de>
    
    Really enable the NUMA API system calls on x86-64.

commit 5f633f0c239ba08d249df361074bf25d4e1df8b5
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon May 24 18:43:28 2004 -0700

    [PATCH] remap_file_pages: fix syscall declaration
    
    Signed-off-by: Hugh Dickins <hugh@veritas.com>
    
    sys_remap_file_pages is declared as asmlinkage in mm/fremap.c, but is the one
    syscall declared without asmlinkage in include/linux/syscalls.h.

commit 2c60fda2125ccd88ac80184496dbebf23f678406
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon May 24 18:43:17 2004 -0700

    [PATCH] remap_file_pages: implement MAP_POPULATE for all protections
    
    Signed-off-by: Hugh Dickins <hugh@veritas.com>
    
    It seems eccentric to implement MAP_POPULATE only on PROT_NONE mappings:
    do_mmap_pgoff is passing down prot, then sys_remap_file_pages verifies it's
    not set.  I guess that's an oversight from when we realized that the prot arg
    to sys_remap_file_pages was misdesigned.
    
    There's another oddity whose heritage is harder for me to understand, so
    please let me leave it to you: sys_remap_file_pages is declared as asmlinkage
    in mm/fremap.c, but is the one syscall declared without asmlinkage in
    include/linux/syscalls.h.

commit 5ca688341a281ea6a9f78a60ca3831c2c0642eac
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon May 24 18:43:06 2004 -0700

    [PATCH] Fix for lockup in reiserfs acl/xattrs
    
    From: Jeff Mahoney <jeffm@suse.com>
    
    The following is a patch to fix a locking problem in ACL/xattr code. It
    manifests when a user attempts to set an xattr on a file which they do
    not own, and on which an ACL is applied.
    
    What happens is this:
    reiserfs_setxattr [write lock inode xattr sem]
      ->xattr_set
        -> lookup
           -> __reiserfs_permission [if conditions above are met, and need_lock=
     is
              unset, read lock inode xattr sem] *lockup*
    
    Since we already keep track of when to lock during permission calls, the
    fix is simple: just make the locking conditional as it was before.
    
    Credits to Andreas Gruenbacher <agruen@suse.de>

commit 2804eb00ead66cf56b6c331cb20571295224d150
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon May 24 18:42:56 2004 -0700

    [PATCH] UDF: directory reading fix
    
    From: Ben Fennema <bfennema@falcon.csc.calpoly.edu>
    
    The problem occured when files were stored on the disc in 16-bit per
    character mode when all the upper bits were 0.  The fs module
    converted the file name given by the user to a 8-bit per character
    string to compare, so the comparison always failed.
    
    The patch maps the file from disc into the current locale and then
    compares it directly to the file name given by the user.

commit 85530b97ee4ac2b0e312259f62709711f6a3248b
Author: Ivan Kokshaysky <ink@jurassic.park.msu.ru>
Date:   Mon May 24 18:42:55 2004 -0700

    [PATCH] compile fix for mm/init.c
    
    Fix another page->count reference (in addition to numa.c one
    that I've sent earlier).
    
    Ivan.

commit 8c04bc342b14c2fe1689f5770954dd10c0c6ea7d
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon May 24 18:42:45 2004 -0700

    [PATCH] bk-kernel-howto reversion
    
    From: Rusty Russell <rusty@rustcorp.com.au>
    
    This one snuck through - Jeff prefers the bk:// addresses.

commit 318e2683f99cec5cc9bf1e515452fab6aae39d4b
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon May 24 18:42:34 2004 -0700

    [PATCH] CREDITS is unmaintained
    
    From: Adrian Bunk <bunk@fs.tum.de>
    
    This information seems to be quite outdated.

commit c8bfe3a133d6f9977b278bfae39a371555216ddf
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon May 24 18:42:23 2004 -0700

    [PATCH] H8/300 ne driver module fix
    
    From: Yoshinori Sato <ysato@users.sourceforge.jp>
    
    - module support fix

commit 04e9b59f87797bea9a62e384817532ac21fd4e4f
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon May 24 18:42:12 2004 -0700

    [PATCH] H8/300 module fix
    
    From: Yoshinori Sato <ysato@users.sourceforge.jp>
    
    - fix relocation
    - define SYMBOL_PREFIX

commit 4557746401a0c7e4903e55ca3ed3d6a3314acc04
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon May 24 18:42:00 2004 -0700

    [PATCH] Fix various memory leaks
    
    From: Yury Umanets <torque@ukrpost.net>
    
    Thanks to smatch I have found few memory leaks and other related issues.

commit 43b6594ed53a459f7af2159514b8e5a042c07bbc
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon May 24 18:41:49 2004 -0700

    [PATCH] v4l: use saa7111 i2c module in V4L MXB driver
    
    From: Michael Hunold <hunold@convergence.de>
    
    The attached patch changes my "Multimedia eXtension Board" (MXB)
    Video4Linux-driver to use the standard saa7111 video decoder infrastructure
    (to which I recently submitted changes through Ronald Bultje) instead of
    some home-brewn direct-access stuff.
    
    Nothing serious, but it removes code duplication and makes the code use the
    video decoder api.

commit 4ee5a98f4bfafed787e78446df551ad5ed6edaa6
Author: Ivan Kokshaysky <ink@jurassic.park.msu.ru>
Date:   Mon May 24 18:41:45 2004 -0700

    [PATCH] fix NUMA build
    
    Replace reference to page->count with page_count().
    
    Ivan.

commit 385b866c18a884d1b31811ab5d2207545ffb15ba
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon May 24 18:41:40 2004 -0700

    [PATCH] initramfs uncpio fix
    
    From: <viro@parcelfarce.linux.theplanet.co.uk>
    
    init/initramfs.c::do_skip() has an off-by-one that leads to unpacking
    failures for some gzipped cpio images.  We have
    
    static int __init do_skip(void)
    {
            if (this_header + count <= next_header) {
                    eat(count);
                    return 1;
            } else {
                    eat(next_header - this_header);
                    state = next_state;
                    return 0;
            }
    }
    
    and that <= should actually be <.  It almost never matters, since if we hit
    the boundary case (header ending exactly on the gunzip window end) the
    current variant will simply end up doing extra call of do_skip() when we
    get to the next window and that will finish the work (assign state).  The
    only exception is when we hit that in the last window.  That is, if there's
    nothing after the final header (trailer).  Then we miss the final state
    transition (Skip -> Reset) and get "junk in archive" panic.  Normally
    cpio(1) pads the image to multiple of 512, so we actually have a bunch of
    zeroes after the trailer.  And that almost always saves our butts - trailer
    is followed by zeroes, so we get to Reset state just fine.
    
    So we never see that on small in-kernel image (it's less than 512 bytes, so
    it gets a lot of padding) and we almost never see that on external ones
    (1:127 odds of hitting the bug).

commit 70c6e41ed40c8877155d6418da987210077c0d71
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon May 24 18:41:29 2004 -0700

    [PATCH] FAT: small fixes
    
    From: OGAWA Hirofumi <hirofumi@mail.parknet.co.jp>
    
    - use fat_fs_panic() instead of BUG() if it read a corrupted inode.
    
    - add missing "\n".

commit e7b1438a5924664fa1fe62a4a37019c852902809
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon May 24 18:41:18 2004 -0700

    [PATCH] swsusp: fix swsusp with intel-agp
    
    From: Pavel Machek <pavel@suse.cz>
    
    swsusp contained rather nasty bug where it killed machine when intel-agp or
    anything else split kernel 4MB mapping.  Herbert Xu diagnosed this.  Fixed by
    switching to "known good" mapping for during suspend/resume.

commit e7653a144e03bb79235d307d9da7b32e64436580
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon May 24 18:41:07 2004 -0700

    [PATCH] Don't use "cut" in laptop mode control script -- it is in /usr.
    
    From: Bart Samwel <bart@samwel.tk>
    
    We don't want to use "cut" in the laptop mode control script, because that
    is in /usr.  This patch is from Jasper Spaans.

commit d14672aa9ccc7587364db6990a678a6e7f7ab6fc
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon May 24 18:40:54 2004 -0700

    [PATCH] matroxfb: Add support for mapping CRTC<->outputs at boot time
    
    Signed-off-by: Petr Vandrovec <vandrove@vc.cvut.cz>
    
    Some people expressed interest in having possibility to set CRTC <->
    outputs mapping at boot time, without having to use 'matroxset' later after
    kernel boots.
    
    This patch adds option 'video=matroxfb:outputs:XYZ', where X sets which
    CRTC will connect to primary output, Y sets secondary output and Z sets DVI
    output.
    
    In addition to that I also added missing memset() into maven, which was
    broken since i2c was kobjectified.

commit 377cb3dee55957e03d52ecb2d720fae28b7ff5d0
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon May 24 18:40:43 2004 -0700

    [PATCH] ext3: remove duplicated ext3_std_error() call
    
    From: Andi Kleen <ak@muc.de>
    
    When start_transaction() detects an error it already calls ext3_std_error.
    No need to do it again in the caller.

commit ff49aa825f8809a096f06e21ac5722dbfc21f358
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon May 24 18:40:34 2004 -0700

    [PATCH] make i386 dma-mapping.h includeable standalone
    
    From: Christoph Hellwig <hch@lst.de>
    
    From: Debian kernel package, author probably Herbert Xu
    
    Include asm/io.h and asm/scatterlist.h in include/asm-i386/dma-mapping.h to
    make it useable standalone, which is already true for most architectures.

commit 2d5f63eba03b541b35ea473a700ad11b6ba2999d
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon May 24 18:40:22 2004 -0700

    [PATCH] befs: typo fix
    
    From: "Sergey S. Kostyliov" <rathamahata@php4.ru>
    
    Fix a typo in an error message.

commit 77f8c8015877bdd41d11354fd776000a45966139
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon May 24 18:40:12 2004 -0700

    [PATCH] include linux/selection.h for color_table in drivers/video/tgafb.c
    
    From: Christoph Hellwig <hch@lst.de>
    
    From: Debian kernel package, author probably Herbert Xu

commit d0ab1ebc68ed1cbcd6684aa8431784dcb5c954b1
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon May 24 18:40:01 2004 -0700

    [PATCH] include linux/root_dev.h for ROOT_DEV in drivers/mtd/maps/uclinux.c
    
    From: Christoph Hellwig <hch@lst.de>
    
    * Include linux/root_dev.h for ROOT_DEV in drivers/mtd/maps/uclinux.c

commit 538981e405c91d924bc3c58c88942e5005653a65
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon May 24 18:39:49 2004 -0700

    [PATCH] missing init.h in drivers/mtd/chips/sharp.c
    
    From: Christoph Hellwig <hch@lst.de>
    
    again needed by most non-x86 arches.
    
     * Include linux/init.h for __init

commit a979373197badc27c0bb8db2b5034035316baa97
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon May 24 18:39:38 2004 -0700

    [PATCH] add one more neomagic audio device id
    
    From: Christoph Hellwig <hch@lst.de>
    
    From: Mattia Monga via Debian kernel package
    
    Add support for nm256xl+ in sound/oss/nm256_audio.c

commit 1b4d4894abd600416a0656d1f6b91250581c2c4b
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon May 24 18:39:28 2004 -0700

    [PATCH] remove a dead variable from isofs
    
    From: Christoph Hellwig <hch@lst.de>
    
    From: Debian kernel package, author is probably Herbert Xu
    
     * Do not get seqno since we will not use it in fs/isofs/inode.c

commit ce683ef56705500b7128ca580cf9a72027ed6d8b
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon May 24 18:39:18 2004 -0700

    [PATCH] fix a bash-ism in toplevel Makefile
    
    From: Christoph Hellwig <hch@lst.de>
    
    From: Debian kernel package, author probably Herbert Xu.
    
     * Fixed bashism in Makefile

commit ff88d7dab61c0463d08cef5b097eaf63c5599a1e
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon May 24 18:39:07 2004 -0700

    [PATCH] befs: nls fix
    
    From: "Sergey S. Kostyliov" <rathamahata@php4.ru>
    
    Fix nls support for character sets with character width large than 1.

commit 04af400eff6ca887e1a08a37e3e9f290b0931bb3
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon May 24 18:38:57 2004 -0700

    [PATCH] hfsplus: update dir time after change
    
    From: Roman Zippel <zippel@linux-m68k.org>
    
    Update dir ctime/mtime when adding/removing an entry.

commit d4f99544e3798ec15021cc426922a424402e94c9
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon May 24 18:38:46 2004 -0700

    [PATCH] hfsplus: don't release not existing nodes
    
    From: Roman Zippel <zippel@linux-m68k.org>
    
    When releasing a page don't try to release not existing nodes.

commit 629c9ae08928eab76f27dde4c5ffe1a708ebfdfb
Author: Ivan Kokshaysky <ink@jurassic.park.msu.ru>
Date:   Mon May 24 18:38:44 2004 -0700

    [PATCH] fix system clock on ruffian
    
    Unlike most other alphas, ruffian uses i8253 timer instead of RTC
    as the system clock source. However, the PIT clock divisor (LATCH)
    is bogus since CLOCK_TICK_RATE has been changed to 32 KHz.
    Fixed using recently introduced PIT_TICK_RATE macro.
    
    Ivan.

commit 8fc4dec54b16049662c0cfb08b2cdfdc25dc9e40
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon May 24 18:38:35 2004 -0700

    [PATCH] hfsplus: completely remove half inserted catalog entry
    
    From: Roman Zippel <zippel@linux-m68k.org>
    
    If the inserting of the file or dir record failed, remove the previously
    inserted thread record.

commit d58fc33e1fb2d4c1c5a4d496b25b1f99e341e7bf
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon May 24 18:38:25 2004 -0700

    [PATCH] hfsplus: delete inode properly
    
    From: Roman Zippel <zippel@linux-m68k.org>
    
    Call hfsplus_delete_inode() to delete an inode when adding it to the
    filesystem failed, so superblock info is correctly updated.

commit 543481c967d8a75dac24d8f02c961061060ab912
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon May 24 18:38:14 2004 -0700

    [PATCH] hfsplus: correct dentry initialization for dir dentries.
    
    From: Roman Zippel <zippel@linux-m68k.org>
    
    Initialize d_fsdata field also for dir dentries, use hfsplus_instantiate
    helper function for this.

commit 9a57bb39378c4942dac015682f7c28473343935d
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon May 24 18:38:04 2004 -0700

    [PATCH] hfsplus: fix key length for index nodes
    
    From: Roman Zippel <zippel@linux-m68k.org>
    
    Use the correct key length for index nodes.

commit e00d79e4e3d6a8aa323c4ffc798de0c782a1bc79
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon May 24 18:37:53 2004 -0700

    [PATCH] Decrease srtuct file size by 8
    
    From: Kurt Garloff <garloff@suse.de>
    
    Attached patch decreases the size of struct file by 8 bytes on 64 bit arches
    by avoiding unecessary padding.

commit f74742d3963ca022e69a745b259d46cb723f42e7
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon May 24 18:37:44 2004 -0700

    [PATCH] remove stale comments above struct page
    
    From: Christoph Hellwig <hch@lst.de>
    
    struct page easily fits into a single cacheline with any recent CPU, and the
    ordering isn't as described anymore anyway.

commit 8a7f19c7b1554bdbaaef209f5b077380273b0e2a
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon May 24 18:37:33 2004 -0700

    [PATCH] don't export vma_prio_tree_next
    
    From: Christoph Hellwig <hch@lst.de>
    
    there's no user is modules, the function isn't in mainline and I don't see why
    modules should use it.

commit 8e56790b8b07263f9ac3e319ce848df1d1ef932f
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon May 24 18:37:14 2004 -0700

    [PATCH] Fix race condition with current->group_info
    
    From: Olaf Kirch <okir@suse.de>
    
    I have been chasing a corruption of current->group_info on PPC during NFS
    stress tests.  The problem seems to be that nfsd is messing with its
    group_info quite a bit, while some monitoring processes look at
    /proc/<pid>/status and do a get_group_info/put_group_info without any locking.
    
    This problem can be reproduced on ppc platforms within a few seconds if you
    generate some NFS load and do a "cat /proc/XXX/status" of an nfsd thread in a
    tight loop.
    
    I therefore think changes to current->group_info, and querying it from a
    different process, needs to be protected using the task_lock.
    
    (akpm: task->group_info here is safe against exit() because the task holds a
    ref on group_info which is released in __put_task_struct, and the /proc file
    has a ref on the task_struct).

commit af57e8aee0df5cf87e036f018ce3d0d24b2675c3
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon May 24 18:36:57 2004 -0700

    [PATCH] ep_send_events() stack reduction
    
    ep_send_events() uses ~350 bytes of stack for a local buffer of events to send
    to userspace.  The patch fixes that by removing the double-buffering
    altogether.  A pipe-based microbenchmark from Davide Libenzi
    <davidel@xmailserver.org> was sped up by 1-2%.

commit c570d66770cfaf169ba91e43f6243ddbac8efd73
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon May 24 18:36:46 2004 -0700

    [PATCH] Fix the mangled-oops-output-on-SMP problem
    
    From: Ingo Molnar <mingo@elte.hu>
    
    printk currently does
    
    	if (oops_in_progres)
    		bust_printk_locks();
    
    which means that once we oops, the printk locking is 100% ineffective and
    multiple CPUs make an unreadable mess on a serial console.  It's a significant
    development hassle.
    
    Fix that up by only popping locks once per ten seconds.
    
    akpm@osdl.org did:
    
      - Bump the timeout to 30 seconds - 9600 baud is slow.
    
      - Handle jiffy wraps: change the logic so that we only skip the lockbust
        if the current time is within 30 seconds of the previous lockbusting
        attempt.

commit ed8d9961f3c411b5b3ab2a673e66bfc01827a46b
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon May 24 18:36:31 2004 -0700

    [PATCH] Prevent scary warnings from knfsd
    
    From: "J. Bruce Fields" <bfields@fieldses.org>
    
    The kernel currently prints:
    
     nfsd: nobody listening for auth.unix.ip upcall; has some daemon not been started?
    
    on every bootup, during initscripts.
    
    Neil Brown <neilb@cse.unsw.edu.au> says:
    
      It was part of the recent set of idmapper patches.  Bruce wanted the admin
      to get a warning when the idmapper daemon wasn't running.  I thought the
      same warning should apply to any daemon that responded to upcalls.
    
      In the case of auth.unix.ip it isn't strictly necessary for a daemon to be
      running (for comparability with 2.4).
    
      You can get rid of the warning by doing:
    
        mount -t nfsd nfsd /proc/fs/nfs
    
      before mountd is started (init scripts should start doing this I hope, but
      distributions don't tend to use the init script from nfs-utils, so it is
      hard to push it).  This will trigger mountd to listen on auth.unix.ip and
      others.
    
    
    That's a hassle, so Bruce's patch limits the warning purely to the new
    idmapper cache.  It provides a callback in the cache_detail that individual
    caches can use to log messages when upcalls fail because a userspace daemon
    not running.  Implement this method for the idmapping caches.

commit 7190b86d8c48217c158dae34dff754a953381197
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon May 24 18:36:18 2004 -0700

    [PATCH] Fix userspace include of linux/fs.h
    
    From: Mans Rullgard <mru@kth.se>
    
    There are a few include which should have been under __KERNEL__.

commit 4f527e6a4f09922579303577f6fdd52d9e041691
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon May 24 18:36:02 2004 -0700

    [PATCH] use SLAB_PANIC in ll_rw_blk.c

commit a5d436c4dfeff1cf15efa5bbb17271727be55102
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon May 24 18:35:48 2004 -0700

    [PATCH] ppc64: avoid bogus real IRQ numbers
    
    Signed-off-by: Paul Mackerras <paulus@samba.org>
    
    Early in the boot process on pSeries machines, we look in the Open Firmware
    device tree for information about the interrupt assignments, and assign
    virtual IRQ numbers for each physical IRQ.  There is currently a couple of
    bugs in this code which result in us assigning virtual IRQs for nonexistent
    physical IRQs.  This causes problems when we call the firmware to enable or
    disable those nonexistent physical IRQs.  Some versions at least of the
    firmware will hit an assertion failure and crash the machine when this
    happens.
    
    This patch fixes the bugs and ensures that we don't try and use nonexistent
    physical IRQ numbers.  One bug was that we were mapping ISA interrupts,
    which is unnecessary since virtual IRQ numbers 0 - 15 are reserved for
    them.  The other was that when we had a PCI interrupt (which is always in
    the range 1 to 4, corresponding to INTA to INTD) which didn't have a
    mapping in the PCI host bridge above it, we were just using the original
    number (usually 1) rather than ignoring it.

commit 1c7481042ac10ef187e308a54aeb85a4487c87eb
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon May 24 18:35:31 2004 -0700

    [PATCH] ppc64: bump IOMMU_MAX_ORDER
    
    Signed-off-by: Anton Blanchard <anton@samba.org>
    
    We have cards that want over 2MB of PCI consistent memory.  The
    IOMAP_MAX_ORDER limit is just to catch bad drivers early, so we can bump
    this a bit.
    
    We want some room to grow but our maximum get_free_pages allocation on
    ppc64 is currently 16MB, so it doesnt make sense to go above that.

commit 18f883b60005fe5da08ce194c1855a5c3f14c502
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon May 24 18:35:13 2004 -0700

    [PATCH] ppc64: small enter_rtas fix
    
    From: Anton Blanchard <anton@samba.org>
    
    enter_rtas now takes an unsigned long.

commit b086c8a35e48197eb93b85b82e238506111d3556
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon May 24 18:34:57 2004 -0700

    [PATCH] dynamic addition of virtual disks on PPC64 iSeries
    
    From: Stephen Rothwell <sfr@canb.auug.org.au>
    
    This patch allows us to dynamically add virtual disks to an iSeries partition.
     It works like this: after you have created the virtual disk file on OS/400
    and attached it to the Linux partition, you need to write to
    /sys/bus/vio/drivers/viodasd/probe (it doesn't matter what you write).  This
    will do the probe.  It calls add_disk() for each new disk, so we get hotplug
    events as a side effect.
    
    This was the nicest way I could think of doing this as the interface to the
    hypervisor is polled ...

commit bb0d09273629785b6ae1dfd19b85bac90c333e89
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon May 24 18:34:44 2004 -0700

    [PATCH] ppc64: fix to viopath.c
    
    From: Anton Blanchard <anton@samba.org>
    
    From: Olaf Hering and Nathan Lynch:
    
    Fix a couple of nasty lurking bugs in viopath.c and add information
    required to know if the iseries_veth module should be loaded on legacy
    iSeries systems.

commit 55d130a515cbe09a39b103b5202df6cb40f02e0f
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon May 24 18:34:35 2004 -0700

    [PATCH] ppc64: NUMA fixes
    
    From: Anton Blanchard <anton@samba.org>
    
    From: Anton Blanchard, Dave Hansen and Olof Johansson:
    
    Fix multiple bugs in the ppc64 NUMA topology probe code.
    
    - We were using HW cpu numbers instead of logical ones.  615, 630, 650,
      some 670 and some 690 SMP will all fail to boot without this patch.
    
    - The old code would BUG() when it got confused (more NUMA zones than the
      kernel is configured for etc).
    
    - The common depth calculation was incorrect.  Dave found an OF property
      that gives us exactly what we want.
    
    - Things were broken on SMT machines.
    
    The new code should work on those broken systems and should no longer BUG()
    but fall back to a flat topology when it gets confused.

commit 2c72518874e35cfd32aba05a7609cf8c74729197
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon May 24 18:34:24 2004 -0700

    [PATCH] ppc64: fix inline spinlocks
    
    From: Anton Blanchard <anton@samba.org>
    
    In _raw_spin_lock_flags we were branching to the wrong spot and would
    restore random stuff to the MSR.

commit 4b796a9f6d47f9a70854de9275877760a8f2170c
Author: Dave Jones <davej@redhat.com>
Date:   Mon May 24 18:05:12 2004 -0700

    [PATCH] Make early_cpu_detect() set x86_cache_alignment on pre-cpuid CPU's too
    
    From: Zdenek Pavlas <pavlas@nextra.cz>
    
    On any x86 without cpuid, early_cpu_detect() left x86_cache_alignment as
    zero, so kmem_cache_init() calls cache_estimate() with align == 0, and
    it loops forever. I've tried this trivial fix, and it works for me.
    
    Andi Kleen looked over this, and ok'd it.

commit 2eb9a24d74e8e9d6aeec39758aa9ea9bb9a58881
Author: Dave Jones <davej@redhat.com>
Date:   Tue May 25 00:06:20 2004 +0100

    [CPUFREQ] Scaling on VIA C3 Nehemiah works now.
    So remove the warning printk.

commit 5768f143072855298bf3b4c41097b4e980719530
Author: Dave Jones <davej@redhat.com>
Date:   Tue May 25 00:03:26 2004 +0100

    [CPUFREQ] Make longhaul debug a module option.

commit 78b17ed07238c6c26e967efa883584d5a949588d
Author: Dave Jones <davej@redhat.com>
Date:   Mon May 24 23:39:03 2004 +0100

    [CPUFREQ] Fix leak in powernow-k8
    Spotted by Yury Umanets

commit d75801fd3f9433c1567975838e62c47b4daa4281
Author: Dave Jones <davej@redhat.com>
Date:   Mon May 24 23:29:57 2004 +0100

    [CPUFREQ] Remove a bunch of trailing whitespace from the powernow-k8 driver.

commit 3c892fff03afaa42c6215bf6f2a480ae42d51aac
Author: Dave Jones <davej@redhat.com>
Date:   Mon May 24 23:20:35 2004 +0100

    [CPUFREQ] Quieten the powernow-k7 init printk a little.
    There seem to be quite a few desktop K7 processors which support the
    powernow cpuid call, but don't actually offer any powernow scaling.
    In which case the driver prints out
    "PowerNOW! Technology present. Can scale: nothing" which looks a bit odd,
    and just adds to confusion of end-users.
    Change things so that we don't print anything at all if we can't do anything.
    
    Also kill some trailing whitespace gremlins that crept in.

commit a936d500bd22453d994ecd276e9c0d89eed5ae85
Author: Dave Jones <davej@redhat.com>
Date:   Mon May 24 23:12:04 2004 +0100

    [CPUFREQ] Use correct printk prefix in p4-clockmod driver

commit 32f20199a678f33196286b54ee93daddfa7e6ffa
Author: Dave Jones <davej@redhat.com>
Date:   Mon May 24 23:09:12 2004 +0100

    [CPUFREQ] Remove some unneeded includes.

commit bea1ff66840dc46d1becd14f1741a76704fa6d81
Author: Dave Jones <davej@redhat.com>
Date:   Mon May 24 23:06:38 2004 +0100

    [CPUFREQ] Convert longhaul driver to use module_param

commit 395fe70375f73e7eb67107ae13df3727c7770b49
Merge: c72113b... de41da3...
Author: Nathan Scott <nathans@sgi.com>
Date:   Tue May 25 07:39:19 2004 +1000

    Merge sgi.com:/source2/linux-2.6 into sgi.com:/source2/xfs-linux-2.6

commit f051a69f8d2a54d57b4f069b582b5fdfad7abb99
Author: Steve French <stevef@smfhome.smfdom>
Date:   Mon May 24 14:13:22 2004 -0500

    Retry build_path_from_dentry if parent path changes in flight

commit 40474c4429dcbe9374a4d5a269afb182f72d320a
Author: Steve French <stevef@smfhome.smfdom>
Date:   Mon May 24 13:58:35 2004 -0500

    check for close pending and invalid file struct on writing out page

commit ec9b2be054608e64a1ec12cf50dfeaad4ce077ff
Author: Steve French <stevef@smfhome1.smfsambadom>
Date:   Mon May 24 09:51:38 2004 -0500

    Fix incorrect file size on handle based setattr (for big endian hardware)

commit ffcb6060a221e99d978aa2f8687bbddf60a7a5fb
Merge: 7bcc67f... 68da1c2...
Author: Anton Altaparmakov <aia21@cantab.net>
Date:   Mon May 24 12:28:15 2004 +0100

    Merge cantab.net:/home/src/bklinux-2.6
    into cantab.net:/home/src/ntfs-2.6

commit 14bc28ad32eb052c169dc2035cd1cffd80138bad
Author: Paul Mackerras <paulus@samba.org>
Date:   Mon May 24 03:19:59 2004 -0700

    [PATCH] ppc64: better stack traces
    
    This improves the stack traces we get on PPC64 by putting a marker in
    those stack frames that are created as a result of an interrupt or
    exception.  The marker is "regshere" (0x7265677368657265).
    
    With this, stack traces show where exceptions have occurred, which can
    be very useful.  This also improves the accuracy of the trace because
    the relevant return address can be in the link register at the time of
    the exception rather than on the stack.  We now print the PC and
    exception type for each exception frame, and then the link register if
    appropriate as the next item in the trace.

commit 8639d2a40c9b441a646d7dadcbe5286e65d86f1a
Author: Thomas Wahrenbruch <thomas.wahrenbruch@kobil.com>
Date:   Mon May 24 03:06:48 2004 -0700

    [PATCH] USB: Fix kobil_sct with uhci
    
    the kobil_sct didn't work with uhci hcds.
    It used usb_fill_bulk_urb instead of usb_fill_int_urb.
    The attached patch fixes this.
    
    It starts reading in open now - this gives apps (CT-API) the chance to
    detect the p'n'p string correctly.

commit f1022df9eed639ea6d77aa8adea4eb931ce6511f
Author: Mordechai Ovits <movits@bloomberg.com>
Date:   Mon May 24 03:06:06 2004 -0700

    [PATCH] USB: add support for MS adapter to usb pegasus net driver
    
    I took the relevant parts from the patch (not some PHY stuff that was
    irrelevant).  Attached is the patch against stock 2.6.6.

commit e6f3d6a3d6f24dbff2311acb068ade768394e7e3
Author: David Brownell <david-b@pacbell.net>
Date:   Mon May 24 03:05:26 2004 -0700

    [PATCH] USB: PXA 2xx UDC and RNDIS g_ether
    
    I noticed some problems with the PXA 2xx UDC and the
    RNDIS version of the ethernet-over-usb link:
    
      - Static linking needs more than just two endpoints now
    
      - The endpoint autoconfig misbehaves (sounds like what
        Stefan reported a couple weeks ago)
    
    This patch fixes those two problems, though there are
    a couple others lurking too.

commit 7234f3cbc0f243a8d9b901dcff67a5ef470ad9f9
Author: Luiz Capitulino <lcapitulino@prefeitura.sp.gov.br>
Date:   Mon May 24 03:04:38 2004 -0700

    [PATCH] USB: /usb/gadget/serial.c warning fix.
    
     that code is generating the fallowing warning:
    
    drivers/usb/gadget/serial.c:162: warning: `debug' defined but not used
    
     When G_SERIAL_DEBUG is not defined, `debug' is not used, because
    the gs_debug() function is compiled only when G_SERIAL_DEBUG is
    defined.
    
     Thus, a solution is to define `debug' only when G_SERIAL_DEBUG
    is defined. That includes the use of `debug' as a module parameter
    (this last part I'm not sure).
    
     The patch bellow does that (compiles ok, not tested because I don't
    have that hardware):

commit 461b6851066f4c42dccbdb4c5da29e253af9a9c3
Author: Oliver Neukum <oliver@neukum.org>
Date:   Mon May 24 03:03:52 2004 -0700

    [PATCH] USB: fix fix to kaweth.c
    
    the previous patch was buggy. The state must be set _before_ the
    condition is checked, or there's a window missing a wakeup.
    This incremental change set fixes that.
    
      - fix race condition with current->state

commit b0eef108cd9c2b1b4b1350d28d750a1ab13298a2
Author: Oliver Neukum <oliver@neukum.org>
Date:   Mon May 24 03:03:19 2004 -0700

    [PATCH] USB: waitqueue related problem in kaweth
    
    this was buggy for the same reason that the old msleep was buggy.
    
      - safe waiting in case we are left on other wait queues

commit 662be4ac3bdf670cb1655daa19394533db7732cc
Author: Oliver Neukum <oliver@neukum.org>
Date:   Mon May 24 03:02:47 2004 -0700

    [PATCH] USB: yet another place for msleep
    
    this is in kobil_sct.
    It uses msleep() and replaces needless GFP_ATOMICs with GFP_NOIO
    as this function can sleep.
    
      - no need for GFP_ATOMIC
      - use msleep()

commit 1a9461b68968774359e66d4395997fe64782231a
Author: Oliver Neukum <oliver@neukum.org>
Date:   Mon May 24 03:02:10 2004 -0700

    [PATCH] USB: clean delays for ehci
    
    Here's one you overlooked.
    
      - safe sleep helper

commit 83d55856eed7880c99c90e4e542d382de763637e
Author: Martin Habets <errandir_news@mph.eclipse.co.uk>
Date:   Mon May 24 03:01:41 2004 -0700

    [PATCH] USB: usblp printer GET_DEVICE_ID fix
    
    There is a problem in the usblp GET_DEVICE_ID ioctl() implementation. The patch
    below (against 2.6 current) fixes the code to be according to the official usb
    printer spec.
    
    Most printers are not affected by this fix, as they use interface 0 and
    alternate 0. For those, nothing changes. But my printer/scanner uses interface
    1 for the printer.

commit e1ff5fe002c31271c2398bf5eb38fa62e0c67cad
Merge: 91d7f4e... 9878e2f...
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Mon May 24 02:41:46 2004 -0700

    Merge bk://bk.arm.linux.org.uk/linux-2.6-rmk
    into ppc970.osdl.org:/home/torvalds/v2.6/linux

commit 9878e2f8581c1cca1cb917258558d4fe563b1990
Author: Russell King <rmk@flint.arm.linux.org.uk>
Date:   Tue May 25 01:14:52 2004 +0100

    [ARM] pxa2xx_udc needs asm/mach-types.h

commit 40878b17d9f3056ba860a1f51d74b42d75bb9a07
Author: Russell King <rmk@flint.arm.linux.org.uk>
Date:   Tue May 25 00:42:29 2004 +0100

    [ARM] Fix lubbock PCMCIA driver.
    
    - access SA1111 GPIO using sa1111_set_io functions.
    - access Lubbock misc register using lubbock_set_misc_wr
    - fix CF voltage selection.
    - don't fiddle with PCMCIA voltage selection when selecting CF
      voltage.
    - wait for the voltage switches to stabilise before reading the
      new card state.

commit 7f0f8627a910ed0fa51fa6ead3d47b89b6440b3d
Author: Russell King <rmk@flint.arm.linux.org.uk>
Date:   Mon May 24 19:29:49 2004 +0100

    [ARM] Don't reference __machine_arch_type directly.

commit 00ab95b491cfa850d2788015baa885ac85490200
Author: Ian Campbell <icampbell@com.rmk.(none)>
Date:   Mon May 24 19:18:24 2004 +0100

    [ARM PATCH] 1893/1: define __ARCH_WANT_SYS_PAUSE for ARM
    
    Patch from Ian Campbell
    
    The recent changeset "Sanitise handling of unneeded syscall stubs" missed
    
    __ARCH_WANT_SYS_PAUSE from include/asm-arm/unistd.h.

commit 33b347e09becb3ea3f09d0e8d8a92f6d437178e4
Author: Russell King <rmk@flint.arm.linux.org.uk>
Date:   Mon May 24 19:14:00 2004 +0100

    [ARM] Remove needless include of asm/mach-types.h

commit 8b2cd4219c143c9ea831c079234d399590e58a42
Author: Russell King <rmk@flint.arm.linux.org.uk>
Date:   Mon May 24 15:16:26 2004 +0100

    [ARM] Enable IRQs over context switches
    
    Disabling IRQs over context switches causes unreasonable IRQ latency
    on VIVT cached machines, so provide our own prepare_arch_switch(),
    finish_arch_switch() and task_running() implementations.  We provide
    an optimised UP version so we don't end up needlessly incrementing
    and decrementing the preempt count.

commit fe9f64b3aec2fe9e336f85e88dd991d1ea7ec5ce
Author: Russell King <rmk@flint.arm.linux.org.uk>
Date:   Mon May 24 14:17:09 2004 +0100

    [ARM] Fix sorting of machine class symbols.
    
    These are supposed to be ordered by option name.

commit 8abe04b07f88bce694b2d06d4ecf9a319af4a1ef
Author: Herbert Xu <herbert@gondor.apana.org.au>
Date:   Sun May 23 20:15:43 2004 -0700

    [IPSEC]: Use add_timer in find_acq.

commit 6ee9ceee6f8dcfeb49b486a650219d4b03bb3f69
Author: Herbert Xu <herbert@gondor.apana.org.au>
Date:   Sun May 23 20:13:27 2004 -0700

    [IPSEC]: Fix OOPS when deleting an ip address.
    
    Looks like I was too hasty in blaming myself :) Although my patch does
    fix a real bug, it cannot have been responsible for the crash that the OP
    reported.  The reason is that the state timer always keeps a reference to
    the state so even if it is incorrectly re-added the reference will prevent
    the crash.
    
    Hence the problem is still a bug in the ref counting.  I think I've found
    the real culprit now.  __xfrm?_find_acq() is missing an xfrm_state_hold
    on the create path.  This also explains why I never see it myself since
    Openswan never creates states through that code-path.

commit 3bc275e92c029c95a6d860d69cd92a7b1c23a8a3
Author: Meelis Roos <mroos@linux.ee>
Date:   Sun May 23 20:09:27 2004 -0700

    [SPARC64]: Make 32 CPUs the default.

commit de7888b63e695da98b46d098f5c76b923e492e94
Author: Russell King <rmk@flint.arm.linux.org.uk>
Date:   Mon May 24 02:34:23 2004 +0100

    [ARM] Remove old static GPIO port definitions for SA1111.
    
    Using these old definitions on PXA will result in randomly
    scribbling over memory.  Remove them.

commit 91d7f4e3a95e62455715a355b7be81175d2018ac
Merge: 3c65bcb... be4284e...
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Sun May 23 18:26:05 2004 -0700

    Merge http://linux-sound.bkbits.net/linux-sound
    into ppc970.osdl.org:/home/torvalds/v2.6/linux

commit be4284e3a038c6d4476cf841601658321fe4c764
Author: James Bottomley <james.bottomley@steeleye.com>
Date:   Sun May 23 18:20:03 2004 -0700

    [PATCH] pa-risc: kernel/fork.c broken by the new rmap
    
    Any architecture (like pa-risc) that makes use of the helper function
    flush_dcache_mmap_lock() won't compile with the new rmap due to use of
    the wrong "mapping".
    
    Trivial fix.

commit dcde1f6f9ce968fe453ea5c2da81408b17a6f551
Merge: 68da1c2... 6156153...
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Sun May 23 18:16:24 2004 -0700

    Merge bk://linux-scsi.bkbits.net/scsi-for-linus-2.6
    into ppc970.osdl.org:/home/torvalds/v2.6/linux

commit 9d68fc87519b49b9e2a8557a837ec0b3aa9defac
Author: Russell King <rmk@flint.arm.linux.org.uk>
Date:   Mon May 24 02:09:54 2004 +0100

    [ARM] PXAFB bug fixes
    
    - There are only 16 entries in the pseudo palette
    - For dual-panel displays, we need to halve the display height
    - When disabling the LCD controller, use LCCR0_DIS (aka slow disable)
      rather than quick disable.
    - Clean up compiler warnings.

commit ed621f4baeaaa0d4780c5b4ea06267732a7ffca6
Author: Russell King <rmk@flint.arm.linux.org.uk>
Date:   Mon May 24 01:52:39 2004 +0100

    [ARM] Remove SA1111 PS/2 IRQ_HANDLED handling.
    
    Some SA1111 devices are unable to clear the PS/2 receive IRQ before
    it has been serviced, so we always re-enter the handler one more
    time than is strictly necessary.  We can't clear the IRQ after
    servicing because that causes race conditions with other SA1111
    devices, so we take the easy option and always return IRQ_HANDLED.

commit 1bd553f9fcfb9a5b0cc029c0b6d6db5a00a490c1
Author: Russell King <rmk@flint.arm.linux.org.uk>
Date:   Mon May 24 01:41:39 2004 +0100

    [ARM] Update PXA serial driver.
    
    - Move CKEN manipulation into power management handling (so we don't
      shut down the clock to the console port.)
    - .iotype should be using UPIO_xxx not SERIAL_IO_xxx
    - Remove each port when module is unloaded.
    - Remove needless #include.
    - Remove ASYNC_SKIP_TEST - we don't have any tests to skip.

commit 854ec72270952c5a4dbf3d2a2dc10488ac242239
Author: Russell King <rmk@flint.arm.linux.org.uk>
Date:   Mon May 24 01:29:13 2004 +0100

    [ARM] Add LCD display parameters for Lubbock board.

commit 87beab86db18db166dc1a651e69de74267213540
Author: Russell King <rmk@flint.arm.linux.org.uk>
Date:   Mon May 24 01:23:59 2004 +0100

    [ARM] Add lubbock_set_misc_wr()
    
    This provides an atomic method to update the Lubbock board specific
    register from various drivers.

commit f827cb0a611218c54e5cb9de05b63ff8fe793c31
Author: Russell King <rmk@flint.arm.linux.org.uk>
Date:   Mon May 24 00:06:28 2004 +0100

    [ARM] Provide coherent_dma_mask for PXA MCI device.

commit 9f6ea3542fd4e81397d9aebc019c0dd02dad322f
Author: Russell King <rmk@flint.arm.linux.org.uk>
Date:   Sun May 23 23:56:17 2004 +0100

    [ARM] Fix oops in dma_unmap_single()
    
    Fix an oops caused by a missing failure return value for devices which
    do not require DMA bouncing.

commit 0a032839ccae3d14c34dc709fbcdc0f524fb00c0
Author: Dave Jones <davej@redhat.com>
Date:   Sun May 23 17:24:28 2004 +0100

    [CPUFREQ] Silence noisy debugging printk in longhaul driver.

commit ca09bcc9bf5f1021f1b7a477677180c8d8a347f9
Author: Marcel Holtmann <marcel@holtmann.org>
Date:   Sun May 23 17:43:34 2004 +0200

    [Bluetooth] Define .kobj.k_name for the fake device
    
    The PCMCIA devices are not devices for the kernel and the bt3c_cs
    driver uses a fake device for calling request_firmware(). The fake
    device initialization must also set .kobj.k_name to prevent an oops
    until PCMCIA devices are fully integrated into the driver model.

commit f1b6caac9025ab9d01c6b1ed418037ab7f14b92d
Author: Marcel Holtmann <marcel@holtmann.org>
Date:   Sun May 23 17:31:00 2004 +0200

    [Bluetooth] Use try_module_get() for RFCOMM sessions
    
    It is not possible to use __module_get() when adding a new RFCOMM
    session, because there is a case where no reference count is hold.
    This happens when the module is not in use right now and an incoming
    connection occurs.

commit 6d997c66376b0ff46977519df434206747da3e98
Author: Dave Jones <davej@redhat.com>
Date:   Sun May 23 15:02:45 2004 +0100

    [AGPGART] Fix a potential leak in intel driver.
    It's not leaking anything currently, as agp_alloc_bridge() doesn't do any
    actual allocations right now, but if/when things get changed to support
    multiple bridges, these error paths need to free up the allocation.

commit 1a275257729f09ccdfd604f62a345ac5e1fc6ae5
Author: Dave Jones <davej@redhat.com>
Date:   Sun May 23 14:38:50 2004 +0100

    [AGPGART] Add ID for Intel E7501 chipset.

commit 68da1c2a7a0147665739aa4657730abddc57d00f
Merge: 9c2d00e... a733600...
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Sun May 23 05:54:19 2004 -0700

    Merge bk://bk.arm.linux.org.uk/linux-2.6-pcmcia
    into ppc970.osdl.org:/home/torvalds/v2.6/linux

commit 3c65bcbbfdebee6372ad34771a8fc94d628d8408
Author: Jaroslav Kysela <perex@suse.cz>
Date:   Sun May 23 14:22:27 2004 +0200

    ALSA CVS update - Jaroslav Kysela <perex@suse.cz>
    PCM Midlevel,ALSA Core
    Added SNDRV_PCM_SYNC_PTR_APPL and SNDRV_PCM_SYNC_PTR_AVAIL_MIN extensions
    to SYNC_PTR ioctl for PCM API.

commit 2b38ae751eeef2faa6193cdcae6be01c7ad8def3
Author: Jaroslav Kysela <perex@suse.cz>
Date:   Sun May 23 14:22:01 2004 +0200

    ALSA CVS update - Takashi Iwai <tiwai@suse.de>
    VIA82xx driver
    - added the DXS entry for ECS K7VTA3 v8.0
    - fixed the DXS entry for ASUS A7V8X to NO_VRA.

commit c71e1496af8a13506b68d5a632a75eaf2b9bd47b
Author: Jaroslav Kysela <perex@suse.cz>
Date:   Sun May 23 14:21:22 2004 +0200

    ALSA CVS update - Takashi Iwai <tiwai@suse.de>
    ALSA Core
    added reverse selections of components to CONFIG_SND_BIT32_EMUL.

commit 0348756acaed428686a447bd8a80318d7aaa0826
Author: Jaroslav Kysela <perex@suse.cz>
Date:   Sun May 23 14:14:09 2004 +0200

    ALSA CVS update - Takashi Iwai <tiwai@suse.de>
    PCI drivers,ICE1712 driver,ICE1724 driver
    - improved the description of ice1724 driver on Kconfig.
    - better support of VT1720 with snd-ice1724 driver.
    - check PCI subsystem IDs when no EEPROM is available (ice1724 only)
    - change the driver name string if given in the board list.
    - merged prodigy 7.1 support into aureon.c.  they are almost identical.
    - allow to use PDMA4 and RMDA1 for non-SPDIF purpose if specified (ice1724 only).

commit 7bcc67f848b36227885dcdff976ec98ed57ffc99
Merge: 5596f50... 8604270...
Author: Anton Altaparmakov <aia21@cantab.net>
Date:   Sun May 23 11:43:51 2004 +0100

    Merge cantab.net:/home/src/bklinux-2.6
    into cantab.net:/home/src/ntfs-2.6

commit 9c2d00e7de0d98cc9b5974006a28bbf208067b10
Author: Vadim Lobanov <vadim@cs.washington.edu>
Date:   Sun May 23 02:19:28 2004 -0700

    [NET]: Save some space with sysfs strings.

commit 8fc644706b2c5f5f50bacc95ba5b5ad4fa016f67
Merge: c72113b... ca09bcc...
Author: David S. Miller <davem@nuts.davemloft.net>
Date:   Sun May 23 02:13:00 2004 -0700

    Merge http://linux-mh.bkbits.net/bluetooth-2.6
    into nuts.davemloft.net:/disk1/BK/net-2.6

commit 615615389078b56fef986e69e26470aa899386b6
Author: Brian King <brking@us.ibm.com>
Date:   Sun May 23 01:44:28 2004 -0500

    [PATCH] ipr driver version 2.0.7
    
    Bump driver version

commit 48947380f08a2193bdcc87a2c7501092df72dacd
Author: Brian King <brking@us.ibm.com>
Date:   Sun May 23 01:37:37 2004 -0500

    [PATCH] ipr remove anonymous unions for gcc 2.95
    
    This patch removes all usage of anonymous unions from the ipr
    driver since gcc 2.95 does not support anonymous unions.

commit 943d7b0ae200b729ff6c59ce0ef51e05014468c2
Author: Brian King <brking@us.ibm.com>
Date:   Sun May 23 01:25:01 2004 -0500

    [PATCH] ipr fix for ioa reset timeout oops
    
    This patch fixes an oops discovered in test which can occur
    on bad hardware if the ipr adapter times out coming operational.

commit 8b6ab6a944fef129fbb583f2a8985625c0cfd9d2
Author: Brian King <brking@us.ibm.com>
Date:   Sun May 23 01:22:07 2004 -0500

    [PATCH] ipr add error logs to abort and reset paths
    
    This patch adds additional error logging to abort, device reset,
    and bus reset paths to help in diagnosing scsi problems on ipr.

commit f8e85c6330b695205b46ec058f7b76a22012c82b
Author: Brian King <brking@us.ibm.com>
Date:   Sun May 23 01:19:21 2004 -0500

    [PATCH] ipr gcc attributes fixes
    
    This patch fixes an issue where ipr was including a kernel
    data structure, list_head, in a packed structure, which causes
    compile issues on some architectures, and is just a bad thing to do.

commit f59da63169ec06c3f50fdc43c9f3b6798dec2e54
Author: James Bottomley <jejb@mulgrave.(none)>
Date:   Sun May 23 01:17:44 2004 -0500

    initial 2.6 fixup for ATP870U scsi
    
    From: 	Alan Cox <alan@redhat.com>
    
    Pretty minimal. queue_command is now called locked, this requires propogating
    some small locking changes for send_s870

commit c72113b5b7314d72a2238966d4df48f638a4fa87
Author: Alexander Viro <viro@parcelfarce.linux.theplanet.co.uk>
Date:   Sat May 22 22:22:09 2004 -0700

    [PATCH] ncpfs compat ioctls
    
    This takes ncpfs ioctl handling into fs/compat_ioctl.c, removing it from
    ppc64 and sparc64 code.
    
    Code sanitized, switched to compat_alloc_user_space(), bunch of
    {k,v}malloc() killed.

commit 5cb3428947383fb6cbcb0445d847638f1346692b
Author: Steve French <stevef@smfhome1.smfsambadom>
Date:   Sat May 22 13:20:38 2004 -0500

    fix oops in heavy stress test caused by lack of check for bad dentry being passed in on reconnect

commit 8604270709747bdac2f7212c8d4b16e6a8ae03dc
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Sat May 22 08:46:07 2004 -0700

    Linux 2.6.7-rc1

commit ce34221ee271c07599f4e69141532c695b5847ad
Author: Roland McGrath <roland@redhat.com>
Date:   Sat May 22 08:26:09 2004 -0700

    [PATCH] bogus sigaltstack calls by rt_sigreturn
    
    There is a longstanding bug in the rt_sigreturn system call.
    This exists in both 2.4 and 2.6, and for almost every platform.
    
    I am referring to this code in sys_rt_sigreturn (arch/i386/kernel/signal.c):
    
    	if (__copy_from_user(&st, &frame->uc.uc_stack, sizeof(st)))
    		goto badframe;
    	/* It is more difficult to avoid calling this function than to
    	   call it and ignore errors.  */
    	/*
    	 * THIS CANNOT WORK! "&st" is a kernel address, and "do_sigaltstack()"
    	 * takes a user address (and verifies that it is a user address). End
    	 * result: it does exactly _nothing_.
    	 */
    	do_sigaltstack(&st, NULL, regs->esp);
    
    As the comment says, this is bogus.  On vanilla i386 kernels, this is just
    harmlessly stupid--do_sigaltstack always does nothing and returns -EFAULT.
    
    However this code actually bites users on kernels using Ingo Molnar's 4G/4G
    address space layout changes.  There some kernel stack address might very
    well be a lovely and readable user address as well.  When that happens, we
    make a sigaltstack call with some random buffer, and then the fun begins.
    
    To my knowledge, this has produced trouble in the real world only for 4G
    i386 kernels (RHEL and Fedora "hugemem" kernels) on machines that actually
    have several GB of physical memory (and in programs that are actually using
    sigaltstack and handling a lot of signals).  However, the same clearly
    broken code has been blindly copied to most other architecture ports, and
    off hand I don't know the address space details of any other well enough to
    know if real kernel stack addresses and real user addresses are in fact
    disjoint as they are on i386 when not using the nonstandard 4GB address
    space layout.
    
    The obvious intent of the call being there in the first place is to permit
    a signal handler to diddle its ucontext_t.uc_stack before returning, and
    have this effect a sigaltstack call on the signal handler return.  This is
    not only an optimization vs doing the extra system call, but makes it
    possible to make a sigaltstack change when that handler itself was running
    on the signal stack.  AFAICT this has never actually worked before, so
    certainly noone depends on it.  But the code certainly suggests that
    someone intended at one time for that to be the behavior.  Thus I am
    inclined to fix it so it works in that way, though it has not done so before.
    It would also be reasonable enough to simply rip out the bogus call and not
    have this functionality.
    
    From the current state of code in both 2.4 and 2.6, there is no fathoming
    how this broken code came about.  It's actually much simpler to just make
    it work!  I can only presume that at some point in the past the sigaltstack
    implementation functions were different such that this made sense.  Of the
    few ports I've looked at briefly, only the ppc/pc64 porters (go paulus!)
    actually tried to understand what the i386 code was doing and implemented
    it correctly rather than just carefully transliterating the bug.
    
    The patch below fixes only the i386 and x86_64 versions.  The x86_64
    patches I have not actually tested.  I think each and every arch (except
    ppc and ppc64) need to make the corresponding fixes as well.  Note that
    there is a function to fix for each native arch, and then one for each
    emulation flavor.  The details differ minutely for getting the calls right
    in each emulation flavor, but I think that most or all of the arch's with
    biarch/emulation support have similar enough code that each emulation
    flavor's fix will look very much like the arch/x86_64/ia32/ia32_signal.c
    patch here.

commit ad9beb315728e494dd66943054426fd550fe44b8
Author: Andrew Morton <akpm@osdl.org>
Date:   Sat May 22 08:10:33 2004 -0700

    [PATCH] partial prefetch for vma_prio_tree_next
    
    From: Rajesh Venkatasubramanian <vrajesh@umich.edu>
    
    This patch adds prefetches for walking a vm_set.list.  Adding prefetches
    for prio tree traversals is tricky and may lead to cache trashing.  So this
    patch just adds prefetches only when walking a vm_set.list.
    
    I haven't done any benchmarks to show that this patch improves performance.
     However, this patch should help to improve performance when vm_set.lists
    are long, e.g., libc.  Since we only prefetch vmas that are guaranteed to
    be used in the near future, this patch should not result in cache trashing,
    theoretically.
    
    I didn't add any NULL checks before prefetching because prefetch.h clearly
    says prefetch(0) is okay.

commit 17e8935ff8a2dee9c34add6784d0a073d3e79c66
Author: Andrew Morton <akpm@osdl.org>
Date:   Sat May 22 08:10:23 2004 -0700

    [PATCH] rmap 40 better anon_vma sharing
    
    From: Hugh Dickins <hugh@veritas.com>
    
    anon_vma rmap will always necessarily be more restrictive about vma merging
    than before: according to the history of the vmas in an mm, they are liable to
    be allocated different anon_vma heads, and from that point on be unmergeable.
    
    Most of the time this doesn't matter at all; but in two cases it may matter.
    One case is that mremap refuses (-EFAULT) to span more than a single vma: so
    it is conceivable that some app has relied on vma merging prior to mremap in
    the past, and will now fail with anon_vma.  Conceivable but unlikely, let's
    cross that bridge if we come to it: and the right answer would be to extend
    mremap, which should not be exporting the kernel's implementation detail of
    vma to user interface.
    
    The other case that matters is when a reasonable repetitive sequence of
    syscalls and faults ends up with a large number of separate unmergeable vmas,
    instead of the single merged vma it could have.
    
    Andrea's mprotect-vma-merging patch fixed some such instances, but left other
    plausible cases unmerged.  There is no perfect solution, and the harder you
    try to allow vmas to be merged, the less efficient anon_vma becomes, in the
    extreme there being one to span the whole address space, from which hangs
    every private vma; but anonmm rmap is clearly superior to that extreme.
    
    Andrea's principle was that neighbouring vmas which could be mprotected into
    mergeable vmas should be allowed to share anon_vma: good insight.  His
    implementation was to arrange this sharing when trying vma merge, but that
    seems to be too early.  This patch sticks to the principle, but implements it
    in anon_vma_prepare, when handling the first write fault on a private vma:
    with better results.  The drawback is that this first write fault needs an
    extra find_vma_prev (whereas prev was already to hand when implementing
    anon_vma sharing at try-to-merge time).

commit 8aa3448cabdfca146aa3fd36e852d0209fb2276a
Author: Andrew Morton <akpm@osdl.org>
Date:   Sat May 22 08:10:11 2004 -0700

    [PATCH] rmap 39 add anon_vma rmap
    
    From: Hugh Dickins <hugh@veritas.com>
    
    Andrea Arcangeli's anon_vma object-based reverse mapping scheme for anonymous
    pages.  Instead of tracking anonymous pages by pte_chains or by mm, this
    tracks them by vma.  But because vmas are frequently split and merged
    (particularly by mprotect), a page cannot point directly to its vma(s), but
    instead to an anon_vma list of those vmas likely to contain the page - a list
    on which vmas can easily be linked and unlinked as they come and go.  The vmas
    on one list are all related, either by forking or by splitting.
    
    This has three particular advantages over anonmm: that it can cope
    effortlessly with mremap moves; and no longer needs page_table_lock to protect
    an mm's vma tree, since try_to_unmap finds vmas via page -> anon_vma -> vma
    instead of using find_vma; and should use less cpu for swapout since it can
    locate its anonymous vmas more quickly.
    
    It does have disadvantages too: a lot more change in mmap.c to deal with
    anon_vmas, though small straightforward additions now that the vma merging has
    been refactored there; more lowmem needed for each anon_vma and vma structure;
    an additional restriction on the merging of vmas (cannot be merged if already
    assigned different anon_vmas, since then their pages will be pointing to
    different heads).
    
    (There would be no need to enlarge the vma structure if anonymous pages
    belonged only to anonymous vmas; but private file mappings accumulate
    anonymous pages by copy-on-write, so need to be listed in both anon_vma and
    prio_tree at the same time.  A different implementation could avoid that by
    using anon_vmas only for purely anonymous vmas, and use the existing prio_tree
    to locate cow pages - but that would involve a long search for each single
    private copy, probably not a good idea.)
    
    Where before the vm_pgoff of a purely anonymous (not file-backed) vma was
    meaningless, now it represents the virtual start address at which that vma is
    mapped - which the standard file pgoff manipulations treat linearly as vmas
    are split and merged.  But if mremap moves the vma, then it generally carries
    its original vm_pgoff to the new location, so pages shared with the old
    location can still be found.  Magic.
    
    Hugh has massaged it somewhat: building on the earlier rmap patches, this
    patch is a fifth of the size of Andrea's original anon_vma patch.  Please note
    that this posting will be his first sight of this patch, which he may or may
    not approve.

commit a89cd0f027d187c9c639a171aee7ee80b5a37da5
Author: Andrew Morton <akpm@osdl.org>
Date:   Sat May 22 08:10:00 2004 -0700

    [PATCH] rmap 38 remove anonmm rmap
    
    From: Hugh Dickins <hugh@veritas.com>
    
    Before moving on to anon_vma rmap, remove now what's peculiar to anonmm rmap:
    the anonmm handling and the mremap move cows.  Temporarily reduce
    page_referenced_anon and try_to_unmap_anon to stubs, so a kernel built with
    this patch will not swap anonymous at all.

commit e1fd9cc9cbb5ac6465601833ea1cc5d6d376a155
Author: Andrew Morton <akpm@osdl.org>
Date:   Sat May 22 08:09:49 2004 -0700

    [PATCH] rmap 37 page_add_anon_rmap vma
    
    From: Hugh Dickins <hugh@veritas.com>
    
    Silly final patch for anonmm rmap: change page_add_anon_rmap's mm arg to vma
    arg like anon_vma rmap, to smooth the transition between them.

commit 2b2e2a3615d022106c0300241219c1d952208b3d
Author: Andrew Morton <akpm@osdl.org>
Date:   Sat May 22 08:09:38 2004 -0700

    [PATCH] rmap 36 mprotect use vma_merge
    
    From: Hugh Dickins <hugh@veritas.com>
    
    Earlier on, in 2.6.6, we took the vma merging code out of mremap.c and let it
    rely on vma_merge instead (via copy_vma).  Now take the vma merging code out
    of mprotect.c and let it rely on vma_merge too: so vma_merge becomes the sole
    vma merging engine.  The fruit of this consolidation is that mprotect now
    merges file-backed vmas naturally.  Make this change now because anon_vma will
    complicate the vma merging rules, let's keep them all in one place.
    
    vma_merge remains where the decisions are made, whether to merge with prev
    and/or next; but now [addr,end) may be the latter part of prev, or first part
    or whole of next, whereas before it was always a new area.
    
    vma_adjust carries out vma_merge's decision, but when sliding the boundary
    between vma and next, must temporarily remove next from the prio_tree too.
    And it turned out (by oops) to have a surer idea of whether next needs to be
    removed than vma_merge, so the fput and freeing moves into vma_adjust.
    
    Too much decipherment of what's going on at the start of vma_adjust?  Yes, and
    there's a delicate assumption that you may use vma_adjust in sliding a
    boundary, or splitting in two, or growing a vma (mremap uses it in that way),
    but not for simply shrinking a vma.  Which is so, and must be so (how could
    pages mapped in the part to go, be zapped without first splitting?), but would
    feel better with some protection.
    
    __vma_unlink can then be moved from mm.h to mmap.c, and mm.h's more misleading
    than helpful can_vma_merge is deleted.

commit 06ecc0dbc95056b4165d9868fbf2cad4ec42f895
Author: Andrew Morton <akpm@osdl.org>
Date:   Sat May 22 08:09:27 2004 -0700

    [PATCH] rmap 35 mmap.c cleanups
    
    From: Hugh Dickins <hugh@veritas.com>
    
    Before some real vma_merge work in mmap.c in the next patch, a patch of
    miscellaneous cleanups to cut down the noise:
    
    - remove rb_parent arg from vma_merge: mm->mmap can do that case
    - scatter pgoff_t around to ingratiate myself with the boss
    - reorder is_mergeable_vma tests, vm_ops->close is least likely
    - can_vma_merge_before take combined pgoff+pglen arg (from Andrea)
    - rearrange do_mmap_pgoff's ever-confusing anonymous flags switch
    - comment do_mmap_pgoff's mysterious (vm_flags & VM_SHARED) test
    - fix ISO C90 warning on browse_rb if building with DEBUG_MM_RB
    - stop that long MNT_NOEXEC line wrapping
    
    Yes, buried in amidst these is indeed one pgoff replaced by "next->vm_pgoff -
    pglen" (reverting a mod of mine which took pgoff supplied by user too
    seriously in the anon case), and another pgoff replaced by 0 (reverting
    anon_vma mod which crept in with NUMA API): neither of them really matters,
    except perhaps in /proc/pid/maps.

commit 4877b14f909ede73c3cdd593e72e90cf03dcf93c
Author: Andrew Morton <akpm@osdl.org>
Date:   Sat May 22 08:09:16 2004 -0700

    [PATCH] rmap 34 vm_flags page_table_lock
    
    From: Hugh Dickins <hugh@veritas.com>
    
    First of a batch of seven rmap patches, based on 2.6.6-mm3.  Probably the
    final batch: remaining issues outstanding can have isolated patches.  The
    first half of the batch is good for anonmm or anon_vma, the second half of the
    batch replaces my anonmm rmap by Andrea's anon_vma rmap.
    
    Judge for yourselves which you prefer.  I do think I was wrong to call
    anon_vma more complex than anonmm (its lists are easier to understand than my
    refcounting), and I'm happy with its vma merging after the last patch.  It
    just comes down to whether we can spare the extra 24 bytes (maximum, on
    32-bit) per vma for its advantages in swapout and mremap.
    
    rmap 34 vm_flags page_table_lock
    
    Why do we guard vm_flags mods with page_table_lock when it's already
    down_write guarded by mmap_sem?  There's probably a historical reason, but no
    sign of any need for it now.  Andrea added a comment and removed the instance
    from mprotect.c, Hugh plagiarized his comment and removed the instances from
    madvise.c and mlock.c.  Huge leap in scalability...  not expected; but this
    should stop people asking why those spinlocks.

commit 114c71ee019870e1822a4d1a0cfdda1f8a28f51a
Author: Andrew Morton <akpm@osdl.org>
Date:   Sat May 22 08:09:05 2004 -0700

    [PATCH] rmap 33 install_arg_page vma
    
    From: Hugh Dickins <hugh@veritas.com>
    
    anon_vma will need to pass vma to put_dirty_page, so change it and its
    various callers (setup_arg_pages and its 32-on-64-bit arch variants); and
    please, let's rename it to install_arg_page.
    
    Earlier attempt to do this (rmap 26 __setup_arg_pages) tried to clean up
    those callers instead, but failed to boot: so now apply rmap 27's memset
    initialization of vmas to these callers too; which relieves them from
    needing the recently included linux/mempolicy.h.
    
    While there, moved install_arg_page's flush_dcache_page up before
    page_table_lock - doesn't in fact matter at all, just saves one worry when
    researching flush_dcache_page locking constraints.

commit 5911438d73c0125366299c87d767ff11b0eeb16f
Author: Andrew Morton <akpm@osdl.org>
Date:   Sat May 22 08:08:54 2004 -0700

    [PATCH] rmap 32 zap_pmd_range wrap
    
    From: Hugh Dickins <hugh@veritas.com>
    
    From: Andrea Arcangeli <andrea@suse.de>
    
    zap_pmd_range, alone of all those page_range loops, lacks the check for
    whether address wrapped.  Hugh is in doubt as to whether this makes any
    difference to any config on any arch, but eager to fix the odd one out.

commit 68c45e43edd7ab46c15a3058c3d1f43e08a3c2d9
Author: Andrew Morton <akpm@osdl.org>
Date:   Sat May 22 08:08:43 2004 -0700

    [PATCH] rmap 31 unlikely bad memory
    
    From: Hugh Dickins <hugh@veritas.com>
    
    From: Andrea Arcangeli <andrea@suse.de>
    
    Sprinkle unlikelys throughout mm/memory.c, wherever we see a pgd_bad or a
    pmd_bad; likely or unlikely on pte_same or !pte_same.  Put the jump in the
    error return from do_no_page, not in the fast path.

commit d321a42d00053e526cf06816fe505907af456e80
Author: Andrew Morton <akpm@osdl.org>
Date:   Sat May 22 08:08:33 2004 -0700

    [PATCH] rmap 30 fix bad mapcount
    
    From: Hugh Dickins <hugh@veritas.com>
    
    From: Andrea Arcangeli <andrea@suse.de>
    
    page_alloc.c's bad_page routine should reset a bad mapcount; and it's more
    revealing to show the bad mapcount than just the boolean mapped.

commit c3a17613880a6e99a120a406d9312581d7498890
Author: Andrew Morton <akpm@osdl.org>
Date:   Sat May 22 08:08:22 2004 -0700

    [PATCH] rmap 29 VM_RESERVED safety
    
    From: Hugh Dickins <hugh@veritas.com>
    
    From: Andrea Arcangeli <andrea@suse.de>
    
    Set VM_RESERVED in videobuf_mmap_mapper, to warn do_no_page and swapout not to
    worry about its pages.  Set VM_RESERVED in ia64_elf32_init, it too provides an
    unusual nopage which might surprise higher level checks.  Future safety: they
    don't actually pose a problem in this current tree.

commit bbdaef5f62ed065613b8ad372032594a3faa4c9b
Author: Andrew Morton <akpm@osdl.org>
Date:   Sat May 22 08:08:11 2004 -0700

    [PATCH] rmap 28 remove_vm_struct
    
    From: Hugh Dickins <hugh@veritas.com>
    
    The callers of remove_shared_vm_struct then proceed to do several more
    identical things: gather them together in remove_vm_struct.

commit c8ba206502dbf94b5ba984150d936a860cc8f339
Author: Andrew Morton <akpm@osdl.org>
Date:   Sat May 22 08:08:00 2004 -0700

    [PATCH] rmap 27 memset 0 vma
    
    From: Hugh Dickins <hugh@veritas.com>
    
    We're NULLifying more and more fields when initializing a vma
    (mpol_set_vma_default does that too, if configured to do anything).  Now use
    memset to avoid specifying fields, and save a little code too.
    
    (Yes, I realize anon_vma will want to set vm_pgoff non-0, but I think that
    will be better handled at the core, since anon vm_pgoff is negotiable up until
    an anon_vma is actually assigned.)

commit ee7baa35264d9cb6bbf01491f3757c3312fb2376
Author: Andrew Morton <akpm@osdl.org>
Date:   Sat May 22 08:07:49 2004 -0700

    [PATCH] rmap 24 no rmap fastcalls
    
    From: Hugh Dickins <hugh@veritas.com>
    
    I like CONFIG_REGPARM, even when it's forced on: because it's easy to force
    off for debugging - easier than editing out scattered fastcalls.  Plus I've
    never understood why we make function foo a fastcall, but function bar not.
    Remove fastcall directives from rmap.  And fix comment about mremap_moved
    race: it only applies to anon pages.

commit 4a72e942ad937ed10566b87efd4bcb152c0f5b31
Author: Andrew Morton <akpm@osdl.org>
Date:   Sat May 22 08:07:38 2004 -0700

    [PATCH] rmap 23 empty flush_dcache_mmap_lock
    
    From: Hugh Dickins <hugh@veritas.com>
    
    Most architectures (like i386) do nothing in flush_dcache_page, or don't scan
    i_mmap in flush_dcache_page, so don't need flush_dcache_mmap_lock to do
    anything: define it and flush_dcache_mmap_unlock away.  Noticed arm26, cris,
    h8300 still defining flush_page_to_ram: delete it again.

commit 16ceff2d5dc9f0347ab5a08abff3f4647c2fee04
Author: Andrew Morton <akpm@osdl.org>
Date:   Sat May 22 08:07:26 2004 -0700

    [PATCH] rmap 22 flush_dcache_mmap_lock
    
    From: Hugh Dickins <hugh@veritas.com>
    
    arm and parisc __flush_dcache_page have been scanning the i_mmap(_shared) list
    without locking or disabling preemption.  That may be even more unsafe now
    it's a prio tree instead of a list.
    
    It looks like we cannot use i_shared_lock for this protection: most uses of
    flush_dcache_page are okay, and only one would need lock ordering fixed
    (get_user_pages holds page_table_lock across flush_dcache_page); but there's a
    few (e.g.  in net and ntfs) which look as if they're using it in I/O
    completion - and it would be restrictive to disallow it there.
    
    So, on arm and parisc only, define flush_dcache_mmap_lock(mapping) as
    spin_lock_irq(&(mapping)->tree_lock); on i386 (and other arches left to the
    next patch) define it away to nothing; and use where needed.
    
    While updating locking hierarchy in filemap.c, remove two layers of the fossil
    record from add_to_page_cache comment: no longer used for swap.
    
    I believe all the #includes will work out, but have only built i386.  I can
    see several things about this patch which might cause revulsion: the name
    flush_dcache_mmap_lock?  the reuse of the page radix_tree's tree_lock for this
    different purpose?  spin_lock_irqsave instead?  can't we somehow get
    i_shared_lock to handle the problem?

commit b124bc14b39502c8b46e3af5b12f821670e82298
Author: Andrew Morton <akpm@osdl.org>
Date:   Sat May 22 08:07:15 2004 -0700

    [PATCH] rmap 21 try_to_unmap_one mapcount
    
    From: Hugh Dickins <hugh@veritas.com>
    
    Why should try_to_unmap_anon and try_to_unmap_file take a copy of
    page->mapcount and pass it down for try_to_unmap_one to decrement?  why not
    just check page->mapcount itself?  asks akpm.  Perhaps there used to be a good
    reason, but not any more: remove the mapcount arg.

commit c7a491f07de4c18b8cbb6c6fc06dad1d8a1a706b
Author: Andrew Morton <akpm@osdl.org>
Date:   Sat May 22 08:07:04 2004 -0700

    [PATCH] rmap 20 i_mmap_shared into i_mmap
    
    From: Hugh Dickins <hugh@veritas.com>
    
    Why should struct address_space have separate i_mmap and i_mmap_shared
    prio_trees (separating !VM_SHARED and VM_SHARED vmas)?  No good reason, the
    same processing is usually needed on both.  Merge i_mmap_shared into i_mmap,
    but keep i_mmap_writable count of VM_SHARED vmas (those capable of dirtying
    the underlying file) for the mapping_writably_mapped test.
    
    The VM_MAYSHARE test in the arm and parisc loops is not necessarily what they
    will want to use in the end: it's provided as a harmless example of what might
    be appropriate, but maintainers are likely to revise it later (that parisc
    loop is currently being changed in the parisc tree anyway).
    
    On the way, remove the now out-of-date comments on vm_area_struct size.

commit b1efdc30f4c1499a793a87825818c64d466a4a31
Author: Andrew Morton <akpm@osdl.org>
Date:   Sat May 22 08:06:53 2004 -0700

    [PATCH] rmap.c comment/style fixups
    
    From: Christoph Hellwig <hch@lst.de>

commit 4a58335f409e2469295b6a4feb1b38b7e53067d2
Author: Andrew Morton <akpm@osdl.org>
Date:   Sat May 22 08:06:42 2004 -0700

    [PATCH] vm_area_struct size comment
    
    From: Hugh Dickins <hugh@veritas.com>
    
    Missed comment on the size of vm_area_struct: it is no longer 64 bytes on
    ia32.

commit afd8143182ceca9e1364bcac49319d42f5c0cc98
Author: Andrew Morton <akpm@osdl.org>
Date:   Sat May 22 08:06:32 2004 -0700

    [PATCH] rmap 19: arch prio_tree
    
    From: Hugh Dickins <hugh@veritas.com>
    
    The previous patches of this prio_tree batch have been to generic only.  Now
    the arm and parisc __flush_dcache_page are converted to using
    vma_prio_tree_next, and benefit from its selection of relevant vmas.  They're
    still accessing the tree without i_shared_lock or any other, that's not
    forgotten but still under investigation.  Include pagemap.h for the definition
    of PAGE_CACHE_SHIFT.  s390 and x86_64 no longer initialize vma's shared field
    (whose type has changed), done later.

commit 4e44e0858ae4d92755db9ad31592e931a6ec0751
Author: Andrew Morton <akpm@osdl.org>
Date:   Sat May 22 08:06:21 2004 -0700

    [PATCH] unmap_mapping_range: add comment

commit 068258f78adf5e3af492fb433b5a8bc2b2ba8f2f
Author: Andrew Morton <akpm@osdl.org>
Date:   Sat May 22 08:06:10 2004 -0700

    [PATCH] rmap 18: i_mmap_nonlinear
    
    From: Hugh Dickins <hugh@veritas.com>
    
    The prio_tree is of no use to nonlinear vmas: currently we're having to search
    the tree in the most inefficient way to find all its nonlinears.  At the very
    least we need an indication of the unlikely case when there are some
    nonlinears; but really, we'd do best to take them out of the prio_tree
    altogether, into a list of their own - i_mmap_nonlinear.

commit 2fe9c14c0e6932f1f2d18f8888a49078933dfaf6
Author: Andrew Morton <akpm@osdl.org>
Date:   Sat May 22 08:05:59 2004 -0700

    [PATCH] rmap 17: real prio_tree
    
    From: Hugh Dickins <hugh@veritas.com>
    
    Rajesh Venkatasubramanian's implementation of a radix priority search tree of
    vmas, to handle object-based reverse mapping corner cases well.
    
    Amongst the objections to object-based rmap were test cases by akpm and by
    mingo, in which large numbers of vmas mapping disjoint or overlapping parts of
    a file showed strikingly poor performance of the i_mmap lists.  Perhaps those
    tests are irrelevant in the real world?  We cannot be too sure: the prio_tree
    is well-suited to solving precisely that problem, so unless it turns out to
    bring too much overhead, let's include it.
    
    Why is this prio_tree.c placed in mm rather than lib?  See GET_INDEX: this
    implementation is geared throughout to use with vmas, though the first half of
    the file appears more general than the second half.
    
    Each node of the prio_tree is itself (contained within) a vma: might save
    memory by allocating distinct nodes from which to hang vmas, but wouldn't save
    much, and would complicate the usage with preallocations.  Off each node of
    the prio_tree itself hangs a list of like vmas, if any.
    
    The connection from node to list is a little awkward, but probably the best
    compromise: it would be more straightforward to list likes directly from the
    tree node, but that would use more memory per vma, for the list_head and to
    identify that head.  Instead, node's shared.vm_set.head points to next vma
    (whose shared.vm_set.head points back to node vma), and that next contains the
    list_head from which the rest hang - reusing fields already used in the
    prio_tree node itself.
    
    Currently lacks prefetch: Rajesh hopes to add some soon.

commit fc96c90fc0de79790e77fe3a9e5147a96c453c1e
Author: Andrew Morton <akpm@osdl.org>
Date:   Sat May 22 08:05:47 2004 -0700

    [PATCH] rmap 16: pretend prio_tree
    
    From: Hugh Dickins <hugh@veritas.com>
    
    Pave the way for prio_tree by switching over to its interfaces, but actually
    still implement them with the same old lists as before.
    
    Most of the vma_prio_tree interfaces are straightforward.  The interesting one
    is vma_prio_tree_next, used to search the tree for all vmas which overlap the
    given range: unlike the list_for_each_entry it replaces, it does not find
    every vma, just those that match.
    
    But this does leave handling of nonlinear vmas in a very unsatisfactory state:
    for now we have to search again over the maximum range to find all the
    nonlinear vmas which might contain a page, which of course takes away the
    point of the tree.  Fixed in later patch of this batch.
    
    There is no need to initialize vma linkage all over, just do it before
    inserting the vma in list or tree.  /proc/pid/statm had an odd test for its
    shared count: simplified to an equivalent test on vm_file.

commit fb41b4173dbfae80fe601f528d968e9caba0c766
Author: Andrew Morton <akpm@osdl.org>
Date:   Sat May 22 08:05:35 2004 -0700

    [PATCH] rmap 15: vma_adjust
    
    From: Hugh Dickins <hugh@veritas.com>
    
    If file-based vmas are to be kept in a tree, according to the file offsets
    they map, then adjusting the vma's start pgoff or its end involves
    repositioning in the tree, while holding i_shared_lock (and page_table_lock).
    We used to avoid that if possible, e.g.  when just moving end; but if we're
    heading that way, let's now tidy up vma_merge and split_vma, and do all the
    locking and adjustment in a new helper vma_adjust.  And please, let's call the
    next vma in vma_merge "next" rather than "prev".
    
    Since these patches are diffed over 2.6.6-rc2-mm2, they include the NUMA
    mpolicy mods which you'll have to remove to go earlier in the series, sorry
    for that nuisance.  I have intentionally changed the one vma_mpol_equal to
    mpol_equal, to make the merge cases more alike.

commit e1e71f9b6c8dd34be36573346ecbbb00f34a7a0a
Author: Andrew Morton <akpm@osdl.org>
Date:   Sat May 22 08:05:24 2004 -0700

    [PATCH] numa api: fix end of memory handling in mbind
    
    From: Andi Kleen <ak@suse.de>
    
    This fixes a user triggerable crash in mbind() in NUMA API.  It would oops
    when running into the end of memory.  Actually not really oops, because a
    oops with the mm sem hold for writing always deadlocks.

commit e8a2ef16fd2fbcf65d423a137290f94bd7f2bb02
Author: Andrew Morton <akpm@osdl.org>
Date:   Sat May 22 08:05:14 2004 -0700

    [PATCH] numa api: Add policy support to anonymous  memory
    
    From: Andi Kleen <ak@suse.de>
    
    Change to core VM to use alloc_page_vma() instead of alloc_page().
    
    Change the swap readahead to follow the policy of the VMA.

commit 6633401dda1a4994174344c80685cd89c7d1e83c
Author: Andrew Morton <akpm@osdl.org>
Date:   Sat May 22 08:05:02 2004 -0700

    [PATCH] numa api: Add statistics
    
    From: Andi Kleen <ak@suse.de>
    
    Add NUMA hit/miss statistics to page allocation and display them in sysfs.
    
    This is not 100% required for NUMA API, but without this it is very
    
    The overhead is quite low because all counters are per CPU and only happens
    when CONFIG_NUMA is defined.

commit e52c02f76ae684f86f18f0fc7d7577e22a4d9318
Author: Andrew Morton <akpm@osdl.org>
Date:   Sat May 22 08:04:51 2004 -0700

    [PATCH] small numa api fixups
    
    From: Christoph Hellwig <hch@lst.de>
    
    - don't include mempolicy.h in sched.h and mm.h when a forward delcaration
      is enough.  Andi argued against that in the past, but I'd really hate to add
      another header to two of the includes used in basically every driver when we
      can include it in the six files actually needing it instead (that number is
      for my ppc32 system, maybe other arches need more include in their
      directories)
    
    - make numa api fields in tast_struct conditional on CONFIG_NUMA, this gives
      us a few ugly ifdefs but avoids wasting memory on non-NUMA systems.

commit d31d7a1874c710a5c1b589807d53f32d8e7df397
Author: Andrew Morton <akpm@osdl.org>
Date:   Sat May 22 08:04:40 2004 -0700

    [PATCH] numa api: Add shared memory support
    
    From: Andi Kleen <ak@suse.de>
    
    Add support to tmpfs and hugetlbfs to support NUMA API.  Shared memory is a
    bit of a special case for NUMA policy.  Normally policy is associated to VMAs
    or to processes, but for a shared memory segment you really want to share the
    policy.  The core NUMA API has code for that, this patch adds the necessary
    changes to tmpfs and hugetlbfs.
    
    First it changes the custom swapping code in tmpfs to follow the policy set
    via VMAs.
    
    It is also useful to have a "backing store" of policy that saves the policy
    even when nobody has the shared memory segment mapped.  This allows command
    line tools to pre configure policy, which is then later used by programs.
    
    Note that hugetlbfs needs more changes - it is also required to switch it to
    lazy allocation, otherwise the prefault prevents mbind() from working.

commit c78b023ffcddf5868ec0bedc07942ac62c11154d
Author: Andrew Morton <akpm@osdl.org>
Date:   Sat May 22 08:04:29 2004 -0700

    [PATCH] numa api: Add VMA hooks for policy
    
    From: Andi Kleen <ak@suse.de>
    
    NUMA API adds a policy to each VMA.  During VMA creattion, merging and
    splitting these policies must be handled properly.  This patch adds the calls
    to this.
    
    It is a nop when CONFIG_NUMA is not defined.

commit 490b582a14d4611d2942a7d8a188c9eca8ecf44b
Author: Andrew Morton <akpm@osdl.org>
Date:   Sat May 22 08:04:17 2004 -0700

    [PATCH] Re-add NUMA API statistics
    
    From: Andi Kleen <ak@suse.de>
    
    Patch readds the sysfs output of the NUMA API statistics.  All my test
    scripts need this and it is very useful to check if the policy actually
    works.
    
    This got lost when the huge page numa api changes got dropped.
    
    I decided to not resend the huge pages NUMA API changes for now.  Instead I
    will wait for this area to settle when demand paged large pages is merged.

commit 0aa6e336182ce310bfef3af78dfa41081fab2344
Author: Andrew Morton <akpm@osdl.org>
Date:   Sat May 22 08:04:06 2004 -0700

    [PATCH] numa api core: use SLAB_PANIC

commit e6ac361f77cdccde7434032238847b852149f2ec
Author: Andrew Morton <akpm@osdl.org>
Date:   Sat May 22 08:03:56 2004 -0700

    [PATCH] mpol in copy_vma
    
    From: Hugh Dickins <hugh@veritas.com>
    
    I think Andi missed the copy_vma I recently added for mremap, and it'll
    need something like below....  (Doesn't look like it'll optimize away when
    it's not needed - rather bloaty.)

commit d3b8924aa8ba6adc312644e19b49dbbdd2238599
Author: Andrew Morton <akpm@osdl.org>
Date:   Sat May 22 08:03:39 2004 -0700

    [PATCH] numa api: Core NUMA API code
    
    From: Andi Kleen <ak@suse.de>
    
    The following patches add support for configurable NUMA memory policy
    for user processes. It is based on the proposal from last kernel summit
    with feedback from various people.
    
    This NUMA API doesn't not attempt to implement page migration or anything
    else complicated: all it does is to police the allocation when a page
    is first allocation or when a page is reallocated after swapping. Currently
    only support for shared memory and anonymous memory is there; policy for
    file based mappings is not implemented yet (although they get implicitely
    policied by the default process policy)
    
    It adds three new system calls: mbind to change the policy of a VMA,
    set_mempolicy to change the policy of a process, get_mempolicy to retrieve
    memory policy. User tools (numactl, libnuma, test programs, manpages) can be
    found in  ftp://ftp.suse.com/pub/people/ak/numa/numactl-0.6.tar.gz
    
    For details on the system calls see the manpages
    http://www.firstfloor.org/~andi/mbind.html
    http://www.firstfloor.org/~andi/set_mempolicy.html
    http://www.firstfloor.org/~andi/get_mempolicy.html
    Most user programs should actually not use the system calls directly,
    but use the higher level functions in libnuma
    (http://www.firstfloor.org/~andi/numa.html) or the command line tools
    (http://www.firstfloor.org/~andi/numactl.html
    
    The system calls allow user programs and administors to set various NUMA memory
    policies for putting memory on specific nodes. Here is a short description
    of the policies copied from the kernel patch:
    
     * NUMA policy allows the user to give hints in which node(s) memory should
     * be allocated.
     *
     * Support four policies per VMA and per process:
     *
     * The VMA policy has priority over the process policy for a page fault.
     *
     * interleave     Allocate memory interleaved over a set of nodes,
     *                with normal fallback if it fails.
     *                For VMA based allocations this interleaves based on the
     *                offset into the backing object or offset into the mapping
     *                for anonymous memory. For process policy an process counter
     *                is used.
     * bind           Only allocate memory on a specific set of nodes,
     *                no fallback.
     * preferred      Try a specific node first before normal fallback.
     *                As a special case node -1 here means do the allocation
     *                on the local CPU. This is normally identical to default,
     *                but useful to set in a VMA when you have a non default
     *                process policy.
     * default        Allocate on the local node first, or when on a VMA
     *                use the process policy. This is what Linux always did
     *                in a NUMA aware kernel and still does by, ahem, default.
     *
     * The process policy is applied for most non interrupt memory allocations
     * in that process' context. Interrupts ignore the policies and always
     * try to allocate on the local CPU. The VMA policy is only applied for memory
     * allocations for a VMA in the VM.
     *
     * Currently there are a few corner cases in swapping where the policy
     * is not applied, but the majority should be handled. When process policy
     * is used it is not remembered over swap outs/swap ins.
     *
     * Only the highest zone in the zone hierarchy gets policied. Allocations
     * requesting a lower zone just use default policy. This implies that
     * on systems with highmem kernel lowmem allocation don't get policied.
     * Same with GFP_DMA allocations.
     *
     * For shmfs/tmpfs/hugetlbfs shared memory the policy is shared between
     * all users and remembered even when nobody has memory mapped.
    
    
    
    
    This patch:
    
    This is the core NUMA API code. This includes NUMA policy aware
    wrappers for get_free_pages and alloc_page_vma(). On non NUMA kernels
    these are defined away.
    
    The system calls mbind (see http://www.firstfloor.org/~andi/mbind.html),
    get_mempolicy (http://www.firstfloor.org/~andi/get_mempolicy.html) and
    set_mempolicy (http://www.firstfloor.org/~andi/set_mempolicy.html) are
    implemented here.
    
    Adds a vm_policy field to the VMA and to the process. The process
    also has field for interleaving. VMA interleaving uses the offset
    into the VMA, but that's not possible for process allocations.
    
    From: Andi Kleen <ak@muc.de>
    
      > Andi, how come policy_vma() calls ->set_policy under i_shared_sem?
    
      I think this can be actually dropped now.  In an earlier version I did
      walk the vma shared list to change the policies of other mappings to the
      same shared memory region.  This turned out too complicated with all the
      corner cases, so I eventually gave in and added ->get_policy to the fast
      path.  Also there is still the mmap_sem which prevents races in the same MM.
    
    
      Patch to remove it attached.  Also adds documentation and removes the
      bogus __alloc_page_vma() prototype noticed by hch.
    
    From: Andi Kleen <ak@suse.de>
    
      A few incremental fixes for NUMA API.
    
      - Fix a few comments
    
      - Add a compat_ function for get_mem_policy I considered changing the
        ABI to avoid this, but that would have made the API too ugly.  I put it
        directly into the file because a mm/compat.c didn't seem worth it just for
        this.
    
      - Fix the algorithm for VMA interleave.
    
    From: Matthew Dobson <colpatch@us.ibm.com>
    
      1) Move the extern of alloc_pages_current() into #ifdef CONFIG_NUMA.
        The only references to the function are in NUMA code in mempolicy.c
    
      2) Remove the definitions of __alloc_page_vma().  They aren't used.
    
      3) Move forward declaration of struct vm_area_struct to top of file.

commit 8a8e5a38b0ea9999b3fff71981f9bff29be3c500
Author: Andrew Morton <akpm@osdl.org>
Date:   Sat May 22 08:03:26 2004 -0700

    [PATCH] numa api: Add IA64 support
    
    From: Andi Kleen <ak@suse.de>
    
    Add NUMA API system calls on IA64 and one bug fix required for it.

commit 5a6d8244f6697d5556a3d67d15c3f1313458d29f
Author: Andrew Morton <akpm@osdl.org>
Date:   Sat May 22 08:03:15 2004 -0700

    [PATCH] numa api: Add i386 support
    
    From: Andi Kleen <ak@suse.de>
    
    Add NUMA API system calls for i386

commit 6f4944c56e561950551dfd8311969f3d2e9a1959
Author: Andrew Morton <akpm@osdl.org>
Date:   Sat May 22 08:03:04 2004 -0700

    [PATCH] numa api: x86_64 support
    
    From: Andi Kleen <ak@suse.de>
    
    Add NUMA API system calls on x86-64
    
    This includes a bugfix to prevent miscompilation on gcc 3.2 of bitmap.h

commit d3f42511c53d6401a5d9cdec299528c81ce96d98
Author: Andrew Morton <akpm@osdl.org>
Date:   Sat May 22 08:02:50 2004 -0700

    [PATCH] rmap 14: i_shared_lock fixes
    
    From: Hugh Dickins <hugh@veritas.com>
    
    First of batch of six patches which introduce Rajesh Venkatasubramanian's
    implementation of a radix priority search tree of vmas, to handle object-based
    reverse mapping corner cases well.
    
    rmap 14 i_shared_lock fixes
    
    Start the sequence with a couple of outstanding i_shared_lock fixes.
    
    Since i_shared_sem became i_shared_lock, we've had to shift and then
    temporarily remove mremap move's protection of concurrent truncation - if
    mremap moves ptes while unmap_mapping_range_list is making its way through the
    vmas, there's a danger we'd move a pte from an area yet to be cleaned back
    into an area already cleared.
    
    Now site the i_shared_lock with the page_table_lock in move_one_page.  Replace
    page_table_present by get_one_pte_map, so we know when it's necessary to
    allocate a new page table: in which case have to drop i_shared_lock, trylock
    and perhaps reorder locks on the way back.  Yet another fix: must check for
    NULL dst before pte_unmap(dst).
    
    And over in rmap.c, try_to_unmap_file's cond_resched amidst its lengthy
    nonlinear swapping was now causing might_sleep warnings: moved to a rather
    unsatisfactory and less frequent cond_resched_lock on i_shared_lock when we
    reach the end of the list; and one before starting on the nonlinears too: the
    "cursor" may become out-of-date if we do schedule, but I doubt it's worth
    bothering about.

commit c08689623e4e807489a2727b5362a75c11ce6342
Author: Andrew Morton <akpm@osdl.org>
Date:   Sat May 22 08:02:36 2004 -0700

    [PATCH] Convert i_shared_sem back to a spinlock
    
    Having a semaphore in there causes modest performance regressions on heavily
    mmap-intensive workloads on some hardware.  Specifically, up to 30% in SDET on
    NUMAQ and big PPC64.
    
    So switch it back to being a spinlock.  This does mean that unmap_vmas() needs
    to be told whether or not it is allowed to schedule away; that's simple to do
    via the zap_details structure.
    
    This change means that there will be high scheuling latencies when someone
    truncates a large file which is currently mmapped, but nobody does that
    anyway.  The scheduling points in unmap_vmas() are mainly for munmap() and
    exit(), and they still will work OK for that.
    
    From: Hugh Dickins <hugh@veritas.com>
    
      Sorry, my premature optimizations (trying to pass down NULL zap_details
      except when needed) have caught you out doubly: unmap_mapping_range_list was
      NULLing the details even though atomic was set; and if it hadn't, then
      zap_pte_range would have missed free_swap_and_cache and pte_clear when pte
      not present.  Moved the optimization into zap_pte_range itself.  Plus
      massive documentation update.
    
    From: Hugh Dickins <hugh@veritas.com>
    
      Here's a second patch to add to the first: mremap's cows can't come home
      without releasing the i_mmap_lock, better move the whole "Subtle point"
      locking from move_vma into move_page_tables.  And it's possible for the file
      that was behind an anonymous page to be truncated while we drop that lock,
      don't want to abort mremap because of VM_FAULT_SIGBUS.
    
      (Eek, should we be checking do_swap_page of a vm_file area against the
      truncate_count sequence?  Technically yes, but I doubt we need bother.)
    
    
    - We cannot hold i_mmap_lock across move_one_page() because
      move_one_page() needs to perform __GFP_WAIT allocations of pagetable pages.
    
    - Move the cond_resched() out so we test it once per page rather than only
      when move_one_page() returns -EAGAIN.

commit 71a1874542dd939ae1505b336b90cc6b6e95bd2d
Author: Andrew Morton <akpm@osdl.org>
Date:   Sat May 22 08:02:25 2004 -0700

    [PATCH] rmap 13 include/asm deletions
    
    From: Hugh Dickins <hugh@veritas.com>
    
    Delete include/asm*/rmap.h
    Delete pte_addr_t typedef from include/asm*/pgtable.h
    Delete KM_PTE2 from subset of include/asm*/kmap_types.h
    Beware when 4G/4G returns to -mm: i386 may need KM_FILLER for 8K stack.

commit 865fadf052c506ef75db12ccafb42b25664cc62b
Author: Andrew Morton <akpm@osdl.org>
Date:   Sat May 22 08:02:09 2004 -0700

    [PATCH] rmap 12 pgtable remove rmap
    
    From: Hugh Dickins <hugh@veritas.com>
    
    Remove the support for pte_chain rmap from page table initialization, just
    continue to maintain nr_page_table_pages (but only for user page tables -
    it also counted vmalloc page tables before, little need, and I'm unsure if
    per-cpu stats are safe early enough on all arches).  mm/memory.c is the
    only core file affected.
    
    But ppc and ppc64 have found the old rmap page table initialization useful
    to support their ptep_test_and_clear_young: so transfer rmap's
    initialization to them (even on kernel page tables?  well, okay).

commit 70b671f80eda1c72c2cb00fd0d471dbc43258c16
Author: Andrew Morton <akpm@osdl.org>
Date:   Sat May 22 08:01:58 2004 -0700

    [PATCH] rmap 11 mremap moves
    
    From: Hugh Dickins <hugh@veritas.com>
    
    A weakness of the anonmm scheme is its difficulty in tracking pages shared
    between two or more mms (one being an ancestor of the other), when mremap has
    been used to move a range of pages in one of those mms.  mremap move is not
    very common anyway, and it's more often used on a page range exclusive to the
    mm; but uncommon though it may be, we must not allow unlocked pages to become
    unswappable.
    
    This patch follows Linus' suggestion, simply to take a private copy of the
    page in such a case: early C-O-W.  My previous implementation was daft with
    respect to pages currently on swap: it insisted on swapping them in to copy
    them.  No need for that: just take the copy when a page is brought in from
    swap, and its intended address is found to clash with what rmap has already
    noted.
    
    If do_swap_page has to make this copy in the mremap moved case (simply a call
    to do_wp_page), might as well do so also in the case when it's a write access
    but the page not exclusive, it's always seemed a little odd that swapin needed
    a second fault for that.  A bug even: get_user_pages force imagines that a
    single call to handle_mm_fault must break C-O-W.  Another bugfix: swapoff's
    unuse_process didn't check is_vm_hugetlb_page.
    
    Andrea's anon_vma has no such problem with mremap moved pages, handling them
    with elegant use of vm_pgoff - though at some cost to vma merging.  How
    important is it to handle them efficiently?  For now there's a msg
    printk(KERN_WARNING "%s: mremap moved %d cows\n", current->comm, cows);

commit 6bccf794bf7f3161152ef4204c13e45c3d0fe372
Author: Andrew Morton <akpm@osdl.org>
Date:   Sat May 22 08:01:46 2004 -0700

    [PATCH] rmap 10 add anonmm rmap
    
    From: Hugh Dickins <hugh@veritas.com>
    
    Hugh's anonmm object-based reverse mapping scheme for anonymous pages.  We
    have not yet decided whether to adopt this scheme, or Andrea's more advanced
    anon_vma scheme.  anonmm is easier for me to merge quickly, to replace the
    pte_chain rmap taken out in the previous patch; a patch to install Andrea's
    anon_vma will follow in due course.
    
    Why build up and tear down chains of pte pointers for anonymous pages, when a
    page can only appear at one particular address, in a restricted group of mms
    that might share it?  (Except: see next patch on mremap.)
    
    Introduce struct anonmm per mm to track anonymous pages, all forks from one
    exec sharing the same bundle of linked anonmms.  Anonymous pages originate in
    one mm, but may be forked into another mm of the bundle later on.  Callouts
    from fork.c to allocate, dup and exit the anonmm structure private to rmap.c.
    
    From: Hugh Dickins <hugh@veritas.com>
    
      Two concurrent exits (of the last two mms sharing the anonhd).  First
      exit_rmap brings anonhd->count down to 2, gets preempted (at the
      spin_unlock) by second, which brings anonhd->count down to 1, sees it's 1
      and frees the anonhd (without making any change to anonhd->count itself),
      cpu goes on to do something new which reallocates the old anonhd as a new
      struct anonmm (probably not a head, in which case count will start at 1),
      first resumes after the spin_unlock and sees anonhd->count 1, frees "anonhd"
      again, it's used for something else, a later exit_rmap list_del finds list
      corrupt.

commit 123e4df7e093329599a75ad8ad0eed9ebbd9aa27
Author: Andrew Morton <akpm@osdl.org>
Date:   Sat May 22 08:01:30 2004 -0700

    [PATCH] rmap 9 remove pte_chains
    
    From: Hugh Dickins <hugh@veritas.com>
    
    Lots of deletions: the next patch will put in the new anon rmap, which
    should look clearer if first we remove all of the old pte-pointer-based
    rmap from the core in this patch - which therefore leaves anonymous rmap
    totally disabled, anon pages locked in memory until process frees them.
    
    Leave arch files (and page table rmap) untouched for now, clean them up in
    a later batch.  A few constructive changes amidst all the deletions:
    
    Choose names (e.g.  page_add_anon_rmap) and args (e.g.  no more pteps) now
    so we need not revisit so many files in the next patch.  Inline function
    page_dup_rmap for fork's copy_page_range, simply bumps mapcount under lock.
     cond_resched_lock in copy_page_range.  Struct page rearranged: no pte
    union, just mapcount moved next to atomic count, so two ints can occupy one
    long on 64-bit; i386 struct page now 32 bytes even with PAE.  Never pass
    PageReserved to page_remove_rmap, only do_wp_page did so.
    
    
    From: Hugh Dickins <hugh@veritas.com>
    
      Move page_add_anon_rmap's BUG_ON(page_mapping(page)) inside the rmap_lock
      (well, might as well just check mapping if !mapcount then): if this page is
      being mapped or unmapped on another cpu at the same time, page_mapping's
      PageAnon(page) and page->mapping are volatile.
    
      But page_mapping(page) is used more widely: I've a nasty feeling that
      clear_page_anon, page_add_anon_rmap and/or page_mapping need barriers added
      (also in 2.6.6 itself),

commit b33a7bad9bcb5c8453d7a13a99b3151ebe69563f
Author: Andrew Morton <akpm@osdl.org>
Date:   Sat May 22 08:01:17 2004 -0700

    [PATCH] slab: consolidate panic code
    
    Many places do:
    
    	if (kmem_cache_create(...) == NULL)
    		panic(...);
    
    We can consolidate all that by passing another flag to kmem_cache_create()
    which says "panic if it doesn't work".

commit 108e31587b9b9b4c6aaa99deb7f50c09c9f9b880
Author: Andrew Morton <akpm@osdl.org>
Date:   Sat May 22 08:01:04 2004 -0700

    [PATCH] rmap 8 unmap nonlinear
    
    From: Hugh Dickins <hugh@veritas.com>
    
    The previous patch let the ptes of file pages be located via page
    ->mapping->i_mmap and i_mmap_shared lists of vmas; which works well unless
    the vma is VM_NONLINEAR - one in which sys_remap_file_pages has been used
    to place pages in unexpected places, to avoid an explosion of distinct
    unmergable vmas.  Such pages were effectively locked in memory.
    
    page_referenced_file is already skipping nonlinear vmas, they'd just waste
    its time, and age unfairly any pages in their proper positions.  Now extend
    try_to_unmap_file, to persuade it to swap from nonlinears.
    
    Ignoring the page requested, try to unmap cluster of 32 neighbouring ptes
    (in worst case all empty slots) in a nonlinear vma, then move on to the
    next vma; stopping when we've unmapped at least as many maps as the
    requested page had (vague guide of how hard to try), or have reached the
    end.  With large sparse nonlinear vmas, this could take a long time:
    inserted a cond_resched while no locks are held, unusual at this level but
    I think okay, shrink_list does so.
    
    Use vm_private_data a little like the old mm->swap_address, as a cursor
    recording how far we got, so we don't attack the same ptes next time around
    (earlier tried inserting an empty marker vma in the list, but that got
    messy).  How well this will work on real- life nonlinear vmas remains to be
    seen, but should work better than locking them all in memory, or swapping
    everything out all the time.
    
    Existing users of vm_private_data have either VM_RESERVED or VM_DONTEXPAND
    set, both of which are in the VM_SPECIAL category where we never try to
    merge vmas: so removed the vm_private_data test from is_mergeable_vma, so
    we can still merge VM_NONLINEARs.  Of course, we could instead add another
    field to vm_area_struct.

commit cab971db76406075a03df304db139fd4b7193a96
Author: Andrew Morton <akpm@osdl.org>
Date:   Sat May 22 08:00:54 2004 -0700

    [PATCH] rmap 7 object-based rmap
    
    From: Hugh Dickins <hugh@veritas.com>
    
    Dave McCracken's object-based reverse mapping scheme for file pages: why
    build up and tear down chains of pte pointers for file pages, when
    page->mapping has i_mmap and i_mmap_shared lists of all the vmas which
    might contain that page, and it appears at one deterministic position
    within the vma (unless vma is nonlinear - see next patch)?
    
    Has some drawbacks: more work to locate the ptes from page_referenced and
    try_to_unmap, especially if the i_mmap lists contain a lot of vmas covering
    different ranges; has to down_trylock the i_shared_sem, and hope that
    doesn't fail too often.  But attractive in that it uses less lowmem, and
    shifts the rmap burden away from the hot paths, to swapout.
    
    Hybrid scheme for the moment: carry on with pte_chains for anonymous pages,
    that's unchanged; but file pages keep mapcount in the pte union of struct
    page, where anonymous pages keep chain pointer or direct pte address: so
    page_mapped(page) works on both.
    
    Hugh massaged it a little: distinct page_add_file_rmap entry point; list
    searches check rss so as not to waste time on mms fully swapped out; check
    mapcount to terminate once all ptes have been found; and a WARN_ON if
    page_referenced should have but couldn't find all the ptes.

commit d61ae266b334dfdd64697d4d5b5df9e3440666d8
Author: Andrew Morton <akpm@osdl.org>
Date:   Sat May 22 08:00:42 2004 -0700

    [PATCH] __set_page_dirty_nobuffers race fix
    
    Running __mark_inode_dirty() against a swapcache page is illegal and will
    oops.
    
    I see a race in set_page_dirty() wherein it can be called with a PageSwapCache
    page, but if the page is removed from swapcache after
    __set_page_dirty_nobuffers() drops tree_lock(), we have the situation where
    PageSwapCache() is false, but local variable `mapping' points at swapcache.
    
    Handle that by checking for non-null mapping->host.  We don't care about the
    page state at this point - we're only interested in the inode.
    
    
    
    There is a converse case: what if a page is added to swapcache as we are
    running set_page_dirty() against it?
    
    In this case the page gets its PG_dirty flag set but it is not tagged as dirty
    in the swapper_space radix tree.  The swap writeout code will handle this OK
    and test_clear_page_dirty()'s call to
    radix_tree_tag_clear(PAGECACHE_TAG_DIRTY) will silently have no effect.  The
    only downside is that future radix-tree-based writearound won't notice that
    such pages are dirty and swap IO scheduling will be a teensy bit worse.
    
    
    The patch also fixes the (silly) testing of local variable `mapping' to see if
    the page was truncated.  We should test page_mapping() for that.

commit e6dfd92e48a0d3d2738e30dc762233d85ac98612
Author: Andrew Morton <akpm@osdl.org>
Date:   Sat May 22 08:00:31 2004 -0700

    [PATCH] Make sync_page use swapper_space again
    
    Revert recent changes to sync_page().  Now that page_mapping() returns
    &swapper_space for swapcache pages we don't need to test for PageSwapCache in
    sync_page().

commit 8ea360d493ec1b969dc08a7d1413033eb52079de
Author: Andrew Morton <akpm@osdl.org>
Date:   Sat May 22 08:00:19 2004 -0700

    [PATCH] vmscan: revert may_enter_fs changes
    
    Fix up the "may we call writepage" logic for the swapcache changes.

commit e74193ade30270984a8f49b3604cff69c045ea4e
Author: Andrew Morton <akpm@osdl.org>
Date:   Sat May 22 08:00:08 2004 -0700

    [PATCH] revert recent swapcache handling changes
    
    Go back to the 2.6.5 concepts, with rmap additions.  In particular:
    
    - Implement Andrea's flavour of page_mapping().  This function opaquely does
      the right thing for pagecache pages, anon pages and for swapcache pages.
    
      The critical thing here is that page_mapping() returns &swapper_space for
      swapcache pages without actually requiring the storage at page->mapping.
      This frees page->mapping for the anonmm/anonvma metadata.
    
    - Andrea and Hugh placed the pagecache index of swapcache pages into
      page->private rather than page->index.  So add new page_index() function
      which hides this.
    
    - Make swapper_space.set_page_dirty() again point at
      __set_page_dirty_buffers().  If we don't do that, a bare set_page_dirty()
      will fall through to __set_page_dirty_buffers(), which is silly.
    
      This way, __set_page_dirty_buffers() can continue to use page->mapping.
      It should never go near anon or swapcache pages.
    
    - Give swapper_space a ->set_page_dirty address_space_operation method, so
      that set_page_dirty() will not fall through to __set_page_dirty_buffers()
      for swapcache pages.  That function is not set up to handle them.
    
    
    The main effect of these changes is that swapcache pages are treated more
    similarly to pagecache pages.  And we are again tagging swapcache pages as
    dirty in their radix tree, which is a requirement if we later wish to
    implement swapcache writearound based on tagged radix-tree walks.

commit 7379e3022d236e2aff1b654d8ecb6cd4fc19246e
Author: Andrew Morton <akpm@osdl.org>
Date:   Sat May 22 07:59:57 2004 -0700

    [PATCH] __add_to_swap_cache and add_to_pagecache() simplification
    
    Simplify the logic in there a bit.

commit b6c418dc809fb3ab4eb2b11f7caec7d98a1eaae7
Author: Andrew Morton <akpm@osdl.org>
Date:   Sat May 22 07:59:45 2004 -0700

    [PATCH] Make swapper_space tree_lock irq-safe
    
    ->tree_lock is supposed to be IRQ-safe.  Hugh worked out that with his
    changes, we never actually take it from interrupt context, so spin_lock() is
    sufficient.
    
    Apart from kinda freaking me out, the analysis which led to this decision
    becomes untrue with later patches.  So make it irq-safe.

commit 15fe2ede78c1531205f34efbaa55ecdd6c7a5450
Merge: ddac3ee... aabea32...
Author: Jaroslav Kysela <perex@suse.cz>
Date:   Sat May 22 14:16:19 2004 +0200

    Merge suse.cz:/home/perex/bk/linux-sound/linux-2.5
    into suse.cz:/home/perex/bk/linux-sound/linux-sound

commit a20a9deece83ea13989595792665dd9da925b09c
Merge: 649f71c... 4d4aaa6...
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Sat May 22 00:31:41 2004 -0700

    Merge bk://kernel.bkbits.net/davem/net-2.6
    into ppc970.osdl.org:/home/torvalds/v2.6/linux

commit 4d4aaa67c871435690ce592df84a14a9b526a43b
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Sat May 22 00:27:16 2004 -0700

    Avoid type warning in comparison by making it explicit.
    
    (The difference between two pointers is a "size_t", while
    MAX_LEN and the result here are "int"s).

commit 303d5a2a7a5f6fbd537d5c8b682495588747464c
Author: Christoph Hellwig <hch@lst.de>
Date:   Sat May 22 01:57:26 2004 -0500

    [PATCH] remove an unused function from NC53c406a
    
    and here's a variant using #if 0

commit 649f71c527932fd0c68675fd905c78f3b4621d4a
Author: Stephen Hemminger <shemminger@osdl.org>
Date:   Fri May 21 23:47:44 2004 -0700

    [BRIDGE]: Forwarding table sanity checks.
    
    Forwarding table paranoia:
    * Solve some potential problems if a device changes address and one or
      more device has the same address.
    * Warn if new device added to a bridge matches a entry that has shown
      up on the network.
    * Also don't put static entries in the timer list, they don't time
      out so shouldn't be there.

commit d6bd66197a356c1b19efe7adcccccdb1b080a155
Author: Stephen Hemminger <shemminger@osdl.org>
Date:   Fri May 21 23:47:01 2004 -0700

    [BRIDGE]: Compat hooks for new-ioctl interface.
    
    Replacement 64 bit compatibility code for the new ioctl's.  The new
    ioctl's all pass through clean, but for the old style ioctl's it uses
    the mis-feature of the earlier bridge-utils that they check the API version.
    
    So if an old 32bit version of brctl is run on a 64bit platform it will
    report
    	bridge utilities not compatible with kernel version
    
    Tested on Itanium 1; but should solve issue for sparc, ppc, and x86_64

commit 5075405c92203b299736e3c625d702d1f32edba2
Author: Stephen Hemminger <shemminger@osdl.org>
Date:   Fri May 21 23:46:09 2004 -0700

    [BRIDGE]: New ioctl interface for 32/64 compatability.
    
    Add four new ioctl's for the operations that can't be done through sysfs.
    The existing bridge ioctl's are multiplexed, and most go through SIOCDEVPRIVATE
    so they won't work in a mixed 32/64bit environment.
    
    The new release of bridge-utils will use these if possible, and fall
    back to the old interface.

commit 3d702922fcdda853d1a73ae2b6ea423e8ef453a8
Author: Stephen Hemminger <shemminger@osdl.org>
Date:   Fri May 21 23:44:51 2004 -0700

    [BRIDGE]: Add sysfs support.

commit f1d657897f1a76e6854eb67913e00b22c9156278
Author: Stephen Hemminger <shemminger@osdl.org>
Date:   Fri May 21 23:39:53 2004 -0700

    [BRIDGE]: Expose timer_residue function for use by sysfs.
    
    Move the local function timer_residue to br_timer_value so it can
    be used by both ioctl and sysfs code.

commit 7e40dbf8ec3b59c4ff16792fa0f16dd0f2ea868f
Author: Stephen Hemminger <shemminger@osdl.org>
Date:   Fri May 21 23:39:18 2004 -0700

    [BRIDGE]: Read forwarding table chunk at a time.
    
    Change how the read of forwarding table works.  Instead of copying
    entries to user one at a time, use an intermediate kernel buffer and
    do up to a page at a chunk.
    
    This gets rid of some awkward code dealing with entries getting deleted
    during the copy.  And allows same function to be used by later sysfs
    hook.

commit 367c89b5538c0aa3ccb7a611a96c8fb3441073a0
Author: Stephen Hemminger <shemminger@osdl.org>
Date:   Fri May 21 23:38:39 2004 -0700

    [BRIDGE]: Fix deadlock on device removal.
    
    Fix a deadlock where deleting a device call br_del_if with lock held.
    br_del_if doesn't want to be called under lock anymore.

commit 39b81cce315bda6f970f40050e40e9ca4e1cd0ea
Author: Stephen Hemminger <shemminger@osdl.org>
Date:   Fri May 21 23:38:07 2004 -0700

    [BRIDGE]: Ioctl cleanup and consolidation.
    
    Merge the ioctl stub calls that just end up calling the sub-function
    to do the actual ioctl.  Move br_get_XXX_ifindices into the ioctl file
    as well where they can be static.

commit af13a4506ef7e66a770fc1c03a3d0af1efd76683
Author: Stephen Hemminger <shemminger@osdl.org>
Date:   Fri May 21 23:37:36 2004 -0700

    [BRIDGE]: Relax locking on add/delete.
    
    Relax the locking on add/delete interfaces to a bridge.  Since these operations
    are already called with RTNL semaphore, only need to hold the bridge lock while
    doing operations related to STP and processing path.  This is necessary for later
    sysfs support where those operations might sleep.

commit 20d50e8c542e16c0e49ce0d8537d83f4d6664844
Author: Stephen Hemminger <shemminger@osdl.org>
Date:   Fri May 21 23:36:59 2004 -0700

    [BRIDGE]: Cleanup of bridge allocation.
    
    Minor cleanup (lead in to later sysfs support).
    Change new_nb to new_bridge_dev and return the net_device rather than
    bridge because that is what the caller wants anyway.

commit c5c0a0e37382bb7c21931d6775ed9ee4eaca0f07
Author: Stephen Hemminger <shemminger@osdl.org>
Date:   Fri May 21 23:36:24 2004 -0700

    [BRIDGE]: Handle delete of multiple devices with same address.
    
    This fixes the issue discovered when removing bluetooth devices from a bridge.
    Need to add special case code when forwarding table is being cleaned up to
    handle the case where several devices share the same hardware address.

commit e8d122760cfe22f5d581b2d67055efa69df07dce
Author: Herbert Xu <herbet@gondor.apana.org.au>
Date:   Fri May 21 23:35:20 2004 -0700

    [IPSEC]: Lock policy in policy timer.

commit 46f55c6342abfecafb97482a19de1db69d537f02
Author: Bartlomiej Zolnierkiewicz <b.zolnierkiewicz@elka.pw.edu.pl>
Date:   Fri May 21 23:01:55 2004 -0700

    [PATCH] IDE PCI: don't initialize fields of static chipset tables to zero
    
    Also remove unused EOL define from ide.h.
    
    This trivial patch makes grepping a lot easier.

commit 58148fac604e8b740b0f0471d6a41e1caa50f6ac
Author: Bartlomiej Zolnierkiewicz <b.zolnierkiewicz@elka.pw.edu.pl>
Date:   Fri May 21 23:01:44 2004 -0700

    [PATCH] two fixups for my ARM/ARM26 IDE changes
    
    - initializing needs to be set to 1 before calling ide_arm_init()
    
    - ide_default_io_ctl() should be 0 on arm26

commit cbc6f01b05246a9ec52803d0e851c86d91a10494
Author: Bartlomiej Zolnierkiewicz <b.zolnierkiewicz@elka.pw.edu.pl>
Date:   Fri May 21 23:01:33 2004 -0700

    [PATCH] remove dead drivers/ide/ppc/swarm.c
    
    This driver was partially merged in 2.5.32 and never compiled in 2.5/2.6.
    It was fixed in linux-mips CVS but has been broken again about 5 months ago.
    Just remove it for now (it is in wrong directory anyway).

commit 6d388419cde4b9c740a65edf000ed9a9c392f426
Author: Guennadi Liakhovetski <g.liakhovetski@gmx.de>
Date:   Sat May 22 00:50:24 2004 -0500

    [PATCH] tmscsim: trivial updates
    
    Here comes the next (trivial) patch. I just want to get it out of the way
    to make the next (scary) patch smaller and simpler. This one doesn't
    modify the object code either. Actually, well, it does - it makes a few
    objects, that were previously declared extern static. And removes a couple
    more defines.

commit 6f9af6fc3c7b39261a7162c057fc487d73fa5179
Author: Adrian Bunk <bunk@fs.tum.de>
Date:   Fri May 21 20:52:32 2004 -0700

    [PATCH] more comx removal
    
    The patch below removes the MAINTAINERS entry for the removed comx
    driver.
    
    Additionally, the following comx header files could be removed:
      drivers/net/wan/mixcom.h
      drivers/net/wan/hscx.h
      drivers/net/wan/munich32x.h
      drivers/net/wan/falc-lh.h
    
    I've double-checked that none of them are used by any other driver.

commit 8fcb7c3382519c89928c44b68fe4cfc43b963e7f
Author: Adrian Bunk <bunk@fs.tum.de>
Date:   Fri May 21 20:50:24 2004 -0700

    [PATCH] JFFS2_FS_NAND=y compile error
    
    The case of CONFIG_JFFS2_FS_NAND=y got broken recently.
    
    The bug is obvious, and the fix is trivial:

commit c56f34ada055e621ad520ea948a956204971eac2
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 21 20:39:44 2004 -0700

    [PATCH] autofs4: MAINTAINERS update
    
    From: Ian Kent <raven@themaw.net>
    
    This changes the autofs4 maintainer to me.  Recommended by Joe Perches and
    OKed with Jeremy.

commit 2d9a3b29ee46fbc7bf94ae8f4e10cebe7fa1ecfa
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 21 20:39:34 2004 -0700

    [PATCH] autofs4: printk cleanup
    
    From: Ian Kent <raven@themaw.net>
    
    This is a patch contributed by Joe Perches to automatically include the
    function name in the dprintk statements.

commit a7250728d2444155ed5038f756ab7c62a8ec6f03
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 21 20:39:23 2004 -0700

    [PATCH] x86 cpuid cache info update
    
    From: Francois Romieu <romieu@fr.zoreil.com>
    
    Missing cache size format for Intel P4E (p.26 of doc.  241618-025, "Intel
    Processor Identification and the CPUID Instruction").

commit dfbbadeb930b5fc65dbaad3f10e8e2e95e502ec0
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 21 20:39:12 2004 -0700

    [PATCH] i4l: Eicon driver: fix __devexit in prototype
    
    From: Armin Schindler <armin@melware.de>
    
    Fixes a compiler warning about unused Eicon ISDN driver function if hotplug is
    disabled.

commit 12186dc489b3100869c729bf78efe359c43c183d
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 21 20:39:01 2004 -0700

    [PATCH] swsusp: fix devfs breakage introduced in 2.6.6
    
    From: Pavel Machek <pavel@ucw.cz>
    
    This fixes bad interaction between devfs and swsusp.
    
    Check whether the swap device is the specified resume device, irrespective of
    whether they are specified by identical names.
    
    (Thus, device inode aliasing is allowed.  You can say /dev/hda4 instead of
    /dev/ide/host0/bus0/target0/lun0/part4 [if using devfs] and they'll be
    considered the same device.  This is *necessary* for devfs, since the resume
    code can only recognize the form /dev/hda4, but the suspend code would like
    the long name [as shown in 'cat /proc/mounts'].)
    
    [Thanks to devfs hero whose name I forgot.]

commit a7f8c55feb894410ae534fde1d8bab38fb928f22
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 21 20:38:51 2004 -0700

    [PATCH] swsusp: kill unneccessary debugging
    
    From: Pavel Machek <pavel@ucw.cz>
    
    This is no longer neccessary.  We have enough pauses elsewhere, and it works
    well enough that this is not needed.

commit cb79a0b23d25f4b9b5bcf06741892a2fb2fd91a0
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 21 20:38:40 2004 -0700

    [PATCH] blk: clear completion stack pointer on return
    
    From: Jens Axboe <axboe@suse.de>
    
    It doesn't always look safe to let ->waiting remain set when returning from
    functions that set it to point to stack area, since various locations check
    for != NULL to see if it's valid.  So clear it on return from
    ide_do_drive_cmd() and blk_execute_rq().

commit 581ae915a3e17cbee9e393d4cf1e877b08b8a7a1
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 21 20:38:29 2004 -0700

    [PATCH] Sanitise handling of unneeded syscall stubs
    
    From: David Mosberger <davidm@napali.hpl.hp.com>
    
    Below is a patch that tries to sanitize the dropping of unneeded system-call
    stubs in generic code.  In some instances, it would be possible to move the
    optional system-call stubs into a library routine which would avoid the need
    for #ifdefs, but in many cases, doing so would require making several
    functions global (and possibly exporting additional data-structures in
    header-files).  Furthermore, it would inhibit (automatic) inlining in the
    cases in the cases where the stubs are needed.  For these reasons, the patch
    keeps the #ifdef-approach.
    
    This has been tested on ia64 and there were no objections from the
    arch-maintainers (and one positive response).  The patch should be safe but
    arch-maintainers may want to take a second look to see if some __ARCH_WANT_foo
    macros should be removed for their architecture (I'm quite sure that's the
    case, but I wanted to play it safe and only preserved the status-quo in that
    regard).

commit 2b590e8513e1ec259211630c21ef68f3ba2ded73
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 21 20:38:16 2004 -0700

    [PATCH] trivial: remove duplicated #includes
    
    From: Rusty Russell <rusty@rustcorp.com.au>
    
    From:  a.othieno@bluewin.ch (Arthur Othieno)
    From:  Vinay K Nallamothu <vinay-rc@naturesoft.net>
    
    Remove various duplicated #includes
    
    From:  Vinay K Nallamothu <vinay-rc@naturesoft.net>
    
            Use mod_timer in drivers_block_floppy98.c
    
    From:  carbonated beverage <ramune@net-ronin.org>
    
            doc update for bk usage
            bk://... appears to be dead, use http://... instead.

commit f110f331ab5d6024e3c3f90a5895daf8824b2220
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 21 20:38:03 2004 -0700

    [PATCH] trivial: use page_to_phys in dma_map_page()
    
    From: Trivial Patch Monkey <trivial@rustcorp.com.au>
    
    From:  Adam Lackorzynski <adam@os.inf.tu-dresden.de>
    
    dma_map_page() can be simplified by using page_to_phys instead of writing the
    calculation explicitly.

commit 458a55138545b8b098feb29aaf2e509f8fbab4b3
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 21 20:37:52 2004 -0700

    [PATCH] fbdev: mode switching fix.
    
    From: James Simmons <jsimmons@infradead.org>
    
    This fixes the bugs that where in mode switch via stty.
    
    The problem was we couldn't set the mode just by using the x and y
    resolution.  We use modedb to fill in the rest.  There also was a bug that
    allowed you to change the console resolution for drivers with fixed
    resolutions.  This would mess up your display.  Now that is fixed.

commit ef7df33c05a896a989ee9c994a39e42ae78e9b38
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 21 20:37:41 2004 -0700

    [PATCH] fix sendfile on 64bit architectures
    
    From: Andi Kleen <ak@suse.de>
    
    sys_sendfile has a hardcoded 2GB limit.  64bit architectures should
    probably always use sys_sendfile64() in their native system tables, because
    for them sizeof(off_t) == sizeof(loff_t).  This patch does this.  It seemed
    easier to just change the 64bit entry tables instead of fixing up all the
    emulation layers to do 2GB checks on their own.
    
    I changed all 64bit architectures except for parisc64, which seemed to
    already have a sendfile64.

commit 7c0e65552f8d78cc6975195d024181ae18d8fab5
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 21 20:37:30 2004 -0700

    [PATCH] console autodetection for pmac
    
    From: Olaf Hering <olh@suse.de>
    
    This one allows console autodetection for powermacs.

commit 9b19f4f0bf4daf2e8bbec3b4e14d35a0872620a4
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 21 20:37:19 2004 -0700

    [PATCH] gss_api build fix
    
    From: "J. Bruce Fields" <bfields@fieldses.org>
    
    Older gcc's don't like that dimensionless array.  Remove it in favour of a
    pointer to the data.

commit f0ab7d06174e788940874f6ce4f093e8d219feec
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 21 20:37:08 2004 -0700

    [PATCH] vga16fb warning fix
    
    drivers/video/vga16fb.c:1350: warning: assignment makes pointer from integer without a cast

commit ab09753f64432d0c2e0806bd37f8ea6707a4c0bb
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 21 20:36:55 2004 -0700

    [PATCH] Fix !CONFIG_SYSFS build
    
    From: Maneesh Soni <maneesh@in.ibm.com>
    
    The sysfs_rename_dir() interface was changed recently but I forgot to
    change the definition if CONFIG_SYSFS is not defined.

commit de41da3e062d468734efb685b6a48b5dfa58f59f
Author: Nathan Scott <nathans@sgi.com>
Date:   Sat May 22 13:08:56 2004 +1000

    [XFS] Remove unused xfs_trans_bhold_until_committed and related macros.
    
    SGI Modid: xfs-linux:xfs-kern:172237a

commit 9ca701217d628a47f0121dc9a7ec99c6846e6c5e
Author: Nathan Scott <nathans@sgi.com>
Date:   Sat May 22 12:48:18 2004 +1000

    [XFS] Remove no-longer-used variable in log write code, and a
    dated comment.
    
    SGI Modid: xfs-linux:xfs-kern:172225a

commit 07e39c581af2522b17423ba141e181995a7208e9
Author: Nathan Scott <nathans@sgi.com>
Date:   Sat May 22 12:43:37 2004 +1000

    [XFS] Remove xfs_swappable code, its not useful on Linux.
    
    SGI Modid: xfs-linux:xfs-kern:172224a

commit 3b04890b919b144b9f311c33d3a88d2c74d62a72
Author: Eric Sandeen <sandeen@sgi.com>
Date:   Sat May 22 12:39:49 2004 +1000

    [XFS] guard against unused var in new mutex_spinunlock #define
    
    SGI Modid: xfs-linux:xfs-kern:172198a

commit aba4e1e2ce4899fb6b941b9ff8eede1d6212b741
Author: Christoph Hellwig <hch@sgi.com>
Date:   Sat May 22 12:32:18 2004 +1000

    [XFS] Use macros instead of inlines for spinlock wrappers to aid
    debugging.
    
    SGI Modid: xfs-linux:xfs-kern:172120a

commit 8ccfe3c5e92b2e81605a713ccb9e79e2b97f39e9
Author: Timothy Shimmin <tes@sgi.com>
Date:   Sat May 22 12:27:05 2004 +1000

    [XFS] Change xfs_contig_bits to work on 32/64 and both endian styles.
    Fix from nboullis@debian.org.
    
    SGI Modid: xfs-linux:xfs-kern:172115a

commit 46b40350265153bc3d192ac787cdad624c5e460d
Author: Nathan Scott <nathans@sgi.com>
Date:   Sat May 22 12:22:04 2004 +1000

    [XFS] Fix sendfile return code to be ssize_t in all places.
    
    SGI Modid: xfs-linux:xfs-kern:172110a

commit 6ba3988abcbfa70678611cca448fe942d080ce3e
Author: Nathan Scott <nathans@sgi.com>
Date:   Sat May 22 12:18:17 2004 +1000

    [XFS] Use set_current_state instead of direct current->state assignment.
    
    SGI Modid: xfs-linux:xfs-kern:172042a

commit a734b95caa18018568b61a3a5c9d26916b956332
Author: Nathan Scott <nathans@sgi.com>
Date:   Sat May 22 12:00:43 2004 +1000

    [XFS] Fix a use-after-free during transaction commit when the log
    is in error state.
    
    SGI Modid: xfs-linux:xfs-kern:172041a

commit 233dc581fb37803397b193f86a5ac8d257250dbc
Author: Nathan Scott <nathans@sgi.com>
Date:   Sat May 22 10:55:03 2004 +1000

    [XFS] Switch all XFSDEBUG to DEBUG
    
    SGI Modid: xfs-linux:xfs-kern:171990a

commit 1f2a36f1371baa37b04c9c9a6ecc37fe0cfddd0b
Author: Nathan Scott <nathans@sgi.com>
Date:   Sat May 22 10:29:43 2004 +1000

    [XFS] Export/import tunable time intervals as centisecs not jiffies.
    
    SGI Modid: xfs-linux:xfs-kern:171825a

commit 823f57cd1242a1011247281520cc1268ec299b54
Author: Jon Krueger <jpk@sgi.com>
Date:   Sat May 22 10:17:09 2004 +1000

    [XFS] Add support for allocating additional file space in
    stripe width sized chunks. A new fstab/mount option,
    "swalloc" has been defined. If specified when mounting
    a striped file system, allocation requests will be
    rounded up to a stripe width if the file size is >= stripe
    width, and the data is being appended to eof. The
    'swalloc' option is "off" by default.
    
    SGI Modid: xfs-linux:xfs-kern:171710a

commit d263737889ff74e172870e1981c96ffe384236d7
Author: Felix Blyakher <felixb@sgi.com>
Date:   Sat May 22 10:11:19 2004 +1000

    [XFS] Remove speculative preallocation from linvfs_get_block_core.
    All speculative preallocations should be done from xfs_iomap_write_delay.
    
    SGI Modid: xfs-linux:xfs-kern:171620a

commit 2ebec18487b9fa3b5bbaf0f93af584833f97d0d9
Author: Nathan Scott <nathans@sgi.com>
Date:   Sat May 22 09:59:35 2004 +1000

    [XFS] Merge final laptop mode patch (xfssyncd) from Bart Samwel.
    
    SGI Modid: xfs-linux:xfs-kern:171591a

commit 26d93369c06914f24ca01f0b332b2377cd463a63
Author: Nathan Scott <nathans@sgi.com>
Date:   Sat May 22 09:54:24 2004 +1000

    [XFS] Fixup a couple of incorrect xfs_trans_commit calls (bad
    flags/casts).
    
    SGI Modid: xfs-linux:xfs-kern:171452a

commit f32f733672e365cfc731ef0d9d6394d6408f3eab
Author: Nathan Scott <nathans@sgi.com>
Date:   Sat May 22 09:48:35 2004 +1000

    [XFS] Fix some compiler warnings, mark cmn_err as printflike.
    
    SGI Modid: xfs-linux:xfs-kern:171451a

commit 34187d9e14a55a30d3413fe27815eea0490af923
Author: Nathan Scott <nathans@sgi.com>
Date:   Sat May 22 09:43:46 2004 +1000

    [XFS] Make uses of extended inode flags consistent, remove duplicated code.
    
    SGI Modid: xfs-linux:xfs-kern:171450a

commit 8f299acdfd00aa5556cd86cf9e50f8ee2d8dd0e5
Author: Nathan Scott <fsgqa@sgi.com>
Date:   Sat May 22 09:22:38 2004 +1000

    [XFS] Remove the 128K limitation on pagebuf_get_no_daddr() and allow
    the kmem_alloc() to fail.
    
    SGI Modid: xfs-linux:xfs-kern:171201a

commit 94234ddaad5f03613a764a4a4b545ce88a07c399
Author: Christoph Hellwig <hch@sgi.com>
Date:   Sat May 22 09:15:52 2004 +1000

    [XFS] fix direct user memory dereference in bulkstat
    
    SGI Modid: xfs-linux:xfs-kern:171167a

commit 62a604de8f57a9b22c579b2f4fb04a908d90ae4b
Author: Jon Krueger <jpk@sgi.com>
Date:   Sat May 22 09:09:56 2004 +1000

    [XFS] xfs_iomap_write_delay() was doing speculative allocations
     without checking if there were any real blocks already in the
     speculative allocation area. This could result in an allocation
     that overlaps pre-allocated space. This would result in an ASSERT
     failure in debug kernels, or invalid output from xfs_bmap.
     The code will now only do speculative allocation if we are writing
     beyond the current allocation eof.
    
    SGI Modid: xfs-linux:xfs-kern:171163a

commit 63efe3eb615eb210a120c374adf61544a0d07904
Author: Christoph Hellwig <hch@sgi.com>
Date:   Sat May 22 09:04:22 2004 +1000

    [XFS] Properly account for clustered pages in the writeout path
    
    SGI Modid: xfs-linux:xfs-kern:171157a

commit dcb5fff8bc7e00d30e990094429831d30d04994b
Author: Nathan Scott <nathans@sgi.com>
Date:   Sat May 22 08:58:47 2004 +1000

    [XFS] Bump the kmalloc/vmalloc cutoff up to 128k.
    
    SGI Modid: xfs-linux:xfs-kern:171083a

commit 1dee7094c8eaa41247aee8900bdbc76215d48210
Author: Nathan Scott <nathans@sgi.com>
Date:   Sat May 22 08:52:11 2004 +1000

    [XFS] Remove unused transaction pointer from bulkstat.
    
    SGI Modid: xfs-linux:xfs-kern:171081a

commit 0a9bde578b4efd987318eeac784062a96575f08e
Author: Dean Roehrich <roehrich@sgi.com>
Date:   Sat May 22 08:46:40 2004 +1000

    [XFS] Dmapi preunmount event references null pointer
    
    SGI Modid: xfs-linux:xfs-kern:171047a

commit 8370abf06150f8d8381391c0d83f187548fdd33f
Author: Dean Roehrich <roehrich@sgi.com>
Date:   Sat May 22 08:40:25 2004 +1000

    [XFS] Remove some recent dmapi changes
    
    SGI Modid: xfs-linux:xfs-kern:171032a

commit dd2fa29bf6aa4cf17e16b75e37730bf9c3610a10
Author: Nathan Scott <nathans@sgi.com>
Date:   Sat May 22 08:32:56 2004 +1000

    [XFS] Remove xfs_iaccess checks on security namespace, needs to be
    done outside XFS.
    
    SGI Modid: xfs-linux:xfs-kern:170861a

commit 143b1a1782b37e4566c8eb05087eb2cf065d85e4
Author: Nathan Scott <nathans@sgi.com>
Date:   Sat May 22 08:09:47 2004 +1000

    [XFS] Remove extraneous vmtruncate call, missed in earlier merge.
    
    SGI Modid: xfs-linux:xfs-kern:170858a

commit 25d1280a14cde26860e26b6f4fe1fe23e74d2594
Author: Dean Roehrich <roehrich@sgi.com>
Date:   Sat May 22 08:04:01 2004 +1000

    [XFS] Prep for using dmapi code outside of xfs tree
    
    SGI Modid: xfs-linux:xfs-kern:170510a

commit b5e60fe23e011a02c67991caa45c62d632f94f7c
Merge: 3cab1c9... 2a92d69...
Author: Nathan Scott <nathans@sgi.com>
Date:   Sat May 22 07:02:37 2004 +1000

    Merge sgi.com:/source2/linux-2.6 into sgi.com:/source2/xfs-linux-2.6

commit 2868fd353914dd0d34e5e8fbef535983353c46ab
Merge: ddac3ee... cf3035f...
Author: Steve French <cifs.adm@hostme.bitkeeper.com>
Date:   Fri May 21 07:05:27 2004 -0700

    Merge bk://linux.bkbits.net/linux-2.5
    into hostme.bitkeeper.com:/repos/c/cifs/linux-2.5cifs

commit cf3035f7fefb46cdff2621231cf9379f205a8f43
Author: Steve French <stevef@steveft21.ltcsamba>
Date:   Fri May 21 19:47:17 2004 -0500

    Check for kmalloc failure on building full path

commit 5596f50c1ee2fe1cd2cf76a001e3db0a1a1afc6d
Merge: cc3bc0b... 8f7cad8...
Author: Anton Altaparmakov <aia21@cantab.net>
Date:   Fri May 21 11:25:03 2004 +0100

    Merge cantab.net:/home/src/bklinux-2.6
    into cantab.net:/home/src/ntfs-2.6

commit ddac3ee38e2ffb6d486202796836ab44892aaec4
Merge: ef552a8... e808a63...
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Fri May 21 02:42:20 2004 -0700

    Merge bk://gkernel.bkbits.net/libata-2.6
    into ppc970.osdl.org:/home/torvalds/v2.6/linux

commit e808a63c6783d299d253379e836b3af18187a4f1
Merge: cc3bc0b... 4cccadb...
Author: Jeff Garzik <jgarzik@redhat.com>
Date:   Fri May 21 09:03:30 2004 -0400

    Merge redhat.com:/spare/repo/linux-2.6
    into redhat.com:/spare/repo/libata-2.6

commit ef552a869b350c7c101829502c8772b0a00edb1b
Merge: 865a40b... cd0d37f...
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Fri May 21 02:41:29 2004 -0700

    Merge bk://kernel.bkbits.net/jgarzik/i810-audio-2.6
    into ppc970.osdl.org:/home/torvalds/v2.6/linux

commit cd0d37f1e712d985143df550329582e3ae8cabab
Merge: cc3bc0b... c39393c...
Author: Jeff Garzik <jgarzik@redhat.com>
Date:   Fri May 21 08:54:36 2004 -0400

    Merge redhat.com:/spare/repo/linux-2.6
    into redhat.com:/spare/repo/i810-audio-2.6

commit 865a40b2718171ad366f524c3d3ad0df6da90bd6
Merge: fa01152... 2f5a8ca...
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Fri May 21 01:43:19 2004 -0700

    Merge bk://bk.arm.linux.org.uk/linux-2.6-rmk
    into ppc970.osdl.org:/home/torvalds/v2.6/linux

commit fa01152edbd609690315b76cfd444d16ebb99d29
Author: Tony Lindgren <tony@com.rmk.(none)>
Date:   Sat May 22 00:59:48 2004 +0100

    [ARM PATCH] 1887/1: Update OMAP low level debug functions again
    
    Patch from Tony Lindgren
    
    This patch makes the low level debug functions work when support is
    compiled in for multiple OMAPs. The patch also removes now unnecessary
    include, incorrect comment, and SERIAL_REG_SHIFT ifdefs.

commit 83c0cf67fbdccae44c9a41baec0a916f9127503a
Author: Tony Lindgren <tony@com.rmk.(none)>
Date:   Sat May 22 00:55:08 2004 +0100

    [ARM PATCH] 1885/1: OMAP update 2/2: include files
    
    Patch from Tony Lindgren
    
    This patch syncs the mainline kernel with the linux-omap tree.
    The highlights of the patch are:
    - Changed the BOOT_MEM() to use the new IO address (Tony Lindgren)
    - Cleaned up interrupt handler (Juha YrjÃ¶lÃ¤)
    - DMA channel linking for 1610 (Samuel Ortiz)
    - GPIO fixes (Juha YrjÃ¶lÃ¤)
    - IRQ fix for OMAP-730 (Kevin Hilman)
    - OMAP-1510 FPGA interrupt fix (Dirk Behme)
    - OMAP-1610 voltage change settings (Todd Poynor)
    - Uncompress kernel serial output fixes (Tony Lindgren)

commit 74cc274e28f8aaaf99ea69a5b082777749838a42
Author: Tony Lindgren <tony@com.rmk.(none)>
Date:   Sat May 22 00:46:09 2004 +0100

    [ARM PATCH] 1884/1: OMAP update 1/2: arch files
    
    Patch from Tony Lindgren
    
    This patch syncs the mainline kernel with the linux-omap tree.
    The highlights of the patch are:
    - Changed the BOOT_MEM() to use the new IO address (Tony Lindgren)
    - Cleaned up interrupt handler (Juha YrjÃ¶lÃ¤)
    - DMA channel linking for 1610 (Samuel Ortiz)
    - GPIO fixes (Juha YrjÃ¶lÃ¤)
    - IRQ fix for OMAP-730 (Kevin Hilman)
    - OMAP-1510 FPGA interrupt fix (Dirk Behme)
    - OMAP-1610 voltage change settings (Todd Poynor)
    - Uncompress kernel serial output fixes (Tony Lindgren)

commit f4b8b484556e0530ac897c1ff14a335db1c74033
Merge: 51123ec... 210139f...
Author: Russell King <rmk@flint.arm.linux.org.uk>
Date:   Fri May 21 14:49:13 2004 +0100

    Merge bk://dsaxena.bkbits.net/linux-2.6-for-rmk
    into flint.arm.linux.org.uk:/usr/src/bk/linux-2.6-rmk

commit 51123ec9b5ccf00c712c242b52affefb4d4bbdc5
Author: Nicolas Pitre <nico@org.rmk.(none)>
Date:   Fri May 21 11:47:55 2004 +0100

    [ARM PATCH] 1889/1: don't select CONFIG_IWMMXT just yet with Mainstone
    
    Patch from Nicolas Pitre
    
    Since the iWMMXt patch (#1866/1) requires more time to be reviewed,
    this patch will allow merging Mainstone patches without breaking
    anything if iWMMXt support isn't merged yet.
    Should be applied after patch #1867/1.

commit ce9de8d16dcc500548033d94882a99c4a17dfd7e
Author: Nicolas Pitre <nico@org.rmk.(none)>
Date:   Fri May 21 11:44:10 2004 +0100

    [ARM PATCH] 1870/1: defconfig for Mainstone
    
    Patch from Nicolas Pitre

commit f899e97aa0b390e3b2c5b16ca82b9143d02e75f0
Author: Nicolas Pitre <nico@org.rmk.(none)>
Date:   Fri May 21 11:40:03 2004 +0100

    [ARM PATCH] 1868/1: support for LEDs on Mainstone
    
    Patch from Nicolas Pitre

commit a5b4e9ae38e25fdfcd164cb08c2bfdcd2739b876
Author: Nicolas Pitre <nico@org.rmk.(none)>
Date:   Fri May 21 11:35:39 2004 +0100

    [ARM PATCH] 1867/1: support for the Intel Mainstone (PXA27x based) eval board
    
    Patch from Nicolas Pitre

commit 2f5a8caae8231842050aaf4ac704ea950663ecbf
Merge: eb0c34c... 4123def...
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Fri May 21 01:26:15 2004 -0700

    Merge bk://kernel.bkbits.net/davem/net-2.6
    into ppc970.osdl.org:/home/torvalds/v2.6/linux

commit 4123def980217b0bb39c0976eb534fb39ee618bf
Merge: 008fbe6... a2db90b...
Author: David S. Miller <davem@kernel.bkbits.net>
Date:   Fri May 21 00:59:52 2004 -0700

    Merge davem@nuts.davemloft.net:/disk1/BK/net-2.6
    into kernel.bkbits.net:/home/davem/net-2.6

commit eb0c34c80cdb8d15f50eceb46f74844e6a6db58d
Merge: 4686696... 0e2800f...
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Fri May 21 00:54:20 2004 -0700

    Merge http://lia64.bkbits.net/to-linus-2.5
    into ppc970.osdl.org:/home/torvalds/v2.6/linux

commit 468669633eedf98fdbb55f71cfa2e5239c381df8
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Fri May 21 00:46:46 2004 -0700

    [REDO] ramdisk: separate the blockdev backing_dev_info from the hosted inodes
    
    This re-applies the separation of the ramdisk blockdev inode
    backing store and the files that live in the ramdisk.
    
    Cset exclude: torvalds@ppc970.osdl.org|ChangeSet|20040521210025|21437

commit 520808bf20e90fdbdb320264ba7dd5cf9d47dcac
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 21 00:46:17 2004 -0700

    [PATCH] block device layer: separate backing_dev_info infrastructure
    
    Sigh.  ramdisk almost works, except it loses data on umount.
    
    This is because the files which are atop the ramdisk do not contribute to
    dirty memory accounting, but they do need writeback.  So when sync() calls
    sync_inodes_sb() to do the work, sync_inodes_sb() hopelessly underestimates
    the number of pages which need writeback for a complete sync.
    
    If you run `sync' enough times, everything eventually hits "disk" and all is
    happy.
    
    The root cause here is that the ramdisk and the files which it hosts shared
    the same backing_dev_info.  This is inappropriate because the hosted files
    *do* want to writeback and really should contribute to dirty memory
    accounting. But the ramdisk inode itself wants neither.
    
    So.  The patch sets up the infrastructure which permits a blockdev to provide
    a separate backing_dev_info for the files which it hosts.  It's a bit of a
    ramdisk-special.

commit 6051b52a7452dcf8e43a61385d57a3a8ec725724
Merge: 008fbe6... 0e2800f...
Author: David Mosberger <davidm@tiger.hpl.hp.com>
Date:   Fri May 21 00:43:14 2004 -0700

    Merge tiger.hpl.hp.com:/data1/bk/vanilla/linux-2.5
    into tiger.hpl.hp.com:/data1/bk/lia64/to-linus-2.5

commit a2db90b00a2713286e949d6876e4c8ad22fa57d4
Author: Herbert Xu <herbert@gondor.apana.org.au>
Date:   Fri May 21 00:43:13 2004 -0700

    [IPSEC]: Fix state modifications in xfrm_state_update().
    
    doing a mod_timer on a live state without holding a lock or for that
    matter not even checking whether the state is dead is definitely a bad
    idea

commit e98db349a409904af7d821b9df640bef3edab7be
Author: Bart De Schuymer <bdschuym@pandora.be>
Date:   Fri May 21 00:41:11 2004 -0700

    [BRIDGE]: Fix LL_RESERVED_SPACE usage in netfilter code.

commit 34315ee2a952bc3637cba8c7d9d23e0657013b08
Author: Hideaki Yoshifuji <yoshfuji@linux-ipv6.org>
Date:   Fri May 21 00:39:28 2004 -0700

    [IPV4]: Fix deadlock in IP tunnel error path.

commit f98c4469b160fb1be283b1c280548efc800aedcc
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Fri May 21 00:29:23 2004 -0700

    Add 'mode' argument to vfs_symlink.
    
    Right now we ignore it, but we need to pass this down
    to the low-level filesystems if we want to ever make
    knfsd create symlinks with different permissions correctly.

commit bd25e412d992b40e132c2c378bee724fc9f19a17
Merge: cc3bc0b... 516651a...
Author: David S. Miller <davem@nuts.davemloft.net>
Date:   Fri May 21 00:29:11 2004 -0700

    Merge nuts.davemloft.net:/disk1/BK/network-2.6
    into nuts.davemloft.net:/disk1/BK/net-2.6

commit 4e82b2d84725559ff8d7c1ed65299cb65a82062a
Author: Yoshinori Sato <ysato@users.sourceforge.jp>
Date:   Fri May 21 00:09:43 2004 -0700

    [PATCH] H8/300 module support update
    
    - add module support code
    - add H8/300 ELF infomation
    - fix kcore ELF format

commit 13bea95faaea31b297acc1fd7d502c1b3a368073
Author: Yoshinori Sato <ysato@users.sourceforge.jp>
Date:   Fri May 21 00:09:31 2004 -0700

    [PATCH] H8/300 new ide driver support
    
    - new config items
    - interface setup
    - io cleanup

commit b4625576130d8334bfacd3ce7d8e57f02643651c
Author: Yoshinori Sato <ysato@users.sourceforge.jp>
Date:   Fri May 21 00:09:20 2004 -0700

    [PATCH] H8/300 mtd setup fix
    
    - config symbol fix

commit 0e2800fbd97e22dc777d6d1f06b1e8b5f03e7573
Author: David Mosberger <davidm@tiger.hpl.hp.com>
Date:   Fri May 21 00:03:26 2004 -0700

    ia64: Update defconfig

commit fcaec0369ee29411011b0079e3f11fb29e5ca6aa
Author: David Mosberger <davidm@tiger.hpl.hp.com>
Date:   Fri May 21 00:01:30 2004 -0700

    ia64: Kill a warning when arch/ia64/kernel/machvec.c gets compiled on UP.

commit 008fbe6b19a62e70f977012e8509c54fa9e71d4f
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Fri May 21 00:00:25 2004 -0700

    Undo separate backing_dev_info for ramdisk.c.
    
    The code was incomplete. Let's re-do it when the other pieces
    are in place.
    
    Cset exclude: akpm@osdl.org[torvalds]|ChangeSet|20040521202003|24125

commit dd684591c8ecc89d671ce95342a71418b9610940
Author: Peter Chubb <peterc@gelato.unsw.edu.au>
Date:   Thu May 20 23:28:01 2004 -0700

    ia64: Make cond_syscall() declare a dummy prototype so GCC doesn't complain.

commit dacdeaaec7f8d279998fbfb11547ef86eaa4cda7
Author: Andrew Morton <akpm@osdl.org>
Date:   Thu May 20 23:24:27 2004 -0700

    [PATCH] ramfs lfs limit
    
    From: Andrea Arcangeli <andrea@suse.de>
    
    this fixes the 2G limit on ramfs

commit 4a66417543805876c2bd8938657e74fc125af9f6
Author: Andrew Morton <akpm@osdl.org>
Date:   Thu May 20 23:24:17 2004 -0700

    [PATCH] Neaten and fix init/main.c cpu bringup message
    
    From: Andrew Theurer <habanero@us.ibm.com>
    
    Use num_online_cpus in smp_init instead of counting cpus which may or may not
    really be brought up.

commit 245f2bf28387af25a9c27ebc9ea98ba013ae0656
Author: Andrew Morton <akpm@osdl.org>
Date:   Thu May 20 23:24:06 2004 -0700

    [PATCH] Fix power/shutdown.c comments
    
    From: Roger Luethi <rl@hellgate.ch>
    
    Make the comments in drivers/base/power/shutdown.c somewhat less wrong.
    There's still room for improvement :-/.

commit 0c44e490f60d84ffbb91198b718f83591d88c345
Author: Andrew Morton <akpm@osdl.org>
Date:   Thu May 20 23:23:55 2004 -0700

    [PATCH] drop left-over #ifndef __ia64__
    
    From: David Mosberger <davidm@napali.hpl.hp.com>
    
    It used to be that loops_per_jiffy was a macro on ia64, hence it couldn't be
    exported.  That's no longer the case though, so there is no point in
    inhibiting its export (not that it makes any _sense_ to export that value on
    ia64).

commit c3ca375df32d4dd958b023cc3e993bcf31c8f4e5
Author: Andrew Morton <akpm@osdl.org>
Date:   Thu May 20 23:23:44 2004 -0700

    [PATCH] Fix i386/x86_64 cpuid/msr BUG() on impossible CPUs
    
    From: Rusty Russell <rusty@rustcorp.com.au>
    
    Matthieu Castet <castet.matthieu@free.fr> pointed out that testing
    cpu_online(cpu) on a UP system goes BUG().
    
    That's because you're never supposed to ask cpu_online() about a CPU which
    is >= NR_CPUS.  msr and cpuid devices use the minor to indicate the CPU
    number.  Oops.
    
    Fix is to explicitly test cpu < NR_CPUS.  Using cpu_online() is OK;
    although the CPU might go down before you actually read the file, that will
    simply cause junk to be returned.

commit b7e09f0377c616f1f793994d43a760cccc5f4896
Author: Andrew Morton <akpm@osdl.org>
Date:   Thu May 20 23:23:33 2004 -0700

    [PATCH] msr.c touchups
    
    A few things which Lindent got wrong.

commit cb90cf3c4d9472a1a779d3c6ffad825e106b5af0
Author: Andrew Morton <akpm@osdl.org>
Date:   Thu May 20 23:23:23 2004 -0700

    [PATCH] Feed arch/i386/kernel/msr.c through Lindent

commit 2c28ee5a1b0b112290c89215c5cfd29041fd69b0
Author: Andrew Morton <akpm@osdl.org>
Date:   Thu May 20 23:23:12 2004 -0700

    [PATCH] trivial: swsusp section usage
    
    From: Rusty Russell <rusty@rustcorp.com.au>
    
    From:  Pavel Machek <pavel@ucw.cz>
    
    This patch fixes init section usage in swsusp.c: "read_suspend_image()" can
    be __init.

commit 007c4b6278a280370db3ecfab125a359f6577612
Author: Andrew Morton <akpm@osdl.org>
Date:   Thu May 20 23:23:01 2004 -0700

    [PATCH] trivial: fix counter in build_zonelists()
    
    From: Rusty Russell <rusty@rustcorp.com.au>
    
    From:  Stephen Leonard <stephen@phynp6.phy-astr.gsu.edu>
    
    This fixes a counter that is unnecessarily incremented in build_zonelists().

commit b55a523c5cf2e5104bb09ec8957d529457d1f96d
Author: Andrew Morton <akpm@osdl.org>
Date:   Thu May 20 23:22:51 2004 -0700

    [PATCH] trivial: add CC Trivial Patch Monkey to SubmittingPatches
    
    From: Rusty Russell <rusty@rustcorp.com.au>
    
     From:  maximilian attems <janitor@sternwelten.at>
    
    The "Trivial Patch Monkey" is neither documented in MAINTAINERS nor was there
    a note in SubmittingPatches.

commit ed192f49d5919f16364730843ec301e7b3e49e67
Author: Andrew Morton <akpm@osdl.org>
Date:   Thu May 20 23:22:40 2004 -0700

    [PATCH] trivial: drivers/media/video_ir-kbd-gpio.c: kill duplicate include
    
    From: Rusty Russell <rusty@rustcorp.com.au>
    
    From:  a.othieno@bluewin.ch (Arthur Othieno)

commit bea69dca5b7bbe2e525448be5188d9374f3f86e2
Author: Andrew Morton <akpm@osdl.org>
Date:   Thu May 20 23:22:29 2004 -0700

    [PATCH] trivial: Make JFFS2 ready for Linux 2.7
    
    From: Rusty Russell <rusty@rustcorp.com.au>
    
    (OK from maintainer  	David Woodhouse <dwmw2@infradead.org>)
     From:  Sam Ravnborg <sam@ravnborg.org>
    
      From:  <l.s.r@web.de>
      >   since the code for Linux 2.4 compatibility in fs/jffs2 is gone, we can
      >   clean up the Makefile a bit. Following patch makes the Makefile
      >   compatible with Linux 2.7 instead . :) Please consider applying.
    
      If we are going to clean up this I prefer we get rid of the
      local variables.
      See attached patch.
    
      	Sam

commit a5849316e65a88dc3e6e008fcc4d4fc15f087964
Author: Andrew Morton <akpm@osdl.org>
Date:   Thu May 20 23:22:19 2004 -0700

    [PATCH] trivial: fix /proc documentation lies about file-nr
    
    From: Rusty Russell <rusty@rustcorp.com.au>
    
    From:  Tommi Virtanen <tv@tv.debian.net>

commit f1474fba2b8b9b208cc277eab1f1958384928ac3
Author: Andrew Morton <akpm@osdl.org>
Date:   Thu May 20 23:22:08 2004 -0700

    [PATCH] trivial: Fix #endif comment in linux_moduleparam.h
    
    From: Rusty Russell <rusty@rustcorp.com.au>
    
    From:  Pavel Machek <pavel@ucw.cz>
    
    If we are providing "helpful" comment, it should better be correct.

commit 5f6ee5e1e151634e0eb9a3cb8ed1be2e91c9f958
Author: Andrew Morton <akpm@osdl.org>
Date:   Thu May 20 23:21:57 2004 -0700

    [PATCH] trivial: MAINTAINERS fbdev - web site change
    
    From: Rusty Russell <rusty@rustcorp.com.au>
    
    From:  David Eger <eger@theboonies.us>
    
    Doesn't resolve.

commit cdae9df5cf06df481262c2c064dabdaf39d4ff4e
Author: Andrew Morton <akpm@osdl.org>
Date:   Thu May 20 23:21:47 2004 -0700

    [PATCH] trivial: fix old URLs in initrd doc
    
    From: Rusty Russell <rusty@rustcorp.com.au>
    
    From:  Marco Cova <marco.cova@studio.unibo.it>

commit b9175675033db4f8fa16266fe67f48b7c4191b07
Author: Andrew Morton <akpm@osdl.org>
Date:   Thu May 20 23:21:34 2004 -0700

    [PATCH] trivial: add parantheses for if (necessary for cross-compilation)
    
    From: Rusty Russell <rusty@rustcorp.com.au>
    
    From:  Martin Schaffner <schaffner@gmx.li>

commit 2d7010fe3ee27ffaf042ce7aeaa424d05a64a981
Author: Andrew Morton <akpm@osdl.org>
Date:   Thu May 20 23:21:21 2004 -0700

    [PATCH] trivial: scripts_kernel-doc should strip comments inside structs'
    
    From: Rusty Russell <rusty@rustcorp.com.au>
    
    From:  <adobriyan@mail.ru>
    
      Long block comment before declaration moves it out of page in pdfs.
    
      Alexey
    
      $ ./linux-2.6.6-rc2/scripts/kernel-doc.orig -text test.c
      struct stuff:
      struct stuff {
              int a;
              /** comment here*/char b;
      };
      Members:
      a
               aaaa
      b
               bbbbb
      Description:
      stuff
    
      $ ./linux-2.6.6-rc2/scripts/kernel-doc -text test.c
      struct stuff:
      struct stuff {
              int a;
              char b;
      };
      Members:
      a
               aaaa
      b
               bbbbb
      Description:
      stuff

commit d6e56fb22a8c404c272f773115d66fa371daf648
Author: Andrew Morton <akpm@osdl.org>
Date:   Thu May 20 23:21:10 2004 -0700

    [PATCH] trivial: Fix name of biovec slab
    
    From: Rusty Russell <rusty@rustcorp.com.au>
    
    From:  "Chen, Kenneth W" <kenneth.w.chen@intel.com>
    
    Pure cosmetic.  Largest biovec slab is printed as biovec-BIO_MAX_PAGES in
    /proc/slabinfo.  It would be more informative to print actual number instead
    of macro's name.

commit 6a8729ecbba07d23fc375965bf7f9fdbd71f625b
Author: Andrew Morton <akpm@osdl.org>
Date:   Thu May 20 23:21:00 2004 -0700

    [PATCH] cleanup double semicolons
    
    From: Nuno Monteiro <nuno@itsari.org>
    
    Remove lots of double-semicolons.

commit 2907430d779f886beae4c76c49e6b54a836cb9c2
Author: Andrew Morton <akpm@osdl.org>
Date:   Thu May 20 23:20:48 2004 -0700

    [PATCH] Fix NFSD oops in readdir
    
    From: Neil Brown <neilb@cse.unsw.edu.au>
    
    If a single readdir entry needs to be split over two pages in the reply, we
    first encode it into a new page, and then copy the bits into place.  When
    we do this relocation, we have to modify the "offset" pointer to be either
    in the first or the second page, as appropriate.
    
    If the pointer should be at the start of the second page, it is currently
    put past the end of the first page.
    
    Note that as the offset and whole response is known to be 4byte-aligned,
    the offset pointer will never be split over two pages.

commit c9bb1e5de2cc5e0044f753f481ed8c3d375dee1e
Author: Andrew Morton <akpm@osdl.org>
Date:   Thu May 20 23:20:38 2004 -0700

    [PATCH] fbmem: rename sys_inbuf() and sys_outbuf()
    
    From: David Mosberger <davidm@napali.hpl.hp.com>
    
    These aren't syscalls, so rename them.  And make them static.

commit bd105032cbc92a91df094190587bba9af63f8b3a
Author: Andrew Morton <akpm@osdl.org>
Date:   Thu May 20 23:20:26 2004 -0700

    [PATCH] getblk() BUG removal
    
    We keep on getting BUG()s from isofs_read_super() because it passes an insane
    blocksize to bread().  See http://bugme.osdl.org/show_bug.cgi?id=2735 for
    example.
    
    I don't know what's up with isofs, but going BUG in there seems a bit rude.
    Change it to drop a bunch of diagnostics and a backtrace then return a null
    bh*.
    
    Most callers of getblk() don't expect it to fail, so they'll oops anyway.  But
    isofs does actually check for a NULL return.  This way, the machine stays up
    and we get better debug diagnostics.

commit 83804118c3e7927a7a0b5d29100f6e3aaeb0d69c
Author: Andrew Morton <akpm@osdl.org>
Date:   Thu May 20 23:20:14 2004 -0700

    [PATCH] Debugging option to put data symbols in kallsyms
    
    From: Rusty Russell <rusty@rustcorp.com.au>
    
    kallsyms contains only function names, but some debuggers (eg.  xmon on
    PPC/PPC64) use it to lookup symbols: it'd be much nicer if it included data
    symbols too.

commit c83cd7830ff8f40cd6402229b3df150816dbb6b5
Author: Andrew Morton <akpm@osdl.org>
Date:   Thu May 20 23:20:03 2004 -0700

    [PATCH] ramdisk: separate the blockdev backing_dev_info from the hosted inodes'
    
    Give appropriate and separate backing_dev_info's to both the ramdisk blockdev
    inode and to the files which live atop the ramdisk.
    
    Everything works now.

commit ef70d82a1444320534ffcdcf61ea78acc9447944
Author: Andrew Morton <akpm@osdl.org>
Date:   Thu May 20 23:19:51 2004 -0700

    [PATCH] ramdisk: implement writepages()
    
    Implement an empty ->writepages() so that attempts to write back ramdisk pages
    have less work to do.

commit bf1570fe66dbda369313a0aaab10fcedd9986506
Author: Andrew Morton <akpm@osdl.org>
Date:   Thu May 20 23:19:40 2004 -0700

    [PATCH] ramdisk: fix PageUptodate() handling
    
    When a filesystem does getblk() to get a buffer_head against the ramdisk the
    VFS will allocate a new not-uptodate pagecache page and will attach buffers to
    it.
    
    The filesystem will then bring certain buffer_heads uptodate.  But not the
    whole page.
    
    Later, various ramdisk a_ops see the not-uptodate page and wipe the whole
    thing out, including the parts to which the filesystem wrote!
    
    Fix that up by only zapping those parts of the page which are covered by
    non-uptodate buffers.

commit 5e86fee487f036a2db60d20e8ff9c07b735e595a
Author: Andrew Morton <akpm@osdl.org>
Date:   Thu May 20 23:19:28 2004 -0700

    [PATCH] ramdisk: use kmap_atomic() in rd_blkdev_pagecache_IO()
    
    We don't actualy need to kmap the blockdev inode's pages at all, because
    they're ~__GFP_HIGHMEM.  But it's future-safe, and cheap.

commit f8cc96479219109a729af4be7043aaa8ff645b62
Author: Andrew Morton <akpm@osdl.org>
Date:   Thu May 20 23:19:17 2004 -0700

    [PATCH] ramdisk: lock blockdev pages during "IO".
    
    There's a race: one CPU writes a 1k block into a ramdisk page which isn't in
    the blockdev pagecache yet.  It memsets the locked page to zeroes.
    
    While this is happening, another CPU comes in and tries to write a different
    1k block to the "disk".  But it doesn't lock the page so it races with the
    memset and can have its data scribbled over.
    
    Fix this up by locking the page even if it already existed in pagecache.
    
    Locking a pagecache page in a make_request_fn sounds deadlocky but it is not,
    because:
    
    a) ramdisk_writepage() does nothing but a set_bit(), and cannot recur onto
       the same page.
    
    b) Any higher-level code which holds a page lock is supposed to be
       allocating its memory with GFP_NOFS, and in 2.6 kernels that's equivalent
       to GFP_NOIO.
    
       (The distinction between GFP_NOIO and GFP_NOFS basically disappeared
       with the buffer_head LRU, although it was reused for writes to swap).

commit 5be8e6a207fd6105478468aa0baf9552de40ffb8
Author: Andrew Morton <akpm@osdl.org>
Date:   Thu May 20 23:19:06 2004 -0700

    [PATCH] ramdisk memory allocation fixes
    
    Allocating pagecache pages within the disk request_fn is deadlocky and prone
    to page allocation failures, causing write I/O errors.
    
    Attempt to improve things by fiddling with gfp masks.

commit a16539ba6256c0b36a256aa8d27b9257bd6b8d7e
Author: Andrew Morton <akpm@osdl.org>
Date:   Thu May 20 23:18:55 2004 -0700

    [PATCH] ramdisk fixes
    
    - Remove the ramdisk special-case in fs-writeback.c - it will soon be
      unneeded.
    
    - Fix rd_ioctl() to return -ENOTTY on invalid ioctl types, not -EINVAL.
    
    - Make ramdisk Kconfig friendlier.

commit c8dcfa856721fea07e3e35b95f6b6e550977a7b0
Author: Andrew Morton <akpm@osdl.org>
Date:   Thu May 20 23:18:44 2004 -0700

    [PATCH] ppc64: make enter_rtas() take unsigned long arg
    
    From: Paul Mackerras <paulus@samba.org>
    
    We declare enter_rtas with a struct rtas_args * argument, though it is
    supposed to be a physical address, and then every time we call it we cast the
    unsigned long result from __pa() to a void *.  This patch changes the
    declaration of enter_rtas to make it take an unsigned long argument, and
    removes the cast from all the callers.  The actual enter_rtas() routine is in
    assembler and doesn't need to be changed.

commit 3897e8678f3e4947f82cb51cc51a5a575613b93d
Author: Andrew Morton <akpm@osdl.org>
Date:   Thu May 20 23:18:33 2004 -0700

    [PATCH] ppc64: trivial cleanup
    
    From: David Gibson <david@gibson.dropbear.id.au>
    
    The ppc64 head.S contains an enable_32b_mode function which is used
    nowhere.  This patch removes it.

commit 984aa1e8dcf6ed5641135710527b06c27185c3b0
Author: Andrew Morton <akpm@osdl.org>
Date:   Thu May 20 23:18:21 2004 -0700

    [PATCH] ppc64: update xmon debugger
    
    From: Paul Mackerras <paulus@samba.org>
    
    This patch fixes a whole pile of problems in the xmon kernel debugger for
    ppc64.  This basically makes xmon SMP-safe.  Now, when we enter xmon it
    sends an IPI to the other CPUs to get them into xmon too.  It also changes
    the way we do single-stepping and breakpoints so that we don't have to
    remove a breakpoint to proceed from it (instead we either emulate the
    instruction where the breakpoint was, or execute it out of place).  With
    this patch, if we get an exception inside xmon, it will just return to the
    xmon command loop instead of hanging the system as at present.
    
    The patch is quite large because it updates the disassembler to the latest
    version from binutils (trimmed a bit), which is why I didn't cc lkml.

commit 68a6cd9bacc1de770eca1f194855e37b573098ce
Author: Andrew Morton <akpm@osdl.org>
Date:   Thu May 20 23:18:10 2004 -0700

    [PATCH] ppc64: fix inline version of _raw_spin_trylock
    
    From: Paul Mackerras <paulus@samba.org>
    
    When I added the out-of-line spinlocks on PPC64, I inadvertently introduced
    a bug in the inline version of _raw_spin_trylock, where it returns the
    opposite of what it should return.  The patch below fixes it.

commit fb5c2d93c8ac63f27f53b982c03985527b7c56c9
Author: Andrew Morton <akpm@osdl.org>
Date:   Thu May 20 23:17:59 2004 -0700

    [PATCH] ppc64: Fix readq & writeq
    
    From: Benjamin Herrenschmidt <benh@kernel.crashing.org>
    
    This fixes busted asm constraints for readq & writeq implementation on
    ppc64 that resulted in garbage beeing generated for writeq (plus an obvious
    mistake in the prototype).

commit e0689d5df443a7305e421380916646d299223016
Author: Andrew Morton <akpm@osdl.org>
Date:   Thu May 20 23:17:47 2004 -0700

    [PATCH] fix for stuck cpus at boot]
    
    From: Anton Blanchard <anton@samba.org>
    
    From: Rusty Russell <rusty@rustcorp.com.au>
    
    When hotplug cpu isn't enabled, cpu_is_offline is always false.  I had a stuck
    cpu at boot that resulted in a lockup because we tried to start a migration
    thread on it.  Instead of cpu_is_offline we can use !cpu_online which should
    cover both the hotplug cpu enabled and disabled cases.

commit a6e0b36c9d40258a131ff91dc60f3220afb2df99
Author: James Bottomley <jejb@mulgrave.(none)>
Date:   Fri May 21 00:53:24 2004 -0500

    SCSI: make inquiry timeout tuneable
    
    From: garloff@suse.de
    
    Feature
    
    Make the timeout for INQUIRY during SCSI scan adjustable via boot parameter.
    Note that the second INQUIRY does use a shorter timeout, as the long timeout
    is for recovery from the initial reset, not because existing devices would
    take so long to answer INQUIRY. SPC3 says that INQUIRY should be available
    right away, but real life is different unfortunately.

commit fded8abea2a827c011900e1a15f2cec06090a41a
Author: James Bottomley <jejb@mulgrave.(none)>
Date:   Fri May 21 00:51:57 2004 -0500

    SCSI: make SCSI REPORT LUNS the default
    
    From: garloff@suse.de
    
    Cleanup/Feature
    
    Remove CONFIG_SCSI_REPORT_LUNS config option.
    Instead provide BLIST_NOREPORTLUN that can be passed as default_dev_flags
    (but also per device if needed).
    Provide BLIST_REPORTLUN2 that allows trying to use REPORT_LUNS for SCSI-2
    devices, if they are connected to a host adapter supporting more than 8 LUNs
    (and thus avoiding the usual USB crap to render this feature useless when
    used with default_dev_flags).
    
     drivers/scsi/Kconfig        |   11 -----------
     drivers/scsi/scsi_scan.c    |   19 +++++++++----------
     include/scsi/scsi_devinfo.h |    3 +++
     3 files changed, 12 insertions(+), 21 deletions(-)

commit 71d5da93f1fa535292c2ce46ee23b3670015b9f4
Author: James Bottomley <jejb@mulgrave.(none)>
Date:   Fri May 21 00:48:13 2004 -0500

    SCSI: deprecate BLIST_FORCELUN
    
    From: garloff@suse.de
    
    Cleanup
    
    Mark BLIST_FORCELUN as deprecated, as we don't want to collect a list
    of perfectly working multi-LUN devices with BLIST_FORCELUN. Instead
    document max_luns boot/module parameter.

commit dfa412e20a19361931a24774b66b916fba3d1409
Author: James Bottomley <jejb@mulgrave.(none)>
Date:   Fri May 21 00:46:21 2004 -0500

    SCSI: logging optimisation
    
    From: garloff@suse.de
    
    Optimization.
    
    Tell the compiler that the SCSI LOG will not likely happen.

commit cf4616a509b3106a9b87537ed2e644d7a6f62ccf
Author: Rusty Russell <rusty@rustcorp.com.au>
Date:   Fri May 21 00:31:54 2004 -0500

    [PATCH] [TRIVIAL 2.6] drivers_scsi_nsp32.c: kill duplicate
    
     From:  a.othieno@bluewin.ch (Arthur Othieno)

commit e4ac305115e6f379c746f7a33cf8e9c76c5c0363
Author: Guennadi Liakhovetski <g.liakhovetski@gmx.de>
Date:   Fri May 21 00:30:21 2004 -0500

    [PATCH] tmscsim: remove legacy and void code
    
    This one is purely cosmetic - it removes legacy (pre 2.4) and some void
    (e.g. #defined as nothing locks) code. So, it doesn't affect the resulting
    object file.

commit d1fef10e1c2c4bade53534dfa99cc2bb10d26edb
Author: Guennadi Liakhovetski <g.liakhovetski@gmx.de>
Date:   Fri May 21 00:28:12 2004 -0500

    tmscsim: remove procfs write support from tmscsim
    
    From: Christoph Hellwig <hch@lst.de>
    
    When looking at the driver after reviewing the changes I stubled over
    that code.  Almost all of the funcitonality (except DUMP) should go
    through the midlayer and will at least cause some confusion if it
    doesn't.
    
    Also the implementation isn't exactly nice, like kmalloced scsi commands
    and the tytpical 'parsing' macros cut & pasted over all historic scsi
    drivers.  I think we're better of removing it completly and maybe readd
    dump as a sysfs attribute if needed.
    
    500 lines of code gone.

commit 5dc8b542a1f0fe4eda64dcfee7e6c047c8d12b84
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 21 00:27:19 2004 -0500

    [PATCH] qlogicfas408.c warning fix
    
    drivers/scsi/qlogicfas.c:190: warning: initialization from incompatible pointer type

commit d9883b0120a79f26efdcdc6e842803757f6bc84f
Author: Guennadi Liakhovetski <g.liakhovetski@gmx.de>
Date:   Fri May 21 00:21:03 2004 -0500

    [PATCH] tmscsim: no internal queue
    
    Here comes the 2nd one. I wanted to get Christoph's patches now in, but
    already the first his patch comes on the top of this one: remove internal
    command queuing in the driver. And, in fact, it fixes some bugs in it. So,
    they should go in together. Here's the original comment from Christoph's
    email of 1 Feb 2004:
    
    <start quote>
    
    Patch looks mostly good for me.  But there's some fishyness in queuecommand,
    mostly from before you patch:
    
     - many failure cases return one with the new EH code although we wouldn't
       want to requeue the midlayer in that case.  I removed the ifdef and added
       a failed goto to handle them.
     - we need to set cmd->result onlyh if we have an error instead of always
       an overriding it - else it will leak to the midlayer in the return 1
       case.
     - the check for ids out of range are superflous (this was one of the errors
       above, I decided to remove it instead of fixing it).
     - you don't do DC390_UNLOCK_ACB when failing.  While it's a noop I think
       it's bad to have locking macros in place and don't balance them.  You
       should probably remove it completly in one of the next patches.
     - the pDCB->pWaitingSRB looks a bit strange.  By unifying the the codepathes
       it becomes much more readable.
    
    <end quote>

commit aec4b22ad513e361daa2479a5656a10648d0afa5
Author: Christoph Hellwig <hch@lst.de>
Date:   Fri May 21 00:16:18 2004 -0500

    [PATCH] fix assorted wd7000 warnings
    
     - needs linux/delay.h for udelay
     - C doesn't allow taking addresses of register variables and gcc even
       complains these days

commit 65ccf7f1b063c3a4d0ef366634fd60c01c16775e
Author: Guennadi Liakhovetski <g.liakhovetski@gmx.de>
Date:   Fri May 21 00:07:05 2004 -0500

    [PATCH] tmscsim: 64-bit cleanup
    
    Ok, here comes the first one. I chose this one because it fixes an actual
    bug in the driver. This bug was (partially) introduced by myself when
    porting to 2.6. Partly the reason was that I disliked using
    function-like macros as lvalues:
    
    sg_dma_address(x) = ...
    sg_dma_len(x) = ...
    
    [OT] wouldn't it be better to introduce some macros like
    set_sg_dma_{address|len}(x, y)?
    
    A part of the original patch has already been merged (s/UINT/ULONG/), so,
    the actual version is re-diffed against 2.6.6-bk6 and re-tested (on a
    plain Pentium).
    
    Also updates the driver-version, printed on startup.

commit 2a92d69c70562cce482455f2a69d0fdd5688c452
Author: Nathan Scott <nathans@sgi.com>
Date:   Fri May 21 08:56:43 2004 +1000

    Remove a bk ignored XFS cvs directory, accidentally added.

commit 76da14e23b41e1cc5cf492dc0404818b02abce0f
Author: Nathan Scott <nathans@sgi.com>
Date:   Fri May 21 08:47:54 2004 +1000

    Fix an incorrect email address in XFS maintainers section.

commit 9ea9778e2e19e35360b0a3d698b0fde425fe7840
Author: Marcel Holtmann <marcel@holtmann.org>
Date:   Thu May 20 23:01:34 2004 +0200

    [Bluetooth] Kill duplicate includes
    
    This patch removes the duplicate inclusion of linux/config.h in the
    hci_uart driver.
    
    Patch from Arthur Othieno <a.othieno@bluewin.ch>

commit cc3bc0b5cf07dbf18d9fdb3cf04d836f1f84f623
Author: Andrew Morton <akpm@osdl.org>
Date:   Thu May 20 08:22:11 2004 -0700

    [PATCH] ide-disk.c: don't put disks in STANDBY mode on reboot
    
    From: Bartlomiej Zolnierkiewicz <B.Zolnierkiewicz@elka.pw.edu.pl>
    
    From: Rene Herman <rene.herman@keyaccess.nl>
    
    Prevent the disks from spinning down across a reboot.

commit ba44b0661d26bbc4a63be4bdc4e9f577e4c52f65
Merge: a063b7f... 04d0f23...
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Thu May 20 04:07:35 2004 -0700

    Merge http://nfsclient.bkbits.net/linux-2.5
    into ppc970.osdl.org:/home/torvalds/v2.6/linux

commit 04d0f23ca51c0e7957114e5d5d9eeeb081746852
Author: Trond Myklebust <trond.myklebust@fys.uio.no>
Date:   Thu May 20 09:40:39 2004 -0400

    From: Dave Jones <davej@redhat.com>
    
    Remove a local 1k array.

commit 863a6d53f3cc6b21254e2dffebfa13b4fcff0214
Author: Trond Myklebust <trond.myklebust@fys.uio.no>
Date:   Thu May 20 07:54:44 2004 -0400

    From: Arjan van de Ven <arjanv@redhat.com> and akpm
    
    nfs/read.c: dynamically allocate the big structs

commit 338be654db25b1ac5afaef30f6f2e121154adc4d
Author: Trond Myklebust <trond.myklebust@fys.uio.no>
Date:   Thu May 20 07:54:10 2004 -0400

    nfs_writepage_sync stack reduction
    
    Patch from akpm

commit 58c4a5c1dadebbf2a942a02919e1c64b7fbc9033
Author: Trond Myklebust <trond.myklebust@fys.uio.no>
Date:   Thu May 20 07:52:52 2004 -0400

    RPCSEC_GSS: The expiration time passed down in the
        gss context is (duh!) in seconds, not jiffies!
    
    Patch by Bruce Fields

commit 20065001d1e6fb06c89965383d5b8256e250ba57
Author: Trond Myklebust <trond.myklebust@fys.uio.no>
Date:   Thu May 20 07:52:15 2004 -0400

    RPCSEC_GSS: Split out integrity code in wrap and
        unwrap procedures; otherwise they're going to
        be ridiculously long after we add privacy support.
    
    Patch by Bruce Fields

commit d4e0c4b2aaa812b42de22d649b9d1708aca01c91
Author: Trond Myklebust <trond.myklebust@fys.uio.no>
Date:   Thu May 20 07:51:05 2004 -0400

    RPCSEC_GSS: Move EXPORT_SYMBOL's to place where functions
        are defined.
    
    Patch by Bruce Fields

commit 47737de1a783b5001d0c1aa3346e9ed1dae317dc
Author: Trond Myklebust <trond.myklebust@fys.uio.no>
Date:   Thu May 20 07:49:58 2004 -0400

    RPCSEC_GSS: Fix module reference counting.
        Clean up the interface to the GSSAPI code.
    
    Patch by Bruce Fields

commit 71aaeb7f04a23f14d7831db4589ca198ce7719f6
Author: Trond Myklebust <trond.myklebust@fys.uio.no>
Date:   Thu May 20 07:49:16 2004 -0400

    RPCSEC_GSS: Make a couple functions in the krb5 code more
        generally useful. This will help prepare for the spkm3
        and lipkey mechanisms.
    
    Patch by Bruce Fields

commit 2d6e6e142cd7960d18d0dde90e3a021e74515ee7
Author: Trond Myklebust <trond.myklebust@fys.uio.no>
Date:   Thu May 20 07:48:31 2004 -0400

    RPCSEC_GSS: this adds some new trace messages and
         makes existing ones consistent with other
         trace messages in the RPC client.
    
    Patch by Chuck Lever

commit 376282cdfa3a6b35fabe5fecf0cf8505a9da1804
Author: Trond Myklebust <trond.myklebust@fys.uio.no>
Date:   Thu May 20 07:47:44 2004 -0400

    NFS: Patch by Steve Dickson to improve error reporting
        when mounting an NFS filesystem.

commit 6da1abab69dc2d6b12123fba230f539028743b0f
Author: Trond Myklebust <trond.myklebust@fys.uio.no>
Date:   Thu May 20 07:47:06 2004 -0400

    Following a suggestion by Jamie Lokier
    
    RPC: Make "major" timeouts be of fixed length "timeo<<retrans"
         rather than counting the number of retransmissions. The
         clock starts at the first attempt to send each request.
    
    RPC: Ensure that we "slow start" the RTT estimation after a
         major timeout has occurred.

commit 015d2aecf070aa2016f2140dcf09e837e35ec233
Author: Trond Myklebust <trond.myklebust@fys.uio.no>
Date:   Thu May 20 07:46:05 2004 -0400

    NFSv4: Fix a bug in the open reboot-recovery code.

commit 78f673caa6ab336f52834b73b477fb7ad32d734e
Author: Trond Myklebust <trond.myklebust@fys.uio.no>
Date:   Thu May 20 07:45:19 2004 -0400

    NFS O_DIRECT: Change the NFS O_DIRECT path so that it
        no longer calls the generic VFS read and write routines.
        This allows all application read requests to pass through
        to the server, instead of just the ones that appear to be
        inside the file. this eliminates the requirement to use a
        GETATTR operation before each read or write to determine
        where the EOF is. This is a significant performance and
        scalability win.
    
        It also removes all requirements for holding the inode
        semaphore during NFS direct reads and writes, as the read
        and write logic no longer needs atomic access to the size
        of the file. this also helps client CPU scalability by
        reducing the serialization of writes against a single file.
    
        Patch by Chuck Lever

commit e89b7533e3b1e6c0e23e2a2ca70788e2528a4139
Author: Trond Myklebust <trond.myklebust@fys.uio.no>
Date:   Thu May 20 07:43:48 2004 -0400

    NFS_O_DIRECT: there's a code path in nfs_direct_write_seg
        where NFS_I(inode)->data_updates can get out of sync
        with reality, which will lead to a BUG() in nfs_clear_inode
        later on.
    
        Patch by Olaf Kirch.

commit 283eb003dbc08c0445f4882f63744434850c53ae
Author: Trond Myklebust <trond.myklebust@fys.uio.no>
Date:   Thu May 20 07:39:02 2004 -0400

    RPC: Ensure that if we reconnect, we delay by at least 15
         seconds in order to avoid flooding of servers.

commit 8f7cad8f36ef71a245cdd51b9b1d6b3d60344440
Merge: 1cbc020... 1aa3f5e...
Author: Anton Altaparmakov <aia21@cantab.net>
Date:   Thu May 20 11:30:41 2004 +0100

    Merge cantab.net:/home/src/bklinux-2.6
    into cantab.net:/home/src/ntfs-2.6

commit a063b7fc4534001ea43f3539b839d611453b3f25
Merge: 8b38710... 30a7ddb...
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Thu May 20 02:10:26 2004 -0700

    Merge http://jfs.bkbits.net/linux-2.5
    into ppc970.osdl.org:/home/torvalds/v2.6/linux

commit 30a7ddb1d0ec1223dccb2d01e8d11823052770bd
Merge: 3cab1c9... 21776fa...
Author: Dave Kleikamp <shaggy@austin.ibm.com>
Date:   Thu May 20 06:40:21 2004 -0500

    Merge jfs@jfs.bkbits.net:linux-2.5
    into austin.ibm.com:/shaggy/bk/jfs-2.5

commit 21776fa33d124df638bb721a99083d38ee1fa343
Author: Dave Kleikamp <shaggy@austin.ibm.com>
Date:   Thu May 20 05:46:12 2004 -0500

    JFS: [CHECKER] if txCommit fails, don't call d_instantiate
    
    In several functions, d_instantiate is called before the transaction
    is committed.  Under the rare condition that txCommit fails, the new
    inode is released, but the dentry continues to point to it.  This
    can lead to a seg fault.  The fix is to call d_instantiate after
    txCommit has run successfully.

commit 4abe6746d25d61b5ab0bf9d46908fa1bb210f079
Author: David Mosberger <davidm@tiger.hpl.hp.com>
Date:   Thu May 20 00:05:41 2004 -0700

    ia64: Reserve syscall number for kexec_load().

commit 495e4268cdd120b5603ef74a1b277ac9d25197be
Author: David Mosberger <davidm@tiger.hpl.hp.com>
Date:   Wed May 19 23:50:49 2004 -0700

    ia64: Fix bug in fsys_rt_sigprocmask() reported by Andreas Schwab.

commit 8b387102d934da0a5bb514910d6e1e223dbc70bd
Merge: d9f9c3d... 3cab1c9...
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Wed May 19 22:53:13 2004 -0700

    Merge bk://linux-acpi.bkbits.net/linux-acpi-release-2.6.7
    into ppc970.osdl.org:/home/torvalds/v2.6/linux

commit 70e17f405fde233b5bc936dff0aeaa105d4fdad2
Author: Dave Kleikamp <shaggy@austin.ibm.com>
Date:   Thu May 20 00:05:02 2004 -0500

    JFS: [CHECKER] Memory leak on commonly executed path
    
    The jfs_log structure was never being freed at unmount time.

commit 3cab1c951fbb09d5787d2492ca1b3ec8e66eab95
Author: Trond Myklebust <trond.myklebust@fys.uio.no>
Date:   Wed May 19 22:02:07 2004 -0700

    [PATCH] Fix NFS long symlinks checks
    
    The NFS readlink() methods all take a buffer length argument.  Use that
    instead of assuming PAGE_SIZE...
    
    We need to return ENAMETOOLONG rather than EIO.

commit 210139f1ebd1c0f62353f499fb8dbb068c48227f
Author: David Vrabel <dvrabel@arcom.com>
Date:   Wed May 19 20:53:00 2004 -0700

    [ARM] Fix IXP4XX_OST_RELOAD_MASK definition to not mask proper bits
    
    Current definition of OST_RELOAD_MASK masks off bit 2 of
    the timer reload value register when it should mask bits 0
    and 1.  This would cause small timeout values to be loaded
    incorrectly.

commit 516651ae2a6f932025580a44760310a23763b297
Merge: 37433f9... d6523d6...
Author: David S. Miller <davem@nuts.davemloft.net>
Date:   Wed May 19 20:41:54 2004 -0700

    Merge nuts.davemloft.net:/disk1/BK/network-2.6
    into nuts.davemloft.net:/disk1/BK/net-2.6

commit b950c789dbb4e9422928c1628e31ab2a33e48f00
Author: David Vrabel <dvrabel@arcom.com>
Date:   Wed May 19 20:33:31 2004 -0700

    [ARM] Fix IXP4xx CLOCK_TICK_RATE to match HW 66.66... MHz

commit e6863f8bdca23fc1a3c5f9b7ec442585d72511a0
Author: Neil Brown <neilb@cse.unsw.edu.au>
Date:   Wed May 19 18:28:38 2004 -0700

    [PATCH] Invalid notify_change(symlink, [ATTR_MODE]) in nfsd
    
    Make sure NFS client doesn't see errors from mode setting on new symlinks.
    
    When nfsd creates a symlink, it tries to set the mode as the mode is
    carried in the NFS request and some filesystems store a mode.
    
    If the filesystem refuses to set the mode (e.g. -EOPNOTSUPP), this
    error should not be returned to the client.

commit d6523d6439b24cad3a92766136ddad3f17c5bb11
Merge: 775407e... acfaa33...
Author: David S. Miller <davem@nuts.davemloft.net>
Date:   Wed May 19 18:16:00 2004 -0700

    Merge bk://bk.skbuff.net:20606 into nuts.davemloft.net:/disk1/BK/net-2.6

commit acfaa3314dac2aef2ecc518e35ccb06f7008eed5
Author: Hideaki Yoshifuji <yoshfuji@linux-ipv6.org>
Date:   Fri May 21 12:41:07 2004 +0900

    [IPV6] ensure to evaluate the checksum for sockets with the IPV6_CHECKSUM option.

commit ec1a21910c1cfa7c760ea76ab421d31dd4f83421
Author: Hideaki Yoshifuji <yoshfuji@linux-ipv6.org>
Date:   Fri May 21 12:33:44 2004 +0900

    [IPV6] put appropriate checksum for rawv6 sockets even if it was not initialized.

commit b59b3e33cc0d5a8ffa3ef16387e8fe1a01ed83fa
Author: Hideaki Yoshifuji <yoshfuji@linux-ipv6.org>
Date:   Fri May 21 12:30:34 2004 +0900

    [IPV6] unify csum_ipv6_magic() code path for rawv6 sockets.

commit 3280a25271cadd4c958caa44fac6c8e798e1da4a
Author: Hideaki Yoshifuji <yoshfuji@linux-ipv6.org>
Date:   Fri May 21 12:23:35 2004 +0900

    [IPV6] unify XXX_push_pending_frames() code path for rawv6 sockets.

commit 899b0e04643528d251f24448264ebd85eb97a8d0
Author: Hideaki Yoshifuji <yoshfuji@linux-ipv6.org>
Date:   Fri May 21 12:20:15 2004 +0900

    [IPV6] handle return value from ip6_push_pending_frames().

commit 1cbc020d68775124352c311c02da8ef5100dbdb6
Merge: 2e7d221... 6fc4af2...
Author: Anton Altaparmakov <aia21@cantab.net>
Date:   Thu May 20 01:39:43 2004 +0100

    Merge cantab.net:/home/src/bklinux-2.6
    into cantab.net:/home/src/ntfs-2.6

commit 37433f983c0900e9b570c56a3d3fc1b99c2dfa9e
Merge: 31a02fd... 775407e...
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Wed May 19 17:06:02 2004 -0700

    Merge bk://kernel.bkbits.net/davem/sparc-2.6
    into ppc970.osdl.org:/home/torvalds/v2.6/linux

commit b29e527a49283061bb52eb0b980707dd3e081e40
Merge: 86cda02... 6035c8a...
Author: Steve French <stevef@steveft21.ltcsamba>
Date:   Wed May 19 17:59:08 2004 -0500

    Merge bk://cifs.bkbits.net/linux-2.5cifs
    into steveft21.ltcsamba:/usr/src/bk/linux-2.5cifs

commit 6035c8a56f505be065abb6cb6d281a5ece0d5ccb
Author: Steve French <stevef@steveft21.ltcsamba>
Date:   Wed May 19 17:26:15 2004 -0500

    POSIX protocol extensions part 1

commit be825f0272270afd0fc6d8c8ca3fa8f4fdd64201
Author: Dave Jones <davej@redhat.com>
Date:   Wed May 19 17:47:31 2004 +0100

    [AGPGART] Remove lots of trailing whitespace from amd64 gart driver.
    No code changes.

commit cd1414775f901d3fb589b4f120b2826db9433172
Author: Dave Jones <davej@redhat.com>
Date:   Wed May 19 17:43:11 2004 +0100

    [AGPGART] Add missing SIS755 ID to AMD64 AGP driver
    From: Andi Kleen

commit d9f0401c1c26d6de3234bc44022d65fa2925f4c9
Author: Dave Jones <davej@redhat.com>
Date:   Wed May 19 17:41:33 2004 +0100

    [AGPGART] Make the Nvidia AGP driver only announce PCI IDs it actually supports.
    From: Andi Kleen

commit 7e75bfb964f56d1903d46882d1ab4b6fefc32a25
Author: Dave Jones <davej@redhat.com>
Date:   Wed May 19 17:40:43 2004 +0100

    [AGPGART] Make the VIA AGP driver only announce PCI IDs it actually supports.
    Avoids dups with the AMD64 driver.
    From: Andi Kleen

commit 7f28b1fa22f303e1a34abac517f69d21cb542634
Author: Dave Jones <davej@redhat.com>
Date:   Wed May 19 17:39:09 2004 +0100

    [AGPGART] kill trailing whitespace & indentation fixes.

commit 6c42bd0a6e080aa0390902b225c6007daa065344
Author: Dave Jones <davej@redhat.com>
Date:   Wed May 19 17:36:10 2004 +0100

    [AGPGART] Make the driver only announce the PCI IDs it actually supports.
    This avoids dups with the amd64 driver.
    From: Andi Kleen

commit 775407eb73b44cb8f13ec6b1b032ce845d7d6660
Author: Mark Huth <mhuth@mvista.com>
Date:   Wed May 19 09:28:11 2004 -0700

    [IPV6]: Fix sock identity checking bug in tcp_ipv6_check_established.

commit 556769bc0b6b77ea8a1cc2bea73646a07dcfef24
Author: Peter Martuccelli <peterm@redhat.com>
Date:   Wed May 19 09:22:32 2004 -0700

    [NETLINK]: Fix typo in netlink_unicast.

commit 018713f5436611e184e799e880da6c0229d4c600
Author: Daniele Venzano <webvenza@libero.it>
Date:   Wed May 19 11:52:24 2004 -0400

    [netdrvr sis900] fix missing netif_device_detach in suspend

commit a9f5e347be511e90f3b2d073c5b0d5d1cab7c666
Author: Daniele Venzano <webvenza@libero.it>
Date:   Wed May 19 11:50:05 2004 -0400

    [netdrvr sis900] cosmetic header cleanups

commit 31a02fd4e5a6f6af0fcc75bc64d311fb6cde7f86
Merge: 1aa3f5e... c976868...
Author: David S. Miller <davem@nuts.davemloft.net>
Date:   Wed May 19 08:49:54 2004 -0700

    Merge nuts.davemloft.net:/disk1/BK/sparcwork-2.6
    into nuts.davemloft.net:/disk1/BK/sparc-2.6

commit 663f87fa005f95794e6ce4c2496a969634eb0864
Author: Daniele Venzano <webvenza@libero.it>
Date:   Wed May 19 11:33:32 2004 -0400

    [netdrvr sis900] fix ISA bridge detection

commit 70e96af248d811cc22ddc6f67c0d760881236d7d
Author: Arthur Kepner <akepner@sgi.com>
Date:   Wed May 19 07:26:04 2004 -0700

    [TG3]: Fix ethtool -S.

commit ba5a280af865da870b487c4bd8381184a65c7593
Author: Greg Banks <gnb@melbourne.sgi.com>
Date:   Wed May 19 07:16:59 2004 -0700

    [TG3]: Add more ethtool -S stats.

commit 1485d14ffdc4672431aa2a72f708b3fb7fabb62d
Author: Greg Banks <gnb@melbourne.sgi.com>
Date:   Wed May 19 07:15:59 2004 -0700

    [TG3]: Count rx_discards in rx_errors.

commit c976868d53aaf0cf3195f9d99883642066f240bb
Author: Patrick Finnegan <pat@computer-refuge.org>
Date:   Wed May 19 07:11:32 2004 -0700

    [SPARC64]: Verify that boot CPU number is less than NR_CPUS.

commit 1aa3f5edd465c6659c340627b5d5ed8eb9b56c62
Author: Vernon A. Fort <vfort@provident-solutions.com>
Date:   Wed May 19 07:02:27 2004 -0700

    [PATCH] mxser.c kernel-2.6.5
    
    This adds support for the CP-104 Moxa Smartio serial cards.  Just add
    the PCI ID information.

commit 7041e3b9b7b529a1a30fb3c3d8e2e7702929e9d6
Merge: 2e7d221... f1b91e2...
Author: David S. Miller <davem@nuts.davemloft.net>
Date:   Wed May 19 07:02:13 2004 -0700

    Merge bk://kernel.bkbits.net/jgarzik/tg3-2.6
    into nuts.davemloft.net:/disk1/BK/tg3-2.6

commit 09d4eb8f9f2605349cd5b7c3b9a7b9d020c20897
Author: Zhenmin Li <zli4@cs.uiuc.edu>
Date:   Wed May 19 06:59:01 2004 -0700

    [SPARC]: Fix prom_prom_taken[].theres_more setting.

commit ecdd78ec42eae7eb1cbcc015e1c4bccd588284c5
Author: David S. Miller <davem@nuts.davemloft.net>
Date:   Wed May 19 06:56:34 2004 -0700

    [SPARC64]: Mark sort_memlist static.

commit adde86cf97e154592b5d8451d7568929a7b06f23
Author: David S. Miller <davem@nuts.davemloft.net>
Date:   Wed May 19 06:55:29 2004 -0700

    [SPARC64]: Update defconfig.

commit 1ba3a31fdb3fdc15f694f5265359edcd803a27ed
Author: Paul Mackerras <paulus@samba.org>
Date:   Wed May 19 06:35:43 2004 -0700

    [PATCH] ppc64: move kmem_bufctl_t inside #ifndef __ASSEMBLY__
    
    When the kmem_bufctl_t typedef got added to include/asm-ppc64/types.h,
    it got added outside the #ifndef __ASSEMBLY__ section, causing
    assembler errors.  This patch, from David Gibson, moves it inside the
    #ifndef __ASSEMBLY__ region.

commit 245a62a1835c87878e7a96d1bec70687666c5cb1
Author: Greg Ungerer <gerg@snapgear.com>
Date:   Wed May 19 06:15:25 2004 -0700

    [PATCH] m68knommu: add newlines to debug trace in comempci.c
    
    Add newlines to some printk debug trace of comempci.c driver.

commit a7ebf779d17262b41d7c4e78d102bb8902dede5e
Author: Greg Ungerer <gerg@snapgear.com>
Date:   Wed May 19 06:15:14 2004 -0700

    [PATCH] m68knommu: remove un-used libgcc symbols
    
    Remove a lot of un-used and un-needed libgcc funstions from export list
    for m68knommu syms.

commit 72d713729912c32ce645d030cf49fca22ee31e4d
Author: Greg Ungerer <gerg@snapgear.com>
Date:   Wed May 19 06:15:04 2004 -0700

    [PATCH] m68knommu: correct build line for Dragonbakk frame buffer driver
    
    Correct build lines for Motorola Dragonball 68x328 frame buffer driver.
    
    Patch from Georges Menie <georges@menie.org>

commit 8e80d3773b57aabfc3b96f380cea8605975af6e4
Author: Greg Ungerer <gerg@snapgear.com>
Date:   Wed May 19 06:14:53 2004 -0700

    [PATCH] m68knommu: remove ColdFire specific atomic functions
    
    Remove ColdFire specific code sections for atomic_add and atomc_sub.
    
    These are not needed, the m68k asm code for these functions is ColdFire
    clean.

commit 110bf11daea2bbf84f2c4a0997689087b23e85c0
Author: Greg Ungerer <gerg@snapgear.com>
Date:   Wed May 19 06:14:42 2004 -0700

    [PATCH] m68knommu: un-define IO instructions when using smc driver
    
    We should un-define all the x86 style IO routines when redefining local
    versions.

commit 5258ce563c7f898070367ef6cd895552ec70435a
Author: Greg Ungerer <gerg@snapgear.com>
Date:   Wed May 19 06:14:31 2004 -0700

    [PATCH] m68knommu: add init points for Dragonball frame buffer driver
    
    Create init points for the Motorola Dragonball 68x328 frame
    buffer driver.
    
    Patch from Georges Menie <georges@menie.org>

commit 7a28349031d0556b2544bfcf6951cef838938ba6
Author: Greg Ungerer <gerg@snapgear.com>
Date:   Wed May 19 06:14:21 2004 -0700

    [PATCH] m68knommu: add find_next_bit() to bitops.h
    
    A couple of fixups for asm-m68knommu/bitops.h:
    
    . re-order definition of fls(), to be outside __KERNEL__
    . add code for find_next_bit()

commit 3fb529dc04e417a7405eeaa8f04f3c0d6ab365f7
Author: Greg Ungerer <gerg@snapgear.com>
Date:   Wed May 19 06:14:10 2004 -0700

    [PATCH] m68knommu: big clean/fix of Dragonball frame buffer driver
    
    Big cleanup of the Motorola DragonBall 68x328 frame buffer.  It was
    quite broken before.
    
    Patch from Georges Menie <georges@menie.org>.

commit 1d2e3bff3ba8b9838d349467f4c9528b877813a0
Author: Greg Ungerer <gerg@snapgear.com>
Date:   Wed May 19 06:13:59 2004 -0700

    [PATCH] m68knommu: fix cache flush for 5407 ColdFire CPU
    
    Fix the cache flushing code for the ColdFire 5407 CPU.
    
    The cpushl instruction arguments are wrong, causing it to miss some
    cache lines.

commit c5c7dfff6494c407de69e458f43df55c7a3709e0
Author: Greg Ungerer <gerg@snapgear.com>
Date:   Wed May 19 06:13:49 2004 -0700

    [PATCH] ucLinux: return 0 on success from do_munmap() for nommu version
    
    Added a nommu version of sysctl_max_map_count.
    
    Fix return value from do_munmap(), it should return 0 on success not
    EINVAL.

commit 26c78a959a6a64ae032e6d009aaeac7b630ad7e6
Author: Andrew Morton <akpm@osdl.org>
Date:   Wed May 19 06:10:35 2004 -0700

    [PATCH] raid locking fix.
    
    From: Neil Brown <neilb@cse.unsw.edu.au>
    
    Fix bug #2661
    
    Raid currently calls ->unplug_fn under spin_lock_irqsave(), but unplug_fns
    can sleep.
    
    
    After a morning of scratching my head and trying to come up with some that
    does less locking, the following is the best I can come up with.  I'm not
    proud of it but it should work.
    
    If I move "nr_pending" out or rdev into the per-personality structures
    (e.g.  mirror_info), and if I had "atomic_inc_if_nonzero" I could do with
    without locking so much, but random atomic* functions don't seem trivial

commit d0511fb6baaefb3ace24267a749f21ea5a46a8e1
Merge: 86cda02... e1c7684...
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Wed May 19 03:43:40 2004 -0700

    Merge bk://gkernel.bkbits.net/net-drivers-2.6
    into ppc970.osdl.org:/home/torvalds/v2.6/linux

commit 6fc4af2ca32307259cc99e30d6a35a381c345587
Merge: 97e0f20... 1487e21...
Author: Anton Altaparmakov <aia21@cantab.net>
Date:   Wed May 19 11:32:44 2004 +0100

    Merge cantab.net:/home/src/bklinux-2.6
    into cantab.net:/home/src/ntfs-2.6

commit 6316036f8c12dc186eadd3f52797c1148b92123c
Author: Dave Kleikamp <shaggy@austin.ibm.com>
Date:   Wed May 19 05:28:02 2004 -0500

    JFS: set GFP_NOFS to avoid recursing back into file system code

commit e1c768495a10d2cbe7f51ddc650db2098ba7fd8f
Author: Arjan van de Ven <arjanv@redhat.com>
Date:   Wed May 19 06:07:50 2004 -0400

    [PATCH] fealnx smp bugfix
    
            spinlock_t *lp = &((struct netdev_private *)dev->priv)->lock;
    doesn't mix with
    	spin_unlock_irqrestore(&lp, flags);

commit 86cda021b854339a5616776e0c03180803467829
Author: Andrew Morton <akpm@osdl.org>
Date:   Wed May 19 02:43:49 2004 -0700

    [PATCH] s390 atomic_inc_and_test() fix
    
    From: David Mosberger <davidm@napali.hpl.hp.com>

commit 6d06b3427d65884d0f04464d06177bb75a0dc40d
Author: Andrew Morton <akpm@osdl.org>
Date:   Wed May 19 02:42:48 2004 -0700

    [PATCH] sir_dev locking fix
    
    From: Martin Diehl <lists@mdiehl.de>
    
    There was a spin_unlock missing in the raw mode tx-completion path.  Probably
    it slipped through because the raw mode stuff is never reached with my Actisys
    hardware.

commit 2c81f2e4b7db4a609cd70f6f8110ae0cfe3de3ab
Author: Andrew Morton <akpm@osdl.org>
Date:   Wed May 19 02:42:37 2004 -0700

    [PATCH] s390: network driver
    
    From: Martin Schwidefsky <schwidefsky@de.ibm.com>
    
    Network driver changes:
     - iucv: Make grab_param function SMP safe.
     - lcs: Fix null-pointer dereference after unsuccessful set_online.
     - qeth: Fix kmalloc flags in qeth_alloc_reply.
     - qeth: Show broadcase capability also in route4/6 sysfs attributes.
     - qeth: Remove debug code.
     - qeth: Add option to qetharp user space interface to strip unused
             fields from query arp records.
     - qeth: Add shortcut in outbound path for HiperSockets.
     - qeth: Add more info to qeth_perf_stats.
     - qeth: Add support for direct SNMP interface to OSA express cards.

commit b874ee0789fb5ebf48264226e1b16280b40cab7e
Author: Andrew Morton <akpm@osdl.org>
Date:   Wed May 19 02:42:26 2004 -0700

    [PATCH] s390: zfcp host adapater
    
    From: Martin Schwidefsky <schwidefsky@de.ibm.com>
    
    zfcp host adapter change:
     - Remove misplaced dot in error message.
     - Remove unused performance statistics code.

commit 1f5a9d4efab4d779b990c27124703361ed63d40f
Author: Andrew Morton <akpm@osdl.org>
Date:   Wed May 19 02:42:15 2004 -0700

    [PATCH] s390: dasd driver
    
    From: Martin Schwidefsky <schwidefsky@de.ibm.com>
    
    dasd device driver changes:
     - Reset pointer from ccw device to dasd_devmap on device removal.

commit 4120bd7869ca377729b4f31523673f540995cf20
Author: Andrew Morton <akpm@osdl.org>
Date:   Wed May 19 02:42:05 2004 -0700

    [PATCH] s390: core s390
    
    From: Martin Schwidefsky <schwidefsky@de.ibm.com>
    
    s390 core changes:
     - Fix system call trace / audit interface.
     - Fix find_first_bit / find_next_bit inlines assembly constraints.

commit 83ee50f561a349906f463983653f94133bdbf833
Author: Andrew Morton <akpm@osdl.org>
Date:   Wed May 19 02:41:54 2004 -0700

    [PATCH] use-before-uninitialized value in ext3(2)_find_ goal
    
    From: Mingming Cao <cmm@us.ibm.com>
    
    There is a uninitialized goal value being referenced in both ext3 and ext2
    find goal block functions (ext3_find_goal() and ext2_find_goal()).
    
    In the non-sequential write case, these functions check the goal value(non
    zero) before calling ext3(2)_find_near() to find the goal block to
    allocate.
    
    Since the goal value is uninitialized(non zero), the ext3(2)_find_near() is
    never being called in the non-sequential write, thus ext3(2)_find_goal()
    failed to guide a goal block in the random write case.
    
    ext3(2)_new_block() takes the junk goal value and will turn it to goal 0
    since it's normally beyond the filesystem block number limit.  The fix is
    trivial.

commit 2cb2f31fba9f82ffc1a922bf9c731b01cbbffe29
Author: Andrew Morton <akpm@osdl.org>
Date:   Wed May 19 02:41:43 2004 -0700

    [PATCH] Fix overzealous use of online cpu iterators
    
    From: Rusty Russell <rusty@rustcorp.com.au>
    
    The IA64 hotplug CPU merge seems to have included some core changes: in
    particular the recalc_bh_state() needs to sum for all (including offline)
    cpus, since we don't empty the counters on CPU down.  The totals printed by
    /proc/stat (the first loop) should include offline cpus, too (apparently
    printing out the per-cpu lines for offline cpus confuses top).

commit 4a40d604bcf84bd5863c9a7e1d6ca218e164d92f
Author: Andrew Morton <akpm@osdl.org>
Date:   Wed May 19 02:41:33 2004 -0700

    [PATCH] vga16fb-fix
    
    The recent ARM-specific fix broke ia32.  Hopefully the ARM team can find an
    arch-specific implementation of VGA_MAP_MEM() which makes it work.

commit 227d8064a796c3cc28f63401b7b9a1d3c25e9b95
Author: Andrew Morton <akpm@osdl.org>
Date:   Wed May 19 02:41:22 2004 -0700

    [PATCH] VFS cache sizing fix for small machines
    
    From: Matt Mackall <mpm@selenic.com>
    
    Doing the algebra:
    
    c = (a - b) * 3/2
    a' = a - c = a - 3/2(a - b) = (2a - 3a + 3b)/2 = (3b - a)/2
    a' >= 0
    3b - a >= 0
    3b >= a
    b >= a/3
    nr_free_pages() >= mempages/3
    
    We can indeed get into trouble if we try to load a large kernel on a very
    small box (ie kernel reserves more than 2/3 of usable memory).  Surprisingly I
    haven't hit this, but here's a fix.

commit c0b5943fa6d224285595d809379ac9c986a78afe
Author: Andrew Morton <akpm@osdl.org>
Date:   Wed May 19 02:41:11 2004 -0700

    [PATCH] svc_recv() fix
    
    From: "J. Bruce Fields" <bfields@fieldses.org>
    
    svc_recv may call svc_sock_release before rqstp->rq_res is initialized.

commit eeb6f17bd6b7eb4826da599e38cd9108c9b6aba5
Author: Andrew Morton <akpm@osdl.org>
Date:   Wed May 19 02:41:00 2004 -0700

    [PATCH] kNFSd: Add a warning when upcalls fail,
    
    From: NeilBrown <neilb@cse.unsw.edu.au>
    
    From: "J. Bruce Fields" <bfields@fieldses.org>
    
    To help the user diagnose problems caused by user-level daemons not running.

commit 95321936288a431666cbac158db61faa217cfff9
Author: Andrew Morton <akpm@osdl.org>
Date:   Wed May 19 02:40:49 2004 -0700

    [PATCH] kNFSd: Remove check on number of threads waiting on user-space.
    
    From: NeilBrown <neilb@cse.unsw.edu.au>
    
    From: "J. Bruce Fields" <bfields@fieldses.org>
    
    Currently we are counting the number of threads already asleep and returning
    an immediate NFS4ERR_DELAY (==JUKEBOX) error if more than half are already
    asleep.
    
    This patch removes that logic, so instead we only return NFS4ERR_DELAY if an
    upcall times out (if it takes more than a second to return).
    
    With the thread counting there is the risk that even when all the relevant
    subsystems are responsive, the client may still see occasional NFS4ERR_DELAY
    returns just because, by coincidence, several upcalls were initiated at the
    same time.  I expect clients will delay several seconds before retrying after
    NFS4ERR_DELAY, so this will be quite noticeable to users.  Sporadic long
    delays like this are likely to lead users to suspect a problem somewhere, when
    in fact there is none.
    
    The current scheme ensures that we can still process requests not depending on
    upcalls, even when all threads would otherwise be tied up waiting on upcalls.
    However, this is not something that should happen under normal circumstances;
    if a server spends a significant portion of its time with all threads waiting
    for upcalls, this a sign that something is seriously wrong.
    
    In such a circumstance (e.g., an ldap server dies), we can, at least, bound
    the waiting time to a second without the need for counting threads.
    
    In short, removing the thread-counting will allow us to behave predictably
    when things are working, while still allowing some progress when they don't.
    
    It would be a worthwhile project to measure the amount of time threads spend
    waiting for upcalls (or for reads, for that matter); if a significant portion
    of the time they spend handling requests is spent sleeping, then there's an
    opportunity to improve nfsd performance: if we can break the one-to-one
    mapping between requests and threads, then we can lower the number of threads
    required to keep the nfs server busy.
    
    However, both the currently available options for doing this are problematic:
    returning JUKEBOX/DELAY errors at random times will lead to unpredictable
    performance, and saving a copy of the request to be processed from scratch
    again later is wasteful and makes it difficult to provide correct semantics,
    especially in the NFSv4 case.
    
    So for now I believe waits with short timeouts are the best option.

commit 5eb098e2e29c103b1c3b930ee3485e08e6458ac6
Author: Andrew Morton <akpm@osdl.org>
Date:   Wed May 19 02:40:39 2004 -0700

    [PATCH] kNFSd: Reduce timeout when waiting for idmapper userspace daemon.
    
    From: NeilBrown <neilb@cse.unsw.edu.au>
    
    From: "J. Bruce Fields" <bfields@fieldses.org>
    
    1 second should be plenty of time; if we're going to take longer than that
    it's probably better just to return NFS4ERR_DELAY and let the client retry
    anyway.

commit 74d88830f9c3bf5a9bb7dcea5b1611653d13265c
Author: Andrew Morton <akpm@osdl.org>
Date:   Wed May 19 02:40:28 2004 -0700

    [PATCH] kNFSd: Improve idmapper behaviour on failure.
    
    From: NeilBrown <neilb@cse.unsw.edu.au>
    
    From: "J. Bruce Fields" <bfields@fieldses.org>
    
    Slightly better behavior on failed mapping (which may happen either because
    idmapd is not running, or because there it has told us it doesn't know the
    mapping.):
    
    	on name->id (setattr), return BADNAME.  (I used ESRCH to
    		communicate BADNAME, just because it was the first error in
    		include/asm-generic/errno-base.h that had something to
    		do with nonexistance of something, and that we weren't
    		already using.)
    
    	id->name (getattr), return a string representation of the numerical
    		id.  This is probably useless to the client, especially
    		since we're unlikely to accept such a string on a setattr,
    		but perhaps some client will find it mildly helpful.

commit 63b6061586a90999d772042315acc1b5f535f87d
Author: Andrew Morton <akpm@osdl.org>
Date:   Wed May 19 02:40:17 2004 -0700

    [PATCH] kNFSd: Fix race conditions in idmapper
    
    From: NeilBrown <neilb@cse.unsw.edu.au>
    
    From: "J. Bruce Fields" <bfields@fieldses.org>
    
    Also fix leaks on error; split up code a bit to make it easier to verify
    correctness.

commit 8dfec5a1a50ed2e2f5e4dcbe55ebb17b351ac603
Author: Andrew Morton <akpm@osdl.org>
Date:   Wed May 19 02:40:08 2004 -0700

    [PATCH] kNFSd: Protect reference to exp across calls to nfsd_cross_mnt
    
    From: NeilBrown <neilb@cse.unsw.edu.au>
    
    nfsd_cross_mnt can release the reference to the passed svc_export structure
    when it returns a different svc_export structure.  So we need to make sure we
    have a counted reference before, and drop the reference afterwards.

commit a1de7361e932e6f56053cbb9c0964a08a57b0af2
Author: Andrew Morton <akpm@osdl.org>
Date:   Wed May 19 02:39:57 2004 -0700

    [PATCH] kNFSd: Change fh_compose to NOT consume a reference to the dentry.
    
    From: NeilBrown <neilb@cse.unsw.edu.au>
    
    fh_compose currently consumes a reference to the dentry but not the export
    point.  This is both inconsistent and confusing.
    
    It is better if a routine like this doesn't consume reference points, so with
    this patch, it doesn't.  This fixes a couple of very subtle and unusual
    reference counting errors.

commit 4fc696886e058b45c2e84a1f807103bfeec8e0d2
Author: Andrew Morton <akpm@osdl.org>
Date:   Wed May 19 02:39:46 2004 -0700

    [PATCH] kNFSd: Allow larger writes to sunrpc/svc caches.
    
    From: NeilBrown <neilb@cse.unsw.edu.au>
    
    We currently serialize all writes to these caches with queue_io_sem, so we
    only needed one buffer.
    
    There is some need for larger-than-one-page writes, so we can just statically
    allocate a buffer.

commit 00979a9fd0c7f162d5c2c262425936bf4788ded0
Author: Andrew Morton <akpm@osdl.org>
Date:   Wed May 19 02:39:35 2004 -0700

    [PATCH] kNFSd: Make sure CACHE_NEGATIVE is cleared when a cache entry is updates.
    
    From: NeilBrown <neilb@cse.unsw.edu.au>
    
    This is important for update-in-place caches which may change from being
    negative to posative.
    
    Thanks to "J.  Bruce Fields" <bfields@fieldses.org> and Olaf Kirch
    <okir@suse.de>

commit fb4bb3a0ca1b3d6d8f1a451245fd234eddf10ec5
Author: Andrew Morton <akpm@osdl.org>
Date:   Wed May 19 02:39:25 2004 -0700

    [PATCH] kNFSd: Use correct _bh locking on sv_lock.
    
    From: NeilBrown <neilb@cse.unsw.edu.au>
    
    With the _bh, we can deadlock.

commit 64e67fb0628e5e4a657350be69d8ed4fe433101a
Author: Andrew Morton <akpm@osdl.org>
Date:   Wed May 19 02:39:14 2004 -0700

    [PATCH] initialise mca_bus_type even if !MCA_bus
    
    From: "Randy.Dunlap" <rddunlap@osdl.org>
    
    We need to call mca_system_init() to register MCA bus struct, otherwise
    find_mca_adapter() oopses with a NULL ptr dereference.
    
    Fixes this oops reported last week:
    	http://marc.theaimsgroup.com/?l=linux-kernel&m=108455738606747&w=2
    
    Thanks to James Bottomley for pointing this out.

commit a856abc9973d5c62c9c6a4ca91d83c53cf8a2e90
Author: Andrew Morton <akpm@osdl.org>
Date:   Wed May 19 02:39:03 2004 -0700

    [PATCH] drivers/cdrom/aztcd.c warning fix.
    
    From: "Luiz Fernando N. Capitulino" <lcapitulino@prefeitura.sp.gov.br>
    
    drivers/cdrom/azctd.c:379: warning: `pa_ok' defined but not used

commit 6eb8058f3762a4e6a93258fdf73bc15a4d2ebd4a
Author: Andrew Morton <akpm@osdl.org>
Date:   Wed May 19 02:38:53 2004 -0700

    [PATCH] do_generic_mapping_read() cleanup
    
    We just tested the page's uptodateness, no point in doing it again.

commit 54a50867dc605eea9d0eda235e5222399cb7da96
Author: Andrew Morton <akpm@osdl.org>
Date:   Wed May 19 02:38:42 2004 -0700

    [PATCH] efivars: add MODULE_VERSION, remove unnecessary check in exit
    
    From: Matt Domsch <Matt_Domsch@dell.com>
    
    * Adds MODULE_VERSION
    
    * Remove check for efi_enabled in efivars_exit() - we aborted module load at
      init based on this already.

commit 17b62a729dce0e71ccc3465fad396bdcdf010d10
Author: Andrew Morton <akpm@osdl.org>
Date:   Wed May 19 02:38:32 2004 -0700

    [PATCH] EDD: remove unused SCSI header files
    
    From: Matt Domsch <Matt_Domsch@dell.com>
    
    EDD: Remove no longer needed SCSI header file inclusion.
    
    Thanks to ArjanV for reminding me.

commit dc4ed52a0c09fe6d6fc25892c0711d8c226ad281
Author: Andrew Morton <akpm@osdl.org>
Date:   Wed May 19 02:38:21 2004 -0700

    [PATCH] SubmittingDrivers completeness
    
    From: Jonathan Corbet <corbet@lwn.net>
    
    I noticed a patch went in to Documentation/SubmittingDrivers which tweaked
    the URL for KernelTraffic.  Here's a self-serving patch which makes that
    section more complete; to be fair, I added two other sites too.  Just in
    case it's useful.

commit e69c0c5523167790d7231e0d759e9f62b16d696b
Author: Andrew Morton <akpm@osdl.org>
Date:   Wed May 19 02:38:10 2004 -0700

    [PATCH] Quota fix 3 - quota file corruption
    
    From: Jan Kara <jack@ucw.cz>
    
    This patch fixes possible quota files corruption which could happen when root
    did not have any inodes&space allocated.
    
    Originally this could not happen as structure would not be written to disk in
    that case but with journalled quota we need to write even all-zero structure.
    The fix is not very nice but change of the format on disk is probably worse (I
    made a mistake with not including the usage-bitmaps into format :().

commit cfeff00490d9b29aa802a0651a1c53fd0ba0771e
Author: Andrew Morton <akpm@osdl.org>
Date:   Wed May 19 02:37:59 2004 -0700

    [PATCH] SELinux: fix error handling in selinuxfs
    
    From: Stephen Smalley <sds@epoch.ncsc.mil>
    
    This patch against 2.6.6 fixes error handling for two out-of-memory conditions
    in selinuxfs, avoiding potential deadlock due to returning without releasing a
    semaphore.  The patch was submitted by Karl MacMillan of Tresys.

commit 5187778fe86908d134bd13f18812aba7e218525b
Author: Andrew Morton <akpm@osdl.org>
Date:   Wed May 19 02:37:49 2004 -0700

    [PATCH] correct ps2esdi module parm name
    
    From: "Randy.Dunlap" <rddunlap@osdl.org>
    
    The module parameter name is incorrect (looks like a thinko).

commit 4da35e71d7afbbae583aed8e581da9d1e70cdff1
Author: Andrew Morton <akpm@osdl.org>
Date:   Wed May 19 02:37:38 2004 -0700

    [PATCH] Subject: [PATCH] kbuild SUBDIRS="more/ than/ one/"
    
    From: Andreas Gruenbacher <agruen@suse.de>
    
    Here is a patch that re-adds support for more than one directory in SUBDIRS.
    We have a number of packages that use this.
    
    The FORCE dependency of crmodverdir seems unnecessary; removing.
    
    (acked by Sam)

commit e6d0a0a21a842a442266dee8368039a191661d2d
Author: Andrew Morton <akpm@osdl.org>
Date:   Wed May 19 02:37:28 2004 -0700

    [PATCH] mark the `planb' video driver broken
    
    From: Christoph Hellwig <hch@lst.de>
    
    This one is missing updates from the v4l1 interfaces in 2.4 to the 2.6ish
    v4l2 and thus doesn't compile.  While we're at it also remove the
    MOD_{INC,DEC}_USE_COUNT calls in it that were bogus even in 2.4 to avoid
    false positives in grep.

commit 965954596848d1946f97631f91d4c963b4d3d921
Author: Andrew Morton <akpm@osdl.org>
Date:   Wed May 19 02:37:17 2004 -0700

    [PATCH] don't mention MOD_INC_USE_COUNT/MOD_DEC_USE_COUNT in docs
    
    From: Christoph Hellwig <hch@lst.de>
    
    If we want new drivers to not use obsolete interfaces we're better off not
    mentioning it in the documentation.

commit 0054147555288263776ac404cda17fe89c8f2360
Author: Andrew Morton <akpm@osdl.org>
Date:   Wed May 19 02:37:06 2004 -0700

    [PATCH] replace MOD_INC_USE_COUNT in cyber2000fb
    
    From: Christoph Hellwig <hch@lst.de>
    
    This driver is unloadable for the pci case, but not if vlb cards are found so
    we can't use the module_exit removal to lock it into memory.
    
    Replace the MOD_INC_USE_COUNT with __module_get in it's module_init routine.

commit e229be85d8e1cb9d3e8e484aca316e210b77cf52
Author: Andrew Morton <akpm@osdl.org>
Date:   Wed May 19 02:36:55 2004 -0700

    [PATCH] Remove blk_run_queues() remnants
    
    It no longer exists.

commit ccee748ef83e85c36732137353403e04c3bf72d2
Author: Andrew Morton <akpm@osdl.org>
Date:   Wed May 19 02:36:45 2004 -0700

    [PATCH] fore200e.c warning fix
    
    drivers/atm/fore200e.c: In function `fore200e_close':
    drivers/atm/fore200e.c:1659: warning: use of cast expressions as lvalues is deprecated

commit c450028fe381974610696ee80dcc1d78edbb7344
Author: Andrew Morton <akpm@osdl.org>
Date:   Wed May 19 02:36:34 2004 -0700

    [PATCH] reserve syscall slots for kexec
    
    From: "Randy.Dunlap" <rddunlap@osdl.org>
    
    kexec is a fairly major and popular feature.  People are shipping it in
    products, although it is not known if Linux distributors plan to ship it.
    
    The patch reserves the kexec syscall slots to pin the ABI down for
    everyone.
    
    
    - add kexec_load prototype to syscalls.h
    
    - add LINUX_REBOOT_CMD_KEXEC to reboot.h
    
    - add kexec_load syscall for ia32, ia64, x86_64, ppc32, ppc64

commit d06d15d2cdd3920665cef5cc2246342e8593d526
Author: Andrew Morton <akpm@osdl.org>
Date:   Wed May 19 02:36:23 2004 -0700

    [PATCH] Fix for Makefiles to get KBUILD_OUTPUT working
    
    From: Mathieu Chouquet-Stringer <mchouque@online.fr>
    
    If you use O=/someotherdir or KBUILD_OUTPUT=/someotherdir on the following
    architectures: alpha, mips, sh and cris, the build process is probably
    going to fail at one point or another, depending on the target you used,
    because make can't find scripts/Makefile.build or scripts/Makefile.clean.
    
    The following patch fixes this, I greped the whole tree and these four were
    the only "offenders" I found.

commit 64fa9f969e0819916aac7149e577236605024bcb
Author: Andrew Morton <akpm@osdl.org>
Date:   Wed May 19 02:36:12 2004 -0700

    [PATCH] BeFS MAINTAINERS update
    
    From: "Sergey S. Kostyliov" <rathamahata@php4.ru>

commit 05d2b90d5571c51ea2cbe9213164f95dce6b829d
Author: Andrew Morton <akpm@osdl.org>
Date:   Wed May 19 02:36:00 2004 -0700

    [PATCH] Work around gcc 3.3.3-hammer sched miscompilation on x86-64
    
    From: Andi Kleen <ak@muc.de>
    
    The new domain scheduler got miscompiled on x86-64 with gcc 3.3.3-hammer,
    which is shipping with some distributions.  The kernel deadlocks eventually
    under light stress on SMP systems with the right options.
    
    After some experiments it seems this simple change avoids the
    miscompilation.  It also doesn't pessimize the code unduly for other
    architectures.

commit 68978ee77a87d0daa93a9089cf47cea1de0447c9
Author: Andrew Morton <akpm@osdl.org>
Date:   Wed May 19 02:35:49 2004 -0700

    [PATCH] slab: add kmem_cache_alloc_node
    
    From: Manfred Spraul <manfred@colorfullife.com>
    
    The attached patch adds a simple kmem_cache_alloc_node function: allocate
    memory on a given node.  The function is intended for cpu bound structures.
     It's used for alloc_percpu and for the slab-internal per-cpu structures.
    Jack Steiner reported a ~3% performance increase for AIM7 on a 64-way
    Itanium 2.
    
    Port maintainers: The patch could cause problems if CPU_UP_PREPARE is
    called for a cpu on a node before the corresponding memory is attached
    and/or if alloc_pages_node doesn't fall back to memory from another node if
    there is no memory in the requested node.  I think noone does that, but I'm
    not sure.

commit a3e754c2e0c086dfa9e64b672d8a529ef5dfd8c2
Author: Andrew Morton <akpm@osdl.org>
Date:   Wed May 19 02:35:39 2004 -0700

    [PATCH] slab: allow arch override for kmem_bufctl_t
    
    From: Manfred Spraul <manfred@colorfullife.com>
    
    The slab allocator keeps track of the free objects in a slab with a linked
    list of integers (typedef'ed to kmem_bufctl_t).  Right now unsigned int is
    used for kmem_bufctl_t, i.e.  4 bytes per-object overhead.
    
    The attached patch implements a per-arch definition of for this type:
    Theoretically, unsigned short is sufficient for kmem_bufctl_t and this would
    reduce the per-object overhead to 2 bytes.  But some archs cannot operate on
    16-bit values efficiently, thus it's not possible to switch everyone to
    ushort.
    
    The chosen types are a result of dicussions with the various arch maintainers.

commit 897d49be87feb06747a3538e7fbf16cdcd349b75
Author: Andrew Morton <akpm@osdl.org>
Date:   Wed May 19 02:35:27 2004 -0700

    [PATCH] slab: enable runtime cache line size on i386
    
    From: Manfred Spraul <manfred@colorfullife.com>
    
    the attached patch switches the SLAB_HWCACHE_ALIGN alignment from the
    compile time L1 cache line size to the runtime detected value for i386.
    x86-64 already uses the runtime detection.

commit 6fa1d901d520c1414a1cb3386bbaf0c51a445e20
Author: Andrew Morton <akpm@osdl.org>
Date:   Wed May 19 02:35:17 2004 -0700

    [PATCH] Fix arithmetic in shrink_zone()
    
    From: Nick Piggin <nickpiggin@yahoo.com.au>
    
    If the zone has a very small number of inactive pages, local variable
    `ratio' can be huge and we do way too much scanning.  So much so that Ingo
    hit an NMI watchdog expiry, although that was because the zone would have a
    had a single refcount-zero page in it, and that logic recently got fixed up
    via get_page_testone().
    
    Nick's patch simply puts a sane-looking upper bound on the number of pages
    which we'll scan in this round.
    
    
    It fixes another failure case: if the inactive list becomes very small
    compared to the size of the active list, active list scanning (and therefore
    inactive list refilling) also becomes small.
    
    This patch causes inactive list scanning to be keyed off the size of the
    active+inactive lists.  It has the plus of hiding active and inactive
    balancing implementation from the higher level scanning code.  It will
    slightly change other aspects of scanning behaviour, but probably not
    significantly.

commit 8a98d6d1442c243a7fe36ca64d096de019a3d67a
Author: Andrew Morton <akpm@osdl.org>
Date:   Wed May 19 02:35:06 2004 -0700

    [PATCH] dentry size tuning
    
    Experimenting with various values of DENTRY_STORAGE
    
     dentry size      objs/slab   dentry size * objs/slab    inline string
    
       148               26               3848                   32
       152               26               3952                   36
       156               25               3900                   40
       160               24               4000                   44
    
    We're currently at 160.  The patch fairly arbitrarily takes it down to 152, so
    we can fit a 35-char name into the inline part of the dentry.
    
    Also, go back to the old way of sizing d_iname so that any arch-specific
    compiler-forced alignemnts are honoured.

commit f7efcc03fbd1c63fe361bf1a52363c947e557a8c
Author: Andrew Morton <akpm@osdl.org>
Date:   Wed May 19 02:34:55 2004 -0700

    [PATCH] Fix madvise length checking
    
    Fix http://bugme.osdl.org/show_bug.cgi?id=2710.
    
    When the user passed madvise a length of -1 through -4095, madvise blindly
    rounds this up to 0 then "succeeds".

commit c2273c8750fbc74c512edaa900847ed9fa53adde
Author: Andrew Morton <akpm@osdl.org>
Date:   Wed May 19 02:34:45 2004 -0700

    [PATCH] Remove hardcoded offsets from i386 asm
    
    From: Brian Gerst <bgerst@didntduck.org>
    
    Generate offsets for thread_info, cpuinfo_x86, and a few others instead of
    hardcoding them.

commit dba396ff9a722fc94dd14167cb6c0f1ad7a12140
Author: Andrew Morton <akpm@osdl.org>
Date:   Wed May 19 02:34:34 2004 -0700

    [PATCH] fix radio-cadet `readq' namespace clash
    
    It conflicts with the readq() I/O function.

commit 01db63f2527a35cd8c03b18630d20ad11ba49454
Author: Andrew Morton <akpm@osdl.org>
Date:   Wed May 19 02:34:23 2004 -0700

    [PATCH] security: add disable param to capabilities module
    
    From: Chris Wright <chrisw@osdl.org>
    
    Add disable param to capabilities module.  Similar to the SELinux param for
    disabling at boot time.  This allows vendors to ship single binary image with
    capabilities compiled statically, and disable it if they provide another
    security model compiled as module.

commit b27685872d1493caefe5c2d321291cca61a5bb25
Author: Andrew Morton <akpm@osdl.org>
Date:   Wed May 19 02:34:12 2004 -0700

    [PATCH] speed up readahead for seeky loads
    
    From: Ram Pai <linuxram@us.ibm.com>
    
    Currently the readahead code tends to read one more page than it should with
    seeky database-style loads.  This was to prevent bogus readahead triggering
    when we step into the last page of the current window.
    
    The patch removes that workaround and fixes up the suboptimal logic instead.
    
    
    wrt the "rounding errors" mentioned in this patch, Ram provided the following
    description:
    
      Say the i/o size is 20 pages.
    
      Our algorithm starts by a initial average i/o size of 'ra_pages/2' which
      is mostly say 16.
    
      Now every time we take a average, the 'average' progresses as follows
      (16+20)/2=18
      (18+20)/2=19
      (19+20)/2=19
      (19+20)/2=19.....
      and the rounding error makes it never touch 20
    
    
    
    Benchmarking sitrep:
    
    			IOZONE
    
    	run on a nfs mounted filesystem:
    	client machine 2proc, 733MHz, 2GB memory
    	server machine 8proc, 700Mhz, 8GB memory
    
    ./iozone -c -t1 -s 4096m -r 128k

commit f71e41846ae370747a3c1c584c93872050085bb2
Author: Andrew Morton <akpm@osdl.org>
Date:   Wed May 19 02:34:02 2004 -0700

    [PATCH] dpt_i2o warning fixes
    
    drivers/scsi/dpt_i2o.c: In function `adpt_queue':
    drivers/scsi/dpt_i2o.c:442: warning: use of cast expressions as lvalues is deprecated
    drivers/scsi/dpt_i2o.c: In function `adpt_scsi_register':
    drivers/scsi/dpt_i2o.c:2213: warning: use of cast expressions as lvalues is deprecated

commit f2284fc6758b5dbbee433daa4945eb4867edc6f6
Author: Andrew Morton <akpm@osdl.org>
Date:   Wed May 19 02:33:51 2004 -0700

    [PATCH] Mark CONFIG_MAC_SERIAL (drivers/macintosh/macserial.c) as broken
    
    From: Arthur Othieno <a.othieno@bluewin.ch>
    
    CONFIG_MAC_SERIAL (drivers/macintosh/macserial.c) is marked obsolete and
    currently doesn't build.
    
    benh says: "I though build got fixed recently ...  well, anyway, the driver is
    indeed obsolete, there's a new one in drivers/serial now."

commit dada7d8fe3e9a1322aa3e8e9595cc94263ae6b7a
Author: Andrew Morton <akpm@osdl.org>
Date:   Wed May 19 02:33:40 2004 -0700

    [PATCH] PPC32: Minor OCP cleanups
    
    From: Matt Porter <mporter@kernel.crashing.org>
    
    Fixes a warning and a printk format in OCP.

commit 93d14c8440e7b4aaa5fe7da54d990f062aa9c9ea
Author: Andrew Morton <akpm@osdl.org>
Date:   Wed May 19 02:33:30 2004 -0700

    [PATCH] PPC64 iSeries virtual ethernet locking fix
    
    From: Olaf Hering <olh@suse.de>
    
    Missing spin_unlock in the error path.

commit 83615b9dacd0197b3c0a30eacb36c349eaa64eaa
Author: Andrew Morton <akpm@osdl.org>
Date:   Wed May 19 02:33:19 2004 -0700

    [PATCH] PPC64: iSeries virtual ethernet transmit errors
    
    From: Stephen Rothwell <sfr@au1.ibm.com>
    
    This patch stops the iseries_veth driver trying to send every packet to too
    many logical partitions.  Consequently, the number of transmit errors falls to
    (about) zero from a very large number.  This should also improve performance a
    bit as the driver is no longer doing 31 extra skb_clone()s and skb_free()s for
    each packet.

commit 7495a2b5b1e525efe316f97625ce1d35f82cefa7
Author: Andrew Morton <akpm@osdl.org>
Date:   Wed May 19 02:33:08 2004 -0700

    [PATCH] PPC32: Get full register set on bad kernel accesses
    
    From: Paul Mackerras <paulus@samba.org>
    
    At present on ppc32, if the kernel accesses a bad address and causes an
    oops, or drops into the xmon debugger, we only have the contents of the
    volatile registers available to print.  The reason is that we only save the
    volatile registers on entry for a page fault.
    
    This patch restructures the code a bit so that if do_page_fault()
    determines that the page fault is caused by a bad kernel access, it returns
    to the caller, which then saves the full register set into the exception
    frame before calling bad_page_fault().  This way we get the full set of
    registers printed in the oops message.

commit fff2879416f36ca85649cc5d68be2237af24edd0
Author: Andrew Morton <akpm@osdl.org>
Date:   Wed May 19 02:32:57 2004 -0700

    [PATCH] put module license in swim3.c
    
    From: Paul Mackerras <paulus@samba.org>
    
    This patch adds module tags for the swim3 (macintosh floppy) driver.

commit 66a759eb4d85542f900eba2b5f71f7bb3e2b73d4
Author: Andrew Morton <akpm@osdl.org>
Date:   Wed May 19 02:32:47 2004 -0700

    [PATCH] blk_run_page() race fix
    
    blk_run_page() is incorrectly using page->mapping, which makes it racy against
    removal from swapcache.
    
    Make block_sync_page() use page_mapping(), and remove bkl_run_page(), which
    only had one caller.

commit bf7c3d2de183a1c138ac667e41be357ce59f5998
Author: Andrew Morton <akpm@osdl.org>
Date:   Wed May 19 02:32:36 2004 -0700

    [PATCH] system_state splitup
    
    Split the system_state state `SYSTEM_SHUTDOWN' into SYSTEM_HALT,
    SYSTEM_POWER_OFF and SYSTEM_RESTART and export system_state to modules.
    
    This allows driver shutdown routines to know why they are being shutdown.  The
    IDE subsystem wants this so that it knows to not spin the disks down across a
    reboot.

commit d9f9c3da233192545b7a6ee79a58ad50f0081d22
Merge: 8d29f22... 1d39949...
Author: Len Brown <len.brown@intel.com>
Date:   Wed May 19 04:23:09 2004 -0400

    Merge intel.com:/home/lenb/bk/linux-2.6.7
    into intel.com:/home/lenb/src/linux-acpi-test-2.6.7

commit 1fc03632f09967d1da928455280287da199f562a
Author: StÃ©phane Eranian <eranian@hpl.hp.com>
Date:   Wed May 19 00:38:22 2004 -0700

    [PATCH] ia64: fix 1-CPU PMC/PMD dump for /proc/perfmon when PFM_DEBUG is on

commit 10e277527dbcc406bbf1b57e3964e8653248b8eb
Author: Dave Kleikamp <shaggy@austin.ibm.com>
Date:   Wed May 19 01:29:37 2004 -0500

    JFS: Implement multiple commit threads
    
    For scalability, jfs now allows specifying the number of commit
    threads with the module parameter commit_threads=<num>.  It defaults
    to the number of processors.
    
    You can also change the number of txBlocks and txLocks allocated with
    the nTxBlock and nTxLock module parameters.  "modinfo jfs.ko" for
    specifics.

commit 7d2370c15a6bbe7f1e34628123a2a1bb0ab0a62b
Author: James Bottomley <jejb@mulgrave.(none)>
Date:   Wed May 19 01:12:20 2004 -0500

    SCSI: fix Stack overflow when lldd returns SCSI_MLQUEUE_DEVICE_BUSY
    
    From: 	Heiko Carstens <Heiko.Carstens@de.ibm.com>
    
    This happened when sending out the inquiry command and the LLDD was in
    recovery for the specific LUN and returned SCSI_MLQUEUE_DEVICE_BUSY.
    Problem is that max_device_blocked gets set _after_ the inquiry command
    finished. In this specific case max_device_blocked was 0 and thus the
    device was never blocked resulting in the observed stack overflow.
    I moved the initializazion of max_device_blocked from scsi_add_lun to
    sdev_alloc_sdev and the problem is gone.

commit 25c30df185aad6de78353c9299e188f378cfb447
Author: Dave Kleikamp <shaggy@austin.ibm.com>
Date:   Wed May 19 00:20:44 2004 -0500

    JFS: Don't return -EPERM for system xattrs.
    
    Also, we don't need to call jfs_permission directly anymore, just
    permission.
    
    Thanks Andreas Gruenbacher

commit 00f98fd82a4c64614da0b34f529840a5adb0a4db
Author: Greg Kroah-Hartman <greg@kroah.com>
Date:   Tue May 18 20:33:24 2004 -0700

    Reversed pci.ids changes, as Linus already fixed them in his tree

commit 2e7d2212302b8b660963aef7386d6719703f339d
Merge: 164e430... 3b1d74f...
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Tue May 18 19:41:52 2004 -0700

    Merge bk://gkernel.bkbits.net/net-drivers-2.6
    into ppc970.osdl.org:/home/torvalds/v2.6/linux

commit 164e430f5ecbda40ffa6333eea5433028534a28d
Author: Richard Henderson <rth@twiddle.net>
Date:   Tue May 18 19:36:53 2004 -0700

    [PATCH] alpha fp-emu vs module refcounting
    
    From: Ivan Kokshaysky <ink@jurassic.park.msu.ru>
    
    This allows building the math-emu code as a module only when
    CONFIG_SMP is not set. The fp trap handler cannot be preempted
    on a single-CPU (as CONFIG_PREEMPT is not going to be supported
    on alpha), so the module can be safely unloaded at any time.

commit 1d399491a14f1e5fa11765105b0f98fa50a72ff5
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Tue May 18 18:39:10 2004 -0700

    Shorten some PCI device names
    
    Avoid warnings about truncating them when building the
    name database.

commit d3dfd13f4c0c718164dfee507e7a806275c73cac
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Tue May 18 18:03:11 2004 -0700

    Fixed mismerge of cpufreq and pcmcia updates

commit c5fc9c4b897635c2708e5266e63278d733037dc2
Merge: a7c47e5... e79b352...
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Tue May 18 17:56:17 2004 -0700

    Merge bk://cifs.bkbits.net/linux-2.5cifs
    into ppc970.osdl.org:/home/torvalds/v2.6/linux

commit e79b352d9d0a4fb2ae755150b8ab98b12340c907
Merge: 10cba76... 6deb6e5...
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Tue May 18 17:54:10 2004 -0700

    Merge

commit 10cba765d2c2e4dcbab3e8fe7a859435d9098b81
Author: Bartlomiej Zolnierkiewicz <b.zolnierkiewicz@elka.pw.edu.pl>
Date:   Tue May 18 17:42:01 2004 -0700

    [PATCH] ide.c: use less stack in ide_unregister()
    
    From: Chris Wedgwood <cw@f00f.org>
    
    Seperate function, cruft removed and old_hwif
    renamed to something less confusing.

commit 7b4ac0aebb5d89d9b4bd85286a8e6a2bbb650b44
Author: Bartlomiej Zolnierkiewicz <b.zolnierkiewicz@elka.pw.edu.pl>
Date:   Tue May 18 17:41:51 2004 -0700

    [PATCH] H8/300 IDE support update
    
    From: Yoshinori Sato <ysato@users.sourceforge.jp>
    
    With minor fixes from me

commit 77124e4ca8beabd786f7768a64b850c04e9892ef
Author: Chris Mason <mason@suse.com>
Date:   Tue May 18 17:18:07 2004 -0700

    [PATCH] Fix reiserfs inode size update race
    
    reiserfs_file_write unlocks the pages it operated on before updating
    i_size.  This can lead to races with writepage, who checks i_size when
    deciding how much of the file to zero out.
    
    This patch also replaces SetPageReferenced with mark_page_accessed() in
    reiserfs_file_write
    
    This was verified to fix the BitKeeper data corruption problems that
    Steven Cole has been debugging, where concurrent writes to a file and
    writebacks to disk would cause zeroes in the file when CONFIG_PREEMPT
    was enabled.

commit 4b3b8ee5db374b76608537e061f2efd90e21179d
Author: Bartlomiej Zolnierkiewicz <b.zolnierkiewicz@elka.pw.edu.pl>
Date:   Tue May 18 17:14:44 2004 -0700

    [PATCH] ARM/ARM26 IDE cleanups
    
    - clear hwif->hw in setup-pci.c before using it
    
    - fix arch/arm/Kconfig to allow IDE only on platforms supporting it
    
    - introduce IDE_ARCH_OBSOLETE_INIT and ide_default_io_ctl() so
      we can use generic ide_init_hwif_ports() and kill no longer needed
      <asm-arm/arch-*/ide.h> (leave broken lh7a40x and sa1100 versions)
    
    Cross-compile tested on ARM.

commit 20ebd12c55c61800d6c61d388f91220b343ede7e
Author: Bartlomiej Zolnierkiewicz <b.zolnierkiewicz@elka.pw.edu.pl>
Date:   Tue May 18 17:14:31 2004 -0700

    [PATCH] add default ARM/ARM26 IDE host driver
    
    Add drivers/ide/arm/ide_arm.c for simple default IDE interfaces
    and clean obsolete ide_init_default_hwifs() implementations
    in asm-arm/arch-{cl7500,rpc,shark}/ide.h and asm-arm26/ide.h.
    
    This allows us to kill ide_init_default_hwifs() completely
    in the next patch (because lh7a40x and sa1100 are broken).
    
    Cross-compile tested on ARM.

commit a7336008913aebf9dbb91ec3fa6ec5262b16f0b2
Author: Russell King <rmk@flint.arm.linux.org.uk>
Date:   Wed May 19 00:02:38 2004 +0100

    [PCMCIA] Convert IO resource allocation to use struct resource.
    
    This causes PCMCIA to use struct resource internally for IO resources.
    This means that we can keep track of the resource pointer, expand
    this resource if necessary, and use release_resource() on it when
    we're done.
    
    This eventually means that we can change these to normal resources
    which aren't marked busy.

commit 7529d8a40b4747a914ec20c9786c0c0111d8c4c8
Author: Russell King <rmk@flint.arm.linux.org.uk>
Date:   Tue May 18 23:52:46 2004 +0100

    [PCMCIA] Fix a couple of resource bugs.
    
    Fix resource database bug where base + num wraps to zero.  Also,
    ensure that we always take the resource semaphore whenever we
    allocate a resource.

commit d0b6b61e91aee37ce3bfc85631902b923f4cd483
Author: Eugene Surovegin <ebs@ebshome.net>
Date:   Tue May 18 10:26:34 2004 -0700

    [PATCH] I2C PPC4xx IIC driver: 0-length transaction temporary fix
    
    this patch adds temporary fix for 0-length requests (e.g. SMBUS_QUICK) to PPC4xx
    IIC driver. This i2c controller doesn't support such transactions and this patch
    just restores previous driver version behavior making SMBUS_QUICK-based bus scan
    at least partially usable. This is temporary kludge until correct bit-banging
    emulation is implemented.

commit 1776ad0c0d42b8954b05c48d7a2145d43903766a
Author: Eugene Surovegin <ebs@ebshome.net>
Date:   Tue May 18 10:26:13 2004 -0700

    [PATCH] I2C PPC4xx IIC driver: fix debug build with gcc3
    
    this patch fixes PPC4xx IIC driver debug mode build with gcc 3.x compiler.
    Noticed by Evgenij Polyakov.

commit 8c33f77746755c4dda4dae65639fe2a3222a8d1a
Author: Eugene Surovegin <ebs@ebshome.net>
Date:   Tue May 18 10:25:54 2004 -0700

    [PATCH] I2C PPC4xx IIC driver: Kconfig cleanup
    
    this patch renames Kconfig entry for PPC4xx IIC driver making it more clear and
    also adds a help text.

commit cc560373b8932d5271a1060e2b1e9625e36c4d17
Author: Eugene Surovegin <ebs@ebshome.net>
Date:   Tue May 18 10:25:35 2004 -0700

    [PATCH] I2C PPC4xx IIC driver: upgrade to new OCP infrastructre
    
    this patch changes IBM PPC4xx IIC driver to support new PPC OCP infrastructure
    recently added to 2.6 kernel.

commit 1f7303886dea7edef75916daf44a5ce500a3a706
Author: Jean Delvare <khali@linux-fr.org>
Date:   Tue May 18 10:25:14 2004 -0700

    [PATCH] I2C: Incomplete AT24RF08 corruption prevention in i2c eeprom
    
    The AT24RF08 corruption prevention trick that is found in the i2c eeprom
    driver is not correct. The prevention is activated only conditionally,
    while it should be done all the time.

commit 66d20816534a9ad37286540fd371b01eb04515c9
Author: Faik Uygur <faikuygur@tnn.net>
Date:   Tue May 18 10:24:54 2004 -0700

    [PATCH] I2C: use idr_get_new to allocate a bus id in drivers/i2c/i2c-core.c

commit 438e8838a6db566c84975d9521892bf68fc2aea6
Author: Roland Dreier <roland@topspin.com>
Date:   Tue May 18 09:57:17 2004 -0700

    [PATCH] PCI: Add InfiniBand HCA IDs to pci_ids.h
    
    Add InfiniBand HCA IDs to pci_ids.h.

commit f25284153ee217ef20d086f88c342651af8f1a86
Author: Greg Kroah-Hartman <greg@kroah.com>
Date:   Tue May 18 09:56:57 2004 -0700

    [PATCH] PCI: fix up build warnings in pci.ids file.

commit 3b1d74faad7f27deb9c52664599864e1e215045f
Author: Scott Feldman <scott.feldman@intel.com>
Date:   Tue May 18 12:40:13 2004 -0400

    [PATCH] e100: netdev->priv to netdev_priv()
    
    * Convert all netdev->priv references to the fancy new netdev_priv().

commit f05ed6c191fc553b43251abf0066e5735f4c8cc8
Author: Scott Feldman <scott.feldman@intel.com>
Date:   Tue May 18 12:40:05 2004 -0400

    [PATCH] e100: big-endian fix for ethtool -e/E
    
    * Reads/writes from/to eeprom using ethtool weren't working right
      on big-endian.  Now they are.

commit aaeeab249fa61ff14fcc8eaefc04a2b6043b7b94
Author: Scott Feldman <scott.feldman@intel.com>
Date:   Tue May 18 12:39:57 2004 -0400

    [PATCH] e100: fix for incoherent arches
    
    * Changed mapping on Rx skb to bi-directional.  skb->data holds both the
      RFD structure and the packet data, and the RFD is read/written by
      HW.  Issue found on Xscale HW that doesn't handle cache syncs auto-
      matically.  Other changes in patch are whitespace/spelling.

commit aabea325147a05eb97d4f74a4a6d44d8ff9ed124
Author: Jaroslav Kysela <perex@suse.cz>
Date:   Tue May 18 17:50:23 2004 +0200

    ALSA CVS sync

commit 1487e21080e5c6a89af4eb94ba35e9becb087fc9
Merge: 5bac8cd... 3dfcc8a...
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Tue May 18 08:39:33 2004 -0700

    Merge bk://kernel.bkbits.net/gregkh/linux/usb-2.6
    into ppc970.osdl.org:/home/torvalds/v2.6/linux

commit a7c47e51899420a8652d5fd847b56c11229d9712
Author: Steve French <stevef@smfhome1.smfsambadom>
Date:   Tue May 18 10:37:06 2004 -0500

    do not recurse into the filesystem allocating sk buffs

commit 5bac8cdef6f2e36e9f7bdf0a8ba2982f8fb37142
Merge: 485b525... 3065405...
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Tue May 18 08:30:07 2004 -0700

    Merge bk://kernel.bkbits.net/davem/tg3-2.6
    into ppc970.osdl.org:/home/torvalds/v2.6/linux

commit 3065405740f5b72dff227b3f9839d2552ad3fb8c
Merge: b235c7d... d566c1c...
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Tue May 18 08:24:29 2004 -0700

    Merge bk://bk.arm.linux.org.uk/linux-2.6-rmk
    into ppc970.osdl.org:/home/torvalds/v2.6/linux

commit d566c1c580393910b8d8864987391f1c582106b2
Author: Russell King <rmk@flint.arm.linux.org.uk>
Date:   Tue May 18 23:39:02 2004 +0100

    [ARM] Initialise an uninitialised spinlock.

commit b235c7dbfec166e577bd53314cd4fd2fc4cb579d
Author: Paul Mackerras <paulus@samba.org>
Date:   Tue May 18 08:07:43 2004 -0700

    [PATCH] Fix incorrect PT_FPSCR definition
    
    Bryan Rosenburg pointed out that the definition of PT_FPSCR in
    include/asm-ppc64/ptrace.h is wrong.  The patch below fixes it.

commit cb4d14c46e96737048f2e7ad697b2a2d223f520a
Author: Andrew Morton <akpm@osdl.org>
Date:   Tue May 18 08:07:16 2004 -0700

    [PATCH] i2o: reorder of fields in i2o_cmd_passthru structure
    
    From: Markus Lidel <Markus.Lidel@shadowconnect.com>
    
    I have made a mistake in the kernel header i2o-dev.h.  All structures there
    begin with the "iop" first, but in my structure the order is reversed.

commit c8fecbe20b2a65b0598742a04b082921acc40a42
Author: Andrew Morton <akpm@osdl.org>
Date:   Tue May 18 08:07:06 2004 -0700

    [PATCH] md: Fix user-after-free bug in multipath
    
    From: NeilBrown <neilb@cse.unsw.edu.au>
    
    If mddev->thread is non-null later, it gets used.

commit 47653d611c0ee7c546714204e690d6c5783ebf7b
Author: Andrew Morton <akpm@osdl.org>
Date:   Tue May 18 08:02:57 2004 -0700

    [PATCH] ppc64: add device tree pointer for vio devices
    
    From: Anton Blanchard <anton@samba.org>
    
    From: Olaf Hering
    
    Provide pointer into the device-tree for vio devices.

commit 9c4e9729163b0eda40ba5a6d5f05887d651a15d2
Author: Andrew Morton <akpm@osdl.org>
Date:   Tue May 18 08:02:46 2004 -0700

    [PATCH] ppc64: more required exports
    
    From: Anton Blanchard <anton@samba.org>
    
    IBM veth uses these symbols.

commit 7eae4cbdeba517ae4c9d480acb69189747a4d798
Author: Andrew Morton <akpm@osdl.org>
Date:   Tue May 18 08:02:36 2004 -0700

    [PATCH] ppc64: correct return code in iommu_alloc_consistent
    
    From: Anton Blanchard <anton@samba.org>
    
    From: Olof Johansson
    
    iommu_alloc_consistent should return NULL on failure.

commit 825848178ed17a6d136a57e6fe96735a5331180f
Author: Andrew Morton <akpm@osdl.org>
Date:   Tue May 18 08:02:25 2004 -0700

    [PATCH] ppc64: Make PMC6 spin
    
    From: Anton Blanchard <anton@samba.org>
    
    Make PMC6 spin on POWER5 boxes.

commit 56078e539b17d25971c60343b481cb8d7be60f3b
Author: Andrew Morton <akpm@osdl.org>
Date:   Tue May 18 08:02:14 2004 -0700

    [PATCH] ppc64: oprofile fixes
    
    From: Anton Blanchard <anton@samba.org>
    
    - support newer 970 and POWER5 chips.
    
    - use new SIHV/SIPR bits on POWER5.
    
    - fix oops at shutdown.

commit f69ea5542668cec44027002ad2306eb6ef57be22
Author: Andrew Morton <akpm@osdl.org>
Date:   Tue May 18 08:02:03 2004 -0700

    [PATCH] ppc64: 4GB firmware flash fix
    
    From: Anton Blanchard <anton@samba.org>
    
    From: Jake Moilanen
    
    We want to make sure flash list is above 4 gigs, not 4 megs.

commit 804ff5068c0ae825705eb9ec61235a3d7c13e207
Author: Andrew Morton <akpm@osdl.org>
Date:   Tue May 18 08:01:52 2004 -0700

    [PATCH] ppc64: fix rtas flash driver
    
    From: Anton Blanchard <anton@samba.org>
    
    From: John Rose <johnrose@austin.ibm.com>
    
    Please apply the following, which fixes a typo that prevents the creation of
    the manage_flash /proc file.

commit 116288d494948df7da89873262d811c96e663b41
Author: Andrew Morton <akpm@osdl.org>
Date:   Tue May 18 08:01:41 2004 -0700

    [PATCH] ppc64: fix error return in mf_proc
    
    From: Anton Blanchard <anton@samba.org>
    
    This patch was submitted by Olaf Hering to fix mf_proc.c where it does not
    return error values correctly.

commit 4f3a39f1adf4d3da92d75ecd818c87a807e9434e
Author: Andrew Morton <akpm@osdl.org>
Date:   Tue May 18 08:01:30 2004 -0700

    [PATCH] ppc64: add stack overflow detection
    
    From: Anton Blanchard <anton@samba.org>
    
    I only got iseries first time around.  Add CONFIG_DEBUG_STACKOVERFLOW for
    pseries/pmac too.

commit 342c58a6615dbddb693932426c6b858d9ae01dcb
Author: Andrew Morton <akpm@osdl.org>
Date:   Tue May 18 08:01:15 2004 -0700

    [PATCH] ppc64: fix rtas error log location
    
    From: Anton Blanchard <anton@samba.org>
    
    From: Nathan Lynch <nathanl@austin.ibm.com>
    
    Somehow we've been placing the rtas error_log file at /proc/ppc64/error_log,
    which breaks at least one application I know of.  It is supposed to be at
    /proc/ppc64/rtas/error_log (this is the 2.4 behavior).

commit 914c249ba1a36be296447d6ede09051b878521c9
Author: Andrew Morton <akpm@osdl.org>
Date:   Tue May 18 08:01:02 2004 -0700

    [PATCH] ppc64: fix rtas error log length
    
    From: Anton Blanchard <anton@samba.org>
    
    From: Jake Moilanen
    
    Fix for not vmalloc'n space for the sequence number in rtas_log_buf.

commit 24eb3a50e35cbf2a9708c757b301f0549e371533
Author: Andrew Morton <akpm@osdl.org>
Date:   Tue May 18 08:00:49 2004 -0700

    [PATCH] ppc32: PPC4xx fixes
    
    From: Matt Porter <mporter@kernel.crashing.org>
    
    Fixes 440GX UIC code, updates 440GX PVRs, and fixes a typo.

commit f665e63f86a8f32b832da80488ed7c275095597a
Author: Andrew Morton <akpm@osdl.org>
Date:   Tue May 18 08:00:40 2004 -0700

    [PATCH] ppc32: Fix ocp_register_driver() return value
    
    From: Matt Porter <mporter@kernel.crashing.org>
    
    Fixes return value from ocp_register_driver().

commit 281ce5aab50891ee9da14f46ec08e68fc5c86952
Author: Andrew Morton <akpm@osdl.org>
Date:   Tue May 18 08:00:29 2004 -0700

    [PATCH] ppc32: some fixes for 'make O=...'
    
    From: Tom Rini <trini@kernel.crashing.org>
    
    From: Geoffrey LEVAND <geoffrey.levand@am.sony.com>
    
    Fix some of the problems with 'make O=...'
    
    Ack'd by Sam Ravnborg.

commit f9a1922e015165197b19d60c731d34d0b6e14c5d
Author: Andrew Morton <akpm@osdl.org>
Date:   Tue May 18 08:00:19 2004 -0700

    [PATCH] ppc32: remove 'mem_pieces_append'
    
    From: Tom Rini <trini@kernel.crashing.org>
    
    From: Fabian.Frederick <Fabian.Frederick&prov-liege.be>
    
    Remove mem_pieces_append, it is never used.

commit 7f54374766e4cb9858011fe38bcf3bccde00cec3
Author: Andrew Morton <akpm@osdl.org>
Date:   Tue May 18 08:00:08 2004 -0700

    [PATCH] ppc32: update Motorola LoPEC and Sandpoint defconfigs
    
    From: Tom Rini <trini@kernel.crashing.org>
    
    Update the Motorola LoPEC and Sandpoint config files.

commit 7977c341e73f78e6b06fd1dc213c64d4567eb8b6
Author: Andrew Morton <akpm@osdl.org>
Date:   Tue May 18 07:59:56 2004 -0700

    [PATCH] ppc32: fix MOD_{INC,DEC}_USE_COUNT abuse in 4xx/8xx code
    
    From: Christoph Hellwig <hch@lst.de>
    
    Note that most of the drivers are in a compiling shape currently, but I
    want to get rid of the last callers of those.
    
    (acked by Tom Rini)

commit dba1c9130b925b5d9a698d0b0c5e20f4fa82fdce
Author: Andrew Morton <akpm@osdl.org>
Date:   Tue May 18 07:59:45 2004 -0700

    [PATCH] ppc32: update defconfigs
    
    From: Paul Mackerras <paulus@samba.org>
    
    This patch updates several of the ppc32 defconfigs.

commit 66a7d6a6beccfa45a9ee698ae1d1cf4e0548871d
Author: Andrew Morton <akpm@osdl.org>
Date:   Tue May 18 07:59:34 2004 -0700

    [PATCH] ppc32: Handle altivec assist exception properly
    
    From: Paul Mackerras <paulus@samba.org>
    
    On machines with Altivec (i.e.  G4 and G5 processors), the altivec
    floating-point instructions can operate in two modes: one where
    denormalized inputs or outputs are truncated to zero, and one where they
    aren't.  In the latter mode the processor can take an exception when it
    encounters denormalized floating-point inputs or outputs rather than
    dealing with them in hardware.
    
    This patch adds code to deal properly with the exception, by emulating the
    instruction that caused the exception.  Previously the kernel just switched
    the altivec unit into the truncate-to-zero mode, which works but is a bit
    gross.  Fortunately there are only a limited set of altivec instructions
    which can generate the assist exception, so we don't have to emulate the
    whole altivec instruction set.
    
    This patch also makes sure that we always have a handler for the altivec
    unavailable exception.  Without this, if you run a kernel that is not
    configured for altivec support on a machine with altivec, it works fine
    until a user process tries to execute an altivec instruction.  At that
    point the kernel thinks it has taken an unknown exception and panics.  With
    this patch it sends a SIGILL to the process instead.

commit 26b271be52e086c7715b3d583270aac7aa6dcd7c
Author: Andrew Morton <akpm@osdl.org>
Date:   Tue May 18 07:59:23 2004 -0700

    [PATCH] ppc32: some whitespace fixes
    
    From: Paul Mackerras <paulus@samba.org>
    
    This patch does nothing but fix up whitespace in three files in arch/ppc.
    It deletes trailing blanks and tabs in several places and joins two lines
    that didn't need to be split.

commit ea8b94ab8c821b018a55dfe4d827a4be95c21c3c
Author: Andrew Morton <akpm@osdl.org>
Date:   Tue May 18 07:59:11 2004 -0700

    [PATCH] ppc32: IBM PowerPC 750GX Support
    
    From: Benjamin Herrenschmidt <benh@kernel.crashing.org>
    
    From: Bryan Rittmeyer <bryan@staidm.org>
    
    This patch adds preliminary support for the IBM PowerPC 750GX.  In summary
    this part is a PPC750FX ramped to 1 GHz with a 1MB 4-way L2 and more
    advanced I/O pipelining.  It is beginning to appear in embedded systems and
    was rumored to be under evaluation inside Apple.  Tested on PVR 70020101;
    please merge.
    
    http://www-3.ibm.com/chips/techlib/techlib.nsf/products/PowerPC_750GX_Microprocessor

commit 8d29f222dccfb64e9f3055c0db95d8ff5e32bf57
Merge: 4a80425... f0f8402...
Author: Len Brown <len.brown@intel.com>
Date:   Tue May 18 08:36:27 2004 -0400

    Merge intel.com:/home/lenb/src/linux-acpi-test-2.6.6
    into intel.com:/home/lenb/src/linux-acpi-test-2.6.7

commit 4a80425d51eb92e27249203a8cea8e7d3500f2e5
Merge: 81b9a74... b80345b...
Author: Len Brown <len.brown@intel.com>
Date:   Tue May 18 08:17:19 2004 -0400

    Merge intel.com:/home/lenb/bk/linux-2.6.7
    into intel.com:/home/lenb/src/linux-acpi-test-2.6.7

commit 97e0f20f1b208ec1609d3c711e156973b6c98b91
Merge: 08be072... 85c1836...
Author: Anton Altaparmakov <aia21@cantab.net>
Date:   Tue May 18 11:57:20 2004 +0100

    Merge cantab.net:/home/src/bklinux-2.6
    into cantab.net:/home/src/ntfs-2.6

commit f0f84027cfef1dd5d5088b4457ff3fa71b1edca1
Merge: a0e9957... 9028100...
Author: Len Brown <len.brown@intel.com>
Date:   Tue May 18 06:39:54 2004 -0400

    Merge intel.com:/home/lenb/src/old/linux-acpi-test-2.6.5
    into intel.com:/home/lenb/src/linux-acpi-test-2.6.6

commit 7530537ba14c3dfde498f0eb3d5518ec48bcb7e5
Author: Dave Kleikamp <shaggy@austin.ibm.com>
Date:   Tue May 18 05:36:21 2004 -0500

    JFS: error in __get_metapage caused by invalid size from ea_get

commit 9028100e01896a8d9052127dce5e85d0aaf96edc
Author: Len Brown <len.brown@intel.com>
Date:   Tue May 18 06:30:02 2004 -0400

    [ACPI] remove /proc files before unloading modules
    from Sau Dan Lee, Zhenyu Wang
    http://bugzilla.kernel.org/show_bug.cgi?id=2705

commit 3dfcc8ac75ee105618ad8c0f868289ae7d0349ce
Author: Greg Kroah-Hartman <greg@kroah.com>
Date:   Tue May 18 02:56:06 2004 -0700

    Some more misc wait_ms() conversions to use msleep()

commit e1a929afac1039b934e0c3f950f0e6b58ea5cf84
Author: Greg Kroah-Hartman <greg@kroah.com>
Date:   Tue May 18 02:51:33 2004 -0700

    Input: remove wait_ms() in place of using msleep()

commit a8e9fcec583103b6fca14839fbae353639be10b9
Author: Greg Kroah-Hartman <greg@kroah.com>
Date:   Tue May 18 02:00:39 2004 -0700

    I2C: change i2c_delay() to use msleep() instead.

commit 3f3f36e1720c8fa99c471d8fdcef37fee79646cb
Author: Greg Kroah-Hartman <greg@kroah.com>
Date:   Tue May 18 02:00:04 2004 -0700

    USB: remove wait_ms() from usb.h as it's no longer needed.

commit 65815c0b77237ffee8836c9021ee48612e82b64b
Author: Greg Kroah-Hartman <greg@kroah.com>
Date:   Tue May 18 01:58:57 2004 -0700

    USB: remove ehci and ohci's private sleep function and use msleep() instead.

commit ad72bf4f33fcd6fa52a125d429ec615ae547abed
Author: Greg Kroah-Hartman <greg@kroah.com>
Date:   Tue May 18 01:57:20 2004 -0700

    USB: clean up usages of wait_ms() now that we have msleep()

commit a715632eb997394bdaa33540592443d3b680a242
Author: Greg Kroah-Hartman <greg@kroah.com>
Date:   Tue May 18 01:56:35 2004 -0700

    USB: remove usb_uninterruptible_sleep_ms() now that we have msleep()

commit fee7e3cabb6d1f37aadce4c467985e6f5d82c00c
Author: Greg Kroah-Hartman <greg@kroah.com>
Date:   Tue May 18 01:55:19 2004 -0700

    Remove libata's version of msleep()

commit baff547cf790ac119c48d6fc2322115222c539b3
Author: Greg Kroah-Hartman <greg@kroah.com>
Date:   Tue May 18 01:51:44 2004 -0700

    Delete block/carmel.c's version of msleep()

commit 8365c315507fe10925bb3281d74444fe02935b25
Author: Greg Kroah-Hartman <greg@kroah.com>
Date:   Tue May 18 01:49:36 2004 -0700

    Add msleep function to the kernel core to prevent duplication.

commit d05aa0e77a8caffde6600609df35ba9448c6a4fb
Author: Len Brown <len.brown@intel.com>
Date:   Tue May 18 04:19:00 2004 -0400

    [ACPI] revert button module unload fix (2281)
    Cset exclude: len.brown@intel.com|ChangeSet|20040503042906|02093
    Cset exclude: len.brown@intel.com|ChangeSet|20040428081825|02121
    Cset exclude: len.brown@intel.com[lenb]|ChangeSet|20040428071221|03892

commit 485b52519cab6d1198c2548a92b26f8d3dd272ec
Author: David S. Miller <davem@nuts.davemloft.net>
Date:   Tue May 18 01:03:47 2004 -0700

    Resolve merge conflicts.

commit 4282368cbcc697ea545ab4c1306aa769c660d115
Merge: b80345b... 7ff622f...
Author: David S. Miller <davem@nuts.davemloft.net>
Date:   Mon May 17 22:49:51 2004 -0700

    Fix merge conflicts.

commit b80345b7d08708cf7b14cd9c1f2b310a4a31aa86
Merge: 08be072... 9150818...
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Mon May 17 17:39:21 2004 -0700

    Merge bk://kernel.bkbits.net/davem/sparc-2.6
    into ppc970.osdl.org:/home/torvalds/v2.6/linux

commit 85c183610f1a525d7a18502229432cf7d7808db1
Author: Anton Altaparmakov <aia21@cantab.net>
Date:   Tue May 18 00:45:04 2004 +0100

    NTFS: Add a new address space operations struct, ntfs_mst_aops, for mst
          protected attributes.  This is because the default ntfs_aops do not
          make sense with mst protected data and were they to write anything to
          such an attribute they would cause data corruption so we provide
          ntfs_mst_aops which does not have any write related operations set.

commit e3126f86060cc401ca43b61eedc96d25dfd990ac
Author: Steve French <stevef@smfhome1.smfsambadom>
Date:   Mon May 17 12:44:28 2004 -0500

    free mempool in correct order

commit 6c923d8c7ec180bcd5d0a9424ba66fd6da78b277
Author: Jaroslav Kysela <perex@suse.cz>
Date:   Mon May 17 19:35:07 2004 +0200

    ALSA CVS update - Jaroslav Kysela <perex@suse.cz>
    PCM Midlevel
    Call hwsync at the start of SYNC_PTR ioctl

commit dcc6460a2a426102896f2342e132ecd0edcd137f
Author: Jaroslav Kysela <perex@suse.cz>
Date:   Mon May 17 19:34:43 2004 +0200

    ALSA CVS update - Jaroslav Kysela <perex@suse.cz>
    PCM Midlevel,ALSA Core
    Added SYNC_PTR ioctl for the PCM interface.

commit 4ba2128a9d524e15ecb0dcdf577324173bccba71
Author: Jaroslav Kysela <perex@suse.cz>
Date:   Mon May 17 19:34:22 2004 +0200

    ALSA CVS update - Jaroslav Kysela <perex@suse.cz>
    ICE1712 driver
    <Dirk.Kalis@t-online.de>
    ice1712 patch for dsp24 value cards
    Without this patch in envy24control no controls for DAC and ADC
    available because no number of dacs and adcs is given.

commit 5aeb5e480422cee99be66d370c0333e87f956b0f
Author: Jaroslav Kysela <perex@suse.cz>
Date:   Mon May 17 19:33:58 2004 +0200

    ALSA CVS update - Takashi Iwai <tiwai@suse.de>
    ICE1712 driver
    fixes by Christoph Haderer <chris_web@gmx.at>:
    - added the support of DAC/ADC mute switches
    - fixed the capture route enum.

commit fc1e9e0eb9f9595c08b9369b44c9bf6f3641273f
Author: Jaroslav Kysela <perex@suse.cz>
Date:   Mon May 17 19:33:36 2004 +0200

    ALSA CVS update - Takashi Iwai <tiwai@suse.de>
    ICE1712 driver
    Added the support of Aureon 7.1-Universe.

commit ae5f5d815dfee0bb149c22fc95507f20d293ea16
Author: Jaroslav Kysela <perex@suse.cz>
Date:   Mon May 17 19:33:15 2004 +0200

    ALSA CVS update - Takashi Iwai <tiwai@suse.de>
    ICE1712 driver
    added headphone amplifier switch.
    initial patch by Radoslaw 'AstralStorm' Szkodzinski.

commit 7113237cbd0c07769731243135ad8d79b258603e
Author: Jaroslav Kysela <perex@suse.cz>
Date:   Mon May 17 19:32:48 2004 +0200

    ALSA CVS update - Takashi Iwai <tiwai@suse.de>
    RME HDSP driver,RME9652 driver
    fixed invalid spin_lock/unlock_irq() in the prepare callback.

commit 1accddfdde0caaa11b8cee3f5aa9240c1628be10
Author: Jaroslav Kysela <perex@suse.cz>
Date:   Mon May 17 19:32:27 2004 +0200

    ALSA CVS update - Takashi Iwai <tiwai@suse.de>
    CS4236+ driver
    Added the new pnp id for an Intel mobo.

commit 9dbfb3acce18250b0204814ba902530c31406fef
Author: Jaroslav Kysela <perex@suse.cz>
Date:   Mon May 17 19:32:03 2004 +0200

    ALSA CVS update - Takashi Iwai <tiwai@suse.de>
    ATIIXP driver
    - probe only audio codecs.
    - use enums instead of embedded numbers.
    - added KERN_ERR prefix to the error messages.

commit 910b5e1465451ecb1935241bbc51bbbf1b83ffaf
Author: Jaroslav Kysela <perex@suse.cz>
Date:   Mon May 17 19:31:38 2004 +0200

    ALSA CVS update - Takashi Iwai <tiwai@suse.de>
    PPC PMAC driver,PPC Tumbler driver
    Giuliano Pochini <pochini@shiny.it>:
    fixed the return value of interrupt handlers.

commit 952f2fb223c3a1a7fbc699e48139402b7bdde857
Author: Jaroslav Kysela <perex@suse.cz>
Date:   Mon May 17 19:31:16 2004 +0200

    ALSA CVS update - Takashi Iwai <tiwai@suse.de>
    PCM Midlevel
    fixed the buffer id confliction in the case of CONTINUOUS or ISA buffers.

commit 3f06603e6988ab30b80514a10333ec95caf52a51
Author: Jaroslav Kysela <perex@suse.cz>
Date:   Mon May 17 19:30:56 2004 +0200

    ALSA CVS update - Clemens Ladisch <clemens@ladisch.de>
    USB generic driver
    fix typo

commit 414e8312f7a25d3ba120226d9ee46e2cb5495127
Author: Jaroslav Kysela <perex@suse.cz>
Date:   Mon May 17 19:30:31 2004 +0200

    ALSA CVS update - Clemens Ladisch <clemens@ladisch.de>
    USB generic driver
    Roland UA-1000 support

commit 4789a1c8615de8949934adef01ed952df0c501af
Author: Jaroslav Kysela <perex@suse.cz>
Date:   Mon May 17 19:30:09 2004 +0200

    ALSA CVS update - Clemens Ladisch <clemens@ladisch.de>
    AC97 Codec Core
    STAC9758: stereo mutes, jack configuration

commit d08a161d6ab179bda3e62b50d23cf3e7189bed5d
Author: Jaroslav Kysela <perex@suse.cz>
Date:   Mon May 17 19:29:43 2004 +0200

    ALSA CVS update - Takashi Iwai <tiwai@suse.de>
    PARISC Harmony driver
    - fixed the buffer allocation with the new API.
    - optimized the rate and format setting.
    - removed redundant call of buffer release.
    - removed invalid __devinit prefix.

commit 82aecba7c7a554223b588a05f30ce4ce62ef8998
Author: Dave Jones <davej@redhat.com>
Date:   Mon May 17 18:29:24 2004 +0100

    [AGPGART] Don't abort if Intel-agp can't find AGP capability.
    Some bridges don't have this set it seems.
    Detective work, and fixing by Andi Kleen.

commit 382305a33f3d313ca36f83a81f25531daba1e035
Author: Jaroslav Kysela <perex@suse.cz>
Date:   Mon May 17 19:29:19 2004 +0200

    ALSA CVS update - Takashi Iwai <tiwai@suse.de>
    Documentation,ICE1724 driver,ICE1712 driver
    - added model module option to specify board model to snd-ice1712 and snd-ice1724
      drivers.
    - removed ez8 option from ice1724.  this can be specified as 'model=ez8' option.
    - rewritten some struct init in C99 style.
    - function for accessing i2c of ice1724 (for future use).

commit fcdd368f2c7fa33f04ce973cb54dde750de38691
Author: Jaroslav Kysela <perex@suse.cz>
Date:   Mon May 17 19:28:56 2004 +0200

    ALSA CVS update - Takashi Iwai <tiwai@suse.de>
    Sound Core PDAudioCF driver
    - fixed the changed function decleration.
    - fixed the return value from cast check.

commit 769109501232c3725046f3030c24fe2c7046fa3c
Author: Jaroslav Kysela <perex@suse.cz>
Date:   Mon May 17 19:28:36 2004 +0200

    ALSA CVS update - Takashi Iwai <tiwai@suse.de>
    VIA82xx driver
    renamed the elements of 'input source select' control to avoid confusion.
    
    formerly used words 'Line' and 'Mic', which have nothing to do with
    the actual connections.

commit 30f778b6f703672c4d03b90f0e3cd0e2ad57db66
Author: Jaroslav Kysela <perex@suse.cz>
Date:   Mon May 17 19:28:08 2004 +0200

    ALSA CVS update - Takashi Iwai <tiwai@suse.de>
    Documentation,CMIPCI driver
    make soft_ac3 option conditional again.
    
    this will make it possible for old chips to feed the IEC958 data
    without conversion (sometimes useful, e.g. for apps using mmap).

commit 0f94e03c17d574168486a9227cf35bb9ae31ab9d
Author: Jaroslav Kysela <perex@suse.cz>
Date:   Mon May 17 19:27:42 2004 +0200

    ALSA CVS update - Jaroslav Kysela <perex@suse.cz>
    Sound Core PDAudioCF driver
    Updated interrupt function to 2.6 irq API

commit 9132374e6ff69130e207441428c4409e9ffbb40c
Author: Jaroslav Kysela <perex@suse.cz>
Date:   Mon May 17 19:27:17 2004 +0200

    ALSA CVS update - Jaroslav Kysela <perex@suse.cz>
    EMU10K1/EMU10K2 driver
    Credits for SB Live (c) 2003

commit 8bd54046ec3cea0c08d243a26ce2b31f9bc6be17
Author: Jaroslav Kysela <perex@suse.cz>
Date:   Mon May 17 19:26:57 2004 +0200

    ALSA CVS update - Clemens Ladisch <clemens@ladisch.de>
    USB generic driver
    (Alan Stern) use altsetting number instead of index in messages

commit 6278f6fad400b7013b28bed33ac8c3deaa1b3442
Author: Jaroslav Kysela <perex@suse.cz>
Date:   Mon May 17 19:26:35 2004 +0200

    ALSA CVS update - Takashi Iwai <tiwai@suse.de>
    Documentation
    added the document about Audigy mixer implementation by Peter Zubaj.
    it is not target to users, rather to developers.

commit 7e5f13f2ba1b07e19ed27046844f45a1ff16944c
Author: Jaroslav Kysela <perex@suse.cz>
Date:   Mon May 17 19:26:10 2004 +0200

    ALSA CVS update - Takashi Iwai <tiwai@suse.de>
    ATIIXP driver
    - fixed the direct SPDIF playback mode.  (still experimental)
    - use the different driver id name for the direct spdif mode, so that
      alsa-lib can read another corresponding configuration.

commit aaffb2af2736f9c6e014a44432500bd2dd158cbe
Author: Jaroslav Kysela <perex@suse.cz>
Date:   Mon May 17 19:25:49 2004 +0200

    ALSA CVS update - Takashi Iwai <tiwai@suse.de>
    Documentation,CMIPCI driver
    dropped the software encoding of AC3 stream in the driver.
    this is done now in alsa-lib.
    soft_ac3 module option is kept for backward compatibility but not
    referred at all.

commit 646134728d204d55a225b08b348f3d8f46b24379
Author: Jaroslav Kysela <perex@suse.cz>
Date:   Mon May 17 19:25:22 2004 +0200

    ALSA CVS update - Takashi Iwai <tiwai@suse.de>
    Documentation,NM256 driver
    - added a blacklist to avoid the possible hang-up at module loading.
    - added notes about the hang-up problem to ALSA-Configuration.txt.

commit 9c9b6622d65a988aebb93f7cbcecb269a6a2c0ae
Author: Jaroslav Kysela <perex@suse.cz>
Date:   Mon May 17 19:25:00 2004 +0200

    ALSA CVS update - Takashi Iwai <tiwai@suse.de>
    PCM Midlevel
    fixed the bit width of IEC958_SUBFRAME_* formats from 24 to 32.

commit 2264ed68ffc3245317c70a6ce9c6d500debe1dd2
Author: Jaroslav Kysela <perex@suse.cz>
Date:   Mon May 17 19:24:35 2004 +0200

    ALSA CVS update - Takashi Iwai <tiwai@suse.de>
    VIA82xx driver
    fixed again the DXS entry for m680x to 48k-fixed rate.

commit 3a5b89ffb1153bc4ab2fa3fea688c47d4e25731b
Author: Jaroslav Kysela <perex@suse.cz>
Date:   Mon May 17 19:24:11 2004 +0200

    ALSA CVS update - Clemens Ladisch <clemens@ladisch.de>
    ALSA<-OSS emulation
    don't return negative byte count from GET[IO]PTR ioctl

commit 2979867e25d0419b4b84e1ad1a2884751b2e5068
Author: Jaroslav Kysela <perex@suse.cz>
Date:   Mon May 17 19:23:52 2004 +0200

    ALSA CVS update - Clemens Ladisch <clemens@ladisch.de>
    ICE1712 driver
    fix Hoontech DSP* box configuration

commit d9acfcc9e99c55bec0d7c828c21aef1e56888b60
Author: Jaroslav Kysela <perex@suse.cz>
Date:   Mon May 17 19:23:29 2004 +0200

    ALSA CVS update - Takashi Iwai <tiwai@suse.de>
    Documentation
    - fixed some obsolete descriptions and typos.
    - a bit more detailed description about addition of the new driver.

commit a29211b921dd82a7a1dbf101d612f15a0e8a145b
Author: Jaroslav Kysela <perex@suse.cz>
Date:   Mon May 17 19:23:08 2004 +0200

    ALSA CVS update - Takashi Iwai <tiwai@suse.de>
    SA11xx UDA1341 driver,UDA1341
    - clean up PM codes using the new PM callback functions.

commit 0f2c1fd45b3c73e24a4efb69e544b0a413c323fc
Author: Jaroslav Kysela <perex@suse.cz>
Date:   Mon May 17 19:22:44 2004 +0200

    ALSA CVS update - Takashi Iwai <tiwai@suse.de>
    ALSA Core
    - added the generic PM callback registration.
    - rewritten ISA callbacks to use the new one.

commit 83632df912f096ba36e2ba31d2d1c0d66ebc1aeb
Author: Jaroslav Kysela <perex@suse.cz>
Date:   Mon May 17 19:22:22 2004 +0200

    ALSA CVS update - Takashi Iwai <tiwai@suse.de>
    ES1968 driver
    - set ACPI D3 at suspend.
    - fixed the interrupt disabling at shutdown.
    - enabled PM for compaq Armada.

commit 487d7fcd7cbea2b62d3177f65e52a5c719fef6d8
Author: Jaroslav Kysela <perex@suse.cz>
Date:   Mon May 17 19:21:59 2004 +0200

    ALSA CVS update - Takashi Iwai <tiwai@suse.de>
    AC97 Codec Core
    try to mute and power down in the destructor (to shut up noises).

commit 05058ebd91982b0fae48752f097e92633f3cbdb2
Author: Jaroslav Kysela <perex@suse.cz>
Date:   Mon May 17 19:21:39 2004 +0200

    ALSA CVS update - Clemens Ladisch <clemens@ladisch.de>
    CS4231 driver
    add missing closing brace

commit 588d8e80e78305e4904e32546510c43ac402bd01
Author: Jaroslav Kysela <perex@suse.cz>
Date:   Mon May 17 19:21:16 2004 +0200

    ALSA CVS update - Jaroslav Kysela <perex@suse.cz>
    RME HDSP driver
    HDSP9632 has also firmware version 0x97

commit 6db246fa5752d4ad8ce228194dd7c50de4cdde78
Author: Jaroslav Kysela <perex@suse.cz>
Date:   Mon May 17 19:20:55 2004 +0200

    ALSA CVS update - Jaroslav Kysela <perex@suse.cz>
    Documentation,EMU10K1/EMU10K2 driver
    Initial attempt to add support for SB Live 5.1 (c) 2003

commit e722528492cc72ea8de93643c257a99b054b0c6c
Author: Jaroslav Kysela <perex@suse.cz>
Date:   Mon May 17 19:20:32 2004 +0200

    ALSA CVS update - Takashi Iwai <tiwai@suse.de>
    VIA82xx driver
    added DXS whitelist for (eMachines) m680x.

commit 3a2ff73ed2794730dfe71177a21376f069f4874b
Author: Jaroslav Kysela <perex@suse.cz>
Date:   Mon May 17 19:20:12 2004 +0200

    ALSA CVS update - Takashi Iwai <tiwai@suse.de>
    CS4231 driver
    checks the PCM substream pointers to fix oops/panic in the interrupt
    handler.

commit 9b465a1ffaf8b4ea9061f95e261a3de33e27cd19
Author: Jaroslav Kysela <perex@suse.cz>
Date:   Mon May 17 19:19:51 2004 +0200

    ALSA CVS update - Clemens Ladisch <clemens@ladisch.de>
    Intel8x0 driver
    check that period interrupt really has occured;
    clear only those interrupts that have been handled

commit 95388082cef7da0f95a1075ee5a94973231a1ea1
Author: Jaroslav Kysela <perex@suse.cz>
Date:   Mon May 17 19:19:27 2004 +0200

    ALSA CVS update - Clemens Ladisch <clemens@ladisch.de>
    ALSA<-OSS emulation,ALSA sequencer,ALSA<-OSS sequencer,OPL4
    make some module parameters sysfs-writable, where appropriate

commit 8e1f5ff0de4c41212e44ba872a6b7e36f4202130
Author: Jaroslav Kysela <perex@suse.cz>
Date:   Mon May 17 19:19:06 2004 +0200

    ALSA CVS update - Takashi Iwai <tiwai@suse.de>
    PARISC Harmony driver
    fixed compilation - using struct parisc_device for DMA allocation.

commit 497d5fc2d5ca3fb4af9929da4e2adc1fca45fc42
Author: Steve French <stevef@smfhome.smfdom>
Date:   Mon May 17 11:53:34 2004 -0500

    switch to mempools for cifs request buf and mid allocation to avoid deadlocks in out of memory conditions

commit 9150818417293339049f490ad10150cf2625ea70
Merge: 277c710... a852ca3...
Author: David S. Miller <davem@kernel.bkbits.net>
Date:   Mon May 17 08:55:19 2004 -0700

    Merge davem@nuts.davemloft.net:/disk1/BK/sparc-2.6
    into kernel.bkbits.net:/home/davem/sparc-2.6

commit 4cccadb1a41cf954ff52394f2ed919396e614edc
Author: Jeff Garzik <jgarzik@redhat.com>
Date:   Mon May 17 11:39:54 2004 -0400

    [libata] polish DocBook docs a bit
    
    Mainly involved fixing a great many docproc warnings, by filling in
    missing documentation in the source code.

commit 56b3ffec18b6f1cc5be4fca612b67e98fb45cb2e
Author: Takashi Iwai <tiwai@suse.de>
Date:   Mon May 17 17:02:06 2004 +0200

    input: Fix oops in hiddev

commit 08be072b4ff5d32677525de4e8ddc01c036ced90
Author: Olof Johansson <olof@austin.ibm.com>
Date:   Mon May 17 07:12:36 2004 -0700

    [PATCH] ppc64: fix non-SMP build break
    
    arch/ppc64/lib/locks.c was recently added by Paulus' lock rewrite. It's
    always compiled, which breaks non-SMP builds. Below patch makes it depend
    on CONFIG_SMP.

commit f2f6bd5c8eb6f35e3075d2211d566c71cf826b70
Merge: bd7b6c4... 1c4b231...
Author: Jaroslav Kysela <perex@suse.cz>
Date:   Mon May 17 15:37:11 2004 +0200

    Merge suse.cz:/home/perex/bk/linux-sound/linux-2.5
    into suse.cz:/home/perex/bk/linux-sound/linux-sound

commit 85f9b52e24ce5665cc5c15a78b2c64980d7e34ce
Merge: 809d726... 419c049...
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Mon May 17 05:20:19 2004 -0700

    Merge bk://kernel.bkbits.net/gregkh/linux/pci-2.6
    into ppc970.osdl.org:/home/torvalds/v2.6/linux

commit bc963d9233f135b5276a0e82183ac11db510f929
Author: Rene Herman <rene.herman@keyaccess.nl>
Date:   Mon May 17 03:28:58 2004 -0700

    [PATCH] missing closing \n in printk

commit 99d4f395dead41d062f433d6616b2376df502c25
Merge: b1cfd14... 40c96fb...
Author: Deepak Saxena <dsaxena@xanadu.(none)>
Date:   Mon May 17 03:09:15 2004 -0700

    Merge bk://bk.arm.linux.org.uk/linux-2.6-rmk
    into xanadu.(none):/home/dsaxena/src/linux-2.6-for-rmk

commit b1cfd1403684dc09c668306cabced0733c96ea6a
Merge: 5e49f9a... 2963e48...
Author: Russell King <rmk@flint.arm.linux.org.uk>
Date:   Tue May 18 01:06:50 2004 +0100

    Merge bk://dsaxena.bkbits.net/linux-2.6-for-rmk
    into flint.arm.linux.org.uk:/usr/src/bk/linux-2.6-rmk

commit 5e49f9a3d47bfe80d3f6847ca9e3d75df68e4a4e
Author: Russell King <rmk@flint.arm.linux.org.uk>
Date:   Tue May 18 00:46:10 2004 +0100

    [ARM] Add linux/module.h include for ioremap.

commit 135247bfe4d966949b00d42f4190944f20b6ace9
Author: Russell King <rmk@flint.arm.linux.org.uk>
Date:   Tue May 18 00:28:23 2004 +0100

    [ARM] Update atomic.h
    
    This re-jigs atomic.h by providing atomic_add_return and
    atomic_sub_return as other architectures do.  This allows us to
    implement the atomic ops that test the new value without having
    to write the underlying atomic operation in various forms.

commit 1f20fe30dd133a187afab1ae39fe1a5c6423aa51
Author: Ian Campbell <icampbell@com.rmk.(none)>
Date:   Mon May 17 22:02:14 2004 +0100

    [ARM] Fix use of page->count
    
    Patch from: Ian Campbell
    
    This changes the atomic_t in struct page named count into a private
    member _count which breaks arch/arm/mm/init.c at line 80 which reads
    page->count directly in show_mem().
    
    The comments in the above changeset suggest that page_count(page) is
    precisely equal to the old page->count semantics, even though the
    semantics of _count are different, so I think the following is correct

commit 809d726dbe286cd73af346380f6f9c323e85cb34
Merge: bb8abfe... 30c154b...
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Mon May 17 02:51:13 2004 -0700

    Merge bk://kernel.bkbits.net/gregkh/linux/usb-2.6
    into ppc970.osdl.org:/home/torvalds/v2.6/linux

commit 419c049e3c94952faba4dc1854b0ad9b64e1640c
Merge: 277c710... 3b2b54d...
Author: Greg Kroah-Hartman <greg@kroah.com>
Date:   Mon May 17 02:44:49 2004 -0700

    merge

commit bb8abfed9e0c39ab8e7c087a930523ba6e8d07b4
Merge: c7f22f7... 277c710...
Author: Greg Kroah-Hartman <greg@kroah.com>
Date:   Mon May 17 02:19:41 2004 -0700

    Merge kroah.com:/home/greg/linux/BK/bleed-2.6
    into kroah.com:/home/greg/linux/BK/usb-2.6

commit 3b2b54d39c97d5c4d606a17237d00ca2e4c6caf7
Author: Greg Kroah-Hartman <greg@kroah.com>
Date:   Mon May 17 02:08:02 2004 -0700

    PCI Hotplug: clean up a lot of global symbols that do not need to be.

commit c7f22f7a0d21dfc1ce127c740facd914d1920689
Author: Greg Kroah-Hartman <greg@kroah.com>
Date:   Mon May 17 01:58:40 2004 -0700

    USB: fix up formatting issues with aiptek driver

commit 30c154b386a6ff6b18a272f15ef182f4f9a87e7f
Merge: b1cfd14... 277c710...
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Mon May 17 01:52:19 2004 -0700

    Merge bk://bk.arm.linux.org.uk/linux-2.6-rmk
    into ppc970.osdl.org:/home/torvalds/v2.6/linux

commit d9e08e986cd5e1d7c157bc9a0536d23fd7c3127e
Author: Greg Kroah-Hartman <greg@kroah.com>
Date:   Mon May 17 01:37:07 2004 -0700

    USB: fix dumb compile error in aiptek driver
    
    Doesn't anyone ever actually build the patches they send me...

commit 42842f8a776e46a6e1637cc3f5da27c3dd60835b
Author: Oliver Neukum <oliver@neukum.org>
Date:   Mon May 17 01:35:00 2004 -0700

    [PATCH] USB: purge wait_ms from core
    
    this makes the core use the new safe waiting helper.
    
      - remove wait_ms from hub driver

commit 289cf6add4c686f3a43c2d3ebb78c4d06febf2c6
Author: Oliver Neukum <oliver@neukum.org>
Date:   Mon May 17 01:34:21 2004 -0700

    [PATCH] USB: new delay helper safe wrt waitqueues
    
    this is a new waiting helper safe even if we are left on a waitqueue.
    This version addresses Alan's concerns about ifdefs. Please apply.
    
      - add delay helper that is safe even if we are still on another waitqueue

commit 331a2d82bcaff97ecc4764cca266db0d7465b937
Author: David Brownell <david-b@pacbell.net>
Date:   Mon May 17 01:33:22 2004 -0700

    [PATCH] USB: ethernet/rndis gadget address params
    
    This resolves a FIXME by adding module parameters that can
    be used to provide stable (vs random) addresses, and gets
    rid of a runtime error from obsolete module parameter usage
    in the RNDIS code.
    
    The stable ethernet addresses are nice to hosts, which will
    normally want to save them away in config databases.  For
    example, without stable addresses Windows XP will end up
    recording quite a lot of RNDIS devices.

commit eaab83eb20a622cf6e8dd86cd9e9efb030f9cbb9
Author: David Brownell <david-b@pacbell.net>
Date:   Mon May 17 01:32:03 2004 -0700

    [PATCH] USB: RNDIS (and CDC) filter flag handling
    
    This should fix the problem David Meggy found, where RNDIS was setting
    the OID_GEN_CURRENT_PACKET_FILTER state incorrectly.  It's the same
    issue Andrew Morton noticed a while back, for that matter, but with
    more than just a "now compiles on 64 bit" fix.
    
    Basically the code needs to interpret 32 bits provided in the request
    from the (Windows) host, rather than 8 bits of other memory that's got
    some irrelevant value.
    
    The fix is just to save the 32 bits.  I did the same thing with the
    CDC Ethernet filter, which should eventually be used the same way:  to
    limit what packets get sent to the host.  Also defined a couple more
    of the CDC requests.

commit 6aecb90dd9997136b2b25ed289cf2fbd7bf47149
Author: Bryan W. Headley <bwheadley@earthlink.net>
Date:   Mon May 17 01:31:31 2004 -0700

    [PATCH] USB: Aiptek.c Driver patch

commit 40c96fb5648b0dba6ec9c64079182a083c55f95f
Author: Deepak Saxena <dsaxena@xanadu.(none)>
Date:   Mon May 17 00:56:28 2004 -0700

    [ARM] Fix bogus variable name in dev_dbg() call in dmabounce code.

commit 81b9a74dc009462dababc382ae25beb875a1f34b
Merge: deb2820... bd7b6c4...
Author: Len Brown <len.brown@intel.com>
Date:   Mon May 17 03:27:31 2004 -0400

    Merge intel.com:/home/lenb/bk/linux-2.6.7
    into intel.com:/home/lenb/src/linux-acpi-test-2.6.7

commit 277c7105083ac6824861333d6d46bd8aec3f5dc3
Merge: fadf035... 043ea30...
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Mon May 17 00:01:34 2004 -0700

    Merge bk://gkernel.bkbits.net/libata-2.6
    into ppc970.osdl.org:/home/torvalds/v2.6/linux

commit fadf035a6cf657183bdead4ba4d9c80b4e4d5a26
Merge: 052a883... c96ded1...
Author: Jeff Garzik <jgarzik@redhat.com>
Date:   Mon May 17 07:15:48 2004 -0400

    Merge redhat.com:/spare/repo/netdev-2.6/remove-rcpci
    into redhat.com:/spare/repo/net-drivers-2.6

commit 052a883c67690bc78b48387ea6ed9239b4551248
Merge: bd7b6c4... b173de9...
Author: Jeff Garzik <jgarzik@redhat.com>
Date:   Mon May 17 07:14:07 2004 -0400

    Merge redhat.com:/spare/repo/netdev-2.6/fealnx
    into redhat.com:/spare/repo/net-drivers-2.6

commit a852ca3d3a56017784a64f8bb7ee47d5d8935876
Merge: e92f75e... 1ffdb4f...
Author: David S. Miller <davem@nuts.davemloft.net>
Date:   Sun May 16 21:47:28 2004 -0700

    Merge

commit cc0b73f6dbc4ec7445d279587074445233c79871
Author: Oliver Neukum <oliver@neukum.org>
Date:   Sun May 16 21:38:40 2004 -0700

    [PATCH] USB: further fix to mdc800
    
    I made a mistake fixing that driver. Here's the fix. Please apply soon.
    
      - fix race condition leading to busy waiting

commit fd7b635db5f127daa6914307b8a84efb9c51d52e
Author: David Brownell <david-b@pacbell.net>
Date:   Sun May 16 21:13:32 2004 -0700

    [PATCH] USB: fix MSEC_TO_JIFFIES in usb code
    
    Here are some MSEC_TO_JIFFIES() fixes missed by whoever did it,
    plus a minor fix to grab root_hub->serialize() during OHCI
    suspend.  (I forgot to cut/paste those lines from resume.)

commit 676ab9a6173eb63bf3363c366f954594048ce10c
Author: David Brownell <david-b@pacbell.net>
Date:   Sun May 16 21:12:22 2004 -0700

    [PATCH] USB: fix CONFIG_PM build issues

commit 469f0ab2070a8f6715f2dec51020dda65bfa5133
Author: Arjan van de Ven <arjanv@redhat.com>
Date:   Sun May 16 21:01:17 2004 -0700

    [PATCH] USB: fix obsolete header usage in usb storage
    
    drivers/scsi/hosts.h is obsolete, <scsi/scsi_host.h> is the prefered header
    nowadays. (hosts.h is just a 1 line wrapper to include it for now anyway)

commit 14283028469d79fa011989199c6901d6f5d89f09
Author: Zwane Mwaikambo <zwane@fsmlabs.com>
Date:   Sun May 16 21:00:46 2004 -0700

    [PATCH] USB: fix usb-serial serial_open oops
    
    No usb serial devices, just compiled in and the system has a USB controller.
    
    Unable to handle kernel NULL pointer dereference at virtual address 0000000c
     printing eip:
    c046a188
    *pde = 00000000
    Oops: 0000 [#1]
    PREEMPT SMP DEBUG_PAGEALLOC
    Modules linked in:
    CPU:    0
    EIP:    0060:[<c046a188>]    Not tainted VLI
    EFLAGS: 00010246   (2.6.6-mm3)
    EIP is at serial_open+0x38/0x170
    eax: 00000000   ebx: dc883000   ecx: c0613db8   edx: 00000000
    esi: 00000001   edi: 00000000   ebp: dc84cef0   esp: dc84cedc
    ds: 007b   es: 007b   ss: 0068
    Process serial (pid: 1073, threadinfo=dc84c000 task=ddffca50)
    Stack: 00000000 de8f4f5c ffffffed 00000100 de8f4f5c dc84cf14 c035a874 090115a0
           0bc00000 dc883000 00000000 de8f4f5c 00000001 df8a2dfc dc84cf40 c0171270
           dc84c000 00000001 00000000 de8f4f5c dbc75e94 00000000 de8f4f5c dbc75e94
    Call Trace:
     [<c01076c5>] show_stack+0x75/0x90
     [<c010781f>] show_registers+0x11f/0x180
     [<c01079c6>] die+0xb6/0x170
     [<c011af20>] do_page_fault+0x1e0/0x525
     [<c010732d>] error_code+0x2d/0x40
     [<c035a874>] tty_open+0x274/0x3b0
     [<c0171270>] chrdev_open+0x160/0x340
     [<c0166426>] dentry_open+0x156/0x230
     [<c01662cd>] filp_open+0x4d/0x50
     [<c0166858>] sys_open+0x38/0x70
     [<c0106199>] sysenter_past_esp+0x52/0x79
    
    Code: de 63 c0 89 55 f0 c7 45 ec 00 00 00 00 85 f6 0f 85 31 01 00 00 c7 83
    8c 09 00 00 00 00 00 00 8b 43 08 e8 3c fe ff ff 31 d2 89 c7 <8a> 50 0c 8b
    43 08 29 d0 8b 74 87 18 89 b3 8c 09 00 00 89 5e 04
    
    (gdb) list *serial_open+0x38
    0xc046a188 is in serial_open (drivers/usb/serial/usb-serial.c:465).
    460
    461             /* get the serial object associated with this tty pointer */
    462             serial = usb_serial_get_by_index(tty->index);
    463
    464             /* set up our port structure making the tty driver remember our port object, and us it */
    465             portNumber = tty->index - serial->minor;
    466             port = serial->port[portNumber];
    467             tty->driver_data = port;
    468
    469             port->tty = tty;

commit 377912145f05c9dae40b8e6a46824fe1012e0b73
Author: Maneesh Soni <maneesh@in.ibm.com>
Date:   Sun May 16 20:32:30 2004 -0700

    [PATCH] fix-sysfs-symlinks.patch
    
    - Rediffed the patch for 2.6.6-mm3 to fix rejects in the latest changes
      in sysfs code.
    
    o The symlinks code in sysfs doesnot point to the correct target kobject
      whenever target kobject is renamed and suffers from dangling symlinks
      if target kobject is removed.
    
    o The following patch implements ->readlink and ->follow_link operations
      for sysfs instead of using the page_symlink_inode_operations.
      The pointer to target kobject is saved in the link dentry's d_fsdata field.
      The target path is generated everytime we do ->readlink and ->follow_link.
      This results in generating the correct target path during readlink and
      follow_link operations inspite of renamed target kobject.
    
    o This also pins the target kobject during link creation and the ref. is
      released when the link is removed.
    
    o Apart from being correct this patch also saves some memory by not pinning
      a whole page for saving the target information.
    
    o Used a rw_semaphor sysfs_rename_sem to avoid clashing with renaming of
      ancestors while the target path is generated.
    
    o Used dcache_lock in fs/sysfs/sysfs.h:sysfs_get_kobject() because of using
      d_drop() while removing dentries.

commit 393fce22b92ab98fe66f23dea335e53ee06e8b0e
Author: Greg Kroah-Hartman <greg@kroah.com>
Date:   Sun May 16 19:46:52 2004 -0700

    USB: fix build error in drivers/usb/serial/console.c
    
    Thanks to Adrian Bunk <bunk@fs.tum.de> for pointing this out.

commit b3a9bd1fc7127e0d5f5a9494580b43b5d3fdd18d
Merge: bd7b6c4... 1cba182...
Author: Steve French <cifs.adm@hostme.bitkeeper.com>
Date:   Sun May 16 18:21:13 2004 -0700

    Merge bk://linux.bkbits.net/linux-2.5
    into hostme.bitkeeper.com:/repos/c/cifs/linux-2.5cifs

commit 043ea303862df141a74b873cd5fd4f16efd2a64c
Author: Jeff Garzik <jgarzik@redhat.com>
Date:   Sun May 16 17:41:56 2004 -0400

    [libata] replace ATA_QCFLAG_ATAPI with inline helper
    
    Detection of an ATAPI taskfile is possible using a simple test
    on existing information, so there is no need to cache this value
    in a separate flag (ATA_QCFLAG_ATAPI).  Instead, create and use
    a new helper function is_atapi_taskfile().

commit ffb17d43e7e39a0a323a261bae0124012ae83709
Author: Jeff Garzik <jgarzik@redhat.com>
Date:   Sun May 16 16:21:15 2004 -0400

    [libata] scsi simulator improvements: MODE SENSE, SEEK(6,10), REZERO_UNIT
    
    * SEEK(6), SEEK(10), and REZERO_UNIT are no-ops.  Unconditionally
      complete these commands with success.
    * MODE SENSE caching page work:
    	* correct page length
    	* set bit, if read-ahead is disabled
    	* set bit, if writeback caching is enabled
    	  (previously, this bit was never set, even if
    	   writeback caching was enabled)
    * add MODE SENSE r/w error recovery page

commit a163af74bf0a7dc9906c31f05a687cf2253fbff7
Author: Jeff Garzik <jgarzik@redhat.com>
Date:   Sun May 16 14:19:19 2004 -0400

    [libata] comments and constants
    
    * note a nasty problem with shared interrupts that must be fixed
      before we turn on certain code paths.
    * add a few comments to the READ CAPACITY scsi simulator
    * remove a FIXME comment from the TEST UNIT READY scsi simulator
    * add constant for ATA command CHECK POWER MODE, and associated
      "mandatory" power management feature set bit.

commit 7f594e47663f5121d34ffdf43eba8a8109bd1be7
Author: Jeff Garzik <jgarzik@redhat.com>
Date:   Sun May 16 13:33:18 2004 -0400

    [libata] SCSI->ATA simulator hacking: INQUIRY command
    
    The SCSI T10 committee is working on a document describing a standard
    method for translating ATA<->SCSI, since it being done quite often
    these days.  Some of the recommendations are reasonable, and we implement
    two here:
    
    * Mirror that ATA 'removeable media' bit into INQUIRY output.
    * Change behavior of INQUIRY output field 'product revision' from
      the libata software version number to the first 4 bytes of the
      ATA device's firmware revision number.
    
    Rather than cache the firmware revision in struct ata_device, as was/is
    done with two other strings, I took the opportunity to eliminate the
    caching of the two other strings, 'vendor' and 'product'.  These strings
    are now retrieved as needed from the IDENTIFY [PACKET] DEVICE info page,
    since we cache its entire contents.
    
    Retrieving a string from the identify-device page is done via the
    helper function ata_dev_id_string(), which is now exported.
    
    This patch winds up making struct ata_device 40 bytes smaller, and
    the libata core gets a bit smaller as well.

commit e9c8846e3de355918b6ee6df1bb5b270c0963199
Author: Jeff Garzik <jgarzik@redhat.com>
Date:   Sun May 16 10:48:08 2004 -0400

    [libata] remove redundant use of ATA_QCFLAG_SG in ATAPI packet translation
    
    ata_scsi_translate() sets this flag for all ATA->SCSI translated
    commands, so it need not be done in atapi_xlat().  The now-removed
    use in atapi_xlat() was also inconsistent WRT PIO versus DMA.

commit d89ee0218780580d748a7d43344c87bb1153886a
Author: Jeff Garzik <jgarzik@redhat.com>
Date:   Sun May 16 10:35:15 2004 -0400

    [libata] DMADIR support
    
    DMADIR bit is necessary for some PATA->SATA bridges.  These
    bridges require the OS driver to specify the data xfer direction,
    for PACKET (a.k.a. scsi) commands.
    
    A reliable DMADIR detection method hasn't yet been developed,
    and ATAPI is still a WIP, so DMADIR is enabled with an ifdef for
    now.

commit bd7b6c43e2e61a6380c1a1b99229d108c16c1f3a
Merge: b3e0153... e9c8846...
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Sun May 16 05:47:53 2004 -0700

    Merge bk://gkernel.bkbits.net/libata-2.6
    into ppc970.osdl.org:/home/torvalds/v2.6/linux

commit b3e0153fc25d95ba0c2eb6751701809e38c92128
Merge: 03fc059... abec713...
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Sun May 16 05:39:44 2004 -0700

    Merge bk://bk.arm.linux.org.uk/linux-2.6-serial
    into ppc970.osdl.org:/home/torvalds/v2.6/linux

commit abec7137d9525e89044a251d7d991425835f9f53
Author: Russell King <rmk@flint.arm.linux.org.uk>
Date:   Sun May 16 14:08:21 2004 +0100

    [SERIAL] Remove base_baud default from 8250_pci
    
    Since all boards specify base_baud, the code to default base_baud to
    the architecture-defined BASE_BAUD is redundant.  Also, defaulting
    to the architecture-defined BASE_BAUD is wrong since the UARTs on a
    serial PCI card will be clocked at the same rate no matter what the
    architecture of the host machine.

commit 03fc059ccd673fd01e5899783fc80bac6af4f554
Merge: 3a25181... a7aea5b...
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Sun May 16 05:15:02 2004 -0700

    Merge bk://bk.arm.linux.org.uk/linux-2.6-rmk
    into ppc970.osdl.org:/home/torvalds/v2.6/linux

commit a7aea5bf531d83256413ab22221db833fa6e316c
Author: Russell King <rmk@flint.arm.linux.org.uk>
Date:   Sun May 16 16:37:30 2004 +0100

    [ARM] Convert execve() to be a function rather than a SWI call.
    
    This eliminates the last SWI user from the kernel - now all SWI calls
    will only come from userspace.  More importantly, this also allows us
    to empty the kernel stack when starting userspace programs from
    kernelspace, thereby ensuring that the user registers always appear
    at the top of the kernel stack.

commit 31aa2bf6c217dd55a4cbcce23073cbd4e63d7c9c
Author: Russell King <rmk@flint.arm.linux.org.uk>
Date:   Sun May 16 16:12:49 2004 +0100

    [ARM] Move a bunch of symbol exports from armksyms.c
    
    This moves a bunch of EXPORT_SYMBOL() statements from armksyms.c
    into the file which defines the function/variable such that the
    exports are localised.
    
    This also means we can get rid of the ugly __xxx_to_xxx__is_a_macro
    in include/asm-arm/arch-*/memory.h

commit 3a2518119714287e5626846c8457185a829a6790
Merge: 557c670... cccac60...
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Sun May 16 05:08:10 2004 -0700

    Merge bk://gkernel.bkbits.net/net-drivers-2.6
    into ppc970.osdl.org:/home/torvalds/v2.6/linux

commit 557c670b3d93db0261f1efbfcf482a042413f85d
Merge: 1cda7f5... db4830e...
Author: Jeff Garzik <jgarzik@redhat.com>
Date:   Sun May 16 09:55:11 2004 -0400

    Merge redhat.com:/spare/repo/netdev-2.6/remove-comx
    into redhat.com:/spare/repo/net-drivers-2.6

commit 1cda7f590df249f308aa2fbde9452cff8b082669
Author: Jonathan Corbet <corbet@lwn.net>
Date:   Sun May 16 01:52:33 2004 -0400

    Remove drivers/net/auto_irq.c.
    
    No more users of the autoirq_xxx() API existed, so this file is not
    only unused, it isn't even listed in any makefiles.

commit cccac60034a56b0568fe86c9b1cf67b79a7b90e2
Author: Andrew Morton <akpm@osdl.org>
Date:   Sat May 15 18:55:56 2004 -0700

    [PATCH] Fixed quota recursion fix
    
    This fixes the gfp_mask setting on the quota inode.

commit 6deb6e5b874ba6750acd4427448b1d5cc313a664
Author: Dave Jones <davej@redhat.com>
Date:   Sun May 16 00:40:07 2004 +0100

    [CPUFREQ] Make powernow-k8 work right when ACPI is built as a module.
    From: Tony Lindgren <tony@atomide.com>

commit 383b816c14299fd2f5d7eeb825f18b68e3516d8b
Author: Dave Jones <davej@redhat.com>
Date:   Sun May 16 00:38:41 2004 +0100

    [CPUFREQ] Fix an invalid comment in speedstep-ich
    This driver is for ICH only, not for PIIX4. Thanks to Christian Hilberg for noting this.

commit 9dba63f482d9cdda530a01e565ed00054c16571b
Author: Dave Jones <davej@redhat.com>
Date:   Sun May 16 00:37:38 2004 +0100

    [CPUFREQ] Sync p4-clockmod MSR access across logical CPUs.
    As noted and debugged by Rutger Nijlunsing and verified in section 13.15.3 of Intel's
    IA32 Intel Architecture Software Developer's Manual, Volume 3, the p4-clockmod
    msr needs to be set to the same value on all logical CPUs ("siblings") to
    function "properly".
    
    This patch implements this, and uses cpufreq_p4_get instead of a local copy in
    cpufreq_p4_setdc. The latter function now only does the actual setting, all
    other (notification, verification and set_cpus_allowed()) stuff is done in
    cpufreq_p4_target.

commit a2bd9297bb12d9f4d97644f8d8b959df219b26c9
Author: Dave Jones <davej@redhat.com>
Date:   Sun May 16 00:36:25 2004 +0100

    [CPUFREQ] Makefile reordering issues.
    As several cpufreq drivers are late_initcalls now [dependency on acpi/processor.c
    which is module_init()], we need to use Makefile ordering to assert that
    - speedstep-centrino is loaded before acpi [faster: msr instead of io]
    - speedstep-centrino, speedstep-ich and acpi are loaded before p4-clockmod
      [frequency and voltage scaling instead of throttling]

commit 9ae46eefe973c490f40b57adcdb6b4f84d619ac8
Author: Dave Jones <davej@redhat.com>
Date:   Sun May 16 00:35:10 2004 +0100

    [CPUFREQ] Fix several operator precedence bugs.

commit 170747d7b9f1678a71d21ae0b4fd558b23fdf27e
Merge: 7847981... 694919c...
Author: Jeff Garzik <jgarzik@redhat.com>
Date:   Sat May 15 10:45:33 2004 -0400

    Merge redhat.com:/spare/repo/b44-2.6.5
    into redhat.com:/spare/repo/net-drivers-2.6

commit 694919c6db580fb8eb1fa8a0a8e61e4232f764d3
Author: Pekka PietikÃ¤inen <pp@ee.oulu.fi>
Date:   Sat May 15 10:28:24 2004 -0400

    [netdrvr b44] better reset behavior
    
    This patch makes the b44-after-bcm4400 scenario work for
    me. What was happening is that the broadcom driver sets a "power off MAC"
    bit, and we didn't remove that when initializing the chip.
    Also added some (a bit ugly, I know  ) logic to clear up the address
    filter stuff, which is what recent broadcom drivers do...

commit 80e00375262ea73f746262e39f5ea41bdfe0ede5
Author: Jeff Garzik <jgarzik@redhat.com>
Date:   Sat May 15 10:07:32 2004 -0400

    [libata] handle non-data ATAPI commands via interrupt
    
    It's easier to do it this way, than polling, at the moment.
    
    Also, fix a test in ata_scsi_translate that was incorrectly
    erroring-out non-data commands.

commit deb2820196b3d50ce06c3ad3a06c7c748185e4b6
Merge: 7847981... 706c901...
Author: Len Brown <len.brown@intel.com>
Date:   Sat May 15 09:32:48 2004 -0400

    Merge intel.com:/home/lenb/bk/linux-2.6.7
    into intel.com:/home/lenb/src/linux-acpi-test-2.6.7

commit 96b2b4d79d5d1b99dd72aeab8f38f5eb07c7ee2e
Author: Jeff Garzik <jgarzik@redhat.com>
Date:   Sat May 15 06:36:08 2004 -0400

    [libata] minor stuff
    
    * now that ATAPI is close to working, making ATAPI DMA interrupts
      in ata_host_intr
    * remove unnecessary space character in printk() output (oh, the horror)

commit 054852c4a6cbf2eaf7d34b030e193264dce43281
Author: Richard Henderson <rth@twiddle.net>
Date:   Sat May 15 03:29:10 2004 -0700

    [PATCH] alpha: fix GP-load symbol linkage
    
    From: Ivan Kokshaysky <ink@jurassic.park.msu.ru>
    
    This skips the GP-loading function prologue (two instructions: 8 bytes)
    on BRSGP linkage correctly, fixing an oops on alpha while loading the
    aic7xxx driver.

commit ed40244ef274504df3b0261be7369704b2642f8a
Author: Linus Torvalds <torvalds@evo.osdl.org>
Date:   Sat May 15 03:11:18 2004 -0700

    We need to use "memset_io()" when accessing PCI
    mapped memory.
    
    A regular "memset()" may be using cache control
    instructions etc, which is not appropriate for
    memory-mapped IO.
    
    This also fixes a warning.

commit 18857d8ea02330d7f0ffa8f2bc7749fd4a2fd497
Merge: 73b5d16... cd594a3...
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Sat May 15 02:31:31 2004 -0700

    Merge bk://bk.arm.linux.org.uk/linux-2.6-rmk
    into ppc970.osdl.org:/home/torvalds/v2.6/linux

commit cd594a3b6da2dd1dcb23d01e5453b0eb4d9fe09b
Author: Robin Farine <robin.farine@org.rmk.(none)>
Date:   Sat May 15 17:32:59 2004 +0100

    [ARM PATCH] 1879/1: fix a few xscale "drain write & fill buffer" instructions
    
    Patch from Robin Farine
    
    Fix the xscale cache handling routines that were invalidating a D
    cache line instead of draining the write & fill buffer as intended.

commit 6ef8f0dc5f49808860aceaa221f10b52328cdb93
Author: Catalin Marinas <catalin.marinas@com.rmk.(none)>
Date:   Sat May 15 17:26:45 2004 +0100

    [ARM PATCH] 1883/1: Bit 4 in pmd should be 0 for the ARMv6 architecture
    
    Patch from Catalin Marinas
    
    Unlike the v5 architecture, the ARM1136 requires that BIT4 is 0 in
    the first level page descriptor (ARM1136 TRM, page 6-39). It works
    at the moment but it might break future v6 cores.

commit dc1b0aa3dbb2fae3251d4989b53a05dbc8e9c741
Author: Catalin Marinas <catalin.marinas@com.rmk.(none)>
Date:   Sat May 15 17:19:34 2004 +0100

    [ARM PATCH] 1882/1: Fixes in the v6_dma_(invalidate|flush)_range functions
    
    Patch from Catalin Marinas
    
    The v6_dma_invalidate_range - the "mcr" instruction for draining
    
    the write buffer requires r0 == 0. A "cmp" instruction for
    
    testing the end address is missing in the v6_dma_flush_range
    
    function.

commit 2b01a2d3e0b08ea3f394fd02afec82845e58a114
Author: Catalin Marinas <catalin.marinas@com.rmk.(none)>
Date:   Sat May 15 17:13:48 2004 +0100

    [ARM PATCH] 1881/1: Illegal strex instruction generated by gcc
    
    Patch from Catalin Marinas
    
    The _raw_write_(try)lock functions in include/asm-arm/spinlock.h
    
    should use the early clobber modifier (&) for the "tmp" register.
    
    A newer compiler (gcc-3.4.0) generates an "strexeq %0, %1, [%2]"
    
    instruction where %0 is the same as %2, which is illegal.

commit 34dadab400cc8811e1ae96d4c7b1f196dc4758f2
Author: Catalin Marinas <catalin.marinas@com.rmk.(none)>
Date:   Sat May 15 17:07:10 2004 +0100

    [ARM PATCH] 1880/1: cache_type is uninitialised in the blockops_check() function
    
    Patch from Catalin Marinas
    
    In the blockops_check() function, cache_type is uninitialised
    
    because an "mcr" instruction is used instead of "mrc".

commit 73b5d1641f80f5508ae1098ff5eb9a687fa8571f
Merge: ba1abdb... 3bfc260...
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Sat May 15 02:26:27 2004 -0700

    Merge bk://bk.arm.linux.org.uk/linux-2.6-pcmcia
    into ppc970.osdl.org:/home/torvalds/v2.6/linux

commit ba1abdbf11f6813676d2dafd6263424dfc6925e7
Merge: 64a3243... 8d7f041...
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Sat May 15 02:22:48 2004 -0700

    Merge bk://bk.arm.linux.org.uk/linux-2.6-serial
    into ppc970.osdl.org:/home/torvalds/v2.6/linux

commit 64a3243bed95d5c10793b959eadbd00a07553d01
Author: Jan Kara <jack@ucw.cz>
Date:   Sat May 15 02:20:21 2004 -0700

    [PATCH] Quota fix 2
    
    This fixes the problem with recursion into filesystem when inode of
    quota file needs a page + some other allocation problems.  I hope I got
    the GFP mask setting right..

commit 48aa12e1d42c26b5689bcd2cd49a5b2ea120fa44
Merge: 7847981... 96b2b4d...
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Sat May 15 02:17:59 2004 -0700

    Merge bk://gkernel.bkbits.net/libata-2.6
    into ppc970.osdl.org:/home/torvalds/v2.6/linux

commit 50112a634c71a93d2c91fa2be46787ab9ca09a83
Author: Jeff Garzik <jgarzik@redhat.com>
Date:   Sat May 15 05:09:25 2004 -0400

    [libata] internal cleanups
    
    Remove unused 'done_late' arg to ata_qc_complete(), which was never
    useful in 2.4, and never used at all in 2.6.
    
    This allows us to eliminate the same arg from ata_dma_complete(),
    and also make it more correct by passing the command rather than
    the ATA port structure as arg0.

commit 1ad2c4d10e631707b29e50d1aa6cb1156baf2fab
Merge: e92f75e... 32b467b...
Author: Jeff Garzik <jgarzik@redhat.com>
Date:   Sat May 15 04:47:04 2004 -0400

    Merge redhat.com:/spare/repo/sata-hacks/atapi-hacks-2.6
    into redhat.com:/spare/repo/libata-2.6

commit 784798168972a40d89096288ca9756b4468e84a1
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Fri May 14 21:13:22 2004 -0700

    Fix gidsetsize == 0 for real this time.
    
    We need to always allocate at least one indirect block
    pointer, since we always fill out blocks[0] even if
    we don't have any groups.

commit 584286cc2836661453261db887d12e946c7face2
Author: Bartlomiej Zolnierkiewicz <b.zolnierkiewicz@elka.pw.edu.pl>
Date:   Fri May 14 21:08:29 2004 -0700

    [PATCH] remove bogus drivers/ide/pci/cmd640.h
    
    Trivia.
    
    CMD640 driver doesn't use generic IDE PCI code (it doesn't even include
    this header).

commit 7e33820d9017521a3513f0a3c715f63c2cb386f1
Author: Bartlomiej Zolnierkiewicz <b.zolnierkiewicz@elka.pw.edu.pl>
Date:   Fri May 14 21:01:48 2004 -0700

    [PATCH] ide-disk.c: more write cache fixes
    
    - many Maxtor disks incorrectly claim CACHE FLUSH EXT command support,
      fix it by checking both CACHE FLUSH EXT command and LBA48 support
      (thanks to Eric D. Mudama for help in fixing this)
    
    - write_cache() was called with 'drive->id->cfs_enable_2 & 0x3000' as 'int arg'
      argument which was always truncated to zero due to 'u8 drive->wcache = arg'
      assignment so write cache was indeed enabled but drive->wcache was zero
      (thanks to Rene Herman for help in debugging this)
    
    - flush cache in idedisk_start_power_step() only if ATA-6 CACHE FLUSH (EXT)
      bits are present in disk's identify data (prevents sending unknown commands)
    
    - set drive->wcache in idedisk_setup() not idedisk_attach() (no need to check
      id->command_set_2 - we check id->cfs_enable_2 instead in write_cache() call)
    
    - use ide_cacheflush_p() in idedisk_setup()
    
    - minor cleanups

commit 545907e63a70004e3a237c02c17b5f45e7f00af1
Author: James Bottomley <jejb@mulgrave.(none)>
Date:   Fri May 14 22:42:53 2004 -0500

    scsi sg: fix smp_call_function() with intrs disabled
    
    From: 	Matthew Wilcox <willy@debian.org>,
    	Douglas Gilbert <dougg@torque.net>
    
      - Fix vmalloc,vfree with intrs disabled
      - bump version number
      - introduce MODULE_VERSION
      - increase over allocation of sg_dev_arr from 6 to 32

commit ab9e69a33b25cd34d547d05806e04dc69a62cb38
Author: Andi Kleen <ak@muc.de>
Date:   Fri May 14 20:41:14 2004 -0700

    [PATCH] Handle empty nodes in sysfs on x86-64
    
    This code is shared between i386 and x86-64, and x86-64 needs to check
    for empty nodes here.  Otherwise you can get oopses at boot in some
    circumstances.
    
    This handles empty nodes != 0; empty node zero are still broken in other
    ways.

commit f1eda4169fd6b1d5721a1e07a35411d3fe07d65a
Author: Andi Kleen <ak@muc.de>
Date:   Fri May 14 20:41:03 2004 -0700

    [PATCH] x86-64: fix /dev/mem caching behaviour
    
    This changes the /dev/mem caching behaviour on x86-64 to be compatible
    with i386.
    
    By default everything is set cached.
    
    This actually makes WC MTRRs on AMD systems work, which would get
    overriden by the UC PAT bits that were set earlier.  This can make DVD
    decoding with hardware support a lot faster.
    
    It also supports O_SYNC now, like i386, although that is not really
    safe, because it allows the user to create undefined cache attribute
    conflicts that can corrupt caches in some circumstances.  I kept it for
    now.  Better would to disallow it, until Terrence Ripperda's PAT
    framework is getting merged, that can avoid these problems.
    
    Actually it would be probably a good idea to add a printk here to catch
    broken programs for i386 and x86-64, but that is for another patch.

commit fb75a3d49306fbf83cbefab5a6883f19e5233e4d
Author: Andi Kleen <ak@muc.de>
Date:   Fri May 14 20:40:53 2004 -0700

    [PATCH] x86-64 updates
    
    Various accumulated x86-64 patches and bug fixes.
    
    It fixes one nasty bug that has been there since NX is used by
    default in the kernel. With heavy AGP memory allocation it would
    set NX on parts of the kernel mapping in some corner cases, which gave
    endless crash loops. Thanks goes to some wizards in AMD debug labs
    for getting a trace out of this.
    
    Also various other fixes. This patches only changes x86-64 specific
    files, i have some changes outside too that I am sending separately.
    
     - Fix help test for CONFIG_NUMA
     - Don't enable SMT nice on CMP
     - Move HT and MWAIT checks up to generic code
     - Update defconfig
     - Remove duplicated includes (Arthur Othieno)
     - Set up GSI entry for ACPI SCI correctly (from i386)
     - Fix some comments
     - Fix threadinfo printing in oopses
     - Set task alignment to 16 bytes
     - Handle NX bit for code pages correctly in change_page_attr()
     - Use generic nops for non amd specific kernel
     - Add __KERNEL__ checks in unistd.h (David Lee)

commit ffc60a42b601f2f8658e2622311120075c5f015c
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Fri May 14 20:38:09 2004 -0700

    Fix bogus debug code in usb/misc/cytherm.c
    
    Uncovered by recent cleanup of "dev_dbg()".

commit 11741f8a5652e37f32d3900d0f201ef4f1c7f687
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 14 22:37:26 2004 -0500

    [PATCH] Fix dpt_i2o
    
    From: Go Taniguchi <go@turbolinux.co.jp>
    
    Make it build (and work) again.

commit 3e92416489a39256cd1b13a38918098a934621b9
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 14 20:27:04 2004 -0700

    [PATCH] i2o_config build fix
    
    Stomp a C99ism.

commit b332ad9d6c27cb5f95d53f3d82b754d696e3c8f3
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 14 20:26:53 2004 -0700

    [PATCH] Fix botched fbdev lvalue conversion

commit 1540760cb0decdb9664dfa97150f419c21682565
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 14 20:26:42 2004 -0700

    [PATCH] typhoon locking fix
    
    Initialise the semaphore even if !MODULE

commit e04dbc4086ca3f87cd95a9932f64a22ffe8c36a2
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 14 20:26:32 2004 -0700

    [PATCH] radeonfb stack space fix
    
    These (unused) arrays are causing huge stack utilisation when instantiated in
    an auto variable.  Remove them for now.

commit bc39e03b1b8dbcc80f11400a51e1c452baf8f2bb
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 14 20:26:21 2004 -0700

    [PATCH] bootmem.c cleanup
    
    From: Michael Buesch <mbuesch@freenet.de>
    
    - BUG_ON() conversion
    
    - Remove redundant dump_stack() (BUG already does that)

commit a2c4791239dabcebcefbfa2c48a30186bd8bea31
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 14 20:26:11 2004 -0700

    [PATCH] groups_alloc(0) clobbers memory past end of block
    
    From: Olaf Kirch <okir@suse.de>
    
    Authentication code in net/sunrpc makes frequent use of groups_alloc(0),
    which seems to clobber memory past the end of what it allocated.
    
    If called with gidsetsize == 0, groups_alloc will set nblocks = 0,
    but still does a
    
    	group_info->blocks[0] = group_info->small_block;

commit 52e802f6e70ec2eb746404cc37a56e79b834ed6b
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 14 20:26:00 2004 -0700

    [PATCH] ac97_plugin_ad1980 porting fix
    
    From: "Uwe Bugla" <uwe.bugla@gmx.de>
    
    Fix up a mistake in the 2.4->2.6 forward-port of this driver.

commit 03e6a21b52ae8caa93505722b33cf72613dfa9dd
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 14 20:25:50 2004 -0700

    [PATCH] Increase xfsbufd_centisecs when in laptop mode
    
    From: Bart Samwel <bart@samwel.tk>
    
    The attached patch is the outcome of a discussion with Nathan.
    
    When laptop mode is active, there is no need for XFS to wake up xfsbufd (the
    daemon that flushes buffers that are too old) too often.  The default is once
    every second, this patch makes laptop mode do it once every 30 seconds.

commit a581734327bffe26ceda1ecf9916785d31688e31
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 14 20:25:39 2004 -0700

    [PATCH] Laptop mode control script support for XFS *_centisecs sysctl values.
    
    From: Bart Samwel <bart@samwel.tk>
    
    XFS now uses
    	/proc/sys/fs/xfs/xfssyncd_centisecs
    	/proc/sys/fs/xfs/xfsbufd_centisecs
    	/proc/sys/fs/xfs/age_buffer_centisecs
    
    Here's a patch to support these values in the laptop mode control script.

commit 41dd128c2144b3f3a53a146b539db60a2269734f
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 14 20:25:29 2004 -0700

    [PATCH] remove unused acpi_irq_to_vector()
    
    From: Bjorn Helgaas <bjorn.helgaas@hp.com>
    
    Now that everybody has acpi_gsi_to_irq(), we can nuke the deprecated
    acpi_irq_to_vector().  No references remain.

commit 10c9a37944cc71511a474ee4d17c2830ca2cd15e
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 14 20:25:17 2004 -0700

    [PATCH] floppy.c: better/cleaner use of debugt
    
    From: "Randy.Dunlap" <rddunlap@osdl.org>
    
    From: "Luiz Fernando N. Capitulino" <lcapitulino@prefeitura.sp.gov.br>
    
    floppy_debugt.patch: better use of the debugt functions.

commit 794b6dd5fcb795c78a7b1c349f01633d3bc0d6e2
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 14 20:25:08 2004 -0700

    [PATCH] floppy.c: better floppy_init error handling
    
    From: "Randy.Dunlap" <rddunlap@osdl.org>
    
    From: "Luiz Fernando N. Capitulino" <lcapitulino@prefeitura.sp.gov.br>
    
    Adds a better audit for floppy_init().  Fixes one real bug (in calling
    blk_queue_max_sectors()).

commit 2d976592bae6b09d53417b976cdd0c74008e3031
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 14 20:24:57 2004 -0700

    [PATCH] Export `laptop_mode' for XFS
    
    From: <bart@samwel.tk>
    
    XFS needs `laptop_mode'.

commit ff60dd36dede3942c955511b0edf9f3ec6b34657
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 14 20:24:47 2004 -0700

    [PATCH] Remove old sh-sci driver
    
    From: Paul Mundt <lethal@linux-sh.org>
    
    The old drivers/char sh-sci driver is no long used by anyone, both sh and
    h8300 are using the drivers/serial version at this point, so we can get rid
    of the old one entirely.

commit b620063cf6e53f6466abbb045289c5af99965483
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 14 20:24:36 2004 -0700

    [PATCH] Fix x86_64 allmodconfig with gcc-3.4.0
    
    From: Andi Kleen <ak@muc.de>
    
    *** Warning: "memcmp" [drivers/atm/zatm.ko] undefined!
    
    gcc 3.4 specific problem.  This patch should fix it.  Actually it would be
    better to move all these EXPORT_SYMBOLs into lib/string.c, it is silly that
    each arch has to duplicate all that.

commit 63ad39dc2d68bcdc37983b548e5e8c61e2c3c5ad
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 14 20:24:25 2004 -0700

    [PATCH] remove driver model code in mwave driver
    
    From: Christoph Hellwig <hch@lst.de>
    
    Someone blindly added sysfs support to the driver long time ago without
    understanding the implications (and if they were understood the driver
    would need half a rewrite for it).  Herber Xu recently noticed the problems
    this causes on unload, so let's if 0 out all that code and get the driver
    working again.

commit dd3871ec53cb626920662f7270ff90083f2d3097
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 14 20:24:15 2004 -0700

    [PATCH] Make /proc/sysrq-trigger ignore sysrq_enabled
    
    It's silly that writing to /proc/sysrq-trigger does nothing if you haven't
    enabled /proc/sys/kernel/sysrq.  So provide a new __handle_sysrq() which
    ignores the sysrq_enabled check.
    
    The patch also withdraws __handle_sysrq_nolock() from the kernel API.  It had
    no callers.

commit 04229e509312406d40f8d4101383eb2c5c7e1c25
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 14 20:24:04 2004 -0700

    [PATCH] x86_64 msr.c warning fix
    
    arch/x86_64/kernel/msr.c:1:10: warning: extra tokens at end of #ident directive

commit 4167d41da3e2c9bb7115a0afe191b312155448ef
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 14 20:23:54 2004 -0700

    [PATCH] fix aic7xxx_old.c for !PCI
    
    From: Adrian Bunk <bunk@fs.tum.de>
    
    drivers/scsi/aic7xxx_old.c: In function `aic7xxx_release':
    drivers/scsi/aic7xxx_old.c:10971: warning: implicit declaration of function `pci_release_regions'

commit b2efc82c59493c29ad7a18222ed3b58a7b860a40
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 14 20:23:43 2004 -0700

    [PATCH] fix tlan.c for !PCI
    
    From: Adrian Bunk <bunk@fs.tum.de>
    
    drivers/net/tlan.c: In function `tlan_remove_one':
    drivers/net/tlan.c:449: warning: implicit declaration of function `pci_release_regions'

commit b618744f78907d66efe89a544444a914a1023163
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 14 20:23:33 2004 -0700

    [PATCH] fix cyclades compile with !PCI
    
    From: Adrian Bunk <bunk@fs.tum.de>
    
    drivers/char/cyclades.c: In function `cy_cleanup_module':
    drivers/char/cyclades.c:5638: warning: implicit declaration of function `pci_release_regions'

commit 42f0e8f2b7a34d40fba6ef64c2023a47f3189a44
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 14 20:23:22 2004 -0700

    [PATCH] Fix endianess in modpost when cross-compiling for sparc on i386
    
    From: Mathieu Chouquet-Stringer <mchouque@online.fr>
    
    This patch makes the following code work again:
    
    #ifdef STT_REGISTER
                    if (info->hdr->e_machine == EM_SPARC ||
                        info->hdr->e_machine == EM_SPARCV9) {
                            /* Ignore register directives. */
                            if (ELF_ST_TYPE(sym->st_info) == STT_REGISTER)
                                    break;
                    }
    #endif
    
    This portion of code is sparc specific and nothing else in modpost.c uses
    e_machine meaning cross-compiling for sparc on i386 (or any little endian
    machine) is the only way to experience the bug.
    
    Without it, e_machine has the wrong value and modpost then generates a lot
    of "*** Warning: \"symbol\" [filename.ko] undefined" messages.

commit 7d0c5f9a63c1d0e43bfe2d83a14d52e4e384bd83
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 14 20:23:12 2004 -0700

    [PATCH] m68k: use print_modules()
    
    From: Geert Uytterhoeven <geert@linux-m68k.org>

commit 22e1c5c4e32614bb23a817ea53b4fa4842803d21
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 14 20:23:01 2004 -0700

    [PATCH] implement print_modules()
    
    From: Arjan van de Ven <arjanv@redhat.com>,
          Rusty Russell <rusty@rustcorp.com.au>
    
    The patch below resolves the "Not Yet Implemented" print_modules() thing.
    This is a really useful feature for distros; it allows us to do statistical
    analysis on which modules are present how often in oopses compared to how
    often they are used normally.  In addition it helps to spot candidates for
    certain bugs without having to go back to the customer asking for this
    information.

commit d0980c12bbb794fdfef4fb0f82e08e2e94905daf
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 14 20:22:51 2004 -0700

    [PATCH] Fix reiserfs oom crash
    
    From: Oleg Drokin <green@linuxhacker.ru>
    
    Thanks to Standford guys, a case where reiserfs can dereference NULL
    pointer if memory allocation fail during mount was identified.

commit deb2ae4a2d3d744b0ee21a6e8ba41e72fef50aef
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 14 20:22:41 2004 -0700

    [PATCH] fix block layer ioctl bug
    
    From: Alan Cox <alan@redhat.com>
    
    The block layer checks for -EINVAL from block layer driver ioctls.  This is
    wrong - ENOTTY is unknown and some drivers correctly use this.  I suspect
    for an internal ioctl 2.7 should change to -ENOIOCTLCMD and bitch about old
    style returns
    
    This is conservative fix for the 2.6 case, it keeps the bogus -EINVAL to
    avoid breaking stuff

commit 4539d2e48ff3230c426d048770c52f1f0eaee3dc
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 14 20:22:30 2004 -0700

    [PATCH] fix linux doc errors
    
    From: Alan Cox <alan@redhat.com>

commit 5671b0c551ecac1e929d3820778e0345555017c4
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 14 20:22:19 2004 -0700

    [PATCH] security: minor cleanups in capability.c
    
    From: Chris Wright <chrisw@osdl.org>
    
    Remove confusing error message when loading as secondary module, and ditch
    conditional MY_NAME macro.

commit fc3a78892d9efc478cdb343e95f7ee4d9842d2c9
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 14 20:22:09 2004 -0700

    [PATCH] security: remove empty build of capability.o
    
    From: Chris Wright <chrisw@osdl.org>
    
    The build includes capability.c when CONFIG_SECURITY=n, yet the whole file is
    ifdef'd out.  Remove unnecessary build step as well as superfluous ifdefs.

commit cd8d1252e8d44b5c1776398c282eb2db9003efe5
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 14 20:21:58 2004 -0700

    [PATCH] PCI debug compile fix in sis_router_probe()
    
    From: Pavel Roskin <proski@gnu.org>
    
    I get a compile error when I define "DEBUG" in arch/i386/pci/pci.h.  Variable
    rt is not defined in sis_router_probe(), file arch/i386/pci/irq.c.

commit 7dd692fc712b84d7d882f23f17af9626afe28b50
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 14 20:21:48 2004 -0700

    [PATCH] calculate NGROUPS_PER_BLOCK from PAGE_SIZE
    
    From: Greg Edwards <edwardsg@sgi.com>
    
    On ia64, EXEC_PAGESIZE (max page size) is 65536, but the default page size is
    16k.  This results in NGROUPS_PER_BLOCK in include/linux/sched.h being
    calculated incorrectly when the page size is anything other than 64k.  For
    example, on a 16k page size kernel, a setgroups() call with a gidsetsize of
    65536 will end up walking over memory since only 1/4 of the needed pages were
    allocated for the blocks[] array in the group_info struct.
    
    Patch below calculates NGROUPS_PER_BLOCK from PAGE_SIZE instead.

commit ee4c48c066c1aa2e6f34decf4ad15a3a32952c6a
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 14 20:21:37 2004 -0700

    [PATCH] dquot_release oops fix
    
    From: Jan Kara <jack@ucw.cz>
    
    Fix a null-pointer-deref oops in the quota code.

commit 252a94e94c21a94f5edb8cc3d1e250fedaf5fba3
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 14 20:21:27 2004 -0700

    [PATCH] videodev: handle class_register() failure
    
    From: "Randy.Dunlap" <rddunlap@osdl.org>
    
    From: <WHarms@bfs.de>(Walter Harms)
    
    (acked by Gerd)

commit 19bee149edb1d1b47dfc786041f3be579aa0d0bb
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 14 20:21:16 2004 -0700

    [PATCH] Update laptop mode control script with XFS_HZ=100
    
    From: Bart Samwel <bart@samwel.tk>
    
    The laptop mode control script incorrectly guesses XFS_HZ=1000.  This is
    incorrect, since the patches that made XFS use USER_HZ went into 2.6.6 as
    well.  This changes XFS_HZ to 100 and removes the warning from the doc about
    checking XFS_HZ.

commit e82512d72bfd1c488590c422b2a496a636d29524
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 14 20:21:06 2004 -0700

    [PATCH] Watchdog timer for Intel IXP4xx CPUs
    
    From: Deepak Saxena <dsaxena@plexity.net>
    
    Following patch adds a driver for the watchdogs on the Intel IXP4xx family of
    network processors (ARM).

commit b604c40088c7dd41006fc8bba80ac7046a4f6a42
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 14 20:20:55 2004 -0700

    [PATCH] Fix AladdinCard entry in parport_pc
    
    From: Christian Groessler <cpg@aladdin.de>
    
    Our AladdinCard also uses the oxsemi_840 chips and locks up when ecp mode
    is enabled.

commit 4d103436faa1b95ca9cf2780e2a41769d314ff92
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 14 20:20:44 2004 -0700

    [PATCH] create_workqueue locking fix
    
    Fix some silliness in there.

commit 15c2165e9e7781106348addd65b2ad4dcbdcde9d
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 14 20:20:34 2004 -0700

    [PATCH] laptop-mode documentation fix
    
    From: Sau Dan Lee <danlee@informatik.uni-freiburg.de>
    
    The script /etc/acpi/actions/battery.sh in the document doesn't run,
    because of a wrong name.

commit c793ef32a95e0c3c33e4f926b074c7d9ffe2bca2
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 14 20:20:24 2004 -0700

    [PATCH] ib700wdt watchdog driver fix #2
    
    From: Patrice Bouchand <PBouchand@cyberdeck.com>
    
    The value written in the WDT_STOP register is not important.  As soon as
    something is written, the watchdog timer stops.  But things will be cleaner
    if we use the following patch.

commit 4020f4a0f22ffb9c95979a29cc827edd672cab79
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 14 20:20:13 2004 -0700

    [PATCH] ib700wdt watchdog driver fix
    
    From: Patrice Bouchand <PBouchand@cyberdeck.com>
    
    ibwdt_ping(): we should write the current timeout's index into the holdoff
    register, not the timeout's value in seconds.

commit a50376bda091b762dc2bcfdd54b386157829f84b
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 14 20:20:03 2004 -0700

    [PATCH] expose backing dev max read-ahead
    
    From: Jens Axboe <axboe@suse.de>
    
    Expose the blockdev's VM readahead in /sys/block/hda/queue/read_ahead_kbytes
    
    This duplicates `blockdev --setra', but we're trying to get away from
    ioctls.
    
    It would be nice to have a readahead-setting mechanism which also allows,
    say, NFS to be tuned.  But there is no common exposure point for
    backing_dev_infos.  One option might be per-superblock:
    
    	mount -o remount,read_ahead_kbytes=64
    
    but the generic remount code also has no visibility of the backing_dev, so it
    would need a new super_block operation.  One which doesn't accidentally modify
    default_backing_dev_info.

commit 0575b04abcd3032ee80a18bf9e86f96fd5fe01d7
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 14 20:19:52 2004 -0700

    [PATCH] efivars: check that it's enabled
    
    From: "Randy.Dunlap" <rddunlap@osdl.org>
    
    EFI-enabled kernels crash on non-EFI machines.  efivars_init() and
    efivars_exit() need to check efi_enabled instead of assuming that the
    system is using EFI.

commit 8f1ee1b36556cffee3f73d8af385fab9f6891470
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 14 20:19:35 2004 -0700

    [PATCH] make buildcheck
    
    From: Arjan van de Ven <arjanv@redhat.com>
    
    the patch below adds a "make buildcheck" target which checks for the "uses
    exit in init" bug using Keith Owen's script.  In the future other similar
    sanity checks can be added to this target, but even just this one has been
    quite useful already.  I use it in the kernel rpm build process for
    example, and I'm sure the OSDL build testers can/want to use it too.
    
    From: Keith Owens <kaos@ocs.com.au>
    
      They commented out the progress print statements, I prefer to have them
      present but no big deal.  The licence is missing.

commit 53d202028111ae48b54d8b88e9f71a8d4630b668
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 14 20:19:25 2004 -0700

    [PATCH] Include Aliases in kallsyms
    
    From: Rusty Russell <rusty@rustcorp.com.au>
    
    Kallsyms discards symbols with the same address, but these are sometimes
    useful.  Skip this minor optimization and make kallsyms_lookup deal with
    aliases

commit bfb288f1177db455dca1387fd3b97e3b9b94b09c
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 14 20:19:11 2004 -0700

    [PATCH] show last kernel-image symbol in /proc/kallsyms
    
    From: Rusty Russell <rusty@rustcorp.com.au>
    
    The current code doesn't show the last symbol (usually _einittext) in
    /proc/kallsyms.  The reason for this is subtle: s_start() returns an empty
    string for position 0 (ignored by s_show()), and s_next() returns the first
    symbol for position 1.
    
    What should happen is that update_iter() for position 0 should fill in the
    first symbol.  Unfortunately, the get_ksymbol_core() fills in the symbol
    information, *and* updates the iterator: we have to split these functions,
    which we do by making it return the length of the name offset.
    
    Then we can call get_ksymbol_core() without moving the iterator, meaning
    that we can call it at position 0 (ie.  s_start()).

commit 017474ed123ac14187eef6a0d5b76becbce763e0
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 14 20:19:00 2004 -0700

    [PATCH] slabify iocontext + request_queue
    
    From: Jens Axboe <axboe@suse.de>
    
    Move both request_queue and io_context allocation to a slab cache.
    
    This is mainly a space-saving exercise.  Some setups have a lot of disks
    and the kmalloc rounding-up can consume significant amounts of memory.

commit 6570695993f02465f4f84c7fc252fc43f7180974
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 14 20:18:50 2004 -0700

    [PATCH] i2o_proc module owner fix
    
    From: Warren Togami <wtogami@redhat.com>

commit 5bb8577f1fedb6d047911154431153dcdbea99fe
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 14 20:18:39 2004 -0700

    [PATCH] Fix i2o_proc kernel panic on access of /proc/i2o/iop0/lct
    
    From: Markus Lidel <Markus.Lidel@shadowconnect.com>
    
    The patch converts i2o_proc to seq_file, thereby fixing a bug in the
    i2o_proc.c module, where the kernel panics, if you access /proc/i2o/iop0/lct
    and read more then 1024 bytes of it.

commit c36b18ac17c09799123307b79c4ceb1e8ef0add8
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 14 20:18:28 2004 -0700

    [PATCH] fbdev: Q40 fbdev updates.
    
    From: James Simmons <jsimmons@infradead.org>
    
    It ports this driver to sysfs api and fixes a colormap issue.

commit 29c968d694c8a2d8132c42cac8494c0e48e0bbe6
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 14 20:18:18 2004 -0700

    [PATCH] fbdev: Fix fbcon and unimap
    
    From: Fabrice Menard <menard.fabrice@wanadoo.fr>
    
    Trying to solve my latin1 char problems with the framebuffer console, I
    found that fbcon doesn't set a unicode map.

commit 30b182577d5ae7d082fa300c44d865224d5cfe31
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 14 20:18:07 2004 -0700

    [PATCH] fbdev: New Asiliant framebuffer driver.
    
    From: James Simmons <jsimmons@infradead.org>
    
    This is the new asiliant framebuffer driver.

commit 9767e5dcb70115de034848a059c13e8bd446fd50
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 14 20:17:56 2004 -0700

    [PATCH] fbdev: Vesa Fbdev update fix
    
    From: Geert Uytterhoeven <geert@linux-m68k.org>
    
    On Sun, 25 Apr 2004, James Simmons wrote:
    > This patch migrates the Vesa Framebuffer driver over to the
    > framebuffer_alloc/framebuffer_release api. It also fixes the error
    > handling paths. The mtrr issue that Geert brought up has been fixed.
    > With your approval Geert, Ben please apply this patch.
    
    > +	/* Set video size according to vram boot option */
    > +	if (vram && vram * 1024 * 1024 != vesafb_fix.smem_len)
    > +		vesafb_fix.smem_len = vram * 1024 * 1024;
    
    The second part of the test can be removed. The rest looks OK to me.

commit b5f86b850366b01c04b6d4fa862a601164cebf88
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 14 20:17:45 2004 -0700

    [PATCH] fbdev: Vesa Fbdev update
    
    From: James Simmons <jsimmons@infradead.org>
    
    This patch migrates the Vesa Framebuffer driver over to the
    framebuffer_alloc/framebuffer_release api.  It also fixes the error
    handling paths.  The mtrr issue that Geert brought up has been fixed.

commit f5f2e754fb64d7d17a746e1ff1f24f040156bc7e
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 14 20:17:34 2004 -0700

    [PATCH] fbdev: Virtual fbdev updates
    
    From: James Simmons <jsimmons@infradead.org>
    
    This is attempt 2 at the virtual framebuffer patch.  It migrates the driver
    to the framebuffer_release/framebuffer_alloc api.  It doesn't enable the
    driver by default.

commit 3cb52df526d2e26f0e405f6cfd14aa640bf9339d
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 14 20:17:23 2004 -0700

    [PATCH] fbdev: Fix NULL-ptr dereference in pm2fb_probe
    
    From: Jim Hague <jim.hague@acm.org>
    
    It fixes the NULL pointer dereference and also a problem in pm2fb_blank().

commit d04c36b43bb1d4535b947b707f81451865f77e0c
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 14 20:17:12 2004 -0700

    [PATCH] fbdev: set a default access_align value
    
    From: James Simmons <jsimmons@infradead.org>
    
    Set the default access_align variable.  This variable tells us how much data
    the hardware can handle in a single read/write cycle.  For example the epson
    chipset can handle only 16 bit reads and writes to the framebuffer.

commit 794e931fda32f4a56da087d18957c0e9d139af7c
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 14 20:17:01 2004 -0700

    [PATCH] fbdev: remove redundant local
    
    From: James Simmons <jsimmons@infradead.org>
    
    Remove extra variable. We use i instead of rc.

commit 5a35f98298eb59a2c1ec9ad8a6278644701b488f
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 14 20:16:51 2004 -0700

    [PATCH] fbdev: remove redundant p->vrows calculation
    
    From: James Simmons <jsimmons@infradead.org>
    
    This patch removes the redundent calculation of p->vrows.  This is done in
    fbcon_resize.

commit eb7b807c9d4f26fb6a5b4e0c810a1c2c43756912
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 14 20:16:40 2004 -0700

    [PATCH] fbdev: clean up logo handling
    
    From: James Simmons <jsimmons@infradead.org>
    
    This make the logo handling code easier to read.  Merged the two code blocks
    since they test for the exact same condition.

commit e51b83567ca88653b3c4ca3674ac2ed34ffe15be
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 14 20:16:30 2004 -0700

    [PATCH] fbdev: video/imsttfb.c warning fix
    
    From: "Luiz Fernando N. Capitulino" <lcapitulino@prefeitura.sp.gov.br>
    
    drivers/video/imsttfb.c:1089: warning: `imsttfb_load_cursor_image' defined but not used
    drivers/video/imsttfb.c:1159: warning: `imstt_set_cursor' defined but not used

commit 164fc4cf3399f1f1fddd905c516a8c8d7166db53
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 14 20:16:20 2004 -0700

    [PATCH] fbdev: video/tdfxfb.c warning fix
    
    From: "Luiz Fernando N. Capitulino" <lcapitulino@prefeitura.sp.gov.br>
    
    Fix this:
    
    drivers/video/tdfxfb.c:1005: warning: `tdfxfb_cursor' defined but not used
    
    and make the acceleration function selectable (like hgafb and tridentfb)
    
    Geert says:
    
     tdfxfb_cursor() was not used before, causing a compiler warning.
     tdfxfb_cursor() may work, but we don't know, so we didn't dare to enable it
     by default.  Now the user (he who has the hardware) can enable it, and tell
     us whether it works or not.

commit 042c5b0d1dd1aa1434e50f53a0b623f31f9ca650
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 14 20:16:09 2004 -0700

    [PATCH] fbdev: video/hgafb.c warning fix
    
    From: "Luiz Fernando N. Capitulino" <lcapitulino@prefeitura.sp.gov.br>
    
    Make HGA acceleration functions selectable in kernel config, fix these
    warnings:
    
    drivers/video/hgafb.c:452: warning: `hgafb_fillrect' defined but not used
    drivers/video/hgafb.c:472: warning: `hgafb_copyarea' defined but not used
    drivers/video/hgafb.c:502: warning: `hgafb_imageblit' defined but not used

commit a75e8fb85d46e31e54b3baa1ccec2813dca9dd9f
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 14 20:15:59 2004 -0700

    [PATCH] fbdev: video/tridentfb.c warning fix
    
    From: "Luiz Fernando N. Capitulino" <lcapitulino@prefeitura.sp.gov.br>
    
    Speaking with frame buffer people, we agree with this patch to fix the
    warning:
    
    drivers/video/tridentfb.c:455: warning: `tridentfb_fillrect' defined but not used
    drivers/video/tridentfb.c:473: warning: `tridentfb_copyarea' defined but not used

commit c14b0803220768d24a572982eb2b78c0f29c414c
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 14 20:15:48 2004 -0700

    [PATCH] fbdev: Neomagic driver update.
    
    From: James Simmons <jsimmons@infradead.org>
    
    Here is a updated driver for the neomagic.

commit 68f1120532d9d341169a91ced3bfcea500fe53f0
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 14 20:15:37 2004 -0700

    [PATCH] fbdev: radeonfb: fix garbled screen
    
    From: Benjamin Herrenschmidt <benh@kernel.crashing.org>
    
    > My screen is still a bit garbeld after booting.
    > Still like http://zodiac.dnsalias.org/images/garbage.jpg
    
    Yes, usual boot-time x86 garbage. Well, let's imagine it's as simple
    as clearing the framebuffer during boot :) Try this patch and let me
    know. If that doesn't help, then the problem is definitely in fbcon.

commit b36f6b5f5040760cf0c1adae485d6209e3cdfb97
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 14 20:15:26 2004 -0700

    [PATCH] autofs4 compat ioctls
    
    From: <raven@themaw.net>
    
    These are the ioctls that need to be added to the compatibility layer.
    
    They are all esentially the same as the AUTOFS_IOC_PROTOVER in their
    requirements and so should be fine.

commit e246a5f2b9765059b88a86e968f219c6283cb4a9
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 14 20:15:15 2004 -0700

    [PATCH] autofs4 race fix
    
    From: Ian Kent <raven@themaw.net>
    
    The case where two process similtaneously trigger a mount in autofs4 can
    cause multiple requests to the daemon for the same mount.  The daemon
    handles this OK but it's possible an incorrect error to be returned.  For
    this reason I believe it is better to change the spin lock to a semaphore
    in waitq.c.  This makes the second and subsequent request wait on the q as
    ther supposed to.

commit 9ca0507d7f249ae16cc29cfe4f7c1e8f7bbd73dd
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 14 20:15:04 2004 -0700

    [PATCH] autofs4: readdir futureproofing
    
    From: Ian Kent <raven@themaw.net>
    
    Needed for support coming development plans.

commit 340a9772c8484ff4cff6e654c823dc4f267489b9
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 14 20:14:54 2004 -0700

    [PATCH] autofs4: add ioctl to query unmountability
    
    From: Ian Kent <raven@themaw.net>
    
    Add ioctl to find out if autofs mount can be umounted.  When the daemon
    discovers this it's past the point of no return.

commit f69b66188c11933c2c73c9c381726a897c51094d
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 14 20:14:43 2004 -0700

    [PATCH] autofs4: fix handling of chdir and chroot
    
    From: <raven@themaw.net>
    
    Pushed changes in sys_chdir and sys_chroot into the revalidate/lookup by
    using nameidata hint.

commit 7d1f193d26bfe1366380dac0bafa8f2682f58439
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 14 20:14:32 2004 -0700

    [PATCH] autofs4: readdir fixes
    
    From: Ian Kent <raven@themaw.net>
    
    a. Implement readdir and friends for directory lookup for late mounting.
       This is done largely by replacing a catch all condition in
       try_to_fill_dentry with appropriate cases.
    
    b. Add path calc.  function in waitq.c to get extended path to return to
       daemon (for direct mounts).
    
    c. Add revalidate calls to sys_chdir and sys_chroot so that pwd lookups
       work correctly.
    
    d. Add ioctl to retrieve minor version for automount daemon (and me) to
       recognise module fix level.  Bumped minor version to 5.
    
    From: Hugh Dickins <hugh@veritas.com>
    
      After chdir (or chroot) to non-existent directory on 2.6.5-mm5, you can no
      longer unmount filesystem holding working directory (or root).

commit 8b22c0c5387fcf1642c458482e8a278d7b49ac80
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 14 20:14:21 2004 -0700

    [PATCH] autofs4: may_umount_tree() cleanup
    
    From: <raven@themaw.net>
    
    Patch to sync 2.6.6-rc2-mm2 with the result of my discussion with
    Christoph Hellwig.
    
    Difference is that Christoph realised that merging may_umount_tree and
    may_umount was not worth it. They are now seperate functions.

commit ee81def6a75bcd48f43ef2fbdfe12878dba01aa6
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 14 20:14:11 2004 -0700

    [PATCH] autofs4: expiry refcount fixes
    
    From: Ian Kent <raven@themaw.net>
    
    This patch is the result of an e-mail discussion with Soni Maneesh.  He felt
    that the use of reference counts in the expire module is unreliable (in the
    presence of rcu) and suggested it should use standard VFS calls where
    possible.  This has been done.  Once the boundary in autofs is reached we
    have no choice but to resort using reference counts (but under the
    vfsmount_lock).
    
    
    After review by hch:
    
    - renamed autofs4_may_umount to __may_umount_tree, made it static and moved
      it to namespace.c.
    
    - added stub function may_umount_tree with description
    
    - altered may_umount to use above stub function and added little description
    
    - added may_umount_tree prototype to fs.h
    
    - removed the EXPORT_SYMBOL for vfsmount_lock
    
    - updated expire.c to suit

commit 79c2bc374be40f00be49acf188b0847f7b1fa023
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 14 20:14:00 2004 -0700

    [PATCH] autofs4: locking rework
    
    From: Ian Kent <raven@themaw.net>
    
    Remove BKL from autofs4 module and add spinlock to serialise access to the
    automount daemon communication waitq.
    
    Locking requirements are different in 2.6 and so I'm seeking comments and
    suggestions on this.  I have taken a rather heavy handed approach to this in
    the patch.  For example, the VFS operations that directly change the
    filesystem, such as autofs4_mkdir etc, hold the inode semaphore on entry so
    the BKL has been removed.  I can't see why two locking mechanisms are needed.
     Rather than add locking all over the place, I'm looking for justification
    it's needed, as I don't see it myself.

commit 3c51ca5fd1cc62e642daaac669947d2348f26b23
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 14 20:13:49 2004 -0700

    [PATCH] autofs4: printk cleanups and memory leak fix
    
    From: Ian Kent <raven@themaw.net>
    
    - Correct text in DPRINTK messages and comments, a little reformating and
      correct URL location for autofs v4 in Kconfig message.
    
    - Fix error-path memory leak in autofs4_fill_super()

commit 44367d15f89f15a3b6b034097ade430afc9d651a
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 14 20:13:39 2004 -0700

    [PATCH] autofs4: dnotify + autofs may create signal/restart syscall loop
    
    From: Ian Kent <raven@themaw.net>
    
    From: Jeff Mahoney <jeffm@suse.com>
    
    I saw a recent bug report that showed when a process set up a dnotify
    against the autofs root and then attempted an access(2) call inside the
    autofs namespace on a mount that would fail, it would create a
    signal/restart loop.
    
    The cause is that the autofs code checks to see if any signals are pending
    after it waits on a response from the autofs daemon.  If it finds any, it
    assumes that autofs_wait was interrupted, and that it should return
    -ERESTARTNOINTR.  The problem with this is that a signal_pending(current)
    check will return true if *any* signals were received, not just if a signal
    that interrupted the wait was received.  autofs_wait explicitly blocks all
    signals except for SIGKILL, SIGQUIT, and SIGINT before calling
    interruptible_sleep_on.
    
    The effect is that if a dnotify is set against the autofs root, when the
    autofs daemon creates the directory, a dnotify event will be sent to the
    originating process.  Since the code in autofs_root_lookup doesn't check to
    see what signals are actually pending, it bails early, telling the caller
    to try again.  The loop goes on forever until interrupted via one of the
    actual interrupting signals.
    
    The following patch makes both autofs_root_lookup and autofs4_root_lookup
    verify that one of its defined "shutdown" signals are pending before
    bailing out early.  Any other signal should be delivered later, as
    expected.  It doesn't matter if the signal occured outside of the sleep in
    autofs_wait.  The calling process will either go away or try again.

commit 55faa5298a7a38274c29281e4cc172a011027f6b
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 14 20:13:28 2004 -0700

    [PATCH] Use -msoft-float
    
    From: Dave Jones <davej@redhat.com>
    
    To catch accidental usage of floating point.  Has been in -mm for ages.

commit 44469277e55f012a460becb8d4d59397e7c6d0b3
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 14 20:13:17 2004 -0700

    [PATCH] sched: reduce node balancing interval
    
    From: Nick Piggin <nickpiggin@yahoo.com.au>
    
    From: Suresh Siddha <suresh.b.siddha@intel.com>
    
    Node max rebalance interval is too large.  It is currently dependent on
    number of online cpus.  For 16 cpu system, max node balance interval in
    busy case is 32 seconds.  Agreed that it will use max 32 seconds only when
    it doesn't find imbalance for a long time.  But this will lead to slow
    response time in cases where load runs for a second with no imbalance and
    suddently creates an imbalance.  My patch makes the busy max node rebalance
    interval equal to the base [scheduler].

commit 632eb5ca925ff5f830ed85e45c12b2a22bb8e1d9
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 14 20:13:06 2004 -0700

    [PATCH] sched: less locking in balancing
    
    From: Nick Piggin <nickpiggin@yahoo.com.au>
    
    Analysis and basic idea from Suresh Siddha <suresh.b.siddha@intel.com>
    
    "This small change in load_balance() brings the performance back upto base
    scheduler(infact I see a ~1.5% performance improvement now).  Basically
    this fix removes the unnecessary double_lock.."
    
    Workload is SpecJBB on 16-way Altix.

commit 44069c37b6e110092b1836fc50c64374b4f5129e
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 14 20:12:56 2004 -0700

    [PATCH] sched: fix scheduler for unsynched processor sched_clock
    
    From: Nick Piggin <nickpiggin@yahoo.com.au>
    
    Fine-tune the unsynched sched_clock handling.
    
    Basically, you need to be careful about ensuring timestamps get correctly
    adjusted when moving CPUs, and you *can't* look at your unadjusted
    sched_clock() and a remote task's ->timestamp and try to come up with
    anything meaningful.
    
    I think this second problem will really hit hard in the activate_task path
    on systems with unsynched sched_clock when you're waking up a remote task,
    which happens very often.  Andi, I thought some Opterons have unsynched
    tscs?  Maybe this is causing your unexplained bad interactivity?
    
    Another problem is a fixup in pull_task.  When adjusting ->timestamp from
    one processor to another, you must use timestamp_last_tick for the local
    processor too.  Using sched_clock() will cause ->timestamp to creep
    forward.
    
    A final small fix is for sync wakeups.  They were using __activate_task for
    some reason, thus they don't get credited for sleeping at all AFAIKS.
    
    And another thing, do we want to #ifdef timestamp_last_tick so it doesn't
    show on UP?

commit b75125deebc5ff5fe96aba64ba11dad7ed320b2e
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 14 20:12:44 2004 -0700

    [PATCH] sched: improved cpu_load rounding
    
    From: Nick Piggin <nickpiggin@yahoo.com.au>
    
    "Siddha, Suresh B" <suresh.b.siddha@intel.com> noticed a problem in the
    cpu_load averaging where the integer truncation could sometimes cause cpu_load
    to never quite reach its target.
    
    I'm not sure that you could demonstrate a real world problem, but I quite
    like this fix.

commit 3d48f700203a312ee4840d9fffaef788342dbdfa
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 14 20:12:33 2004 -0700

    [PATCH] Fix writeback_inodes-vs-umount race
    
    Fix bug identified by Chris Mason.
    
    If writeback_inodes is left holding a ref on the superblock's last inode then
    the superblock list walk can race with umount and the superblock can be
    released.
    
    Take and put a ref against the superblock to fix that.

commit 066479e379f387e5b1da0f1149fe0b97bac58888
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 14 20:12:23 2004 -0700

    [PATCH] x86: stack dumps using frame pointers
    
    From: Adam Litke <agl@us.ibm.com>
    
    Teach the x86 stack tracing code to use frame pointers, if they are available.
    It eliminates all the false-positives in the normal stack traces.
    
    This is a big improvement, and -fomit-frame-pointer seems to make no
    difference at all to generated code size.  Maybe we should kill off
    -fomit-frame-pointer.

commit fc4c3ad209fdbb5f1f76b7a396fefd1fac107564
Author: Shai Fultheim <shai@ftcon.com>
Date:   Fri May 14 19:42:40 2004 -0700

    [PATCH] Multiple (ICH3) IDE-controllers in a system
    
    This fixes a problem with multiple IDE controllers in a system.
    
    The problem is that pcibios_fixups table (in arch/i386/pci/fixup.c) uses
    the pci_fixup_ide_trash() quirk for Intel's ICH3 (my case specifically
    8086:248b).  This clears any bogus BAR information set up by the BIOS.
    
    In a system which has multiple ICH3's can't use any of the IDE
    controllers beside the one on the first ICH3.
    
    Anyhow, the fix is to make sure pci_fixup_ide_trash resets the BARs only
    for first time being called, so the subsequent IDE controllers will use
    the BIOS BARs.  This is better than "loosing" all these IDE controllers
    in the case their BARs set right.
    
    The issue discussed and agreed with Bartlomiej Zolnierkiewicz (see below).

commit c39393c40205e12da4440b9f5d45feb29934fb87
Author: Jeff Garzik <jgarzik@redhat.com>
Date:   Fri May 14 17:42:41 2004 -0400

    [sound/oss i810] pci id cleanups
    
    The driver defined its own PCI id constants.  Kill the majority,
    which were redundant, and move the rest to include/linux/pci_ids.h.
    
    Also, move open-coded tests for "new ICH" audio chips to a single
    helper function.  These tests were being patched with each new
    ICH motherboard from Intel, resulting in each new PCI id being added
    to several places in the driver.
    
    Note that, even though this should be a harmless patch, there
    exists the remote possibility that I mis-matched some of the
    PCI ids, as I only tested ICH5.

commit 2eb43bc469cb1ef0d3c648ad3d0e461a8ec491ad
Author: Jeff Garzik <jgarzik@redhat.com>
Date:   Fri May 14 17:03:42 2004 -0400

    [sound/oss i810] bump driver to version 1.00

commit 2cf05d78294e8c5015e6f347e390d93a3c383f53
Merge: 5ea484a... 81da67b...
Author: Jeff Garzik <jgarzik@redhat.com>
Date:   Fri May 14 16:18:55 2004 -0400

    Merge redhat.com:/spare/repo/linux-2.6
    into redhat.com:/spare/repo/i810-audio-2.6

commit 706c9015d43804f48361bece4b4d3509cd4d95eb
Merge: cae2199... a0e9957...
Author: Len Brown <len.brown@intel.com>
Date:   Fri May 14 15:14:04 2004 -0400

    Merge intel.com:/home/lenb/src/linux-acpi-test-2.6.6
    into intel.com:/home/lenb/src/linux-acpi-test-2.6.7

commit a0e9957766982e2fada267b03ab8d2bbf1d34ab0
Author: Len Brown <len.brown@intel.com>
Date:   Fri May 14 15:09:23 2004 -0400

    [ACPI] delete IOAPIC-disable workaround on x86_64/VIA
    http://bugme.osdl.org/show_bug.cgi?id=1530

commit e92f75e77c3c20cefc65c62c225c14400910e806
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Fri May 14 09:11:43 2004 -0700

    Fix typo nonsense test in radeon PMAC backlight code.

commit 0fed95846d2d570e866c159927d155dc7b25b6d5
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Fri May 14 09:01:25 2004 -0700

    Make dev_dbg() "use" it's 'dev' argument even when not debugging.
    
    This avoids warnings about unused variables.

commit 6a1ae045f0da158405b72b5b1a320f8b21bcf6c5
Merge: 6999066... a0207f1...
Author: Vojtech Pavlik <vojtech@suse.cz>
Date:   Fri May 14 17:44:53 2004 +0200

    Merge bkbits:input into suse.cz:/home/vojtech/bk/input

commit a0207f19f657b13ea4100d2032fe0f5143830061
Merge: e88468a... 141baf8...
Author: Vojtech Pavlik <vojtech@suse.cz>
Date:   Fri May 14 17:21:02 2004 +0200

    Merge suse.cz:/home/vojtech/bk/linus into suse.cz:/home/vojtech/bk/input

commit c16c278b274de7a6536aa75df921324f012e5f87
Merge: a9c6320... 2eb43bc...
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Fri May 14 08:17:04 2004 -0700

    Merge bk://kernel.bkbits.net/jgarzik/i810-audio-2.6
    into ppc970.osdl.org:/home/torvalds/v2.6/linux

commit a9c6320527399ddb24e24b45af9fc993ef0e8148
Merge: edd53aa... a00507f...
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Fri May 14 08:10:36 2004 -0700

    Merge bk://kernel.bkbits.net/davem/net-2.6
    into ppc970.osdl.org:/home/torvalds/v2.6/linux

commit edd53aa9955f50c83bcb41da2773d0a3b15ad9fc
Author: Anton Altaparmakov <aia21@cam.ac.uk>
Date:   Fri May 14 07:53:01 2004 -0700

    [PATCH] x86_64 has buggy ffs() implementation
    
    x86_64 has an incorrect ffs() implementation.  The asm uses "g" instead
    of "rm" for the bsfl instruction.  (This was spotted by Yuri Per.)
    
    bsfl does not accept constant values but only memory or register ones.
    On i386 the correct "rm" is used.
    
    This causes NTFS build to fail as gcc optimizes a variable into a
    constant and ffs() then fails to assemble.

commit 9bdcb64b99a777b6c6e4d70717b3a1acbc2ade55
Merge: ae855f4... 8b5bbc6...
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Fri May 14 07:47:48 2004 -0700

    Merge http://linux-ntfs.bkbits.net/ntfs-2.6
    into ppc970.osdl.org:/home/torvalds/v2.6/linux

commit ae855f4073de970fdbd1c17890659f368f90d40b
Author: Anton Altaparmakov <aia21@cantab.net>
Date:   Fri May 14 16:16:04 2004 +0100

    NTFS: 2.1.11 - Rename uchar_t to ntfschar.

commit a00507f7b50c3950d487a0e33187b245d0985b99
Merge: 5ea484a... da749ce...
Author: David S. Miller <davem@kernel.bkbits.net>
Date:   Fri May 14 07:46:30 2004 -0700

    Merge davem@nuts.davemloft.net:/disk1/BK/net-2.6
    into kernel.bkbits.net:/home/davem/net-2.6

commit 8b5bbc6954975d0dd3e2800168b35ad01f508b0f
Author: Karsten Keil <kkeil@suse.de>
Date:   Fri May 14 07:45:59 2004 -0700

    [PATCH] fix typo in avm_cs PCMCIA AVM B1 cardservice driver
    
    this trivial fix makes the AVM B1 PCMCIA cards work with 2.6

commit 5ea484a816af65e41aecfbd41e685df84fde683b
Author: Santiago Leon <santil@us.ibm.com>
Date:   Fri May 14 06:47:15 2004 -0700

    [PATCH] PowerPC Virtual Ethernet links to /sys/class/net/ethX
    
    This adds links to the driver and device inside /sys/class/net/ethX for
    PowerPC Virtual Ethernet devices.

commit 49ac9cc312e3644aef496e05092dd4dce1d9f2e8
Author: Santiago Leon <santil@us.ibm.com>
Date:   Fri May 14 06:47:05 2004 -0700

    [PATCH] PowerPC Virtual Ethernet duplicate MAC addresses
    
    This fixes a bug where different partitions were assigned the same MAC
    address.  Also, according to Anton, gcc 3.5 didn't like our mac_addr_p
    gymnastics, so this ends up fixing that as well.

commit 564c36d2173eac6c4d84a7b9be08bcd4554ddc2a
Author: Anton Altaparmakov <aia21@cantab.net>
Date:   Fri May 14 14:30:56 2004 +0100

    NTFS: 2.1.11 - Driver internal cleanups.

commit 69990663b3371c1c97fa84223381cb44a96b98e7
Author: Vojtech Pavlik <vojtech@suse.cz>
Date:   Fri May 14 15:18:46 2004 +0200

    input: Check for IM Explorer mice even if IMPS check failed.

commit 862d5483ed3b2fb51de12a6b46e17ed3bc2202f8
Author: Benjamin Herrenschmidt <benh@kernel.crashing.org>
Date:   Fri May 14 06:07:57 2004 -0700

    [PATCH] ppc64: Add proper  SMP init on dual 970FX based machines
    
    This patch fixes SMP boot on Apple Xserve G5

commit 4d45d9200a6aa3fee5347fa07b5b15bace5fe2e3
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 14 05:56:29 2004 -0700

    [PATCH] ppc64 iSeries: allow read only virtual disks
    
    From: Stephen Rothwell <sfr@canb.auug.org.au>
    
    It is possible to attach a virtual disk to a logical partition on an iSeries
    machine so that it is read only to the partition.  This patch allows Linux to
    use such virtual disks.

commit 2c3956c90ecaa7faa8d35a388c7246e83241efc8
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 14 05:56:19 2004 -0700

    [PATCH] ppc64: strengthen I/O and memory barriers
    
    From: Paul Mackerras <paulus@samba.org>
    
    After I sent the recent patch to include/asm-ppc64/io.h which put stronger
    barriers in the I/O accessor macros, Paul McKenney pointed out to me that a
    writex/outx could still slide out from inside a spinlocked region.  This patch
    makes the barriers a bit stronger so that this can't happen.  It means that we
    need to use a sync instruction for wmb (a full "heavyweight" sync), since
    drivers rely on wmb for ordering between writes to system memory and writes to
    a device.
    
    I have left smb_wmb() as a lighter-weight barrier that orders stores, and
    doesn't impose an ordering between cacheable and non-cacheable accesses (the
    amusingly-named eieio instruction).  I am assuming here that smp_wmb is only
    used for ordering stores to system memory so that another cpu will see them in
    order.  It can't be used for enforcing any ordering that a device will see,
    because it is just a gcc barrier on UP.
    
    This also changes the spinlock/rwlock unlock code to use lwsync ("light-weight
    sync") rather than eieio, since eieio doesn't order loads, and we need to
    ensure that loads stay inside the spinlocked region.

commit 24f5976029b06f45e249ba4b8e3eb400d8454385
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 14 05:56:08 2004 -0700

    [PATCH] ppc64: Kconfig bits for CONFIG_SPINLINE
    
    From: Paul Mackerras <paulus@samba.org>
    
    When I sent the patch to uninline the spinlocks, I inadvertently left out
    the change to arch/ppc64/Kconfig which defines the config symbol for
    inlining the locks (CONFIG_SPINLINE now).  This patch adds it.  It also
    adds a symbol CONFIG_PPC_SPLPAR which enables the code for calling the
    hypervisor on shared-processor logically-partitioned system to yield the
    physical processor to the lock holder when spinning.  (The code that
    depends on this symbol is already present in arch/ppc64/lib/locks.c.)

commit b2590fb049a319a2d7e7f6475997862430d68f9c
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 14 05:55:58 2004 -0700

    [PATCH] ppc64: remove iseries interrupt recursion workaround
    
    From: Anton Blanchard <anton@samba.org>
    
    It turns out we do avoid irq recursion on iseries so remove the workaround.

commit f1061519866eae37331b4cc759df6e142f2666dd
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 14 05:55:47 2004 -0700

    [PATCH] ppc64: NVRAM fixes
    
    From: Anton Blanchard <anton@samba.org>
    
    We check nvram_fetch/nvram_store against -1, so better not make these
    unsigned.

commit 9d0eb0abb52e21a4a3e2c8e4ddf087f54b0a6845
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 14 05:55:37 2004 -0700

    [PATCH] ppc64: align some heavily used variables
    
    From: Anton Blanchard <anton@samba.org>
    
    Based on feedback from the hardware guys align jiffies and tb_last_stamp.
    We update both regularly and there are other read only, heavily accessed
    things that share those cachelines.

commit 349f2cf4c84c9cd48f8015d7d07cdf2446511ec4
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 14 05:55:26 2004 -0700

    [PATCH] ppc64: set MSR_RI in iseries exception code
    
    From: Anton Blanchard <anton@samba.org>
    
    We need to set MSR_RI in iseries exception prolog.

commit 554a2bbe874f643eb3e56acffccc9edea95b08f1
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 14 05:55:15 2004 -0700

    [PATCH] ppc64: fix radix tree allocation under spinlock
    
    From: Anton Blanchard <anton@samba.org>
    
    We were allocating radix tree nodes in the interrupt code with GFP_KERNEL
    under a spinlock.  Change it to GFP_ATOMIC.

commit bb2a045977ecae954276cbf75307ef8a13b5ed62
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 14 05:55:05 2004 -0700

    [PATCH] ppc32: Move declarations into headers
    
    From: Paul Mackerras <paulus@samba.org>
    
    The patch below moves some declarations from C files into the appropriate
    header file in include/asm-ppc (and removes an unused local variable in a
    function).

commit c13dbf345d9e645447a8986f0db2a8e0c8a3d240
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 14 05:54:54 2004 -0700

    [PATCH] ppc32: Fix pmac compile after OCP changes
    
    From: Paul Mackerras <paulus@samba.org>
    
    Matt Porter's recent changes broke the compile for non-4xx ppc32 systems,
    unfortunately.  I get an error that mfdcr is not defined in
    include/asm-ppc/ocp.h when compiling for powermac (reasonable, since the
    mfdcr instruction only exists on 4xx processors).  The patch below fixes
    it.

commit c1da7a145595bd6d260770105be24e133bb9a555
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 14 05:54:43 2004 -0700

    [PATCH] PPC32: PPC44x ports for new OCP
    
    From: Matt Porter <mporter@kernel.crashing.org>
    
    Merge all current PPC44x ports against new OCP.

commit a355c17b3f5f892f7fba77c4cd8933b11ff9f236
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 14 05:54:32 2004 -0700

    [PATCH] PPC32: PPC40x ports for new OCP
    
    From: Matt Porter <mporter@kernel.crashing.org>
    
    Merge all current PPC40x ports against new OCP.

commit d63538d4227be34ca6f7890d29312f949884d28c
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 14 05:54:21 2004 -0700

    [PATCH] PPC32: Update 4xx defconfigs
    
    From: Matt Porter <mporter@kernel.crashing.org>
    
    Update all current 4xx defconfigs for new OCP.

commit c60390957081678fba2e23f1119d6014e0af6685
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 14 05:54:10 2004 -0700

    [PATCH] PPC32: 4xx core fixes and 440gx PIC support
    
    From: Matt Porter <mporter@kernel.crashing.org>
    
    Merge misc.  4xx core fixes and support for the new cascade scheme in the
    440gx.

commit 8c8b5d2213894e0a544a7404b66f9f224c0e01a1
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 14 05:53:59 2004 -0700

    [PATCH] PPC32: IBM PPC4xx-specific OCP support
    
    From: Matt Porter <mporter@kernel.crashing.org>
    
    Merge PPC4xx-specific OCP support for new OCP core.

commit 3ce4aa1bcaff5cb0355a12c228bce44c83d88cf7
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 14 05:53:48 2004 -0700

    [PATCH] PPC32: PPC44x lib support
    
    From: Matt Porter <mporter@kernel.crashing.org>
    
    Merge PPC44x library support against new OCP.

commit 558e7b25c56a61ecb8607fdb99d079b56976ff49
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 14 05:53:37 2004 -0700

    [PATCH] PPC32: Bubinga/405EP for new OCP
    
    From: Matt Porter <mporter@kernel.crashing.org>
    
    Merge Bubinga/405EP support against new OCP.

commit c907be958628c58aef1ccb2b8fb09e2e6e913802
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 14 05:53:26 2004 -0700

    [PATCH] PPC32: New OCP core support (updated)
    
    From: Matt Porter <mporter@kernel.crashing.org>
    
    New OCP infrastructure ported from 2.4 along with several enhancements.
    Updated patch with comments from hch and Valdis.

commit 120cf52feba9ca1b70dfeb8b392f5d679b793a74
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 14 05:52:43 2004 -0700

    [PATCH] PPC32: Add Book E / PPC44x specific exception support
    
    From: Matt Porter <mporter@kernel.crashing.org>
    
    Adds general Book E machine check exception support and PPC44x-specific
    machine check exception implementation.

commit 47d83679ef951e5a15fdcdcf5b1bb6b8c0cc3a89
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 14 05:52:31 2004 -0700

    [PATCH] PPC32: Add Book E / PPC44x specific exception support
    
    From: Matt Porter <mporter@kernel.crashing.org>
    
    Adds general Book E debug exception support and PPC44x-specific debug
    exception implementation.

commit 1c4a7135b27fa2a7040113da007e4d3a3342c24b
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 14 05:52:21 2004 -0700

    [PATCH] PPC32: Fix copy prefetch on non coherent PPCs
    
    From: Matt Porter <mporter@kernel.crashing.org>
    
    This patch fixes the condition where prefetching cache lines beyond a
    buffer can cause data corruption on non cache coherent PPCs.  It is a port
    of the version that went into 2.4.  From Eugene Surovegin
    <ebs@ebshome.net>.

commit 4bab667f2ae876708dd91bbe67285be9d19a3397
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 14 05:52:10 2004 -0700

    [PATCH] PPC32: Fix __flush_dcache_icache_phys() for Book E
    
    From: Matt Porter <mporter@kernel.crashing.org>
    
    This patch implements/uses __flush_dcache_icache_page() which kmaps on a
    Book E part, but keeps the existing behavior on other PowerPCs which can
    disable the MMU.

commit 239adc580e45a49f1bfc5b2a4ac46acc234a791f
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 14 05:51:59 2004 -0700

    [PATCH] export clear_pages on ppc32
    
    From: Olaf Hering <olh@suse.de>
    
    ext3 as module is not possible in 2.6.6, clear_pages, called from clear_page,
    is not exported.
    
    Also, unexport clear_page(), which is an inline.

commit a710c38708bb25f4c6a3fac9cfa0df6a6a04ff73
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 14 05:51:48 2004 -0700

    [PATCH] befs: inode->i_flags thinko fix
    
    Jorn Engel <joern@wohnheim.fh-wedel.de>
    
    inode->i_flags should never contain fs-specific flags.  In fact, it doesn't;
    the checks against it cause "chattr +T" to be useless for ext[23].  Same bug
    was in befs as well.

commit c6204bb4531221b9ce54fe29e0a84d87f10c58e6
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 14 05:51:37 2004 -0700

    [PATCH] befs: maintainer update
    
    From: "Sergey S. Kostyliov" <rathamahata@php4.ru>
    
    Acked by Will Dyson.

commit 8a64f0cb5fed1320ca2b4dbb163b3c2d86ab7f57
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 14 05:51:27 2004 -0700

    [PATCH] befs: debugging code cleanup
    
    From: "Sergey S. Kostyliov" <rathamahata@php4.ru>
    
    - Reduce stack usage.
    - Kill useless duplication of error and warning messages when debug is on. Old
    	behaviour was:
    ...
    BeFS(hda1):

commit 50f7b6fdba7b1d20cebc622241c656de9c060997
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 14 05:51:16 2004 -0700

    [PATCH] befs: typo fix
    
    From: "Sergey S. Kostyliov" <rathamahata@php4.ru>
    
    Fix really old typo in config help

commit d22b1c8dabc2e615ae5c76ac44b65bf45c7f9fa8
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 14 05:51:06 2004 -0700

    [PATCH] befs: binary search microoptimisation
    
    From: "Sergey S. Kostyliov" <rathamahata@php4.ru>
    
    Move value initialisation out of the loop body.

commit 4286d673bef6f3d2537bfae2e8bffbc468ad8ed0
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 14 05:50:55 2004 -0700

    [PATCH] befs: microoptimisation, use befs_bread() instead of befs_bread_iaddr()
    
    From: "Sergey S. Kostyliov" <rathamahata@php4.ru>
    
    We already have block number (inode->i_ino), so there is no need to calculate
    it from befs_block_run before sb_bread() call (this is what befs_bread_iaddr()
    do).

commit 3e9e5d09b1e89ad4bed84788e51c92c24173b761
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 14 05:50:44 2004 -0700

    [PATCH] befs: LBD support
    
    From: "Sergey S. Kostyliov" <rathamahata@php4.ru>
    
    LBD patch merged long time ago, so it is safe to pass u64 block numbers to
    sb_bread() when sector_t is large enough.

commit 7747d41ea6ed94eca5a83dfc12e1d1e3a7550521
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 14 05:50:33 2004 -0700

    [PATCH] s390: network driver
    
    From: Martin Schwidefsky <schwidefsky@de.ibm.com>
    
    Network driver changes:
     - lcs: Add missing irb error checking.
     - lcs: Fix multicasting.
     - lcs: Use a seperate lock (ipm_lock) for multicast list.
     - lcs: Add missing in_dev_put in multicase address list handling.
     - iucv: Set static variables to NULL after kfree.
     - iucv: Do bus_unregister if module initialization fails.
     - netiucv: Convert iucvMagic to EBCDIC in con_action_start.
     - netiucv: Remove administration of ifno-stuff for device name,
     - netiucv: Add attribute to remove a netiucv device.
     - qeth: Add version string that is displayed at driver load time.
     - qeth: Fix memory leak in qeth_arp_query.
     - qeth: Remove duplicate case statements in qeth_do_ioctl.
     - qeth: Fix OSA broadcast filtering.
     - qeth: Increase timeout for purge ARP cache IPA.
     - qeth: Fix hsi device naming.
     - qeth: Add do_QDIO count to qeth performance statistics.
     - qeth: Allow writing to IP address takeover attribute only in
             state DOWN or RECOVER.
     - qeth: Fix hang when removing a vlan device.
     - qeth: Cleanup error messages for ARP commands.
     - qeth: Return EOPNOTSUPP for purge ARP on HiperSockets.
     - qeth: Drop skbs if the net_device of a qeth device is down.
     - qeth: Simplify ip address list processing.

commit a7a533926779438ad83cef66950137d3c7b3e998
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 14 05:50:22 2004 -0700

    [PATCH] s390: zfcp host adapter
    
    From: Martin Schwidefsky <schwidefsky@de.ibm.com>
    
    zfcp host adapter change:
     - Prevent infinite retry of SCSI commands when FCP adapter is unavailable.
     - Always queue error recovery structure to the error recovery running list.
     - Add help text to zfcp config option.

commit b42e64d442a44bbabe83f52576266090e325cc55
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 14 05:50:11 2004 -0700

    [PATCH] s390: 3270 console driver
    
    From: Martin Schwidefsky <schwidefsky@de.ibm.com>
    
    3270 device driver change:
     - Don't allow activation of views while the initial size sensing is still
       in progress. Replace RAW3270_FLAGS_SHUTDOWN with RAW3270_FLAGS_READY.
     - Make 3270 views loadable as modules.

commit c6b04cd09f3926515603be37b7aa62c73fe30201
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 14 05:50:00 2004 -0700

    [PATCH] s390: dasd driver
    
    From: Martin Schwidefsky <schwidefsky@de.ibm.com>
    
    dasd driver changes:
     - Do error recovery for error recovery requests.
     - Retry request if the start_IO failed because of a timeout.

commit 6019886d87b7d06325d82d6ab587990df2745085
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 14 05:49:49 2004 -0700

    [PATCH] s390: common i/o layer
    
    From: Martin Schwidefsky <schwidefsky@de.ibm.com>
    
    Common i/o layer changes:
     - Delay unregister/register of ccw devices reappering on a different
       subchannel. Search for the old ccw_device & subchannel for the
       reattached device and deregister it too to avoid inconsistencies.
     - Fix path grouping for devices that present command reject for
       SetPGID but not for SensePGID.

commit 9cb51c16101578dfa7399833c0282126c50fafc9
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 14 05:49:38 2004 -0700

    [PATCH] s390: core
    
    From: Martin Schwidefsky <schwidefsky@de.ibm.com>
    
    s390 core changes:
     - Rename idle_cpu_mask to nohz_cpu_mask as agreed with Dipankar.
     - Refine compiler version check for "Q" constraints in uaccess.h.
     - Store per process ptrace information to the correct place.
     - Fix per cpu data access for 64-bit modules.
     - Add topology_init function for cpu hotplug.
     - Define TASK_SIZE dependent on TIF_31BIT and define MM_VM_SIZE
       to 4TB to get rid of elf_map32 and arch_get_unmapped_area.

commit 1b9407d76c0cb2e46ae7abc53de35fa91626bd7d
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 14 05:49:27 2004 -0700

    [PATCH] Add del_single_shot_timer()
    
    From: Geoff Gustafson <geoff@linux.jf.intel.com>,
          "Chen, Kenneth W" <kenneth.w.chen@intel.com>,
          Ingo Molnar <mingo@elte.hu>,
          me.
    
    The big-SMP guys are seeing high CPU load due to del_timer_sync()'s
    inefficiencies.  The callers are fs/aio.c and schedule_timeout().
    
    We note that neither of these callers' timer handlers actually re-add the
    timer - they are single-shot.
    
    So we don't need all that complexity in del_timer_sync() - we can just run
    del_timer() and if that worked we know the timer is dead.
    
    Add del_single_shot_timer(), export it to modules and use it in AIO and
    schedule_timeout().
    
    
    (these numbers are for an earlier patch, but they'll be close)
    
    Before:             32p     4p
         Warm cache   29,000    505
         Cold cache   37,800   1220
    
    After:              32p     4p
         Warm cache       95     88
         Cold cache    1,800    140
    
    [Measurements are CPU cycles spent in a call to del_timer_sync, the average
    of 1000 calls. 32p is 16-node NUMA, 4p is SMP.]
    
    (I cleaned up a few things and added some commentary)

commit 496dc9b420ac2db0e639aca9b668de2a695d3277
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 14 05:49:16 2004 -0700

    [PATCH] H8/300: more cleanup
    
    From: Yoshinori Sato <ysato@users.sourceforge.jp>
    
    - gcc-3.4 warning fix.
    - io access address fix.
    - cleanup code.

commit b942a8855ff36b1b34c15a89f9a7d5e048052ff8
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 14 05:49:05 2004 -0700

    [PATCH] H8/300: delete headers
    
    From: Yoshinori Sato <ysato@users.sourceforge.jp>
    
    - Delete obsolete header files

commit d3ab913e9289b305a46c2ac48c7097aaf0f9b493
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 14 05:48:53 2004 -0700

    [PATCH] H8/300: Kconfig
    
    From: Yoshinori Sato <ysato@users.sourceforge.jp>
    
    - Separate taget depends config.

commit 5cabf638439378c5359d6ad926f3bf59c5b95ec9
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 14 05:48:42 2004 -0700

    [PATCH] H8/300: ne driver
    
    From: Yoshinori Sato <ysato@users.sourceforge.jp>
    
    - ne2k compatible NIC support

commit 58cdd45bcc36d13ecb1ed24ae1abeda5e38db7b6
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 14 05:48:31 2004 -0700

    [PATCH] H8/300: SCI driver fix
    
    From: Yoshinori Sato <ysato@users.sourceforge.jp>
    
    - fix h8300 depend setup sequence

commit caeb59c8c042c019e761da3733110001f04d388d
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 14 05:48:20 2004 -0700

    [PATCH] H8/300: preempt support
    
    From: Yoshinori Sato <ysato@users.sourceforge.jp>
    
    - add preempt support
    - add new syscalls
    - code cleanup

commit 906355ca26698195c4a6f543ab78e461d078d437
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 14 05:48:09 2004 -0700

    [PATCH] H/8300 pic support fix
    
    From: Yoshinori Sato <ysato@users.sourceforge.jp>
    
    Sorry. There was the file which lacked.

commit ebd99675d52a5eab65c4cc71ecccb67b37f821f6
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 14 05:47:58 2004 -0700

    [PATCH] H8/300: pic support
    
    From: Yoshinori Sato <ysato@users.sourceforge.jp>
    
    - add PIC binary support

commit e51c5d04b91492feb79c6b3f606d237ef2e0b1d4
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 14 05:47:47 2004 -0700

    [PATCH] H8/300: ldscripts fix
    
    From: Yoshinori Sato <ysato@users.sourceforge.jp>
    
    - symbol prefix (use h8300 and v850) support
    - include headers

commit dd2deeb9acbdc5141cda24906fcf7a45b333e144
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 14 05:47:36 2004 -0700

    [PATCH] H8/300: bitops.h add find_next_bit
    
    From: Yoshinori Sato <ysato@users.sourceforge.jp>
    
    - add find_next_bit

commit 35181da9667ae831f72c905a6691f82d999c56a6
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 14 05:47:27 2004 -0700

    [PATCH] dentry layout tweaks
    
    Lookup typically touches three fields of the dentry: d_bucket, d_name.hash and
    d_parent.
    
    Change the layout of things so that these will always be in the same
    cacheline.

commit 66ca0978354be3c2f6977c577fb47c96d98e4d7b
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 14 05:47:16 2004 -0700

    [PATCH] more dentry shrinkage
    
    - d_vfs_flags can be removed - just use d_flags.  All modifications of
      dentry->d_flags are under dentry->d_lock.
    
    On x86 this takes the internal string size up to 40 bytes.  The
    internal/external ratio on my 1.5M files hits 96%.

commit b7b5563e74bbeff253ea454ff301fa6e6712a84c
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 14 05:47:06 2004 -0700

    [PATCH] dentry d_bucket fix
    
    The gap between checking d_bucket and sampling d_move_count looks like a bug
    to me.
    
    It feels safer to be checking d_bucket after taking the lock, when we know
    that it is stable.
    
    And it's a little faster to check d_bucket after having checked the hash
    rather than before.

commit 90b163a4b5dd909f8a6f9c61c5bdce17130350a0
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 14 05:46:55 2004 -0700

    [PATCH] dentry qstr consolidation
    
    When dentries are given an external name we currently allocate an entire qstr
    for the external name.
    
    This isn't needed.  We can use the internal qstr and kmalloc only the string
    itself.  This saves 12 bytes from externally-allocated names and 4 bytes from
    the dentry itself.
    
    The saving of 4 bytes from the dentry doesn't actually decrease the dentry's
    storage requirements, but it makes four more bytes available for internal
    names, taking the internal/external ratio from 89% up to 93% on my 1.5M files.
    
    
    Fix:
    
    The qstr consolidation wasn't quite right, because it can cause qstr->len to
    be unstable during lookup lockless traverasl.
    
    Fix that up by taking d_lock earlier in lookup.  This serialises against
    d_move.
    
    Take the lock after comparing the parent and hash to preserve the
    mostly-lockless behaviour.
    
    This obsoletes d_movecount, which is removed.

commit fd2d876083bf90ce4f569542d78166387937e0bf
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 14 05:46:44 2004 -0700

    [PATCH] dentry shrinkage
    
    Rework dentries so that the inline name length is between 31 and 48 bytes.
    
    On SMP P4-compiled x86 each dentry consumes 160 bytes (24 per page).
    
    Here's the histogram of name lengths on all 1.5M files on my workstation:
    
    1:  0%
    2:  0%
    3:  1%
    4:  5%
    5:  8%
    6:  13%
    7:  19%
    8:  26%
    9:  33%
    10:  42%
    11:  49%
    12:  55%
    13:  60%
    14:  64%
    15:  67%
    16:  69%
    17:  71%
    18:  73%
    19:  75%
    20:  76%
    21:  78%
    22:  79%
    23:  80%
    24:  81%
    25:  82%
    26:  83%
    27:  85%
    28:  86%
    29:  87%
    30:  88%
    31:  89%
    32:  90%
    33:  91%
    34:  92%
    35:  93%
    36:  94%
    37:  95%
    38:  96%
    39:  96%
    40:  96%
    41:  96%
    42:  96%
    43:  96%
    44:  97%
    45:  97%
    46:  97%
    47:  97%
    48:  97%
    49:  98%
    50:  98%
    51:  98%
    52:  98%
    53:  98%
    54:  98%
    55:  98%
    56:  98%
    57:  98%
    58:  98%
    59:  98%
    60:  99%
    61:  99%
    62:  99%
    63:  99%
    64:  99%
    
    So on x86 we'll fit 89% of filenames into the inline name.
    
    
    The patch also removes the NAME_ALLOC_LEN() rounding-up of the storage for the
    out-of-line names.  That seems unnecessary.

commit 75fb13cdbd050bf9a14e72d2d3dccdf17e1060ff
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 14 05:46:33 2004 -0700

    [PATCH] d_vfs_flags locking fix
    
    Be consistent about d_vfs_flags locking: take dentry->d_lock when modifying
    it.

commit 87ada13e2b7019718df58591ea4767591b9af68a
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 14 05:46:23 2004 -0700

    [PATCH] d_flags locking fixes
    
    A few filesystems modify dentry.d_flags under non-obvious locking.  To
    consolidate that field wth d_vfs_flags they need to take ->d_lock

commit 12102e4ed23209b6f6b02480a68ef711ed5fe702
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 14 05:46:12 2004 -0700

    [PATCH] I2O subsystem fixing and cleanup for 2.6 - i2o-makefile-cleanup.patch
    
    From: Markus Lidel <Markus.Lidel@shadowconnect.com>
    
    * The Kconfig and Makefile in drivers/message/i2o still got a CONFIG_I2O_PCI
      entry, which is not used anymore.  This one is replaced by a
      CONFIG_I2O_CONFIG entry, which now builds the i2o_config module.

commit 7c11ccc5f5a7f71f2832c03f8c7fcbc9ee82a7de
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 14 05:46:01 2004 -0700

    [PATCH] I2O subsystem fixing and cleanup for 2.6 - i2o-64-bit-fix.patch
    
    From: Markus Lidel <Markus.Lidel@shadowconnect.com>
    
    * provides i2o_context_list_*() functions, which maps 64-bit pointers to
      32-bit context id's in a dynamic list.  On 32-bit systems the functions are
      replaced with a static inline.
    
    * i2o_scsi now uses the i2o_context_list_*() functions for transaction
      context, and therefore now work on 64-bit systems too.

commit 96005e5a21afaa7aa63f0a08333587f865b89948
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 14 05:45:50 2004 -0700

    [PATCH] I2O subsystem fixing and cleanup for 2.6 - i2o_block-cleanup.patch
    
    From: Markus Lidel <Markus.Lidel@shadowconnect.com>
    
    * more than 3 "visible" disks (hda, hdb, hdc, hdd) lead to kernel panics.
    
    * removes some unused code with partitions.
    
    * I2O_LOCK was often called with the addresses of the controller, and not
      with the address of the device.  Fixed.
    
    * the cleanup function for gendisk (del_gendisk) doesn't work if the queue
      is shared between different devices.  To workaround the queue is removed
      before.
    
    * redundant code removed in module initialization and remove, use
      i2ob_new_device and i2ob_del_device instead.
    
    * removed atomic_t queue_depth
    
    * removed unnecessary and bogus code for queue handling

commit a94a0bb40e72a82860e72815051da1588c60c050
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 14 05:45:39 2004 -0700

    [PATCH] i2o: 64-bit fixes
    
    From: Markus Lidel <Markus.Lidel@shadowconnect.com>
    
    Fix 64-bit problems.

commit 8c95df95bf083b59e846c12403360971865bf673
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 14 05:45:29 2004 -0700

    [PATCH] I2O subsystem fixing and cleanup for 2.6 - i2o-passthru.patch
    
    From: Markus Lidel <Markus.Lidel@shadowconnect.com>
    
    * Add a pass-thru ioctl to i2o_config, which is needed to work with the
      Adaptec management software.

commit 9bf41bd3740cc7f5a99e074ebe4b640d769cd0da
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 14 05:45:18 2004 -0700

    [PATCH] I2O subsystem fixing and cleanup for 2.6 - i2o-config-clean.patch
    
    From: Markus Lidel <Markus.Lidel@shadowconnect.com>
    
    * Changes the formating of the header in i2o_config.c

commit 5770ced918468d627595003a9a3bb0421cb0cfbc
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 14 05:45:07 2004 -0700

    [PATCH] Module ref counting for vt console drivers
    
    From: Herbert Xu <herbert@gondor.apana.org.au>
    
    The following patch adds basic module reference counting to vt console
    drivers.  Currently modules like fbcon are not counted at all.

commit f887808c36bffedcbccd49a199e2c477a0d81005
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 14 05:44:57 2004 -0700

    [PATCH] ia64 cpu hotplug: core
    
    From: Ashok Raj <ashok.raj@intel.com>
    
    Supports basic ability to enable hotplug functions for IA64.
    Code is just evolving, and there are several loose ends to tie up.
    
    What this code drop does
    - Support logical online and offline
    - Handles interrupt migration without loss of interrupts.
    - Handles stress fine > 24+ hrs with make -j/ftp/rcp workloads
    - Handles irq migration from a dying cpu without loss of interrupts.
    
    What needs to be done
    - Boot CPU removal support, with platform level authentication
    - Putting cpu being removed in BOOT_RENDEZ mode.

commit fda94eff9b081a5e498d7d9aabf7d418f5249b0d
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 14 05:44:45 2004 -0700

    [PATCH] Revisited: ia64-cpu-hotplug-cpu_present.patch
    
    From: Paul Jackson <pj@sgi.com>
    
    With a hotplug capable kernel, there is a requirement to distinguish a
    possible CPU from one actually present.  The set of possible CPU numbers
    doesn't change during a single system boot, but the set of present CPUs
    changes as CPUs are physically inserted into or removed from a system.  The
    cpu_possible_map does not change once initialized at boot, but the
    cpu_present_map changes dynamically as CPUs are inserted or removed.
    
    
    Paul Jackson <pj@sgi.com> provided an expanded explanation:
    
    
    Ashok's cpu hot plug patch adds a cpu_present_map, resulting in the following
    cpu maps being available.  All the following maps are fixed size bitmaps of
    size NR_CPUS.
    
    #ifdef CONFIG_HOTPLUG_CPU
    	cpu_possible_map - map with all NR_CPUS bits set
    	cpu_present_map - map with bit 'cpu' set iff cpu is populated
    	cpu_online_map - map with bit 'cpu' set iff cpu available to scheduler
    #else
    	cpu_possible_map - map with bit 'cpu' set iff cpu is populated
    	cpu_present_map - copy of cpu_possible_map
    	cpu_online_map - map with bit 'cpu' set iff cpu available to scheduler
    #endif
    
    In either case, NR_CPUS is fixed at compile time, as the static size of these
    bitmaps.  The cpu_possible_map is fixed at boot time, as the set of CPU id's
    that it is possible might ever be plugged in at anytime during the life of
    that system boot.  The cpu_present_map is dynamic(*), representing which CPUs
    are currently plugged in.  And cpu_online_map is the dynamic subset of
    cpu_present_map, indicating those CPUs available for scheduling.
    
    If HOTPLUG is enabled, then cpu_possible_map is forced to have all NR_CPUS
    bits set, otherwise it is just the set of CPUs that ACPI reports present at
    boot.
    
    If HOTPLUG is enabled, then cpu_present_map varies dynamically, depending on
    what ACPI reports as currently plugged in, otherwise cpu_present_map is just a
    copy of cpu_possible_map.
    
    (*) Well, cpu_present_map is dynamic in the hotplug case.  If not hotplug,
        it's the same as cpu_possible_map, hence fixed at boot.

commit 4af52c2390574f7cb34cbf04a159238ee2c873fe
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 14 05:44:34 2004 -0700

    [PATCH] ia64 cpu hotplug: /proc rework
    
    From: Ashok Raj <ashok.raj@intel.com>
    
    Changes proc entries for cpu hotplug to be created via the cpu hotplug
    notifier callbacks.  Also fixed a bug in the removal code that did not remove
    proc entries as expected.

commit f53c027a8434bcb1299888048bfc24fb31a896b6
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 14 05:44:23 2004 -0700

    [PATCH] ia64 cpu hotplug: IRQ affinity work
    
    From: Ashok Raj <ashok.raj@intel.com>
    
    irq affinity setting via /proc was forcing iosapic rte programming by force.
    The correct way to do this is to perform this when a interrupt is pending.

commit 68a50f57a1a9b27886ea3f5d29055ee36e98bd82
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 14 05:44:13 2004 -0700

    [PATCH] ia64 cpu hotplug: sysfs additions
    
    From: Ashok Raj <ashok.raj@intel.com>
    
    Creation of sysfs via topology_init() creates sysfs entries.  The creation of
    the online control file is created separately when the cpu_up is invoked in
    arch independent code.

commit c4dff897f16d94b3e14f9952269d8103edb0b31a
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 14 05:44:02 2004 -0700

    [PATCH] ia64 cpu hotplug: init section fixes
    
    From: Ashok Raj <ashok.raj@intel.com>
    
    Contains changes from __init to __devinit to support cpu hotplug Changes only
    arch/ia64 portions of the kernel tree.

commit 8fe084449efe98c1f36cd308fb9b5be5dff8c7a5
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 14 05:43:50 2004 -0700

    [PATCH] ia64 cpu hotplug: core kernel initialisation
    
    From: Ashok Raj <ashok.raj@intel.com>
    
    This patch changes __init to __devinit to init_idle so that when a new cpu
    arrives, it can call these functions at a later time.

commit 2e27bd98812fd2f07999574564bd8ce7ddfb4b9e
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 14 05:43:39 2004 -0700

    [PATCH] swap speedups and fix
    
    From: Andrea Arcangeli <andrea@suse.de>
    
    I don't think we need an install_swap_bdev/remove_swap_bdev anymore, we should
    use the swap_info->bdev, not the swap_bdevs.  the swap_info already has a
    ->bdev field, the only point of remove_swap_bdev/install_swap_bdev was to
    unplug all devices as efficiently as possible, we don't need that anymore with
    the page parameter.
    
    Plus the semaphore should be a rwsem to allow parallel unplug from multiple
    pages.
    
    After that I don't need to take the semaphore anymore during swapon, no
    swapcache with swp_type() pointing to such bdev, will be allowed until swapon
    is complete (SWP_ACTIVE is set a lot later after setting p->bdev).
    
    In swapoff I only need a dummy serialization with the readers, after
    try_to_unuse is complete:
    
     	err = try_to_unuse(type);
     	current->flags &= ~PF_SWAPOFF;
    
     	/* wait for any unplug function to finish */
     	down_write(&swap_unplug_sem);
     	up_write(&swap_unplug_sem);
    
    
    that's all, no other locking and no install_swap_bdev/remove_swap_bdev.
    
    (and the swap_bdevs[] compression code was busted)

commit 4e36c1187923a30df09227412a64636cf5dea634
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 14 05:43:29 2004 -0700

    [PATCH] blk_run_page(): we don't trust bh->b_page
    
    We don't trust bh->b_page to point to the right thing across all filesystems,
    so revert this bit.

commit 3a1e4697cbfc3db774d3d29b80d5ef588cfe1d2e
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 14 05:43:18 2004 -0700

    [PATCH] blk_run_page(): fixup for swap_unplug_io_fn()

commit e059d5daf158b1bde61883ee5a091cd4875864a9
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 14 05:43:07 2004 -0700

    [PATCH] Add blk_run_page()
    
    From: Andrea Arcangeli <andrea@suse.de>
    
    From: Jens Axboe
    
    Add blk_run_page() API.  This is so that we can pass the target page all the
    way down to (for example) the swap unplug function.  So swap can work out
    which blockdevs back this particular page.

commit 485ba3c3b6da6ca02daee0f961fe70beaebd32b3
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 14 05:42:56 2004 -0700

    [PATCH] rmap-5-swap_unplug-page-revert
    
    Revert the pre-2.6.6 per-address-space unplugging changes.  This removes a
    swapper_space exceptionality, syncs things with Andrea and provides for
    simplification of the swap unplug function.

commit c78a6f265684bbe76a03d45666b8b6dee4952045
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 14 05:42:45 2004 -0700

    [PATCH] rename rmap_lock to page_map_lock
    
    Sync this up with Andrea's patches.

commit 70d1f017811daab3cdf75d69fa1e37b1a08f4bb8
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 14 05:42:34 2004 -0700

    [PATCH] filtered wakeups: apply to buffer_head functions
    
    From: William Lee Irwin III <wli@holomorphy.com>
    
    This patch implements wake-one semantics for buffer_head wakeups in a single
    step.  The buffer_head being waited on is passed to the waiter's wakeup
    function by the waker, and the wakeup function compares that to the a pointer
    stored in its on-stack structure and checking the readiness of the bit there
    also.  Wake-one semantics are achieved by using WQ_FLAG_EXCLUSIVE in the
    codepaths waiting to acquire the bit for mutual exclusion.

commit 08aaf1cc54e61c4357828f7d029f9446144d0cc7
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 14 05:42:25 2004 -0700

    [PATCH] filtered wakeups: apply to pagecache functions
    
    From: William Lee Irwin III <wli@holomorphy.com>
    
    This patch implements wake-one semantics for page wakeups in a single step.
    Discrimination between distinct pages is achieved by passing the page to the
    wakeup function, which compares it to a pointer in its own on-stack structure
    containing the waitqueue element and the page.  Bit discrimination is achieved
    by storing the bit number in that same structure and testing the bit in the
    wakeup function.  Wake-one semantics are achieved by using WQ_FLAG_EXCLUSIVE
    in the codepaths waiting to acquire the bit for mutual exclusion.

commit 2afafa3b9804e7a8a515c528270121c5349dbf53
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 14 05:42:14 2004 -0700

    [PATCH] filtered wakeups: wakeup enhancements
    
    From: William Lee Irwin III <wli@holomorphy.com>
    
    This patch provides an additional argument to __wake_up_common() so that the
    information wakefunc.patch made waiters ready to receive may be passed to them
    by wakers.  This is provided as a separate patch so that the overhead of the
    additional argument to __wake_up_common() can be measured in isolation.  No
    change in performance was observable here.

commit 2f24285400352ec3b832db6de3644241ee7c2c84
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 14 05:42:03 2004 -0700

    [PATCH] filtered wakeups
    
    From: William Lee Irwin III <wli@holomorphy.com>
    
    This patch series is solving the "thundering herd" problem that occurs in the
    mainline implementation of hashed waitqueues.  There are two sources of
    spurious wakeups in such arrangements:
    
    (a) Hash collisions that place waiters on different objects on the same
        waitqueue, which wakes threads falsely when any of the objects hashed to
        the same queue receives a wakeup.  i.e.  loss of information about which
        object a wakeup event is related to.
    
    (b) Loss of information about which object a given waiter is waiting on.
        This precludes wake-one semantics for mutual exclusion scenarios.  For
        instance, a lock bit may be slept on.  If there are any waiters on the
        object, a lock bit release event must wake at least one of them so as to
        prevent deadlock.  But without information as to which waiter is waiting
        on which object, we must resort to waking all waiters who could possibly
        be waiting on it.  Now, as the lock bit provides mutual exclusion, only
        one of the waiters woken can proceed, and the remainder will go back to
        sleep and wait for another event, creating unnecessary system load.  Once
        wake-one semantics are established, only one of the waiters waiting to
        acquire a lock bit need to be woken, which measurably reduces system load
        and improves efficiency (i.e.  it's the subject of the benchmarking I've
        been sending to you).
    
    Even beyond the measurable efficiency gains, there are reasons of robustness
    and responsiveness to motivate addressing the issue of thundering herds.  In a
    real-life scenario I've been personally involved in resolving, the thundering
    herd issue caused powerful modern SMP machines with fast IO systems to be
    unresponsive to user input for a minute at a time or more.  Analogues of these
    patches for the distro kernels involved fully resolved the issue to the
    customer's satisfaction and obviated workarounds to limit the pagecache's
    size.
    
    The latest spin of these patches basically shoves more pieces of the logic
    into the wakeup functions, with some efficiency gains from sharing the hot
    codepath with the rest of the kernel, and a slightly larger diff than the
    patches with the newly-introduced entrypoint.  Writing these was motivated by
    the push to insulate sched.c from more of the details of wakeup semantics by
    putting more of the logic into the wakeup functions.  In order to accomplish
    this while still solving (b), the wakeup functions grew a new argument for
    communication about what object a wakeup event is related to to be passed by
    the waker.
    
    =========
    
    This patch provides an additional argument to wakeup functions so that
    information may be passed from the waker to the waiter.  This is provided as a
    separate patch so that the overhead of the additional argument can be measured
    in isolation.  No change in performance was observable here.

commit 5a930dd984fb23ea63c4ab18745b082f257d0718
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 14 05:41:52 2004 -0700

    [PATCH] do_mounts_rd-malloc-fix
    
    gcc-3.4.0 sez:
    
    init/do_mounts_rd.c:309: warning: conflicting types for built-in function 'malloc'

commit e46bdb8d9a7c3d3d70ec20a9a1057f29efd03f31
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 14 05:41:41 2004 -0700

    [PATCH] VM accounting fix
    
    From: Hugh Dickins <hugh@veritas.com>
    
    Stas Sergeev <stsp@aknet.ru> wrote:
    
       mprotect() fails to merge VMAs because one VMA can end up with
       VM_ACCOUNT flag set, and another without that flag.  That makes several
       apps of mine to malfuncate.
    
    
    Great find!  Someone has got their test the wrong way round.  Since that
    VM_MAYACCT macro is being used in one place only, and just hiding what it's
    actually about, fold it into its callsite.

commit 64525acc0e653d8295edcaa4332b79512483d92b
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 14 05:41:31 2004 -0700

    [PATCH] revert the process-migration-speedup patch
    
    David Mosberger asked that this be backed out:
    
    "I do not believe that flushing the TLB before migration is be the right thing
    to do on ia64 machines which support global TLB purges (i.e., all but SGI's
    machines)."
    
    It was of huge benefit for the SGI machines, so work is ongoing.

commit 5975a1db0182b107ae5e2df9d8d54b29eb99c372
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 14 05:41:20 2004 -0700

    [PATCH] MSEC_TO_JIFFIES to msec_to_jiffies
    
    Switch all users of MSEC[S]_TO_JIFFIES and JIFFIES_TO_MSEC[S] over to use
    jiffies_to_msecs() and msecs_to_jiffies().  Withdraw MSECS_TO_JIFFIES() and
    JIFFIES_TO_MSECS() from the kernel API.

commit b3dafee7dc88ed3690474512919d053eb97a281f
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 14 05:41:08 2004 -0700

    [PATCH] Covert drivers to use msec_to_jiffies
    
    Remove various private implementations of msecs_to_jiffies() and
    jiffies_to_msecs().
    
    There are various uppercase versions which should be consolidated.

commit 5b59eadfbf215aa20885d06ce81f263df99cc009
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 14 05:40:57 2004 -0700

    [PATCH] MSEC_TO_JIFFIES consolidation
    
    From: Ingo Molnar <mingo@elte.hu>
    
    We have various different implementations of MSEC[S]_TO_JIFFIES and
    JIFFIES_TO_MSEC[S].  We recently had a compile-time clash in USB.
    
    Fix all that up.
    
    - The SCTP version was very inefficient.  Hopefully this version is accurate
      enough.
    
    - Optimise for the HZ=100 and HZ=1000 cases
    
    - This version does round-up, so sleep(9 milliseconds) works OK on 100HZ.
    
    - We still have lots of jiffies_to_msec and msec_to_jiffies implementations.
    
    From: William Lee Irwin III <wli@holomorphy.com>
    
      Optimize the cases where HZ is a divisor of 1000 or vice-versa in
      JIFFIES_TO_MSECS() and MSECS_TO_JIFFIES() by allowing the nonvanishing(!)
      integral ratios to appear as a parenthesized expressions eligible for
      constant folding optimizations.
    
    From: me
    
      Use typesafe inlines for the jiffies-to-millisecond conversion functions.
    
      This means that milliseconds officially takes the type `unsigned int'.
      All current callers seem to be OK with that.
    
      Drivers need to be fixed up to use this instead of their private versions.

commit 1b104df13b1e99ebaa10df9b88b79276b28ea804
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 14 05:40:46 2004 -0700

    [PATCH] sched: add missing local_irq_enable()
    
    From: Nick Piggin <nickpiggin@yahoo.com.au>
    
    this_rq_lock does a local_irq_disable, and sched_yield() needs to undo that.

commit f68e7a55b5e2baaff9f9ac3a7068c32dc8d30b03
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 14 05:40:34 2004 -0700

    [PATCH] Fix page double-freeing race
    
    This has been there for nearly two years.  See bugzilla #1403
    
    vmscan.c does, in two places:
    
    	spin_lock(zone->lru_lock)
    	page = lru_to_page(&zone->inactive_list);
    	if (page_count(page) == 0) {
    		/* erk, it's being freed by __page_cache_release() or
    		 * release_pages()
    		 */
    		put_it_back_on_the_lru();
    
    	} else {
    
    	--> window 1 <--
    
    		page_cache_get(page);
    		put_in_on_private_list();
    	}
    	spin_unlock(zone->lru_lock)
    
    	use_the_private_list();
    
    	page_cache_release(page);
    
    
    
    whereas __page_cache_release() and release_pages() do:
    
    	if (put_page_testzero(page)) {
    
    	--> window 2 <--
    
    		spin_lock(lru->lock);
    		if (page_count(page) == 0) {
    			remove_it_from_the_lru();
    			really_free_the_page()
    		}
    		spin_unlock(zone->lru_lock)
    	}
    
    
    The race occurs if the vmscan.c path sees page_count()==1 and then the
    page_cache_release() path happens in that few-instruction "window 1" before
    vmscan's page_cache_get().
    
    The page_cache_release() path does put_page_testzero(), which returns true.
    Then this CPU takes an interrupt...
    
    The vmscan.c path then does page_cache_get(), taking the refcount to one.
    Then it uses the page and does page_cache_release(), taking the refcount to
    zero and the page is really freed.
    
    Now, the CPU running page_cache_release() returns from the interrupt, takes
    the LRU lock, sees the page still has a refcount of zero and frees it again.
    Boom.
    
    
    The patch fixes this by closing "window 1".  We provide a
    "get_page_testone()" which grabs a ref on the page and returns true if the
    refcount was previously zero.  If that happens the vmscan.c code simply drops
    the page's refcount again and leaves the page on the LRU.
    
    All this happens under the zone->lru_lock, which is also taken by
    __page_cache_release() and release_pages(), so the vmscan code knows that the
    page has not been returned to the page allocator yet.
    
    
    In terms of implementation, the page counts are now offset by one: a free page
    has page->_count of -1.  This is so that we can use atomic_add_negative() and
    atomic_inc_and_test() to provide put_page_testzero() and get_page_testone().
    
    The macros hide all of this so the public interpretation of page_count() and
    set_page_count() remains unaltered.
    
    The compiler can usually constant-fold the offsetting of page->count.  This
    patch increases an x86 SMP kernel's text by 32 bytes.
    
    The patch renames page->count to page->_count to break callers who aren't
    using the macros.
    
    This patch requires that the architecture implement atomic_add_negative().  It
    is currently present on
    
    	arm
    	arm26
    	i386
    	ia64
    	mips
    	ppc
    	s390
    	v850
    	x86_64
    
    ppc implements this as
    
    #define atomic_add_negative(a, v)	(atomic_add_return((a), (v)) < 0)
    
    and atomic_add_return() is implemented on
    
    	alpha
    	cris
    	h8300
    	ia64
    	m68knommu
    	mips
    	parisc
    	ppc
    	ppc
    	ppc64
    	s390
    	sh
    	sparc
    	v850
    
    so we're looking pretty good.

commit 2a43abd30975cd72080363cd8b505247dbb225a9
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 14 05:40:23 2004 -0700

    [PATCH] sparc64: implement atomic_add_negative()

commit bcd599c68c534f3c64f5d07175b465c6a95a913b
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 14 05:40:13 2004 -0700

    [PATCH] ia64 atomic_inc_and_test fix
    
    From: David Mosberger <davidm@napali.hpl.hp.com>

commit f3b6590cb5aa6086064ca20ce37ed75734b01a8a
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 14 05:40:02 2004 -0700

    [PATCH] alpha: atomic_inc_and_test()
    
    From: Ivan Kokshaysky <ink@jurassic.park.msu.ru>
    
    It seems atomic_inc_and_test() is missing on alpha.

commit 52d38af5b3f29fe6c94866735b6b85125a16620f
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 14 05:39:51 2004 -0700

    [PATCH] Implement atomic_inc_and_test() on various architectures
    
    It's easy to do when the arch provides atomic_inc_return().

commit ebc7bc428067d8ce745d787a2fbdd593e645bef9
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 14 05:39:40 2004 -0700

    [PATCH] Implement atomic_add_negative() on various architectures
    
    Lots of architectures have atomic_add_return() and no atomic_add_negative().
    
    We can implement the latter in terms of the former.

commit b5fc1438a06e40000dd9510ded6f950fd613c131
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 14 05:39:29 2004 -0700

    [PATCH] Make users of page->count use the provided macros
    
    I'm about to change the meaning (and name) of page->count.  Go through and fix
    up all those places which are open-coding references to it.

commit 21adfc1448c17757da328f16d92710850dd9ebb1
Merge: cd53caa... 0cd6f6c...
Author: Jeff Garzik <jgarzik@redhat.com>
Date:   Fri May 14 12:48:09 2004 -0400

    Merge redhat.com:/spare/repo/linux-2.6
    into redhat.com:/spare/repo/net-drivers-2.6

commit e88468acddd678332b055aca883e1ddfb08394f5
Merge: d09000d... 3fc3952...
Author: Vojtech Pavlik <vojtech@suse.cz>
Date:   Fri May 14 14:32:54 2004 +0200

    Merge bkbits:input into suse.cz:/home/vojtech/bk/input

commit 3fc3952010ffa4927e7d736fefee93fdcf23a95d
Author: Rob Melby <async@cc.gatech.edu>
Date:   Fri May 14 14:23:53 2004 +0200

    evdev.c:
      input: Fix an oops at opentime of /dev/input/event devices

commit 1cba1828853856ae40c30066c7bb8fc6fe0a2331
Author: Steve French <stevef@stevef95.austin.ibm.com>
Date:   Fri May 14 07:09:37 2004 -0500

    do not try to grab the i_sem ever during revalidate path since the rename code can grab it before we get here

commit c96ded1b5c0a1d792543474ae053660872077aed
Author: Jeff Garzik <jgarzik@redhat.com>
Date:   Fri May 14 06:10:10 2004 -0400

    [netdrvr] remove rcpci driver, for Red Creek Hardware VPNs
    
    Pete Popov, the author says
    
    This driver is obsolete and broken in 2.4 (and I'm pretty sure in 2.6).
    The hardware has not been available for a while. I wrote the driver
    for 2.2 but after I left RedCreek (which went out of business),
    someone in the community updated it to 2.4, but I don't think that
    person even had the hardware to test it so the driver remained broken
    in 2.4. So my recommendation is that it's really time to remove this
    driver from the kernel tree. Just my opinion but I thought I'd share
    it with you.
    [...]
    I can't imagine that there are any users because 2.4 was broken last
    time I checked (admittedly that was a year ago).

commit da749ce7f9c0fba0472cda3366bd7f1dd008abf9
Merge: be9bc8d... 44fcd18...
Author: David S. Miller <davem@nuts.davemloft.net>
Date:   Fri May 14 02:48:56 2004 -0700

    Merge nuts.davemloft.net:/disk1/BK/network-2.6
    into nuts.davemloft.net:/disk1/BK/net-2.6

commit 0cd6f6c123fb688380c1a48ce5f64c811913eee3
Merge: a0d4e51... 744804b...
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Fri May 14 02:46:22 2004 -0700

    Merge bk://kernel.bkbits.net/gregkh/linux/i2c-2.6
    into ppc970.osdl.org:/home/torvalds/v2.6/linux

commit db4830e5459d22fb073506c26cc3f2d07503d4d7
Author: Christoph Hellwig <hch@lst.de>
Date:   Fri May 14 05:28:03 2004 -0400

    [netdrvr wan] remove comx driver
    
    the drivers have been broken since pre-2.4.0, like referencing a symbol
    that was made procfs-internal in 2.3.x, haven't received maintainer
    updates for about the same period and MOD_{INC,DEC}_USE_COUNT usage that
    pretty much unfixable (inside warts of _horrible_ procfs abuse).

commit a0d4e51c1a5e5d031aa9dd1fb2fa207ccfafe627
Merge: be9bc8d... 3004c70...
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Fri May 14 02:26:40 2004 -0700

    Merge bk://kernel.bkbits.net/gregkh/linux/driver-2.6
    into ppc970.osdl.org:/home/torvalds/v2.6/linux

commit be9bc8d1f307a4c57b51284eb1393fcd950f9c4c
Merge: 8382d1f... 5458096...
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Fri May 14 01:50:45 2004 -0700

    Merge bk://kernel.bkbits.net/gregkh/linux/usb-2.6
    into ppc970.osdl.org:/home/torvalds/v2.6/linux

commit 3004c70f9036bbb74ea2842995edc8a21de9106e
Merge: 141baf8... 51c0c34...
Author: Greg Kroah-Hartman <greg@kroah.com>
Date:   Fri May 14 01:44:08 2004 -0700

    Merge kroah.com:/home/greg/linux/BK/bleed-2.6
    into kroah.com:/home/greg/linux/BK/driver-2.6

commit 744804bcdeaef29a736421bd0f2b0eddcfa9f879
Merge: 141baf8... 558fcd7...
Author: Greg Kroah-Hartman <greg@kroah.com>
Date:   Fri May 14 01:21:10 2004 -0700

    Merge kroah.com:/home/greg/linux/BK/bleed-2.6
    into kroah.com:/home/greg/linux/BK/i2c-2.6

commit e503ef53558091604330c09345cfe7485a6c75e3
Merge: 1147e4a... 33a393e...
Author: Steve French <stevef@stevef95.austin.ibm.com>
Date:   Fri May 14 03:13:52 2004 -0500

    Merge bk://cifs.bkbits.net/linux-2.5cifs
    into stevef95.austin.ibm.com:/home/stevef/linux-2.5cifs

commit 33a393ea7307a983aef603816301ec2278c89821
Author: Steve French <stevef@stevef95.austin.ibm.com>
Date:   Fri May 14 03:07:31 2004 -0500

    Add missing mount parameters

commit 558fcd724e9016b1af08d796f7e762b7dcc6117a
Author: Deepak Saxena <dsaxena@plexity.net>
Date:   Fri May 14 01:00:02 2004 -0700

    [PATCH] I2C: Missed ixp42x -> ixp4xx conversion
    
    Forgot to include this with my original patch a few weeks ago...

commit 4b36b0cf1d1e3ad1fe6e3df62623c5bff48eefda
Author: BjÃ¸rn Mork <bjorn@mork.no>
Date:   Fri May 14 00:59:26 2004 -0700

    [PATCH] I2C: "probe" module param broken for it87 in Linux 2.6.6
    
    Jean Delvare <khali@linux-fr.org> writes:
    > So I'd suggest that you simply use the standard exit sequence in the
    > it87 driver (the second one in your current patch). A patch for the 2.4
    > driver would be appreciated as well.
    
    OK.  I've attached a new version of the patch against linux-2.6.6.
    I'll send a patch against current lm_sensors CVS removing the extra
    exit command in a separate mail.
    
    Greg KH <greg@kroah.com> writes:
    > On Wed, May 12, 2004 at 04:38:03PM +0200, Bj?rn Mork wrote:
    >> +	if (!it87_find(&addr)) {
    >> +		printk("it87.o: new ISA address: 0x%04x\n", addr);
    >
    > That printk is wrong (no KERN_ level, or dev_printk() style use).
    > Please fix it in your next revision of this patch.
    
    Errh, I just added it to document my sloppyness.  It was never meant
    to be in the patch I sent you.  Sorry.  Removed in the attached patch.
    The style of these drivers seem to be "just working, making no noise"
    so I assume informational printk's are unwanted.

commit 5fc5be30cceb0b0c2c190754813a5aaa611f7d11
Author: Jason D. Gaston <jdgaston@snoqualmie.dp.intel.com>
Date:   Fri May 14 00:58:42 2004 -0700

    [PATCH] I2C: ICH6/6300ESB i2c support
    
    This patch adds DID support for ICH6 and 6300ESB to i2c-i801.c(SMBus).
    In order to add this support I needed to patch pci_ids.h with the SMBus
    DID's.  To keep things orginized I renumbered the ICH6 and ESB entries
    in pci_ids.h.  I then patched the piix IDE and i810 audio drivers to
    reflect the updated #define's.  I also removed an error from irq.c;
    there was a reference to a 6300ESB DID that does not exist.

commit 8382d1fb1c3333b2c468e587561a6c63522564f0
Author: Greg Kroah-Hartman <greg@kroah.com>
Date:   Fri May 14 00:49:39 2004 -0700

    USB: convert visor to use module_param()

commit f6442a84019ec33af161597fc34c2153c7d09869
Author: Greg Kroah-Hartman <greg@kroah.com>
Date:   Fri May 14 00:47:04 2004 -0700

    USB: convert pl2303 to use module_param()

commit 02eb8c101faf61a9720581584b57e8cbe56a2d81
Author: Greg Kroah-Hartman <greg@kroah.com>
Date:   Fri May 14 00:46:03 2004 -0700

    USB: change usbserial core to use module_param()

commit 5458096c8594f2cfc5e438ea9c5e579a98ea6293
Merge: 141baf8... 482f333...
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Fri May 14 00:00:10 2004 -0700

    Merge bk://linux-acpi.bkbits.net/linux-acpi-release-2.6.6
    into ppc970.osdl.org:/home/torvalds/v2.6/linux

commit 7ff622fd1ec7b429732bcb35dafc72e3688563fe
Author: David S. Miller <davem@nuts.davemloft.net>
Date:   Thu May 13 23:08:58 2004 -0700

    [TG3]: Add 572x/575x PCI IDs to driver table, update vers/reldate.

commit bc33285e146f43625e1cebbfb5ceaa0c4ae35055
Author: David S. Miller <davem@nuts.davemloft.net>
Date:   Thu May 13 23:04:52 2004 -0700

    [TG3]: Rewrite dma_rwctrl settings to handle PCIX/PCIE.

commit 8fd78857ae5b9c1a663294d37c7f20b2de8b8994
Author: David S. Miller <davem@nuts.davemloft.net>
Date:   Thu May 13 22:35:59 2004 -0700

    [TG3]: Do not enable slow clocks on 5750 with ASF.

commit f3a880cc9c7e4b231f0bdf8fb13f2236e7e5a1f5
Author: David S. Miller <davem@nuts.davemloft.net>
Date:   Thu May 13 22:22:38 2004 -0700

    [TG3]: More 5750 chip reset tweaks.

commit e044323a5be8fa10d5b71b6a4241823de2345daf
Author: David Brownell <david-b@pacbell.net>
Date:   Thu May 13 22:19:20 2004 -0700

    [PATCH] USB: hcd-pci suspend tweak
    
    I needed this to get an APM + UHCI config to behave on resume.
    Applies against your BK of last night ... OHCI and EHCI do
    some of this manually, they could be simplified later.

commit 51c0c34c8f0ac464c97aaef4754e7dc163dd586e
Author: Maneesh Soni <maneesh@in.ibm.com>
Date:   Thu May 13 22:13:00 2004 -0700

    [PATCH] sysfs_rename_dir-cleanup
    
    o The following patch cleans up sysfs_rename_dir(). It now checks the
      return code of kobject_set_name() and propagates the error code to its
      callers. Because of this there are changes in the following two APIs. Both
      return int instead of void.
    
    int sysfs_rename_dir(struct kobject * kobj, const char *new_name)
    int kobject_rename(struct kobject * kobj, char *new_name)

commit f00beb55bde63c01a8ee200e33c7f3d72a4e92b7
Author: Max Asbock <masbock@us.ibm.com>
Date:   Thu May 13 22:12:11 2004 -0700

    [PATCH] add ibmasm driver warning message
    
    [note, I changed this a bit to be nicer on the system log, greg k-h]

commit f6deceab14a869218e3e02669e038d013b9482dc
Author: David S. Miller <davem@nuts.davemloft.net>
Date:   Thu May 13 22:02:44 2004 -0700

    [TG3]: Full chip reset tweaks for 5750.

commit 48820d1a7cc812e6caa08dae37e03595e0e3a284
Author: David Brownell <david-b@pacbell.net>
Date:   Thu May 13 21:57:21 2004 -0700

    [PATCH] USB: ohci resume fix
    
    Prakash K. Cheemplavam wrote:
    > David Brownell wrote:
    >
    >>> There appear lines like
    >>>
    >>> usb usb2: string descriptor 0 read error: -108
    >>>
    >>> bug or feature? They weren't there with 2.6.6-mm1. I have no usb2.0
    >>> stuff to actually test. My usb1 stuff seems to work though.
    >>
    >> Bug; minor, since the only real symptom seems to be messages like
    >> that.  Ignore them for now, I'll make a patch soonish.
    >
    > Ok, good. Thanks for the explanation of what is going on, though I don't
    > can make too much out of it. ;-)
    
    The short version is:  it's missing this patch.

commit e240cf848d0b4fc1cd16ba21273a7df50f971c34
Author: David S. Miller <davem@nuts.davemloft.net>
Date:   Thu May 13 21:56:59 2004 -0700

    [TG3]: On 5750 with TSO, need to set some special reg bits.

commit 41fba93e9e46dfd46d11cbdb46aa294391afb74f
Author: Duncan Sands <baldrick@free.fr>
Date:   Thu May 13 21:52:44 2004 -0700

    [PATCH] USB: compile fix for usbfs snooping

commit 198ec964bbf11675fe04dc6164ed9aa11cb2e5c2
Author: Greg Kroah-Hartman <greg@kroah.com>
Date:   Thu May 13 21:49:41 2004 -0700

    USB: remove get_usb_serial() as it's pretty much unneeded
    
    It also could hide real bugs, and that's not good.  And the name
    implies that a reference is grabbed, and that's not true at all.

commit bbf793f8ec36227adef162dbdd2b8f63a99001da
Author: David S. Miller <davem@nuts.davemloft.net>
Date:   Thu May 13 21:46:43 2004 -0700

    [TG3]: Include mss in every txd, not just the first, on 5750.

commit 0cc8b902353b9609e7fe8e98717915758dbf4b05
Author: Greg Kroah-Hartman <greg@kroah.com>
Date:   Thu May 13 20:54:51 2004 -0700

    USB: remove serial_paranoia_check() function
    
    If this is hiding real problems, we need to find them.

commit c63063e2a105a07a2e709ad9086318461bc5063b
Author: Greg Kroah-Hartman <greg@kroah.com>
Date:   Thu May 13 20:53:59 2004 -0700

    USB: removed port_paranoia_check() call for usb serial drivers.
    
    Pretty useless stuff.  If this was hiding anything real, we need to find out.

commit fd7f6a57d0b96c18fe20c277614e471375e6a12e
Author: Greg Kroah-Hartman <greg@kroah.com>
Date:   Thu May 13 20:52:34 2004 -0700

    USB: remove magic number field from struct usb_serial as it's pretty useless.

commit 70f7aa08ecae297d9cf5c643fb9063f4a01a03bd
Author: Greg Kroah-Hartman <greg@kroah.com>
Date:   Thu May 13 20:50:40 2004 -0700

    USB: remove magic number field from usb_serial_port as it's pretty useless.

commit 2963e48d9ebc2900c8404b05ec66c68115d96a85
Author: Yves Rutschle <y.rutschle@indigovision.com>
Date:   Thu May 13 20:34:27 2004 -0700

    [ARM] Fix broken IXP4xx GPIO0 IRQ handling
    
    Patch from Yves Rutschle

commit 55a7006f62192ff66723b4ea80251b7b1ae71495
Merge: 2da9158... b27fa2f...
Author: Russell King <rmk@flint.arm.linux.org.uk>
Date:   Thu May 13 22:03:13 2004 +0100

    Merge bk://dsaxena.bkbits.net/linux-2.6-for-rmk
    into flint.arm.linux.org.uk:/usr/src/bk/linux-2.6-rmk

commit 2da915817874edb821f798ca38cfbbe685f1ec61
Author: Ben Dooks <ben-linux@org.rmk.(none)>
Date:   Thu May 13 20:27:25 2004 +0100

    [ARM PATCH] 1876/1: Removed apostrophes from asembler source
    
    Patch from Ben Dooks
    
    Removed two 's from assembly code (binutils has problems
    with these)

commit 70fdd2c03fca676f3fe6e1c8128d2d74ac5dfebf
Author: Ben Dooks <ben-linux@org.rmk.(none)>
Date:   Thu May 13 20:23:16 2004 +0100

    [ARM PATCH] 1875/1: SMDK2410 machine support
    
    Patch from Ben Dooks
    
    Initial support for SMDK2410 and variants

commit 5294473354d1a2d957bcb70f05605d8ee17befdb
Author: Ben Dooks <ben-linux@org.rmk.(none)>
Date:   Thu May 13 20:19:26 2004 +0100

    [ARM PATCH] 1874/1: S3C2410 - fix for selection of low-level debug UART
    
    Patch from Ben Dooks
    
    Fix selection configuration entry for UART number for low-level debug

commit 32b467bbd32147352fe26b9dcb616f09db78be57
Author: Jeff Garzik <jgarzik@redhat.com>
Date:   Thu May 13 14:46:01 2004 -0400

    [libata] kill ATA_QCFLAG_POLL flag
    
    The standard ATA bit nIEN in the Device Control register serves as
    the indicator for whether we are polling or not.  As it mirrors
    ATA_QCFLAG_POLL completely, eliminate that in favor of testing
    ATA_NIEN bit.

commit 63a2ea09fb6fa17943a9bfd9cb1732704eb96d01
Author: Jeff Garzik <jgarzik@redhat.com>
Date:   Thu May 13 14:39:17 2004 -0400

    [libata] random minor bug fixes
    
    * Only call ata_sg_setup{_one} if ATA_QCFLAG_SG is set.  Preparation
      for future use, as currently ATA_QCFLAG_SG is always set when
      ata_qc_issue is called.
    
      This change in theory is incorrect for Promise TX/SX4 drivers,
      since those drivers set up the Promise-specific packet in their
      ->fill_sg hook, which is now called conditionally.
    
      A FIXME that doesn't affect anything, for now.
    
    * ATA_PROT_ATAPI and ATA_PROT_ATAPI_DMA command issue need to be
      differentiated.
    
    * Create and use ata_qc_set_polling() to consistently set/clear the
      flags associated with using polling instead of interrupts.

commit 2e0b05720b394ba2c6bb36364ff963d07d9ccb05
Author: Jeff Garzik <jgarzik@redhat.com>
Date:   Thu May 13 13:26:59 2004 -0400

    [libata] more ATAPI work - translate SCSI CDB to ATA PACKET
    
    Now that we can specify ATAPI as a taskfile protocol, we can utilize
    the existing SCSI->ATA translation infrastructure to build an ATA
    PACKET command quickly and easily.

commit 4801224e03f98cc2cfcf154767aff46617365046
Author: Jeff Garzik <jgarzik@redhat.com>
Date:   Thu May 13 13:15:42 2004 -0400

    [libata] use new ->bmdma_{start,setup} method to properly support ATAPI

commit 8fdb45f52c108cf1c02078681b87209a3bf10656
Author: Jeff Garzik <jgarzik@redhat.com>
Date:   Thu May 13 12:35:48 2004 -0400

    [libata] add new ->bmdma_setup hook
    
    In order to support some new taskfile protocols, particularly ATAPI,
    the setup-and-start-DMA hook needs to be split into its component
    pieces, 'setup' and 'start'.
    
    For PCI IDE-style controllers, most of the code is moved into the
    'setup' portion, with the 'start' portion only flipping a single
    bit in hardware.

commit 6206b396ffb5133a86059e83ac53f0f477826fe8
Author: John Lenz <jelenz@edu.rmk.(none)>
Date:   Thu May 13 16:41:47 2004 +0100

    [ARM PATCH] 1851/1: sa1100 fb support for collie
    
    Patch from John Lenz
    
    Add the sa1100fb_mach_info structure for collie

commit bab1bc0fa425c364dff2ab25db34b09886801d6a
Merge: fc9754d... b57845a...
Author: Russell King <rmk@flint.arm.linux.org.uk>
Date:   Thu May 13 16:05:27 2004 +0100

    Merge bk://dsaxena.bkbits.net/linux-2.6-for-rmk
    into flint.arm.linux.org.uk:/usr/src/bk/linux-2.6-ds

commit b57845a4bad6598e601003d3c9cbff16d5667178
Author: Nicolas Pitre <nico@org.rmk.(none)>
Date:   Thu May 13 14:59:34 2004 +0100

    [ARM PATCH] 1871/1: faster IRQ retrieval for PXA27x
    
    Patch from Nicolas Pitre
    
    On the PXA27x it's also possible to get the IRQ info from CP6
    and it has a much lower latency than the memory mapped equivalent.

commit fc86dbc07720e3f5dea68eb1f84c8a5e2358f8ab
Author: Nicolas Pitre <nico@org.rmk.(none)>
Date:   Thu May 13 14:55:33 2004 +0100

    [ARM PATCH] 1865/1: DMA changes for PXA27x
    
    Patch from Nicolas Pitre

commit 348420ffe37ccad380f75ff203017071ffda4d1a
Author: Nicolas Pitre <nico@org.rmk.(none)>
Date:   Thu May 13 14:51:39 2004 +0100

    [ARM PATCH] 1864/1: separate PXA25x and PXA27x specific code
    
    Patch from Nicolas Pitre

commit 5eefd7a832e731dedb9ec82c5650ed047c27193e
Author: Nicolas Pitre <nico@org.rmk.(none)>
Date:   Thu May 13 14:47:12 2004 +0100

    [ARM PATCH] 1863/2: definitions and mapping for the Intel PXA27x internal registers
    
    
    Patch from Nicolas Pitre
    
    This reworks PXA register mapping to accommodate the extra registers
    of the PXA27x chips (aka Bulverde).

commit 3639d00e1ebac5ff3bece67b99e2e3430c8b030a
Author: Nicolas Pitre <nico@org.rmk.(none)>
Date:   Thu May 13 14:43:02 2004 +0100

    [ARM PATCH] 1842/1: fix/clarify some comments
    
    Patch from Nicolas Pitre

commit 7852fa902c18289b6c6d36b165e3527b44510a66
Author: John K. Luebs <jkluebs@com.rmk.(none)>
Date:   Thu May 13 14:27:15 2004 +0100

    [ARM PATCH] 1848/1: PXA suspend/resume improvements
    
    Patch from John K Luebs
    
    This adds support to preserve the GPIO level across a suspend
    and resume for PXA machine types. Removes the hack to preserve
    the FFUART state as this is unnecessary with the 2.6 serial
    driver code.

commit 6f299774f4dba0c19e021af43470557369b3a9e6
Author: Tony Lindgren <tony@com.rmk.(none)>
Date:   Thu May 13 14:22:56 2004 +0100

    [ARM PATCH] 1854/1: Remove old board specific OMAP files
    
    Patch from Tony Lindgren
    
    Removes old duplicate board specific files that have been renamed to
    board-*.c

commit 308d4fe2d5bf5fc11373a7689ca8e199268b4dab
Author: Tony Lindgren <tony@com.rmk.(none)>
Date:   Thu May 13 14:19:05 2004 +0100

    [ARM PATCH] 1853/1: Update OMAP low level debug functions
    
    Patch from Tony Lindgren
    
    Changes OMAP low level debug function to allow virtual IO != physical
    IO.  Also removes waituart checking, as it only worked for first
    serial port.

commit 3c65c55d5d118137d80ce12e77ac2e14ae889717
Author: Ian Campbell <icampbell@com.rmk.(none)>
Date:   Thu May 13 14:14:47 2004 +0100

    [ARM PATCH] 1827/1: PXAFB patch updated based on comments in 1826
    
    Patch from Ian Campbell
    
    The patch includes the PXA FB driver discussed recently on the
    arm-kernel mailing list, I have incorporated your (RMK's) comments
    from patch 1826.

commit ab16652905c53f1acbbc974478055f184e263310
Author: Deepak Saxena <dsaxena@xanadu.(none)>
Date:   Thu May 13 03:34:01 2004 -0700

    [ARM] Add config help and documentation for Intel IXP4xx platforms
    
    Patch from Deepak Saxena

commit 1b51f2428c28bde7bbefefe09926f68da964baaf
Author: James Bottomley <jejb@mulgrave.(none)>
Date:   Thu May 13 05:03:44 2004 -0500

    gdth driver update to 3.04
    
    From: 	Leubner, Achim <Achim_Leubner@adaptec.com>
    
    - Support for drives > 2 TB implemented
    - 64-bit DMA support depending on the controller firmware version implemented
    - Some important bug fixes made

commit 5e738ff127c19cb4bf63240eba427dff067730e8
Author: David Brownell <david-b@pacbell.net>
Date:   Thu May 13 02:04:18 2004 -0700

    [PATCH] USB: usbhid calls itself "hid"

commit ee996862e15487b5540acd40c620382b0c82ce00
Author: Tony Lindgren <tony@atomide.com>
Date:   Thu May 13 02:03:50 2004 -0700

    [PATCH] USB: Merge support for Keyspan UPR-112 USB serial adapter from 2.4 to 2.6
    
    Following patch merges the support for Keyspan UPR-112 USB serial adapter
    from 2.4 to 2.6.

commit 67bfc49970bfcc06abee67c52cf4dd1a44b2a5c5
Author: Deepak Saxena <dsaxena@xanadu.(none)>
Date:   Thu May 13 01:41:14 2004 -0700

    MTD driver for Intel IXP4xx platform (from MTD CVS tree)
    
    Patch from Deepak Saxena <dsaxena@plexity.net>

commit 0d7d76d3e681fc36f6bf04d776d153f04eba8c25
Author: Greg Kroah-Hartman <greg@kroah.com>
Date:   Thu May 13 01:40:30 2004 -0700

    USB: add snooping capability to usbfs for control messages.
    
    Also fix up some of the other printk() calls to be dev_* calls.

commit 42705eb4fe4cb82f31e78fa869a8799e6e7eb118
Author: David Mosberger <davidm@tiger.hpl.hp.com>
Date:   Thu May 13 01:35:41 2004 -0700

    ia64: Correct atomic_inc_and_test() and atomic64_inc_and_test().

commit 7c323b141ad1f0b6a7a3561e3a5e5bcce9a9c03b
Author: David Mosberger <davidm@tiger.hpl.hp.com>
Date:   Thu May 13 01:31:46 2004 -0700

    ia64: fix spurious "timer tick before it's due" problem
    
    Patch Bjorn Helgaas: Fix the "timer tick before it's due" complaint
    from timer_interrupt().  The problem was that smp_callin() turned
    on the periodic timer tick before syncing the ITC with the BP.
    
    Syncing the ITC happens with interrupts disabled, and if you're
    unlucky enough to (1) pend a timer interrupt, and (2) set the ITC
    back before the ITM value that caused the timer interrupt, you
    can get stuck for several iterations in the following cycle
    (assume 100 clocks per tick):
    
        ITC     ITM
        ---	    ---
                        ia64_init_itm()
        100	    200	        schedule first tick at 200
                        ia64_sync_itc()
                            disable interrupts
        200     200         ITC == ITM; pend IT interrupt
        150                 set ITC to sync with BP
                            enable interrupts
                            recognize pending IT interrupt
                            disable IT interrupts
                        timer_interrupt()
        160     200         notice that 160 < 200,
                                printk "timer tick before it's due")
        200     200         ITC == ITM; pend IT interrupt
    	    300         set ITM for next tick
                            re-enable IT interrupt
                            recognize pending IT interrupt
                            disable IT interrupts
                        timer_interrupt()
        260     300         notice that 260 < 300,
                                printk "timer tick before it's due")
    
        ...	            repeat until you're tired or timer_interrupt()
                        takes long enough that the ITC lands after the
                        ITM
    
    This patch syncs the ITC with the BP before starting up the
    periodic tick, so the above scenario should never happen.
    
    This doesn't change how the timer tick on the BP is started;
    that happens quite early (and must be early because things
    like calibrate_delay() depend on jiffies updates).

commit 8081e9a10f7d57c7b24a17e8a9780444ae318485
Author: Deepak Saxena <dsaxena@xanadu.(none)>
Date:   Thu May 13 01:12:54 2004 -0700

    [ARM] Remove Documentation/ARM/XScale
    
    Patch from Deepak Saxena <dsaxena@plexity.net>
    
    Documentation/ARM/XScale has not been updated by anyone in a long time;
    therefore, it is being deleted until someone volunteers to provide
    updated versions.

commit b3701e0e5180bd27648c9962d53948dce0bd989f
Author: Douglas Gilbert <dougg@torque.net>
Date:   Thu May 13 02:40:33 2004 -0500

    [PATCH] st.c for GET_IDLUN
    
    A little more testing of st's SG_IO ioctl turned up a
    small problem.
    
    This is the corresponding patch that was applied to the
    sd driver when it received the block layer SG_IO ioctl.
    
    For least surprise of lk 2.4 utilities that use the
    SCSI_IOCTL_GET_IDLUN and SCSI_IOCTL_GET_BUS_NUMBER
    ioctls (e.g. sg_map) it is better to return the correct
    values rather than 0.

commit 9fc5617da2092313d1bd096c910c2959d2b874ca
Author: James Bottomley <jejb@mulgrave.(none)>
Date:   Thu May 13 02:36:42 2004 -0500

    Fix SCSI device state model
    
    Following a prior patch, we made cancel the sole
    route into deleted, but forgot to update the
    state model checks to reflect this.
    
    offline and created also go to cancel

commit e243c0fe60f97f3749f616a78d695c0d538a33ee
Author: Andrew Morton <akpm@osdl.org>
Date:   Thu May 13 00:15:01 2004 -0700

    [PATCH] USB: fix ohci-hcd build error
    
    "Matt H." <lkml@lpbproductions.com> wrote:
    >
    > Just attempted to compile 2.6.6-mm2 and got this error
    >
    >    CC [M]  drivers/usb/core/driverfs.o
    >    CC [M]  drivers/usb/core/hcd-pci.o
    >    LD [M]  drivers/usb/core/usbcore.o
    >    LD      drivers/usb/host/built-in.o
    >    CC [M]  drivers/usb/host/ehci-hcd.o
    >    CC [M]  drivers/usb/host/ohci-hcd.o
    >  In file included from drivers/usb/host/ohci-hcd.c:129:
    >  drivers/usb/host/ohci-hub.c: In function `ohci_rh_resume':
    >  drivers/usb/host/ohci-hub.c:313: error: `hcd' undeclared (first use in this
    >  function)
    
    hm, not sure what's happened there...

commit 00ee59a3c87637789e51d95ee081dd695dba9bee
Author: Alan Stern <stern@rowland.harvard.edu>
Date:   Thu May 13 00:14:34 2004 -0700

    [PATCH] USB: Don't delete interfaces until all are unbound
    
    On Thu, 13 May 2004, Duncan Sands wrote:
    
    > No, but the pointer for another (previous) interface may just have been
    > set to NULL, causing an Oops when usb_ifnum_to_if loops over all
    > interfaces.
    
    Of course!  I trust you won't mind me changing your suggested fix
    slightly.  This should do an equally good job of repairing things, and it
    will prevent other possible invalid references as well.

commit 79560d5ad1c93ecf63421e8de8dc4f49725a7620
Author: Duncan Sands <baldrick@free.fr>
Date:   Thu May 13 00:14:05 2004 -0700

    [PATCH] USB: Patch to remove interface indices from devio.c
    
    > I went ahead and created a patch to change all the places where devio.c
    > uses an interface index.  Now it always uses just the interface number.
    > Does this look all right to you?  I don't have a convenient way to test
    > it.
    
    Hi Alan, thanks for doing this.  It looks and works OK.  I added some name
    changes: all struct usb_interface pointers are now called intf; and, when
    reasonable, variables holding interface numbers are now all called ifnum.
    This drowns your original changes in a sea of churning names, I hope you
    don't mind.

commit e2a5c7a916ee39a5ccc6c34be80d9083f2bb05e7
Author: David Brownell <david-b@pacbell.net>
Date:   Thu May 13 00:13:38 2004 -0700

    [PATCH] USB: missing probe() diagnostics for CDC Ethernet
    
    This patch should help correct the "missing diagnostics with
    CONFIG_USB_DEBUG during CDC Ethernet probe()" issue.  Some
    folk are having problems with firmware that doesn't respond
    properly to descriptor fetches -- which is unnecessarily
    confusing because the diagnostics aren't being printed.

commit e3f32fdc6b221c3bc9d439c09953208d2b8e70d1
Author: StÃ©phane Eranian <eranian@hpl.hp.com>
Date:   Wed May 12 23:23:45 2004 -0700

    [PATCH] ia64: switch /proc/perfmon to seq_file avoid buffer overflows
    
    Switches /proc/perfmon to using the seq_file interface.  This is more
    inline with the rest of the kernel and avoid crashes for very large
    machine configurations.
    
    Based on patch by Dean Nelson.

commit b27fa2f1ff626d514bbe52b819ac2b55d4bc7244
Author: Deepak Saxena <dsaxena@xanadu.(none)>
Date:   Wed May 12 20:40:24 2004 -0700

    prpmc1100-setup.c, ixdp425-setup.c, coyote-setup.c:
      Add INIT_MACHINE() to ixp4xx platform setup code

commit e0aaff94e96c3270936c3df2e59b628e8d253646
Author: Deepak Saxena <dsaxena@xanadu.(none)>
Date:   Wed May 12 20:37:50 2004 -0700

    common.c:
      Remove unused flag variable from ixp4xx_timer_interrupt

commit 297df44d7e3d03c7d3b073462258f8f0a1c005b2
Author: Deepak Saxena <dsaxena@xanadu.(none)>
Date:   Wed May 12 20:20:39 2004 -0700

    common.c:
      new file

commit cae2199517a6a62e00972818720eb2570b81043b
Merge: 5ae3979... bd3ad3b...
Author: Len Brown <len.brown@intel.com>
Date:   Wed May 12 18:40:09 2004 -0400

    Merge intel.com:/home/lenb/src/linux-acpi-test-2.6.6
    into intel.com:/home/lenb/src/linux-acpi-test-2.6.7

commit bd3ad3b93ecde3a9975e36e7942b251a3c7f39ec
Author: Len Brown <len.brown@intel.com>
Date:   Wed May 12 16:10:47 2004 -0400

    [ACPI] create kacpid thread to handle ACPI work in process context.
    Also will be needed for cpu hot-unplug.
    from Anil S Keshavamurthy and David Shaohua Li
    http://bugzilla.kernel.org/show_bug.cgi?id=2515

commit 6c3d6ae4c8576b1378b23153394a1646fa04b629
Author: Len Brown <len.brown@intel.com>
Date:   Wed May 12 15:31:01 2004 -0400

    [ACPI] Add MADT error checking (Yi Zhu)
    http://bugzilla.kernel.org/show_bug.cgi?id=1434

commit e7c9dc4330e703b75de85029cd77bb5ff1866db6
Author: David S. Miller <davem@nuts.davemloft.net>
Date:   Wed May 12 07:53:02 2004 -0700

    [TG3]: Updated ASF handling for 5750.

commit 918a92d3b32c41204573d892cb0419b94d4046e8
Author: David S. Miller <davem@nuts.davemloft.net>
Date:   Wed May 12 07:23:46 2004 -0700

    [TG3]: Update LED programming to support 5750.

commit 678e1a686aac55759f626b1822a80f070609dba2
Author: David S. Miller <davem@nuts.davemloft.net>
Date:   Wed May 12 06:28:36 2004 -0700

    [TG3]: Add 5750 NVRAM programming plus 5704 MAC offset bug fix.

commit 3bf263ee92eb1b5eaf138f92ee4631c6a47fd8a1
Author: Dave Jones <davej@redhat.com>
Date:   Wed May 12 13:50:18 2004 +0100

    [AGPGART] Various Intel/EM64T AGP fixes.
    
    From Andi Kleen.
    
    - Add full PCI IDs to the module table for intel-agp and intel-mch-agp.
    Don't use PCI_ANY_ID for device, since the drivers cannot handle unknown
    devices anyways.
    This fixes the problems with them loading both when compiled in and
    also helps external tools that use the module PCI table to find the
    correct driver.
    - Remove wrong hack in intel-mch-agp that checked for long mode.
    EM64T capability has nothing to do with the MCH version.
    To avoid double probing the fix above is better.
    - Handle the case of no AGP capability (unlikely, but better to handle it)

commit fc9754dc3a2cd08b65cc75ce9d22db9512e0bf77
Author: Deepak Saxena <dsaxena@xanadu.(none)>
Date:   Wed May 12 01:24:58 2004 -0700

    pci_ids.h:
      IXP4xx support

commit d43e2297031f927173cc261e9d68dd5b49a9ff69
Author: Deepak Saxena <dsaxena@xanadu.(none)>
Date:   Wed May 12 01:02:42 2004 -0700

    Add IXP4xx support

commit 3b6e11b5bc539075c61c0c9e091e78b9b25335cd
Author: Deepak Saxena <dsaxena@xanadu.(none)>
Date:   Wed May 12 00:59:16 2004 -0700

    proc-xscale.S, Kconfig:
      IXP4xx support

commit 87aa70c43f0673727cca33d8996d951bc677bb1a
Author: Deepak Saxena <dsaxena@xanadu.(none)>
Date:   Wed May 12 00:58:18 2004 -0700

    head.S, Makefile:
      IXP4xx support

commit cea72048a1216f2a5a7d8beb27347914c526f845
Author: Deepak Saxena <dsaxena@xanadu.(none)>
Date:   Wed May 12 00:57:06 2004 -0700

    entry-armv.S, debug.S, bios32.c:
      IXP4xx support

commit f338b93f639829eba92abd0778881eb203dc3cc8
Author: Deepak Saxena <dsaxena@xanadu.(none)>
Date:   Wed May 12 00:55:17 2004 -0700

    First of a set of eight patches that adds support for Intel's
    IXP4xx family of network processors. The code still needs some
    cleanup here and there, but it's to the point that it's should
    be OK to push upstream.
    
    Some of the remaining TODOs:
    
    - Cleanup GPIO IRQ handling for edge-trigered HW (none exists ATM)
    - Add IDE driver for various platforms
    - Misc cleanups
    
    This patch adds the changes to arch/arm/Makefile and arch/arm/Kconfig

commit 5bfa4967e3ef2ba5bbf65e98c6144cf810293d3f
Author: Jesse Barnes <jbarnes@engr.sgi.com>
Date:   Wed May 12 00:48:30 2004 -0700

    [PATCH] ia64: map display option ROMs on SN2
    
    By default, the sn2 PCI init code doesn't map option ROM address
    ranges since PIO address space is limited.  However, we do need to map
    display option ROMs in the event that userland applications want to
    read and emulate them.

commit 833ae1898ffc1702d1eafd514451c753baf65318
Author: Jesse Barnes <jbarnes@engr.sgi.com>
Date:   Wed May 12 00:43:35 2004 -0700

    [PATCH] ia64: This patch kills some unused lines and redundant functions

commit 2c1bcb9102a05f86a5dfad9e55a03ed298f91375
Author: David Mosberger <davidm@tiger.hpl.hp.com>
Date:   Wed May 12 00:27:12 2004 -0700

    ia64: Call print_modules() before printing tombstone.

commit 4948bc708375619e69a2c18f8cec65b92702d39e
Author: David S. Miller <davem@nuts.davemloft.net>
Date:   Wed May 12 00:25:12 2004 -0700

    [TG3]: If asked to load TSO firmware on 5750, just return success.
    
    The 5750 does TSO in hardware, not via firmware code.

commit b0386328019b71a70c0ee54e2b1d1e50aa53158e
Author: David S. Miller <davem@nuts.davemloft.net>
Date:   Tue May 11 23:59:06 2004 -0700

    [TG3]: Update to non-5705 TSO firmware version 1.6.0

commit b7fea8b8bd72166942e8b589e0e948af4aff3a37
Author: David S. Miller <davem@nuts.davemloft.net>
Date:   Tue May 11 23:49:49 2004 -0700

    [TG3]: Update to 5788 capable 5705 TSO firmware, version 1.2.0

commit 1ffdb4f5be08892a5355a99e715f55c07d0bc1a6
Author: Mathieu Chouquet-Stringer <mchouque@online.fr>
Date:   Tue May 11 22:51:44 2004 -0700

    [MODULES]: Fix endianness in modprobe.

commit 44fcd182122d818d855df5e5d43b895ea5596f16
Author: Stephen Hemminger <shemminger@osdl.org>
Date:   Tue May 11 22:03:46 2004 -0700

    [BRIDGE]: Allow multiple interfaces with same address (necessary for VLAN's).

commit 2de4b300b6ef5e9dfadd3646bf624aee09190474
Author: Jesse Barnes <jbarnes@engr.sgi.com>
Date:   Tue May 11 22:01:10 2004 -0700

    [PATCH] ia64: kill warnings in sn2 specific pci init
    
    A couple of unused variable warnings cropped up in the sn2 pci init routine.
    This patch kills the unused variables.

commit 6e0e96e841cb7047105cb28f9bc5e8434f33bad0
Author: Jesse Barnes <jbarnes@engr.sgi.com>
Date:   Tue May 11 22:00:13 2004 -0700

    [PATCH] ia64: sn_get_node_first_cpu() is redundant
    
    sn_get_node_first_cpu() is redundant, so kill it.  Since calls to this routine
    happen rather late in the boot process, using the generic topology functions
    is safe.  Fixup the callers and kill the function.

commit 8163ca20c9d91412b02ef0b9cda35e6390b9d3c6
Merge: 141baf8... 5684f29...
Author: David S. Miller <davem@nuts.davemloft.net>
Date:   Tue May 11 21:58:31 2004 -0700

    Merge http://linux-mh.bkbits.net/bluetooth-2.6
    into nuts.davemloft.net:/disk1/BK/net-2.6

commit b9177fbea42bca04a45ea980f48c64dbed94be48
Author: Mathieu Chouquet-Stringer <mchouque@online.fr>
Date:   Tue May 11 21:33:56 2004 -0700

    [SPARC]: Mark unaligned_panic as attribute used to workaround gcc-3.4 problem.

commit f5510e199d75aa007d25f4d6d663e206249bddd1
Merge: 141baf8... 7e0cb22...
Author: Greg Kroah-Hartman <greg@kroah.com>
Date:   Tue May 11 20:06:23 2004 -0700

    Merge kroah.com:/home/greg/linux/BK/bleed-2.6
    into kroah.com:/home/greg/linux/BK/usb-2.6

commit daabacc2eeef3a71613d14b9f88212677c987aaa
Author: Anton Altaparmakov <aia21@cantab.net>
Date:   Wed May 12 01:39:47 2004 +0100

    NTFS: Really final white space cleanups.

commit 70bf88da262fea2641c7fd4130e49c1e4ec3bdfb
Author: Anton Altaparmakov <aia21@cantab.net>
Date:   Wed May 12 01:16:06 2004 +0100

    NTFS: Only build logfile.o if building the driver with read-write support.

commit 42a905515f6a4d448162574801b981bb8c99d8ad
Merge: d14e09a... 141baf8...
Author: Anton Altaparmakov <aia21@cantab.net>
Date:   Tue May 11 23:57:26 2004 +0100

    Merge cantab.net:/home/src/bklinux-2.6
    into cantab.net:/home/src/ntfs-2.6

commit 5ae397912567556d22fb60e4ed7fe498572da7ab
Merge: bbe8a2c... b1cf069...
Author: Len Brown <len.brown@intel.com>
Date:   Tue May 11 17:57:31 2004 -0400

    Merge intel.com:/home/lenb/src/linux-acpi-test-2.6.6
    into intel.com:/home/lenb/src/linux-acpi-test-2.6.7

commit b1cf0694af8bdf97d9124377a9b5f350aa894a9a
Author: Len Brown <len.brown@intel.com>
Date:   Tue May 11 16:37:02 2004 -0400

    [ACPI] if _STA.functional, set _STA.present (Bjorn Helgaas)
    workaround for Big Sur and Bull systems

commit 7ea74153b23177a0eef2219df2485eadbfc96609
Author: Len Brown <len.brown@intel.com>
Date:   Tue May 11 15:53:05 2004 -0400

    [ACPI] create platform_rename_gsi() so ES7000 can munge IRQ numbers
    from Natalie Protasevich

commit d14e09af7df411fc013171e95a22efafdce39f28
Author: Anton Altaparmakov <aia21@cantab.net>
Date:   Tue May 11 19:38:24 2004 +0100

    NTFS: 2.1.10 - Force read-only (re)mounting of volumes with unsupported flags.

commit 1147e4a73cbc5f58833ee208a20caf4737fdf82c
Author: Steve French <stevef@steveft21.ltcsamba>
Date:   Tue May 11 13:29:26 2004 -0500

    Fix oops when smb buffer can not be allocated

commit 3bfc2601c5e5bfa5c8769f45dcfd4b35e3222809
Author: Nicolas Pitre <nico@org.rmk.(none)>
Date:   Tue May 11 18:51:14 2004 +0100

    [ARM PATCH] 1843/2: supress PCMCIA build warnings
    
    Patch from Nicolas Pitre
    
    This is an alternative to patch #1843/1 keeping the ugliness
    (and possible future breakage) to the affected driver only.
    This one should be applied after patch #1830/2.

commit 9a76ada83d5bd88bc35b20d5a4511d759ef0d940
Author: Nicolas Pitre <nico@org.rmk.(none)>
Date:   Tue May 11 18:46:51 2004 +0100

    [ARM PATCH] 1831/1: remove outdated SA11xx PCMCIA documentation
    
    Patch from Nicolas Pitre
    
    This documentation isn't reflecting the code anymore and therefore
    is misleading.  Better remove it and let people see the code where
    multiple examples can now be followed.

commit 8bb47e486cec7662181da8a354c350b3cc76d67b
Author: Nicolas Pitre <nico@org.rmk.(none)>
Date:   Tue May 11 18:42:43 2004 +0100

    [ARM PATCH] 1830/2: PCMCIA support for Lubbock (PXA2xx based)
    
    Patch from Nicolas Pitre
    
    [Patch #1830/1 wasn't generated correctly.  Here's the fixed one.]
    
    This adds PCMCIA support for Lubbock and relies on patch #1829/1.  This
    is probably the only reference board using both the PXA2xx and the SA1111
    for PCMCIA support. Other board won't need to link sa1111_generic.o.

commit 507035e1a5185c2450cae2fc928efac0dfc8aa77
Author: Nicolas Pitre <nico@org.rmk.(none)>
Date:   Tue May 11 18:38:35 2004 +0100

    [ARM PATCH] 1829/1: base support for PCMCIA on the Intel PXA2xx chip
    
    Patch from Nicolas Pitre
    
    This provides base PCMCIA support for PXA2xx and relies on patch #1828/1.
    Board specific support must be added separately.
    
    This is based on initial work from Stefan Eletzhofer and Ian Molton.

commit d4d07e46c780840d5d1983dd9c10937c10e2682f
Author: Nicolas Pitre <nico@org.rmk.(none)>
Date:   Tue May 11 18:32:38 2004 +0100

    [ARM PATCH] 1828/2: rework SA11xx PCMCIA code structure for better sharing of generic
     code
    
    Patch from Nicolas Pitre
    
    [Updated after comments on patch #1828/1]
    
    This patch moves things around and rename a few files/functions/structures
    to be shared with PXA2xx PCMCIA support (coming in a separate patch) and
    maybe others SOCs. No functional change were made so SA11xx users
    shouldn't see any difference.

commit 6ded2df9774012dff25037df3a669da46f56d7c2
Author: Dave Jones <davej@redhat.com>
Date:   Tue May 11 15:01:27 2004 +0100

    [CPUFREQ] Nehemiah improvements for longhaul driver.
    From Andreas Meisinger

commit a7615aebabc680800f4922350719a7f6c059f841
Author: Dave Jones <davej@redhat.com>
Date:   Tue May 11 14:59:02 2004 +0100

    [CPUFREQ] Fix for longrun.c for degenerate case
    From H. Peter Anvin
    
    I ran into a system the other day which had a Transmeta processor, but
    configured in a degenerate, fixed-frequency configuration.  It crashed
    booting Fedora Core 2 test 3 due to a division by zero in the longrun
    cpufreq driver.

commit 06393d0fd61ad205855e3578b64f685488d0f6de
Author: Dave Jones <davej@redhat.com>
Date:   Tue May 11 14:57:45 2004 +0100

    [CPUFREQ] Avoid scheduling cpufreq_delayed_get_work() twice; but do call it a bit earlier.

commit b4ffaea13eaf1e6656bd181a998a060267f3d539
Author: Dave Jones <davej@redhat.com>
Date:   Tue May 11 14:56:07 2004 +0100

    [CPUFREQ] Latency is in nanoseconds -- speedstep-centrino got it wrong

commit d2b4affa9e8e66c46be7ad2a5826166d7d12ff7a
Author: Dave Jones <davej@redhat.com>
Date:   Tue May 11 14:37:15 2004 +0100

    [CPUFREQ] cpu_sibling_mask fixup.

commit d09000d34ceef54a1f0bbe68dd58203960bd65cd
Merge: 7e1bfc5... fac70b7...
Author: Vojtech Pavlik <vojtech@suse.cz>
Date:   Tue May 11 15:02:53 2004 +0200

    Merge bk://dtor.bkbits.net/input into suse.cz:/data/bk/input

commit 9d41ab4c2321ed069fc98c6eaba3a050359dbe7e
Merge: 83afa5c... 3d29f7c...
Author: Anton Altaparmakov <aia21@cantab.net>
Date:   Tue May 11 11:50:41 2004 +0100

    Merge cantab.net:/home/src/bklinux-2.6
    into cantab.net:/home/src/ntfs-2.6

commit 427ac533882bb6f0a138cce26cfabd8467c081e3
Author: Maneesh Soni <maneesh@in.ibm.com>
Date:   Tue May 11 02:43:50 2004 -0700

    [PATCH] kobject/sysfs race fix
    
    The following patch fixes the race involved between unregistering a kobject
    and simultaneously opeing a corresponding attribute file in sysfs.
    
    Ideally sysfs should take a ref.  to the kobject as long as it has dentries
    referring to the kobjects, but because of current limitations in
    module/kobject ref counting, sysfs's pinning of kobject leads to
    hang/delays in rmmod of certain modules.  The patch checks for unhashed
    dentries in check_perm() while opening a sysfs file.  If the dentry is
    still hashed then it goes ahead and takes the ref to kobject.  This done
    under the per dentry lock.  It does this in the inline routine
    sysfs_get_kobject(dentry).

commit bbe8a2c8e4f478e4e9e456664a0db8b0b7a947f2
Merge: 141baf8... 482f333...
Author: Len Brown <len.brown@intel.com>
Date:   Tue May 11 05:36:33 2004 -0400

    Merge intel.com:/home/lenb/bk/linux-2.6.7
    into intel.com:/home/lenb/src/linux-acpi-test-2.6.7

commit 8bcb3f98404202e085120d21fcc6e66eb90677a7
Author: James Bottomley <james.bottomley@steeleye.com>
Date:   Tue May 11 02:35:42 2004 -0700

    [PATCH] fix dev_printk to work even in the absence of an attached driver

commit ab7f733171c2c0a44689f89c2078e76631d32dd5
Author: Maneesh Soni <maneesh@in.ibm.com>
Date:   Tue May 11 02:31:46 2004 -0700

    [PATCH] kobject_set_name - error handling
    
    1) kobject_set_name-cleanup-01.patch
    
    This patch corrects the following by checking the reutrn code from
    kobject_set_name().
    
    bus_add_driver()
    bus_register()
    sys_dev_register()
    
    
    
    o The following patch cleansup the kobject_set_name() users. Basically checking
      return code from kobject_set_name(). There can be error returns like -ENOMEM
      or -EFAULT from kobject_set_name() if the name length exceeds KOBJ_NAME_LEN.

commit 81da67b3713b53ad7fcbe7110cd531f1e00de1d2
Author: Gary Wong <gtw@cs.bu.edu>
Date:   Tue May 11 05:31:42 2004 -0400

    [sound i810] silently ignore invalid PCM_ENABLE_xxx bits from userland
    
    We must guarantee that struct file's ->f_mode agrees with
    PCM_ENABLE_xxx bits from userland OSS apps.  Other drivers silently
    ignore invalid bits, so we follow their lead.

commit 7e0cb221855e45fdeb1b3f433fefb211a205434c
Author: Colin Leroy <colin@colino.net>
Date:   Tue May 11 02:19:59 2004 -0700

    [PATCH] USB: cosmetic fixes for cdc-acm

commit c8ae88da4d4fa7a5ca936e48d401f434ad27e959
Author: David Brownell <david-b@pacbell.net>
Date:   Tue May 11 02:03:07 2004 -0700

    [PATCH] USB: OHCI root hub suspend/resume/wakeup
    
    This patch goes on top of the previous two, and the hcd-0506 patch:
    
      - Moves root hub suspend/resume code out of PCI-specific bus glue
        into generic hub code.  That way it's easy to re-use it even
        for non-PCI implementations like SA1111, OMAP, and LH7A404.
        (Plus, given CONFIG_USB_SUSPEND, it can be invoked with sysfs.)
    
      - Root hub suspend is a lot more careful, as is root hub resume.
        Pending transactions are now shut down more consistently; and
        more registers are re-initialized on resume.
    
      - The PCI bus glue is now left with truly generic PCI stuff, plus
        some PMAC-specific stuff (which doesn't include irq disabling
        any more, hcd-0506 moves that up a level in the stack).
    
      - Remote wakeup support is basically working for the root hub.
        (given CONFIG_USB_SUSPEND to suspend devices and enable it).
    
      - Idle HCs will now automatically suspend themselves, and resume
        as necessary.  This saves a certain amount of power on most
        systems, and matches what UHCI has been doing for a while.
    
    The large size of this patch is mostly because of moving that
    root hub suspend/resume code out of the PCI-specific glue.

commit 12423061634ccfeee71d323b235cc4c981f9d624
Author: David Brownell <david-b@pacbell.net>
Date:   Tue May 11 01:57:51 2004 -0700

    [PATCH] USB: khubd turns port power back on after reset
    
    This goes with the OHCI anti-deadlock patch, and is what
    ensures that when a root hub loses power during suspend,
    khubd can turn port power back on so devices can enumerate.

commit ea2b2c103adfc696b665da1f10af940d39a2e25f
Author: David Brownell <david-b@pacbell.net>
Date:   Tue May 11 01:57:21 2004 -0700

    [PATCH] USB: OHCI cleanups
    
    This splits out a few obvious fixes, to help shrink a PM patch:
    
      - when the HC is quiescing, don't schedule any more EDs
        or re-activate any after unlink completion.
    
      - when the HC is suspended, don't access registers through
        sysfs either.
    
      - simplify locking and call for donelist processing

commit 2a3396705416ae35c9f2516cf72db645b7b60b16
Author: David Brownell <david-b@pacbell.net>
Date:   Tue May 11 01:56:50 2004 -0700

    [PATCH] USB: OHCI resume/reset stops deadlocking in PM code
    
    System-wide PM resume now happily deadlocks if one of the
    resuming devices tries to remove devices which vanished
    during the suspend(*).  IMO that's unreasonable both
    because devices can/do vanish, and because 2.4 didn't
    deadlock in those cases; but no patch to fix that has been
    merged.  The result is that ever since merging the "new" PM
    code, some OHCI-based systems deadlock on resume.
    
    So this patch handles the "lost power during resume" case
    differently:  it doesn't disconnect the root hub (or its
    children) directly.  Instead, it does part of that work
    immediately, and defers the rest to khubd:
    
      - add a "pending" list for live urbs, and use it after reset
        to abort pending URBs (and reclaim "live" EDs/TDs)
      - immediately mark all devices NOTATTACHED, so any operations
        on the devices before khubd handles the disconnects, including
        resume() callbacks, will fail
      - kick root hub so it can do the cleanup
    
    It also handles "fminterval" init/reinit a bit better, mostly
    to work better in some remote wakeup scenarios addressed in
    later patches:
    
       - save any initial value the boot firmware provided
       - use it during initialization (and eventually, remote wakeup)
    
    Other changes:
    
      - use better jiffies calculation for scheduled delays
      - the allocator does more of the one-time initialization
      - initialize hcd.can_wakeup according to boot firmware
      - move some inlines to the header
      - minor cleanups
    
    
    (*) http://marc.theaimsgroup.com/?l=linux-kernel&m=106606272103414&w=2
         reported against 2.6.0-test7.

commit ec0e35582cdb938b4086a8f3643932fab885df35
Author: Oliver Neukum <oliver@neukum.org>
Date:   Tue May 11 01:45:25 2004 -0700

    [PATCH] USB: fixes of assumptions about waitqueues
    
    quoting Linus:
    
    --
    > so there is no need to recheck the bit in do/while loop, because
    > there is no false wakeups now.
    
    You should never assume this. You should assume that there are _always_
    false wakeups.
    
    Why? Because Linux has always allowed people to leave wait-queues active,
    without being "atomic". For example, the tty read/write layer used to
    (still does?)  add itself on the wait-queue _once_, and then leave itself
    on the wait-queue while in a loop it does copies from/to user space.
    --
    
    Unfortunately, this means us. Here's the first fix. Comments?
    
      - make sure timeouts are observed even if somebody left us on a queue

commit 4808f141a8b359ea5cc29064cd2c1d4d44a8e159
Author: David Brownell <david-b@pacbell.net>
Date:   Tue May 11 01:41:37 2004 -0700

    [PATCH] USB: more functional HCD PCI PM glue
    
    This patch makes the usbcore PCI suspend/resume logic behave
    much better.  In particular:
    
      - Even HCs without PCI PM support will normally be able
        to support global suspend, saving power ... and will
        need to resume later.  Let them try to suspend; lots
        of not-that-old USB controllers don't have PM caps.
    
      - Saner order for the boilerplate PCI stuff.  It also
        explicitly disables the IRQ and DMA, which aren't
        available in D1/D2/D3 states anyway.
    
      - Uses pci_enable_wake() when the root hub supports
        remote wakeup.  Didn't fully work in one test setup;
        that controller's PME# was evidently ignored.  (Not
        enabled unless CONFIG_USB_SUSPEND.)
    
    It worked for me with brief tests with the current 2.6.6-rc
    uhci-hcd with one old UHCI; more extensive ones with various
    OHCIs (using patches which I'll post soonish); and not at all
    with EHCI (where PM hasn't ever worked).
    
    Those of you who've been having PM problems might find
    this helpful as-is, though I think that unless you're
    using UHCI you'll also need an HCD patch.
    
    - Dave

commit 3a6e35adc3a34f07117726e045a68f58b7904c8f
Author: Alan Stern <stern@rowland.harvard.edu>
Date:   Tue May 11 01:34:08 2004 -0700

    [PATCH] USB: Accept devices with funky interface/altsetting numbers
    
    Now that all the USB drivers have been audited, we can safely accept
    devices that have noncompliant numbering for their interfaces or
    altsettings.  This patch skips bad or duplicate descriptors, allows gaps
    in the numbering, accepts more or fewer interfaces than bNumInterfaces,
    and logs warnings describing all these things.  Also, the debugging log
    messages have been improved by David Brownell.
    
    This should please a sizeable group of users.

commit 9f579d55afcd9d09ad623814133b83b0b58297e8
Author: StÃ©phane Eranian <eranian@hpl.hp.com>
Date:   Tue May 11 01:33:48 2004 -0700

    [PATCH] ia64: perfmon dv serialization patch
    
    Add ia64_dv_serialize_*() macros to ia64_set_*br() calls to avoid DV warnings
    from the assembler (requires updated assembler).

commit 657dc0a00917cc5d26ce83f4ff6e56da73d89bcd
Author: David Brownell <david-b@pacbell.net>
Date:   Tue May 11 01:33:38 2004 -0700

    [PATCH] USB: EHCI power management updates
    
    This patch updates EHCI suspend/resume so that its essential
    components work on a few different implementations:
    
       - make root hub suspend/resume work
       - make remote wakeup work (given CONFIG_USB_SUSPEND patch)
       - separate root hub suspend/resume from PCI suspend/resume
       - say if controller supports remote wakeup (on this system)
       - sysfs register dump unavailable if controller is suspended
    
    Plus a handful of minor cleanups.  Please merge, along with the
    "hcd-0506.patch" I sent last week.
    
    Tested by modifying sysfs power/state files, since ACPI doesn't
    work on this system (so I can't test system suspend/resume):
    
      - For root hub(*) ... suspend/resume works, also remote wakeup
      - PCI controller ... suspend/resume works, remote wakeup
        signals PME# (according to "lspci -vv"), but that's ignored
        on my test sytem
    
    Regardless of whether USB was active, "echo 1 > /proc/acpi/sleep"
    produced a system that wouldn't resume, and the same result
    came from "echo standby > /sys/power/state".  So that's about
    as far as I can take this testing for now.
    
    - Dave
    
    (*) Doing this relies on the CONFIG_USB_SUSPEND patch.  Otherwise
         no USB devices respond to sysfs power/state updates.  The
         PCI suspend/resume is a superset of this.

commit 23601558f3956c8e4c7b085932018c9adcdd49db
Author: Alan Stern <stern@rowland.harvard.edu>
Date:   Tue May 11 01:33:09 2004 -0700

    [PATCH] USB Gadget: Fix file-storage gadget Request Sense length
    
    On Fri, 7 May 2004, kernel@metro.cx wrote:
    > Hi All,
    >
    > I don't know where else to report this, but I found a very very very
    > minor bug in the usb gadgets drivers, specifically the file_storage.c
    > mass storage driver.
    >
    > In the function do_request_sense(..) it says:
    >
    > buf[7] = 18 - 7;                        // Additional sense length
    >
    > Whereas (according to page 38 of the USB mass storage class, UFI command spec,
    > http://www.usb.org/developers/devclass_docs#approved) this clearly neads
    > to be equal to 10, not 11.
    >
    > I checked with the 2.6.5 source, it is still there. Hope someone will find this usefull, although most USB hosts seem to ignore length bits alltogether anyway....
    >
    > Koen Martens
    
    You are quite right; thank you for pointing this out.  Greg, please apply
    the patch below.

commit c0e1607acfab3b28b8834eb00a8ac42c7800c7e0
Author: Luiz Capitulino <lcapitulino@prefeitura.sp.gov.br>
Date:   Tue May 11 01:32:38 2004 -0700

    [PATCH] USB: fix media/dsbr100.c unused variable.
    
    drivers/usb/media/dsbr100.c: In function `usb_dsbr100_probe':
    drivers/usb/media/dsbr100.c:239: warning: unused variable `videodev'

commit 6e8c2276b03e2553faa9004de35b4f42d5930010
Author: Arjan van de Ven <arjanv@redhat.com>
Date:   Tue May 11 00:59:36 2004 -0700

    [PATCH] PCI crash with pciless box or pci=off workaround on Vaio's
    
    From: Alan Cox <alan@redhat.com>
    
    Reasoning
    
    
    - Earlier in boot if we find a PCI bus we set raw_pci_ops to the function
      table to use for PCI accesses.
    - When we enter this function we now check if we have such a method
    - If not then we know it will otherwise crash because the call sequence
      through the code goes
    
            pci_irq_init
            pirq_peer_trick
            pci_scan_bus_parented
            which always leads down into the device scan and a pci config access
                    via raw_pci_ops
    
      The moment the scan searches for a device it has to crash as it has no
      access methods.
    
    - The other case which does nothing but pci_fixup_irqs is a no-op with no
      PCI devices
    
    - THUS any situation that is changed by the raw_pci_ops check was
      previously an oops case anyway or did nothing anyway.
    
    
    Tested with pci=off and without

commit bc721a8805e148a6eb7deeed827d57169bff8e1e
Author: Herbert Xu <herbert@gondor.apana.org.au>
Date:   Tue May 11 00:54:19 2004 -0700

    [PATCH] acpiphp_glue.c oops fix
    
    It oopses during modprobe becasue the first load of acpiphp didn't clean up
    properly.

commit 86ff0b3fac1391591f992e26efabc1382b138bf6
Author: Luiz Capitulino <lcapitulino@prefeitura.sp.gov.br>
Date:   Tue May 11 00:50:43 2004 -0700

    [PATCH] PCI Hotplug: fix wrong var used in hotplug/shpchp_ctrl.c.
    
    Zhenmin's checker tool <zli4@cs.uiuc.edu> detected this:
    
     9. /drivers/pci/hotplug/shpchp_ctrl.c, Line 1575:
     err("%s: Failed to disable slot, error code(%d)\n", __FUNCTION__, rc);
    
     Maybe change to:
     err("%s: Failed to disable slot, error code(%d)\n", __FUNCTION__,
     retval);
    
     I think it is right because at line 1564, the slot is turned off, and
    in this line (1575) is checked the status to see if we got an error; if
    so, the error number is shown. This number is in 'retval', not in 'rc'
    ('rc' does have the return of configure_new_device()).
    
     The patch bellow fixes that:

commit 08c7b59b7d4dde564b1d4f1878b19b6c9af1867f
Author: Rolf Eike Beer <eike-hotplug@sf-tec.de>
Date:   Tue May 11 00:50:01 2004 -0700

    [PATCH] SHPC PCI Hotplug: fix cleanup_slots again...
    
    Am Donnerstag, 6. Mai 2004 02:48 schrieb Sy, Dely L:
    > On Fri, 30 Apr 2004 12:31:18 +0200, Rolf Eike Beer wrote:
    
    >> -
    >> -static int cleanup_slots (struct controller * ctrl)
    >> +static void cleanup_slots(const struct controller *ctrl)
    >> {
    >> -	struct slot *old_slot, *next_slot;
    >> +	struct slot *old_slot;
    >>
    >> 	old_slot = ctrl->slot;
    >> 	ctrl->slot = NULL;
    >>
    >> 	while (old_slot) {
    >> -		next_slot = old_slot->next;
    >> -		pci_hp_deregister (old_slot->hotplug_slot);
    >> -		kfree(old_slot->hotplug_slot->info);
    >> -		kfree(old_slot->hotplug_slot->name);
    >> -		kfree(old_slot->hotplug_slot);
    >> -		kfree(old_slot);
    >> -		old_slot = next_slot;
    >> +		pci_hp_deregister(old_slot->hotplug_slot);
    >> +		old_slot = old_slot->next;
    >>  	}
    >
    > The variable next_slot and its assignment should be kept, for once
    > pci_hp_deregister() is called and the release callback function, which
    > you added, may come in and clean up old_slot structure before the next
    > ptr is saved.  The code should be:
    >
    > static void cleanup_slots(const struct controller *ctrl)
    > {
    > 	struct slot *old_slot, *next_slot;
    >
    > 	old_slot = ctrl->slot;
    >  	ctrl->slot = NULL;
    >
    >  	while (old_slot) {
    > 		next_slot = old_slot->next;
    > 		pci_hp_deregister (old_slot->hotplug_slot);
    > 		old_slot = next_slot;
    >  	}
    > }
    
    Yes, good point. Greg, this patch makes does it. Please apply on top of the
    other stuff.

commit 3476911c598dcf59d234db7ad7260f37e1b9670b
Author: Rolf Eike Beer <eike-hotplug@sf-tec.de>
Date:   Tue May 11 00:46:07 2004 -0700

    [PATCH] PCI Express, SHPCHP: fix freeing wrong resources

commit 5b0b68ad18214b2a67105566ab00fe3055de1542
Author: Rolf Eike Beer <eike-hotplug@sf-tec.de>
Date:   Tue May 11 00:44:42 2004 -0700

    [PATCH] CompactPCI: remove two useless functions
    
    This 2 get_* functions do the same the hotplug core does if this functions
    would not be there. Kill Bil^H^H^Hem!
    
    Eike

commit d75debd299b8e6744728079afa2eb27cc6d12560
Author: Rolf Eike Beer <eike-hotplug@sf-tec.de>
Date:   Tue May 11 00:44:02 2004 -0700

    [PATCH] CompactPCI: remove slot_paranoia_check and get_slot
    
    slot_paranoia_check is only another kind of checking everything for NULL.
    Removing this leads to function get_slot is reduced to a simple cast, so this
    function can be killed also.
    
    Eike

commit 9bbb91f0fdaeb4a63860d735649175cf1c376884
Author: Rolf Eike Beer <eike-hotplug@sf-tec.de>
Date:   Tue May 11 00:43:25 2004 -0700

    [PATCH] CompactPCI: remove useless NULL checks
    
    If the "struct hotplug_slot *" parameter is ever NULL then something bogus is
    going on, we should not hide this bug by catching it. Also the name used in
    debug messages is fixed.
    
    Eike

commit 6ab00129f8aac45edf2ed53844f6b546f6751ccd
Author: Rolf Eike Beer <eike-hotplug@sf-tec.de>
Date:   Tue May 11 00:42:00 2004 -0700

    [PATCH] CompactPCI: use goto for error handling
    
    Convert cpci_hotplug_core.c::cpci_hp_register_bus to use goto for error
    handling.
    
    Eike

commit c1600f7cf0a30ab0c66e4ff80f03afd3c8f48141
Author: Rolf Eike Beer <eike-hotplug@sf-tec.de>
Date:   Tue May 11 00:40:08 2004 -0700

    [PATCH] CompactPCI: remove two useless checks
    
    This two checks are useless: cpci_hp_register_bus is only called from two
    places, one has constant arguments, the other one passes the module
    parameters which are checked for this condition on module load. And the bus
    argument of cpci_hp_unregister_bus can never be NULL, all functions calling
    this function use fields of the bus struct before so they will oops if it
    would ever be NULL.
    
    Eike

commit 7c39c06564d71106ea8661aeb0f691b7ff356a8d
Author: Rolf Eike Beer <eike-hotplug@sf-tec.de>
Date:   Tue May 11 00:39:27 2004 -0700

    [PATCH] CompactPCI: remove set_attention_status
    
    This one removes useless code and fixes the issue that the return code of
    set_attention_status for cpcihp is always 0 even if cpci_set_attention_status
    returns an error.
    
    Eike

commit de59104f89593e7fdb1f76e9f31ad3f9d0c0c6d8
Author: Hanna V. Linder <hannal@us.ibm.com>
Date:   Tue May 11 00:31:48 2004 -0700

    [PATCH] USB: Add class support to drivers/usb/misc/tiglusb.c

commit e15f75b5b12dcb5665475dd12f1745ecd8c7bc43
Author: Hanna V. Linder <hannal@us.ibm.com>
Date:   Tue May 11 00:31:21 2004 -0700

    [PATCH] Add class support to drivers/net/wan/cosa.c
    
    This patch adds sysfs class support to the Cosa driver. I have verified it
    compiles but do not have the hardware to test it. If someone could that
    would be helpful.

commit 0c8a2f9d08b1b6def97cfa6cdf47ac6d8507c0a6
Author: Jean Delvare <khali@linux-fr.org>
Date:   Mon May 10 23:46:12 2004 -0700

    [PATCH] I2C: Rename hardware monitoring I2C class
    
    Quoting myself:
    
    > Mmm, I once proposed that I2C_ADAP_CLASS_SMBUS would be better renamed
    > I2C_ADAP_CLASS_SENSORS (so I2C_CLASS_SENSORS now). What about that? I
    > think it would be great to embed that change into your patch, so that
    > the name changes only once.
    >
    > BTW, if HWMON is prefered to SENSORS, this is fine with me too, I
    > have no strong preference.
    
    Below is a patch that does that. I finally went for HWMON. Yes, it's
    big, but it's actually nothing more than
    s/I2C_CLASS_SMBUS/I2C_CLASS_HWMON/ (thanks perl -wip :)).

commit ebd5b5d9beecda589b770efac6bcc72ab792ac61
Author: Ronald S. Bultje <r.s.bultje@students.uu.nl>
Date:   Mon May 10 23:45:12 2004 -0700

    [PATCH] I2C: new i2c video decoder calls: saa7111 driver
    
    Attached patch implements the i2c calls in the saa7111 driver.
    
    The driver is still compatible with old behaviour, so the zr36067 driver
    (the original user of the saa7111 module) doesn't need any changes.  I'll
    probably gradually make everything use DECODER_INIT instead of 0 (that was
    a nice hack back then) somewhere later.
    
    Can I just remove '0' later on? Or are there official ABI rules for
    stable kernel versions?

commit 2afffbde3c122786493087cf68b13d7ad9f522f8
Author: Ronald S. Bultje <r.s.bultje@students.uu.nl>
Date:   Mon May 10 23:44:19 2004 -0700

    [PATCH] I2C: new i2c video decoder calls
    
    Attached patch adds three new calls to the i2c video decoder API.  The changes
    were requested by Michael (CC'ed) and approved by Gerd Knorr (v4l maintainer,
    CC'ed).
    
    Short explanation:
    
    * INIT is a general initialization call with optional initialization data.
      Reason for this is that several i2c decoders (or general: clients) are being
      used by several adapters (main drivers), and in some cases, one adapter
      simply needs different settings than the other, either because the adapter
      is completely different or because the card was reverse engineered in a way
      that doesn't allow multiple adapters to run using the same original
      initialization data.  Michael faces such a problem right now.  Both he and
      me lack time to properly sit together and work out the exact details or a
      proper way to merge.
    
    * VBI_BYPASS and GPIO set specific pins on the decoder.  This will be used
      in the saa7111 driver.  My driver (zr36067, original user of the saa7111
      driver) doesn't use any of this, but Michael's does.

commit 3e7123964369b3be32262d8b2df5da10e8af2c16
Author: Jean Delvare <khali@linux-fr.org>
Date:   Mon May 10 23:43:55 2004 -0700

    [PATCH] I2C: kill duplicate includes in i2c bus drivers
    
    Following a suggestion of Arthur Othieno, here is a trivial patch that
    kills duplicate inclusions of config.h in four i2c bus drivers.
    
    At first I was thinking of also removing inclusions of config.h wherever
    it doesn't seem to be necessary but Eugene doesn't seem to think it's a
    good idea. So I may give it a try later (in 2.7), but for now this
    simple patch will be enough.

commit 31c4141f53d272c501d5a71bf34a52301d60ab29
Author: Greg Kroah-Hartman <greg@kroah.com>
Date:   Mon May 10 23:32:24 2004 -0700

    Module attributes: fix build error if CONFIG_MODULE_UNLOAD=n
    
    Thanks to Andrew Morton for pointing this out to me.

commit e17b04753fcb5607a9f5633b29c789a85633c289
Author: David S. Miller <davem@nuts.davemloft.net>
Date:   Mon May 10 23:18:00 2004 -0700

    [SPARC64]: Export pci_domain_nr to modules.

commit efe46e510399ba7006ca5f941d744d534088e78b
Author: James Bottomley <jejb@mulgrave.(none)>
Date:   Tue May 11 01:16:45 2004 -0500

    Make st support the scsi_device timeout
    
    From: 	Brian King <brking@us.ibm.com>

commit 842b7fa8666ca735b048799f8b1f7ea95c70b71e
Author: Alan Cox <alan@redhat.com>
Date:   Tue May 11 00:33:58 2004 -0500

    [PATCH] PATCH: Do something about aacraid
    
    This is a fairly minimal fix for aacraid. It removes the happy cast
    pointers to u32 garbage in the 2.6 code and replaces it with the working
    2.4 equivalents. I've not backported any of the other changes from 2.4 to
    2.6 yet, and some things have gone which are good to be gone (eg the
    proc/scsi horror). There is a certain amount of white space noise caused
    by realigning with the 2.4 code so I could see what was going on.
    
    Tested on a dual opteron

commit e41b865af4a588e34b81de1b7af46aa6f18ef4ec
Author: David S. Miller <davem@nuts.davemloft.net>
Date:   Mon May 10 22:19:43 2004 -0700

    [SCHED]: Fix double slash in include directive.

commit 8d5c15b83b2c99c96bd1df2afb1be87ba084f84f
Author: Greg Kroah-Hartman <greg@kroah.com>
Date:   Mon May 10 21:34:29 2004 -0700

    USB: make functions static in usb drivers that should be
    
    Thanks to Tridge's findstatic.pl script for helping find these.

commit 86a15ee0335482eb714f157671462047fe56cb68
Merge: 74499d3... 78d1c35...
Author: Dave Jones <davej@delerium.codemonkey.org.uk>
Date:   Tue May 11 02:11:04 2004 +0100

    Merge delerium.codemonkey.org.uk:/mnt/nfs/neologic/bar/src/kernel/2.6/trees/bk-linus
    into delerium.codemonkey.org.uk:/mnt/nfs/neologic/bar/src/kernel/2.6/trees/cpufreq

commit 8d7f04124bc0b3b9758a6b1a27f9409ade0155f4
Author: Russell King <rmk@flint.arm.linux.org.uk>
Date:   Tue May 11 01:56:17 2004 +0100

    [SERIAL] Fix exit function pointer initialisers
    
    This wraps pointer initialisers to functions marked __devexit with
    __devexit_p.

commit 141baf80514374935d084c12f2f1e426e9cea5a0
Author: Geert Uytterhoeven <geert@linux-m68k.org>
Date:   Mon May 10 17:54:30 2004 -0700

    [PATCH] M68k superfluous whitespace
    
    M68k: Remove superfluous whitespace that hurts my eyes with `let
    c_space_errors=1' in vim. This includes correcting trailing whitespace and
    spaces in front of tabs. `diff -urNbB' shows no difference before/after.

commit 83afa5cb9ab916c639b0bb91e0448f10e2bc1bee
Author: Anton Altaparmakov <aia21@cantab.net>
Date:   Tue May 11 01:53:05 2004 +0100

    NTFS: Cleanup whitespace (trailing space removal, etc).

commit 75bfb49694d17f0b0111d923589efd3bfcac478c
Merge: 7ff4e12... ed59cb7...
Author: Anton Altaparmakov <aia21@cantab.net>
Date:   Tue May 11 01:22:46 2004 +0100

    Merge cantab.net:/home/src/bklinux-2.6
    into cantab.net:/home/src/ntfs-2.6

commit d75705b8f16620339e8768cd7652b6165e2c81ff
Author: Herbert Xu <herbert@gondor.apana.org.au>
Date:   Mon May 10 20:05:08 2004 -0400

    [sound/oss i810] fix deadlock in drain_dac
    
    This patch fixes a typo in a previous change that causes the driver
    to deadlock under SMP.

commit ee2dfaccf279c8dd72534eaf3d236d3e07fd8e10
Author: Herbert Xu <herbert@gondor.apana.org.au>
Date:   Mon May 10 20:04:09 2004 -0400

    [sound/oss i810] fix reads/writes % 4 != 0
    
    This patch removes another bogus chunk of code that breaks when
    the application does a partial write.
    
    In particular, a read/write of x bytes where x % 4 != 0 will loop forever.

commit 8cd3762c46971cf180c2cbdc53a80b8d4424f2f6
Author: Herbert Xu <herbert@gondor.apana.org.au>
Date:   Mon May 10 20:02:55 2004 -0400

    [sound/oss i810] fix drain_dac loop when signals_allowed==0
    
    This patch fixes another bug in the drain_dac wait loop when it is
    called with signals_allowed == 0.

commit 8fb892d48802abfdd082f00043d4c1c27b3c47f4
Author: Herbert Xu <herbert@gondor.apana.org.au>
Date:   Mon May 10 20:01:34 2004 -0400

    [sound/oss i810] remove divides on playback
    
    This patch removes a couple of divides on the playback path.

commit 011fba7bca5108e12613915f46e43a45eb0ae9ca
Author: Herbert Xu <herbert@gondor.apana.org.au>
Date:   Mon May 10 19:59:23 2004 -0400

    [sound/oss i810] fix OSS fragments
    
    This patch makes userfragsize do what it's meant to do: do not start
    DAC/ADC until a full fragment is available.

commit 37b57f6c246889f173c23c99aa3960a781a20d06
Author: Herbert Xu <herbert@gondor.apana.org.au>
Date:   Mon May 10 19:58:35 2004 -0400

    [sound/oss i810] fix playback SETTRIGGER
    
    This patch fixes SETTRIGGER with playback so that the LVI is always
    set and the DAC is always started.

commit 630eaf8f4a036555e2519223a0b7b243a532fac6
Author: Herbert Xu <herbert@gondor.apana.org.au>
Date:   Mon May 10 19:57:31 2004 -0400

    [sound/oss i810] fix partial DMA transfers
    
    This patch fixes a longstanding bug in this driver where partial fragments
    are fed to the hardware.  Worse yet, those fragments are then extended
    while the hardware is doing DMA transfers causing all sorts of problems.

commit 0b4c327778017b3710cc97ccb4665115e52539f1
Author: Herbert Xu <herbert@gondor.apana.org.au>
Date:   Mon May 10 19:56:34 2004 -0400

    [sound/oss i810] clean up with macros
    
    This patch adds a number macros to clean up the code.

commit f3347c3de3a702cc4fc23595f34031a71677e7e0
Author: Herbert Xu <herbert@gondor.apana.org.au>
Date:   Mon May 10 19:52:23 2004 -0400

    [sound/oss] remove bogus CIV_TO_LVI
    
    This patch removes a pair of bogus LVI assignments.  The explanation in
    the comment is wrong because the value of PCIB tells the hardware that
    the DMA buffer can be processed even if LVI == CIV.
    
    Setting LVI to CIV + 1 causes overruns when with short writes
    (something that vmware is very fond of).

commit 168616367afb06b1398b9ef971fb80175ea4c683
Author: Herbert Xu <herbert@gondor.apana.org.au>
Date:   Mon May 10 19:50:39 2004 -0400

    [sound/oss i810] fix race
    
    This patch fixes the value of swptr in case of an underrun/overrun.
    
    Overruns/underruns probably won't occur at all when the driver is
    fixed properly, but this doesn't hurt.

commit e026d85d9b6093cb79689d4410e7f2b36851a97d
Author: Herbert Xu <herbert@gondor.apana.org.au>
Date:   Mon May 10 19:48:33 2004 -0400

    [sound/oss i810] fix wait queue race in drain_dac
    
    This particular one fixes a textbook race condition in drain_dac
    that causes it to timeout when it shouldn't.

commit cd53caa13346f39567ff1572248764c0037ca213
Author: Ingo Molnar <mingo@elte.hu>
Date:   Mon May 10 19:05:10 2004 -0400

    [netdrvr dmfe] netpoll support

commit 2279a9da3e9b527f0062f2bcf3e5aefa0184b2ec
Author: Christoph Hellwig <hch@lst.de>
Date:   Mon May 10 19:05:01 2004 -0400

    [netdrvr gt961000eth] remove useless MOD_{INC,DEC}_USE_COUNT
    
    *grr* - this one slipped in after my last round of audits it seems.

commit c7e6e05298b24c52b117bd10f0709f401c524858
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon May 10 19:04:53 2004 -0400

    [PATCH] 8139too not running s3 suspend/resume pci fix
    
    From: "Adrian Yee" <brewt-linux-kernel@brewt.org>
    
    Having an 8139 based device in my notebook, I often switch between it and
    wireless.  The problem is that the 8139too driver does not save/restore the
    pci configuration of the card if the device isn't running.  This simple
    patch moves the save/restore code so that the code runs regardless of
    whether or not the device is running.
    
    I looked at other drivers and they all seem to do the same thing.  Is there
    a reason why this isn't done like in the patch?

commit 5c9526299875d4da4f5affd257478eac81d9166b
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon May 10 19:04:44 2004 -0400

    [PATCH] lance.c: fix for card with signature 0x52 0x49
    
    From: Vesselin Kostadiov <vesselin@alphawave.com.au>
    
    Problem: The lance.c driver did not work with my Racal Interlan EtherBlaster
    card.
    
    More info: I found that my card has a signature 0x52 0x49 that was not
    recognized by the driver.
    
    Explanation: Following your suggestion I created a static table with possible
    signatures, not too different from the table in ni65.c.  The updated code
    compares the first byte of the cards signature with the first byte of the
    signatures from the table.  It this succeeds then it reads the second byte and
    compares the whole signature with the values from the table.  This way the
    minimal I/O reads approach is maintained.
    
    Side effect: The previous version would missdetect cards with signatures 0x52
    0x57 and 0x57 0x44.  This has been fixed as well.

commit d6176eaeb09398ca698881cc95afb440149e2292
Author: Chris Wedgwood <cw@f00f.org>
Date:   Mon May 10 19:04:36 2004 -0400

    [PATCH] kill warning in r8169

commit 5684f290e073ee2581be49eb6b10ffdebd673d85
Author: Marcel Holtmann <marcel@holtmann.org>
Date:   Tue May 11 00:12:34 2004 +0200

    [Bluetooth] Use type of the parent socket
    
    The SELinux fixes for kernel sockets assume that we always use the type
    SOCK_SEQPACKET, but this must not be the truth. Give the sock->type
    as argument to sock_create_lite() and everything is correct for the new
    child socket.

commit c1ca0f910d901e21629a493e423c2e1974442c50
Author: Steve French <stevef@steveft21.ltcsamba>
Date:   Mon May 10 15:02:01 2004 -0500

    Update readme with new information on symlinks to Samba

commit 7cf130fda24acfb9ee38c11c2d277176ca366db1
Author: Marcel Holtmann <marcel@holtmann.org>
Date:   Mon May 10 21:25:27 2004 +0200

    [Bluetooth] Adapt changes for USB core altsettings
    
    The USB core has changed its way the interfaces and the altsettings are
    stored. The probe routines of the USB based Bluetooth drivers must be
    changed and in some cases they are simplified.
    
    Patch from Alan Stern <stern@rowland.harvard.edu>

commit f5174ca07e7aa761479370111c284980a869f4e6
Author: Marcel Holtmann <marcel@holtmann.org>
Date:   Mon May 10 21:11:34 2004 +0200

    [Bluetooth] Fix disconnect race on ISOC interface
    
    The hci_usb_disconnect() gets called recursively when SCO support
    is enabled and used. This causes sysfs_hash_and_remove() finally to
    dereference a NULL pointer.
    
    Noticed by Sebastian Schmidt <yath@yath.eu.org>

commit 3d29f7cb74c66bb60613f7c3d29a99d201995be3
Author: Jeff Garzik <jgarzik@redhat.com>
Date:   Mon May 10 14:12:24 2004 -0400

    [libata] Maintainer annotations
    
    In MAINTAINERS and in individual low-level drivers.

commit 8962c3151a145b5c60af3f9642e1fa072dae1a59
Author: Jeff Garzik <jgarzik@redhat.com>
Date:   Mon May 10 13:51:40 2004 -0400

    [libata] preparation for writeback caching support
    
    * bug fix: make sure 'nsect' member of struct ata_queued_cmd is
    initialized each time a cmd is re-used.  Only affects PIO data xfers,
    which nobody uses.
    * slightly change the way a device's flags are printed out.  currently
    the only flag is 'lba48', but soon 'wcache' will appear also.
    * add WB-cache-related constants and macros to linux/ata.h

commit 7e1bfc50c0a3b34c6553df1b8c8324e3b4a276f7
Merge: 3d29f7c... 4ea686b...
Author: Dmitry Torokhov <dtor_core@ameritech.net>
Date:   Mon May 10 12:50:00 2004 -0500

    Merge with Linus' tree

commit 47ee7f408dbff3b41e3d1d4fb0c2c95e06b7b448
Author: David Mosberger <davidm@tiger.hpl.hp.com>
Date:   Mon May 10 09:44:48 2004 -0700

    ia64: Minor changes to get a (mostly) clean compile with GCC pre-3.5.

commit c9b85512c1d6e30b60e6c9fbb9c49c93128ec72f
Author: David Mosberger <davidm@tiger.hpl.hp.com>
Date:   Mon May 10 08:48:57 2004 -0700

    ia64: Add support to the kernel unwinder for the ".save rp, r0" idiom.
    
    Based on patch by Keith Owens.

commit c5dac50105bc29a6cb3724fd88685510db5d3518
Merge: b7dca46... 113edc2...
Author: Steve French <stevef@steveft21.ltcsamba>
Date:   Mon May 10 08:51:27 2004 -0500

    Merge bk://cifs.bkbits.net/linux-2.5cifs
    into steveft21.ltcsamba:/usr/src/bk/linux-2.5cifs

commit 78d1c35b64bedf62fa8afbea3eb41961f46d3344
Author: Dave Jones <davej@redhat.com>
Date:   Mon May 10 14:02:16 2004 +0100

    [CPUFREQ] Warning fixes.
    On sparc64:
    
    drivers/cpufreq/cpufreq.c: In function `cpufreq_add_dev':
    drivers/cpufreq/cpufreq.c:394: warning: cast to pointer from integer of different size
    drivers/cpufreq/cpufreq.c: In function `handle_update':
    drivers/cpufreq/cpufreq.c:507: warning: cast from pointer to integer of different size

commit 482f33340f6d38b164783aca285c2e090e3f93da
Author: Len Brown <len.brown@intel.com>
Date:   Mon May 10 08:48:38 2004 -0400

    [ACPI] handle _CRS outside _PRS -- even when non-zero
    avoid sharing IRQ12
    http://bugzilla.kernel.org/show_bug.cgi?id=2665

commit 7ff4e12974bc23ca1ed39251e1797ed6e0714d9d
Author: Anton Altaparmakov <aia21@cantab.net>
Date:   Mon May 10 11:56:02 2004 +0100

    NTFS: 2.1.9 release - Fix two bugs in the decompression engine
          in handling of corner cases.

commit b404fc906a8b79f5d9902941bbfc98348e7646c5
Merge: e2b48fa... 3dc567d...
Author: Anton Altaparmakov <aia21@cantab.net>
Date:   Mon May 10 11:29:45 2004 +0100

    Merge cantab.net:/home/src/bklinux-2.6
    into cantab.net:/home/src/ntfs-2.6

commit 7fb76946991955b25cda94323c7cbc343936253e
Author: David Eger <eger@havoc.gtf.org>
Date:   Mon May 10 02:54:27 2004 -0700

    [PATCH] radeon: fix overlapping copyarea
    
    This fixes a corruption problem with overlapping copyarea()'s
    in the radeon driver.

commit 307b7297b8c6055aa8ff62424c74c7d8351cd093
Author: Paul Mackerras <paulus@samba.org>
Date:   Mon May 10 02:54:17 2004 -0700

    [PATCH] ppc64: extra barrier in I/O operations
    
    At the moment, on PPC64, the instruction we use for wmb() doesn't
    order cacheable stores vs. non-cacheable stores.  (It does order
    cacheable vs. cacheable and non-cacheable vs. non-cacheable.)  This
    causes problems in the sort of driver code that writes stuff into
    memory, does a wmb(), then a writel to the device to start a DMA
    operation to read the stuff it has just written to memory.
    
    This patch solves the problem by adding a sync instruction before the
    store in the write* and out* macros.  The sync is a full barrier that
    orders all loads and stores, cacheable or not.  The patch also moves
    the eieio instruction that we had after the store to before the load
    in the read* and in* macros.  With the sync before the store, we don't
    need an eieio as well in a sequence of stores, but we still need an
    eieio between a store and a load.
    
    I think it is better to do this than to turn wmb() into a full memory
    barrier (a sync instruction) because the full barrier is slow and
    isn't needed with the sync in the write*/out* macros.  This way,
    write*/out* are fully ordered with respect to preceding loads and
    stores, which is what driver writers expect, and we avoid penalizing
    users of wmb() who are only doing cacheable stores.

commit 9c152646f93057296a6f2ecc4043d301cb0bf619
Merge: 49e9c1c... 4c6b594...
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Mon May 10 02:35:59 2004 -0700

    Merge bk://drm.bkbits.net/drm-2.6
    into ppc970.osdl.org:/home/torvalds/v2.6/linux

commit 49e9c1cc774c65fcc5a1d8e5d493bac83e46d69e
Author: Matthew Wilcox <willy@debian.org>
Date:   Mon May 10 02:30:02 2004 -0700

    [PATCH] PA-RISC updates for 2.6.6
    
     - Split PA7300LC from PA7100LC (Matthew Wilcox)
     - Handle 32-bit firmware and 64-bit kernel at runtime (Ryan Bradetich)
     - Fix building in a separate tree (Matthew Wilcox)
     - Update defconfigs (Randolph Chung)
     - Make WCHAN work (Randolph Chung)
     - Initial support for SMP in 2.6 (Grant Grundler)
     - Use 8-byte PTEs on 32-bit kernels (James Bottomley)
     - Implement L2/L3 hybrid page tables for 64 bit kernels (James Bottomley)
     - Support 8TB of physical and virtual address space (James Bottomley)
     - Macro'ise the tlb miss handlers (James Bottomley)
     - Check the ptrace flags correctly in the syscall return path (Randolph Chung)
     - Eliminate many magic numbers (James Bottomley)
     - Work around linker bug in vmlinux.lds.S (James Bottomley)
     - Many cache flushing fixes (James Bottomley)
     - first baby step for PA8800 support (Grant Grundler)
     - Self-aligning spinlocks (Randolph Chung)

commit 10190153f5429ff2ad5cf141fca3eb713cb65fc1
Author: Geert Uytterhoeven <geert@linux-m68k.org>
Date:   Mon May 10 02:25:28 2004 -0700

    [PATCH] M68k missing <linux/compiler.h>
    
    M68k: <asm/virtconvert.h> needs include <linux/compiler.h> for
    __attribute_const__ (from Richard Zidlicky)

commit 714c146410267902d1a3970c00983b0355c019df
Author: Geert Uytterhoeven <geert@linux-m68k.org>
Date:   Mon May 10 02:25:18 2004 -0700

    [PATCH] Sun3x dummycon
    
    Sun3x: Like most other platforms, Sun3x needs conswitchp set if
    CONFIG_DUMMY_CONSOLE is defined (from Sam Creasey)

commit 2a8941cffc453714065bc193e10d3501dc50f6e0
Merge: a49b915... 1e27958...
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Mon May 10 02:24:30 2004 -0700

    Merge bk://gkernel.bkbits.net/libata-2.6
    into ppc970.osdl.org:/home/torvalds/v2.6/linux

commit a49b91549dc01492437f2b04f9049e4d81df5cf3
Merge: fec9541... 6b5501e...
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Mon May 10 02:20:06 2004 -0700

    Merge bk://gkernel.bkbits.net/net-drivers-2.6
    into ppc970.osdl.org:/home/torvalds/v2.6/linux

commit 6b5501ef12694b72f1890318c25ad1b11f46b2e6
Merge: bcb15a2... 7b29c58...
Author: Jeff Garzik <jgarzik@redhat.com>
Date:   Mon May 10 05:15:32 2004 -0400

    Merge redhat.com:/spare/repo/netdev-2.6/pcnet32
    into redhat.com:/spare/repo/net-drivers-2.6

commit bcb15a27569b9ec46ee5eb9abb3e6fb1cc38f50c
Merge: 7c70330... 511fec9...
Author: Jeff Garzik <jgarzik@redhat.com>
Date:   Mon May 10 05:13:59 2004 -0400

    Merge redhat.com:/spare/repo/netdev-2.6/b44
    into redhat.com:/spare/repo/net-drivers-2.6

commit fec95414a1bf1939b1b22ceca6b033be7ccb2d1d
Author: Alexander Viro <viro@parcelfarce.linux.theplanet.co.uk>
Date:   Mon May 10 02:13:18 2004 -0700

    [PATCH] ntfs cleanup
    
    	ntfs_fill_super() and ntfs_read_inode_mount() cleaned up.  Removed
    the kludges around the first iget() on NTFS.  Instead of playing with
    (re)setting ->s_op we have the MFT_FILE inode set up by explicit new_inode()/
    set ->i_ino/insert_inode_hash()/call ntfs_read_inode_mount() directly.
    That kills the need of second super_operations and it allows to return
    error from ntfs_read_inode_mount() without resorting to ugly "poisoning"
    tricks.

commit 7c70330c458cb47e11fb92abe733d03a2b430445
Merge: 3dc567d... 4ee76fa...
Author: Jeff Garzik <jgarzik@redhat.com>
Date:   Mon May 10 05:12:01 2004 -0400

    Merge redhat.com:/spare/repo/netdev-2.6/8139too
    into redhat.com:/spare/repo/net-drivers-2.6

commit 1ce351789ad5ea21ff9a9d451cc3b3e292cce425
Merge: c8c391f... 50f61b5...
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Mon May 10 02:10:46 2004 -0700

    Merge bk://linux-scsi.bkbits.net/scsi-for-linus-2.6
    into ppc970.osdl.org:/home/torvalds/v2.6/linux

commit 50f61b559714162907ab34467efefb1884385300
Author: James Bottomley <jejb@mulgrave.(none)>
Date:   Mon May 10 07:29:29 2004 -0500

    qla2100 fabric fixes
    
    From: "Andrew Vasquez" <andrew.vasquez@qlogic.com>
    
    Ok, well there aren't too many folks using an QLA2100 in a fabric
    topology, if there were, they wouldn't have gotten very far in the
    driver load sequence.  I've been able to scrape-up a QLA2100, 1Gig
    switch, and an JBOD.  Upon loading the 8.00.00b12k driver, the
    firmware successfully logs into the switch, the driver receives a
    LOOP_UP event, but, the kernel panics due to NULL pointer dereference
    while trying to perform an RFT_ID  -- the attached patch against
    current scsi-misc-2.6 fixes that problem.

commit d512a35f5faf94f02532ad28bd6aadd40113f24e
Author: James Bottomley <james.bottomley@steeleye.com>
Date:   Mon May 10 06:40:22 2004 -0500

    [PATCH] fix LLD module refcounting in sr.c
    
    The patch to close all the open/close/hotplug races in sr left the
    module refcounting broken so that the ULD housing the CD device now
    can't be removed until the device itself is removed.
    
    This patch (structurally identical to the one for sd.c to perform the
    same function) fixes the module refcounting.

commit da2a5d68adc54aa88f8737c0e962354a4cc3b495
Author: Mark Haverkamp <markh@osdl.org>
Date:   Mon May 10 05:38:00 2004 -0500

    [PATCH] aacraid reset handler fix
    
    This fixes a situation where the handler can exit too early.

commit c8c391f74a7375e88dc29083d7ba994a727a87cc
Merge: 75bfb49... 2c1394f...
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Mon May 10 02:09:18 2004 -0700

    Merge http://jfs.bkbits.net/linux-2.5
    into ppc970.osdl.org:/home/torvalds/v2.6/linux

commit f1b91e206a0712853b481f6fde5b27078432e794
Author: Jeff Garzik <jgarzik@redhat.com>
Date:   Mon May 10 05:08:44 2004 -0400

    [netdrvr tg3] netdev_priv

commit 1e279587e49c289fdbe243eea3270bf40b967436
Merge: 3dc567d... fb75e28...
Author: Jeff Garzik <jgarzik@redhat.com>
Date:   Mon May 10 04:26:26 2004 -0400

    Merge redhat.com:/spare/repo/linux-2.6
    into redhat.com:/spare/repo/libata-2.6

commit bf68a9e818910b440a6fe9cbe2292d6da5e1c44a
Author: James Bottomley <jejb@mulgrave.(none)>
Date:   Mon May 10 03:17:31 2004 -0500

    Add SCSI IPR PCI Ids to pci_ids.h

commit ed59cb75e3538b32d3faf142f967710bc72eadc0
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon May 10 00:25:52 2004 -0700

    [PATCH] get_thread_area macro fixes
    
    From: Adam Lackorzynski <adam@os.inf.tu-dresden.de>
    
    one of the macros for get_thread_area extracts the wrong bit.  The
    "32bit" field is in bit 22, not 23 (as can be seen in desc.h).
    
    [ Fix ia64/x86-64 too, while we're at it. Linus ]

commit 5034465f47fdb6bd0b12287531130808089ae276
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon May 10 00:25:41 2004 -0700

    [PATCH] Add SMT setup for domain scheduler on x86-64
    
    From: Andi Kleen <ak@muc.de>
    
    Set up SMT for the domain scheduler on x86-64.  This way the scheduling
    works better on HyperThreading aware systems; in particular it will use
    both physical CPUs before sharing two virtual CPUs on the same package.
    This improves performance considerably in some cases.
    
    Based on the i386 code and a previous patch from Suresh B. Siddha.

commit b5c58730e2f07831ca9d6083fc0c9c14c26b783e
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon May 10 00:25:30 2004 -0700

    [PATCH] x86-64: convert sibling map to masks
    
    From: Andi Kleen <ak@muc.de>
    
    From: Suresh B. Siddha
    
    Convert sibling map on x86-64 to cpumasks.
    
    This is needed for the SMT patches.

commit d03480a13bca96ea49e7617b27bb3660c4a4041a
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Mon May 10 00:14:39 2004 -0700

    Remove intermezzo, per instructions from Peter Braam.

commit b188bcdaf2371377ffd214ebff600ec9ce213131
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon May 10 00:12:21 2004 -0700

    [PATCH] Fix __down Tainting Kernel with CONFIG_MODVERSIONS=y
    
    From: Rusty Russell <rusty@rustcorp.com.au>
    
    PowerPC64 ABI has ".funcname" (the actual function) and "funcname" (the
    function descriptor) and we strip off the dots in "dedotify" called from
    module_frob_arch_sections().  We need to also de-dotify the corresponding
    names in the __version section.
    
    Actually has nothing to do with __down, it's just that we only print the
    first symbol whose version is missing.

commit 5a3e24460a33b9ed41fc7089aea6c7e0a6dfe4e6
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon May 10 00:12:10 2004 -0700

    [PATCH] PPC termio fix
    
    From: Paul Mackerras <paulus@samba.org>
    
    It turns out that we are not handling the TABDLY bits of the termios
    c_oflag field correctly on PPC, PPC64 and Alpha.  These three architectures
    have a value for XTABS that is different from the TAB3 value.  POSIX
    specifies that setting the TABDLY field to TAB3 should result in tabs being
    expanded to spaces.  In n_tty.c:opost() we check for O_TABDLY(tty) ==
    XTABS, which is fine on most architectures because they have XTABS == TAB3.
    
    I think the right thing to do is just to change the definition of XTABS to
    be the same as TAB3 on these architectures.  The patch below does this for
    PPC and PPC64 (and I suggest the Alpha maintainer should do the same).  At
    the moment, applications using either the XTABS or TAB3 values won't get
    the expected behaviour.  With this patch, apps that use TAB3 will get the
    expected behaviour.  Apps that use XTABS will need to be recompiled (but
    note that the POSIX-specified name to use is TAB3 not XTABS).

commit ffaffb06e119b3e6573614eaa54cf4d9832424e6
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon May 10 00:12:00 2004 -0700

    [PATCH] remove intermezzo
    
    Peter Braam said:
    
        I would just like to say that I have no difficulties with intermezzo
        being rm -rf'd.  There are probably only a handful of users.
    
        In the past 4 years nobody has supported InterMezzo sufficiently for
        it to become successful.  I have been fortunate to get really good support
        for the Lustre project.  So I have focussed on that.  Lustre 1.X has
        become really solid.
    
        The disconnected operation, caching and mirroring functionality of
        InterMezzo will become available in Lustre as a new feature in version 2.
    
         So I see no point in keeping InterMezzo if it is a nuisance.
    
    
    The patch removes the references to intermezzo.  Please do a `bk rm' of
    fs/intermezzo.

commit 9f15b9721307e57826e25cfe146986d39306c261
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon May 10 00:11:49 2004 -0700

    [PATCH] make tags for selinux
    
    From: Olaf Hering <olh@suse.de>
    
    make tags skips security/selinux/include because of find .  -name include
    -prune This patch does just add it later.  No idea if it can be done
    better.

commit 10f2b6f5fc750ddb64700c4c54571efcd295c18c
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon May 10 00:11:38 2004 -0700

    [PATCH] fix some typos in sound docs
    
    From: Christoph Hellwig <hch@lst.de>
    
    (partially from the debian kernel tree)

commit 8b1d1b1c274bd0dd484b494f3ec47314c1f1550c
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon May 10 00:11:28 2004 -0700

    [PATCH] telephony/ixj.h: remove kernel 2.2 #ifdef's
    
    From: Adrian Bunk <bunk@fs.tum.de>
    
    The patch below removes two #ifdef's for kernel 2.2 from
    linux-2.6.2-mm1/drivers/telephony/ixj.h

commit 8b2e10d792fcb87cb14f014dd489e98288c2f0a0
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon May 10 00:11:17 2004 -0700

    [PATCH] remove kernel 2.2 code from drivers/net/hamradio/dmascc.c
    
    From: Adrian Bunk <bunk@fs.tum.de>
    
    The patch below removes some #ifdef'd kernel 2.2 code from
    drivers/net/hamradio/dmascc.c.

commit 2e16180e6c3d71aeafce986a87c6f62c9128f7c8
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon May 10 00:11:07 2004 -0700

    [PATCH] Crystal cs4235 mixer fix
    
    From: Joseph Parmelee <jparmele@wildbear.com>
    
    Fixes improper setup of the mixer on Crystal soundcards with the CS4235
    chip.

commit 8848944ce23f47d27331efe8bc7ba10167835683
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon May 10 00:10:56 2004 -0700

    [PATCH] export con_set_default_unimap()
    
    fbcon needs this symbol.

commit b081d0feb160ad4aca8a00dcd443cf0dd07ec680
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon May 10 00:10:46 2004 -0700

    [PATCH] Make usermodehelper_init() use core_initcall()
    
    We may as well make usermodehelper_init() core_initcall as well, to make
    sure its services are avaialble to all the other initcall levels.

commit 3d207d0b867e568f4f6cf31c40ae1b446a493ae0
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon May 10 00:10:35 2004 -0700

    [PATCH] use core_initcall for binfmt initialisation
    
    We need to register the binfmts earlier, so normal initcalls can successfully
    run call_usermodehelper() to execute things.

commit 782a67476f0bee898202ff0b37a964dc4237c305
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon May 10 00:10:24 2004 -0700

    [PATCH] minor RCU optimization
    
    From: Stephen Hemminger <shemminger@osdl.org>
    
    Minor tweak to rcu, use __list_splice instead of list_splice because the
      list has already been checked for empty.

commit 414f345576672dd0bdf28795cd0abc61c8169d26
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon May 10 00:10:14 2004 -0700

    [PATCH] remove MOD_INC_USE_COUNT usage in arch/um/drivers/harddog_kern.c
    
    From: Christoph Hellwig <hch@lst.de>
    
    ->open already has a reference so use __module_get.  The file has no
    maintainer noted in it, all credits are from the driver it's copied from.

commit d03500e86e18e76b91077d655683ff8e74ae30d3
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon May 10 00:10:03 2004 -0700

    [PATCH] fix MOD_INC_USE_COUNT usage in mtd
    
    From: Christoph Hellwig <hch@lst.de>
    
    mtd driver need to get another reference if ->probe succeeds (strange design
    if you ask me, but what the heck..), and while most drivers have been switched
    to __module_get already two are still missing.

commit 655d81830635e913089158ef7dadf19958558c9c
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon May 10 00:09:53 2004 -0700

    [PATCH] drivers/video/* MOD_INC_USE_COUNT fixes
    
    From: Christoph Hellwig <hch@lst.de>
    
    A bunch of framebuffer drivers use MOD_INC_USE_COUNT to prevent themselves
    from unloading completely - but we have a much easier way to do so, that is
    simply removing the module_exit/cleanup_module handler.

commit de664d0ca13368141b3b0184ef3fe49a17332933
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon May 10 00:09:42 2004 -0700

    [PATCH] fix MOD_{INC,DEC}_USE_COUNT gunk in arch/um/drivers/net_kern.c
    
    From: Christoph Hellwig <hch@lst.de>
    
    Well, UML is pretty out of date in mainline, but I'd like to squash the last
    users of said beasts rather sooner than later.

commit 05347c797920bfdbda06782cf17d9bc24d5229de
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon May 10 00:09:31 2004 -0700

    [PATCH] kill MOD_{INC,DEC}_USE_COUNT gunk in arch/cris/arch-v10/drivers/pcf8563.c
    
    From: Christoph Hellwig <hch@lst.de>
    
    Driver already sets fops->owner so the open/close methods are entirely
    superflous.

commit 8e512539331cb5ec33155c88c8a9ef42c96417c8
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon May 10 00:09:21 2004 -0700

    [PATCH] kill useless MOD_{INC,DEC}_USE_COUNT in sound/oss/msnd.c
    
    From: Christoph Hellwig <hch@lst.de>
    
    Callers are exported register/unregister handlers so the module is locked in
    core by users of said exports.

commit 3dfae7182806e15028fe3e5f50584921559aaeba
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon May 10 00:09:10 2004 -0700

    [PATCH] cpqarray update for 2.6
    
    From: <mikem@beardog.cca.cpqcorp.net>
    
    This patch fixes 2 minor issues that break our Array Configuration utility.
     my_io was changed to a pointer so the & had to removed when using it with
    copy_to_user().
    
    Sometime in 2.5 SG_MAX got changed to 31.  Maybe to copy cciss?  Now I'm
    changing it back to 32 so our app can work.

commit cd053a9451232999d2284e2ff23e94a5047e9c70
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon May 10 00:09:00 2004 -0700

    [PATCH] Add sysctl to define a hugetlb-capable group
    
    From: "Chen, Kenneth W" <kenneth.w.chen@intel.com>,
          "Seth, Rohit" <rohit.seth@intel.com>
    
    This patch addresses the longstanding problem wherein Oracle needs
    CAP_IPC_LOCK to allocate SHM_HUGETLB shm memory, but people don't want to run
    Oracle as root, and capabilties are busted.
    
    Various ideas with rlimits didn't work out, mainly because these objects live
    beyond the lifetime of the user processes which establish them.
    
    What we do is to create root-writeable /proc/sys/vm/hugetlb_shm_group which
    specifies a single group ID.  Users who belong to that group may allocate
    hugepages for SHM_HUGETLB shm segments.
    
    So the sysadmin will greate a new group, say `hugepageusers', will add the
    oracle user to that group and will write that group's ID into
    /proc/sys/vm/hugetlb_shm_group.

commit 9008d35b80e72edc52a2f3d64cefe4e2ee858329
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon May 10 00:08:49 2004 -0700

    [PATCH] hugepage: fix add_to_page_cache() error handling
    
    From: David Gibson <david@gibson.dropbear.id.au>
    
    add_to_page_cache() locks the given page if and only if it suceeds.  The
    hugepage code (every arch), however, does an unlock_page() after
    add_to_page_cache() before checking the return code, which could trip the
    BUG() in unlock_page() if add_to_page_cache() failed.
    
    In practice we've never hit this bug, because the only ways
    add_to_page_cache() can fail are when we fail to allocate a radix tree node
    (very rare), or when there is already a page at that offset in the radix
    tree, which never happens during prefault, obviously.  We should probably
    fix it anyway, though.
    
    The analagous bug in some of the patches floating about to
    demand-allocation of hugepages is more of a problem, because multiple
    processes can race to instantiate a particular page in the radix tree -
    that's been hit at least once (which is how I found this).

commit d755344394bdf8304e563f46479687c37aec1716
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon May 10 00:08:38 2004 -0700

    [PATCH] fix wrong var used in hotplug/shpchp_ctrl.c.
    
    From: "Luiz Fernando N. Capitulino" <lcapitulino@prefeitura.sp.gov.br>
    
    Zhenmin's checker tool <zli4@cs.uiuc.edu> detected this:
    
     9. /drivers/pci/hotplug/shpchp_ctrl.c, Line 1575:
     err("%s: Failed to disable slot, error code(%d)\n", __FUNCTION__, rc);
    
     Maybe change to:
     err("%s: Failed to disable slot, error code(%d)\n", __FUNCTION__,
     retval);
    
    I think it is right because at line 1564, the slot is turned off, and in
    this line (1575) is checked the status to see if we got an error; if so,
    the error number is shown.  This number is in 'retval', not in 'rc' ('rc'
    does have the return of configure_new_device()).

commit 0610d50cf38c0c7440809dee57fc60de06b5f712
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon May 10 00:08:27 2004 -0700

    [PATCH] Lindent arch/i386/kernel/cpuid.c
    
    From: Hanna Linder <hannal@us.ibm.com>
    
    Per Greg's request this is a patch of having run Lindent on cpuid.c.  The
    tabs were not the right number of spaces before.  I have verified it still
    compiles and boots with this "change".

commit b5c644118a164f2d33b97361a670bfd2a74fbc8c
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon May 10 00:08:17 2004 -0700

    [PATCH] pcmcia/tcic.c warning fix.
    
    From: "Luiz Fernando N. Capitulino" <lcapitulino@prefeitura.sp.gov.br>
    
    drivers/pcmcia/tcic.c:63: warning: `version' defined but not used

commit 7a49740aa75a5e944dc6de20d41c23b44eac09a4
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon May 10 00:08:06 2004 -0700

    [PATCH] as-iosched barrier fix
    
    From: Jens Axboe <axboe@suse.de>
    
    AS does not correctly account requests inserted with INSERT_FRONT or
    INSERT_BACK, barriers for example.  In other elevators, requeued requests also
    go through the insert path, but AS has its own requeue handler which means the
    code has never been tested.
    
    Also, make inserting a barrier with INSERT_SORT imply INSERT_BACK, which is
    the logical behaviour.  Previously such insertions weren't rigorously defined.

commit e829d2e492297d143e016d1cca2c8b7a79e8d4ea
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon May 10 00:07:55 2004 -0700

    [PATCH] Fix race on tty close
    
    From: Benjamin Herrenschmidt <benh@kernel.crashing.org>
    
    ldisc close can race with the flush_to_ldisc workqueue.
    
    This patch fixes it by killing the workqueue first.

commit 19e12876bc6e9be123def8132559a497101fd5e1
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon May 10 00:07:45 2004 -0700

    [PATCH] SElinux interface for reporting size of printk buffer
    
    From: Olaf Dabrunz <od@suse.de>
    
    Add the necessary hooks so that a SELinux-enabled kernel will allow the new
    "report the size of the printk buffer" query to work.

commit 110eecfb33d49f8265cfdcf228926d7791154ba1
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon May 10 00:07:34 2004 -0700

    [PATCH] blk: cache queue_congestion_on/off_threshold values
    
    From: "Chen, Kenneth W" <kenneth.w.chen@intel.com>
    
    It's kind of redundant that queue_congestion_on/off_threshold gets
    calculated on every I/O and they produce the same number over and over
    again unless q->nr_requests gets changed (which is probably a very rare
    event).  We can cache those values in the request_queue structure.

commit bbfbb758549492a97063bdca22a4df8d2ee5fae9
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon May 10 00:07:23 2004 -0700

    [PATCH] swsusp documentation updates
    
    From: Pavel Machek <pavel@ucw.cz>

commit b3f8802cea1b1f94b7e9ebefdfb7b46d61f4ebc0
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon May 10 00:07:13 2004 -0700

    [PATCH] simplify mqueue_inode_info->messages allocation
    
    From: Chris Wright <chrisw@osdl.org>
    
    Currently, if a user creates an mqueue and passes an mq_attr, the
    info->messages will be created twice (and the extra one is properly freed).
    This patch simply delays the allocation so that it only ever happens once.
    The relevant mq_attr data is passed to lower levels via the dentry->d_fsdata
    fs private data.  This also helps isolate the areas we'd need to touch to do
    rlimits on mqueues.

commit e37a41af9af3ad002f33d2602ac4f355ff956790
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon May 10 00:07:02 2004 -0700

    [PATCH] bfs filesystem read past the end of dir
    
    From: Jakub Jermar <jermar@itbs.cz>
    
    I found out that BFS filesystem will eventually try to read and interpret
    garbage past the end of directory in bfs_add_entry().  If the garbage
    (interpreted as i-node number) is not set to zero (does it have to be?)
    bfs_add_entry() will consider it a regular directory entry.
    
    This causes weird things like this:
    # touch a
    # rm a
    # ls
    # touch b
    # ls
    a
    
    My patch detects an attempt to read past the end of directory and explicitly
    clears the garbage that represents i-node number.  Thus the correct behaviour
    is achieved.
    
    (was unable to contact Tigran)

commit 28d627fb4572b378063f58dd533487bdb1ca67a6
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon May 10 00:06:52 2004 -0700

    [PATCH] update Documentation/md.txt
    
    From: <spam@altium.nl> (Dick Streefland)
    
    The following patch documents the currently undocumented raid= kernel
    parameter.

commit 9828805c649d2753c7e83e5ac55d0c4156719cca
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon May 10 00:06:42 2004 -0700

    [PATCH] es7000 subarch update for generic arch
    
    From: "Protasevich, Natalie" <Natalie.Protasevich@UNISYS.com>
    
    This is ES7000 sub architecture update.  It makes ES7000 a part of the
    generic architecture, so the single compiled kernel will be able to choose
    a correct set of parameters, routines ("genapic"), and a boot path.  It
    uses criteria provided by the subarch for platform identification.  In case
    of ES7000, it is a unique product/vendor string in the ACPI/MP OEM table,
    and server control registers.  The patch is confined to only es7000 subarch
    and generic subarch.  It was tested on ES7000 as well as generic Intel 8x
    Xeon system.  Andi Kleen has reviewed the changes.

commit 1dd5cc779345b9dd2e3e139c08c1c3b988482526
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon May 10 00:05:51 2004 -0700

    [PATCH] CLOCK_TICK_RATE: use CLOCK_TICK_RATE
    
    From: Thorsten Kranzkowski <dl8bcu@dl8bcu.de>
    
    use CLOCK_TICK_RATE where 1193180 was used in general timing calculations.
    (optional)

commit 521616213d818c4cea56983441d43f994d45ca59
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon May 10 00:05:40 2004 -0700

    [PATCH] CLOCK_TICK_RATE: use PIT_TICK_RATE in *spkr.c
    
    From: Thorsten Kranzkowski <dl8bcu@dl8bcu.de>

commit 80c44e4208c06c444e772e2a78a39d3715675446
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon May 10 00:05:29 2004 -0700

    [PATCH] CLOCK_TICK_RATE: introduce asm-*/8253pit.h, #define PIT_TICK_RATE constant.
    
    From: Thorsten Kranzkowski <dl8bcu@dl8bcu.de>
    
    The calculation of the counter values in drivers/input/misc/pcspkr.c is
    incorrectly based on CLOCK_TICK_RATE.  This goes unnoticed in i386 because
    there the system clock is driven by the same Programmable Interval Timer chip
    as the speaker.  But this doesn't hold true on other archs, e.g.  Alpha.
    
    To solve this problem I made these patches:
    
    1/3:    introduce asm-*/8253pit.h, #define PIT_TICK_RATE constant.
            It seems this is not always the same value.
    2/3:    use PIT_TICK_RATE in *spkr.c
    3/3:    use CLOCK_TICK_RATE where 1193180 was used in general timing
            calculations. (optional)
    
    There are still some places where the magic number is used instead of the
    #define (vt_ioctl.c, gameport.c) but I left them as-is.  I got some responses
    from arch maintainers to specifically not touch their respective architectures
    so changing these places would mean breakage for them.
    
    Tested on Alpha and i386, ack'ed by Ralf Baechle for MIPS.
    
    
    This patch:
    
    introduce asm-*/8253pit.h, #define PIT_TICK_RATE constant.

commit 2a12ed0ef2685626ad90736243747c9167535d82
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon May 10 00:05:18 2004 -0700

    [PATCH] readahead: keep file->f_ra sane
    
    When two threads are simultaneously pread()ing from the same fd (which is a
    legitimate thing to do), the readahead code thinks that a huge amount of
    seeking is happening and shrinks the window, damaging performance a lot.
    
    I don't see a sane way to avoid this within the readahead code, so take a
    private copy of the readahead state and restore it prior to returning from the
    read.

commit 6096781056dd1af176317798bbdafcd8c8c8a282
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon May 10 00:05:07 2004 -0700

    [PATCH] jiffies-to-clockt fix
    
    From: john stultz <johnstul@us.ibm.com>
    
    This patch polishes up Tim Schmielau's (tim@physik3.uni-rostock.de) fix for
    jiffies_to_clock_t() and jiffies_64_to_clock_t().  The issues observed was
    w/ /proc output not matching up to wall time due to accumulated error
    caused by HZ not being exactly 1000 on i386 systems.  The solution is to
    correct that error by using the more accurate TICK_NSEC in our calculation.
    
    Additionally, this patch corrects 3 warnings in the TCP layer uncovered by
    this change.

commit c2e4874972469af0a794a3898ed6948394514d94
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon May 10 00:04:56 2004 -0700

    [PATCH] cyclades cleanups
    
    From: Marcelo Tosatti <marcelo.tosatti@cyclades.com>
    
    - cleanups for cyclades Kconfig entry	(Adrian Bunk/me)
    - janitors project: remove dead function	(Don Koch)
    
    From: aris@cathedrallabs.org (Aristeu Sergio Rozanski Filho)
    
    	Use the standard min/max macros

commit 15e5643c53226181e6c8e826e4737250f1498fcc
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon May 10 00:04:46 2004 -0700

    [PATCH] fix ramdisk size assembler warning
    
    From: Jorn Engel <joern@wohnheim.fh-wedel.de>
    
     AS	arch/i386/boot/setup.o
    /usr/src/linux-2.6.5/arch/i386/boot/setup.S: Assembler messages:
    /usr/src/linux-2.6.5/arch/i386/boot/setup.S:159: Warning: value 0x37ffffff truncated to 0x37ffffff
    
    The warning is correct, the calculated value for ramdisk_max would be
    0xb7ffffff instead of 0x37ffffff.  Truncating 0xb7ffffff to 0x37ffffff
    is desired behaviour, so we should do it explicitly.

commit 53fbd0b0cf1be3b6b122a1446a9277368398f3cf
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon May 10 00:04:36 2004 -0700

    [PATCH] ppc64: use generic ipc syscall translation
    
    From: David Gibson <david@gibson.dropbear.id.au>
    
    Currently ppc64 has its own code to convert 32-bit ipc() syscalls to 64-bit,
    rather than using the common translation code from ipc/compat.c.  This patch,
    tweaked slightly from an earlier version of Anton Blanchard's fixes that,
    replacing the ppc64 code with calls to the common code.
    
    I've run the LSB IPC tests, and as many of the LTP IPC tests as I could figure
    out how to run easily, and it seems to pass them all.

commit bf434bf2dc9f2b88a7ae47ffa54996240004199f
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon May 10 00:04:25 2004 -0700

    [PATCH] gcc-3.4.0 fixes for 2.6.6-rc3 x86_64 kernel
    
    From: Mikael Pettersson <mikpe@csd.uu.se>
    
    Here are some patches to fix compilation warnings from
    gcc-3.4.0 in the 2.6.6-rc3 x86_64 kernel.
    
    - puts() type conflict in boot/compressed/misc.c:
      rename to putstr(), just like i386 did
    - cast-as-lvalue in ia32_copy_siginfo_from_user():
      use temporary
    - code before declaration in io_apic.c:
      move decl up
    - code before declaration in ioremap.c:
      move existing #ifndef up
    - cast-as-lvalue (tons of them) from UP version of per_cpu():
      merged asm-generic's version

commit 0b4e162cdb2f06fc78bcd12a4d9208facc063260
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon May 10 00:04:14 2004 -0700

    [PATCH] fixup 68360 module refcounting
    
    From: Christoph Hellwig <hch@lst.de>

commit 43653667122796412010fc148891954d54812705
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon May 10 00:04:03 2004 -0700

    [PATCH] Warn when smp_call_function() is called with interrupts disabled
    
    From: Keith Owens <kaos@sgi.com>
    
    Almost every architecture has a comment above smp_call_function()
    
     * You must not call this function with disabled interrupts or from a
     * hardware interrupt handler or from a bottom half handler.
    
    I have not seen any problems with calling smp_call_function() from a bottom
    half handler, but calling it with interrupts disabled can definitely
    deadlock.  This bug is hard to reproduce and even harder to debug.
    
    CPU A                               CPU B
    Disable interrupts
                                        smp_call_function()
                                        Take call_lock
                                        Send IPIs
                                        Wait for all cpus to acknowledge IPI
                                        CPU A has not responded, spin waiting
                                        for cpu A to respond, holding call_lock
    smp_call_function()
    Spin waiting for call_lock
    Deadlock                            Deadlock
    
    Change all smp_call_function() to WARN_ON(irqs_disabled()).  It should be
    BUG_ON() but some buggy code like SCSI sg will break with BUG_ON, so just
    warn for now.  Change it to BUG_ON after the buggy code has been fixed.

commit 5805ad402642142b5a769e1553c4e45a52653efe
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon May 10 00:03:52 2004 -0700

    [PATCH] worker_thread race fix
    
    Fix a waitqueue-handling race in worker_thread().

commit df125ce9fe67e9b5b4e39c98d11dcc5fc3f297e4
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon May 10 00:03:41 2004 -0700

    [PATCH] pcmcia/i82365.c warning fix
    
    From: "Luiz Fernando N. Capitulino" <lcapitulino@prefeitura.sp.gov.br>
    
    drivers/pcmcia/i82365.c: At top level:
    drivers/pcmcia/i82365.c:71: warning: `version' defined but not used

commit d14c7e922a99294589e67b15928d5d997f7288fd
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon May 10 00:03:31 2004 -0700

    [PATCH] throttle P4 thermal warnings
    
    From: Zwane Mwaikambo <zwane@linuxpower.ca>
    
    In really bad conditions this can keep printing for a while, throttle the
    output somewhat.  Also change the "CPU%d" formatting to better match the
    other boot output.

commit b4ad84fc91d47b7b6c2674abf776068a118a7726
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon May 10 00:03:20 2004 -0700

    [PATCH] fix deadlock in create_workqueue()
    
    Fix bug identified by Srivatsa Vaddagiri <vatsa@in.ibm.com>:
    
    There's a deadlock in __create_workqueue when CONFIG_HOTPLUG_CPU is set.  This
    can happen when create_workqueue_thread fails to create a worker thread.  In
    that case, we call destroy_workqueue with cpu hotplug lock held.
    destroy_workqueue however also attempts to take the same lock.

commit 7676bfa08ae93461715b3bfd9c093821c8baf049
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon May 10 00:03:10 2004 -0700

    [PATCH] remove blk_queue_bounce() printks
    
    From: Matt Domsch <Matt_Domsch@dell.com>
    
    Jens Axboe wrote:
    It should just be deleted. As you note, it is a debug message. I
    originally added it so we would have some clues as to dma capability for
    bug reports. There never was any, the check can go :)

commit b94ef24c7217745d2e83e8db3e1f237d810272bd
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon May 10 00:02:59 2004 -0700

    [PATCH] Fix MTD suspend/resume
    
    From: Russell King <rmk@arm.linux.org.uk>
    
    This patch carries forward the following bug fix from MTD CVS, which causes a
    lot of noise after a suspend/resume cycle on ARM devices.
    
    revision 1.127
    date: 2003/07/02 20:29:38;  author: acurtis;  state: Exp;  lines: +2 -1
    Added FL_STATUS to the FL_READY case in put_chip(). (Eliminate noise)

commit 99effef9544e4d526abf836d6d6c680853e6cf64
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon May 10 00:02:49 2004 -0700

    [PATCH] dentry and inode cache hash algorithm performance changes.
    
    From: "Jose R. Santos" <jrsantos@austin.ibm.com>
    
    It alleviates some issues seen with Linux when accessing millions of files on
    machines with large amounts of RAM (+32GB).  Both algorithms are base on some
    studies that Dominique Heger was doing on hash table efficiencies in Linux.
    The dentry hash table has been tested in small systems with one internal IDE
    hard disk as well as in large SMP with many fiberchanel disks.  Dominique
    claims that in all the testing done, they did not see one case were this has
    function provided worst performance and that in most test they were seeing
    better performance.
    
    The inode hash function was done by me base on Dominique's original work and
    has only been stress tested with SpecSFS.  It provided a 3% improvement over
    the default algorithm in the SpecSFS results and speed ups in the response
    time of almost all filesystem operations the benchmark stress.  With the
    better distribution is as also possible to reduce the number of inode buckets
    for 32 million to 16 million and still get a slightly better results.
    
    Anton was nice enough to provide some graphs that show the distribution
    before and after the patch at http://samba.org/~anton/linux/sfs/1/
    
    For the dentry hash function, some of my other coorkers had put this hash
    function through various testing and have concluded that the hash function was
    equal or better than the default hash function.  These runs were done with a
    (hopefully to be Open Source soon) benchmark called FFSB which can simulate
    various io patters across many filesystems and variable file sizes.
    
    SpecSFS fileset is basically a lot of small file which varies depending on the
    size of the run.  For a not so big SMP system the number of file is in the +20
    Million files range.  Of those 20 million files only 10% are access randomly
    by the client.  The purpose of this is that the benchmark tries to stress not
    only the NFS layer but, VM and Filesystems layers as well.  The filesets are
    also hundreds of gigabytes in size in order to promote disk head movement by
    guaranteeing cache misses in memory.  SFS 27% of the workload are lookups
    __d_lookup has showing high in my profiles.
    
    For the inode hash the problem that I see is that when running a benchmark
    with this huge fileset we end up trying to free a lot of inode entries during
    the run while trying to put new entries in cache.  We end up calling
    ifind_fast() which calls find_inodes_fast() held under inode_lock.  In order
    to avoid holding the inode_lock we needed to avoid having long chains in that
    hash function.
    
    When I took a look at the original hash function, I found it to be a bit to
    simple for any workload.  My solution (which I took advantage of Dominique's
    work) was to create a hash that function that could generate completely
    different hashes depending on the hashval and the superblock in order to have
    the hash scale as we added more filesystems to the machine.
    
    Both of these problems can be somewhat tuned out by increasing the number of
    buckets of both d and i cache but it got to a point were I had 256MB of inode
    and 128MB in dentry hash buckets on a not so large SMP.  With the hash changes
    I have been able to reduce the number of buckets to 128MB for inode cache and
    to 32MB for dentry cache and still get better performance.
    
    If it help my case...  I haven't been running this benchmark for long, so I
    haven't been able to find a way to cheat.  I need to come up with generic
    solutions until I can find a cheat for the benchmark.  :)
    
    
    SDET results:
    
    Steve Pratt seem to have a SDET setup already and he did me the favor of
    running SDET with a reduce dentry entry hash table size.  I belive that
    his table suggest that less than 3% change is acceptable variability, but
    overall he got a 5% better number using the new hash algorith.
    
    A) x4408way1.sdet.2.6.5100000-8p.04-05-05_12.08.44 vs
    B) x4408way1.sdet.2.6.5+hash-100000-8p.04-05-05_11.48.02
    
    
      Dentry cache hash table entries: 131072 (order: 7, 524288 bytes)
      Inode-cache hash table entries: 1048576 (order: 10, 4194304 bytes)
    
    Results:Throughput
    
                                              tolerance = 0.00 + 3.00% of A
                          A            B
       Threads      Ops/sec      Ops/sec    %diff         diff    tolerance
    ----------- ------------ ------------ -------- ------------ ------------
             1    4341.9300    4401.9500     1.38        60.02       130.26
             2    8242.2000    8165.1200    -0.94       -77.08       247.27
             4   15274.4900   15257.1000    -0.11       -17.39       458.23
             8   21326.9200   21320.7000    -0.03        -6.22       639.81
            16   23056.2100   24282.8000     5.32      1226.59       691.69  *
            32   23397.2500   24684.6100     5.50      1287.36       701.92  *
            64   23372.7600   23632.6500     1.11       259.89       701.18
           128   17009.3900   16651.9600    -2.10      -357.43       510.28
    =========================================================================

commit 9e315f49b970750ff034901b5c6fb50ceab5e658
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon May 10 00:02:38 2004 -0700

    [PATCH] cmpci OSS driver update
    
    From: C.L. Tien <cltien@cmedia.com.tw>
    
    Current version from cmedia.

commit da78fe7322dcabd9f2b696514b0ba6fdc5b62fa8
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon May 10 00:02:27 2004 -0700

    [PATCH] EDD: follow sysfs convention, MODULE_VERSION, remove dead SCSI symlink
    
    From: Matt Domsch <Matt_Domsch@dell.com>
    
    Clean up the edd.c driver.
    
    * use kobject_set_name() instead of snprintf() per GregKH's recommendation.
    * Add MODULE_VERSION()
    * s/driverfs/sysfs/ in Kconfig
    * Remove report URL message, as there have been too many BIOSs reported,
      virtually none of which are EDD-capable.  This may return if/when I
      develop a better reporting method and database to capture/store the
      data from users.
    * Remove the unused code for creating a symlink to the scsi_device.
      This never worked right, and I'm going to show the relationship from
      a userspace tool which uses libsysfs instead.

commit 12db2584267b839bc00dfd97110e6ab09cf97ad7
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon May 10 00:02:17 2004 -0700

    [PATCH] blk_start_queue() should use kblockd
    
    kblockd is the thread which runs unplug functions, not keventd.

commit d137ab48940a437f00a9f74b0b645e94bebdc286
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon May 10 00:02:06 2004 -0700

    [PATCH] Only Print Taint Message Once
    
    From: Rusty Russell <rusty@rustcorp.com.au>
    
    Only print the tainted message the first time.  Its purpose is to warn
    users that we can't support them, not to fill their logs.

commit 5dfd0a430176e8f5ff44b1a45b75ce0171a43541
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon May 10 00:01:55 2004 -0700

    [PATCH] Un-inline spinlocks on ppc64
    
    From: Paul Mackerras <paulus@samba.org>
    
    The patch below moves the ppc64 spinlocks and rwlocks out of line and into
    arch/ppc64/lib/locks.c, and implements _raw_spin_lock_flags for ppc64.
    
    Part of the motivation for moving the spinlocks and rwlocks out of line was
    that I needed to add code to the slow paths to yield the processor to the
    hypervisor on systems with shared processors.  On these systems, a cpu as
    seen by the kernel is a virtual processor that is not necessarily running
    full-time on a real physical cpu.  If we are spinning on a lock which is
    held by another virtual processor which is not running at the moment, we
    are just wasting time.  In such a situation it is better to do a hypervisor
    call to ask it to give the rest of our time slice to the lock holder so
    that forward progress can be made.
    
    The one problem with out-of-line spinlock routines is that lock contention
    will show up in profiles in the spin_lock etc.  routines rather than in the
    callers, as it does with inline spinlocks.  I have added a CONFIG_SPINLINE
    config option for people that want to do profiling.  In the longer term, Anton
    is talking about teaching the profiling code to attribute samples in the spin
    lock routines to the routine's caller.
    
    This patch reduces the kernel by about 80kB on my G5.  With inline
    spinlocks selected, the kernel gets about 4kB bigger than without the
    patch, because _raw_spin_lock_flags is slightly bigger than _raw_spin_lock.
    
    This patch depends on the patch from Keith Owens to add
    _raw_spin_lock_flags.

commit 07f94531e056e34d2e1c73c940c8f530badf777d
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon May 10 00:01:44 2004 -0700

    [PATCH] Allow architectures to reenable interrupts on contended spinlocks
    
    From: Keith Owens <kaos@sgi.com>
    
    As requested by Linus, update all architectures to add the common
    infrastructure.  Tested on ia64 and i386.
    
    Enable interrupts while waiting for a disabled spinlock, but only if
    interrupts were enabled before issuing spin_lock_irqsave().
    
    This patch consists of three sections :-
    
    * An architecture independent change to call _raw_spin_lock_flags()
      instead of _raw_spin_lock() when the flags are available.
    
    * An ia64 specific change to implement _raw_spin_lock_flags() and to
      define _raw_spin_lock(lock) as _raw_spin_lock_flags(lock, 0) for the
      ASM_SUPPORTED case.
    
    * Patches for all other architectures and for ia64 with !ASM_SUPPORTED
      to map _raw_spin_lock_flags(lock, flags) to _raw_spin_lock(lock).
      Architecture maintainers can define _raw_spin_lock_flags() to do
      something useful if they want to enable interrupts while waiting for
      a disabled spinlock.

commit a023cd55bbf29d8c0cde45bc1727fc8c06ec3a54
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon May 10 00:01:33 2004 -0700

    [PATCH] Kill some 'No description found...' warnings. (kernel-api.sgml)
    
    From: Alexey Dobriyan <adobriyan@mail.ru>
    
    Fix various kernel-doc parameters.

commit 72468a403fe5976b9a33b00581d66d447fbe0bcf
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon May 10 00:01:22 2004 -0700

    [PATCH] Kill a warning while making pdfdocs.
    
    From: Alexey Dobriyan <adobriyan@mail.ru>
    
      DOCPROC Documentation/DocBook/parportbook.sgml
    Warning(drivers/parport/share.c:188): No description found for parameter 'drv'
    (kernel-doc parameter name is incorrect.)

commit 8b3ca458645203ccf66fc7ac1de0bc9c1cad7ac5
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon May 10 00:01:13 2004 -0700

    [PATCH] com90xx error message patch: check_region() gone
    
    From: Greg Aumann <Greg_Aumann@sil.org>
    
    This patch updates two error messages to reflect changes in the code.

commit 6835de14ba7f7232a3bb97d0034b79f133824cf0
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon May 10 00:01:03 2004 -0700

    [PATCH] Improve laptop mode's block_dump output
    
    From: "Theodore Ts'o" <tytso@mit.edu>
    
    This patch versus improves the output produced by "echo 1 >
    /proc/sys/vm/block_dump", in the following ways:
    
    1) The messages are printed with KERN_DEBUG, so that even if sysklogd is
       running, if configured appropriately, it will not need to write to log
       files.
    
    2) The inode which is dirtied by a process is now identified more
       precisely by inode number and filesystem ID, and by a dcache name if
       present.
    
    3) In the generic filesystem sget function, the superblock id (s_id) is
       filled in with the filesystem type by default.  Filesystems which are
       block-device based will override s_id, but this allows pseudo
       filesystems such as tmpfs, procfs, etc.  to be identified in (2).

commit 475c3656c94b2d8709c113bd7bbd1aa963213f0a
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon May 10 00:00:52 2004 -0700

    [PATCH] find_user locking and leak fix
    
    find_user() is being called from set/get_priority(), but it doesn't take the
    needed lock, and those callers were forgetting to drop the refcount which
    find_user() took.

commit 5a80c2eaf119ef59badcba46580df9a5294fb603
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon May 10 00:00:41 2004 -0700

    [PATCH] mptfusion depends on scsi
    
    From: Olaf Hering <olh@suse.de>

commit 9511c080dcc7fb0754da58475e7ba2eb49535493
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon May 10 00:00:30 2004 -0700

    [PATCH] reiserfs: add device info to diagnostic messages
    
    From: Chris Mason <mason@suse.com>
    
    From: Jeff Mahoney <jeffm@suse.com>
    
    Add device info to the various reiserfs warnings and panics so you can tell
    which filesystem triggers the message.  Loosely based on code from Oleg
    Drokin.

commit cee426000531bfd599a7d1c475e7e038ec881d47
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon May 10 00:00:19 2004 -0700

    [PATCH] reiserfs: xattr permission fix
    
    From: Chris Mason <mason@suse.com>
    
    From: jeffm@suse.com
    
    reiserfs permission bug fix for xattrs

commit 446a7461692fc84cb2fc1e17c259b8a8f672fc54
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon May 10 00:00:09 2004 -0700

    [PATCH] reiserfs: quota support
    
    From: Chris Mason <mason@suse.com>
    
    ReiserFS support for quotas.  Originally from Jan Kara

commit 30304fc967ae7ec3173a6538a3b6ed216a6ce7b4
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun May 9 23:59:58 2004 -0700

    [PATCH] reiserfs: xattr locking fixes
    
    From: Chris Mason <mason@suse.com>
    
    From: jeffm@suse.com
    
    reiserfs xattr locking fixes

commit 647c60b9c9867e6c7e6133a4f01cb0dc750bb476
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun May 9 23:59:47 2004 -0700

    [PATCH] reiserfs: selinux support
    
    From: Chris Mason <mason@suse.com>
    
    From: jeffm@suse.com
    
    reiserfs support for selinux

commit a4a4ddc5b08b319d14651d9c055a358eea3e0df3
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun May 9 23:59:36 2004 -0700

    [PATCH] reiserfs: support trusted xattrs
    
    From: Chris Mason <mason@suse.com>
    
    From: jeffm@suse.com
    
    reiserfs support for trusted xattrs

commit 0acef0325791f2d834e911a32f9d2a51f6149b74
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun May 9 23:59:25 2004 -0700

    [PATCH] reiserfs: ACL support
    
    From: Chris Mason <mason@suse.com>
    
    From: jeffm@suse.com
    
    reiserfs acl support

commit 0b1a6a8ca8a78c2e068b04acf97479ee89a024ac
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun May 9 23:59:13 2004 -0700

    [PATCH] reiserfs: xattr support
    
    From: Chris Mason <mason@suse.com>
    
    From: jeffm@suse.com
    
    reiserfs support for xattrs

commit 06803e35835f0d0fc1a2a3833361ef210457c809
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun May 9 23:59:01 2004 -0700

    [PATCH] reiserfs: acl device node initialization
    
    From: Chris Mason <mason@suse.com>
    
    From: jeffm@suse.com
    
    properly init device inodes in the acl code

commit bb0ad0aa9c209a4923202ca685a9af0fae29e065
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun May 9 23:58:51 2004 -0700

    [PATCH] Reiserfs commit default fix
    
    From: Bart Samwel <bart@samwel.tk>
    
    This patch from Micha Feigin fixes some bugs in the earlier reiserfs
    commit default patch. The changelog:
    
    * If you remounted without any commit=NNN option, it would assume commit=0
      and restore the defaults.  This patch makes it leave the current state alone
      if you don't pass commit=NNN.
    
    * Added range check for cast from unsigned long to unsigned int.

commit 6ef0062552d96a08b3201bc2ef6a18d7820203e4
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun May 9 23:58:41 2004 -0700

    [PATCH] partitioning cleanup: use DOS_EXTENDED_PARTITION
    
    From: FabF <Fabian.Frederick@skynet.be>
    
    Use the pre-existing enum rather than magic numbers.

commit 073c413298220381d7d5496315af4d51bd57ca9d
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun May 9 23:58:30 2004 -0700

    [PATCH] fix 3c59x.c to allow 3c905c 100bT-FD
    
    From: Burton Windle <bwindle@fint.org>
    
    Fix the 3c905C 10/100 transceiver initialisation woes.

commit edb41998d921a5c3c4d840417f01c698df8fb5ef
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun May 9 23:58:20 2004 -0700

    [PATCH] shrink_slab: improved handling of GFP_NOFS allocations
    
    Currently, shrink_slab() will decide that it needs to scan a certain number of
    dentries, will call shrink_dcache_memory() requesting that this be done, and
    shrink_dcache_memory() will simply bale out without doing anything because the
    caller did not have __GFP_FS.
    
    This has the potential to disrupt our lovely pagecache-vs-slab balancing act.
    So change things so that shrinker callouts can return -1, indicating that they
    baled out.  This way, shrink_slab can remember that this slab was owed a
    certain number of scannings and these will be correctly performed next time a
    __GFP_FS caller comes by.

commit b528cea7fb3b5bd875c5d7f8c578ee2863660601
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun May 9 23:58:09 2004 -0700

    [PATCH] New version of early CPU detect
    
    From: Andi Kleen <ak@suse.de>
    
    We still need some kind of early CPU detection, e.g.  for the AMD768
    workaround and for the slab allocator to size its slabs correctly for the
    cache line.  Also some other code already had private early CPU routines.
    
    This patch takes a new approach compared to the previous patch which caused
    Andrew so much grief.  It only fills in a few selected fields in
    boot_cpu_data (only the data needed to identify the CPU type and the cache
    alignment).  In particular the feature masks are not filled in, and the
    other fields are also not touched to prevent unwanted side effects.
    
    Also convert the ppro workaround to use standard cpu data now.
    
    I'm not sure if slab still has the necessary support to use the cache line
    size early; previously Manfred showed some serious memory saving with this
    for kernels that are compiled for a bigger cache line size than the CPU (is
    often the case on distribution kernels).  This code could be reenable now
    with this patch.

commit ed67bbe726e700a5c2de2ade15e5120e4e00a466
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun May 9 23:57:58 2004 -0700

    [PATCH] remove some unused variables in s2io
    
    From: Anton Blanchard <anton@samba.org>
    
    Found a few warnings when compiling with NAPI off.

commit 51538d85c2a02f8f493a3209c54a2784296e47d0
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun May 9 23:57:48 2004 -0700

    [PATCH] Remove bootsect_helper on x86_64 and pc98
    
    From: Coywolf Qi Hunt <coywolf@greatcn.org>
    
    Since "Direct booting from floppy is no longer supported", this patch is
    remove the bootsect_helper code from x86_64 and PC-9800.

commit 7d8d2dfe54fb4f3bf388131774bdca1fe94eb7d7
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun May 9 23:57:37 2004 -0700

    [PATCH] Remove bootsect_helper and a comment fix
    
    From: Coywolf Qi Hunt <coywolf@greatcn.org>
    
    Since "Direct booting from floppy is no longer supported", this patch is to
    remove the bootsect_helper code.  And also a comment fix.
    
    The other two platforms x86_64 and PC-9800 should also be cleaned up too.

commit 79fde3587c69edd388dc093cbe107a7bc290a3fc
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun May 9 23:57:26 2004 -0700

    [PATCH] ppc32: ppc8xx build fixes
    
    From: "Prof. BJ" <prof.bj@freemail.hu>
    
    - m8xx_setup warning and mfmsr error fix
    - ppc8xx_pic include error fix
    - tqm8xxl.c typeing (syntax) error fix
    - commproc.c include error and prototype warning fix
    
    (acked by Matt Porter)

commit 45dc4f2795e08413743098657340dc4b8a1c4296
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun May 9 23:57:16 2004 -0700

    [PATCH] es7000 subarch update
    
    From: "Protasevich, Natalie" <Natalie.Protasevich@UNISYS.com>
    
    The patch fixes a problem with ES7000 Server Management mechanism that uses
    platform register mip_port.  It was not initialized, so the mechanism was not
    functional.
    
    The patch also fixes the APIC destination for hierarchical and flat cluster
    models used in ES7000.  The destination ID's reflect policies for Cascade
    based systems which use logical delivery and lowest priority mechanism, and
    for xAPIC based models that use physical delivery and fixed APIC destinations.
    
    The patch also turns on NO_IOAPIC_CHECK (1) to avoid error messages and
    attempts to re-write the ID, because on ES7000 all ID's are hard coded in the
    BIOS and cannot be altered.

commit 522cbd425a151a5998af32ac8c30963f2bd32621
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun May 9 23:57:05 2004 -0700

    [PATCH] Consolidate sys32_nfsservctl
    
    From: Arnd Bergmann <arnd@arndb.de>
    
    sys32_nfsservctl is the largest remaining syscall emulation handler that can
    be consolidated.  mips and ia64 currently don't use this at all, parisc has a
    simpler implementation than the one used by s390, sparc ppc and that the new
    compat_sys_nfsservctl is based on.
    
    The user access checks in the code are inconsistant at least, which should be
    fixed here.
    
    Compile tested only due to lack of proper test setup.

commit 37915f7bd0dc6e1a03c1b29944e24a3381345541
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun May 9 23:56:53 2004 -0700

    [PATCH] Consolidate sys32_select
    
    From: Arnd Bergmann <arnd@arndb.de>
    
    sys32_select has seven mostly but not exactly identical versions, so
    consolidate them as compat_sys_select.  Based on the ppc64 implementation,
    which most closely resembles sys_select.  One bug that was not caught by LTP
    has been fixed since the first version of this patch.
    
    tested x86_64, ia64 and s390.

commit 265e0a42585f263c979ac924dcddd7f87e2b6d5d
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun May 9 23:56:42 2004 -0700

    [PATCH] Consolidate do_execve32
    
    From: Arnd Bergmann <arnd@arndb.de>
    
    The code for sys32_execve/do_execve32 in most of the seven versions was copied
    from fs/exec.c but not kept up-to-date.  The new compat_do_execve() function
    is based on the mips code and has been resync'ed with do_execve().  IA64
    changes are from Arun Sharma.
    
    Tested on x86_64, ia64 and s390

commit 4791db72dbf79ce30b6351498dca2f4f593cd431
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun May 9 23:56:32 2004 -0700

    [PATCH] Consolidate sys32_readv and sys32_writev
    
    From: Arnd Bergmann <arnd@arndb.de>
    
    The seven implementations of this have gone out of sync and are mostly buggy.
    The new compat_sys_* version is based on the ppc64 implementation, which most
    closely resembles the code in sys_readv/sys_writev.
    
    Tested on x86_64, ia64 and s390.

commit 8aab2013e22c1a08110eb8d5668a3ab9247b1993
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun May 9 23:56:20 2004 -0700

    [PATCH] AS: increase batch expiry intervals
    
    From: Nick Piggin <nickpiggin@yahoo.com.au>
    
    Without disturbing the read/write ratio, increase the bathc expiry
    intervals.  This wil have the effect of increasing latency a little, but
    with improved throughput.

commit e33daf9d9637d0a680d20b772b9cfcd6efa27fd0
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun May 9 23:56:10 2004 -0700

    [PATCH] Laptop Mode doc update
    
    From: <bart@samwel.tk>
    
    Richard Atterer reported that mutt does not play well with noatime (it uses
    access times to check whether new mail has arrived in a folder).  This patch
    warns about this in the doc, and adds a setting to the control script to
    disable the noatime remount.

commit c489e9e6f7a2232a51c3353b26ea00bb1ba000fb
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun May 9 23:55:59 2004 -0700

    [PATCH] cyclades MAINTAINERS update
    
    From: Marcelo Tosatti <marcelo.tosatti@cyclades.com>

commit def3f08e2365e7c602603e73755eb111781249b2
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun May 9 23:55:49 2004 -0700

    [PATCH] selinux: reopen descriptors closed on exec to /dev/null
    
    From: Stephen Smalley <sds@epoch.ncsc.mil>
    
    This patch changes the SELinux module to try to reset any descriptors it
    closes on exec (due to a lack of permission by the new domain to the inherited
    open file) to refer to the null device.  This counters the problem of SELinux
    inducing program misbehavior, particularly due to having descriptors 0-2
    closed when the new domain is not allowed access to the caller's tty.  This is
    primarily to address the case where the caller is trusted with respect to the
    new domain, as the untrusted caller case is already handled via AT_SECURE and
    glibc secure mode.  The code is partly based on the OpenWall LSM, which in
    turn drew from the OpenWall kernel patch.  Note that the code does not
    guarantee that the descriptor is always re-opened to /dev/null; it merely
    makes a reasonable effort to do so, but can fail under various conditions.

commit e461abeb62ef330c4c1b1e9dae2a0a7a10213e79
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun May 9 23:55:38 2004 -0700

    [PATCH] ext3 error handling fixes
    
    From: Andreas Dilger <adilger@clusterfs.com>
    
    a) we don't call ext3_error() for an IO error in ext3_find_entry(), so we
       won't do the normal ext3 error handling (mark SB in error, remount-ro
       or panic if desired);
    b) in empty_dir() we don't continue checking for non-empty blocks after a
       content error (ext3_check_dir_entry() calls ext3_error() already);
    c) we had decided not to mark the SB in error for holes in directories to
       allow leway in the indexed-directory implementation, but this change
       incorrectly also disabled marking the SB in error for real IO errors.

commit a7c8a1d320ff544a044f6fac5c7fda557f5ef60c
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun May 9 23:55:27 2004 -0700

    [PATCH] sched: in_sched_functions() cleanup
    
    From: Rusty Russell <rusty@rustcorp.com.au>
    
    1) Create an in_sched_functions() function in sched.c and make the
       archs use it.  (Two archs have wchan #if 0'd out: left them alone).
    
    2) Move __sched from linux/init.h to linux/sched.h and add comment.
    
    3) Rename __scheduling_functions_start_here/end_here to __sched_text_start/end.
    
    Thanks to wli and Sam Ravnborg for clue donation.

commit e736428d8be55699f3d9626f5196402a3702575b
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun May 9 23:55:16 2004 -0700

    [PATCH] Fix ext3 bogus ENOSPC
    
    With strange workloads which do a lot of quick truncation on small filesystems
    it is possible to get into a situation where there are free blocks on the
    disk, but they are not allocatable at this time due to their having been freed
    up in the current JBD transaction.  Applications get unexpected ENOSPC errors.
    
    We can fix that with this patch, originally by Andreas Dilger which forces a
    single commit+retry when an ENOSPC is encountered.

commit 774882ea14069557c58def6000c2b390261fb746
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun May 9 23:55:06 2004 -0700

    [PATCH] reduce NMI watchdog call frequency with local APIC.
    
    From: Mikael Pettersson <mikpe@csd.uu.se>
    
    The real problem is that SMP with nmi_watchdog=2 initialises the lapic NMI
    watchdog but doesn't check it and therefore doesn't reduce nmi_hz.  This is
    an SMP bug.
    
    The patch changes smpboot.c to do a check_nmi_watchdog() at the appropriate
    place, which fixes the high NMI frequency problem w/o changing anything
    else.  I've verified that it solves the problem on my MP-capable UP box.

commit 961d3a727228b823e9ab7662214bb4e1fb91d92e
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun May 9 23:54:55 2004 -0700

    [PATCH] Fix nmi_watchdog=2 and P4 HT
    
    From: Philippe Elie <phil.el@wanadoo.fr>
    
    With nmi_watchdog=2 and a P4 ht box the nmi is occurring only on logical
    processor 0, it's better to get it on both.
    
    With this patch, on x86 SMP and nmi_watchdog=2, nmi interupts occur at 1000
    hz (if the cpu is loaded) not at the intended 1 hz rate but that's a distinct
    problem.

commit a48558313e0c6bd79c624a782eb93f4d0b09b016
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun May 9 23:54:45 2004 -0700

    [PATCH] Fixes in 32 bit ioctl emulation code
    
    From: Raghavan <raghav@in.ibm.com>,
          me
    
    I am submitting a patch that fixes 2 race conditions in the 32 bit ioctl
    emulation code.(fs/compat.c) Since the search is not locked; when a
    ioctl_trans structure is deleted, corruption can occur.
    
    The following scenarios discuss the race conditions:
    
    1) When the search is hapenning, if any ioctl_trans structure gets
       deleted; then rather than searching the hash table, the code will start
       searching the free list.
    
    while (t && t->cmd != cmd)
            -

commit ed258d80221050c4e14bd891fbfb6c273be86d12
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun May 9 23:54:34 2004 -0700

    [PATCH] mips: sgiwd93 2.6 fixes and crapectomy
    
    From: Ralf Baechle <ralf@linux-mips.org>
    
    Get to work under 2.6 sorting out the giant mess this has been.  Further
    cleanups would require a full crapectomy of wd33c93.c itself ...

commit 41984bac4cf87ae74f3585c7189a0bb1bb712214
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun May 9 23:54:24 2004 -0700

    [PATCH] mips: remove dz driver
    
    From: Ralf Baechle <ralf@linux-mips.org>
    
    This driver has been obsoleted by drivers/serial/dz.c.

commit 303165e97baee8b7f9aea9817aa96ea42b4b9fae
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun May 9 23:54:13 2004 -0700

    [PATCH] mips: 64-bit MIPS needs compat stuff
    
    From: Ralf Baechle <ralf@linux-mips.org>

commit 61f9d5aad0e4883ab424c5e02168664e7fbd4d08
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun May 9 23:54:02 2004 -0700

    [PATCH] mips: add missing IP22 Zilog bit
    
    From: Ralf Baechle <ralf@linux-mips.org>
    
    Add missing definition PORT_IP22ZILOG which is need by ip22zilog driver.

commit f2136be163d7bdc3564acfc35bef5cf14642f4dc
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun May 9 23:53:51 2004 -0700

    [PATCH] mips: GBE Video Driver
    
    From: Ralf Baechle <ralf@linux-mips.org>
    
    This patch adds the GBE video driver for the video system in SGI IP32
    aka O2 and it's i386-based equivalent the Visual Workstation.
    
    This driver obsoletes sgivwfb.c; but I'd prefer to play safe and remove
    it after some additional time, just in case.

commit 4663d2a4437e3b579fa3647deef35258f900176c
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun May 9 23:53:41 2004 -0700

    [PATCH] mips: remove VIDEO_TYPE_SNI_RM
    
    From: Ralf Baechle <ralf@linux-mips.org>
    
    The RM200's onboard video really is a plain old boring Cyrix PCI card.

commit ebaebc689990c650947dd674f31184c5fc638d18
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun May 9 23:53:30 2004 -0700

    [PATCH] mips: newport driver fixes
    
    From: Ralf Baechle <ralf@linux-mips.org>
    
    Make the driver for Newport aka XL work in 2.6.

commit 2cb5274c94a3d442ffa03360374a470a4e708f29
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun May 9 23:53:19 2004 -0700

    [PATCH] mips: Simplify expression
    
    From: Ralf Baechle <ralf@linux-mips.org>
    
    CONFIG_MIPS is always defined, for 32-bit and 64-bit.

commit bbbc024a00147dfcc9921f5f8757bde7df706844
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun May 9 23:53:07 2004 -0700

    [PATCH] mips: fix 2.6 fb setup
    
    From: Ralf Baechle <ralf@linux-mips.org>

commit 4b35ee7fea60f42b5b205c23372b3f90e90064a4
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun May 9 23:52:56 2004 -0700

    [PATCH] MIPS update
    
    From: Ralf Baechle <ralf@linux-mips.org>
    
     - Kconfig cleanups:
        - enable DMA_NONCOHERENT, DMA_COHERENT or DMA_IP27 via reverse dependencies
        - untangle VRC4171 / VRC4173 selection
        - R10000 support enables PREFETCH
        - SEAD needs IRQ_CPU
     - Update defconfig against latest Kconfig files.
     - Fix computation of return address if syscall number was out of range
     - Add power managment hooks in signal code.
     - Don't try to handle signals when previous context was not in user mode.
     - Fix serial interface setup for VR41xx systems.
     - Build fixes after CLEAR_BITMAP changed name.
     - Removes bogus comment from <asm/checksum.h>
     - <asm/hdreg.h> is dead.
     - Start collecting common definitions for PMON firmware in <asm/pmon.h>
     - Define ARCH_MIN_TASKALIGN to 8; we have 64-bit members even on 32-bit
       kernels if we're running on MIPS II or better.

commit 844ef7b98b5108fda7d7c7af7935237ae397999f
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun May 9 23:52:43 2004 -0700

    [PATCH] Fix deadlock in journalled quota
    
    From: Jan Kara <jack@ucw.cz>
    
    Attached patch should fix reported deadlock in journalled quota code.
    quotactl() call was violating the locking rules and didn't start transaction
    when it should.
    
    From: <raven@themaw.net>
    
      Found a couple of symbols not exported that were needed by the ext3.ko
      module.

commit 74499d325f9072130c0e4754e914f0f6e597a815
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun May 9 23:30:22 2004 -0700

    [PATCH] migration_thread() race fix
    
    From: Srivatsa Vaddagiri <vatsa@in.ibm.com>
    
    Noticed that migration_thread can examine "kthread_should_stop()?" without
    setting its state to TASK_INTERRUPTIBLE first.  This can cause kthread_stop
    on that thread to block forever ...
    
    P.S 	- I assumed that having the task state set to TASK_INTERRUTIBLE
    	  while it is doing active_load_balance is fine. It seemed to be
    	  the case earlier also.

commit 870d3c0a86538c98d81849fa58d13f443d30ca2c
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun May 9 23:30:12 2004 -0700

    [PATCH] sched_getaffinity vs cpu hotplug race fix
    
    From: Srivatsa Vaddagiri <vatsa@in.ibm.com>
    
    Fix the race in sys_sched_getaffinity.  Patch below takes cpu_hotplug lock
    before reading cpus_allowed mask of a task.

commit ddea677b6730f9f72d94f87885e38cff6d329fab
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun May 9 23:30:01 2004 -0700

    [PATCH] Move migrate_all_tasks to CPU_DEAD handling
    
    From: Srivatsa Vaddagiri <vatsa@in.ibm.com>
    
    migrate_all_tasks is currently run with rest of the machine stopped.
    It iterates thr' the complete task table, turning off cpu affinity of any task
    that it finds affine to the dying cpu. Depending on the task table
    size this can take considerable time. All this time machine is stopped, doing
    nothing.
    
    Stopping the machine for such extended periods can be avoided if we do
    task migration in CPU_DEAD notification and that's precisely what this patch
    does.
    
    The patch puts idle task to the _front_ of the dying CPU's runqueue at the
    highest priority possible. This cause idle thread to run _immediately_ after
    kstopmachine thread yields. Idle thread notices that its cpu is offline and
    dies quickly. Task migration can then be done at leisure in CPU_DEAD
    notification, when rest of the CPUs are running.
    
    Some advantages with this approach are:
    
    	- More scalable. Predicatable amout of time that machine is stopped.
    	- No changes to hot path/core code. We are just exploiting scheduler
    	  rules which runs the next high-priority task on the runqueue. Also
    	  since I put idle task to the _front_ of the runqueue, there
    	  are no races when a equally high priority task is woken up
    	  and added to the runqueue. It gets in at the back of the runqueue,
    	  _after_ idle task!
    	- cpu_is_offline check that is presenty required in try_to_wake_up,
    	  idle_balance and rebalance_tick can be removed, thus speeding them
    	  up a bit
    
    From: Srivatsa Vaddagiri <vatsa@in.ibm.com>
    
      Rusty mentioned that the unlikely hints against cpu_is_offline is
      redundant since the macro already has that hint.  Patch below removes those
      redundant hints I added.

commit 4197ad870f2d0618da7ca2bea46ec632128c0920
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun May 9 23:29:51 2004 -0700

    [PATCH] sched: Look at another CPU's domain
    
    From: Nick Piggin <nickpiggin@yahoo.com.au>
    
    The SMT wake_idle code really wants to look at a non-local CPU's domain in
    order to check for idle siblings.
    
    So change the domain attachment code a little bit so we continue to hold a
    runqueue's lock while attaching a new domain.  This means the locking rules
    have changed to: you may access your own domain without any lock, you must
    hold a remote runqueue's lock in order to view its domain.

commit 25de09021d379a49a83f17b80fa638d95c94219a
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun May 9 23:29:40 2004 -0700

    [PATCH] sched: micro-optimisation for wake_up
    
    From: Nick Piggin <nickpiggin@yahoo.com.au>
    
    This actually does produce better code, especially under the locked
    section.
    
    Turns a conditional + unconditional jump under the lock in the unlikely
    case into a cmov outside the lock.

commit 85841fc043bfac3ebecd9d3181b496a2dadc1283
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun May 9 23:29:30 2004 -0700

    [PATCH] sched: reduce idle time
    
    From: Nick Piggin <nickpiggin@yahoo.com.au>
    
    It makes NEWLY_IDLE balances cause find_busiest_group return the busiest
    available group even if there isn't an imbalance.  Basically - try a bit
    harder to prevent schedule emptying the runqueue.
    
    It is quite aggressive, but that isn't so bad because we don't (by default)
    do NEWLY_IDLE balancing across NUMA nodes, and NEWLY_IDLE balancing is always
    restricted to cache_hot tasks.
    
    It picked up a little bit of idle time that dbt2-pgsql was seeing...

commit 8c8cfc36d9ec9e9cd6a440fd7bf8b5404bd11635
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun May 9 23:29:19 2004 -0700

    [PATCH] sched: balance-on-clone
    
    From: Ingo Molnar <mingo@elte.hu>
    
    Implement balancing during clone().  It does the following things:
    
    - introduces SD_BALANCE_CLONE that can serve as a tool for an
      architecture to limit the search-idlest-CPU scope on clone().
      E.g. the 512-CPU systems should rather not enable this.
    
    - uses the highest sd for the imbalance_pct, not this_rq (which didnt
      make sense).
    
    - unifies balance-on-exec and balance-on-clone via the find_idlest_cpu()
      function. Gets rid of sched_best_cpu() which was still a bit
      inconsistent IMO, it used 'min_load < load' as a condition for
      balancing - while a more correct approach would be to use half of the
      imbalance_pct, like passive balancing does.
    
    - the patch also reintroduces the possibility to do SD_BALANCE_EXEC on
      SMP systems, and activates it - to get testing.
    
    - NOTE: there's one thing in this patch that is slightly unclean: i
      introduced wake_up_forked_thread. I did this to make it easier to get
      rid of this patch later (wake_up_forked_process() has lots of
      dependencies in various architectures). If this capability remains in
      the kernel then i'll clean it up and introduce one function for
      wake_up_forked_process/thread.
    
    - NOTE2: i added the SD_BALANCE_CLONE flag to the NUMA CPU template too.
      Some NUMA architectures probably want to disable this.

commit a690c9b7ac0ddc28785c38526a69a7fe2e692500
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun May 9 23:29:07 2004 -0700

    [PATCH] sched: cpu load management cleanup
    
    From: Ingo Molnar <mingo@elte.hu>
    
    This does the source/target cleanup.  This is a no-functionality patch which
    also adds more comments to explain these functions.

commit df65cdbf6bc82e79658c35e14221fef34f4db6d0
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun May 9 23:28:57 2004 -0700

    [PATCH] sched: passive balancing damping
    
    From: Nick Piggin <nickpiggin@yahoo.com.au>
    
    This patch starts to balance woken processes when half the relevant domain's
    imbalance_pct is reached.  Previously balancing would start after a small,
    constant difference in waker/wakee runqueue loads was reached, which would
    cause too much process movement when there are lots of processes running.
    
    It also turns wake balancing into a domain flag while previously it was always
    on.  Now sched domains can "soft partition" an SMP system without using
    processor affinities.

commit 237eaf03e4264e7171de2c993c6ad94f30f64a2d
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun May 9 23:28:46 2004 -0700

    [PATCH] sched: cleanups
    
    From: Ingo Molnar <mingo@elte.hu>
    
    This re-adds cleanups which were lost in splitups of an earlier patch.

commit 2ce2e329ddad1da9b86eb159a6c54a57850855d5
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun May 9 23:28:35 2004 -0700

    [PATCH] sched: lock cpu_attach_domain for hotplug
    
    From: Nick Piggin <nickpiggin@yahoo.com.au>
    
    The attached patch is required to work correctly with the CPU hotplug
    framework.  John Hawkes reports successful booting with this.

commit 7dc127021abbd45d928fafdcd57422d689e18be5
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun May 9 23:28:20 2004 -0700

    [PATCH] sched: extend sync wakeups
    
    From: Ingo Molnar <mingo@elte.hu>
    
    The attached patch extends sync wakeups to the process sys_exit() path too:
    the chldwait wakeup can be done sync, since we know that the process is
    going to exit (and thus deschedule).
    
    The most visible effect of this change is strace's behavior on SMP systems:
    it now stays on a single CPU, together with the traced child.  (previously
    it would run in parallel to the child, bouncing around madly.)

commit 3c6f29aac8aba4db3b4716003ab86acc466e3951
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun May 9 23:28:10 2004 -0700

    [PATCH] sched: add enqueeu_task_head()
    
    From: Ingo Molnar <mingo@elte.hu>
    
    Helper function for later patches

commit 78650e1b9aa58135694a64a1f650596c6ecce460
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun May 9 23:27:59 2004 -0700

    [PATCH] sched: uninlinings
    
    From: Ingo Molnar <mingo@elte.hu>
    
    Uninline things

commit 2f16618a944b8b4f64b3308f1b6d1ba0769aa535
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun May 9 23:27:48 2004 -0700

    [PATCH] sched: minor cleanups
    
    From: Nick Piggin <nickpiggin@yahoo.com.au>
    
    Minor cleanups from Ingo's patch including task_hot (do it right in
    try_to_wake_up too).

commit 80b1925658bab860f39873a95817714ae20c5e34
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun May 9 23:27:37 2004 -0700

    [PATCH] sched: fix setup races
    
    From: Nick Piggin <nickpiggin@yahoo.com.au>
    
    De-racify the sched domain setup code.  This involves creating a dummy
    "init" domain during sched_init (which is called early).
    
    When topology information becomes available, the sched domains are then
    built and attached.  The attach mechanism is asynchronous and uses the
    migration threads, which perform the switch with interrupts off.  This is a
    quiescent state, so domains can still be lockless on the read side.  It
    also allows us to change the domains at runtime without much more work.
    This is something SGI is interested in to elegantly do soft partitioning of
    their systems without having to use hard cpu affinities (which cause
    balancing problems of their own).
    
    The current setup code also has a race somewhere because it is unable to
    boot on a 384 CPU system.
    
    
    
    From: Anton Blanchard <anton@samba.org>
    
       This is basically a mindless ppc64 merge of the x86 changes to sched
       domain init code.
    
       Actually if I produce a sibling_map[] then the x86 code and the ppc64
       will be identical.  Maybe we can merge it.

commit 17d66773eec2fcddf99d6778785e51f974c9d253
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun May 9 23:27:24 2004 -0700

    [PATCH] ARCH_HAS_SCHED_WAKE_BALANCE doesnt exist
    
    From: Anton Blanchard <anton@samba.org>
    
    It seems someone has been making trivial changes without using grep.

commit 019bc3bee6ef4d8cd6e333d51628f7c7ef410d4d
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun May 9 23:27:13 2004 -0700

    [PATCH] ppc64: sched-domain support
    
    From: Anton Blanchard <anton@samba.org>
    
    Below are the diffs between the current ppc64 sched init stuff and x86.
    
    - Ignore the POWER5 specific stuff, I dont set up a sibling map yet.
    - What should I set cache_hot_time to?
    
    large cpumask typechecking requirements (perhaps useful on x86 as well):
    - cpu->cpumask = CPU_MASK_NONE -> cpus_clear(cpu->cpumask);
    - cpus_and(nodemask, node_to_cpumask(i), cpu_possible_map) doesnt work,
      need to use a temporary

commit ba5ccb3705d78630d25f40a4e0b9bd518aa2c4e2
Author: James Bottomley <jejb@mulgrave.(none)>
Date:   Mon May 10 01:27:04 2004 -0500

    Add IBM power RAID driver 2.0.6
    
    From: 	Brian King <brking@us.ibm.com>

commit a65fb1d0fdf4493d184ca6d73372e288ba3afc27
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun May 9 23:27:02 2004 -0700

    [PATCH] sched: oops fix
    
    From: Nick Piggin <nickpiggin@yahoo.com.au>
    
    After the for_each_domain change, the warn here won't trigger, instead it
    will oops in the if statement.  Also, make sure we don't pass an empty
    cpumask to for_each_cpu.

commit fd7b7b0f905b4123252d5d791f27b86d97258434
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun May 9 23:26:51 2004 -0700

    [PATCH] sched: altix tuning
    
    From: Nick Piggin <nickpiggin@yahoo.com.au>
    
    From: John Hawkes
    
    The following brings up performance on a 64-way Altix.  This system being on
    the smaller end of the scale should also be applicable to other NUMA systems.

commit 50386fbc384d25844c22e8ed68f04ec8b816bcc8
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun May 9 23:26:40 2004 -0700

    [PATCH] sched: fix imbalance calculations
    
    From: Nick Piggin <nickpiggin@yahoo.com.au>
    
    Imbalance calculations were not right.  This would cause unneeded migration.

commit 713551bcc2391d250506da02996d8eed9624e890
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun May 9 23:26:30 2004 -0700

    [PATCH] sched: wakeup balancing fixes
    
    From: Nick Piggin <nickpiggin@yahoo.com.au>
    
    Make affine wakes and "passive load balancing" more conservative.  Aggressive
    affine wakeups were causing huge regressions in dbt3-pgsql on 8-way non NUMA
    systems at OSDL's STP.

commit 91bc0bf78432c2f0350adf355324bdbc822bc35f
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun May 9 23:26:19 2004 -0700

    [PATCH] Hotplug CPU sched_balance_exec Fix
    
    From: Rusty Russell <rusty@rustcorp.com.au>
    
    From: Srivatsa Vaddagiri <vatsa@in.ibm.com>
    From: Andrew Morton <akpm@osdl.org>
    From: Rusty Russell <rusty@rustcorp.com.au>
    
    We want to get rid of lock_cpu_hotplug() in sched_migrate_task.  Found
    that lockless migration of execing task is _extremely_ racy.  The
    races I hit are described below, alongwith probable solutions.
    
    Task migration done elsewhere should be safe (?) since they either
    hold the lock (sys_sched_setaffinity) or are done entirely with preemption
    disabled (load_balance).
    
       sched_balance_exec does:
    
    	a. disables preemption
    	b. finds new_cpu for current
    	c. enables preemption
    	d. calls sched_migrate_task to migrate current to new_cpu
    
       and sched_migrate_task does:
    
    	e. task_rq_lock(p)
    	f. migrate_task(p, dest_cpu ..)
    		(if we have to wait for migration thread)
    		g. task_rq_unlock()
    		h. wake_up_process(rq->migration_thread)
    		i. wait_for_completion()
    
       Several things can happen here:
    
    	1. new_cpu can go down after h and before migration thread has
    	   got around to handle the request
    
    	   ==> we need to add a cpu_is_offline check in __migrate_task
    
    	2. new_cpu can go down between c and d or before f.
    
    	   ===> Even though this case is automatically handled by the above
    	        change (migrate_task being called on a running task, current,
    		will delegate migration to migration thread), would it be
    	 	good practice to avoid calling migrate_task in the first place
    		itself when dest_cpu is offline. This means adding another
    	 	cpu_is_offline check after e in sched_migrate_task
    
    	3. The 'current' task can get preempted _immediately_ after
    	   g and when it comes back, task_cpu(p) can be dead. In
    	   which case, it is invalid to do wake_up on a non-existent migration
    	   thread.  (rq->migration_thread can be NULL).
    
    	   ===> We should disable preemption thr' g and h
    
    	4. Before migration thread gets around to handle the request, its cpu
    	   goes dead. This will leave unhandled migration requests in the dead
    	   cpu.
    
    	   ===> We need to wakeup sleeping requestors (if any) in CPU_DEAD
    	        notification.
    
    I really wonder if we can get rid of these issues by avoiding balancing at
    exec time and instead have it balanced during load_balance ..Alternately
    if this is valuable and we want to retain it, I think we still need to
    consider a read/write sem, with sched_migrate_task doing down_read_trylock.
    This may eliminate the deadlock I hit between cpu_up and CPU_UP_PREPARE
    notification, which had forced me away from r/w sem.
    
    Anyway patch below addresses the above races. Its against 2.6.6-rc2-mm1
    and has been tested on a 4way Intel Pentium SMP m/c.
    
    
    Rusty sez:
    
    Two other changes:
    1) I grabbed a reference to the thread, rather than using
    preempt_disable().  It's the more obvious way I think.
    
    2) Why the wait_to_die code?  It might be needed if we move tasks after
    stop_machine, but for nowI don't see the problem with the migration
    thread running on the wrong CPU for a bit: nothing is on this runqueue
    so active_load_balance is safe, and __migrate task will be a noop (due
    to cpu_is_offline() check).  If there is a problem, your fix is racy,
    because we could be preempted immediately afterwards.
    
    So I just stop the kthread then wakeup any remaining...

commit 850f7d78d3912cbba31e4f6c266f1182a7ae8a20
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun May 9 23:26:09 2004 -0700

    [PATCH] sched: trivial fixes, cleanups
    
    From: Ingo Molnar <mingo@elte.hu>
    
    The trivial fixes.
    
    - added recent trivial bits from Nick's and my patches.
    - hotplug CPU fix
    - early init cleanup

commit fa8f2c5000cafcaa87182c5f2c021ae1ae52299c
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun May 9 23:25:57 2004 -0700

    [PATCH] Reduce TLB flushing during process migration
    
    From: Martin Hicks <mort@wildopensource.com>
    
    Another optimization patch from Jack Steiner, intended to reduce TLB
    flushes during process migration.
    
    Most architextures should define tlb_migrate_prepare() to be flush_tlb_mm(),
    but on i386, it would be a wasted flush, because i386 disconnects previous
    cpus from the tlb flush automatically.

commit 1ec430966896297cd850a36f1ac082a79de30eca
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun May 9 23:25:45 2004 -0700

    [PATCH] sched: add local load metrics
    
    From: Nick Piggin <piggin@cyberone.com.au>
    
    This patch removes the per runqueue array of NR_CPU arrays.  Each time we
    want to check a remote CPU's load we check nr_running as well anyway, so
    introduce a cpu_load which is the load of the local runqueue and is kept
    updated in the timer tick.  Put them in the same cacheline.
    
    This has additional benefits of having the cpu_load consistent across all
    CPUs and more up to date.  It is sampled better too, being updated once per
    timer tick.
    
    This shouldn't make much difference in scheduling behaviour, but all
    benchmarks are either as good or better on the 16-way NUMAQ: hackbench,
    reaim, volanomark are about the same, tbench and dbench are maybe a bit
    better.  kernbench is about one percent better.
    
    John reckons it isn't a big deal, but it does save 4K per CPU or 2MB total
    on his big systems, so I figure it must be a bit kinder on the caches.  I
    think it is just nicer in general anyway.

commit 47ad0fced4c434ac4f37bc9f40e840b32693e55d
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun May 9 23:25:34 2004 -0700

    [PATCH] sched: SMT niceness handling
    
    From: Con Kolivas <kernel@kolivas.org>
    
    This patch provides full per-package priority support for SMT processors
    (aka pentium4 hyperthreading) when combined with CONFIG_SCHED_SMT.
    
    It maintains cpu percentage distribution within each physical cpu package
    by limiting the time a lower priority task can run on a sibling cpu
    concurrently with a higher priority task.
    
    It introduces a new flag into the scheduler domain
    unsigned int per_cpu_gain;	/* CPU % gained by adding domain cpus */
    
    This is empirically set to 15% for pentium4 at the moment and can be
    modified to support different values dynamically as newer processors come
    out with improved SMT performance.  It should not matter how many siblings
    there are.
    
    How it works is it compares tasks running on sibling cpus and when a lower
    static priority task is running it will delay it till
    high_priority_timeslice * (100 - per_cpu_gain) / 100 <= low_prio_timeslice
    
    eg.  a nice 19 task timeslice is 10ms and nice 0 timeslice is 102ms On
    vanilla the nice 0 task runs on one logical cpu while the nice 19 task runs
    unabated on the other logical cpu.  With smtnice the nice 0 runs on one
    logical cpu for 102ms and the nice 19 sleeps till the nice 0 task has 12ms
    remaining and then will schedule.
    
    Real time tasks and kernel threads are not altered by this code, and kernel
    threads do not delay lower priority user tasks.
    
    with lots of thanks to Zwane Mwaikambo and Nick Piggin for help with the
    coding of this version.
    
    If this is merged, it is probably best to delay pushing this upstream in
    mainline till sched_domains gets tested for at least one major release.

commit a5f39fd8b3fc065350d9bd51a44c19a7b930c047
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun May 9 23:25:22 2004 -0700

    [PATCH] sched_domains: use cpu_possible_map
    
    From: Nick Piggin <piggin@cyberone.com.au>
    
    This changes sched domains to contain all possible CPUs, and check for
    online as needed.  It's in order to play nicely with CPU hotplug.

commit 482b99334b6998fbd3f2b048f90c56de33dd667b
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun May 9 23:25:11 2004 -0700

    [PATCH] sched-group-power
    
    From: Nick Piggin <piggin@cyberone.com.au>
    
    The following patch implements a cpu_power member to struct sched_group.
    
    This allows special casing to be removed for SMT groups in the balancing
    code.  It does not take CPU hotplug into account yet, but that shouldn't be
    too hard.
    
    I have tested it on the NUMAQ by pretending it has SMT.  Works as expected.
    Active balances across nodes.

commit 3de8a6b4008ae9ecdbf08d396124f6aa5ed306e4
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun May 9 23:25:00 2004 -0700

    [PATCH] sched_balance_exec(): don't fiddle with the cpus_allowed mask
    
    From: Rusty Russell <rusty@rustcorp.com.au>,
          Nick Piggin <piggin@cyberone.com.au>
    
    The current sched_balance_exec() sets the task's cpus_allowed mask
    temporarily to move it to a different CPU.  This has several issues,
    including the fact that a task will see its affinity at a bogus value.
    
    So we change the migration_req_t to explicitly specify a destination CPU,
    rather than the migration thread deriving it from cpus_allowed.  If the
    requested CPU is no longer valid (racing with another set_cpus_allowed,
    say), it can be ignored: if the task is not allowed on this CPU, there will
    be another migration request pending.
    
    This change allows sched_balance_exec() to tell the migration thread what
    to do without changing the cpus_allowed mask.
    
    So we rename __set_cpus_allowed() to move_task(), as the cpus_allowed mask
    is now set by the caller.  And move_task_away(), which the migration thread
    uses to actually perform the move, is renamed __move_task().
    
    I also ignore offline CPUs in sched_best_cpu(), so sched_migrate_task()
    doesn't need to check for offline CPUs.
    
    Ulterior motive: this approach also plays well with CPU Hotplug.
    Previously that patch might have seen a task with cpus_allowed only
    containing the dying CPU (temporarily due to sched_balance_exec) and
    forcibly reset it to all cpus, which might be wrong.  The other approach is
    to hold the cpucontrol sem around sched_balance_exec(), which is too much
    of a bottleneck.

commit db05a1928343866f8f52ab6eaf8e5acd9af4e8e3
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun May 9 23:24:49 2004 -0700

    [PATCH] sched: handle inter-CPU jiffies skew
    
    From: Nick Piggin <piggin@cyberone.com.au>
    
    John Hawkes discribed this problem to me:
    
    There *is* a small problem in this area, though, that SuSE avoids.
    "jiffies" gets updated by cpu0.  The other CPUs may, over time, get out of
    sync (and they're initialized on ia64 to start out being out of sync), so
    it's no guarantee that every CPU will wake up from its timer interrupt and
    see a "jiffies" value that is guaranteed to be last_jiffies+1.  Sometimes
    the jiffies value may be unchanged since the last wakeup.  Sometimes the
    jiffies value may have incremented by 2 (or more, especially if cpu0's
    interrupts are disabled for long stretches of time).  So an algoithm that
    says, "I'll call load_balance() only when jiffies is *exactly* N" is going
    to fail on occasion, either by calling load_balance() too often or not
    often enough.  ***
    
    I fixed this by adding a last_balance field to struct sched_domain, and
    working off that.

commit e18e19ade9a0c0334cf8a2bc1945d97ec1697061
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun May 9 23:24:38 2004 -0700

    [PATCH] sched: implement domains for i386 HT
    
    From: Nick Piggin <piggin@cyberone.com.au>
    
    The following patch builds a scheduling description for the i386
    architecture using cpu_sibling_map to set up SMT if CONFIG_SCHED_SMT is
    set.
    
    It could be made more fancy and collapse degenerate domains at runtime (ie.
    1 sibling per CPU, or 1 NUMA node in the computer).
    
    
    From: Zwane Mwaikambo <zwane@arm.linux.org.uk>
    
       This fixes an oops due to cpu_sibling_map being uninitialised when a
       system with no MP table (most UP boxen) boots a CONFIG_SMT kernel.  What
       also happens is that the cpu_group lists end up not being terminated
       properly, but this oops kills it first.  Patch tested on UP w/o MP table,
       2x P2 and UP Xeon w/ no siblings.
    
    From: "Martin J. Bligh" <mbligh@aracnet.com>,
          Nick Piggin <piggin@cyberone.com.au>
    
       Change arch_init_sched_domains to use cpu_online_map
    
    From: Anton Blanchard <anton@samba.org>
    
       Fix build with NR_CPUS > BITS_PER_LONG

commit 7a1dc0ea9e84be7175d007b19ae9d8caab13c2e5
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun May 9 23:24:26 2004 -0700

    [PATCH] sched: cpu_sibling_map to cpu_mask
    
    From: Nick Piggin <piggin@cyberone.com.au>
    
    This is a (somewhat) trivial patch which converts cpu_sibling_map from an
    array of CPUs to an array of cpumasks.  Needed for >2 siblings per package,
    but it actually can simplify code as it allows the cpu_sibling_map to be
    set up even when there is 1 sibling per package.  Intel want this, I use it
    in the next patch to build scheduling domains for the P4 HT.
    
    From: Thomas Schlichter <thomas.schlichter@web.de>
    
       Build fix
    
    From: "Pallipadi, Venkatesh" <venkatesh.pallipadi@intel.com>
    
       Fix to handle more than 2 siblings per package.

commit 3dfa303d9839496fc21d3ac47d10ff017dbb1c3a
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun May 9 23:24:15 2004 -0700

    [PATCH] scheduler domain balancing improvements
    
    From: Nick Piggin <piggin@cyberone.com.au>
    
    This patch gets the sched_domain scheduler working better WRT balancing.
    Its been tested on the NUMAQ.  Among other things it changes to the way SMT
    load calculation works so as not to active load blances when it shouldn't.
    
    It still has a problem with SMT and NUMA: it will put a task on each
    sibling in a node before moving tasks to another node.  It should probably
    start moving tasks after each *physical* CPU is filled.
    
    To fix, you need "how much CPU power in this domain?" At the moment we
    approximate # runqueues == CPU power, and hack around it at the CPU
    physical domain by counting all sibling runqueues as 1.
    
    It isn't hard to correctly work the CPU power out, but once CPU hotplug is
    in the equation it becomes much more hotplug events.  If anyone is actually
    interested in getting this fixed, that is.

commit b45bb3397e0f2e7de0301d1ebc8ed53bfdea5ebf
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun May 9 23:24:05 2004 -0700

    [PATCH] sched_domain debugging
    
    From: Nick Piggin <piggin@cyberone.com.au>
    
    Anton was attempting to make a sched domain topology for his POWER5 and was
    having some trouble.
    
    This patch only includes code which is ifdefed out, but hopefully it will
    be of some use to implementors.

commit 8c136f71934b05aebb7ffb9631415b74f0906bad
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun May 9 23:23:54 2004 -0700

    [PATCH] sched: scheduler domain support
    
    From: Nick Piggin <piggin@cyberone.com.au>
    
    This is the core sched domains patch.  It can handle any number of levels
    in a scheduling heirachy, and allows architectures to easily customize how
    the scheduler behaves.  It also provides progressive balancing backoff
    needed by SGI on their large systems (although they have not yet tested
    it).
    
    It is built on top of (well, uses ideas from) my previous SMP/NUMA work, and
    gets results very similar to them when using the default scheduling
    description.
    
    Benchmarks
    ==========
    
    Martin was seeing I think 10-20% better system times in kernbench on the 32
    way.  I was seeing improvements in dbench, tbench, kernbench, reaim,
    hackbench on a 16-way NUMAQ.  Hackbench in fact had a non linear element
    which is all but eliminated.  Large improvements in volanomark.
    
    Cross node task migration was decreased in all above benchmarks, sometimes by
    a factor of 100!!  Cross CPU migration was also generally decreased.  See
    this post:
    http://groups.google.com.au/groups?hl=en&lr=&ie=UTF-8&oe=UTF-8&frame=right&th=a406c910b30cbac4&seekm=UAdQ.3hj.5%40gated-at.bofh.it#link2
    
    Results on a hyperthreading P4 are equivalent to Ingo's shared runqueues
    patch (which is a big improvement).
    
    Some examples on the 16-way NUMAQ (this is slightly older sched domain code):
    
     http://www.kerneltrap.org/~npiggin/w26/hbench.png
     http://www.kerneltrap.org/~npiggin/w26/vmark.html
    
    From: Jes Sorensen <jes@wildopensource.com>
    
       Tiny patch to make -mm3 compile on an NUMA box with NR_CPUS >
       BITS_PER_LONG.
    
    From: "Martin J. Bligh" <mbligh@aracnet.com>
    
       Fix a minor nit with the find_busiest_group code.  No functional change,
       but makes the code simpler and clearer.  This patch does two things ...
       adds some more expansive comments, and removes this if clause:
    
          if (*imbalance < SCHED_LOAD_SCALE
                          && max_load - this_load > SCHED_LOAD_SCALE)
    		*imbalance = SCHED_LOAD_SCALE;
    
       If we remove the scaling factor, we're basically conditionally doing:
    
    	if (*imbalance < 1)
    		*imbalance = 1;
    
       Which is pointless, as the very next thing we do is to remove the
       scaling factor, rounding up to the nearest integer as we do:
    
    	*imbalance = (*imbalance + SCHED_LOAD_SCALE - 1) >> SCHED_LOAD_SHIFT;
    
       Thus the if statement is redundant, and only makes the code harder to
       read ;-)
    
    From: Rick Lindsley <ricklind@us.ibm.com>
    
       In find_busiest_group(), after we exit the do/while, we select our
       imbalance.  But max_load, avg_load, and this_load are all unsigned, so
       min(x,y) will make a bad choice if max_load < avg_load < this_load (that
       is, a choice between two negative [very large] numbers).
    
       Unfortunately, there is a bug when max_load never gets changed from zero
       (look in the loop and think what happens if the only load on the machine is
       being created by cpu groups of which we are a member).  And you have a
       recipe for some really bogus values for imbalance.
    
       Even if you fix the max_load == 0 bug, there will still be times when
       avg_load - this_load will be negative (thus very large) and you'll make the
       decision to move stuff when you shouldn't have.
    
       This patch allows for this_load to set max_load, which if I understand
       the logic properly is correct.  With this patch applied, the algorithm is
       *much* more conservative ...  maybe *too* conservative but that's for
       another round of testing ...
    
    From: Ingo Molnar <mingo@elte.hu>
    
       sched-find-busiest-fix

commit 067e0480fda41baaf5b6b2d8c2066848e775d457
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun May 9 23:23:42 2004 -0700

    [PATCH] sched: improved resolution in find_busiest_node
    
    From: Nick Piggin <piggin@cyberone.com.au>
    
    From: Frank Cornelis <frank.cornelis@elis.ugent.be>
    
    In order to get the best possible resolution we need to use NR_CPUS instead
    of the constant value 10.  load is an int, so no need to worry about
    overflows...

commit 4f20771c44e8c2e5ce6ca0b62293f71397230b8f
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun May 9 23:23:31 2004 -0700

    [PATCH] small scheduler cleanup
    
    From: Ingo Molnar <mingo@elte.hu>
    
    From: Nick Piggin <piggin@cyberone.com.au> wrote:
    
    It removes the last place where we mess with run_list open coded.

commit 2c1394f5a8ed3fdab64b3d5c8e75ee0cf6247133
Author: Dave Kleikamp <shaggy@austin.ibm.com>
Date:   Mon May 10 00:55:37 2004 -0500

    JFS: module unload was not removing /proc/fs/jfs/

commit cee97f38528b7ccd446ab4bbd16e9e909ba2b27f
Author: Jonathan McDowell <noodles@earth.li>
Date:   Sun May 9 23:52:40 2004 -0500

    [PATCH] Initio INI-9X00U/UW error handling in 2.6
    
    Plumb old error handling into new eh infrastructure.

commit f8888d23055a7628b19d23ec5dbf17ddbc5ee4cb
Author: James Bottomley <jejb@mulgrave.(none)>
Date:   Sun May 9 23:49:16 2004 -0500

    sym53c500_cs remove irq,ioport scsi attributes
    
    From: 	Bob Tracy <rct@gherkin.frus.com>

commit 93d7f97803ebcfacc29c37e62837811740310709
Author: Christoph Hellwig <hch@lst.de>
Date:   Sun May 9 23:39:21 2004 -0500

    [PATCH] mca_53c9x needs CONFIG_MCA_LEGACY

commit 69aeca906c14c44d69f31d2852319b4615497ff1
Merge: 3dc567d... 84725a0...
Author: David Mosberger <davidm@tiger.hpl.hp.com>
Date:   Sun May 9 21:38:43 2004 -0700

    Merge tiger.hpl.hp.com:/data1/bk/vanilla/linux-2.5
    into tiger.hpl.hp.com:/data1/bk/lia64/to-linus-2.5

commit 1f954ee3c35a8b649c21e44f501cf9657db0a2a6
Author: Christoph Hellwig <hch@lst.de>
Date:   Sun May 9 23:37:24 2004 -0500

    [PATCH] missing pci_set_master in megaraid

commit 47ce8a9ebb06662eec42c1d2b05e2fc7bbe389c9
Author: Christoph Hellwig <hch@lst.de>
Date:   Sun May 9 23:36:45 2004 -0500

    [PATCH] imm/ppa style police
    
    fix remaining style problems after Al ressurrected the drivers.

commit e128a80f7a2fd0e82f52a385a6e0fb7ccaa80213
Author: Andrew Vasquez <andrew.vasquez@qlogic.com>
Date:   Sun May 9 23:35:31 2004 -0500

    [PATCH] PATCH [15/15] qla2xxx: Update driver version
    
      Update version number to 8.00.00b12-k.
    
     drivers/scsi/qla2xxx/qla_version.h |    4 ++--
     1 files changed, 2 insertions(+), 2 deletions(-)

commit 2f33ec78ee69c69da5799a073af9f04562cb69d4
Author: James Bottomley <jejb@mulgrave.(none)>
Date:   Sun May 9 23:34:47 2004 -0500

    PATCH [14/15] qla2xxx: Resync with latest released firmware -- 3.02.28.
    
    From: 	Andrew Vasquez <andrew.vasquez@qlogic.com>
    
     drivers/scsi/qla2xxx/ql2300_fw.c |12380 +++++++++++++++++++--------------------
     drivers/scsi/qla2xxx/ql2322_fw.c |11812 ++++++++++++++++++-------------------
     drivers/scsi/qla2xxx/ql6312_fw.c |10174 ++++++++++++++++----------------
     drivers/scsi/qla2xxx/ql6322_fw.c |10352 ++++++++++++++++----------------
     4 files changed, 22368 insertions(+), 22350 deletions(-)

commit 1b81c67aca0b8cc3a25796c4691d8c7abfad8733
Author: Andrew Vasquez <andrew.vasquez@qlogic.com>
Date:   Sun May 9 23:31:56 2004 -0500

    [PATCH] PATCH [13/15] qla2xxx: Misc. code scrubbing
    
      Misc. driver scrubbing:
    
      	o Use kernel #define for PCI command register bit.
    
      	o Fix rate-limiting check the queue-depth module
      	  parameter.
    
      	o Clean-up comments.
    
     drivers/scsi/qla2xxx/qla_init.c |    2 +-
     drivers/scsi/qla2xxx/qla_mbx.c  |    1 -
     drivers/scsi/qla2xxx/qla_os.c   |    7 +++----
     3 files changed, 4 insertions(+), 6 deletions(-)

commit f8bbb011d9a5d4de9953e004f18cc8c0d134929c
Author: Andrew Vasquez <andrew.vasquez@qlogic.com>
Date:   Sun May 9 23:30:37 2004 -0500

    [PATCH] PATCH [12/15] qla2xxx: RIO/ZIO fixes
    
      RIO/ZIO fixes:
    
      	o Reduce register access during RIO operation by checking
      	  for a 'dirtied' signature.
    
      	o Fix problem where ZIO mode handling could result in a
      	  nasty recursive call-frame.
    
     drivers/scsi/qla2xxx/qla_os.c |    5 +----
     1 files changed, 1 insertion(+), 4 deletions(-)

commit b1fc7fe724c581aad27fa0d751d43915654423cf
Author: Andrew Vasquez <andrew.vasquez@qlogic.com>
Date:   Sun May 9 23:29:37 2004 -0500

    [PATCH] PATCH [11/15] qla2xxx: /proc fixes
    
      /proc file updates:
    
      	o Address 'unaligned access' message on ia64 platorms
      	  while displaying bit-field flags.
    
      	o Iterate through the the OS target array to display
      	  target ID bindings.
    
     drivers/scsi/qla2xxx/qla_os.c |   30 ++++++++++++------------------
     1 files changed, 12 insertions(+), 18 deletions(-)

commit 04b4e461114e04fe5e9c5cd8b9ba532f6251ee77
Author: Andrew Vasquez <andrew.vasquez@qlogic.com>
Date:   Sun May 9 23:28:20 2004 -0500

    [PATCH] PATCH [10/15] qla2xxx: Use readX_relaxed
    
      Jeremy Higdon <jeremy () sgi ! com>:
    
      	For those to whom this is new (it was discussed on linux-kernel
      	and linux-ia64 I believe), normal PCI register reads imply that
      	PCI DMA writes that occured prior to the PCI MMR (memory mapped
      	register) read (on the PCI bus) will be reflected in system
      	memory once the MMR read is complete.
    
      	On our platforms, we can speed up the MMR read significantly if
      	that ordering requirement is "relaxed".
    
      	So I attempted to find the common register reads that don't
      	have a need for this ordering so that I could make them use
      	this faster read.
    
     drivers/scsi/qla2xxx/qla_def.h  |    3 +++
     drivers/scsi/qla2xxx/qla_iocb.c |    6 +++---
     drivers/scsi/qla2xxx/qla_isr.c  |    2 +-
     3 files changed, 7 insertions(+), 4 deletions(-)

commit f3ec0ce412df74f1e0cb40301bb5fe89ca0ddd7b
Author: Andrew Vasquez <andrew.vasquez@qlogic.com>
Date:   Sun May 9 23:27:07 2004 -0500

    [PATCH] PATCH [9/15]  qla2xxx: Tape command handling fixes
    
      Fix several problems when handling commands issued to tape devices:
    
      	1) insure commands are not prematurely returned to the mid-layer
      	   with a failed status during loop/fabric transitions.
    
      	2) tape commands tend to have rather 'long' timeout values,
      	   unfortunately, as the these values increase into the 17 to
      	   20 minute range (and larger), the cumulative skew of the
      	   RISC's own timer result in commands being held for seconds
      	   beyond their defined timeout values.  Compensate for this
      	   in the driver's command timeout function.
    
     drivers/scsi/qla2xxx/qla_def.h  |    3 +
     drivers/scsi/qla2xxx/qla_init.c |    4 ++
     drivers/scsi/qla2xxx/qla_isr.c  |   10 ++---
     drivers/scsi/qla2xxx/qla_os.c   |   74 ++++++++++++++++++++++++++++++++++++----
     4 files changed, 79 insertions(+), 12 deletions(-)

commit f246122c4c0768ebc695767ddcaa3b3699a97f00
Author: Andrew Vasquez <andrew.vasquez@qlogic.com>
Date:   Sun May 9 23:25:58 2004 -0500

    [PATCH] PATCH [8/15]  qla2xxx: Volatile topology fixes
    
      Fix problem where during ISP initialization in a volatile topology
      (i.e. fabric environment with large number of streaming RSCNs) the
      driver would loop indefinitely or hang due to termination of an
      invalid thread pid.
    
     drivers/scsi/qla2xxx/qla_init.c |  142 ++++++++++++++++------------------------
     drivers/scsi/qla2xxx/qla_os.c   |    1
     2 files changed, 60 insertions(+), 83 deletions(-)

commit c2e5b0c53a4e66405c76160f4630dbf8d31894ce
Author: Andrew Vasquez <andrew.vasquez@qlogic.com>
Date:   Sun May 9 23:24:46 2004 -0500

    [PATCH] PATCH [7/15]  qla2xxx: Firmware options fixes
    
      Cleanup retrieval and update of firmware options:
    
      	o Update only valid for non-(2[12]00) ISPs.
      	o Instruct firmware to return completed IOCBs without
      	  waiting for an ABTS to complete.
    
     drivers/scsi/qla2xxx/qla_init.c |   79 +++++++++++++++++++++++++---------------
     1 files changed, 50 insertions(+), 29 deletions(-)

commit 0f08f27392b9431a5aabdb7a0f046a9d712d27af
Author: Andrew Vasquez <andrew.vasquez@qlogic.com>
Date:   Sun May 9 23:23:44 2004 -0500

    [PATCH] PATCH [6/15]  qla2xxx: LoopID downcast fix
    
      Fix problem where the driver would incorrectly down-cast the target
      loop_id while retrieving link statistics.
    
     drivers/scsi/qla2xxx/qla_gbl.h |    2 +-
     drivers/scsi/qla2xxx/qla_mbx.c |    2 +-
     2 files changed, 2 insertions(+), 2 deletions(-)

commit 4c42f515bb454eac9263f61f16f5610b78d02184
Author: Andrew Vasquez <andrew.vasquez@qlogic.com>
Date:   Sun May 9 23:21:29 2004 -0500

    [PATCH] PATCH [5/15]  qla2xxx: Debug messages during ISP abort
    
      Issue a kernel warning message before initiating an ISP abort (big
      hammer) -- additional debugging mechanism in case of event.
    
     drivers/scsi/qla2xxx/qla_mbx.c  |    9 +++++++++
     drivers/scsi/qla2xxx/qla_os.c   |    2 ++
     drivers/scsi/qla2xxx/qla_rscn.c |    2 ++
     3 files changed, 13 insertions(+)

commit e379fa31836a09af803ae72d82aa9a0b7d528f48
Author: Andrew Vasquez <andrew.vasquez@qlogic.com>
Date:   Sun May 9 23:20:18 2004 -0500

    [PATCH] PATCH [4/15]  qla2xxx: PortID binding fixes
    
      Fix problem where port ID binding would not be honoured when
      a device was moved within the fabric.
    
     drivers/scsi/qla2xxx/qla_init.c |   33 ++++++++++++++++++++++++---------
     1 files changed, 24 insertions(+), 9 deletions(-)

commit 57b43e98d7f075d3e43000c68f15cdd0d40617a1
Author: Andrew Vasquez <andrew.vasquez@qlogic.com>
Date:   Sun May 9 23:18:48 2004 -0500

    [PATCH] PATCH [3/15]  qla2xxx: 2100 request-q contraints
    
      Older, notably the ISP2100, chips have some contraints for the request
      queue depth and number of scatter-gather elements allowed for a
      given command.  For this chip, reduce request queue size to 128 and
      maximum number of scatter-gather entries for a command to 32.
    
     drivers/scsi/qla2xxx/qla_def.h  |   14 +++-----------
     drivers/scsi/qla2xxx/qla_init.c |    9 +++++----
     drivers/scsi/qla2xxx/qla_iocb.c |   14 +++++++-------
     drivers/scsi/qla2xxx/qla_os.c   |   14 +++++++++-----
     drivers/scsi/qla2xxx/qla_rscn.c |    2 +-
     5 files changed, 25 insertions(+), 28 deletions(-)

commit f8999aea7248f91ca6f91f31b1ebaacfb2812c01
Author: Andrew Vasquez <andrew.vasquez@qlogic.com>
Date:   Sun May 9 23:17:18 2004 -0500

    [PATCH] PATCH [2/15]  qla2xxx: Remove flash routines
    
      Remove flash support from embedded driver:
    
      	o Remove unused option-rom variables from host structure.
      	o Remove flash manipulation routines.
    
     drivers/scsi/qla2xxx/qla_def.h  |    2
     drivers/scsi/qla2xxx/qla_gbl.h  |    8
     drivers/scsi/qla2xxx/qla_init.c |    3
     drivers/scsi/qla2xxx/qla_sup.c  |  446 ----------------------------------------
     4 files changed, 459 deletions(-)

commit 6110fce497581ce770a251c265e6f77453a8cbd9
Author: Andrew Vasquez <andrew.vasquez@qlogic.com>
Date:   Sun May 9 23:15:55 2004 -0500

    [PATCH] PATCH [1/15]  qla2xxx: Firmware dump fixes
    
      ISP dump routine fixes:
    
      	o Properly release hardware_lock in failure path.
    
      	o Fix inability to complete ISP2100 dump, by properly
      	  reseting the RISC after register reads.
    
     drivers/scsi/qla2xxx/qla_dbg.c |   34 ++++++++++++----------------------
     1 files changed, 12 insertions(+), 22 deletions(-)

commit 09991d7e4268c41bae73404937636ce6d48ca9aa
Author: James Bottomley <jejb@mulgrave.(none)>
Date:   Sun May 9 23:15:12 2004 -0500

    MPT Fusion driver 3.01.06 update
    
    From: 	Moore, Eric Dean <Emoore@lsil.com>

commit 19101a341f13e132ec954d24cc819e51d9f69ada
Author: Brian King <brking@us.ibm.com>
Date:   Sun May 9 23:10:59 2004 -0500

    [PATCH] Make SCSI timeout modifiable
    
    add a timeout field to struct scsi_device and expose it in in sysfs.
    
    This patch allows LLDs to override the default timeout used for scsi devices
    and exposes it in sysfs. The default timeout value used is too short for
    many RAID array devices, such as those created by the ipr driver.

commit 1487936958ca9a446af9d2e7e1777ef93a5b666b
Merge: 3dc567d... 5c83baf...
Author: Dave Kleikamp <shaggy@austin.ibm.com>
Date:   Sun May 9 21:57:49 2004 -0500

    Merge jfs@jfs.bkbits.net:linux-2.5
    into austin.ibm.com:/shaggy/bk/jfs-2.5

commit b7dca46fb95b32db04f55919346d8de9e7d360df
Merge: 3dc567d... 42f57a0...
Author: Steve French <cifs.adm@hostme.bitkeeper.com>
Date:   Sun May 9 19:40:44 2004 -0700

    Merge bk://linux.bkbits.net/linux-2.5
    into hostme.bitkeeper.com:/repos/c/cifs/linux-2.5cifs

commit 4ea686bcce798a2879560df37b29dc9b5f9f6b0b
Author: Dmitry Torokhov <dtor_core@ameritech.net>
Date:   Sun May 9 15:44:03 2004 -0500

    Input: mousedev - better multiplex absolute and relative devices;
           cleanups

commit c13036e5c5e719904f05eb19ea5a2f3264109061
Author: Dmitry Torokhov <dtor_core@ameritech.net>
Date:   Sun May 9 15:40:59 2004 -0500

    Patch from Sau Dan Lee
    Input: i8042 - kill the timer only after removing interrupt handler,
           otherwise there is a chance that interrupt handler will install
           the timer again and it will trigger after module is unloaded.

commit a0b63e715e196e52b54f584781c1c4829d4359b4
Author: Dmitry Torokhov <dtor_core@ameritech.net>
Date:   Sun May 9 15:39:35 2004 -0500

    Input: split i8042 interrupt handling into an IRQ handler and a tasklet

commit 47c6252fb08daa197cf28eec3c22154c4ae9af49
Author: Dmitry Torokhov <dtor_core@ameritech.net>
Date:   Sun May 9 15:37:47 2004 -0500

    Input: do not call synaptics_init unless we are ready to do full
           mouse setup

commit 4081c2054e72acb54011c5cd8c7c05577fc30428
Author: Dmitry Torokhov <dtor_core@ameritech.net>
Date:   Sun May 9 15:36:08 2004 -0500

    Input: trailing whitespace fixes in drivers/input

commit 8810dcdc99c7bdf69b558d2de063865d96b26c9e
Author: Dmitry Torokhov <dtor_core@ameritech.net>
Date:   Sun May 9 15:34:55 2004 -0500

    Input: trailing whitespace fixes in drivers/input/gameport

commit 06d2e3732bdb16fab8ddd3f355aa0e00f4334d21
Author: Dmitry Torokhov <dtor_core@ameritech.net>
Date:   Sun May 9 15:34:21 2004 -0500

    Input: trailing whitespace fixes in drivers/input/joystick

commit a6a866702dd56688de20af086a989233f68043c5
Author: Dmitry Torokhov <dtor_core@ameritech.net>
Date:   Sun May 9 15:32:39 2004 -0500

    Input: power - add MODULE_LICENSE

commit 4a1befbb5b06e1d34b424a223873f0ce7a69f09a
Author: Dmitry Torokhov <dtor_core@ameritech.net>
Date:   Sun May 9 15:31:35 2004 -0500

    Input: trailing whitespace fixes in drivers/input/keyboard

commit e70a5c57f99b3c4f62d50820f91351dcfe222e85
Author: Dmitry Torokhov <dtor_core@ameritech.net>
Date:   Sun May 9 15:30:08 2004 -0500

    Input: twidjoy module
           - twidjoy_interrupt should return irqreturn_t
           - add MODULE_DESCRIPTION and MODULE_LICENSE

commit 3a0ee9a53a4d159f92ac4f4f6c7278afbf7d2de6
Author: Dmitry Torokhov <dtor_core@ameritech.net>
Date:   Sun May 9 15:29:33 2004 -0500

    Input: various fixes for H3600 touchscreen driver
           - h3600ts_interrupt, npower_button_handler and action_button_handler
             should return irqreturn_t
           - fix missing argument in h3600ts_process_packet call
           - add MODULE_AUTHOR, MODULE_DESCRIPTION and MODULE_LICENSE
           - small formatting changes

commit 72430fedbb214b665294d2b124a48c947b6448bc
Author: Dmitry Torokhov <dtor_core@ameritech.net>
Date:   Sun May 9 15:26:53 2004 -0500

    Input: kbd98_interrupt should return irqreturn_t

commit 7c51a30e3a7f7faad232c08cb287a4f8af425c05
Author: Dmitry Torokhov <dtor_core@ameritech.net>
Date:   Sun May 9 15:25:24 2004 -0500

    Input: kbd98io_interrupt should return irqreturn_t

commit 0370010bf1a97ae9da3a0418d290b6e8fecf2040
Author: Dmitry Torokhov <dtor_core@ameritech.net>
Date:   Sun May 9 15:23:48 2004 -0500

    Input: trailing whitespace fixes in drivers/input/serio

commit 4c6b5945658e16fdd4d372c893502d5f7da80be6
Merge: 3dc567d... 27aac88...
Author: David Airlie <drm.adm@hostme.bitkeeper.com>
Date:   Sun May 9 12:38:15 2004 -0700

    Merge http://linux.bkbits.net/linux-2.5
    into hostme.bitkeeper.com:/repos/d/drm/drm-2.6

commit 925b151ed8c34f37d19c49b6fedbac965dbdcd36
Author: David S. Miller <davem@nuts.davemloft.net>
Date:   Sun May 9 09:00:33 2004 -0700

    [TG3]: Do not write stats coalescing ticks reg on 5705/5750.

commit f91642f964fb6b878219d142183ffbe2af641f4f
Author: David S. Miller <davem@nuts.davemloft.net>
Date:   Sun May 9 08:51:30 2004 -0700

    [TG3]: Correct RDMAC/WDMAC mode settings on 5705/5750.

commit 99a4c118dabd83fd548a2b85e6e5a507c37162a0
Author: David S. Miller <davem@nuts.davemloft.net>
Date:   Sun May 9 08:33:21 2004 -0700

    [TG3]: Double delay after writing MAC_MI_MODE reg.

commit 312c45d9c1255f2bda394222c9958581f4a6443a
Author: David S. Miller <davem@nuts.davemloft.net>
Date:   Sun May 9 08:29:53 2004 -0700

    [TG3]: Do not set CLOCK_CTRL_DELAY_PCI_GRANT on PCI Express.

commit 6764aac9b93d7976d0409eac5963ab2dfeb2a584
Author: David S. Miller <davem@nuts.davemloft.net>
Date:   Sun May 9 08:26:54 2004 -0700

    [TG3]: Fix chiprev test in previous change.

commit a503f6a23c9c45572af342650de8a2797a86b446
Author: David S. Miller <davem@nuts.davemloft.net>
Date:   Sun May 9 08:22:49 2004 -0700

    [TG3]: PCI Express 5750_A0 chips need 5701_REG_WRITE_BUG treatment.

commit 7ad1b8f8510d98c048f6130ea4808913bd52c0bd
Author: David S. Miller <davem@nuts.davemloft.net>
Date:   Sun May 9 08:17:55 2004 -0700

    [TIGON3]: Detect and record PCI Express.

commit e2b48faa03e8f35f7ae3c0063ce3c1179e2a50b8
Merge: 293889f... cdce8f9...
Author: Anton Altaparmakov <aia21@cantab.net>
Date:   Sun May 9 10:34:15 2004 +0100

    Merge cantab.net:/home/src/bklinux-2.6
    into cantab.net:/home/src/ntfs-2.6

commit 42f57a044ed751cb5e6ca01f6c52f8742a81d795
Merge: 8f555e6... 412874b...
Author: Steve French <cifs.adm@hostme.bitkeeper.com>
Date:   Sat May 8 23:53:35 2004 -0700

    Merge bk://linux.bkbits.net/linux-2.5
    into hostme.bitkeeper.com:/repos/c/cifs/linux-2.5cifs

commit cdce8f9a5c64756a7e67122eeb90eba89464fc01
Merge: 08faf52... 2b20272...
Author: Anton Altaparmakov <aia21@cantab.net>
Date:   Sun May 9 01:48:34 2004 +0100

    Merge cantab.net:/home/src/bklinux-2.6
    into cantab.net:/home/src/ntfs-2.6

commit ddeb14601c180ed0fe2495c5c656e191df924595
Author: David S. Miller <davem@nuts.davemloft.net>
Date:   Sat May 8 06:57:41 2004 -0700

    [TG3]: Prepare for 5750 support plus minor fixes.
    
    1) Handle cases that apply to 5750 the same as 5705.
    2) Only set CLOCK_CTRL_FORCE_CLKRUN on 5705_A0
    3) Clear out on-chip and memory stats block right before
       setting MAC_MODE.
    4) On bootup chip probe, always skip PHY reset if link
       is up.

commit 3d6ddf6eaabb2504afa0b6616e31a6fcadc594b7
Author: David S. Miller <davem@nuts.davemloft.net>
Date:   Sat May 8 06:05:09 2004 -0700

    [TG3]: Add 5750 chip and PHY IDs.

commit c0c14b6172475eec63478c12883a5c4d6ac5806c
Author: David S. Miller <davem@nuts.davemloft.net>
Date:   Sat May 8 05:54:32 2004 -0700

    [TG3]: Add 572x/575x PCI IDs.

commit 2b2027243afd83125490d90376e2713a4c39224d
Merge: ec44dec... 492d6ea...
Author: Anton Altaparmakov <aia21@cantab.net>
Date:   Sat May 8 01:10:24 2004 +0100

    Merge cantab.net:/home/src/bklinux-2.6
    into cantab.net:/home/src/ntfs-2.6

commit 113edc279e7c2b3b3d46776efcfb58d3fd454a91
Merge: 6ffd54b... 75b09a6...
Author: Steve French <stevef@steveft21.ltcsamba>
Date:   Fri May 7 14:44:14 2004 -0500

    Merge bk://cifs.bkbits.net/linux-2.5cifs
    into steveft21.ltcsamba:/usr/src/bk/linux-2.5cifs

commit 482861fa6781395c74c34c83333faac8b5ff819d
Author: Dave Jones <davej@redhat.com>
Date:   Fri May 7 17:51:44 2004 +0100

    [CPUFREQ] Add support for Pentium M (Dothan) processors for p4-clockmod.
    But warn loudly if anyone tries to use it -- you really should use speedstep-centrino
    instead. On Dothans, the TSC is _not_ affected by TSC transitions (contrary
    to Banias processors), so set the CPUFREQ_CONST_LOOPS flag.
    
    Many thanks to Thomas Renninger for reporting the lack of, and testing
    the support for Dothan processors.

commit 6f6d1936fa9c9234630a5e5a131a73094bd22f20
Author: Dave Jones <davej@redhat.com>
Date:   Fri May 7 17:50:34 2004 +0100

    [CPUFREQ] Add support for Pentium M (Dothan) processors.
    Until further review, only ACPI data will get this driver to run - no built-in tables will exist.
    
    Many thanks to Thomas Renninger for reporting the lack of, and testing
    the support for Dothan processors.

commit 3b9f5d56f6333423166fc08e0c6715bdb9fbdda7
Author: Dave Jones <davej@redhat.com>
Date:   Fri May 7 17:49:11 2004 +0100

    [CPUFREQ] Improved Banias detection.
    The built-in tables are only valid for Pentium M (Banias) processors
    with CPUID 6/9/5. So, add a pointer to the proper struct cpu_id to the
    cpu_model struct, and re-name _CPU/CPU to _BANIAS/BANIAS

commit 523e88fef3b1835ace961cd716ef3f056a1ae9c5
Author: Dave Jones <davej@redhat.com>
Date:   Fri May 7 17:47:29 2004 +0100

    [CPUFREQ] Clean up P4 centrino detection.
    Add a new "struct cpu_id" for better handling of different Pentium M
    steppings / revisions.

commit 314a29b2b8899a02cbdbd6932293a386c446564f
Author: Dave Jones <davej@redhat.com>
Date:   Fri May 7 17:45:54 2004 +0100

    [CPUFREQ] Handle P4 TSC scaling.
    Currently, the TSC cpufreq notifiers does almost nothing on P4s, as we
    assumed the TSC to be constant independent of _all_ frequency transitions.
    Extensive testing by Karol Kozimor has shown, though, that only _throttling_
    does not affect the TSC, but _scaling_ does.
    
    So:
    - pass the CPUFREQ_CONST_LOOPS flags (to be exact, all flags) to cpufreq
      transition notifiers
    - skip TSC value changes if this flag is set
    - set this flag for P4 / P4-Ms only in p4-clockmod [On Pentium-M banias
      the TSC _is_ affected by p4-clock modulation

commit 460d0bf0ca45df0d884ffb5ff56225041bef8e5a
Author: Dave Jones <davej@redhat.com>
Date:   Fri May 7 17:44:21 2004 +0100

    [CPUFREQ] Also check whether the CPU frequency is out of sync once we get to cpufreq_notify_transition.

commit 601633f4401c12db7f869f0de665d2b06ba0399f
Author: Dave Jones <davej@redhat.com>
Date:   Fri May 7 17:43:19 2004 +0100

    [CPUFREQ] Handle CPU frequency changing behind our back.
    Once we detected 50 consecutive ticks with lost ticks (and this is half of
    the amount needed to trigger the fallback to a "sane" timesource), verify
    the CPU frequency is in sync if cpufreq is used: sometimes the CPU frequency
    changes behind the user's back, and then the TSC detects lost ticks. By a
    call to cpufreq_get(), the frequency the TSC driver thinks the CPU is in
    is updated to the actual frequency, in case these differ. Works really nice
    on my notebook -- it's never falling back to a different timesource now, even
    if I plug in the power cord.

commit a150ef02d5d538f17fef6b0731344b156f03e3bb
Author: Dave Jones <davej@redhat.com>
Date:   Fri May 7 17:41:58 2004 +0100

    [CPUFREQ] sa11x0 ->get
    sa11x0_getspeed can be used by both cpu-sa1100.c and cpu-sa1110.c as
    ->get() function. Update calling conventions, and un-export it as
    we fixed the handling of cpufreq_get in the cpufreq core. Also,
    remove special call to userspace-governor init as it isn't needed
    any longer.

commit 04958bd18070d3eed1ae8326b9cc37611bf93167
Author: Dave Jones <davej@redhat.com>
Date:   Fri May 7 17:40:59 2004 +0100

    [CPUFREQ] arm-integrator ->get() implementation
    arm-integrator had its ->get() implementation inside
    integrator_cpufreq_init(). Move it to an extra function,
    and add it as ->get() function.

commit bc301e117009559b385cfe3ee18ba911b2a22eeb
Author: Dave Jones <davej@redhat.com>
Date:   Fri May 7 17:38:00 2004 +0100

    [CPUFREQ] Use speedstep_lib's capabilites for ->get() in speedstep-smi.c

commit 6a05c71ac0fc0f3ea895b8619df9b5417c4e8bae
Author: Dave Jones <davej@redhat.com>
Date:   Fri May 7 17:37:05 2004 +0100

    [CPUFREQ] Use speedstep_lib's capabilites for ->get() in speedstep-ich.c

commit a24c67b23244047891bdf9b34baff86ae1d5c7b8
Author: Dave Jones <davej@redhat.com>
Date:   Fri May 7 17:36:26 2004 +0100

    [CPUFREQ] use speedstep_centrino's internal get function as ->get()

commit fdbfdd0bcaa710815bb6f8e13c6d0ab3c420d726
Author: Dave Jones <davej@redhat.com>
Date:   Fri May 7 17:35:39 2004 +0100

    [CPUFREQ] Add powernowk8_get()
    but be careful as some code needs to run on specified CPU only.

commit 3d4db793f36cff0539820a79402baee9f7f7c11c
Author: Dave Jones <davej@redhat.com>
Date:   Fri May 7 17:34:15 2004 +0100

    [CPUFREQ] powernow-k7->get() implementation by Bruno Ducrot.

commit 8ba685b74b544e64f20610c7d04dbe36210ed02c
Author: Dave Jones <davej@redhat.com>
Date:   Fri May 7 17:33:10 2004 +0100

    [CPUFREQ] powernow-k6 ->get
    powernow_k6 has almost all pieces in place for its own ->get() function.
    Add the rest.

commit 8a92d6632ef8ab02a19472fa3bcbd98eb7729ba9
Author: Dave Jones <davej@redhat.com>
Date:   Fri May 7 17:32:21 2004 +0100

    [CPUFREQ] Add p4-clockmod ->get
    p4-clockmod is a bit more complicated as it might run on SMP, HT, and
    the instructions need to run on the specific (physical) CPU.

commit 0344b7bf4c0c60913baf62a1b0e9ebb00e189617
Author: Dave Jones <davej@redhat.com>
Date:   Fri May 7 17:31:46 2004 +0100

    [CPUFREQ] Add longrun ->get
    Longrun users might be interested in their CPU's current frequency as
    well, so use a longrun-specific cpuid-call in longrun_get().

commit 573cb8587e25ba39d5bcd6aaf9cb59017eaf1311
Author: Dave Jones <davej@redhat.com>
Date:   Fri May 7 17:29:19 2004 +0100

    [CPUFREQ] Add a longhaul_get function.

commit e31c257dbac3d9b0f6e2c18188c1a8de1d9ea91b
Author: Dave Jones <davej@redhat.com>
Date:   Fri May 7 17:18:53 2004 +0100

    [CPUFREQ] use gx-suspmod's internal get function as ->get()

commit cc2adf351f0954a42e833f8d37aac56c58b4b931
Author: Dave Jones <davej@redhat.com>
Date:   Fri May 7 17:18:13 2004 +0100

    [CPUFREQ] use elanfreq's internal get function as ->get()

commit 4f111bebc34e7af38b9873afd2946ff3ba251401
Author: Dave Jones <davej@redhat.com>
Date:   Fri May 7 17:17:28 2004 +0100

    [CPUFREQ] Handle CPUFREQ_RESUMECHANGE notifications
    Notifications in i386, sparc64, x86_64, sh-sci and sa11xx-pcmcia notifiers.
    sa1100-framebuffer doesn't seem to be able to handle frequency transitions
    behind its back well. So, sa11xx will be marked
    CPUFREQ_PANIC_OUTOFSYNC | CPUFREQ_PANIC_RESUME_OUTOFSYNC later.

commit ceccad84774fd7e15953465b92d8d76603431860
Author: Dave Jones <davej@redhat.com>
Date:   Fri May 7 17:13:59 2004 +0100

    [CPUFREQ] (Hopefully) fix cpufreq resume support.
    
    Upon resuming, first CPUfreq hardware support needs to be re-enabled in certain cases
    (call to cpufreq_driver->resume()).
    
    Then, two different paths may need to be taken:
    a) frequency during suspend equals frequency during resume ==> everything is fine,
    
    b) frequency differ ==> either we can't handle it, then panic (see flag
       CPUFREQ_PANIC_RESUME_OUTOFSYNC). Or we can handle it, then notify all

commit 6a4a93f9c0d51b5f4ac1bd3efab53e43584330dd
Author: Dave Jones <davej@redhat.com>
Date:   Fri May 7 17:11:44 2004 +0100

    [CPUFREQ] Fix 'out of sync' issue.
    Sometimes we might discover during a call to cpufreq_get() that we're "out of sync",
    meaning the actual CPU frequency changed "behind our back". If this happens, the flag
    CPUFREQ_PANIC_OUTOFSYNC decides what can be done: if it is set, the kernel panic's,
    it it is not set, the cpufreq transition notifiers are informed of this change, and
    a call to cpufreq_update_policy() is scheduled [using the default workqueue] so that
    the user-defined values override BIOS / external interaction.

commit 98525f6faf75f24856895d6925b649b14dfd25b0
Author: Dave Jones <davej@redhat.com>
Date:   Fri May 7 17:09:07 2004 +0100

    [CPUFREQ] Export cpufreq_get() to userspace.
    As it involves calls to hardware which might take some time,
    only let the super-user read out this value.

commit 657b1437a4dde694d5153384d79540aa4909be05
Author: Dave Jones <davej@redhat.com>
Date:   Fri May 7 17:08:05 2004 +0100

    [CPUFREQ] Move cpufreq_get() from the userspace governor to the core.
    Contrary to the previous implementation, it now calls the cpufreq driver,
    and reads out the _actual_ current frequency, and not the frequency the
    CPUfreq core _thinks_ the CPU is running at. Most cpufreq drivers do provide
    such a "hw get" function (only ACPI-io can definitely not be supported,
    I'm not sure about sh, sparc64 and powermac) anyway, and it is useful for
    other issues.

commit 84725a0ea56369c161d2f8fc684d547f77ebb44c
Author: StÃ©phane Eranian <eranian@hpl.hp.com>
Date:   Fri May 7 09:07:34 2004 -0700

    [PATCH] ia64: make perfmon treat Ski simulator like real Itanium chip
    
    Remove perfmon_hpsim.c. Support is folded into perfmon_itanium.c or
    perfmon_itanium2.c depending on how Ski identifies itself via the CPU
    ID family (Merced or McKinley/Madison).  Also fix firmware emulator
    PAL_PERFMON_INFO emulation to report Itanium2 information.

commit f962f4e7410a475a44ba3711568875a7f8b7df42
Author: Dave Jones <davej@redhat.com>
Date:   Fri May 7 17:06:16 2004 +0100

    [CPUFREQ] Export scaling cur frequencies
    Many users want to know the current cpu freqeuncy, even if not using
    the userspace frequency. On ->target cpufreq drivers (if they do their
    calls to cpufreq_notify_transition correctly) this just means reading
    out cpufreq_policy->cur.

commit 412874b4380bff4ea2fabdfecd0a93915eb9cfc5
Merge: 75b09a6... 06bd137...
Author: Steve French <stevef@stevef95.austin.ibm.com>
Date:   Fri May 7 07:34:17 2004 -0500

    Merge bk://cifs.bkbits.net/linux-2.5cifs
    into stevef95.austin.ibm.com:/usr/src/bk/linux-2.5cifs

commit 06bd1373ec7cd7f67232a958c65430c3d25664a0
Author: Steve French <stevef@stevef95.austin.ibm.com>
Date:   Fri May 7 07:31:12 2004 -0500

    update readme for mode,uid,gid description

commit 5c83baf549ed243b81369640e7a56148df94443c
Author: Dave Kleikamp <shaggy@austin.ibm.com>
Date:   Fri May 7 06:05:39 2004 -0500

    JFS: [CHECKER] More robust error recovery in add_index
    
    If an error is encountered in add_index, it now leaves the index table
    in a consistent state.  Since the return value is stored in the
    directory entry regardless of add_index's success, return zero
    instead of -EPERM (which made no sense).

commit b863a25d3dca56d4c84c3cdcca089a42f1c088be
Author: Greg Kroah-Hartman <greg@kroah.com>
Date:   Fri May 7 00:22:49 2004 -0700

    Add modules to sysfs
    
    This patch adds basic kobject support to struct module, and it creates a
    /sys/module directory which contains all of the individual modules.  Each
    module currently exports the refcount (if they are unloadable) and any
    module paramaters that are marked exportable in sysfs.
    
    Was written by me and Rusty over and over many times during the past 6 months.

commit 7d19088e8a0577d9776ab6e7ecb7ab5cfaf677b3
Author: Christoph Hellwig <hch@lst.de>
Date:   Thu May 6 23:54:04 2004 -0700

    [PATCH] ia64: fix MOD_{INC,DEC}_USE_COUNT use in prominfo
    
    set proper proc_entry owner instead.  Patch OK'd by Jesse Barnes.

commit 6f7df25876230c2db4335c607eb2e06866a7bff4
Author: Dave Kleikamp <shaggy@austin.ibm.com>
Date:   Fri May 7 00:32:36 2004 -0500

    JFS: reduce stack usage

commit aaffc09d0a1d5444512184711ce1a218908ed8ee
Author: Dave Kleikamp <shaggy@austin.ibm.com>
Date:   Thu May 6 23:38:25 2004 -0500

    JFS: Avoid race invalidating metadata page

commit fb75e287ff0bfe3e20f728f793a9fd95f0ca5c00
Merge: 91ddedb... 3fcd168...
Author: Jeff Garzik <jgarzik@redhat.com>
Date:   Thu May 6 14:45:23 2004 -0400

    Merge redhat.com:/spare/repo/linux-2.6
    into redhat.com:/spare/repo/libata-2.6

commit fac70b71c54ccd8c7b2d4e78476c83d1f054aef9
Merge: 7af3243... 3a53ff4...
Author: Vojtech Pavlik <vojtech@suse.cz>
Date:   Thu May 6 18:19:31 2004 +0200

    Merge bkbits:input into suse.cz:/data/bk/input

commit 7af32430486d74d5e74be5bd520fce6c0a262830
Merge: 472bca8... 7c660b1...
Author: Vojtech Pavlik <vojtech@suse.cz>
Date:   Thu May 6 17:27:56 2004 +0200

    Merge suse.cz:/data/bk/linus into suse.cz:/data/bk/input

commit 9167522e93d5d263585e2f41d5118e4f59a90779
Author: David Mosberger <davidm@tiger.hpl.hp.com>
Date:   Thu May 6 03:46:53 2004 -0700

    ia64: Fix spurious GAS dependency-violation (dv) warnings by taking
    	advantage of two new GAS directives (.serialize.{data,instruction}).

commit 1119907912c937d27a5e975b1dae1284ae1c51df
Author: Pat Gefre <pfg@sgi.com>
Date:   Thu May 6 02:19:10 2004 -0700

    [PATCH] ia64: SN2 - remove node_first_cpu member
    
    Remove node_first_cpu member from nodepda_s and replace its usage with calls
    to sn_get_node_first_cpu().

commit 82900639748867c84aaff689a84f1429ae6c0cd6
Author: Matt Domsch <matt_domsch@dell.com>
Date:   Wed May 5 02:43:11 2004 -0700

    [PATCH] PCI: PCI devices with no PCI_CACHE_LINE_SIZE implemented
    
    On Wed, May 05, 2004 at 03:31:02PM -0700, Greg KH wrote:
    > On Thu, Apr 29, 2004 at 02:53:01PM -0500, Matt Domsch wrote:
    > > a) need this be a warning, wouldn't KERN_DEBUG suffice, if a message
    > > is needed at all?  This is printed in pci_generic_prep_mwi().
    >
    > Yes, we should make that KERN_DEBUG.  I don't have a problem with that.
    > Care to make a patch?

commit 0f5b969a27d80f7bbe2f50f85dbdcb45e38a5956
Author: David Mosberger <davidm@tiger.hpl.hp.com>
Date:   Wed May 5 02:31:54 2004 -0700

    ia64: rename "mem" boot parameter to "max_addr" and implement proper "mem"
    
    Patch by Robert Picco:
    
    This patch renames the mem bootparameter to max_addr and implements the mem
    boot parameter to work as documented (i.e., to limit the amount of memory
    to be recognized by the kernel).

commit 5716d226954f4d642162c2d313931c2acc14dbb4
Author: Arthur Othieno <a.othieno@bluewin.ch>
Date:   Wed May 5 02:24:10 2004 -0700

    [PATCH] ia64: arch/ia64/kernel/smp.c: kill duplicate #include
    
    linux/cache.h is included more than once.

commit e795a5810a15e8a2b35efe0de075818947fbcc08
Author: Bjorn Helgaas <bjorn.helgaas@hp.com>
Date:   Wed May 5 02:22:13 2004 -0700

    [PATCH] ia64: initialize IO-port-base early
    
    (start_secondary): Set up IO port base here, in case early console
    needs it.
    (smp_callin): Move IO port base setup to start_secondary().

commit c34d5588fc7cf37eafae49fd84bc983509da56a2
Author: StÃ©phane Eranian <eranian@hpl.hp.com>
Date:   Wed May 5 02:20:30 2004 -0700

    [PATCH] ia64: perfmon update
    
    - Cleanup the read/write check routines for pfm_write_pmcs,
      pfm_write_pmds, pfm_read_pmds.
    
    - Autodetect the PMU model. No need to have the kernel compiled for
      Itanium, HP Simulator, or Itanium2. The support for all PMU models
      is included.  Probing is based on processor family and
      platform_name, if necessary.  With this patch, it is possible to use
      an Itanium2 compiled kernel on an Itanium 1 system and get perfmon
      to work.
    
    - Removed remaining dependency on CONFIG_MCKINLEY by adding a new
      field (flags) to pmu_config_t.  Update /proc/perfmon to show the new
      field.
    
    - Fixed a bug in the Itanium2 pmc_ita2_write_check() where an inactive
      PMC13 would be considered active.

commit 223f4b75909baf050e95de4b7c88acaf9b423464
Author: Michael Hunold <hunold@convergence.de>
Date:   Wed May 5 02:14:40 2004 -0700

    [PATCH] I2C: add .class to i2c drivers
    
    in the "[RFC|PATCH][2.6] Additional i2c adapter flags for i2c client
    isolation" thread, the i2c people have  agreed that an ".class" field
    should be added to struct i2c_driver.
    
    Currently only drivers do checks for plausibility ("Is this an adapter I
    can attach to?"), but adapters don't have a chance to keep drivers away
    from their bus.
    
    If both drivers and adapters provide a .class entry, the i2c-core can
    easily compare them and let devices only probe on busses where they can
    really exist.
    
    Real world example: DVB i2c adapters cannot ensure that only known DVB
    i2c chipsets probe their busses. Most client drivers probe every bus
    they get their hands on. This will confuse some DVB i2c busses.
    
    With the new I2C_CLASS_ALL flag it will be possible that an adapter can
    request that really all drivers are probed on the adapter. On the other
    hand, drivers can make sure that they get the chance to probe on every
    i2c adapter out there (this is not encouraged, though)
    
    The attached patch does the first step:
    - add .class member to struct i2c_device
    - remove unused .flags member from struct i2c_adapter
    - rename I2C_ADAP_CLASS_xxx to I2C_CLASS_xxx (to be used both for
      drivers and adapters)
    - add new I2C_CLASS_ALL and I2C_CLASS_SOUND classes
    - follow these changes in the existing drivers with copy & paste

commit abfd324f692c5271600c4b845e56968999a1e804
Author: Jean Delvare <khali@linux-fr.org>
Date:   Wed May 5 01:34:40 2004 -0700

    [PATCH] I2C: Fix memory leaks in w83781d and asb100
    
    Quoting myself
    
    > U-ho. I think I've introduced a memory leak with this patch :(
    >
    > For drivers that handle subclients (asb100 and w83781d on i2c), the
    > sublient memory is never released if I read the code correctly. This
    > is because we now free the private data on unload, assuming that it
    > contains the i2c client data as well. That's true for the main i2c
    > client, but not for the subclients (data == NULL so nothing is freed).
    >
    > Could someone take a look and confirm?
    
    I could test and actually saw memory leaking when cycling the w83781d
    driver at a sustained rate (5/s).
    
    > I can see two different fixes:
    >
    > 1* When freeing the memory, free the data if it's not NULL (main
    > client), else free client (subclients). Cleaner (I suppose?).
    >
    > 2* When creating subclients, do data = &client instead of data = NULL.
    > Then freeing will work. Less code, faster. Are there side effects? (I
    > don't think so)
    >
    > My preference would go to 2*.
    
    I ended up implementing 1*. That's cleaner and there's actually almost
    no extra code.
    
    Mark, can you confirm that I'm doing the correct thing? I'll do
    something similar in our CVS repository (for now, the asb100 and w83781d
    drivers had not their memory allocation scheme reworked there).

commit 06ad1312257e8afd7944a79f68f0e814b47d9f86
Author: Jean Delvare <khali@linux-fr.org>
Date:   Wed May 5 01:34:20 2004 -0700

    [PATCH] I2C: Rewrite temperature conversions in via686a driver
    
    The following patch rewrites the temperature conversion macros and
    functions found in the via686a chip driver. Contrary to the voltage
    conversions a few weeks ago, temperature conversions were numerically
    correct, but artificially complex. The new ones are cleaner. It also
    fixes a highly improbable array overflow (would take one of the measured
    temperatures to be over 145 degrees C).
    
    Successfully tested by Mark D. Studebaker and I, and already applied to
    our CVS repository.

commit 888c8b6b70068adb54bf110fae30b75f82b66cd4
Author: Jean Delvare <khali@linux-fr.org>
Date:   Wed May 5 01:34:00 2004 -0700

    [PATCH] I2C: Invert as99127f beep bits in kernel space
    
    The following patch changes the way we invert beep bits for the AS99127F
    sensor chip. This chip behaves differently from the other chips in that
    a disabled bit is 1, not 0. So far we didn't handle that specificity in
    the w83781d driver, so it was left to user-space applications to handle
    it. For the sake of uniformity, it's obviously better if it's done in
    the driver instead (although the meaning of each bit is still
    chip-dependant).
    
    I already did a similar change to the 2.4 driver and the sensors
    program. I don't think that many user-space application will be
    affected, since most of them don't handle the beep mask as far as I can
    tell.
    
    This also close Debian bug #209299:
    http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=209299
    
    Successfully tested on my AS99127F rev.1 chip. Aurelien Jarno also
    checked that there were no regression on non-Asus chips.

commit 4ee60a144eaba9d8ca213dfa66fcbd0c4979e0bf
Author: Jean Delvare <khali@linux-fr.org>
Date:   Wed May 5 01:33:39 2004 -0700

    [PATCH] I2C: Sensors (W83627HF) in Tyan S2882

commit 009196b400ed5494adee8f093b2b3c360c579a09
Author: Daniele Bellucci <bellucda@tiscali.it>
Date:   Wed May 5 01:10:00 2004 -0700

    [PATCH] missing audit in bus_register()
    
    |How about using a goto on the error path to clean up properly
    |instead of the different return sections.
    
    .. here goes Take 2:

commit 75b09a615ffaf5be76b89b2da5370853ed15446b
Merge: 0d7b696... a34cd93...
Author: Steve French <cifs.adm@hostme.bitkeeper.com>
Date:   Wed May 5 01:04:06 2004 -0700

    Merge bk://linux.bkbits.net/linux-2.5
    into hostme.bitkeeper.com:/repos/c/cifs/linux-2.5cifs

commit 7a54ce5445641f9dcb1ba9ea9d1f347417c58daf
Author: Greg Kroah-Hartman <greg@kroah.com>
Date:   Wed May 5 00:40:43 2004 -0700

    Driver core: handle error if we run out of memory in kmap code

commit 4fe4ea20b43f3a65817db3509660d50b957c776b
Author: Herbert Xu <herbert@gondor.apana.org.au>
Date:   Wed May 5 00:32:49 2004 -0700

    [PATCH] USB Storage: Sony Clie
    
    I've received the following report which indicates that the Sony Clie needs
    the US_FL_FIX_INQUIRY flag set.
    
    http://bugs.debian.org/243650

commit ec778be8a55f970be6d2517e7941b18e81bf0639
Author: Linda Xie <lxiep@us.ibm.com>
Date:   Wed May 5 00:20:44 2004 -0700

    [PATCH] PCI Hotplug: rpaphp doesn't initialize slot's name
    
    Attached is a revised version of rpaphp.patch.  It has the following fixes:
    - Set up slot->name
    - Kill some dbgs
    - Eike's fixes
    - New fixes for incorrect "goto" in rpaphp_slot.c.

commit e6c474dcc0b4a123516ac8f224b5e58dc778ce8a
Author: Alan Stern <stern@rowland.harvard.edu>
Date:   Wed May 5 00:10:42 2004 -0700

    [PATCH] PATCH: (as268) Import device-reset changes from gadget-2.6 tree
    
    This patch imports the changes that David Brownell has made to the
    device-reset functions in his gadget-2.6 tree.  Once these ongoing
    troubling questions about locking are settled, I'll add support for the
    "descriptors changed" case.

commit c0eecb4d51d716f21af8436cf3fe40aef1db28f8
Author: Alessandro Fracchetti <al.fracchetti@tin.it>
Date:   Tue May 4 23:44:44 2004 -0700

    [PATCH] USB Storage: Kyocera Finecsm 3L -unusual_devs.h

commit a643ce4f6a45f9d88dc7550d8b0f25da70d7b7d3
Author: Alan Stern <stern@rowland.harvard.edu>
Date:   Tue May 4 23:36:39 2004 -0700

    [PATCH] USB: Small change to CPiA USB driver
    
    Only one aspect of it is notable: The CPiA USB
    driver calls usb_driver_release_interface() during its disconnect()
    routine.  That doesn't appear to be necessary, since it didn't call
    usb_driver_claim_interface() beforehand and since the interface will be
    released automatically when disconnect() returns.

commit f1b146c6e74a768ec63376fd924daa71a346b96f
Author: Alan Stern <stern@rowland.harvard.edu>
Date:   Tue May 4 23:36:11 2004 -0700

    [PATCH] USB Storage: unusual_devs.h update
    
    On 4 May 2004, Rajesh Kumble Nayak wrote:
    
    > The Above patch work fine for Sony Hc-85
    > I shall post the dmesg entry soon.
    >
    > With many thanks
    > Rajesh
    
    Greg and Pete, here's the patch.  It's possible that this entry could be
    combined with the previous one, but until we know definitely they should
    be kept separate.

commit 20cd671ac68dd7ad047fa81e65b5dde8827b40af
Author: Alan Stern <stern@rowland.harvard.edu>
Date:   Tue May 4 23:35:43 2004 -0700

    [PATCH] USB: Reduce kernel stack usage
    
    This patch allocates a temporary array from the heap instead of from the
    kernel's stack in usb_set_configuration().  It also updates a few
    comments.  Please apply.

commit fa301125fe1d1355bd6cf245f49b3272748a14c0
Author: Daniel Ritz <daniel.ritz@gmx.ch>
Date:   Tue May 4 23:35:14 2004 -0700

    [PATCH] USB: add support for eGalax Touchscreen USB
    
    this is the second version of the patch to add support for eGalax Touchkit USB
    touchscreen. changes since last patch:
    - fixed the bug in open, found by oliver neukum
    - renamed driver from touchkit.c to touchkitusb.c (since the thing also exists
      as RS232, PS/2 and I2C)
    - some minor coding style updates

commit 8dbdc693120d3b19a2b9c445777c7a554d5d55d0
Author: David Brownell <david-b@pacbell.net>
Date:   Tue May 4 23:34:46 2004 -0700

    [PATCH] USB: usbnet handles Billionton Systems USB2AR
    
    This adds another ax8817x device to "usbnet".

commit e0d9f3149d59801e2bd7140a632fb54b4ef11870
Author: Stefan Eletzhofer <stefan.eletzhofer@eletztrick.de>
Date:   Tue May 4 23:34:16 2004 -0700

    [PATCH] USB Gadget: fix g_serial debug module parm
    
    g_serial.ko can't be load as module because "debug" is only
    defined if G_SERIAL_DEBUG is defined, but "debug" is referenced
    in MODULE_PARM().

commit 770c29838dd29299417f5c574b93e8dbbe4766ed
Author: Stefan Eletzhofer <stefan.eletzhofer@eletztrick.de>
Date:   Tue May 4 23:33:47 2004 -0700

    [PATCH] USB Gadget: fix pxa define in gadget_chips.h
    
    below is a trivial patch which fixes the PXA gadget define
    in drivers/linux/usb/gadget/gadget_chips.h
    
    Everywhere CONFIG_USB_GADGET_PXA2XX is used, except in that file, which
    bites obviously ...
    
    
    Fix define for PXA UDC.

commit 821a488ef3d57d28be8e1c00e939a1f39b403328
Author: Greg Kroah-Hartman <greg@kroah.com>
Date:   Tue May 4 22:13:23 2004 -0700

    USB: add support for Zire 31 devices.
    
    Info was from Adriaan de Groot <adridg@cs.kun.nl>

commit a8b5b670d61b9855e99e6ce2e27b55fb580075ba
Author: Greg Kroah-Hartman <greg@kroah.com>
Date:   Tue May 4 22:09:08 2004 -0700

    PCI Hotplug: revert broken PCI Express hotplug patch

commit 511fec9e0e484cfe685d83ac46d166be2f6b57cc
Author: Jeff Garzik <jgarzik@redhat.com>
Date:   Tue May 4 08:50:21 2004 -0400

    [netdrvr b44] use miilib for MII ioctl handling

commit 0e27ec8693555fcfb304f1f982ef862a529791c7
Author: Jeff Garzik <jgarzik@redhat.com>
Date:   Tue May 4 08:36:29 2004 -0400

    [netdrvr b44] use netdev_priv

commit 17c5cde7367e1fcbafd316c8049e56e24379c323
Author: Jeff Garzik <jgarzik@redhat.com>
Date:   Tue May 4 08:33:55 2004 -0400

    [netdrvr b44] ethtool_ops support

commit 361f1a1aaa9072e57088d5fff92f3d5b793f9442
Author: Olaf Hering <olh@suse.de>
Date:   Tue May 4 00:16:58 2004 -0700

    [PATCH] add simple class for adb
    
    This adds /sys/class/adb/, removes unused devfs lines and updates a
    comment to match reality.

commit 0b4e43b058e8c85fd0c0e3e67685fd7e2a443085
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon May 3 23:30:28 2004 -0500

    [PATCH] support swsusp for aic7xxx
    
    From: Pavel Machek <pavel@ucw.cz>
    
    Marks threads as needed for suspend.
    DESC
    aic79xx_osm.c build fix
    EDESC
    
    drivers/scsi/aic7xxx/aic79xx_osm.c: In function `ahd_linux_dv_thread':
    drivers/scsi/aic7xxx/aic79xx_osm.c:2594: `PF_IOTHREAD' undeclared (first use in this function)

commit 7f9ddb3f52c3a6f8917256738b9efd86ae2c2e6c
Author: Randy Dunlap <rddunlap@osdl.org>
Date:   Mon May 3 23:25:05 2004 -0500

    [PATCH] (3/5) ncr53c8x: use kernel.h min/max
    
    From: Michael Veeck <michael.veeck@gmx.net>
    Subject: [Kernel-janitors] [PATCH] drivers/scsi/53c* MIN/MAX removal
    
    
    Patch (against 2.6.6-rc1) removes unnecessary min/max macros and changes
    calls to use kernel.h macros instead.
    
    
     drivers/scsi/ncr53c8xx.c      |    6 +++---
     drivers/scsi/sym53c8xx_comm.h |    5 +----
     2 files changed, 4 insertions(+), 7 deletions(-)

commit 746ffb12e3663f6b39b779518b024308a02619c3
Author: Randy Dunlap <rddunlap@osdl.org>
Date:   Mon May 3 23:24:23 2004 -0500

    [PATCH] (4/5) nsp32 (ninja): use kernel.h min/max/ARRAY_SIZE
    
    From: Michael Veeck <michael.veeck@gmx.net>
    Subject: [Kernel-janitors] [PATCH] drivers/scsi/nsp MIN/MAX/NUMBER removal
    
    Patch (against 2.6.6-rc1) removes unnecessary min/max/number macros and
    changes calls to use kernel.h macros instead.
    
    
     drivers/scsi/nsp32.c |   24 ++++++++++++------------
     drivers/scsi/nsp32.h |    4 ----
     2 files changed, 12 insertions(+), 16 deletions(-)

commit 6235d0b5314ba9e3258ee7bc70e2735534090b51
Author: Randy Dunlap <rddunlap@osdl.org>
Date:   Mon May 3 23:23:43 2004 -0500

    [PATCH] (2/5) aic7xyz_old: use kernel.h min/max/ARRAY_SIZE
    
    From: Michael Veeck <michael.veeck@gmx.net>
    Subject: [Kernel-janitors] [PATCH] drivers/scsi/aic7xxx_old MIN/MAX/NUMBER
    	removal
    
    Patch (against 2.6.6-rc1) removes unnecessary min/max/number macros and
    changes calls to use kernel.h macros instead.
    
    
     drivers/scsi/aic7xxx_old.c              |   43 ++++++++++++++------------------
     drivers/scsi/aic7xxx_old/aic7xxx_proc.c |    6 ++--
     2 files changed, 23 insertions(+), 26 deletions(-)

commit 8e46236c21f68c2d61130e9250564b241d5765f0
Author: Randy Dunlap <rddunlap@osdl.org>
Date:   Mon May 3 23:22:56 2004 -0500

    [PATCH] (5/5) pcmcia/nsp: use kernel.h min/max/ARRAY_SIZE
    
    From: Michael Veeck <michael.veeck@gmx.net>
    Subject: [Kernel-janitors] [PATCH] drivers/scsi/pcmcia MIN/MAX/NUMBER removal
    
    
    Patch (against 2.6.6-rc1) removes unnecessary min/max/number macros and
    changes calls to use kernel.h macros instead.
    
    
     drivers/scsi/pcmcia/nsp_cs.c |   12 ++++++------
     drivers/scsi/pcmcia/nsp_cs.h |    2 --
     2 files changed, 6 insertions(+), 8 deletions(-)

commit c817fa044fa4659a1baebcb37e1d50759086461f
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon May 3 23:21:23 2004 -0500

    [PATCH] aic7xxx deadlock fix
    
    We cannot call del_timer_sync() from within that timer's handler function!

commit c891f36a91745f69e1e73e03fc8798f11d2889b1
Author: Jeremy Higdon <jeremy@sgi.com>
Date:   Mon May 3 23:19:18 2004 -0500

    [PATCH] minor changes to qla1280 driver
    
    On one of our big machines we found a problem with posted writes while
    running AIM.
    
    Two writes of the Request Queue In pointer went out of order, making
    the chip think that it had a queue wrap.
    
    I took advantage of this opportunity to add relaxed reads, which helps
    the Altix.  It should not affect other arches.  All reads are relaxed
    except for the read of the Semaphore register.

commit c4cb64020fbc6b60c80f87a977b62a57abf81212
Author: Alan Stern <stern@rowland.harvard.edu>
Date:   Mon May 3 23:17:25 2004 -0500

    [PATCH] PATCH: (as255) Handle Unit Attention during INQUIRY better
    
    Some buggy USB storage devices can return Unit Attention status for
    INQUIRY commands.  The current code in scsi_scan.c checks for ASC = 0x28 =
    Not ready to ready transition, but these devices can also return ASC =
    0x29 = Power-on or reset occurred.  In addition, the code doesn't retry
    the INQUIRY when these codes are received.

commit 4e629872da4ed6690c907270c48c8b418c3bf694
Author: Bob Tracy <rct@gherkin.frus.com>
Date:   Mon May 3 23:12:32 2004 -0500

    [PATCH] sym53c500_cs PCMCIA SCSI driver (round 5)
    
    Fifth attempt at a PCMCIA SCSI driver for the Symbios 53c500
    controller.  This version has all the cleanup Christoph has requested
    to date, including removal of support for the obsolete (in 2.6)
    proc_info functionality.
    
    Support for additional sysfs class device attributes has been added:
    two are read-only (irq, ioport), one is read-write (fast_pio).  The
    read-write attribute is a per-instance flag indicating the PIO speed
    of the particular HBA: valid values are 1 (enabled -- default) and 0
    (disabled).

commit 6ffd54b15cacc402ce459b29b1b2406ea45bbe2c
Merge: 098bee4... 2ef7ad3...
Author: Steve French <stevef@steveft21.ltcsamba>
Date:   Mon May 3 17:47:36 2004 -0500

    Merge bk://cifs.bkbits.net/linux-2.5cifs
    into steveft21.ltcsamba:/usr/src/bk/linux-2.5cifs

commit a34cd93d257c1d6ea811dca44ffb2226b7c120c0
Author: Steve French <stevef@smfhome.smfdom>
Date:   Mon May 3 12:47:07 2004 -0500

    fix truncated directory listings on large directories to Samba (when Unicode and Unix extensions enabled)

commit ee9225468d8f6d2db78914138104ae0249866e92
Author: Steve French <stevef@smfhome.smfdom>
Date:   Mon May 3 12:15:58 2004 -0500

    Add smb copy function

commit 3a53ff4d1c8d57c7905e6f0a9c28c41252d57b1a
Merge: 0f19266... bcf6534...
Author: Vojtech Pavlik <vojtech@suse.cz>
Date:   Mon May 3 14:50:07 2004 +0200

    Merge suse.cz:/home/vojtech/bk/linus into suse.cz:/home/vojtech/bk/input

commit 2ef7ad377d4189251c036d56d276919766a800aa
Merge: a063296... 75e4174...
Author: Steve French <cifs.adm@hostme.bitkeeper.com>
Date:   Mon May 3 04:29:52 2004 -0700

    Merge bk://linux.bkbits.net/linux-2.5
    into hostme.bitkeeper.com:/repos/c/cifs/linux-2.5cifs

commit 7810c5f1cad17b84d8cbc65da1a63bb645c72228
Author: David Mosberger <davidm@tiger.hpl.hp.com>
Date:   Mon May 3 01:13:21 2004 -0700

    ia64: Avoid ".save rp, r0" since the kernel unwinder doesn't support it yet.
    
    Once we switch to a libunwind-based kernel unwinder, this code can be
    re-enabled again.

commit 93daaa409134bca46f996a00db86750758c70fb3
Author: Todd E. Johnson <tejohnson@yahoo.com>
Date:   Mon May 3 00:18:33 2004 -0700

    [PATCH] USB: update for mtouchusb
    
    The attached patch for the 3M Touch Systems Capacitive controller. (again)
    
    Quick list of changes:
    
       * decrease mtouch->open counter in the event of a urb submission
         failure
    
    The changes are due to comments Oliver Neukum's comments on the
    touchkit.c driver.  Good catch!  Sorry I missed it.
    
    http://marc.theaimsgroup.com/?l=linux-usb-devel&m=108343028201159&w=2

commit d351c51b41e886c664c5aa63e84e2400f5b52d9a
Author: Alan Stern <stern@rowland.harvard.edu>
Date:   Mon May 3 00:17:38 2004 -0700

    [PATCH] USB: Altsetting update for USB IrDA driver
    
    This patch updates the USB IrDA driver to take into account that the
    kernel may no longer store altsetting entries in numerical order.
    The driver only needed one change; this was a simple matter of using the
    entry corresponding to the altsetting that was just installed.

commit 42486a7dea5c1e2839db504dfe17baf21b80636f
Author: Christophe Lucas <c.lucas@ifrance.com>
Date:   Mon May 3 00:16:51 2004 -0700

    [PATCH] USB: esthetic and trivial patch.

commit 098bee4e781ea63ceaddf7264dc1f44f06bb61c5
Merge: 345e3fc... 75e4174...
Author: Steve French <stevef@steveft21.ltcsamba>
Date:   Sun May 2 20:17:41 2004 -0500

    Merge bk://cifs.bkbits.net/linux-2.5cifs
    into steveft21.ltcsamba:/usr/src/bk/linux-2.5cifs

commit 345e3fc5550c4b44c6e135e69088797c57fd7d94
Merge: e29832f... 9f7a3b7...
Author: Steve French <stevef@steveft21.ltcsamba>
Date:   Sun May 2 18:40:51 2004 -0500

    Merge bk://cifs.bkbits.net/linux-2.5cifs
    into steveft21.ltcsamba:/usr/src/bk/linux-2.5cifs

commit 75e417436d5f5e4017f341088410acc6c7816ae3
Author: Steve French <stevef@smfhome.smfdom>
Date:   Sun May 2 13:05:26 2004 -0500

    Add missing cifs protocol data unit definitions

commit b8208e0499a49c370fd05ecbb0854f14748a48c1
Author: Tony Cureington <tony.cureington@hp.com>
Date:   Sun May 2 07:56:49 2004 -0700

    [TG3]: Add eeprom dump support.

commit 38cf5e9249fc650ab8f3cf3d4ee01f41237c8906
Author: Kenn Humborg <kenn@linux.ie>
Date:   Sun May 2 06:30:19 2004 -0700

    [PATCH] Re: Platform device matching
    
    On Mon, Apr 26, 2004 at 12:27:33AM +0100, Russell King wrote:
    > So, this comment needs updating:
    >
    >  *      So, extract the <name> from the device, and compare it against
    >  *      the name of the driver. Return whether they match or not.
    
    Want a patch?

commit 571c7bece37d02c92f22fdc2b6a6b09be2931cdd
Author: Hanna V. Linder <hannal@us.ibm.com>
Date:   Sun May 2 06:29:59 2004 -0700

    [PATCH] add class support to drivers/char/tipar.c
    
    This patch adds class support to the Texas Instruments graphing calculators
    with a parallel link cable.
    
    I have verified it compiles. If someone has the hardware please verify it works.

commit f8d8c844cea6e5ccca597e6a347433ee25a735e5
Author: Hanna V. Linder <hannal@us.ibm.com>
Date:   Sun May 2 06:29:41 2004 -0700

    [PATCH] add class support to drivers/block/paride/pt.c
    
    This patch adds class support to pt.c which "the high-level driver for parallel
    port ATAPI tape drives based on chips supported by the paride module." Which I
    dont have in order to test.
    
    I have verified it compiles but can not test it. If someone who has the
    hardware could I would appreciate it.

commit 2e615ce145671178357e6e6fdf0e4e8f79a1a60e
Author: Hanna V. Linder <hannal@us.ibm.com>
Date:   Sun May 2 06:29:22 2004 -0700

    [PATCH] add class support to drivers/block/paride/pg.c
    
    This patch adds class support to pg.c, the parallel port generic ATAPI device driver.
    
    I have verified it compiles but do not have the hardware. If someone does and
    could test that would be helpful.

commit 106c7ec864a92235baaaf2db2844455dc0da05db
Author: Hanna V. Linder <hannal@us.ibm.com>
Date:   Sun May 2 06:28:58 2004 -0700

    [PATCH] Add class support to drivers/char/ip2main.c

commit 0b5efc22326143061ef8df753eecd5904a032d98
Author: Marcel Sebek <sebek64@post.cz>
Date:   Sun May 2 06:28:38 2004 -0700

    [PATCH] Class support for ppdev.c

commit e29832f8e3a51df3ac071e6a106d713015eaf14f
Author: Steve French <stevef@steveft21.ltcsamba>
Date:   Sun May 2 01:36:06 2004 -0500

    Update cifs change log

commit 83cc0fef15ec937d63799ec380a97c00204371c3
Author: Stefan Eletzhofer <stefan.eletzhofer@eletztrick.de>
Date:   Sat May 1 09:04:01 2004 -0700

    [PATCH] I2C: add I2C epson 8564 RTC chip driver
    
    Add support for the Epson 8564 RTC chip.

commit b5b5c64e560ee6565677555c25ad7960f18b2ecd
Author: Deepak Saxena <dsaxena@plexity.net>
Date:   Sat May 1 08:35:09 2004 -0700

    [PATCH] I2C: Update IXP4xx I2C bus driver
    
    The 2.6 IXP4xx code has been cleaned up to change all references to
    IXP42x/IXP425 with IXP4xx. The following patch updates the I2C bits.
    Before applying, you need to 'bk move i2c-ixp42x.c ixp-4xx.c".

commit e0c91a9832d5da177c8d9b3c9ee423350d2bfc13
Author: Kevin O\'Connor <kevin@koconnor.net>
Date:   Sat May 1 08:34:26 2004 -0700

    [PATCH] I2C: support I2C_M_NO_RD_ACK in i2c-algo-bit
    
    I have an I2C device (Samsung ks0127 video grabber) with a peculiar i2c
    implementation.  When reading bytes, it only senses for the stop condition
    in the place where the acknowledge bit should be.  So, to properly support
    this device acks need to be turned off during reads.
    
    There is an I2C_M_NO_RD_ACK bit already defined in i2c.h which appears to
    be what I want.  Unfortunately it doesn't seem to be used anywhere in the
    current tree.  At the end of this message is a patch to teach i2c_algo_bit
    to honor the bit.

commit 5c2bdb6c269fc0bcd29b14e425f42744cc1658de
Author: Jean Delvare <khali@linux-fr.org>
Date:   Sat May 1 08:33:50 2004 -0700

    [PATCH] I2C: Voltage conversions in via686a
    
    My previous patch was actually not correct, reading from the chip's
    registers was fixed but writing limits to it wasn't. This new version of
    the patch should be better. Sorry for the trouble.

commit 07e9d56e272cc6667da60694e2f3e4ef3348ce0a
Author: Greg Kroah-Hartman <greg@kroah.com>
Date:   Sat May 1 08:32:34 2004 -0700

    I2C: rename i2c-ip4xx.c driver

commit 01e05019547b5161dc92c0a5e33b3fb175ee5c08
Author: Andrew Morton <akpm@osdl.org>
Date:   Sat May 1 07:36:29 2004 -0700

    [PATCH] PCI Hotplug: pciehp-linkage-fix.patch
    
    This fixes allyesconfig

commit 0774728cc3ecb4d92c2294812c544ebcc8485f33
Author: Jean Delvare <khali@linux-fr.org>
Date:   Sat May 1 02:47:38 2004 -0700

    [PATCH] I2C: Add LM99 support to the lm90 driver
    
    The following patch adds support for the LM99 chip to the lm90 driver,
    on popular request. The nVidia GeForce FX 5900 series cards have such a
    chip on-board for monitoring the GPU temperature.
    
    Relevant pointers:
    http://archives.andrew.net.au/lm-sensors/msg07671.html
    http://secure.netroedge.com/~lm78/readticket.cgi?ticket=1661
    http://secure.netroedge.com/~lm78/readticket.cgi?ticket=1662
    
    Additional effects of the patch:
    
    * Do not consider the lm90 driver experimental anymore. I have had
    enough testers and not a single problem report, the driver is working
    OK.
    
    * Support the LM89. According to the datasheets, it is exactly the same
    chip as the LM99 (to the chip ID). We've never seen this chip in a
    computer so far, but it doesn't cost anything to support it (actually we
    cannot not support it, since we have no way to differenciate with the
    LM99).
    
    * Scan two addresses instead of one. The LM99 and LM89 have a "-1"
    variant using an alternate address.
    
    * Update copyright year.
    
    * Reword the identification code a bit. It is hopefully slightly less
    unreadable.
    
    This patch was successfully tested by Corey Hickey.

commit faf8a6b6cc5fa649fe51870c716386415d209cd3
Author: Markus Demleitner <msdemlei@cl.uni-heidelberg.de>
Date:   Sat May 1 02:24:00 2004 -0700

    [PATCH] USB: DSBR-100 tiny patch
    
    On Fri, Feb 06, 2004 at 10:17:32AM -0800, Greg KH wrote:
    > On Fri, Feb 06, 2004 at 05:06:01PM +0100, Markus Demleitner wrote:
    > > Since I finally switched over to 2.6 I noticed that my dsbr100 driver
    > > produces a warning to the effect that I should provide a release
    > > callback.  After a quick google on the issue I came to the conclusion
    >
    > No, you will have to fix up your driver to work properly, sorry.  It's
    > due to the changes to the v4l layer to handle removable devices much
    > better (and to tie it into the driver model.)
    
    I didn't get around to doing real work on this until now, but finally
    in the attachment there's my stab at bringing dsbr100 up to kernel 2.6.
    I'm not really comfortable with the release callback issues (I've yet
    to find some HOWTO-like documentation on this...) on the v4l side,
    so I'd be grateful if you could have a look at it.  I've basically
    tried to copy what stv680 does, which may or may not have been a
    good idea (in particular see the comment above the disconnect
    function).
    
    I've used the opportunity for some code beautyfing, which of course
    makes the patch a bit of a mess.  I hope you won't mind too much
    -- as you can see, it would have been pretty messy anyway.

commit 3861df46a3abb93aa91e8d95c5cfb950d6f33952
Author: David Brownell <david-b@pacbell.net>
Date:   Sat May 1 02:18:03 2004 -0700

    [PATCH] USB: dummy_hcd, root port wakeup/suspend
    
    Here's what's in my tree to make dummy_hcd do suspend and
    wakeup correctly ... that is, making its emulated root hub
    and gadget work more like real ones.
    
    It's easier to do this for fake hardware than the real stuff.
    But real drivers tend to need very similar changes ... :)
    
    - Dave
    
    p.s. This does not depend on the suspend/resume patch.
          And it doesn't do "global" suspend (of root hub).

commit b9c5051b6f0ca1d0b58746ecdf80279fa5014719
Author: Duncan Sands <baldrick@free.fr>
Date:   Sat May 1 02:02:37 2004 -0700

    [PATCH] USB: fix WARN_ON in usbfs
    
    On Tuesday 27 April 2004 10:58, Oliver Neukum wrote:
    > Am Dienstag, 27. April 2004 00:14 schrieb Greg KH:
    > > On Mon, Apr 26, 2004 at 04:05:17PM +0200, Duncan Sands wrote:
    > > > diff -Nru a/drivers/usb/core/devio.c b/drivers/usb/core/devio.c
    > > > --- a/drivers/usb/core/devio.c	Mon Apr 26 13:48:28 2004
    > > > +++ b/drivers/usb/core/devio.c	Mon Apr 26 13:48:28 2004
    > > > @@ -350,8 +350,8 @@
    > > >  	 * all pending I/O requests; 2.6 does that.
    > > >  	 */
    > > >
    > > > -	if (ifnum < 8*sizeof(ps->ifclaimed))
    > > > -		clear_bit(ifnum, &ps->ifclaimed);
    > > > +	BUG_ON(ifnum >= 8*sizeof(ps->ifclaimed));
    > >
    > > I've changed that to a WARN_ON().  Yeah, writing over memory is bad, but
    > > oopsing is worse.  Let's be a bit nicer than that.
    >
    > You aren't nice that way. An oops has localised consequences. Scribbling
    > over memory can cause anything.
    
    Hi Greg, if won't accept a BUG_ON, how about the following?

commit 2a6f7d1129c1c2b4c04784d14e8f1dbbb4c26ce1
Author: Duncan Sands <baldrick@free.fr>
Date:   Sat May 1 02:02:00 2004 -0700

    [PATCH] USB: usbfs: change extern inline to static inline
    
    And change __inline__ to inline and get rid of an unused function
    while at it.

commit bcf65342fd28ce5bb51e4e6bd472179472df9e21
Author: Todd E. Johnson <tejohnson@yahoo.com>
Date:   Fri Apr 30 22:14:24 2004 +0200

    input: Microtouch USB driver update
       Changed reset from standard USB dev reset to vendor reset
       Changed data sent to host from compensated to raw coordinates
       Eliminated vendor/product module params
       Performed multiple successfull tests with an EXII-5010UC

commit 7c660b15bbb03db9ce1293b5e8f8780a30d0c0ea
Merge: f83d9e8... f239d29...
Author: Vojtech Pavlik <vojtech@suse.cz>
Date:   Fri Apr 30 21:20:00 2004 +0200

    Merge bk://dtor.bkbits.net/input into suse.cz:/home/vojtech/bk/input-dt

commit f83d9e8d6d46740ac7ebc0717615d54bf6f950c3
Merge: 8b18832... 85e0dd4...
Author: Vojtech Pavlik <vojtech@suse.cz>
Date:   Fri Apr 30 20:46:44 2004 +0200

    Merge bkbits:input into suse.cz:/home/vojtech/bk/input

commit 8b18832a13289d7fcd489cb38982a9a92cd5b2f9
Merge: 9628945... 17303db...
Author: Vojtech Pavlik <vojtech@suse.cz>
Date:   Fri Apr 30 20:21:52 2004 +0200

    Merge suse.cz:/home/vojtech/bk/linus into suse.cz:/home/vojtech/bk/input

commit d28412d96fa117be5b054c867d208889ddb3e8e9
Author: JÃ¼rgen Stuber <stuber@loria.fr>
Date:   Fri Apr 30 08:19:36 2004 -0700

    [PATCH] USB: LEGO USB Tower driver v0.95
    
    here is the latest version 0.95 of the LEGO USB Tower driver against 2.6.6-rc3
    which corrects a lot of problems in the version currently in the kernel,
    most notably sleeping in interrupt context and improper locking.
    Please apply.
    
    It has been thoroughly tested with UHCI, OHCI and EHCI host controllers
    using Lejos and NQC.  Firmware and program download, and with proper
    modifications all communication protocols supported by Lejos work,
    as well as firmware and program download and datalog upload in NQC.
    
    Notes to application maintainers/protocol designers:
    
    - Small modifications are needed in communication protocols because
      the tower tends to discard the first byte of transmissions.
      So for example LNP needs to send an extra byte like 0xff before
      the packet, and F7 handlers needs to cope with a lost 0x55.
    
    - I suggest /dev/usb/legousbtower0 etc. as the standard device names.
      This puts it in the same place as the other USB devices and makes
      clear which driver is responsible for these devices.

commit e6ff3ede93b9ecd0661cdc03511d9ab4f70bcc25
Author: David Brownell <david-b@pacbell.net>
Date:   Fri Apr 30 08:19:00 2004 -0700

    [PATCH] USB: reject urb submissions to suspended devices
    
    This patch rejects URB submissions to suspended devices, so
    that they don't get hardware-specific fault reports.  Instead,
    they get the same code (-EHOSTUNREACH) for all HCDs.
    
    It also fixes a minor problem with colliding declarations of
    the symbol USB_STATE_SUSPENDED.

commit eb9f952ac35fa55dcec5f5cb40ec6cc25ea52ec8
Author: David Brownell <david-b@pacbell.net>
Date:   Fri Apr 30 08:17:59 2004 -0700

    [PATCH] USB Gadget: gadget zero and USB suspend/resume
    
    This patch lets gadget zero be more useful in testing usb suspend
    and resume.  It prints messages on suspend() and resume(), and
    supports an "autoresume=N" mode to wake the host after N seconds.

commit 8fba64b08d155705af9f15b4db57fb0c9cef07a2
Author: Sepp Wijnands <linux-usb@nerds-incorporated.org>
Date:   Fri Apr 30 08:16:57 2004 -0700

    [PATCH] USB: Alcatel TD10 Serial to USB converter cable support
    
    The Alcatel TD10 USB to Serial converter cable (for use with a Alcatel
    OT 535 or 735(i) mobile phone) seems to be a repackaged Alcatel
    version of the Prolific 2303 adapter.
    
    And as such, simply adding its product/vendor id (0x11f7/0x02df) to
    drivers/usb/serial/pl2303.c seems to be enough to make it work.

commit e7285d82823ff96f34de77ae509c65806ddf912a
Author: Alan Stern <stern@rowland.harvard.edu>
Date:   Fri Apr 30 08:15:51 2004 -0700

    [PATCH] USB: USB altsetting updates for IDSN Hisax driver
    
    The USB core is changing the way interfaces and altsettings are stored.
    They are no longer required to be in numerical order, and as a result,
    simply indexing the interface and altsetting arrays won't work as
    expected.
    
    This patch for the st5481 takes these changes into account.  A simpler
    approach would be to store a pointer to the struct usb_host_interface
    rather than look it up repeatedly, but I'm not very familiar with this
    driver and didn't want to attempt such an alteration.

commit 96a3b84728bd73e1ecb5ee1cc4322ce885fe44e3
Author: James Bottomley <jejb@mulgrave.(none)>
Date:   Fri Apr 30 08:36:06 2004 -0500

    Fix errors in [PATCH] aic7xxx: fix oops whe hardware is not present
    
    This patch was causing a boot panic.  Now fixed.

commit 0707d434d9e5efb8582c09b704082bc94518d8f2
Author: Greg Kroah-Hartman <greg@kroah.com>
Date:   Fri Apr 30 01:27:22 2004 -0700

    PCI Hotplug: fix build error due to previous patches.

commit 733d6bfbf94f66db168a48b0ce3274e89de5c959
Author: Rolf Eike Beer <eike-hotplug@sf-tec.de>
Date:   Fri Apr 30 01:25:10 2004 -0700

    [PATCH] SHPC PCI Hotplug: remove some useless casts
    
    Remove a useless cast: pci_add_new_bus returns a struct pci_bus*, so no need
    to cast.

commit ba51b0eb5eb819b8356d018c687e01c668277b6c
Author: Rolf Eike Beer <eike-hotplug@sf-tec.de>
Date:   Fri Apr 30 01:24:49 2004 -0700

    [PATCH] SHPC PCI Hotplug: more coding style fixes
    
    A big bunch of coding style fixes for shpchp_ctrl.c and shpchp_pci.c
    
    Eike

commit 986f187842abac042ceab803b59dc7bd3b6c8d07
Author: Rolf Eike Beer <eike-hotplug@sf-tec.de>
Date:   Fri Apr 30 01:24:15 2004 -0700

    [PATCH] SHPC PCI Hotplug: kill useless NULL checks

commit b1f8fa94998f27805763b847f314df17bbb2611d
Author: Rolf Eike Beer <eike-hotplug@sf-tec.de>
Date:   Fri Apr 30 01:23:43 2004 -0700

    [PATCH] SHPC PCI Hotplug: codingstyle fixes
    
    Some small coding style fixes for shpchp_core.c.

commit 8be9fee45ca99e9c9ce3c848045ddcfe0a1cc084
Author: Rolf Eike Beer <eike-hotplug@sf-tec.de>
Date:   Fri Apr 30 01:23:11 2004 -0700

    [PATCH] SHPC PCI Hotplug: use goto for error handling
    
    Convert shpchp_core.c::init_slots to use goto for error handling.

commit d369bfcff21f743d9d70ebc3654193451c9fc72e
Author: Rolf Eike Beer <eike-hotplug@sf-tec.de>
Date:   Fri Apr 30 01:22:36 2004 -0700

    [PATCH] SHPC PCI Hotplug: fix cleanup_slots to use a release function
    
    shpchp is the only driver which does not use a release function for the slot
    struct. This adds one and does some minor coding style fixes. Also no one
    cares about the return value of cleanup_slots (which is always 0 anyway) so
    we can make the function void.

commit cfdc4c8f540972a14e862df4ce5bfaea79bb6454
Author: Rolf Eike Beer <eike-hotplug@sf-tec.de>
Date:   Fri Apr 30 01:21:59 2004 -0700

    [PATCH] SHPC PCI Hotplug: kill hardware_test
    
    shpchp_core.c::hardware_test is empty. If we remove it we tell the user that
    hardware tests are not supported at all.

commit 0092b556a4ceb48c9e8257e3172fd55fd5c8b376
Author: Rolf Eike Beer <eike-hotplug@sf-tec.de>
Date:   Fri Apr 30 01:04:50 2004 -0700

    [PATCH] SHPC PCI Hotplug: use new style of module parameters
    
    Convert shpchp_core.c to use new style of module handling.
    
    Eike

commit ec30b7ef1372028e96e69d227a786e5bb0578eb8
Author: Rolf Eike Beer <eike-hotplug@sf-tec.de>
Date:   Fri Apr 30 01:04:23 2004 -0700

    [PATCH] RPA PCI Hotplug: codingstyle fixes for rpaphp_pci.c
    
    Some coding style fixes for rpaphp_pci.c.

commit 35b2cbab250ce06fc2ea87c8972fc0b6b5fae326
Author: Rolf Eike Beer <eike-hotplug@sf-tec.de>
Date:   Fri Apr 30 01:03:58 2004 -0700

    [PATCH] RPA PCI Hotplug: use goto for error handling in rpaphp_slot.c
    
    Convert rpaphp_slot.c::alloc_slot_struct to use goto for error handling. Also
    some small coding style fixes.

commit 42d833923921808afda345ed52044fad662a65e5
Author: Rolf Eike Beer <eike-hotplug@sf-tec.de>
Date:   Fri Apr 30 01:03:27 2004 -0700

    [PATCH] RPA PCI Hotplug: remove useless NULL checks from rpaphp_core.c
    
    Remove two useless NULL checks from rpaphp_core.c

commit 093d33e3bdb9553d75c041cbc37826f81a34a7e3
Author: Rolf Eike Beer <eike-hotplug@sf-tec.de>
Date:   Fri Apr 30 01:02:53 2004 -0700

    [PATCH] RPA PCI Hotplug: fix up init_slots in rpaphp_core.c
    
    rpaphp_core.c::init_slots is not more than a for loop and is called only from
    one place, this inlines the important 3 lines. Als add some __init and __exit.

commit c9a42cf22431e9463ad3fade41b3cec212f7c220
Author: Rolf Eike Beer <eike-hotplug@sf-tec.de>
Date:   Fri Apr 30 01:02:20 2004 -0700

    [PATCH] RPA PCI Hotplug: codingstyle fixes for rpaphp_core.c
    
    Some coding style fixes for rpaphp_core.c:
    -s/return(foo)/return foo/
    -some whitespace fixes
    -document function in proper way
    
    Eike

commit f6458739c6f911d4a77741469ead86e11a53a22d
Author: Rolf Eike Beer <eike-hotplug@sf-tec.de>
Date:   Fri Apr 30 01:01:47 2004 -0700

    [PATCH] RPA PCI Hotplug: kill get_cur_bus_speed from rpaphp_core.c
    
    The get_cur_bus_speed function of rpaphp does nothing that the PCI Hotplug Core
    would not do by itself if this function does not exist, so just kill it.

commit 4fd3215ec49cb29f3ea5cb1c7484afdf73d8af7b
Author: Rolf Eike Beer <eike-hotplug@sf-tec.de>
Date:   Fri Apr 30 01:01:13 2004 -0700

    [PATCH] RPA PCI Hotplug: use new style of module parameters
    
    The debug parameter of rpaphp is only used as a boolean so we can scan the
    commandline of it like a boolean parameter.

commit 6753894e59ad473407b6ba6c927e40e084f126bb
Author: Rolf Eike Beer <eike-hotplug@sf-tec.de>
Date:   Fri Apr 30 01:00:38 2004 -0700

    [PATCH] PCI Express Hotplug: codingstyle fixes for pciehp_pci.c
    
    This is a bunch of coding style fixes (wrap long lines, whitspacing etc.) for
    pciehp_pci.c

commit 0f0f151824b20cec705ecefa3dfcc279d76d3a97
Author: Rolf Eike Beer <eike-hotplug@sf-tec.de>
Date:   Fri Apr 30 01:00:01 2004 -0700

    [PATCH] PCI Express Hotplug: kill more useless casts
    
    This patch does two things:
    -remove casts of pointers which are void* or already the correct type for the
     target
    -if we dereferenced a struct member and copied this to it's own variable use
     this and don't dereference the member again

commit 38e0cb9dfbc02fd0cbd7db8ce6c957e8af471c67
Author: Rolf Eike Beer <eike-hotplug@sf-tec.de>
Date:   Fri Apr 30 00:52:21 2004 -0700

    [PATCH] PCI Express Hotplug: mark global variables static
    
    Don't know why, but it looks like a good idea to mark this global variables
    static.

commit bd1db4f81dd23fb6339a2ad06022feea205fd7ce
Author: Rolf Eike Beer <eike-hotplug@sf-tec.de>
Date:   Fri Apr 30 00:52:02 2004 -0700

    [PATCH] PCI Express Hotplug: some cleanups
    
    Some coding style fixes and small cleanups for pciehp_core.c:
    -wrap long lines
    -kill spaces before opening braces of functions
    -remove code duplication where both parts of an if statement do exactly the
     same
    -kill some useless comments
    -kill an unneeded initialisation

commit 0057e67fe864cd58f3a7930e466aab712f91c6f6
Author: Rolf Eike Beer <eike-hotplug@sf-tec.de>
Date:   Fri Apr 30 00:51:30 2004 -0700

    [PATCH] PCI Express Hotplug: remove useless kmalloc casts
    
    The result of kmalloc does not need to be casted to any other pointer type.
    Also use kmalloc(*foo) instead of kmalloc(type_of_foo) and wrap some long
    lines.

commit 60b395aa13a0dcb9506336ec038fbc1c4a9e679b
Author: Rolf Eike Beer <eike-hotplug@sf-tec.de>
Date:   Fri Apr 30 00:50:55 2004 -0700

    [PATCH] PCI Express Hotplug: codingstyle fixes for pciehp.h
    
    Some small coding style fixes and a typo fix for pciehp.h

commit feed13cd9c9767145fc869040aed63484c4a1dc7
Author: Rolf Eike Beer <eike-hotplug@sf-tec.de>
Date:   Fri Apr 30 00:50:28 2004 -0700

    [PATCH] PCI Express Hotplug: use goto for error handling
    
    This changes pciehp_core.c::init_slots to use goto for error hanling. Also a
    missing magic missed by previous patches is killed.

commit 9a8c14f85368fdb18057effa3171f906e3e86d86
Author: Rolf Eike Beer <eike-hotplug@sf-tec.de>
Date:   Fri Apr 30 00:49:55 2004 -0700

    [PATCH] Compaq PCI Hotplug: remove useless NULL checks from cpqphp_ctrl.c
    
    Remove useless NULL checks from cpqphp_ctrl.c. Under normal circumstances
    there is no chance for any of this functions to get called with a NULL
    argument. If we are in such trouble that we get a NULL pointer don't hide it,
    just oops.

commit 362bdfd5c1794cfb81df5255ab6b2621cabf76ce
Author: Rolf Eike Beer <eike-hotplug@sf-tec.de>
Date:   Fri Apr 30 00:49:21 2004 -0700

    [PATCH] PCI Express Hotplug: kill hardware_test
    
    The hardware_test function of the PCI Express Hotplug driver is empty. It's
    better to completely kill this to tell the user hardware tests are not
    supported by this driver.

commit fc2efe47099b79a82460d3ae26ee0beff431ee24
Author: Rolf Eike Beer <eike-hotplug@sf-tec.de>
Date:   Fri Apr 30 00:48:46 2004 -0700

    [PATCH] Compaq PCI Hotplug: kill useless kmalloc casts
    
    This patch removes the cast of kmalloc's results to the target pointer type.
    Also it fixes kmalloc to use sizeof(*foo) instead of sizeof(type_of_foo) as
    suggested by Matthew Wilcox. Also removes a few useless checks if a pointer
    is NULL before calling kfree: kfree checks this itself.

commit bc81b21c0a3a96c4cc147aaecb6a540353a36c51
Author: Rolf Eike Beer <eike-hotplug@sf-tec.de>
Date:   Fri Apr 30 00:48:11 2004 -0700

    [PATCH] RPA PCI Hotplug: Remove useless NULL checks
    
    Remove useless NULL checks and magic numbers from rpaphp. If one of these
    ever becomes invalid we are in serious trouble anyway.

commit e74a5d2fda7a17bb58c99e54f6f27e2634f06837
Author: Rolf Eike Beer <eike-hotplug@sf-tec.de>
Date:   Fri Apr 30 00:47:34 2004 -0700

    [PATCH] PCI Express Hotplug: remove useless NULL checks
    
    Remove useless NULL checks and magic numbers from PCI Express Hotplug, also
    some minimal coding style fixes.

commit 784f8f3765ee3c2cf2109c7813b59be0dc5550a0
Author: Greg Kroah-Hartman <greg@kroah.com>
Date:   Fri Apr 30 00:24:30 2004 -0700

    PCI Hotplug: fix stupid build bugs caused by previous patches.
    
    Doesn't anyone build their patches anymore before sending them out...

commit 226012f575a5cab4eb377620d554f7ffeeafb5fa
Author: Rolf Eike Beer <eike-hotplug@sf-tec.de>
Date:   Fri Apr 30 00:18:56 2004 -0700

    [PATCH] Compaq PCI Hotplug: fix missing braces
    
    Fix missing braces. It does not change the code but makes it easier to read.

commit e1cc67edb011b86024ac538e667f15d5d2a37148
Author: Rolf Eike Beer <eike-hotplug@sf-tec.de>
Date:   Fri Apr 30 00:18:21 2004 -0700

    [PATCH] PCI Express Hotplug: use new style of module parameters
    
    This converts PCI Express Hotplug to the new style of module parameter
    handling.

commit d30185f053185613c67acd337bd04b781e47017f
Author: Rolf Eike Beer <eike-hotplug@sf-tec.de>
Date:   Fri Apr 30 00:17:48 2004 -0700

    [PATCH] PCI Hotplug: Move an often used while loop to an inline function
    
    Walking through a pci_resource list and freeing all members is done a lot of
    times in unload functions. This patch moves this to an inline function in
    pciehp_core.c, pciehp_pci.c, shpchp_core.c and shpchp_pci.c. This shrinks the
    code a lot (some 200 lines) and makes it much easier to read. Also adds some
    __exit.

commit a20313b159cff865dc4bcacc842cf17701bfad18
Author: Rolf Eike Beer <eike-hotplug@sf-tec.de>
Date:   Fri Apr 30 00:17:13 2004 -0700

    [PATCH] PCI Hotplug Core: use new style of module parameters
    
    Convert PCI Hotplug Core to new style of module parameter handling.

commit b7144747b403f592aaf350f194c6c8becf67a4fc
Author: Rolf Eike Beer <eike-hotplug@sf-tec.de>
Date:   Fri Apr 30 00:16:40 2004 -0700

    [PATCH] [BUGFIX] shpchp_pci.c: fix missing braces after if
    
    Add missing braces around if statement, if not we will try to add devices
    for an empty slot.

commit 55b0d6dd6b79859925f2b506bf79e97e0ffa638e
Author: Rolf Eike Beer <eike-hotplug@sf-tec.de>
Date:   Fri Apr 30 00:16:10 2004 -0700

    [PATCH] PCI Hotplug: Remove type magic from kmalloc
    
    This patch removes the cast of kmalloc's results to the target pointer type.
    Also it fixes kmalloc to use sizeof(*foo) instead of sizeof(type_of_foo) as
    suggested by Matthew Wilcox. Also removes a few useless checks if a pointer
    is NULL before calling kfree: kfree checks this itself.

commit 720c494ea9fa4113febaa92cf21faf4fb72ae233
Author: Rolf Eike Beer <eike-hotplug@sf-tec.de>
Date:   Fri Apr 30 00:15:38 2004 -0700

    [PATCH] Compaq PCI Hotplug: some final fixes for cpqphp_core.c
    
    Final small fixes for cpqphp_core.c:
    -use better error handling in one_time_init
    -small coding style fixes
    -the name of the driver is not "pci_hotplug"
    -add an __exit for unload_cpqphp
    -changes enough to increment version, isn't it?

commit 34e74d4c5371ac712b72ce9b90c04fc8a2d0f084
Author: Rolf Eike Beer <eike-hotplug@sf-tec.de>
Date:   Fri Apr 30 00:15:05 2004 -0700

    [PATCH] Compaq PCI Hotplug: coding style fixes for cpqphp_ctrl.c
    
    Some coding style fixes I missed last time.

commit 965082470b49bd9e71f75de5cef0ec0f0d9530a8
Author: Rolf Eike Beer <eike-hotplug@sf-tec.de>
Date:   Fri Apr 30 00:14:30 2004 -0700

    [PATCH] Compaq PCI Hotplug: use goto for error handling in cpqphp_ctrl.c
    
    Change cpqphp_ctrl.c to use goto for error handling.

commit 36e4a84812e030437e3a3bcea249f71b6f22ef84
Author: Rolf Eike Beer <eike-hotplug@sf-tec.de>
Date:   Fri Apr 30 00:13:57 2004 -0700

    [PATCH] Compaq PCI Hotplug: fix C++ style comments
    
    This is not C++! Fix comments from C++ style to C style, removing some useless
    ones (e.g. no need to tell up and down protect a critical section).

commit c131843c20dc791b51c1f029a0152285f6f331b9
Author: Rolf Eike Beer <eike-hotplug@sf-tec.de>
Date:   Fri Apr 30 00:13:24 2004 -0700

    [PATCH] Compaq PCI Hotplug: remove useless NULL checks from cpqphp_core.c
    
    Remove some useless NULL checks in cpqphp_core.c

commit 989c2fa6ebe18681253ac8eca4a95069f8b76e84
Author: Rolf Eike Beer <eike-hotplug@sf-tec.de>
Date:   Fri Apr 30 00:12:50 2004 -0700

    [PATCH] Compaq PCI Hotplug: use goto for error handling
    
    Convert ctrl_slot_setup to use goto for error handling and fix some minor
    coding style things.

commit 3458f649d78850583fa03164575592677f918f2a
Author: Rolf Eike Beer <eike-hotplug@sf-tec.de>
Date:   Fri Apr 30 00:12:23 2004 -0700

    [PATCH] Compaq PCI Hotplug: split up hardware_test
    
    This puts the LED shifting used as "hardware test" in a function to make
    cpqhp_hardware_test much smaller and easier to read. Also changes some
    comments from C++ to C style.

commit ef64cfb012c1a58ef23eb5cd3e031d1eb450d1af
Author: Rolf Eike Beer <eike-hotplug@sf-tec.de>
Date:   Fri Apr 30 00:11:54 2004 -0700

    [PATCH] Compaq PCI Hotplug: more coding style fixes
    
    Fix a lot of coding style issues in Compaq PCI hotplug:
    -spaces before opening brace of functions
    -much too much C++ style comments
    -wrap long lines
    -remove some comments where the code does not really need to be explained
    
    Eike

commit ab24376f9f7a7606004e5685439269a5608d0742
Author: Rolf Eike Beer <eike-hotplug@sf-tec.de>
Date:   Fri Apr 30 00:11:19 2004 -0700

    [PATCH] Compaq PCI Hotplug: use new style of module parameters
    
    Convert Compaq PCI Hotplug driver to use the new style of module parameters.

commit b65c163905c8bc3ebaa886285c3f5cb96637f845
Author: Rolf Eike Beer <eike-hotplug@sf-tec.de>
Date:   Fri Apr 30 00:10:45 2004 -0700

    [PATCH] Compaq PCI Hotplug: move huge inline function out of header file
    
    set_controller_speed is implemented in cpqphp.h but only used in cpqphp_ctrl.c
    and it's much too big to be defined in a header file. This patch moves it to
    cpqphp_ctrl.c. Also the inline attribute is removed, this function is called
    from 2 places and to big to be an inline.

commit 192e1cac07d5e5e18ec835914a36176a298cb36e
Author: Rolf Eike Beer <eike-hotplug@sf-tec.de>
Date:   Fri Apr 30 00:10:12 2004 -0700

    [PATCH] Compaq PCI Hotplug: remove useless NULL checks
    
    Remove some useless NULL and magic checks from Compaq PCI Hotplug driver.
    If one of this pointers is invalid we are in bad trouble anyway.

commit d8758fa71d992bf417b512df314f1ea3b0e114db
Author: Rolf Eike Beer <eike-hotplug@sf-tec.de>
Date:   Fri Apr 30 00:09:35 2004 -0700

    [PATCH] Compaq PCI Hotplug: coding style fixes
    
    The usual coding style fixes, this time for cpqphp_ctrl.c and cpqphp.c.

commit c61b1d9338b89a775043f68db0d012efc65957de
Author: Rolf Eike Beer <eike-hotplug@sf-tec.de>
Date:   Thu Apr 29 02:14:39 2004 -0700

    [PATCH] PCI Express Hotplug: splut pciehp_ctrl.c::configure_new_function
    
    configure_new_function is way too big (>600 lines). Split it in 2 functions,
    one for the new functions and one for bridges. And split out a small piece
    from the bridge function which is used twice to it's own function.
    
    Patch is huge because of the identation changes but does nothing than the
    split and some minor coding style changes.

commit 30c6a0e8889aa6392accc093343428b2ea474541
Author: Rolf Eike Beer <eike-hotplug@sf-tec.de>
Date:   Thu Apr 29 02:14:14 2004 -0700

    [PATCH] PCI Express Hotplug: remove useless kmalloc casts
    
    The result of kmalloc does not need to be casted, it is a void * which can be
    assigned to any pointer variable. Also avoid code duplication in one if
    statement.

commit 2e36dd6b9d36977e3c1223d2cb551bcae0f7d177
Author: Rolf Eike Beer <eike-hotplug@sf-tec.de>
Date:   Thu Apr 29 02:13:41 2004 -0700

    [PATCH] PCI Express Hotplug: fix coding style

commit 7ab60fc1b8e72e4946470645e07485f35d83dffe
Author: Rolf Eike Beer <eike-hotplug@sf-tec.de>
Date:   Thu Apr 29 02:04:49 2004 -0700

    [PATCH] PCI Hotplug skeleton: final cleanups
    
    Some final fixes for the skeleton driver:
    -spaces before opening brace
    -add a better example for hardware_test function
    -remove a "int retval" in a void function
    -some more coding style changes
    -changed enough stuff: increase version number
    -fix a typo in a comment

commit e189d815881d3ece2a02a76db677f9de296bcfb0
Author: Rolf Eike Beer <eike-hotplug@sf-tec.de>
Date:   Thu Apr 29 02:04:00 2004 -0700

    [PATCH] PCI Hotplug skeleton: use goto for error handling
    
    Convert PCI hotplug skeleton driver to use goto for error handling in
    init_slots to avoid code duplication.

commit ebf2a656c4af4c3031c6729aca88287043d84c72
Author: Rolf Eike Beer <eike-hotplug@sf-tec.de>
Date:   Thu Apr 29 02:03:26 2004 -0700

    [PATCH] PCI Hotplug skeleton: mark functions __init/__exit
    
    Add __init and __exit to some functions only called from __init/__exit context.

commit 5b307d3b66be2dfbe2b63bc380b398b3ba183e81
Author: Rolf Eike Beer <eike-hotplug@sf-tec.de>
Date:   Thu Apr 29 02:02:44 2004 -0700

    [PATCH] PCI Hotplug skeleton: fix codingstyle
    
    Coding style fixes for pcihp_skeleton.c: remove spaces before opening braces
    and change a comment in function hardware_test to make clearer that the
    functions purpose is not to tell the user there are no tests.

commit 2f167387d3d79c2f155ce7d605ba9a7d8b74a6e9
Author: Rolf Eike Beer <eike-hotplug@sf-tec.de>
Date:   Thu Apr 29 02:02:12 2004 -0700

    [PATCH] PCI Hotplug skeleton: remove useless NULL checks
    
    This one removes all the useless NULL checks including slot_paranoia_check,
    get_slot and the magic number from the PCI hotplug skeleton driver. Also some
    lines containing only a single tab are fixed.

commit 1d9838f5511107091f5ffb13c73cdbe4df934fe2
Author: Rolf Eike Beer <eike-hotplug@sf-tec.de>
Date:   Thu Apr 29 02:01:34 2004 -0700

    [PATCH] PCI Hotplug skeleton: use new style of module parameters
    
    Convert the PCI hotplug skeleton driver to use new style of module parameter
    handling.

commit 8f4fe7852694eefdcd802c901b8c6c68aa8419b8
Author: Rolf Eike Beer <eike-hotplug@sf-tec.de>
Date:   Thu Apr 29 01:52:30 2004 -0700

    [PATCH] ACPI PCI Hotplug: add a BUG() where one should be
    
    If there is a condition with the comment "should never happen" it is a good
    place for a BUG() if it is ever reached.

commit 852ca6168df0eda90070f994dcb2d408dd291a74
Author: Rolf Eike Beer <eike-hotplug@sf-tec.de>
Date:   Thu Apr 29 01:51:57 2004 -0700

    [PATCH] ACPI PCI Hotplug: coding style fixes
    
    Some minor coding style fixes:
    -space before opening brace of function
    -wrap some long lines
    -change some identations from spaces to tabs

commit 51c59514418cc411d5e6fd9ca325e9944a58aa2c
Author: Rolf Eike Beer <eike-hotplug@sf-tec.de>
Date:   Thu Apr 29 01:51:27 2004 -0700

    [PATCH] ACPI PCI Hotplug: use goto for error handling
    
    This one fixes another space before an opening brace I missed before and
    optimizes the error paths in init_slots a bit more.

commit ae177142754f8a8ce76375537da7d7910b7cd8e6
Author: Rolf Eike Beer <eike-hotplug@sf-tec.de>
Date:   Thu Apr 29 01:50:56 2004 -0700

    [PATCH] ACPI PCI Hotplug: kill magic number
    
    The magic slot number was only another type of checking the validity of a
    pointer. These checks are all gone so magic can follow them.

commit 574b8399ec236c09cdafc078caae666be5873134
Author: Rolf Eike Beer <eike-hotplug@sf-tec.de>
Date:   Thu Apr 29 01:50:22 2004 -0700

    [PATCH] ACPI PCI Hotplug: use new style of module parameters
    
    This one converts acpiphp_core.c to use the new interface for module
    parameters.

commit a46776b808b9a5b2dba40f5391f9184f9e94adb1
Author: Rolf Eike Beer <eike-hotplug@sf-tec.de>
Date:   Thu Apr 29 01:01:10 2004 -0700

    [PATCH] CompactPCI Hotplug ZT5550: use new style of module parameters
    
    Convert the driver to use new interface for module parameters, Also fix the
    driver name used in debug messages.
    
    Eike

commit 90815e652ff8a5e067ee4f9814993074eb490ac9
Author: Rolf Eike Beer <eike-hotplug@sf-tec.de>
Date:   Thu Apr 29 00:59:12 2004 -0700

    [PATCH] CompactPCI Hotplug: kill magic number
    
    slot->magic is not used anymore since slot_paranoia_check is dead, so just kill
    it.

commit 84ce62fb7b9031e92a8d7c05b9d288e99a6a21e3
Author: Rolf Eike Beer <eike-hotplug@sf-tec.de>
Date:   Thu Apr 29 00:53:25 2004 -0700

    [PATCH] CompactPCI Hotplug: remove unneeded funtion for parameter handling
    
    A special function for handling the parameters in non-module case is not
    needed, the MODULE_* makros handle this also for compiled in situations.

commit 2b62c600e18d52f6745403a5bef36e6260819f6d
Author: Rolf Eike Beer <eike-hotplug@sf-tec.de>
Date:   Thu Apr 29 00:26:03 2004 -0700

    [PATCH] PCI Hotplug: Clean up acpiphp_core.c: remove 3 get_* functions
    
    If we remove this 3 get_* functions the pci hotplug core will do the same
    thing for us.

commit bb42a61455d825a10d58f7bcdebd2ecc23b9cba3
Author: Rolf Eike Beer <eike-hotplug@sf-tec.de>
Date:   Thu Apr 29 00:25:28 2004 -0700

    [PATCH] PCI Hotplug: Clean up acpiphp_core.c: return
    
    Fix 2 very ugly return constructs.

commit c81770f864ed9ac9443592474c631e71c6918433
Author: Rolf Eike Beer <eike-hotplug@sf-tec.de>
Date:   Thu Apr 29 00:25:00 2004 -0700

    [PATCH] PCI Hotplug: Clean up acpiphp_core.c: use goto for error handling
    
    This one converts the error handling in init_slots to use gotos to avoid code
    duplication.

commit b77abdc7ff2a043a235c854cf8d1d7bb55a0ffed
Author: Rolf Eike Beer <eike-hotplug@sf-tec.de>
Date:   Thu Apr 29 00:24:32 2004 -0700

    [PATCH] PCI Hotplug: Clean up acpiphp_core.c: kill hardware_test
    
    The function hardware_test only tells that there are no tests. If we just
    kill it the file "test" in the slot's directory will not show up which
    means pretty much the same.

commit 24fd384bf569b12a549b9664c3a26d9c2b919442
Author: Rolf Eike Beer <eike-hotplug@sf-tec.de>
Date:   Thu Apr 29 00:24:01 2004 -0700

    [PATCH] PCI Hotplug: Clean up acpiphp_core.c: coding style
    
    This patch kills the space before the opening brace in function
    declarations. It also beautifies some ugly return statements.

commit 70ae51eeaaea7e12e89f12244b29fefa04d73f2b
Author: Rolf Eike Beer <eike-hotplug@sf-tec.de>
Date:   Thu Apr 29 00:23:32 2004 -0700

    [PATCH] PCI Hotplug: Clean up acpiphp_core.c: slot_paranoia_check
    
    Matthew Wilcox wrote:
    > On Thu, Apr 22, 2004 at 01:18:23PM +0200, Rolf Eike Beer wrote:
    > > slot_paranoia_check is only another kind of checking everything for NULL.
    > > Removing this leads to function get_slot is reduced to a simple cast, so
    > > this function can be killed also.
    >
    > Since private is void *, you don't even need the casts.
    >
    > >  static int enable_slot (struct hotplug_slot *hotplug_slot)
    > >  {
    > > -	struct slot *slot = get_slot(hotplug_slot, __FUNCTION__);
    > > +	struct slot *slot = (struct slot *)hotplug_slot->private;
    >
    > 	struct slot *slot = hotplug_slot->private;
    >
    > is enough.
    
    Fixed.

commit f7fdea0bd084a35090a2044814029fb6924a2269
Author: Rolf Eike Beer <eike-hotplug@sf-tec.de>
Date:   Thu Apr 29 00:23:01 2004 -0700

    [PATCH] PCI Hotplug: Clean up acpiphp_core.c: null checks
    
    If the "struct hotplug_struct *" parameter to any function in
    hotplug_slots_ops is ever NULL something bogus is going on. In this case we
    should just oops and not hide the bug. This also fixes the driver name used in
    debug messages.

commit 77ddc7449705d642f73aff8901046bb54d4b9fb5
Author: John Rose <johnrose@austin.ibm.com>
Date:   Thu Apr 29 00:07:10 2004 -0700

    [PATCH] PCI Hotplug: RPA DLPAR remove slot, return code fix

commit b59f07cfd2022d67069a9a4ed930064a661ad1f5
Author: Linda Xie <lxiep@us.ibm.com>
Date:   Thu Apr 29 00:01:19 2004 -0700

    [PATCH] PCI Hotplug: rpaphp: set eeh option (enabled ) prior to any i/o to newly added IOA
    
    Attached patch fix the problem I have found during DLPAR I/O slots
    testing on our new hardware.  rpaphp needs to set eeh-option(eanbled)
    for newly added IOA prior to performing PCI config(pci_setup_device),
    otherwise the pci_dev of the IOA will have invalid base address
    information.
    
    Linas Vepstas impleted eeh changes.

commit 07608e1e22dbc2dc9230188c3268d837ed660fe3
Author: Jochen Hein <jochen@jochen.org>
Date:   Wed Apr 28 23:17:35 2004 -0700

    [PATCH] PCI: message cleanup in PCI probe
    
    The messages read:
    
    PCI: Address space collision on region 8 of bridge 0000:00:1f.0 [1180:11bf]
    PCI: Ignoring BAR0-3 of IDE controller 0000:00:1f.1
    Transparent bridge - 0000:00:1e.0
    PCI: Using IRQ router PIIX/ICH [8086/24cc] at 0000:00:1f.0
    PCI: Found IRQ 11 for device 0000:00:1f.1
    
    The following patch adds "PCI: " in front of the message and KERN_INFO as well.
    Compile&boot tested.
    
    Jochen

commit 011ac688592b52f035083bd4a897f6d0cbf85f4d
Author: Jochen Hein <jochen@jochen.org>
Date:   Wed Apr 28 23:16:38 2004 -0700

    [PATCH] PCI: I'm moving
    
    Can you please feed the following patch to Andrew?

commit 5d573a3fd98364b78874263debc9ee92143b7a30
Author: Deepak Saxena <dsaxena@plexity.net>
Date:   Wed Apr 28 23:15:55 2004 -0700

    [PATCH] PCI: pci.ids update from sf.net + add IXP4xx to pci_ids.h

commit 5f90abee1f869b66e80a5e8b7609b8a602a396c5
Author: Greg Kroah-Hartman <greg@kroah.com>
Date:   Wed Apr 28 20:47:50 2004 -0700

    USB: fix build error in hci_usb driver due to urb reference count change.
    
    This really needs to get fixed the proper way, by making the urb allocation
    dynamic in the driver, instead of the hack it is currently doing...

commit 460e95afe79111239942bb81524279826610f00d
Author: Greg Kroah-Hartman <greg@kroah.com>
Date:   Wed Apr 28 20:40:57 2004 -0700

    USB: remove the wait_for_urb function from bfusb driver as it's no longer needed.

commit f65763d340e7d36b433a0ed478dac3b5b21adc0f
Author: Sean Young <sean@mess.org>
Date:   Wed Apr 28 07:43:38 2004 -0700

    [PATCH] USB: fix PhidgetServo driver
    
    Somehow I managed to send the wrong version. Here is a patch which fixes
    that. (Remove a dev_info() which wasn't supposed to be there, and make sure
    that everything is still consistent in the unlikely event that kmalloc()
    fails). Just minor cleanups.

commit e6f2894bebb95aababe3db443db7ca5f036fc98f
Merge: 8419e5f... d675336...
Author: Greg Kroah-Hartman <greg@kroah.com>
Date:   Wed Apr 28 07:08:44 2004 -0700

    Merge gregkh@kernel.bkbits.net:linux/usb-2.6
    into kroah.com:/home/greg/linux/BK/usb-2.6

commit 5053dc60a0384d647ac42819590431b71a2a175f
Author: James Bottomley <jejb@mulgrave.(none)>
Date:   Wed Apr 28 01:32:17 2004 -0500

    Cset exclude: jejb@mulgrave.(none)|ChangeSet|20040404150128|05866
    
    scsi_get_device needs no NULL check

commit d6753366986448118990aab1ab3773ed429245cf
Author: David Brownell <david-b@pacbell.net>
Date:   Tue Apr 27 23:25:14 2004 -0700

    [PATCH] USB: fix sparc64 2.6.6-rc2-mm2 build busted: usb/core/hub.c hubstatus
    
    > 2) An undefined 'hubstatus' variable in drivers/usb/core/hub.c:
    >
    >       CC      drivers/usb/core/hub.o
    >     drivers/usb/core/hub.c: In function `hub_port_connect_change':
    >     drivers/usb/core/hub.c:1343: error: `hubstatus' undeclared (first use in this function)
    >     drivers/usb/core/hub.c:1343: error: (Each undeclared identifier is reported only once
    >     drivers/usb/core/hub.c:1343: error: for each function it appears in.)
    >     make[3]: *** [drivers/usb/core/hub.o] Error 1
    >
    >   As a total shot in the dark, the following fixes the build (I've no clue
    >   if it is the right fix):
    
    Yes, it's the right fix.  Greg, please merge the attached patch,
    which will be needed on any big-endian system.

commit 59c2deedbb7d5e707caff791e8b2b09fe285c8af
Author: Alan Stern <stern@rowland.harvard.edu>
Date:   Tue Apr 27 21:52:21 2004 -0700

    [PATCH] USB: Lock devices during tree traversal
    
    On Tue, 27 Apr 2004, Greg KH wrote:
    
    > So, what's next in this patch series?  :)
    
    Funny you should ask...
    
    While writing those patches I noted a problem, that the USB device tree
    can change while a process reading /proc/bus/usb/devices is traversing it,
    leading to an oops when a pointer to a no-longer-existing child device is
    dereferenced.  The ensuing discussion led to the conclusion that the
    devices' ->serialize locks should be acquired, top-down, while going
    through the tree.
    
    That means changing the code that populates the devices file and changing
    the code that adds and removes USB device structures.  This patch takes
    care of the first part.  I'm delaying the second part because that section
    of usbcore is still under change -- David Brownell's revisions have not
    yet been fully integrated.
    
    A similar change should be made to usb_find_device() and match_device() in
    usb.c.  You may want to add that yourself.

commit df6ed9920eef30278bf320937655aa7f3a36a9d1
Author: Sean Young <sean@mess.org>
Date:   Tue Apr 27 21:51:52 2004 -0700

    [PATCH] USB: add new USB PhidgetServo driver
    
    Here is a driver for the usb servo controllers from Phidgets
    <http://www.phidgets.com/>, using sysfs.
    
    Note that the devices claim to be hid devices, so I've added them to the
    hid_blacklist (HID_QUIRK_IGNORE). A servo controller isn't really an hid
    device (or is it?).

commit 5faee7a33fdf49041c451e3099615c52f0f3ace1
Author: Greg Kroah-Hartman <greg@kroah.com>
Date:   Tue Apr 27 21:51:03 2004 -0700

    My cleanups to the smbios driver.

commit d2d64066658aa83fe0a8c992cdace1dd785b555b
Author: Michael E. Brown <michael_e_brown@dell.com>
Date:   Tue Apr 27 21:50:29 2004 -0700

    [PATCH] add SMBIOS tables to sysfs -- UPDATED

commit 7882eca50995d5dd8dbf8dca49c781a761fe8bc1
Author: Greg Kroah-Hartman <greg@kroah.com>
Date:   Tue Apr 27 03:33:52 2004 -0700

    USB: fix compiler warnings in devices.c file.

commit 3fcd16805b12ba8cb05c306824a1396dcbd90fd8
Author: Jeff Garzik <jgarzik@redhat.com>
Date:   Tue Apr 27 06:02:13 2004 -0400

    [libata sata_sx4] trivial: fix filename in header

commit 9df38a80ba029924bce8bb8b22b2377323e9a8f2
Author: Alan Stern <stern@rowland.harvard.edu>
Date:   Tue Apr 27 02:02:32 2004 -0700

    [PATCH] USB: Allocate interface structures dynamically
    
    This is a revised version of an earlier patch; I feel a lot better about
    this one.  Basically it does the same thing as before: allocate
    interfaces dynamically to avoid the problems with reusing them.
    
    The difference is that this patch adds a struct kref to the array of
    usb_interface_cache's, so the array can persist if needed after the
    device has been disconnected.  Each interface takes a reference to it
    (along with the configuration itself), so as long as the interfaces
    remain pinned in memory the altsettings will also remain.
    
    Here is a slight revision of patch as246b.  This one allocates all the new
    interfaces before changing any other state; otherwise it's the same.

commit e5975ae4570d53e36709c77a7c02c632cce9134d
Author: Greg Kroah-Hartman <greg@kroah.com>
Date:   Tue Apr 27 01:22:05 2004 -0700

    USB: fix incorrect usb-serial conversion for cur_altsetting from previous patch.

commit d2435050a33ae16c48aa5b1a430bd0a9c0e20acc
Author: Greg Kroah-Hartman <greg@kroah.com>
Date:   Tue Apr 27 00:45:49 2004 -0700

    USB: make ehci driver use a kref instead of an atomic_t

commit cb71655f30c274eb697614f29d74ca9645cced54
Author: Greg Kroah-Hartman <greg@kroah.com>
Date:   Tue Apr 27 00:21:13 2004 -0700

    USB: removed unused atomic_t in keyspan driver structure.

commit 8c61259da813801c63dd5f7f6de4d7212cbd774c
Author: Greg Kroah-Hartman <greg@kroah.com>
Date:   Mon Apr 26 03:07:28 2004 -0700

    USB: switch struct urb to use a kref instead of it's own atomic_t

commit c1c737a2116cf050f7984a9b768995d214ed2310
Author: Matthew Dharm <mdharm-usb@one-eyed-alien.net>
Date:   Mon Apr 26 02:11:11 2004 -0700

    [PATCH] USB: usb-storage driver changes for 2.6.x [4/4]
    
    This is a trivial patch to remove some duplicate includes.  sched.h and
    errno.h are already included in this file about a dozen lines or so above
    this point.

commit 2aa680b18626e8277758ed69b7b8caffd3bd0178
Author: Matthew Dharm <mdharm-usb@one-eyed-alien.net>
Date:   Mon Apr 26 02:10:49 2004 -0700

    [PATCH] USB: usb-storage driver changes for 2.6.x [3/4]
    
    This patch adds some clear-halt calls if a GetMaxLUN fails.  Apparently,
    some devices (like certain early-rev Zip100s) stall their bulk pipes if
    they receive a GetMaxLUN.

commit 676cad775d86992a64359ae4ec9cc5a7f547687f
Author: Matthew Dharm <mdharm-usb@one-eyed-alien.net>
Date:   Mon Apr 26 02:10:25 2004 -0700

    [PATCH] USB: usb-storage driver changes for 2.6.x [2/4]
    
    This is patch as248b from Alan Stern, modified by myself:  This adds a flag
    which allows us to supress the "unneeded unusual_devs.h entry" message.
    This is useful for times when idiotic device manufacturers break the rules
    and release two different devices with the same VID, PID, and revision
    number.

commit 5cced93313b68b478471a25a75e4c4de43647777
Author: Matthew Dharm <mdharm-usb@one-eyed-alien.net>
Date:   Mon Apr 26 02:10:02 2004 -0700

    [PATCH] USB: usb-storage driver changes for 2.6.x [1/4]
    
    Patch as239b from Alan Stern:  This patch improves the interaction between
    a SCSI reset, an internally generated reset, and an abort.  This improves
    our error-recovery in cases where the device is hung (or almost hung) while
    we're trying to auto-reset.

commit b0a8807285ef660871e57e335534456ef35bec53
Author: Alan Stern <stern@rowland.harvard.edu>
Date:   Mon Apr 26 02:09:34 2004 -0700

    [PATCH] USB: Altsetting updates for usb/serial
    
    The updates needed for proper altsetting handling among the USB serial
    drivers turned out to be a lot easier than I expected, thanks to the
    organization of the drivers.  Only a handful of changes were needed.

commit a105e5217aa353be75a119e3c9f1174ad371ea41
Author: Duncan Sands <baldrick@free.fr>
Date:   Mon Apr 26 02:09:06 2004 -0700

    [PATCH] USB: be assertive in usbfs
    
    Be assertive.

commit 0056af21e28ed64824deb2894e0774ffa3df1ec8
Author: Daniele Bellucci <bellucda@tiscali.it>
Date:   Mon Apr 26 02:08:38 2004 -0700

    [PATCH] USB: audits in usb_init()
    
    there were some missing audits in usb_init()

commit 4742a8594e0a8091768312ccfc9203c1396d3082
Author: Todd E. Johnson <tejohnson@yahoo.com>
Date:   Mon Apr 26 02:08:12 2004 -0700

    [PATCH] USB: mtouchusb update for 2.6.6-rc2
    
    The attached patch for the 3M Touch Systems Capacitive controller.
    
    Quick list of changes:
    
            *    Changed reset from standard USB dev reset to vendor reset
            *    Changed data sent to host from compensated to raw coordinates
            *    Eliminated vendor/product module params
            *    Performed multiple successfull tests with an EXII-5010UC
    
    The changes are primarily due to comments from Vojtech Pavlik, as well
    as making the newer EXII-50XXUC controllers work.
    
    Thanks to 3M Touch Systems for sending me some new controllers to test with!
    
    An updated HOWTO is also available at:
    
    
    http://groomlakelabs.com/grandamp/code/microtouch/Linux-Input-USB-Touchscreen-HowTo.txt

commit 351cb4d0166ce9f4ec8f3cd591c4de229b6772e2
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon Apr 26 04:41:28 2004 -0400

    [PATCH] sata_sx4.c warning fix
    
    drivers/scsi/sata_sx4.c: In function `pdc20621_put_to_dimm':
    drivers/scsi/sata_sx4.c:928: warning: comparison is always true due to limited range of data type
    
    The code is doing, effectively:
    
    	if ((long)(expr returning u32)) >= 0
    
    but on 64-bit architectures, that will always be true.
    
    So cast the u32 result to s32 before promoting to long so that bit 31
    correctly propagates into bits 32-63.

commit af5821d56e2ebf118058bbfe440e4890542a32b0
Author: Jeff Garzik <jgarzik@redhat.com>
Date:   Mon Apr 26 04:00:03 2004 -0400

    [libata] remove unused struct ata_engine

commit 2e71077250ae80dac417ce4b81e0914102d7dfdd
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 25 23:06:21 2004 -0500

    [PATCH] scsi_disk_release() warning fix
    
    drivers/scsi/sd.c: In function `scsi_disk_release':
    drivers/scsi/sd.c:1477: warning: unused variable `sdev'

commit 23508b81441c0c53d6bc2884e42f19298be6b244
Author: Jeff Garzik <jgarzik@redhat.com>
Date:   Sun Apr 25 18:09:12 2004 -0400

    [libata promise] make sure our schedule_timeout(N) are never with N==0
    
    Make sure we delay for a minimum desired length of time.

commit 74c79f5af1148dca9f1a92ced4cb36ee5d378a51
Author: Jeff Garzik <jgarzik@redhat.com>
Date:   Sun Apr 25 17:36:12 2004 -0400

    [libata] replace per-command semaphore with optional completion
    
    The semaphore was initialized and up'd for each command, but nobody
    was listening.  Replace this with a completion, which may or may not
    be present.

commit bef6feac8c464d5239e18adca275c604b29bb100
Author: Jeff Garzik <jgarzik@redhat.com>
Date:   Sun Apr 25 17:15:11 2004 -0400

    [libata] increase max-sectors limit for modern drives
    
    This is the much-discussed "speed up SATA" patch.  It limits requests
    to 1MB as discussed, rather than the hardware maximum (32MB).
    
    As soon as Jens Axboe's patch to dynamically determining request
    size is merged, max_sectors becomes what it properly should be --
    a description of the absolute hardware maximum.

commit 3af4496c0b50508b003d9b675f571603e34261ee
Author: Jeff Garzik <jgarzik@redhat.com>
Date:   Sun Apr 25 16:54:47 2004 -0400

    [libata] work queueing cleanups and fixes
    
    Make sure to initialize PIO data xfer state.
    
    Use queue_delayed_work() rather than manually calling schedule_timeout(),
    then queue_work(), ourselves.

commit 471b551d9cae015081d2c53bfe638706603783ae
Author: Jeff Garzik <jgarzik@redhat.com>
Date:   Sun Apr 25 16:17:47 2004 -0400

    [libata] some work on the ATAPI path
    
    Remove a lot of redundant code in ATAPI packet submission.
    
    ATAPI is still disabled, it doesn't work yet.

commit 9ca461c0000e3e84a266d6addd658ff53cbe0940
Author: Jeff Garzik <jgarzik@redhat.com>
Date:   Sun Apr 25 15:54:36 2004 -0400

    [libata] internal cleanup: kill ata_pio_start
    
    Integrate it into its caller.

commit bbb21036660e7973a51fa5f6a4e3e044dc163031
Author: Jeff Garzik <jgarzik@redhat.com>
Date:   Sun Apr 25 15:13:39 2004 -0400

    [libata] make ata_wq workqueue local to libata-core module
    
    Now that libata-scsi module no longer calls queue_work() directly,
    we can localize the use of ata_wq.

commit 5017077e418d0c6c899e3f39ee4690626787dd82
Author: Jeff Garzik <jgarzik@redhat.com>
Date:   Sun Apr 25 15:05:58 2004 -0400

    [libata] move ATAPI command initiation code from libata-scsi to libata-core

commit d27a0b0fe30e1e79f9aa4cf370ebd0b8d47179de
Author: Jeff Garzik <jgarzik@redhat.com>
Date:   Sun Apr 25 13:47:36 2004 -0400

    [libata] move probe execution from katad thread to workqueue thread
    
    This allows us to kill the katad thread itself, and several
    thread-related variables in struct ata_port.

commit fe58b80a9482cfd4def1f89835b8c5b45a9fe19d
Author: Mike Anderson <andmike@us.ibm.com>
Date:   Sun Apr 25 12:05:57 2004 -0500

    [PATCH] fix module unload problem in sd
    
    Move scsi_device_get out of sd probe path to allow module to be unloaded
    when devices are not open.

commit 27aac887116ae0922b25372c05108670296ee9f4
Merge: a8c1b28... e7d3817...
Author: Dave Airlie <airlied@pdx.freedesktop.org>
Date:   Sun Apr 25 09:51:40 2004 -0700

    Merge pdx.freedesktop.org:/home/airlied/linux/drm-2.6
    into pdx.freedesktop.org:/home/airlied/linux/drm-dev

commit a8c1b2846aeded3ac1af3f0d2922ba7aa124b637
Author: Dave Airlie <airlied@pdx.freedesktop.org>
Date:   Sun Apr 25 09:45:24 2004 -0700

    drm_pciids.h:
      add new tdfx id, and blank ffb ids

commit 6029373197fdb5e2145ff2c2d878a86484cc372c
Author: Jeff Garzik <jgarzik@redhat.com>
Date:   Sun Apr 25 12:18:57 2004 -0400

    [libata] move PIO data xfer from katad thread to workqueue thread

commit f9d5fc22f93f63e55a40a5bcf69529d6944b8708
Merge: 63d5381... b38e104...
Author: Dave Airlie <airlied@pdx.freedesktop.org>
Date:   Sun Apr 25 09:09:37 2004 -0700

    Merge http://linux.bkbits.net/linux-2.5
    into pdx.freedesktop.org:/home/airlied/linux/drm-dev

commit 68c9a6a251b7eaf98c881b1e2b51e663de3029a6
Author: Jeff Garzik <jgarzik@redhat.com>
Date:   Sun Apr 25 11:28:29 2004 -0400

    [libata] move ATAPI startup from katad thread to workqueue thread
    
    libata creates one thread per ata_port structure.  This is inadequate
    for our needs, and also cumbersome to maintain, now that workqueues
    and Rusty's thread work is available.
    
    This patch begins to move libata away from doing its own per-port
    thread, by moving the ATAPI command initiation code to work under
    the workqueue system.
    
    This patch also creates a private workqueue, global to all of libata.

commit d7e2a19f5c69c0a22402cd4eeff9ed206934e1a0
Author: Adam Radford <aradford@amcc.com>
Date:   Sat Apr 24 23:23:51 2004 -0500

    [PATCH] 3ware driver update
    
    This patch includes the following driver changes:
    
       1.26.00.038 - Roll driver minor version to 26 to denote kernel 2.6.
                     Add support for cmds_per_lun module parameter.
       1.26.00.039 - Fix bug in tw_chrdev_ioctl() polling code.
                     Fix data_buffer_length usage in tw_chrdev_ioctl().
                     Update contact information.

commit 3403c090b6733aaf71feb83f073d43d051dbe558
Author: Kurt Garloff <garloff@suse.de>
Date:   Sat Apr 24 23:20:56 2004 -0500

    [PATCH] scsi: don't attach device if PQ indicates not connected

commit 3dca9ce92f0eab6de1b3261562c42a8e5e9e53e1
Author: Chris Wright <chrisw@osdl.org>
Date:   Sat Apr 24 23:13:40 2004 -0500

    [PATCH] Update aacraid MAINTAINERS entry

commit f0c9261a5233912d7ac2c77657099711d6be6278
Author: James Bottomley <jejb@mulgrave.(none)>
Date:   Sat Apr 24 23:12:06 2004 -0500

    aic7xxx: compile fix for EISA only case
    
    We can't refer to PCI functions for a pure
    EISA machine.

commit fc64979083a33ca62690a617f3d5e074acb59b56
Author: Andrew Morton <akpm@osdl.org>
Date:   Sat Apr 24 23:10:30 2004 -0500

    [PATCH] aic7xxx: fix oops whe hardware is not present
    
    From: Herbert Xu <herbert@gondor.apana.org.au>
    
    This is because aic7xxx does not unregister itself properly if no devices
    are found.  This patch fixes the problem.

commit 66b470296ea59ceba06b3facd415a775f0ddb407
Author: Kai MÃ¤kisara <kai.makisara@kolumbus.fi>
Date:   Sat Apr 24 23:08:55 2004 -0500

    [PATCH] SCSI tape log message fixes
    
    This patch changes the st console/log messages:
    
    - __GFP_NOWARN added to buffer allocation to suppress useless messages
      when having to use smaller than default segments
    - move log message from enlarge_buffer() to caller so that the tape name
      can be printed and remove some debugging messages; now the st messages
      should include drive name where applicable (a problem reported by
      Hironobu Ishii)
    - setting options is logged only when debugging; the most important
      options are now seen in sysfs

commit 3a353fb09ca21016408e1fe88bc58412d10c4fe8
Author: Andrew Vasquez <praka@users.sourceforge.net>
Date:   Sat Apr 24 23:05:51 2004 -0500

    [PATCH] qla2xxx set current state fixes
    
    - always set_current_state(TASK_UNINTERRUBTIBLE) unless we explicitly
      check for signals.
    
    - make all timeouts take HZ based values.

commit 8ceb54e26f403aea4405227803c66143192aebdd
Author: Aristeu Sergio Rozanski Filho <aris@cathedrallabs.org>
Date:   Sat Apr 24 23:04:26 2004 -0500

    [PATCH] qlogic_cs: use qlogicfas408 module
    
    this patch kills qlogic_core.c and I guess the same idea can be
    applied to other pcmcia scsi drivers. comments?

commit 1806b7770fca90296dbb1427b8cfa19793f460f0
Author: Aristeu Sergio Rozanski Filho <aris@cathedrallabs.org>
Date:   Sat Apr 24 23:02:48 2004 -0500

    [PATCH] qlogicfas: split and create a new module

commit ba08cd44e17a43d7fb7a44cf488bd33edc18b8ab
Author: Aristeu Sergio Rozanski Filho <aris@cathedrallabs.org>
Date:   Sat Apr 24 23:00:34 2004 -0500

    [PATCH] qlogicfas: kill horrible irq probing
    
    	this patch kills irq probe and also I/O because isn't useful to
    	probe I/O if we can't probe irq later.

commit 07789a18fd58bc05ba779e3838ba042bea545fce
Author: James Bottomley <jejb@mulgrave.(none)>
Date:   Sat Apr 24 22:44:44 2004 -0500

    MPT Fusion add back FC909 support
    
    From: "Moore, Eric Dean" <Emoore@lsil.com>

commit 1c4b231784c979c38d0912417b0b63c48eb7f727
Author: Jaroslav Kysela <perex@suse.cz>
Date:   Sat Apr 24 20:33:25 2004 +0200

    ALSA CVS update - Jaroslav Kysela <perex@suse.cz>
    OPL3SA2 driver
    Added YMH0801 ISA PnP ID - OPL3-SA2

commit 4322ca139fee915f39fe6e3e89a98905e68a2323
Author: Jaroslav Kysela <perex@suse.cz>
Date:   Sat Apr 24 20:33:07 2004 +0200

    ALSA CVS update - Takashi Iwai <tiwai@suse.de>
    VIA82xx driver
    - added the experimental PM support.

commit cc3222e37143c20d13f747c0f0d167e8615e3dcc
Author: Jaroslav Kysela <perex@suse.cz>
Date:   Sat Apr 24 20:32:49 2004 +0200

    ALSA CVS update - Takashi Iwai <tiwai@suse.de>
    PCI drivers,ATIIXP driver
    - added IXP 300 to descriptions and comments.
    - fixed the codec probing without the proper interrupts.
    - added the experimental PM support.

commit bf942391cf32907b5680dc86ecce3ecf3c9b1617
Author: Jaroslav Kysela <perex@suse.cz>
Date:   Sat Apr 24 20:32:26 2004 +0200

    ALSA CVS update - Takashi Iwai <tiwai@suse.de>
    AC97 Codec Core
    fixed the compilation without CONFIG_SND_DEBUG.

commit f903e5482c172b7c8fcc318dc2ff7c5d86939046
Author: Jaroslav Kysela <perex@suse.cz>
Date:   Sat Apr 24 20:32:05 2004 +0200

    ALSA CVS update - Takashi Iwai <tiwai@suse.de>
    PPC Keywest driver,PPC PMAC driver,PPC PowerMac driver
    PPC Tumbler driver
    fixed the oops on resume and the initialization of chip.

commit 02469e443436e102fccc84129f58f3d3f570e4ae
Author: Jaroslav Kysela <perex@suse.cz>
Date:   Sat Apr 24 20:31:45 2004 +0200

    ALSA CVS update - Jaroslav Kysela <perex@suse.cz>
    AC97 Codec Core
    ac97->pci might be null

commit 8287de06b152f1655ca25c80b8db2d6fe7740692
Author: Jaroslav Kysela <perex@suse.cz>
Date:   Sat Apr 24 20:31:21 2004 +0200

    ALSA CVS update - Jaroslav Kysela <perex@suse.cz>
    AC97 Codec Core
    patch_sigmatel_stac9758
      - initialize with default values from datasheet
      - apply old initialization only for Gateway M675 notebook

commit 17e0e8c035594de49caa08593b2b1ba88648c28d
Author: Jaroslav Kysela <perex@suse.cz>
Date:   Sat Apr 24 20:31:02 2004 +0200

    ALSA CVS update - Jaroslav Kysela <perex@suse.cz>
    Intel8x0 driver
    From: Giridhar Pemmasani <giri@lmc.cs.sunysb.edu>
    
    It seems that pci config space is messed up after resume for Intel ICH4
    audio controller (on Dell Latitude D600, but I notice that others also
    complain about this problem).  Consequently resume from S3 causes oops with
    snd_intel8x0 module.  If the module is removed before suspend and loaded
    afterwards, I still get oops.  The following simple patch fixes the
    problem.  With this, I can leave alsa untouched during suspend/resume.

commit a89b4af087a4af5eee428aed1993e48ee04bd063
Author: Jaroslav Kysela <perex@suse.cz>
Date:   Sat Apr 24 20:30:42 2004 +0200

    ALSA CVS update - Jaroslav Kysela <perex@suse.cz>
    Opti9xx drivers
    Fixed irq&dma initialization for <93x chips

commit fd234ab5fefc61f39520ff45b1724a7c577b06d8
Author: Jaroslav Kysela <perex@suse.cz>
Date:   Sat Apr 24 20:30:24 2004 +0200

    ALSA CVS update - Jaroslav Kysela <perex@suse.cz>
    AC97 Codec Core
    Fixed AD18xx PCM bit handling

commit e94050aac1bc9144273007571ae072082c893dde
Author: Jaroslav Kysela <perex@suse.cz>
Date:   Sat Apr 24 20:30:01 2004 +0200

    ALSA CVS update - Takashi Iwai <tiwai@suse.de>
    Documentation,AC97 Codec Core
    added the write support to ac97#x-x+regs proc file.
    
    this is for debugging purpose, and enabled only when CONFIG_SND_DEBUG is set.
    it allows the user to modify AC97 register bits without compiling the sources.

commit b4e34ef42f439232a0ad463e517331cadacdc858
Author: Jaroslav Kysela <perex@suse.cz>
Date:   Sat Apr 24 20:29:42 2004 +0200

    ALSA CVS update - Takashi Iwai <tiwai@suse.de>
    AC97 Codec Core
    added the mic/center sharing switch of cm9739 codec again.

commit 774a86172c170f27092c0ce29312ffdd2f0de2f7
Author: Jaroslav Kysela <perex@suse.cz>
Date:   Sat Apr 24 20:29:18 2004 +0200

    ALSA CVS update - Takashi Iwai <tiwai@suse.de>
    Control Midlevel
    - fixed the compilation without CONFIG_PM.
    - fixed the return value of POWER ioctl.

commit 7664d1ad8e4b2f35b69a107971d98601a1b9d6e6
Author: Jaroslav Kysela <perex@suse.cz>
Date:   Sat Apr 24 20:29:00 2004 +0200

    ALSA CVS update - Takashi Iwai <tiwai@suse.de>
    AC97 Codec Core
    - fixed the center/mic share switch on ALC65x.
    - created AC97_SINGLE_VALUME() macro.

commit 6e53c1eea05e9f94835572093bd71bd6321a994f
Author: Jaroslav Kysela <perex@suse.cz>
Date:   Sat Apr 24 20:28:38 2004 +0200

    ALSA CVS update - Takashi Iwai <tiwai@suse.de>
    ATIIXP driver
    - added the PCI id entry for SB300.
    - added the missing terminator to the PCI id list.

commit 0a93bbb6176c83ae2e569bee2d0da020a3545d30
Author: Jaroslav Kysela <perex@suse.cz>
Date:   Sat Apr 24 20:28:19 2004 +0200

    ALSA CVS update - Takashi Iwai <tiwai@suse.de>
    PPC PMAC driver
    fixed the missing function declarations.

commit 3c4e4f11fd713394a792d6389f59d980981197a6
Author: Jaroslav Kysela <perex@suse.cz>
Date:   Sat Apr 24 20:27:55 2004 +0200

    ALSA CVS update - Jaroslav Kysela <perex@suse.cz>
    ICE1712 driver
    <Dirk.Kalis@t-online.de>
    added a control for default rate in the ice1712 driver

commit fd26c62954f128bee01402341343dc41d364992e
Author: Jaroslav Kysela <perex@suse.cz>
Date:   Sat Apr 24 20:27:36 2004 +0200

    ALSA CVS update - Takashi Iwai <tiwai@suse.de>
    PPC PMAC driver
    another fix for the new suspend/resume.

commit 6cc9a13562883cf4038d2139db05866a16c1ce61
Author: Jaroslav Kysela <perex@suse.cz>
Date:   Sat Apr 24 20:27:15 2004 +0200

    ALSA CVS update - Takashi Iwai <tiwai@suse.de>
    Memalloc module
    removed the obsolete hack for dev_alloc_coherent() with dev = 0.

commit 1e0634c6fb5108fdf3de693393ba3bb8fce0b2b4
Author: Jaroslav Kysela <perex@suse.cz>
Date:   Sat Apr 24 20:26:49 2004 +0200

    ALSA CVS update - Takashi Iwai <tiwai@suse.de>
    PPC PMAC driver
    fixed the suspend/resume with the new ALSA common callbacks.

commit 316ec498a8ab8455b1dc78471daf9124d3c205b1
Author: Jeremy Higdon <jeremy@sgi.com>
Date:   Sat Apr 24 14:15:40 2004 -0400

    [PATCH] sata_vsc initialization fix

commit 4f50f5280ef82e394c6ebeecad3b2c89df0a257f
Author: Jaroslav Kysela <perex@suse.cz>
Date:   Sat Apr 24 19:59:07 2004 +0200

    ALSA CVS update - Takashi Iwai <tiwai@suse.de>
    PCM Midlevel
    fixed the deadlock of power_lock in suspend (by Terry Loftin)

commit 5313460f74cfde8804e33a1759ff0528e39799da
Author: Jaroslav Kysela <perex@suse.cz>
Date:   Sat Apr 24 19:58:48 2004 +0200

    ALSA CVS update - Takashi Iwai <tiwai@suse.de>
    CS4281 driver,ES1968 driver,Maestro3 driver,ALI5451 driver
    CS46xx driver,NM256 driver,Trident driver,YMFPCI driver
    - call snd_ac97_suspend() in the suspend callback.
    - suspend/resume secondary codecs, too.

commit 94c2b95f5b50e4d2fb7535d2479747259cce905b
Author: Jaroslav Kysela <perex@suse.cz>
Date:   Sat Apr 24 19:58:26 2004 +0200

    ALSA CVS update - Takashi Iwai <tiwai@suse.de>
    AC97 Codec Core
    - export snd_ac97_suspend().
    - mute MASTER and HEADPHONE volumes in suspend to avoid possible clicks.

commit 16486f85f78e46dfdd0fa961fbf462c9935f558e
Author: Jaroslav Kysela <perex@suse.cz>
Date:   Sat Apr 24 19:58:04 2004 +0200

    ALSA CVS update - Takashi Iwai <tiwai@suse.de>
    Intel8x0 driver,Intel8x0-modem driver
    - probe only audio (intel8x0) or modem (intel8x0m) codecs.
    - call snd_ac97_suspend() in the suspend callback.

commit 0e38be1097b579381053f9a23572e975475c18fa
Author: Jaroslav Kysela <perex@suse.cz>
Date:   Sat Apr 24 19:57:44 2004 +0200

    ALSA CVS update - Clemens Ladisch <clemens@ladisch.de>
    USB generic driver
    Edirol UA-700 advanced modes support

commit adf81ab101c1505a8d1ebdcc875cb121c8180f45
Author: Jaroslav Kysela <perex@suse.cz>
Date:   Sat Apr 24 19:57:23 2004 +0200

    ALSA CVS update - Takashi Iwai <tiwai@suse.de>
    Memalloc module
    fixed the allocation of coherent DMA pages under 32bit mask.

commit bbc4ce241df19f2bb59fbf9313b35ff6a7d17889
Author: Jaroslav Kysela <perex@suse.cz>
Date:   Sat Apr 24 19:57:05 2004 +0200

    ALSA CVS update - Takashi Iwai <tiwai@suse.de>
    Intel8x0 driver
    fixed MX440 workaround in suspend/resume.

commit 5ea317ac11eb1d05f324ca218374ed47c6fda93d
Author: Jaroslav Kysela <perex@suse.cz>
Date:   Sat Apr 24 19:56:47 2004 +0200

    ALSA CVS update - Takashi Iwai <tiwai@suse.de>
    ICE1712 driver
    added Event Electronics EZ8 support by Doug McLain <nostar@comcast.net>

commit 9f6ccec9fe5e3173df9c27182907e661b249d1d6
Author: Jaroslav Kysela <perex@suse.cz>
Date:   Sat Apr 24 19:56:24 2004 +0200

    ALSA CVS update - Takashi Iwai <tiwai@suse.de>
    PCI drivers,au88x0 driver
    bugfixes and VIA/AMD chipset automatic workaround by Manuel Jander <manuel.jander@mat.utfsm.cl>

commit 17ef74c1d3b650bd172c002da46dd227fcb0b5e1
Author: Jaroslav Kysela <perex@suse.cz>
Date:   Sat Apr 24 19:50:42 2004 +0200

    ALSA CVS update - Takashi Iwai <tiwai@suse.de>
    Documentation,ALS4000 driver,ATIIXP driver,AZT3328 driver,BT87x driver
    CMIPCI driver,CS4281 driver,ENS1370/1+ driver,ES1938 driver
    ES1968 driver,FM801 driver,Intel8x0 driver,Intel8x0-modem driver
    Maestro3 driver,RME32 driver,RME96 driver,SonicVibes driver
    VIA82xx driver,ALI5451 driver,au88x0 driver,CS46xx driver
    EMU10K1/EMU10K2 driver,ICE1712 driver,ICE1724 driver,KORG1212 driver
    MIXART driver,NM256 driver,RME HDSP driver,RME9652 driver
    Trident driver,Digigram VX222 driver,YMFPCI driver
    - removed superfluous warning messages after pci_module_init().
      (2.6 kernel doesn't return the error anyway...)
    - store card pointer in pci_drvdata instead of chip pointer.
      this would make easier to add PM support.

commit 5f0eb55a7a3022942a27bfcbc65d6e015854c766
Author: Jaroslav Kysela <perex@suse.cz>
Date:   Sat Apr 24 19:50:18 2004 +0200

    ALSA CVS update - Clemens Ladisch <clemens@ladisch.de>
    USB generic driver
    use wrapper function for usb_control_msg()
    to prevent DMA'ing from/to the stack

commit e73338b4a5b073ebfc3f6c7146884a9052bffc55
Author: Jaroslav Kysela <perex@suse.cz>
Date:   Sat Apr 24 19:49:59 2004 +0200

    ALSA CVS update - Clemens Ladisch <clemens@ladisch.de>
    ALSA sequencer
    load snd-seq-dummy automatically, as documented in seq_dummy.c

commit c288525d429b96c7c6a6d2faa67f07283a678f24
Author: Jaroslav Kysela <perex@suse.cz>
Date:   Sat Apr 24 19:49:37 2004 +0200

    ALSA CVS update - Jaroslav Kysela <perex@suse.cz>
    Trident driver,CS4231 driver,PARISC Harmony driver
    Remove all old SNDRV_DMA_TYPE_PCI references

commit f290e603b0a5182edc1548ae481187ca4f55dc20
Author: Jaroslav Kysela <perex@suse.cz>
Date:   Sat Apr 24 19:49:19 2004 +0200

    ALSA CVS update - Takashi Iwai <tiwai@suse.de>
    ALI5451 driver
    Clean up of power-management codes.
    
    - moved commonly used codes to the core layer.
    - using the unified suspend/resume callbacks for PCI and ISA
    - added snd_card_set_pm_callbacks() and snd_card_set_isa_pm_callbacks()
      as the registration functions.

commit 870dd09e04dc14da816526701e54390066baac5b
Author: Jaroslav Kysela <perex@suse.cz>
Date:   Sat Apr 24 19:48:59 2004 +0200

    ALSA CVS update - Takashi Iwai <tiwai@suse.de>
    Documentation,Control Midlevel,ALSA Core,AD1848 driver,CS4231 driver
    CS46xx driver,Trident driver,YMFPCI driver,ES18xx driver,OPL3SA2 driver
    ATIIXP driver,CS4281 driver,ES1968 driver,Intel8x0 driver
    Intel8x0-modem driver,Maestro3 driver,ALI5451 driver,NM256 driver
    Sound Core PDAudioCF driver
    Clean up of power-management codes.
    
    - moved commonly used codes to the core layer.
    - using the unified suspend/resume callbacks for PCI and ISA
    - added snd_card_set_pm_callbacks() and snd_card_set_isa_pm_callbacks()
      as the registration functions.

commit b4409a71132972578dba937f2a8a016238fe8906
Author: Jaroslav Kysela <perex@suse.cz>
Date:   Sat Apr 24 19:48:26 2004 +0200

    ALSA CVS update - Takashi Iwai <tiwai@suse.de>
    Documentation,SA11xx UDA1341 driver,Memalloc module,PCM Midlevel
    RawMidi Midlevel,RTC timer driver,ALSA Core,Timer Midlevel
    ALSA<-OSS emulation,ALSA sequencer,ALSA<-OSS sequencer,Generic drivers
    MPU401 UART,OPL3,OPL4,ALS100 driver,AZT2320 driver,CMI8330 driver
    DT019x driver,ES18xx driver,OPL3SA2 driver,Sound Galaxy driver
    Sound Scape driver,AD1816A driver,AD1848 driver,CS4231 driver
    CS4236+ driver,PC98(CS423x) driver,ES1688 driver,GUS Classic driver
    GUS Extreme driver,GUS MAX driver,AMD InterWave driver,Opti9xx drivers
    EMU8000 driver,ES968 driver,SB16/AWE driver,SB8 driver
    Wavefront drivers,PARISC Harmony driver,ALS4000 driver,ATIIXP driver
    AZT3328 driver,BT87x driver,CMIPCI driver,CS4281 driver
    ENS1370/1+ driver,ES1938 driver,ES1968 driver,FM801 driver
    Intel8x0 driver,Intel8x0-modem driver,Maestro3 driver,RME32 driver
    RME96 driver,SonicVibes driver,VIA82xx driver,AC97 Codec Core
    ALI5451 driver,au88x0 driver,CS46xx driver,EMU10K1/EMU10K2 driver
    ICE1712 driver,ICE1724 driver,KORG1212 driver,MIXART driver
    NM256 driver,RME HDSP driver,RME9652 driver,Trident driver
    Digigram VX222 driver,YMFPCI driver,Sound Core PDAudioCF driver
    Digigram VX Pocket driver,PPC PowerMac driver,SPARC AMD7930 driver
    SPARC cs4231 driver,USB generic driver
    use the new module_param*() functions.

commit dd85ab2309b4436700a23d378a8286715fb82df0
Author: Jaroslav Kysela <perex@suse.cz>
Date:   Sat Apr 24 19:47:52 2004 +0200

    ALSA CVS update - Clemens Ladisch <clemens@ladisch.de>
    AC97 Codec Core
    fix AC'97 revision bits on AD1985

commit 1d2005a96fdfb9f46e981afb67f03938bcd697a1
Author: Jaroslav Kysela <perex@suse.cz>
Date:   Sat Apr 24 19:47:33 2004 +0200

    ALSA CVS update - Clemens Ladisch <clemens@ladisch.de>
    AC97 Codec Core
    show AC'97 2.3 information in proc file

commit 5c5371da18c4ce971a81855f3633e72cfa11dc95
Author: Jaroslav Kysela <perex@suse.cz>
Date:   Sat Apr 24 19:47:10 2004 +0200

    ALSA CVS update - Jaroslav Kysela <perex@suse.cz>
    Timer Midlevel,ALSA Core
    Added early event flag and code to the timer interface.

commit 3590c3c1bb9e81fc252aed8008c7cb1af9f1ff0b
Author: Jaroslav Kysela <perex@suse.cz>
Date:   Sat Apr 24 19:46:51 2004 +0200

    ALSA CVS update - Clemens Ladisch <clemens@ladisch.de>
    USB generic driver
    allow specification of rate_table in AUDIO_FIXED_ENDPOINT quirks

commit 308ff2ae21ab6bcb531c6be4329971031a516bc7
Author: Jaroslav Kysela <perex@suse.cz>
Date:   Sat Apr 24 19:46:27 2004 +0200

    ALSA CVS update - Clemens Ladisch <clemens@ladisch.de>
    USB generic driver
    remove superfluous address operator from literal arrays

commit f2925a5a56e536a25f37fb50cf4ad9be52f024b7
Author: Jaroslav Kysela <perex@suse.cz>
Date:   Sat Apr 24 19:46:08 2004 +0200

    ALSA CVS update - Clemens Ladisch <clemens@ladisch.de>
    Intel8x0 driver
    20-bit sample format support

commit 1da723f3e4a073d7d2c731c75180d7f6a0a23ece
Author: Jaroslav Kysela <perex@suse.cz>
Date:   Sat Apr 24 19:45:45 2004 +0200

    ALSA CVS update - Clemens Ladisch <clemens@ladisch.de>
    AC97 Codec Core
    fix access to wrong register when clearing powerdown bits

commit be4f8171b1b282b7c16e4e62f9ad69a8827f3c82
Author: Jaroslav Kysela <perex@suse.cz>
Date:   Sat Apr 24 19:45:26 2004 +0200

    ALSA CVS update - Takashi Iwai <tiwai@suse.de>
    AC97 Codec Core
    - fixed the possibl ac97 register cache mismatch.
    - added the detection of spdif sample rates.

commit 9cd65233188e34055076b26fd0ceb0a90c901203
Author: Jaroslav Kysela <perex@suse.cz>
Date:   Sat Apr 24 19:45:05 2004 +0200

    ALSA CVS update - Takashi Iwai <tiwai@suse.de>
    ATIIXP driver
    - fixed SPDIF support.
      restricted only 48k sample rate.
    - fixed the address assignment for bigendian (not existing, though)

commit 37051c28a867644d7a5125578638c47c92707c8d
Author: Jaroslav Kysela <perex@suse.cz>
Date:   Sat Apr 24 19:44:47 2004 +0200

    ALSA CVS update - Takashi Iwai <tiwai@suse.de>
    VIA82xx driver
    added dxs_support and ac97_quirk entries for Amira notebook.

commit 18b5d48376b77d56729d791b1f169f8441b0062e
Author: Jaroslav Kysela <perex@suse.cz>
Date:   Sat Apr 24 19:44:24 2004 +0200

    ALSA CVS update - Jaroslav Kysela <perex@suse.cz>
    ALSA Version
    release: 1.0.4

commit 403a2d2984ec7eddaf382a9e048bb38541d0d69b
Author: Jaroslav Kysela <perex@suse.cz>
Date:   Sat Apr 24 19:44:04 2004 +0200

    ALSA CVS update - Jaroslav Kysela <perex@suse.cz>
    PCMCIA Kconfig
    SND_PDAUDIOCF depends on SND_PCM

commit 436a28939a490fd48711e1d51aedf24df7961c5f
Author: Jaroslav Kysela <perex@suse.cz>
Date:   Sat Apr 24 19:43:44 2004 +0200

    ALSA CVS update - Jaroslav Kysela <perex@suse.cz>
    CS4281 driver
    Added retry_count

commit 668361a0affa99b36823f00d9906fb8636aa2180
Merge: 196c4eb... 5d65526...
Author: Jaroslav Kysela <perex@suse.cz>
Date:   Sat Apr 24 18:33:02 2004 +0200

    Cleanups for Aureal PCI IDs.

commit b38e10413fc41fc9e99be039c45d1e0f51d059e7
Author: Dave Airlie <airlied@pdx.freedesktop.org>
Date:   Sat Apr 24 05:37:41 2004 -0700

    drm_irq.h:
      remove NO_VERSION

commit f2959ec3a764d470fb43e3c94b35ad389f287ea5
Author: Jeff Garzik <jgarzik@redhat.com>
Date:   Sat Apr 24 06:12:03 2004 -0400

    [libata] clean up taskfile submission to hardware
    
    When writing taskfile (an ATA command) to the controller, the exact
    setup of the taskfile is dependent on the taskfile "protocol":
    PIO, PIO Multiple, DMA, Non-data, etc.
    
    So, we separate out the submission of the taskfile to hardware into
    a separate function ata_qc_issue_prot(), which will later be the
    home for more code.
    
    Also, remove some dead code (#if 0'd).

commit 7506a701074ab86645a8826a06199b2f40022a05
Author: Jeff Garzik <jgarzik@redhat.com>
Date:   Sat Apr 24 05:26:06 2004 -0400

    [libata] add ata_tf_{to,from}_fis helpers

commit 8ee3cab9803b510e24e9f49d2c1e873010e7358d
Merge: 7ce42ae... acc2730...
Author: Jeff Garzik <jgarzik@redhat.com>
Date:   Fri Apr 23 14:17:35 2004 -0400

    Merge redhat.com:/spare/repo/linux-2.6
    into redhat.com:/spare/repo/libata-2.6

commit 581dc32c0a47ee634a54b86b373892b7d7021b15
Author: Alan Stern <stern@rowland.harvard.edu>
Date:   Fri Apr 23 02:41:30 2004 -0700

    [PATCH] USB: Altsetting update for USB net drivers
    
    The only driver under usb/net that needed any altsetting changes was
    usbnet.  I'm not looking forward to going through all the source files
    under usb/serial. :-(

commit cb2e2a364780e14093f0b2c18995c294870b3e8e
Author: Alan Stern <stern@rowland.harvard.edu>
Date:   Fri Apr 23 02:41:04 2004 -0700

    [PATCH] USB: Altsetting update for USB misc drivers
    
    This is the altsetting update for the drivers under usb/misc.  As you can,
    not much was needed at all.

commit 01a665f649b8efb058bac30bce8c3162188a6d73
Author: Alan Stern <stern@rowland.harvard.edu>
Date:   Fri Apr 23 02:40:35 2004 -0700

    [PATCH] USB: Altsetting updates for USB media drivers
    
    This patch implements the new altsetting regime for the drivers under
    usb/media.  Not much needed to be changed.  I'm unable to test any of the
    changes, but at least they compile all right (except that I didn't even
    try to compile the pwc driver since it's marked BROKEN).
    
    The stv680 and w9968cf drivers still include an assumption that they are
    bound to interface number 0.  Since that the drivers are fairly tightly
    linked to a specific kind of device I didn't try to change those
    assumptions, but maybe they should be changed.

commit c72b4fbb0cf192e493bf6d21fd09ad95506077f7
Author: Alan Stern <stern@rowland.harvard.edu>
Date:   Fri Apr 23 02:40:06 2004 -0700

    [PATCH] USB: Cosmetic improvements for the UHCI driver
    
    This patch makes a few minor improvements to the appearance of the UHCI
    driver.  Please apply.

commit c1f4a51d3a9ec5a6222fd1b9438a30e245e44c19
Author: Alan Stern <stern@rowland.harvard.edu>
Date:   Fri Apr 23 02:39:38 2004 -0700

    [PATCH] USB: Ignore URB_NO_INTERRUPT flag in UHCI
    
    Following a suggestion of David Brownell's I have decided to remove
    support for the URB_NO_INTERRUPT flag in the UHCI driver.  The overall
    effect of the flag is to reduce the number of interrupts, thereby
    improving throughput somewhat while increasing the duration of the
    remaining IRQ handlers quite a lot (i.e., increasing interrupt variance).
    So I think we're better off without it.  Mind you, this is all in the
    absence of any firm measurements.
    
    A common case where this will come up is during usb-storage bulk
    transfers.  Such transfers are generally divided into scatter-gather
    components each corresponding to a single URB and transferring one memory
    page (4 KB).  While generating an interrupt for each one is a little
    faster than ideal -- about every 3 ms -- it's better than waiting until 64
    KB has been transferred and there are 1024 individual TDs to clean up
    during the IRQ.

commit 16443d6ccbdb22aec2c9c4bedd684802b545bbb1
Author: Duncan Sands <baldrick@free.fr>
Date:   Fri Apr 23 02:20:26 2004 -0700

    [PATCH] USB usbfs: drop pointless racy check
    
    The check of interface->dev.driver requires a lock to be taken
    to protect against driver binding changes.  But in fact I think it
    is better just to drop the test.  The result is that the caller is
    required to claim an interface before changing the altsetting,
    which is consistent with the other routines that operate on
    interfaces.
    
     devio.c |    6 ++----
     1 files changed, 2 insertions(+), 4 deletions(-)

commit c057908f545266b10c2e90c6653f61c175a42984
Author: Duncan Sands <baldrick@free.fr>
Date:   Fri Apr 23 02:20:07 2004 -0700

    [PATCH] USB usbfs: missing lock in proc_getdriver
    
    Hi Oliver,
    
    > I expect it to rarely matter, but it might matter now and then. It's
    > just a question of hygiene. If you are using a temporary buffer I'd
    > like to see it used to full advantage. So either drop the lock or do
    > a direct copy. I'd prefer the first option your patch implemented.
    
    I agree.  Greg, please consider applying the updated patch:
    
    
    
    Protect against driver binding changes while reading the driver name.

commit d4b73114547117bead5dd62521c2211beae10bbb
Author: Duncan Sands <baldrick@free.fr>
Date:   Fri Apr 23 02:19:43 2004 -0700

    [PATCH] USB usbfs: destroy submitted urbs only on the disconnected interface
    
    The remaining three patches contain miscellaneous fixes to usbfs.
    This one fixes up the disconnect callback to only shoot down urbs
    on the disconnected interface, and not on all interfaces.  It also adds
    a sanity check (this check is pointless because the interface could
    never have been claimed in the first place if it failed, but I feel better
    having it there).
    
     devio.c |    6 ++++--
     1 files changed, 4 insertions(+), 2 deletions(-)

commit c441f19b18f1a5d05010e9add7cc22d6dc9a51f5
Author: Duncan Sands <baldrick@free.fr>
Date:   Fri Apr 23 02:19:14 2004 -0700

    [PATCH] USB usbfs: fix up releaseintf
    
    The semaphore is now taken in the callers.
    
     devio.c |    2 --
     1 files changed, 2 deletions(-)

commit 2422de2ccd25d75ddd2bf4fe90502808c5d39a76
Author: Duncan Sands <baldrick@free.fr>
Date:   Fri Apr 23 02:18:50 2004 -0700

    [PATCH] USB usbfs: fix up proc_ioctl
    
    The semaphore is now taken in the caller.
    
     devio.c |    2 --
     1 files changed, 2 deletions(-)

commit fb6f56a6b59c36e01d02e6a8080308fd4a78d4a4
Author: Duncan Sands <baldrick@free.fr>
Date:   Fri Apr 23 02:18:24 2004 -0700

    [PATCH] USB usbfs: fix up proc_setconfig
    
    The semaphore is now taken in the caller.
    
     devio.c |    2 --
     1 files changed, 2 deletions(-)

commit e8f366d443e7fba4b1c0393444f7ff088a009b66
Author: Duncan Sands <baldrick@free.fr>
Date:   Fri Apr 23 02:17:59 2004 -0700

    [PATCH] USB usbfs: remove obsolete comment from proc_resetdevice
    
     devio.c |    3 ---
     1 files changed, 3 deletions(-)

commit f6380455f41b2e54f8fef2dedcf94d08acd6fd3b
Author: Duncan Sands <baldrick@free.fr>
Date:   Fri Apr 23 02:17:35 2004 -0700

    [PATCH] USB usbfs: replace the per-file semaphore with the per-device semaphore
    
     devio.c		|   43 +++++++++++++++++++++++--------------------
     usbdevice_fs.h	|    1 -
     2 files changed, 23 insertions(+), 21 deletions(-)

commit 8e082a0da037efd1de7d168dc6f10c70ff65bbf6
Author: Duncan Sands <baldrick@free.fr>
Date:   Fri Apr 23 02:17:09 2004 -0700

    [PATCH] USB usbfs: take a reference to the usb device
    
    Hi Greg, this is the first of a series of patches that replace the
    per-file semaphore ps->devsem with the per-device semaphore
    ps->dev->serialize.  The role of devsem was to protect against
    device disconnection.  This can be done equally well using
    ps->dev->serialize.  On the other hand, ps->dev->serialize
    protects against configuration and other changes, and has
    already been introduced into usbfs in several places.  Using
    just one semaphore simplifies the code and removes some
    remaining race conditions.  It should also fix the oopses some
    people have been seeing.  In this first patch, a reference is
    taken to the usb device as long as the usbfs file is open.  That
    way we can use ps->dev->serialize for as long as ps exists.
    
     devio.c |   27 ++++++++++++++++-----------
     inode.c |    3 ---
     2 files changed, 16 insertions(+), 14 deletions(-)

commit 75f00f32f076fcf687548873a089c88a10e7c9c9
Author: David Brownell <david-b@pacbell.net>
Date:   Fri Apr 23 01:45:24 2004 -0700

    [PATCH] USB: khubd fixes
    
    This goes on top of the other enumeration patch I just sent,
    to handle some dubious and/or broken hub configurations better.
    
    
    Make khubd handle some cases better:
    
     - Track power budget for bus-powered hubs.  This version only warns
       when the budgets are exceeded.  Eventually, the budgets should help
       prevent such errors.
    
     - Rejects illegal USB setup:  two consecutive bus powered hubs
       would exceed the voltage drop budget, causing much flakiness.
    
     - For hosts with high speed hubs, warn when devices are hooked up
       to full speed hubs if they'd be faster on a high speed one.
    
     - For hubs that don't do power switching, don't try to use it
    
     - For hubs that aren't self-powered, don't report local power status

commit f0b314c4b30dab40c2eb94550cfe94c706dfec2d
Author: David Brownell <david-b@pacbell.net>
Date:   Fri Apr 23 01:44:57 2004 -0700

    [PATCH] USB: re-factor enumeration logic
    
    This is an update to some patches from the December/January
    timeframe, which will help sort out some of the mess for
    drivers that need to use the reset logic.  It's one of the
    last significant patches in my gadget-2.6 tree that haven't
    yet been merged into the main kernel tree.
    
    
    More refactoring of the enumeration code paths:
    
     * The first half of usb_new_device() becomes the second half of a new
       hub_port_init() routine (resets, sets address, gets descriptor)
    
     * The middle chunk of hub_port_connect_change() becomes the first half
       of that new hub_port_init() routine.
    
     * Khubd uses that new routine in hub_port_connect_change().
    
     * Now usb_new_device() cleans up better after faults, and has
       a more useful locking policy (caller owns dev->serialize).
    
     * Has related minor cleanups including commenting some of
       the curious request sequences coming from khubd.
    
    Refactoring means a lot of the current usb_reset_device() logic won't
    need to stay an imperfect clone of the enumeration code ... soon, it
    can just call hub_port_init().
    
    Even without touching usb_reset_device(), this eliminates a deadlock.
    Previously, address0_sem was used both during probe and during reset,
    so probe routines can't implement DFU firmware download (involves a
    reset; DFU also uncovers other problems) or safely recover from probe
    faults by resetting (usb-storage can try that).  Now that lock is no
    longer held during probe(); so those deadlocks are gone.  (And some
    drivers, like at76c503, can start to remove ugly workarounds.)

commit ce77b50c6f5b5404f1e7a00214d7c0baa88bc2fa
Author: David Brownell <david-b@pacbell.net>
Date:   Fri Apr 23 01:44:32 2004 -0700

    [PATCH] USB: usbtest, smp unlink modes
    
    Handle some SMP-visible unlink states better.

commit 3069353b40f47358588558a18048190014fe2df9
Author: Greg Kroah-Hartman <greg@kroah.com>
Date:   Fri Apr 23 00:50:19 2004 -0700

    [PATCH] USB: fix devio compiler warnings created by previous patch.

commit 85d0f7fa3f795e132b2054b871a3be3343ed55fe
Author: Alan Stern <stern@rowland.harvard.edu>
Date:   Fri Apr 23 00:49:56 2004 -0700

    [PATCH] USB: Eliminate dead code from the UHCI driver
    
    I'm not sure what this piece of code is doing in the UHCI driver.  It
    looks like someone envisioned queuing several URBs for the same endpoint
    simultaneously.  Anyway, the driver can't do that and this code can never
    run.

commit 44fedd700383c4c019903d6f6fb98714b2590875
Author: Alan Stern <stern@rowland.harvard.edu>
Date:   Fri Apr 23 00:49:33 2004 -0700

    [PATCH] USB: Implement endpoint_disable() for UHCI
    
    This patch implements the endpoint_disable method for the UHCI driver, as
    you requested a while back.  It guarantees that during unbinding events
    (disconnect, configuration change, rmmod) the UHCI driver will have
    finished using every URB for the interface being unbound.  It doesn't
    quite guarantee that the completion handlers will have finished running,
    but it would take a pretty unlikely race to violate that assumption.  (I
    think it's the same with the OHCI and EHCI drivers.)
    
    Despite the patch numbering this one applies _after_ as249, which is a
    more important bugfix.

commit bfdcf3efddf2b144a377123d5b4e83fd6e19a606
Author: Alan Stern <stern@rowland.harvard.edu>
Date:   Fri Apr 23 00:49:10 2004 -0700

    [PATCH] USB: unusual_devs.h update
    
    On Tue, 20 Apr 2004, Damian Ivereigh wrote:
    
    > Here is the output of dmesg when plugging in an IBM USB MemKey
    >
    > usb-storage: This device (0a16,8888,0100 S 06 P 50) has unneeded SubClass and Protocol entries in unusual_devs.h
    >    Please send a copy of this message to <linux-usb-devel@lists.sourceforge.net>
    
    Thank you for sending this in.  Greg and Pete, here's the patch.

commit d22cb6bc3acaaa1dc677f880e36e3ac62c8a63f5
Author: Alan Stern <stern@rowland.harvard.edu>
Date:   Fri Apr 23 00:48:47 2004 -0700

    [PATCH] USB: Remove unusual_devs entries for Minolta DiMAGE 7, 7Hi
    
    It looks safe to conclude that the unusual_devs.h entries for the Minolta
    DiMAGE 7x cameras aren't needed.  (Michael has tested the 7Hi and it's
    definitely unnecessary.)  The two other DiMAGE entries probably aren't
    needed either, but we don't have any evidence of that so I'm leaving them.

commit 1d6569cd024cb61633d23dd771acee91df320731
Author: David Brownell <david-b@pacbell.net>
Date:   Fri Apr 23 00:48:28 2004 -0700

    [PATCH] USB: root hubs can report remote wakeup feature
    
    The patch lets HCDs report the root hub remote wakeup feature to usbcore
    through config descriptors, and lets usbcore say whether or not remote
    wakeup (of host from sleep, by devices) should be enabled.
    
    Both OHCI and UHCI HCDs have some remote wakeup support already; I'm not
    too sure how well it works.  Given (separate) patches, their root hubs
    can start to act more like other hubs in this area too.  That'll make
    it easier to start using USB suspend mode.

commit 2aad220db3a3821d4cdc8e0238e84dd2ce543408
Author: David Brownell <david-b@pacbell.net>
Date:   Fri Apr 23 00:48:02 2004 -0700

    [PATCH] USB: fix usbfs iso interval problem
    
    In 2.6, ISO transfers on USB require a value for urb->interval ... which
    usbfs didn't provide (until this patch), or let user mode drivers specify.
    
    This patch initializes the urb->interval from the endpoint's descriptor,
    so ISO transfers should now work from userspace.  It also fixes a related
    problem for interrupt transfers.

commit f239d2974fe833223d3fd3331fc84453cc710566
Author: Dmitry Torokhov <dtor_core@ameritech.net>
Date:   Thu Apr 22 16:51:39 2004 -0500

    Input: - move set_abs_params from synaptics driver to input and
             rename to input_set_abs_params
           - convert input_report_* macros into inline functions
           - make use of set_abs_params in touchscreen drivers

commit 05d97cb2fc90a404452b9f849d0243220697875b
Author: Dmitry Torokhov <dtor_core@ameritech.net>
Date:   Thu Apr 22 16:50:49 2004 -0500

    Input: trailing whitespace fixes

commit 39cc645838a0b26ff92036a846a33c2f687ae666
Author: Dmitry Torokhov <dtor_core@ameritech.net>
Date:   Thu Apr 22 16:50:09 2004 -0500

    Input: make serio open and close methods optional

commit 1abefc09ec0d682942fe86ab942b3adba8160800
Author: Dmitry Torokhov <dtor_core@ameritech.net>
Date:   Thu Apr 22 16:48:40 2004 -0500

    Input: serio trailing whitespace fixes

commit 3a576098324dfdc2d9b979e0ef453702c63a4d03
Author: Dmitry Torokhov <dtor_core@ameritech.net>
Date:   Thu Apr 22 16:46:06 2004 -0500

    Input: allow disabling legacy psaux device even for non-embedded systems

commit e9b15897fd721fb044218405caa87835933ec351
Author: Dmitry Torokhov <dtor_core@ameritech.net>
Date:   Thu Apr 22 16:45:14 2004 -0500

    Input: do not modify device's properties when probing for protocol
           extensions on reconnect as it may interfere with reconnect
           process

commit bbed529f58fbbf61e513946fbace7ab9b49fa057
Author: Dmitry Torokhov <dtor_core@ameritech.net>
Date:   Thu Apr 22 16:44:24 2004 -0500

    Input: add psmouse_sliced_command (passes extended commands encoded
           with 0xE8 to the mouse) and use it in Synaptics and Logitech
           drivers

commit 94df3e470952d9809cce2b44b52ce004b75cfe98
Author: Dmitry Torokhov <dtor_core@ameritech.net>
Date:   Thu Apr 22 16:43:45 2004 -0500

    Input: add protocol_handler to psmouse structure to ease adding
           new protocols to psmouse module

commit da7accf09e3da53166f1bfaef9a27f68c6d3d64b
Author: Dmitry Torokhov <dtor_core@ameritech.net>
Date:   Thu Apr 22 16:42:57 2004 -0500

    Input: move "reconnect after so many errors" handling from synaptics driver
           to psmouse so it can be used by other PS/2 protcol drivers (but so far
           only synaptics knows how to validate incoming data)

commit c0cc6f988a0ddf767a426e1bedc40a7b284c10e9
Author: Dmitry Torokhov <dtor_core@ameritech.net>
Date:   Thu Apr 22 16:41:59 2004 -0500

    Input: when getting a new device announce (0xAA 0x00) in psmouse
           try reconnecting instead of rescanning to preserve (if possible)
           the same input device.

commit 329c83f4fd993ae8eeb3aee232d7d832c8edeb4a
Author: Dmitry Torokhov <dtor_core@ameritech.net>
Date:   Thu Apr 22 16:40:48 2004 -0500

    Input: Do not generate events from atkbd until keyboard is completely
           initialized. It should suppress messages about suprious NAKs
           when controller's timeout is longer than one in atkbd

commit 163b872feb9ff23e00f1a2658b825faefe337245
Author: Dmitry Torokhov <dtor_core@ameritech.net>
Date:   Thu Apr 22 16:40:08 2004 -0500

    Input: remove unneeded fields in atkbd structure, convert to bitfields

commit cc9ec5b8abb829f139f3459fb9f6516e507a0977
Author: Dmitry Torokhov <dtor_core@ameritech.net>
Date:   Thu Apr 22 16:39:09 2004 -0500

    Input: fix trailing whitespace in atkbd

commit 71ad0225193c302a7512efbf482394691f782844
Author: Dmitry Torokhov <dtor_core@ameritech.net>
Date:   Thu Apr 22 16:37:43 2004 -0500

    Input: Change spurious ACK warning in atkbd to soften accusation
           against XFree86

commit e648554a1133ae04b4302952a7f68506078e2219
Author: Dmitry Torokhov <dtor_core@ameritech.net>
Date:   Thu Apr 22 16:33:04 2004 -0500

    Input: pass maximum allowed protocol to psmouse_extensions instead of
           accessing psmouse_max_proto directly allowing to avoid changing
           the global parameter when synaptics initialization fails

commit 3cb6d7c85a805d6fc2ac9ec9dd9783a217b2d9b1
Author: Dmitry Torokhov <dtor_core@ameritech.net>
Date:   Thu Apr 22 16:32:22 2004 -0500

    Input: support Synaptics touchpads that have separate middle button

commit 1a9e9e7c55de4a553c8608c35ac8ce14c2661769
Author: Dmitry Torokhov <dtor_core@ameritech.net>
Date:   Thu Apr 22 16:28:25 2004 -0500

    Input: synaptics driver cleanup
           - pack all button data in 2 bytes instead of 48
           - adjust the way we extract button data
           - query extended capabilities if SYN_EXT_CAP_REQUESTS >= 1
             (was == 1) according to Synaptics' addendum to the interfacing
             guide
           - do not announce or report BTN_BACK/BTN_FORWARD unless touchpad
             has SYN_CAP_FOUR_BUTTON in its capability flags

commit bc8796a6481c47de1cb29ee720ec30aec971023c
Author: Dave Jones <davej@redhat.com>
Date:   Thu Apr 22 18:09:05 2004 +0100

    [CPUFREQ] powernow-k8: prevent BIOSs offering a vid of 0x1f, which means off.
    From paul.devriendt@amd.com

commit 1bfdecb0dd57cad7fbc5b4594fc5b1ed283ee219
Author: Dave Jones <davej@redhat.com>
Date:   Thu Apr 22 18:05:21 2004 +0100

    [CPUFREQ] powernow-k8 ignore invalid p-states.
    From paul.devriendt@amd.com

commit 0d19e0036d408dc33d034f911e10d3494b98b5fe
Author: Dave Jones <davej@redhat.com>
Date:   Thu Apr 22 18:01:36 2004 +0100

    [CPUFREQ] powernow-k8 cpuid changes.
    cpuid changes to support new processors that will be coming out in the
    future. Also works around a processor that we have released to the field
    that can have an erroneous cpuid value.
    
    From paul.devriendt@amd.com

commit 85e0dd48bf1fcbddb99599d0e61fbc171e214518
Merge: 17d5007... 5f1b09d...
Author: Vojtech Pavlik <vojtech@suse.cz>
Date:   Thu Apr 22 14:27:27 2004 +0200

    Merge suse.cz:/data/bk/linus into suse.cz:/data/bk/input

commit acc27302352e28513c9ad21f1d5235d9c6eecd59
Author: Jeff Garzik <jgarzik@redhat.com>
Date:   Wed Apr 21 19:43:42 2004 -0400

    [libata] Promise driver split part 4: common header

commit a275776fbdff67e2659641492c415df7967ae548
Author: Jeff Garzik <jgarzik@redhat.com>
Date:   Wed Apr 21 19:37:49 2004 -0400

    [libata] Promise driver split part 3: remove TX2/4 code from sata_sx4

commit 4d229fe2642a18102d9e37825e6a1201241cf274
Author: Jeff Garzik <jgarzik@redhat.com>
Date:   Wed Apr 21 19:26:15 2004 -0400

    [libata] Promise driver split part 2: remove SX4 code from sata_promise

commit 2abc3c66116ded5c33a3fecb89395bad5704ae8e
Author: Jeff Garzik <jgarzik@redhat.com>
Date:   Wed Apr 21 19:11:44 2004 -0400

    [libata] Promise driver split part 1: clone to sx4
    
    Clone sata_promise to sata_sx4.

commit e7d38173c473df585b71053d8296f0c04ac38526
Merge: 17d5007... a8c3d13...
Author: Dave Airlie <airlied@pdx.freedesktop.org>
Date:   Wed Apr 21 15:22:10 2004 -0700

    Merge pdx.freedesktop.org:/home/airlied/linux/linus-2.5
    into pdx.freedesktop.org:/home/airlied/linux/drm-2.6

commit a8c3d1303312780ac9fa89cf73e7e86e8bd726b7
Author: Dave Airlie <airlied@pdx.freedesktop.org>
Date:   Wed Apr 21 14:39:19 2004 -0700

    drmP.h:
      remove unused structure

commit d31846123e0e668cc73e62a7db435ac5504dc13c
Author: Dave Airlie <airlied@pdx.freedesktop.org>
Date:   Wed Apr 21 14:25:40 2004 -0700

    convert DRM to use pci device structures on Linux, move pci ids
    into a separate include file (this is auto-generated from the DRM
    tree)

commit ef6a526088748dd209f653b76cfcec159ce1ea59
Author: Jeff Garzik <jgarzik@redhat.com>
Date:   Wed Apr 21 16:51:41 2004 -0400

    [libata sata_sis] add new PCI id
    
    Also remove constant from linux/pci_ids.h.

commit 4003ce2e6835eb61aaea29895d0c2aae18af5b45
Author: Pavel Machek <pavel@ucw.cz>
Date:   Wed Apr 21 13:34:03 2004 -0400

    [PATCH] Cleanups for b44
    
    Hi!
    
    During some unrelated work I was confused by b44_init_hw. Its return
    is checked in _open() but nowhere else. I started adding missing
    checks, but then I found why its so: it only ever returns 0.
    
    So this turns it into void. Killed #if 0-ed piece of code and fixed
    indentation at one point. Please apply,
    								Pavel

commit 7b29c58b1044391323b7eeb5bc75fed8f4691955
Author: Don Fry <brazilnut@us.ibm.com>
Date:   Wed Apr 21 12:53:56 2004 -0400

    [PATCH] pcnet32 timer to free tx skbs for 79C971/972
    
    At the next opportunity to add new code to 2.6.6, please apply the following:
    
    This patch uses an on-chip timer to free completed transmit skb's for the
    79C971 and 972 versions which currently will leave completed transmit
    skb's on the transmit ring until new transmit traffic occurs.

commit 991eb37936f924e3af1c301431ee02b0c108adda
Author: Don Fry <brazilnut@us.ibm.com>
Date:   Wed Apr 21 12:53:46 2004 -0400

    [PATCH] pcnet32 add register dump capability
    
    At the next opportunity to add new code to 2.6.6, please apply the following
    patch to include the capability to dump chip registers.  Ethtool -d support.

commit b173de9e9555565969420e1f80d8d76013b791ac
Author: Denis Vlasenko <vda@port.imtp.ilyichevsk.odessa.ua>
Date:   Wed Apr 21 12:40:33 2004 -0400

    [PATCH] fealnx #11: cleanup and coding style

commit 005da93c998d710a1f1a6cdb818227eedda85b81
Author: Denis Vlasenko <vda@port.imtp.ilyichevsk.odessa.ua>
Date:   Wed Apr 21 12:40:25 2004 -0400

    [PATCH] fealnx #10: replace local delay functions with udelay

commit 0e2e4f04fb8fa445f202ff79036d1142662bbc22
Author: Denis Vlasenko <vda@port.imtp.ilyichevsk.odessa.ua>
Date:   Wed Apr 21 12:40:18 2004 -0400

    [PATCH] fealnx #9: fix locking for set_rx_mode

commit e12bb4d28ecc02a9d1e3637a895c9d2a3ae7b0dc
Author: Denis Vlasenko <vda@port.imtp.ilyichevsk.odessa.ua>
Date:   Wed Apr 21 12:40:10 2004 -0400

    [PATCH] fealnx #8: rework error handling
    
    Add reset timer, fire it 1/2 sec after 'Too much work in interrupt'
    Move reset code from tx_timeout into two separate routines:
    reset_and_disable_rxtx() and enable_rxtx()
    New function reset_tx_descriptors(): clean up tx ring
    after tx_timeout. tx_timeout now does:
        reset_and_disable_rxtx()
        reset_tx_descriptors()
        enable_rxtx()
        netif_wake_queue()
    Absense of netif_wake_queue() call was probably the cause of
    tx_timeout() stalling all future tx.
    Remove stop_nic_tx(), not used anymore

commit a67ea8eb8913ea6bcb3b40f9a56d128e4b72c0ac
Author: Denis Vlasenko <vda@port.imtp.ilyichevsk.odessa.ua>
Date:   Wed Apr 21 12:40:03 2004 -0400

    [PATCH] fealnx #7: Garzik fix (IIRC): add locking to tx_timeout

commit 4c5ec54544009728ef7a1ea1e2135f5867f3aeb7
Author: Denis Vlasenko <vda@port.imtp.ilyichevsk.odessa.ua>
Date:   Wed Apr 21 12:39:55 2004 -0400

    [PATCH] fealnx #6: Francois' fixes for low memory handling; remove free_one_rx_descriptor (not used anymore)

commit dd253205691a2ca3ff1200a49a8e4993bf2d788f
Author: Denis Vlasenko <vda@port.imtp.ilyichevsk.odessa.ua>
Date:   Wed Apr 21 12:39:48 2004 -0400

    [PATCH] fealnx #5: introduce stop_nic_rxtx(), use it where makes sense

commit f44910c85da717e2e2456e50168688185189ecc5
Author: Denis Vlasenko <vda@port.imtp.ilyichevsk.odessa.ua>
Date:   Wed Apr 21 12:39:40 2004 -0400

    [PATCH] fealnx #4: stop doing stop_nic_rx/writel(np->crvalue) in reset_rx_descriptors
    
    this can inadvertently (re)enable tx and/or rx.

commit ad5373eae114904cb82ca9b9f7d19a4f2b435d13
Author: Denis Vlasenko <vda@port.imtp.ilyichevsk.odessa.ua>
Date:   Wed Apr 21 12:39:33 2004 -0400

    [PATCH] fealnx #3: fix pointer substraction bug

commit 6a37b3e6748419622be8804e5e7a194e9783e046
Author: Denis Vlasenko <vda@port.imtp.ilyichevsk.odessa.ua>
Date:   Wed Apr 21 12:39:25 2004 -0400

    [PATCH] fealnx #2: add 'static'; fix wrapped comment

commit 19594f37eceba1e80c041369878d1fed5cdba756
Author: Denis Vlasenko <vda@port.imtp.ilyichevsk.odessa.ua>
Date:   Wed Apr 21 12:39:18 2004 -0400

    [PATCH] fealnx #1: replace magic constants with enums

commit d666b06dc2d4ef67d488518079e1d99a20b8b5e8
Author: Denis Vlasenko <vda@port.imtp.ilyichevsk.odessa.ua>
Date:   Wed Apr 21 12:39:10 2004 -0400

    [PATCH] fealnx #0: replace dev->base_addr with ioaddr

commit ca06bdb9fd7a1770f0b71649fb86dbbc079ae594
Author: Dave Airlie <airlied@pdx.freedesktop.org>
Date:   Wed Apr 21 04:32:05 2004 -0700

    define an empty driver pci ids for ffb driver

commit 9e3a7662863604ffd295c00cd547796c7ef25c4d
Author: Dave Jones <davej@redhat.com>
Date:   Fri Apr 16 22:16:10 2004 +0100

    [AGPGART] If ati_create_gatt_pages() fails, don't propagate an address we've freed.

commit 17303db697855d90dac9e9d58032075fd605bbda
Merge: c608aed... 8e1405b...
Author: Vojtech Pavlik <vojtech@suse.cz>
Date:   Thu Apr 15 23:27:44 2004 +0200

    Merge suse.cz:/home/vojtech/bk/linus into suse.cz:/home/vojtech/bk/input

commit 509a151f7f03c86436c3e54a0fed735099d70bae
Author: Dave Airlie <airlied@pdx.freedesktop.org>
Date:   Fri Apr 9 16:56:43 2004 -0700

    From Jon Smirl:
    This code allows the mesa drivers to use a single definition of the DRM sarea/IOCTLS

commit ebad1c4d75c19d2895332bb4a8d1f53d53123f79
Author: Dave Airlie <airlied@pdx.freedesktop.org>
Date:   Fri Apr 9 16:27:26 2004 -0700

    * Introduce COMMIT_RING() as in radeon DRM, stop using error prone
      writeback for ring read pointer (Paul Mackerras)
    * Get rid of some superfluous stuff, minor fixes

commit e5335bc7e7c2324cf3263f9315f841d290aeed31
Author: Dave Airlie <airlied@pdx.freedesktop.org>
Date:   Fri Apr 9 15:26:04 2004 -0700

    radeon_drm.h:
      missing define from previous checkin

commit 34a9f3ac775d56e6fc2a9e8ec73ecf039556156f
Author: Dave Airlie <airlied@pdx.freedesktop.org>
Date:   Fri Apr 9 10:52:10 2004 -0700

    Miscellaneous changes from DRM CVS

commit 9d136148ec4d3aefc97e0ebc1d29e778ea65a7bf
Author: Dave Airlie <airlied@pdx.freedesktop.org>
Date:   Fri Apr 9 10:06:33 2004 -0700

    drm_ctx_dtor.patch
    Submitted by: Erdi Chen

commit 8153aeff05a2bcab19ec91698e2fc6031308b490
Author: Dave Airlie <airlied@pdx.freedesktop.org>
Date:   Fri Apr 9 09:56:13 2004 -0700

    More differentiated error codes for DRM(agp_acquire)

commit 6cc03ee758ac85a04ce4743804013cb54b10e364
Author: Dave Airlie <airlied@pdx.freedesktop.org>
Date:   Fri Apr 9 09:44:36 2004 -0700

    From Michel Daenzer:
    Adapt to nopage() prototype change in Linux 2.6.1.
    
    Reviewed by: Arjan van de Ven <arjanv@redhat.com>, additional feedback
    from William Lee Irwin III and Linus Torvalds.

commit 8f547eb80bbf398ca6799ecc29cc97df01836602
Author: Dave Airlie <airlied@pdx.freedesktop.org>
Date:   Fri Apr 9 09:20:06 2004 -0700

    From Eric Anholt + Jon Smirl:
    Don't ioremap the framebuffer area. The ioremapped area wasn't used by
    anything.

commit b6ad4641768afefc993323bfc4731996068fd879
Author: Dave Airlie <airlied@pdx.freedesktop.org>
Date:   Fri Apr 9 09:07:59 2004 -0700

    From Eric Anholt:
    Return EBUSY when attempting to addmap a DRM_SHM area with a lock in it if
    dev->lock.hw_lock is already set. This fixes the case of two X Servers running
    on the same head on different VTs with interface 1.1, by making the 2nd head
    fail to inizialize like before.

commit c25f5e81c5b6bacb2cf1a56928a030747125336a
Author: Dave Airlie <airlied@pdx.freedesktop.org>
Date:   Fri Apr 9 09:00:48 2004 -0700

    From Eric Anholt: some cleanups from AlanH:
    - Tie the DRM to a specific device: setunique no longer succeeds when given
    a busid that doesn't correspond to the device the DRM is attached to. This
    is a breaking of backwards-compatibility only for the multiple-DRI-head case
    with X Servers that don't use interface 1.1.
    - Move irq_busid to drm_irq.h and make it only return the IRQ for the current
    device. Retains compatibility with previous X Servers, cleans up unnecessary
    code. This means no irq_busid on !__HAVE_IRQ, but can be changed if
    necessary.
    - Bump interface version to 1.2. This version when set signifies that the
    control ioctl should ignore the irq number passed in and enable the
    interrupt handler for the attached device. Otherwise it errors out when
    the passed-in irq is not equal to the device's.
    - Store the highest version the interface has been set to in the device.

commit 3b7273f0f2604aa2eaf4ca54e4f069c7d37e3cad
Author: Dave Airlie <airlied@pdx.freedesktop.org>
Date:   Fri Apr 9 08:34:54 2004 -0700

    From: Michel Daenzer:
    Memory layout transition:
    
    * the 2D driver initializes MC_FB_LOCATION and related registers sanely
    * the DRM deduces the layout from these registers
    * clients use the new SETPARAM ioctl to tell the DRM where they think the
    framebuffer is located in the card's address space
    * the DRM uses all this information to check client state and fix it up if
    necessary
    
    This is a prerequisite for things like direct rendering with IGP chips and
    video capturing.

commit 7962e010c1ed943ef170d62aafcbba184f11c493
Author: Dave Airlie <airlied@pdx.freedesktop.org>
Date:   Fri Apr 9 07:32:02 2004 -0700

    From Eric Anholt:
     Introduce a new ioctl, DRM_IOCTL_SET_VERSION. This ioctl allows the server
    or client to notify the DRM that it expects a certain version of the device
    dependent or device independent interface. If the major doesn't match or minor
    is too large, EINVAL is returned. A major of -1 means that the requestor
    doesn't care about that portion of the interface. The ioctl returns the actual
    versions in the same struct.

commit d31fc344a26066fa531d3bec17f7a1d3b50f0582
Author: Dave Airlie <airlied@pdx.freedesktop.org>
Date:   Fri Apr 9 06:03:25 2004 -0700

    - Add DRM_GET_PRIV_WITH_RETURN macro. This can be used in shared code to get
    the drm_file_t * based on the filp passed in ioctl handlers.

commit 13723b107e44341a271592de1400eb81fc2980aa
Author: Dave Airlie <airlied@pdx.freedesktop.org>
Date:   Fri Apr 9 05:35:05 2004 -0700

    left gamma_dma.c out of last changeset

commit 44cabf9b188f1e49192797daee2a3069ec3e9aab
Author: Dave Airlie <airlied@pdx.freedesktop.org>
Date:   Fri Apr 9 05:12:53 2004 -0700

    From: Eric Anholt:
    - Move IRQ functions from drm_dma.h to new drm_irq.h and disentangle them from
    __HAVE_DMA. This will be useful for adding vblank sync support to sis and
    tdfx. Rename dma_service to irq_handler, which is more accurately what it is.
    - Fix the #if _HAVE_DMA_IRQ in radeon, r128, mga, i810, i830, gamma to have
    the right number of underscores. This may have been a problem in the case
    that the server died without doing its DRM_IOCTL_CONTROL to uninit

commit 4b782b3c6ae5a964f94a0d03f8b1591f0093e701
Author: Dave Airlie <airlied@pdx.freedesktop.org>
Date:   Thu Apr 8 10:28:45 2004 -0700

    - Converted Linux drivers to initialize DRM instances based on PCI IDs, not
    just a single instance. The PCI ID lists include a driver private field, which may be used
    by drivers for chip family or other information. Based on work by jonsmirl
    and Eric Anholt. I've left out the PCI device naming for this patch as
    that might be a bit controversial. clean up tdfx to look like everyone else..

commit 4ee76fad10a5dd64f97399b9ebf50d70c7f82315
Author: Hirofumi Ogawa <hirofumi@mail.parknet.co.jp>
Date:   Tue Apr 6 00:37:52 2004 -0400

    [PATCH] 8139too: more useful debug info for tx_timeout
    
    Hi,
    
    I think this patch is useful for looking whether it's the real driver
    bug or other bug.
    
    What do you think of this? If ok, please apply.
    --
    OGAWA Hirofumi <hirofumi@mail.parknet.co.jp>
    
    
    
    [PATCH] 8139too: more useful debug info for tx_timeout
    
    	/* disable Tx ASAP, if not already */
    	tmp8 = RTL_R8 (ChipCmd);
    	if (tmp8 & CmdTxEnb)
    		RTL_W8 (ChipCmd, CmdRxEnb);
    
    The above will clear the Tx Descs. So, this prints the debugging info
    before rtl8139_tx_timeout() does it. And IntrStatus etc. also prints
    anytime for the debug.

commit 1906bc68ea4020a185998e3e4e5000c6586372ea
Author: Christoph Hellwig <hch@lst.de>
Date:   Tue Apr 6 00:01:31 2004 -0400

    [PATCH] convert acenic to pci_driver API

commit e578ca5a048f27226d69b47f6643af1064290ebf
Author: Christoph Hellwig <hch@lst.de>
Date:   Tue Apr 6 00:01:18 2004 -0400

    [PATCH] kill acient compat cruft from acenic
    
    Kills lots of really old cruft and adds a little cruft to actually
    make the driver work with recent 2.4 again.

commit 8e1405bdc9b966cda3dd8368ba8153000a7021c3
Author: Vojtech Pavlik <vojtech@suse.cz>
Date:   Mon Apr 5 21:39:48 2004 +0200

    input: Fix emulation of mouse reset (0xff) command.

commit 5d65526c183836da965ba184ba1c41ffb6a37c56
Author: Jaroslav Kysela <perex@suse.cz>
Date:   Thu Apr 1 15:34:39 2004 +0200

    Fixed ALSA aureal driver compilation - wrong and missing PCI IDs

commit 5f1b09db406f5a9c5bbd4f4eca82d4d97769d16c
Author: Vojtech Pavlik <vojtech@suse.cz>
Date:   Fri Mar 26 18:27:05 2004 +0100

    input: Profusion/ServerWorks chipset workaround in i8042.c for Ingo Molnar.

commit 9eca9b8cae64ba9c2844b9ae9887877e53a308c0
Merge: bda1ea3... 5d8f1ff...
Author: Vojtech Pavlik <vojtech@suse.cz>
Date:   Wed Mar 24 14:34:31 2004 +0100

    Merge suse.cz:/data/bk/linus into suse.cz:/data/bk/input

commit 5d8f1ff9cc9f1ead32265bf27c565b811bbb1454
Merge: ed40752... b249c8c...
Author: Vojtech Pavlik <vojtech@suse.cz>
Date:   Mon Mar 22 18:06:01 2004 +0100

    Merge suse.cz:/data/bk/linus into suse.cz:/data/bk/input

commit b249c8ca2b52bc60d59a589349dd5eaa369561ba
Author: Vojtech Pavlik <vojtech@suse.cz>
Date:   Fri Mar 19 16:56:45 2004 +0100

    input: Chips passing MUX detection incorrectly due to USB Legacy support
           report MUX version 10.12, not 12.10. Fixed.

commit fe34572fbdc8de4a35598c9cf28369c06c92aa3d
Merge: 7ed8201... 17fd2d5...
Author: Vojtech Pavlik <vojtech@suse.cz>
Date:   Sat Mar 13 14:48:15 2004 +0100

    Merge bkbits:input into suse.cz:/home/vojtech/bk/input

commit 17fd2d54dc659fccecca2c3b587d3db81e32ff1f
Merge: 4aeae43... 59736d2...
Author: Vojtech Pavlik <vojtech@suse.cz>
Date:   Thu Feb 26 23:14:09 2004 +0100

    Merge suse.cz:/home/vojtech/bk/linus into suse.cz:/home/vojtech/bk/input
