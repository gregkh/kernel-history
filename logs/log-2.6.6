commit 3dc567d850dc6f0858472621ddba3e31fcacdbe5
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Sun May 9 05:30:37 2004 -0700

    Linux 2.6.6

commit 7e941d4d7ef9ad41ed0a8b23b9e64d16593b801d
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Sun May 9 04:43:07 2004 -0700

    Mark the ACPI CPU throttle and timer IO regions busy.
    
    This should help some laptops where the generic PCI
    code might otherwise believe that this range is unused.
    The ACPI IO range is usually not visible as a standard
    BAR.

commit c99ae253229080624867c02818f999680a613ff2
Author: Andi Kleen <ak@suse.de>
Date:   Sun May 9 04:25:35 2004 -0700

    [PATCH] Fix x86-64 compilation without iommu for 2.6.6rc3
    
    Various people hit this in earlier kernels. The x86-64 kernel did not compile
    without CONFIG_IOMMU_GART in various configurations. Just add the missing symbol
    and export it. Also export iommu_merge while I am at it.

commit 57bfa2c5e66892a5384ba77c26aa61b436ceb83f
Author: Andi Kleen <ak@suse.de>
Date:   Sun May 9 04:25:24 2004 -0700

    [PATCH] Fix machine check handler on x86-64
    
    This fixes a bug in the new machine check handler on x86-64.
    
    One nasty part was that when you got an MCE during boot up
    then it would not always print it on the screen, but still
    panic because it attempted to kill the idle task.
    
    This patch does:
     - Always use KERN_EMERG when printing MCEs
     - Always panic and print on screen before killing idle loop
       or init.

commit b81346bc372c4af7183a69c392fc1b333a9e6aec
Merge: 1d89057... 8f555e6...
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Sun May 9 04:22:07 2004 -0700

    Merge bk://bk.arm.linux.org.uk/linux-2.6-rmk
    into ppc970.osdl.org:/home/torvalds/v2.6/linux

commit 1d89057b72b44f275af65c65a18a75459bbf19ac
Merge: a263e25... f42083c...
Author: Russell King <rmk@flint.arm.linux.org.uk>
Date:   Sun May 9 17:57:13 2004 +0100

    Merge flint.arm.linux.org.uk:/usr/src/bk/linux-2.6-sharp
    into flint.arm.linux.org.uk:/usr/src/bk/linux-2.6-rmk

commit f42083cc61e523e7fbcc7e3b238595b518cb20c8
Author: Marc Singer <elf@com.rmk.(none)>
Date:   Sun May 9 17:35:01 2004 +0100

    [ARM PATCH] 1818/1: lh7a40x #2 (3/7) doc
    
    Patch from Marc Singer
    
    Documentation for the Sharp-LH machines.

commit a7c57d4a70bd81bb7e4485663816c116d981f092
Author: Marc Singer <elf@com.rmk.(none)>
Date:   Sun May 9 17:31:40 2004 +0100

    [ARM PATCH] 1817/1: lh7a40x #2 (2/7) core-include
    
    Patch from Marc Singer
    
    Include files for this updated lh7a40x patch set.  The changes in this
    set from the previous are mostly cosmetic.  The memory macros were
    reworked in order to be more similar to the other ARM versions.  The
    previous versions produced the same results, but the forms are
    slightly different.

commit 1c0c27830a0863fe0bfcac6166719a9f66c27c17
Author: Marc Singer <elf@com.rmk.(none)>
Date:   Sun May 9 17:27:51 2004 +0100

    [ARM PATCH] 1816/1: lh7a40x #2 (1/7) core
    
    Patch from Marc Singer
    
    Updated change set for the 2.6.5 kernel *and* for the April 8th arm
    patch.  Also included are changes suggested by Russell that merge
    several of the files in the mach- directory.  I have also endeavored
    to remove all unnecessary whitespace additions.
    
    Note that since I've found the cause of an annoying user-space crash,
    I believe that this patch is OK.  The crash appears to have nothing to
    do with the system setup.

commit a263e2505d4c462808390d6c325eaa7c11682e43
Author: Tony Lindgren <tony@com.rmk.(none)>
Date:   Sun May 9 12:56:38 2004 +0100

    [ARM PATCH] 1847/1: OMAP update 2/2: include files
    
    Patch from Tony Lindgren
    
    This patch syncs the mainline kernel with the linux-omap tree. The
    patch contains following updates:
    - Move virtual IO area to 0xfefb0000 from 0xfffb0000 to fix parts of
      IO area  overlapping with ARM Linux reserved memory area
    - Add support to OMAP-730, OMAP-5912, and OMAP-1710 processors
    - Reorganize board support
    - Add OMAP core detection
    This patch requires ARM Linux patch 1844/1 be applied to compile
    OMAP-730 and OMAP-5912

commit 62b2119f9ab2d6d264c42b257cc7b2c29706e729
Author: Tony Lindgren <tony@com.rmk.(none)>
Date:   Sun May 9 12:52:15 2004 +0100

    [ARM PATCH] 1846/1: OMAP update 1/2: arch files
    
    Patch from Tony Lindgren
    
    This patch syncs the mainline kernel with the linux-omap tree. The
    patch contains following updates:
    - Move virtual IO area to 0xfefb0000 from 0xfffb0000 to fix parts of
      IO area overlapping with ARM Linux reserved memory area
    - Add support to OMAP-730, OMAP-5912, and OMAP-1710 processors
    - Reorganize board support
    - Add OMAP core detection
    This patch requires ARM Linux patch 1844/1 be applied to compile
    OMAP-730 and OMAP-5912

commit 78c4d584d70258a08d0b7711fee81f0f747179d5
Author: Tony Lindgren <tony@com.rmk.(none)>
Date:   Sun May 9 12:41:55 2004 +0100

    [ARM PATCH] 1844/1: Allow OMAP-730 and OMAP-5910 to use ARM926 in mm/Kconfig
    
    Patch from Tony Lindgren
    
    Adds OMAP-730 and OMAP-5910 support

commit 8f555e6d5b7fe5fef1df09133fc2d7397eadfb5d
Author: Armin Schindler <armin@melware.de>
Date:   Sat May 8 20:28:53 2004 -0700

    [PATCH] ISDN Eicon driver: fix idi cleanup deadlock
    
       On IDI module cleanup, the freed card must be removed from list.
       Use list_empty() instead of list_for_each() loop. Thanks Linus.

commit 293889f585892e214fabd84449ea137ab41634c2
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Sat May 8 06:38:51 2004 -0700

    Waste less memory in dentries.
    
    We don't bother aligining them on a cacheline boundary, since
    that is totally excessive in some configurations (especially
    P4's with 128-byte cachelines).
    
    Instead, we make the minimum inline string size a bit longer,
    and re-order a few fields that allow for better packing on
    64-bit architectures, for better memory utilization.

commit 82f1671aa016f8529b97c201111f030998a89e5d
Merge: 2b30827... 0ef8ced...
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Sat May 8 04:52:37 2004 -0700

    Merge bk://kernel.bkbits.net/davem/sparc-2.6
    into ppc970.osdl.org:/home/torvalds/v2.6/linux

commit 0ef8ced2553cac7a4de39f1592aae83232a60b59
Merge: 63206b3... 25714dd...
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Sat May 8 04:51:48 2004 -0700

    Merge bk://kernel.bkbits.net/davem/net-2.6
    into ppc970.osdl.org:/home/torvalds/v2.6/linux

commit 25714ddf854ce2d63c94a7b1cc931aee73867045
Author: Andrew Morton <akpm@osdl.org>
Date:   Sat May 8 03:25:27 2004 -0700

    [PATCH] run populate_rootfs() before initcalls
    
    I moved this a little too late - we need to run populate_rootfs() before
    running initcalls because some driver initcalls need to open files for
    firmware.
    
    The populate_rootfs() call is still coming after init_idle(), so it won't
    knock the scheduler over.

commit 2b308273f9d8376858abf842975979b423af9b76
Author: David S. Miller <davem@nuts.davemloft.net>
Date:   Sat May 8 03:11:42 2004 -0700

    [SPARC64]: hugetlbpage.c needs linux/module.h

commit 63206b3b6f0a14336ee8242d89d84e4a6fb44fde
Author: David S. Miller <davem@nuts.davemloft.net>
Date:   Sat May 8 02:01:11 2004 -0700

    [NET]: Undo marking sock_alloc() as static, still exported to modules.

commit 54d05783ee595b109c209b1febabd9337bf3e0b6
Author: Stephen Hemminger <shemminger@osdl.org>
Date:   Sat May 8 01:28:54 2004 -0700

    [TCP]: BIC TCP for Linux 2.6.6
    
    This is a version of Binary Increase Control (BIC) TCP
    developed by NCSU.   It is yet another TCP congestion control
    algorithm for handling big fat pipes. For normal size congestion
    windows it behaves the same as existing TCP Reno, but when window
    is large it uses additive increase to ensure fairness and when
    window is small it uses binary search increase.
    
    For more details see the BIC TCP web page
     http://www.csc.ncsu.edu/faculty/rhee/export/bitcp/
    
    The original code was for web100 (2.4); this version is pretty
    much the same but targeted for 2.6 with less sysctl parameters
    and more constants.
    
    I don't have a real high speed long haul network to test, but
    when running over 1G links with delays, the performance is more stable
    (ie tests are repeatable) and as fast as existing Reno.

commit fbb3aa0df16c9a46bd05481cdae42d309fb42dab
Author: Sridhar Samudrala <sri@us.ibm.com>
Date:   Sat May 8 01:23:01 2004 -0700

    [SCTP]: Fix multihomed connection failures on 64-bit systems.
    
    Avoid the use of sizeof() and pointer arithmetic to get to the end
    of sctp_cookie structure. Instead use the last element peer_init which
    is a zero-sized array as the offset.

commit 6619be0338da4d642c25a5e96fe1c8ef31e00553
Author: David Stevens <dlstevens@us.ibm.com>
Date:   Sat May 8 01:17:31 2004 -0700

    [IPV4]: Use time_after() in override ARP calculation.

commit 398b3c447d458db2a7972603b3c36ceb97eb976a
Author: James Morris <jmorris@redhat.com>
Date:   Sat May 8 01:05:57 2004 -0700

    [NET]: Add sock_create_lite()
    
    The purpose of this is to allow sockets created by the kernel in this way
    to be passed through the LSM socket creation hooks and be labeled and
    mediated in the same manner as other sockets.
    
    This patches addresses a class of potential issues with LSMs, where such
    sockets will not be labeled correctly (if at all), or mediated during
    creation.  Under SELinux, it fixes a specific bug where RPC sockets
    created by the kernel during TCP NFS serving are unlabeled.

commit e2943dca2d5b67e9578111986495483fe720d58b
Author: James Morris <jmorris@redhat.com>
Date:   Sat May 8 01:00:33 2004 -0700

    [NET]: Add sock_create_kern()
    
    Under SELinux, and potentially other LSMs, we need to be able to
    distinguish between user sockets and kernel sockets.  For SELinux
    specifically, kernel sockets need to be specially labeled during creation,
    then bypass access control checks (they are controlled by the kernel
    itself and not subject to SELinux mediation).
    
    This addresses a class of potential issues in SELinux where, for example,
    a TCP NFS session times out, then the kernel re-establishes an RPC
    connection upon further user activity.  We do not want such kernel
    created sockets to be labeled with user security contexts.
    
    sock_create() and sock_create_kern() are wrapper functions, which seems
    semantically clearer to me than e.g. adding a flag to sock_create().  If
    you prefer the latter, then let me know.
    
    The patch also adds an argument to the LSM socket creation functions
    indicating whether the socket being created is a kernel socket or not.

commit 49a1f4d43f51d534cd7246b6b117fa497ba2fdaf
Merge: 08faf52... d95263f...
Author: David S. Miller <davem@nuts.davemloft.net>
Date:   Fri May 7 23:06:08 2004 -0700

    Merge nuts.davemloft.net:/disk1/BK/network-2.6
    into nuts.davemloft.net:/disk1/BK/net-2.6

commit 812b724d19d78f9f83ab06c329f0781cbae53a8a
Author: Joshua Kwan <joshk@triplehelix.org>
Date:   Fri May 7 23:01:10 2004 -0700

    [SPARC64]: Use $(CC) in NEW_GCC checks.

commit c0251be584201d079729624725129d503c560690
Author: Benjamin Herrenschmidt <benh@kernel.crashing.org>
Date:   Fri May 7 22:57:39 2004 -0700

    [SUNZILOG]: Fix DCD/CTS change tests, just like in pmac_zilog.

commit 08faf52b10f9f091e6c83b3f363afc6c2571ee5a
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri May 7 20:43:30 2004 -0700

    [PATCH] fix WARN_ON on XFS module unload
    
    From: Christoph Hellwig <hch@lst.de>
    
    This one is a little funny.  The SGI trees don't show this issue because dmapi
    and quota are separate modules so they must be unloaded before xfs_fs_exit can
    be called at all.
    
    So let's move the exitcalls for them in mainline first to simulate that
    behaviour.

commit 6032402c3043b62397e9b3c8e4678f7148568292
Author: Benjamin Herrenschmidt <benh@kernel.crashing.org>
Date:   Fri May 7 20:43:19 2004 -0700

    [PATCH] Fix CTS handling in pmac-zilog.c
    
    From: Paul Mackerras <paulus@samba.org>
    
    This patch fixes a bug in the pmac-zilog driver where if you enable
    CRTSCTS mode, it won't output data when CTS is asserted.  On
    powermacs, the CTS input is inverted.  It also fixes a logic bug in
    testing for CTS and DCD changes.

commit d2ac9ae61e8bd208ef62f74443cf3af2993a6987
Author: Armin Schindler <armin@melware.de>
Date:   Fri May 7 20:29:42 2004 -0700

    [PATCH] ISDN Eicon driver: fix empty queue check
    
       Check for last adapter link is done by next member,
       because entries are not removed yet.

commit 16f16e70a7d4b6d9bee906fd4cc1325aa70b8eed
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Fri May 7 19:56:23 2004 -0700

    All the Intel LPC bridges have the same PCI quirks.
    
    They all have 128 bytes of ACPI/TCO IO space pointed to
    by config space register 0x40, and 64 bytes of GPIO space
    pointed to by 0x58.
    
    Thanks to Jun Nakajima for the full list.

commit 60774082d9e6d5576d8e01bdf8346408878e775e
Merge: 703074c... d9e7bd2...
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Fri May 7 01:11:23 2004 -0700

    Merge bk://bk.arm.linux.org.uk/linux-2.6-rmk
    into ppc970.osdl.org:/home/torvalds/v2.6/linux

commit d9e7bd2fada2573995332baac2fb5637b694938b
Author: Russell King <rmk@flint.arm.linux.org.uk>
Date:   Sat May 8 00:21:03 2004 +0100

    [SERIAL] Remove unmerged 'clk' subsystem from PL011 driver.

commit abda8bc7119cf4a1c84900489c48bc0f2769fc1e
Author: Russell King <rmk@flint.arm.linux.org.uk>
Date:   Sat May 8 00:11:05 2004 +0100

    [ARM] Enclose MMC-related code in #ifdef CONFIG_MMC .. #endif

commit fbfb0222d06d93996d3109216261363e078c8aa9
Author: Russell King <rmk@flint.arm.linux.org.uk>
Date:   Sat May 8 00:04:10 2004 +0100

    [ARM] Remove DMA support in Versatile
    
    We don't have DMA support for AMBA devices yet.

commit d95263f5bd134651f473275865133634bc589b10
Author: Clay Haapala <chaapala@cisco.com>
Date:   Fri May 7 01:00:20 2004 -0700

    [CRYPTO]: Fix typing in crc32c's chksum_update

commit 703074c5f629a2dbf4eb7e130e49b193f3444c38
Merge: ec44dec... 492d6ea...
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Fri May 7 00:30:24 2004 -0700

    Merge http://linux-ntfs.bkbits.net/ntfs-2.6
    into ppc970.osdl.org:/home/torvalds/v2.6/linux

commit ec44dec793347028a735dbc6906e068c1e42597b
Author: Anton Altaparmakov <aia21@cantab.net>
Date:   Fri May 7 19:55:19 2004 +0100

    NTFS: 2.1.8 release - If the $LogFile indicates a clean shutdown and a
          read-write (re)mount is requested, empty $LogFile by overwriting it
          with 0xff bytes to ensure that Windows cannot cause data corruption
          by replaying a stale journal after Linux has written to the volume.

commit 1660b1af13d2a46fa9a2531290cff70b76455162
Merge: b7f9198... 57bea21...
Author: Anton Altaparmakov <aia21@cantab.net>
Date:   Fri May 7 18:12:52 2004 +0100

    Merge cantab.net:/home/src/bklinux-2.6
    into cantab.net:/home/src/ntfs-2.6

commit b7f91987cbffaa31ec862df674e392e586f22653
Author: Anton Altaparmakov <aia21@cantab.net>
Date:   Fri May 7 16:26:31 2004 +0100

    NTFS:  Eeek.  Forgot to revert the Makefile before checking it in last time...

commit 589ab626e926621b5f2b2874b2ecd206fe7f3640
Author: Anton Altaparmakov <aia21@cantab.net>
Date:   Fri May 7 16:18:37 2004 +0100

    NTFS: Read the journal ($LogFile) and determine if the volume has been shutdown cleanly
          and force a read-only mount if not (fs/ntfs/super.c and fs/ntfs/logfile.c).  This
          is a little bit of a crude check in that we only look at the restart areas and
          not at the actual log records so that there will be a very small number of cases
          where we think that a volume is dirty when in fact it is clean.  This should only
          affect volumes that have not been shutdown cleanly and did not have any pending,
          non-check-pointed i/o.

commit 492d6ea7afedc625a9dbbd7a75ae57e5ba99e073
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Thu May 6 19:59:19 2004 -0700

    x86-64: fix preempt race in exit_thread
    
    This fixes a (very very small) preempt race window when we
    invalidate the IO permission bitmap on process exit.

commit 037ebff3bb07cb660bf8f3bd2b6950d497d82354
Author: Stas Sergeev <stsp@aknet.ru>
Date:   Thu May 6 19:35:35 2004 -0700

    [PATCH] Fix IO bitmap invalidate
    
    There is a bug where if any process that obtained an IO access
    permissions via ioperm() does not explicitly "drop" that permissions,
    the IO permissions don't get properly invalidated on process exit.
    
    The cause is that exit_thread() only invalidates the per-thread
    io_bitmap pointer, but doesn't invalidate the per-TSS io_bitmap pointer
    as well.
    
    As the per-thread pointer is invalidated, __switch_to() doesn't take
    care of that one either, so the per-TSS pointer stays valid as long as
    some other process does ioperm().
    
    This fixes the problem - it invalidates the per-TSS io_bitmap pointer
    and the problem goes away.

commit 82ec2170faac59c936b5e74166e3c5d58d3e4d85
Author: Arjan van de Ven <arjanv@redhat.com>
Date:   Thu May 6 19:19:15 2004 -0700

    [PATCH] ide: don't send cacheflush to drives that don't understand it

commit 57bea21a670880c9af0751f71fc4d4c7af36c09e
Author: Bartlomiej Zolnierkiewicz <b.zolnierkiewicz@elka.pw.edu.pl>
Date:   Thu May 6 17:27:25 2004 -0700

    [PATCH] Suspend IDE disks on shutdown
    
    When Patrick removed ide_notify_reboot() in 2.5.42, he didn't notice
    that it meant that IDE no longer had any shutdown() functionality.
    
    So we did the right thing on suspend, but not on shutdown.
    
    ide_notify_reboot() was only doing STANDBY on shutdown (because FLUSH
    'doesn't work' in 2.4 too) but it worked okay and we still should do STANDBY
    on shutdown because some broken disks flush their caches.
    
    Thus just calls bus->suspend() (FLUSH+STANDBY) at shutdown time.  We can
    add some safety delay later - 2.4 doesn't have any.

commit 09f4450a92781812c00450045852c1bd02005982
Author: Benjamin Herrenschmidt <benh@kernel.crashing.org>
Date:   Thu May 6 16:52:14 2004 -0700

    [PATCH] ppc64: Fix nasty typo in PTE freeing code
    
    There is a typo in the PTE freeing code causing us to possibly
    overflow the batch structure.
    
    Obvious fix (look at the closing parentheses).

commit ffa625add061425f374123800f79607611eaca28
Merge: cbb2f9c... 91ddedb...
Author: Anton Altaparmakov <aia21@cantab.net>
Date:   Fri May 7 00:44:28 2004 +0100

    Merge cantab.net:/home/src/bklinux-2.6
    into cantab.net:/home/src/ntfs-2.6

commit f0cec6ada68b2883f42cfd4d56d0d2a12675aa2e
Author: Eric Wong <eric@yhbt.net>
Date:   Thu May 6 16:41:02 2004 -0700

    [PATCH] logips2pp driver update (MX510/310 support), cleanup
    
    I've updated the logips2pp driver to detect the MX310 and MX510 mice
    and also made it more maintainable by putting everything into one
    table instead of having 4 arrays for them (the MX700 support wasn't
    added correctly in the last revision).

commit f864a703bcdf9c37e65f81bf958c40a4894c2def
Author: Arjan van de Ven <arjanv@redhat.com>
Date:   Thu May 6 16:30:23 2004 -0700

    [PATCH] IDE disk cache flush at unopportune momemnts
    
    This makes the idedisk_release function only flush the cache on final
    release; with the recent 2.6 blocklayer updates release gets called
    somewhat frequently, and at times where IO is outstanding to the disk.
    
    This bug didn't trigger before simply because ide_cacheflush_p() always
    was a nop.

commit ef81b1558e4c03551d194aa52917a0210a9ae1c8
Author: Roman Zippel <zippel@linux-m68k.org>
Date:   Thu May 6 16:30:12 2004 -0700

    [PATCH] fix value toggle in gconf
    
    gconf doesn't correctly toggle through the values of a symbol, so use
    sym_toggle_tristate_value() instead.
    
    Problem reported by Martin Persenius <martin@persenius.net>

commit 681b6bf7d1fdb68b789254dcfcc45d128ec18cc8
Author: Nitin A. Kamble <nitin.a.kamble@intel.com>
Date:   Thu May 6 16:26:06 2004 -0700

    [PATCH] mxcsr patch for i386 & x86-64
    
    This enables proper mxcsr register masking: the magic mask "0xffbf"
    is not necessarily correct for all CPU's, and there is an architected
    way to discover the proper MXCSR feature bits by examining the fxsave
    results.
    
    Please refer to IA32 Software Developer's Manual, Volume 1, Section
    11.6.6 for more details.

commit 91ddedbe61a9d0a4a44c62e27e0ae9690fa2bf44
Author: Petr Vandrovec <vandrove@vc.cvut.cz>
Date:   Wed May 5 20:22:19 2004 -0700

    [PATCH] ncpfs data corruption when using large TCP transfers
    
    ncpfs was forgetting to update iovec's iov_base field whenever partial
    transmission occured. This was causing data corruption during large
    (60kB) writes.
    
    The code now also passes copy of iovec to the sock_sendmsg, so it does
    not rely on network stack updating (or not updating) passed iovec in
    case of success (or failure).

commit cd19fd0f5dcf12f49241e4ffafaf4630dd798aec
Author: Andrew Morton <akpm@osdl.org>
Date:   Wed May 5 18:18:45 2004 -0700

    [PATCH] b44 driver needs mii

commit 4c76a6b235d5a7ebdaec5bce02aee24f5fbeb40c
Author: Paul Wagland <paul@wagland.net>
Date:   Wed May 5 17:50:40 2004 -0700

    [PATCH] bug fix for megaraid memory leak
    
    I was going through the code looking for bits and pieces to pull across
    into the new LSI Logic beta megaraid driver /sys fs code and came across
    this one.
    
    LSI Logic have already fixed this issue for the 2.4 driver, and the new
    beta driver does not use the /proc filesystem at all, so no problem
    there.
    
    The problem is that resources are not freed upon certain error
    conditions in the in-kernel megaraid driver, to quote from Lester
    Hightower (who originally found the issue):
    
       "The problem occurs only in the circumstance where one reads one of
        the /proc/megaraid/hba<X>/diskdrives-ch<N> files where the card <X>
        does not have channel <N> on it.  Most people would likely not
        notice this leak in normal operation, but due to the way that we
        monitor our MegaRaid cards in our company (we read these /proc
        entries every 180s) so we found the leak rather quickly, and
        unpleasantly (when your kernel eats all your RAM)."
    
    Anyway, here is the fix, compiled and tested OK for me.

commit f0d61324cd799ceca96c805e1ddf5714cf1b9799
Author: Bartlomiej Zolnierkiewicz <b.zolnierkiewicz@elka.pw.edu.pl>
Date:   Wed May 5 17:38:16 2004 -0700

    [PATCH] ide-disk.c: write cache handling fixes
    
    From: Alan Cox <alan@redhat.com>, Arjan van de Ven <arjanv@redhat.com>
    
     - calculate drive->wcache for non-removable disks too
     - flush the cache before unlocking the door on removable media,
       otherwise you have a small race with the human

commit fe61f793e676bc2b7d27ab10f126d4e7529c6159
Author: Stephen Rothwell <sfr@canb.auug.org.au>
Date:   Wed May 5 17:38:06 2004 -0700

    [PATCH] PPC64 iSeries: replace semaphores with completions
    
    This replaces some usages of sempahores on the stack with completions.
    
    We think we have had at least one bug report that could be caused by the
    inherent race in the semaphore usage.

commit d1a1ac7bdfcd0ca24815192818bad76d5c1129fb
Author: Venkatesh Pallipadi <venkatesh.pallipadi@intel.com>
Date:   Wed May 5 17:36:05 2004 -0700

    [PATCH] bug in bigsmp CPU bringup
    
    There is an bug in bigsmp sub-architecture, due to which it will not
    enable all the CPUs when the BIOS-APICIDs are not 0 to n-1 (where n is
    total number of CPUs). Particularly, only 2 CPU comes up on a system
    that has 4 CPUs with BIOS APICID as (0, 1, 6, 7).=20
    
    The bug is root caused to check_apicid_present(bit) call in smpboot.c,
    when bigsmp is expecting apicid in place of bit.
    check_apicid_present(bit) in bigsmp subarchitecture checks the bit with
    phys_id_present_map (which is actually map representing all apicids and
    not bit).
    
    One solution is to change check_apicid_present(bit) to
    check_apicid_present(apicid), in smp_boot_cpus().  But, it can affect
    all the other subarchitectures in various subtle ways.  So, here is a
    simple alternate fix (Thanks to Martin Bligh), which solves the above
    problem.
    
    [ Confirmation from Martin:
    
         Looks fine, it's exactly the same fix we use for Summit.  Since
         we're using the other method instead of the bitmap, this check
         isn't needed, so we can just bypass it.  This way also has the
         great advantage of being isolated to the bigsmp subarch, so it only
         needs testing there ;-)
     ]

commit 596fcdeef21f067da153d4602590963a4884936f
Merge: f1eda5b... 40d4033...
Author: David S. Miller <davem@nuts.davemloft.net>
Date:   Wed May 5 05:29:02 2004 -0700

    Merge http://linux-lksctp.bkbits.net/lksctp-2.5.work
    into nuts.davemloft.net:/disk1/BK/net-2.6

commit 472bca81d77e9a6d60381fbee4927d01b0c2809a
Author: Andrew Morton <akpm@osdl.org>
Date:   Wed May 5 02:46:18 2004 -0700

    [PATCH] cciss update
    
    From: <mikem@beardog.cca.cpqcorp.net>
    
    This patch adds support for 2 new controllers.  The first is a PCI-Express
    version of the 6400.  The second is actually a SATA controller using the cciss
    interface.

commit 0d7b696fe1b422cc1b7b1c934121865e71a6b46d
Author: Armin Schindler <armin@melware.de>
Date:   Tue May 4 20:53:36 2004 -0700

    [PATCH] ISDN Eicon driver: accept capidrv parameters
    
       Accept negative level3cnt value in register_application
       for special b-channel calculation. Necessary to work with
       capidrv.

commit 52b08ec4f5ee2e7dcf8fb026775088efb1fbe921
Merge: c9ce94e... ad996a0...
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Tue May 4 20:45:09 2004 -0700

    Merge bk://gkernel.bkbits.net/misc-2.6
    into ppc970.osdl.org:/home/torvalds/v2.6/linux

commit ad996a013b1e6a9277ff2664ddcfa5ef4cc606a8
Author: Jeff Garzik <jgarzik@redhat.com>
Date:   Wed May 5 04:29:20 2004 -0400

    [libata sata_sis] support SATA SCRs in PCI cfg space

commit 9ffd36060a87c70f7973fdd694e59bd01325e1f5
Author: Jeremy Higdon <jeremy@sgi.com>
Date:   Wed May 5 04:28:20 2004 -0400

    [PATCH] sata_vsc initialization fix

commit 40d40337ded2e036889c609aad6743c0bacb90a9
Author: Sridhar Samudrala <sri@us.ibm.com>
Date:   Tue May 4 20:15:28 2004 -0700

    [SCTP] Fix accessing Gap Ack blocks array with a -ve index in
    sctp_outq_sack()

commit c9ce94ec6d7bc1c8b7c634f666d6043eb13d0317
Merge: 2061546... 2b44ea5...
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Tue May 4 19:16:42 2004 -0700

    Merge bk://linux-acpi.bkbits.net/linux-acpi-release-2.6.6
    into ppc970.osdl.org:/home/torvalds/v2.6/linux

commit 2b44ea579fb3950f97cd54c8917b2544e631a944
Author: Bartlomiej Zolnierkiewicz <b.zolnierkiewicz@elka.pw.edu.pl>
Date:   Tue May 4 18:33:53 2004 -0700

    [PATCH] fixup for C1 Halt Disconnect problem on nForce2 chipsets
    
    Based on information provided by "Allen Martin" <AMartin@nvidia.com>:
    
    A hang is caused when the CPU generates a very fast CONNECT/HALT cycle
    sequence.  Workaround is to set the SYSTEM_IDLE_TIMEOUT to 80 ns.
    This allows the state-machine and timer to return to a proper state within
    80 ns of the CONNECT and probe appearing together.  Since the CPU will not
    issue another HALT within 80 ns of the initial HALT, the failure condition
    is avoided.

commit f1eda5ba0edbbd454e55e1cb1103f7dd75a86f92
Merge: 93dbf6d... f3fdd58...
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Tue May 4 18:26:28 2004 -0700

    Merge bk://bk.linux1394.org/ieee1394-2.6
    into ppc970.osdl.org:/home/torvalds/v2.6/linux

commit f3fdd5872a22740963ab34197a519eef79bc0859
Merge: 990e397... cc97578...
Author: Ben Collins <bcollins@debian.org>
Date:   Wed May 5 01:04:39 2004 -0400

    Merge http://linux.bkbits.net/linux-2.5
    into debian.org:/usr/src/kernel/ieee1394-2.6

commit cc975786bda040434e53add2407f0a77f7ebd098
Author: Ben Collins <bcollins@debian.org>
Date:   Wed May 5 00:52:49 2004 -0400

    [IEEE1394]: Fix deadlock in killing kernel thread

commit 93dbf6d6f876af90b86400bbeb7ea3396a497579
Author: Mikael Pettersson <mikpe@csd.uu.se>
Date:   Tue May 4 18:18:02 2004 -0700

    [PATCH] allow drivers to claim the lapic NMI watchdog HW
    
    Here is an updated lapic NMI ownership tracking patch which
    should address the issues that were raised with the first one:
    
    - Simplified the API function names to {reserve,release}_lapic_nmi().
    
    - Rewrote the ownership tracking code to use two individually named
      flags instead of using arithmetic and the sign. The code is now
      simple enough that no "hiding" macros are needed. (Thanks Albert
      for that suggestion.)

commit 1a4c6c5ddccf4c1756e392d513dee42a36eeb2f6
Author: Gerd Knorr <kraxel@bytesex.org>
Date:   Tue May 4 18:16:54 2004 -0700

    [PATCH] Fix oops in video_register_device
    
    degerrit@web.de wrote:
       "I caused an oops in unusual circumstances by accidentally "forcing" a
        video device number which was too high or already taken (don't know
        which). I assume this probably shouldn't give an oops (though it was my
         fault), so here's a bugreport..."
    
    Fixed by adding a range check for the number passed in by the driver.

commit fb2fc47c4dd051833153801b4de2ee7e1b8b8917
Author: Andrew Morton <akpm@osdl.org>
Date:   Tue May 4 18:16:42 2004 -0700

    [PATCH] page_mapping race fix
    
    From: Hugh Dickins <hugh@veritas.com>
    
    Remove this development-only debug code - Hugh thinks that its BUG_ON() can
    trigger by accident.

commit d6fb7d8fcbb8df83e10f736911f92d64138d11b6
Merge: 57dd143... 1f00373...
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Tue May 4 18:15:14 2004 -0700

    Merge bk://kernel.bkbits.net/davem/net-2.6
    into ppc970.osdl.org:/home/torvalds/v2.6/linux

commit 1f003738181c09dafc59b1afffaee12d79d8e3f9
Author: Benjamin Herrenschmidt <benh@kernel.crashing.org>
Date:   Tue May 4 18:14:07 2004 -0700

    [PATCH] ppc32: pmac support update
    
    This adds some initial support for the latest model of iBook G4 (still
    need some work on the clock chip at least and some radeonfb updates that
    I'll send later along with other fixes for this driver).
    
    It also removes a useless delay and fixes detection of the airport card
    on the "Windtunnel" class desktop G4 machines.

commit 7c123103a4d42d2bffd0fc0a403e3daa8c491dd4
Author: Benjamin Herrenschmidt <benh@kernel.crashing.org>
Date:   Tue May 4 18:13:57 2004 -0700

    [PATCH] ppc32: Add missing [pci_]dma_mapping_error()
    
    Those were missing from ppc32, please apply.

commit 8764350d0cb6a25b79044da77d261e7b8e8ca7a3
Author: Benjamin Herrenschmidt <benh@kernel.crashing.org>
Date:   Tue May 4 18:13:45 2004 -0700

    [PATCH] Fix my address in CREDITS
    
    Heh, I moved 6 month ago, time to update CREDITS ;)

commit 80d628058e48d18bbb56f1eb80ca2c3e107474b7
Author: Benjamin Herrenschmidt <benh@kernel.crashing.org>
Date:   Tue May 4 18:13:33 2004 -0700

    [PATCH] ppc/ppc64: Cleanup PPC970 CPU initialization
    
    This cleans up the code used to initialize the 970 CPU.
    
    More specifically, it adds support for the 970FX, makes sure we don't
    touch registers we aren't supposed to when running in LPAR mode, and
    stop blindly zeroing out HID4 and HID5, we just clear the bits we really
    want clear in there and leave the rest to the firmware.

commit 57dd1436326a816f453275653d70f3cb8f4da005
Author: Ingo Molnar <mingo@redhat.com>
Date:   Tue May 4 06:21:57 2004 -0700

    [NET]: Update netpoll credits.

commit cbb2f9cb7ce63e8d9cb3f886e097e335c92ea9ed
Merge: 7fec76d... ae0a09f...
Author: Anton Altaparmakov <aia21@cantab.net>
Date:   Tue May 4 13:38:01 2004 +0100

    Merge ssh://linux-ntfs@bkbits.net/ntfs-2.6
    into cantab.net:/home/src/ntfs-2.6

commit 990e3971f2b7850a9cef2853c7f96945ba7fa5e1
Author: Chris Wright <chrisw@osdl.org>
Date:   Tue May 4 04:48:34 2004 -0700

    [PATCH] fix queues_count accounting in mqueue_delete_inode()
    
    During mqueue_get_inode(), it's possible that kmalloc() of the
    info->messages array will fail.  This failure mode will cause the
    queues_count to be (incorrectly) decremented twice.  This patch uses
    info->messages on mqueue_delete_inode() to determine whether the
    mqueue was every truly created, and hence proper accounting is needed
    on destruction.

commit dae1a193e4543ebbaceaa2eab56bf3d025097a8d
Merge: ae959b6... e19e230...
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Tue May 4 04:16:59 2004 -0700

    Merge bk://kernel.bkbits.net/davem/sparc-2.6
    into ppc970.osdl.org:/home/torvalds/v2.6/linux

commit e19e23033576506fea82f72e39c7cdd2b477df76
Merge: 54c23d9... 38542c8...
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Tue May 4 04:15:55 2004 -0700

    Merge bk://bk.arm.linux.org.uk/linux-2.6-serial
    into ppc970.osdl.org:/home/torvalds/v2.6/linux

commit 38542c881c5421398ad556b2b24a0f6d9eb5a54f
Author: Russell King <rmk@flint.arm.linux.org.uk>
Date:   Wed May 5 02:17:47 2004 +0100

    [SERIAL] Remove unused variable.

commit f34acba32ca325b8f667b9ec0034d8b8aaad262d
Author: Bjorn Helgaas <bjorn.helgaas@com.rmk.(none)>
Date:   Tue May 4 19:56:47 2004 +0100

    [SERIAL] default to serial console when possible
    
    Patch from Bjorn Helgaas
    
    This adds efi_uart_console_only() so we can default to using a serial
    console if the EFI console path only contains UARTs.

commit 7c6d39f10113f58c6d79abb231afb1196f328ec8
Author: Alex Williamson <alex.williamson@com.rmk.(none)>
Date:   Tue May 4 18:18:13 2004 +0100

    [SERIAL] 8250_hcdp needs irq sharing
    
    Patch from Alex Williamson
    
    Here's a trivial patch that makes 8250_hcdp setup the correct flags
    when IRQ sharing is enabled for serial ports.
    
    The HCDP table tells us if the device is a PCI UART.  We can use this
    to set the shared interrupt flag as well as program the interrupt with
    the correct polarity/trigger (should get rid of "changing vector <x>
    from IO-SAPIC-edge to IO-SAPIC-level" messages at bootup).  This also
    allows non-PCI UARTs to be left un-shareable, which is likely much
    more safe (edge triggered).
    
    The bit that I'm keying on is still part of the older 1.0a HCDP spec,
    so should be implemented (it was on all the boxes I tested).  If
    there's firmware out there that doesn't set this bit or the interrupt
    supported flag, the HCDP UART may run in polling mode, but should
    still be functional.

commit 3250047367555020c77519771bc4420916746dc4
Author: Slawomir Kolodynski <skolodynski@com.rmk.(none)>
Date:   Tue May 4 17:09:30 2004 +0100

    [SERIAL] Add support for SBS Tech. Inc. PMC-OCTPRO and P-OCTAL cards.
    
    Patch from Slawomir Kolodynski

commit 54c23d9636c549f0cbfaa78a50735f877e866830
Merge: f957cc6... b6ae0c5...
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Tue May 4 04:14:04 2004 -0700

    Merge bk://bk.arm.linux.org.uk/linux-2.6-pcmcia
    into ppc970.osdl.org:/home/torvalds/v2.6/linux

commit b6ae0c502bccc9908c071a4886883b1c467a9d7a
Author: Daniel Ritz <daniel.ritz@ch.rmk.(none)>
Date:   Tue May 4 23:31:38 2004 +0100

    [PCMCIA] add EnE specific initialization to fix HDSP
    
    Patch from Daniel Ritz.
    
    This patch clears an almost undocumented EnE specific test register
    that makes sound on RME Hammerfall DSP Carbus work...should even work
    after suspend.

commit f957cc66f00996002724e616c38158c4814f5f25
Merge: 70d5032... e5f20da...
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Tue May 4 04:11:43 2004 -0700

    Merge bk://bk.arm.linux.org.uk/linux-2.6-rmk
    into ppc970.osdl.org:/home/torvalds/v2.6/linux

commit e5f20da100e1c316ef9cafe1faf12b58b172f6ba
Author: Russell King <rmk@flint.arm.linux.org.uk>
Date:   Tue May 4 19:49:24 2004 +0100

    [ARM] Update mach-types file again.

commit 3d5a2440dcf591bee12e3d01e0fb06aa96d49b01
Author: Russell King <rmk@flint.arm.linux.org.uk>
Date:   Tue May 4 19:33:57 2004 +0100

    [ARM] Fix potential oops and kill unused variable warning in sa1111.c
    
    This fixes a potential oops/use after free bug, and removes an unused
    variable warning.

commit 70d5032e73d2e8ae7e40229ab6c321daaa618c96
Author: Andrew Morton <akpm@osdl.org>
Date:   Tue May 4 04:10:36 2004 -0700

    [PATCH] report size of printk buffer
    
    From: <Andries.Brouwer@cwi.nl>
    
    In the old days the printk log buffer had a constant size, and dmesg asked
    for the 4096, later 8192, later 16384 bytes in there.  These days the
    printk log buffer has variable size, and it is not easy for dmesg to do the
    right thing, especially when doing a "read and clear".  The patch below
    adds a syslog subfuntion that reports the buffer size.

commit bb241f20abe0143220ac2c835f45df8e4338cb5d
Author: Chris Wright <chrisw@osdl.org>
Date:   Tue May 4 04:10:25 2004 -0700

    [PATCH] fix memleak in sys_mq_timedsend
    
    Move error handling to capture all three possible error conditions on
    sending to a full queue.  Without this fix any unprivileged user can
    leak arbitrary amounts of kernel memory.

commit ae0a09f798c429018d467a1d752214843cbf411c
Merge: 12b00b3... a063296...
Author: Anton Altaparmakov <aia21@cantab.net>
Date:   Tue May 4 11:59:13 2004 +0100

    Merge cantab.net:/home/src/bklinux-2.6
    into cantab.net:/home/src/ntfs-2.6

commit ae959b6d2a403207a7e4bfb7368ad6121162bd47
Merge: 3078add... c7dd2ca...
Author: David S. Miller <davem@nuts.davemloft.net>
Date:   Tue May 4 02:00:16 2004 -0700

    Merge bk://kernel.bkbits.net/wesolows/sparc32-2.6
    into nuts.davemloft.net:/disk1/BK/sparc-2.6

commit 3078adde5aae7ee93598bccc233fdfab9fbbadb9
Merge: 8aaac86... e7741dd...
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Mon May 3 23:32:15 2004 -0700

    Merge http://jfs.bkbits.net/linux-2.5
    into ppc970.osdl.org:/home/torvalds/v2.6/linux

commit e7741dd4e42ac3e9b5acc6393ef651b83d278bed
Merge: 3bbadbd... 23a2f48...
Author: Dave Kleikamp <shaggy@austin.ibm.com>
Date:   Tue May 4 04:56:21 2004 -0500

    Merge jfs@jfs.bkbits.net:linux-2.5
    into austin.ibm.com:/shaggy/bk/jfs-2.5

commit 23a2f48edf1892d985a1d192f8c1ae62353f3b07
Author: Dave Kleikamp <shaggy@austin.ibm.com>
Date:   Tue May 4 04:26:19 2004 -0500

    JFS: [CHECKER] get rid of txAbortCommit
    
    txAbortCommit is broken and fixing it makes it equivalent to txAbort,
    so get rid of it and use txAbort instead.

commit b4906e052facbd4df963e84b0a650cd40fc0bf8c
Author: Dave Kleikamp <shaggy@austin.ibm.com>
Date:   Tue May 4 04:20:12 2004 -0500

    JFS: [CHECKER] Memory leak in jfs_link

commit 8aaac862603e2b493613bce18ecb5be285d64934
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Mon May 3 22:30:47 2004 -0700

    Be more careful about waking up rwsem waiters
    
    Get a reference count on the the sleeper, so that
    it can't possibly go away before we've sent it the
    wakeup event.
    
    Noted by Nick Piggin <nickpiggin@yahoo.com.au>
             David Howells <dhowells@redhat.com>

commit 04e469df9896c834d5364f65780e70ffea417d5c
Author: Hugh Dickins <hugh@veritas.com>
Date:   Mon May 3 22:19:26 2004 -0700

    [PATCH] add_to_page_cache comments
    
    Remove two layers of the fossil record from comments on add_to_page_cache:
    2.6.6 moves swapcache handling away, and we long ago stopped masking flags.

commit 8c0459dcc061656d94f80922bb29231fc1a25100
Author: Hugh Dickins <hugh@veritas.com>
Date:   Mon May 3 22:19:15 2004 -0700

    [PATCH] mremap pte_unmap NULL
    
    Old bug noone seems to have hit, but mremap's pte_unmap dst might be
    NULL: would get preempt count wrong even when not DEBUG_HIGHMEM.

commit 3bbadbdf1446a040b9f3332cd9c77ae66f22ff6b
Author: Paul Mackerras <paulus@samba.org>
Date:   Mon May 3 17:57:39 2004 -0700

    [PATCH] ppc32: Updated boot fix
    
    This fixes booting on some PPC32 machines, notably CHRP and powermac
    machines.  This is a modified version of Tom Rini's patch that addresses
    the concerns I had with it.
    
    The problem was that the linker script was getting included in the list
    of things that got put together to make some of the sorts of bootable
    images that we produce.  This removes ld.script in cases where it wasn't
    appropriate and changes the rules in others so that although we have the
    dependency on ld.script, it doesn't get included in the list of things
    to link.

commit 59fe352b6668c57497cbba4e72aef4dbaadc6e3a
Author: David Gibson <david@gibson.dropbear.id.au>
Date:   Mon May 3 17:57:29 2004 -0700

    [PATCH] ppc64: Use slbie, not slbia in hugepage code
    
    On PPC64, when we prepare segments below 4G for use with hugepages, we
    need to flush their entries from the SLB, in case SLB entries
    specifying normal pages were already present.
    
    Previously we did that by flushing the entire SLB, the patch below
    changes this to individually flush each necessary segment with slbie.
    The new version may well be slightly faster, but the real reason for
    it is so that this code path doesn't need to be changed to reinstate
    any bolted SLB entries, if we add them.  The existing version has
    already caused problems (read, crashes) when combined with some
    patches that add bolted SLB entries.

commit 99e956271c2e71831882047232a790ce36d804ce
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon May 3 17:57:17 2004 -0700

    [PATCH] cancel_delayed_work() fix
    
    cancel_delayed_work() forgets to clear the workqueue's pending flag.  This
    makes the workqueue appear to be permanently busy, so any subsequent attempts
    to use it will fail.

commit c7dd2ca707f55c85c52aa4cd9f0cbc52baf9582a
Merge: 967d65b... c3645f4...
Author: Keith M. Wesolowski <wesolows@foobazco.org>
Date:   Mon May 3 09:25:10 2004 -0700

    Merge ssh://kernel.bkbits.net/sparc32-2.6
    into foobazco.org:/sources/2.5-sparc-todave

commit c3645f43e57afc83626eae9fb3e510cfae2bd1f1
Merge: a063296... 5f1d320...
Author: Keith M. Wesolowski <wesolows@kernel.bkbits.net>
Date:   Mon May 3 09:18:57 2004 -0700

    Merge kernel.bkbits.net:/home/repos/linux-2.5
    into kernel.bkbits.net:/home/wesolows/sparc32-2.6

commit 967d65bb1f23a398b48b384f41bba619784186df
Merge: a063296... c3247af...
Author: Keith M. Wesolowski <wesolows@foobazco.org>
Date:   Mon May 3 09:16:56 2004 -0700

    Merge foobazco.org:/sources/2.5-bk
    into foobazco.org:/sources/2.5-sparc-todave

commit c3247afe2db64a3dc213529213dae62b37aae176
Author: Keith M. Wesolowski <wesolows@foobazco.org>
Date:   Mon May 3 09:11:44 2004 -0700

    [SPARC32]: Reduce fragmentation in the bitmap allocator
    
    The existing allocator is first-fit with wraparound.  This allows
    a large number of small holes to accumulate in the early part of the
    region, leading to heavy fragmentation.  This adjusts the algorithm
    to rescan the region when smaller sizes are requested, reducing
    early fragmentation.

commit 710339889f1a42bb3455144e6069a79a89074b72
Author: Sridhar Samudrala <sri@us.ibm.com>
Date:   Mon May 3 09:02:10 2004 -0700

    [SCTP] Fix memset() parameter ordering.

commit 8928a30a517cbdbbae3eed61058a56c9a9012d82
Author: Keith M. Wesolowski <wesolows@foobazco.org>
Date:   Mon May 3 08:54:53 2004 -0700

    [SPARC32]: Trivial reformatting patch for arch/sparc/mm/init.c
    
    From Art Haas <ahaas@airmail.net>

commit 8454cfb58491e0957d74bc900ca52247bcea0d63
Author: Keith M. Wesolowski <wesolows@foobazco.org>
Date:   Mon May 3 08:47:03 2004 -0700

    [SPARC32]: Correct calculation of num_physpages
    
    Previously num_physpages only took into consideration low memory.
    Since nr_free_pages returned something much larger, the caches
    init would oops.

commit db6b3bf0e23de740e58670db1fb11e66275fba2c
Merge: a063296... c969a2a...
Author: David S. Miller <davem@nuts.davemloft.net>
Date:   Mon May 3 05:58:45 2004 -0700

    Merge http://linux-lksctp.bkbits.net/lksctp-2.5.work
    into nuts.davemloft.net:/disk1/BK/net-2.6

commit c969a2a3d4cd89da6653ba333135da5ffc94f63f
Author: Sridhar Samudrala <sri@us.ibm.com>
Date:   Sun May 2 21:17:48 2004 -0700

    [SCTP] Rename SCTP_ADDR_REACHABLE as SCTP_ADDR_AVAILABLE to be
    consistent with the SCTP sockets API draft.

commit e418a672546e4d619b17ac4861427403c1ab408c
Author: Sridhar Samudrala <sri@us.ibm.com>
Date:   Sun May 2 21:14:28 2004 -0700

    [SCTP] Fix bugs in handling overlapping INIT and peer restart over a
    multihomed association.

commit d3476cc699c36792b1591654aafed279e2080db4
Author: Stephen Hemminger <shemminger@osdl.org>
Date:   Sun May 2 21:11:07 2004 -0700

    [PATCH] SCTP crc table can be static const

commit 2061546ad2cb1980d156d05a4923b803c4f87e5f
Merge: 4774cf7... 681b514...
Author: Len Brown <len.brown@intel.com>
Date:   Sun May 2 16:29:41 2004 -0400

    Merge intel.com:/home/lenb/src/linux-acpi-test-2.6.5
    into intel.com:/home/lenb/src/linux-acpi-test-2.6.6

commit 681b5149036a3ebe432b9e2ad10d842191f0d6be
Author: Len Brown <len.brown@intel.com>
Date:   Sun May 2 16:29:06 2004 -0400

    [ACPI] export symbols to button module

commit 4774cf7ada1b2c93ca1fb55be396893b032b8888
Merge: 9f7a3b7... 357f653...
Author: Len Brown <len.brown@intel.com>
Date:   Sun May 2 12:39:52 2004 -0400

    Merge intel.com:/home/lenb/bk/linux-2.6.6
    into intel.com:/home/lenb/src/linux-acpi-test-2.6.6

commit a063296dc6bbca150095cd87266d1c021bb45843
Merge: 0f19266... f7f146a...
Author: David S. Miller <davem@kernel.bkbits.net>
Date:   Sun May 2 08:34:46 2004 -0700

    Merge davem@nuts.davemloft.net:/disk1/BK/net-2.6
    into kernel.bkbits.net:/home/davem/net-2.6

commit f7f146af2a43b7efc2436987236702c453b11c3c
Author: Rusty Russell <rusty@rustcorp.com.au>
Date:   Sun May 2 08:31:59 2004 -0700

    [NET]: Fix MODULE_PARM_DESC typo in dummy driver.

commit b13728714a2b4f3126ef2505cb9778b0eefcc20f
Merge: 48c4316... 5f1d320...
Author: Keith M. Wesolowski <wesolows@foobazco.org>
Date:   Sun May 2 07:01:20 2004 -0700

    Merge foobazco.org:/sources/2.5-bk
    into foobazco.org:/sources/2.5-sparc-todave

commit 0f19266dab5d321b2e826b06a9a0f9fd79c3478e
Merge: 9f7a3b7... 7ab6405...
Author: David S. Miller <davem@nuts.davemloft.net>
Date:   Sun May 2 04:24:01 2004 -0700

    Merge nuts.davemloft.net:/disk1/BK/sparcwork-2.6
    into nuts.davemloft.net:/disk1/BK/sparc-2.6

commit 9f7a3b76c426523e1ff1792b517b7bc73b49038c
Merge: 8cbc52d... 7bc8d82...
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Sun May 2 00:36:29 2004 -0700

    Merge bk://bk.arm.linux.org.uk/linux-2.6-serial
    into ppc970.osdl.org:/home/torvalds/v2.6/linux

commit 7bc8d82755061392ff1e157318a390c8de754e03
Author: Russell King <rmk@flint.arm.linux.org.uk>
Date:   Sun May 2 22:47:52 2004 +0100

    [SERIAL] Fix the calculation of the number of UARTs
    
    The calculation ended up believing we had one less UART than we
    really had.  Fix it.

commit 8cbc52d2d0ac929228b053014a26c3ba8ce10840
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Sat May 1 23:06:12 2004 -0700

    Be more careful about semaphore contention memory ordering.
    
    Don't touch the wakee stack after marking it runnable.

commit 612af3addca75750632c5245bb2f82f1cbc74f83
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Sat May 1 23:04:40 2004 -0700

    Make types of big integers in bitops.h explicit.
    
    "sparse" warns about implicit type conversions that may cause
    surprising results. Did you know that large decimal types have
    different type conversions from large hexadecimals?

commit 429de1ee12578a6204e4cbc8d05d7c6561841f62
Author: Hirofumi Ogawa <hirofumi@mail.parknet.co.jp>
Date:   Sat May 1 21:26:25 2004 -0700

    [PATCH] FAT: remove symbols exports from msdosfs/vfat
    
    From Christoph Hellwig <hch@lst.de>
    
    If we're ever going to ressurect umsdos it should be a stackable
    filesystem..

commit dc8b093216a25745e9f2903ac0975c629feb509a
Author: Hirofumi Ogawa <hirofumi@mail.parknet.co.jp>
Date:   Sat May 1 21:26:13 2004 -0700

    [PATCH] FAT: small cleanup

commit 647ebfd1f22a526c7785e1274c2d7cde548174a7
Author: Hirofumi Ogawa <hirofumi@mail.parknet.co.jp>
Date:   Sat May 1 21:26:03 2004 -0700

    [PATCH] FAT: simple error handling cleanup
    
    From: Ren√© Scharfe <l.s.r@web.de>
    
    the following patch converts the error handling paths in VFAT fs to use
    goto, making it more consistent with other filesystem code. Shrinks the
    resulting binary by 144 bytes in my build.

commit f82f633cfa5236930c5e1d9c2b1065ac57323654
Author: Hirofumi Ogawa <hirofumi@mail.parknet.co.jp>
Date:   Sat May 1 21:25:52 2004 -0700

    [PATCH] FAT: Fix nfsv2 support
    
    The ->dentry_to_fh() can use the 20 bytes in the case of NFSv2, but
    fat_dentry_to_fh() requires 24 bytes by my patch.
    
    So nfsd reply the EOPNOTSUPP to nfs client, then nfs client convert
    the unknown error to -EIO.
    
    This patch fixes the problem by pushing the handle data into 20 bytes.

commit d0b87be07c2773339e06fdcf828e78c7a9e3705c
Merge: 20b5050... 1230e43...
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Sat May 1 21:16:13 2004 -0700

    Merge bk://cifs.bkbits.net/linux-2.5cifs
    into ppc970.osdl.org:/home/torvalds/v2.6/linux

commit 20b5050b9adfaf7eb5d1416b1e3fa9ee55caf2d8
Author: Steve French <stevef@steveft21.ltcsamba>
Date:   Sun May 2 01:13:48 2004 -0500

    do not refresh mode (e.g. in revalidate) to windows servers

commit 32901365d2b038e0ebdc506526f106363f542b3e
Author: Steve French <stevef@steveft21.ltcsamba>
Date:   Sat May 1 22:53:52 2004 -0500

    reduce excessive stack space usage in smb password hashing

commit ff50da437d3220e33c5cc09a028433fd2a36a0c1
Author: Steve French <stevef@smfhome.smfdom>
Date:   Sat May 1 12:12:12 2004 -0500

    even if O_CREAT specified do not reset mode when file not actually created

commit dc3d70e82a1712e3071c1a07b85cdd13f26a792f
Author: Steve French <stevef@steveft21.ltcsamba>
Date:   Sat May 1 17:33:19 2004 -0500

    fix ppc64 build problem due to missing header

commit 1230e43766eba66a43fc47b463d028c1fbd58179
Author: Alexander Viro <viro@parcelfarce.linux.theplanet.co.uk>
Date:   Sat May 1 05:53:15 2004 -0700

    [PATCH] mcdx.c insanity removal
    
    The mcdx.c author had pulled off something absolutely amazing - he had
    declared several unsigned variables (ISA port numbers) as void *, using
    explicit cast to unsigned in almost all places that used them.
    Exception: printk.  There he proudly used them as pointers - with %3p in
    format.  That cute trick allowed him to avoid using %03x, which
    apparently scared him for some reason.
    
    Switched to use of unsigned, killed casts, replaced %3p with %03x in
    formats.  BTW, the code had been that way since the initial merge back
    in 1.3.7...

commit 661c8e51951712b193aab3b189f9f2cb00d27fad
Author: Paul Mackerras <paulus@samba.org>
Date:   Sat May 1 05:10:20 2004 -0700

    [PATCH] ppc64: fix incorrect signal handler argument
    
    This fixes a bug in the ppc64 signal delivery code where the signal
    number argument to a signal handler can get corrupted before the handler
    is called.  The specific scenario is that a process is in a blocking
    system call when two signals get generated for it, both of which have
    handlers.
    
    The signal code will stack up two signal frames on the process stack
    (assuming the mask for the first signal delivered doesn't block the
    second signal) and return to userspace to run the handler for the second
    signal.  On return from that handler the first handler gets run with an
    incorrect signal number argument because we end up with regs->result
    still having a negative value (left over from when the system call was
    interrupted) when it should be zero.  This patch sets it to zero when we
    set up the signal frame (in three places; for 64-bit processes, and for
    32-bit processes for RT and non-RT signals).
    
    The way we handle signal delivery and signal handler return using the
    regs->result field in ppc64 is more complicated than it needs to be.  In
    ppc32 I have already simplified it and eliminated use of the
    regs->result field.  I am going to do the same in the ppc64 code, but I
    think this patch should go in for now to fix the bug.
    
    The patch also fixes a couple of places where we were unnecessarily and
    incorrectly truncating the regs->result value to 32 bits
    (sys32_sigreturn and sys32_rt_sigreturn return a long value, as all
    syscalls do, and if regs->result is negative we need those syscalls to
    return a negative value).
    
    Thanks to Maneesh Soni for identifying the specific circumstances
    under which this bug shows up.

commit 1f3c42cc0d3a10712fd7bf6a3284af034a40ec92
Merge: e663d7c... 1ccf65e...
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Sat May 1 05:01:49 2004 -0700

    Merge bk://kernel.bkbits.net/davem/net-2.6
    into ppc970.osdl.org:/home/torvalds/v2.6/linux

commit 1ccf65eede23b2f82705dedc0b521067bb7cdb0e
Merge: 48c4316... ab32df9...
Author: David S. Miller <davem@kernel.bkbits.net>
Date:   Sat May 1 03:42:39 2004 -0700

    Merge davem@nuts.davemloft.net:/disk1/BK/net-2.6
    into kernel.bkbits.net:/home/davem/net-2.6

commit ab32df9012c2bcaebd2b14334ee5e6f2350674f3
Author: Herbert Xu <herbert@gondor.apana.org.au>
Date:   Sat May 1 03:39:13 2004 -0700

    [IPV4/IPV6]: Fix listing of listening sockets.
    
    There is a bug in listening_get_first() which used by /proc/net/tcp*
    where it wasn't looping through all the sockets in each hash chain.
    This problem doesn't show up unless the first socket in a chain doesn't
    match the family that is being looked up.
    
    The following patch fixes this by getting rid of listening_get_first()
    altogether.

commit e663d7c9816d6386e2c9b1bfb992b5c328ce4e4f
Author: Denis Vlasenko <vda@port.imtp.ilyichevsk.odessa.ua>
Date:   Sat May 1 03:32:45 2004 -0700

    [PATCH] add missing #include
    
    There's a subtle problem with "inline" usage in <linux/string.h>:
    
     <linux/string.h>:
            this pulls in __constant_c_and_count_memset()
    
     <linux/mm.h>:
            this pulls <compiler.h>, re-defining
            inline == __inline__ __attribute__((always_inline)).
    
     But by now it is too late! The compiler has already seen the bare
     "inline" in string.h, and hasn't inlined it.
    
    Result:
    
    	# grep __constant System.map
    	c0144670 t __constant_c_and_count_memset
    	c0145c60 t __constant_c_and_count_memset
    	... many more copies of this function ...
    
    Fixed by including <compiler.h> early enough.

commit 7fec76df170256de3a5e61cbbcc6e26836fc401b
Merge: 12b00b3... 2fc0873...
Author: Anton Altaparmakov <aia21@cantab.net>
Date:   Sat May 1 11:16:53 2004 +0100

    Merge cantab.net:/usr/src/bklinux-2.6 into cantab.net:/usr/src/ntfs-2.6

commit 6bc73d8e99f2f5084f43f211f20fbbb5756509f9
Merge: 6e2139c... 48c4316...
Author: Steve French <cifs.adm@hostme.bitkeeper.com>
Date:   Sat May 1 01:01:22 2004 -0700

    Merge bk://linux.bkbits.net/linux-2.5
    into hostme.bitkeeper.com:/repos/c/cifs/linux-2.5cifs

commit d14c946e0796521887935a69e645ed695806c1fc
Merge: 48c4316... 9f7d77d...
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Fri Apr 30 22:51:38 2004 -0700

    Merge bk://are.twiddle.net/axp-2.6/
    into ppc970.osdl.org:/home/torvalds/v2.6/linux

commit 9f7d77d9280213e59aedcbcbef4bd5066e1ef8d6
Author: Richard Henderson <rth@kanga.twiddle.home>
Date:   Fri Apr 30 21:02:13 2004 -0700

    [ALPHA] Add message queue syscalls.

commit 90652b54b7075fdfe5436c71a0c5b0a55aae27d5
Merge: 2fc0873... 6fad9f5...
Author: David S. Miller <davem@nuts.davemloft.net>
Date:   Fri Apr 30 19:23:45 2004 -0700

    Merge nuts.davemloft.net:/disk1/BK/network-2.6
    into nuts.davemloft.net:/disk1/BK/net-2.6

commit 48c43169d8dbeb76c8d2b8d3517cc7d300bf6c34
Author: Bartlomiej Zolnierkiewicz <b.zolnierkiewicz@elka.pw.edu.pl>
Date:   Fri Apr 30 19:11:44 2004 -0700

    [PATCH] serverworks.c: fix DMA for OSB4
    
    From: Patrick Wildi <patrick@wildi.com>
    
    On OSB4 the hwif->ultra_mask is set to not support UDMA.
    Unfortunately in that case svwks_config_drive_xfer_rate()
    falls through to the end of the function, instead of trying
    other DMA modes.

commit 357f65362b425e151407386dfee3ae00f24d3252
Merge: cd51e18... fade103...
Author: Len Brown <len.brown@intel.com>
Date:   Fri Apr 30 17:28:00 2004 -0400

    Merge intel.com:/home/lenb/src/linux-acpi-test-2.6.5
    into intel.com:/home/lenb/src/linux-acpi-test-2.6.6

commit fade1033dba5f4f0d7e0a3637d04779c813dceec
Author: Len Brown <len.brown@intel.com>
Date:   Fri Apr 30 17:27:30 2004 -0400

    [ACPI] PCI Interrupt Link fixes
    Handle BIOS that reference disabled PCI Interrupt Link Devices
    http://bugme.osdl.org/show_bug.cgi?id=1581
    
    Clean up VIA _CRS = 0 BIOS workaround
    
    Handle BIOS returning _CRS outside _PRS
    http://bugme.osdl.org/show_bug.cgi?id=2567
    
    delete now unused _SRS retry code
    disable redundant console messages

commit 2fc0873fe08fd1d01678ee022db184ee5a3bc817
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Fri Apr 30 07:28:54 2004 -0700

    Fix fixed fadvice length handling
    
     - Correctly handle wraparound on offset+len
     - fix FADV_WILLNEED handling of non-page-aligned (offset+len)
    
    Let's hope we don't need to fix the fixed fix.

commit 61a948c4df03e6383e931b016b60dad546c5d66f
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri Apr 30 07:09:43 2004 -0700

    [PATCH] usb linkage fix
    
    On sparc64 toolchain:
    
    drivers/built-in.o(.init.text+0xaf8c): In function `usb_init':
    : undefined reference to `usbfs_cleanup'
    
    usb_init() is __init and usbfs_cleanup() is __exit.  No can do.

commit 5a1564e689ef97904e17661cc4a7114623409bbb
Author: Dave Kleikamp <shaggy@austin.ibm.com>
Date:   Fri Apr 30 04:08:29 2004 -0500

    JFS: [CHECKER] Fix a possible null-pointer dereference

commit 5b0e59c89ee9d6381f7743eefeabacc937847dac
Merge: 978b7ac... f1d26c9...
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Fri Apr 30 01:46:47 2004 -0700

    Merge bk://bk.arm.linux.org.uk/linux-2.6-rmk
    into ppc970.osdl.org:/home/torvalds/v2.6/linux

commit f1d26c92a796b69be85d13475f23a394af9a4cd6
Author: Nicolas Pitre <nico@org.rmk.(none)>
Date:   Fri Apr 30 22:59:26 2004 +0100

    [ARM PATCH] 1841/1: Lubbock defconfig update
    
    Patch from Nicolas Pitre

commit 268ffa1a388b53f128b2ef6cfe782c36565d2c60
Author: Nicolas Pitre <nico@org.rmk.(none)>
Date:   Fri Apr 30 22:55:03 2004 +0100

    [ARM PATCH] 1840/1: recognize more XScale CPU variants
    
    Patch from Nicolas Pitre
    
    ... including the new PXA270 aka Bulverde.

commit 5cd573bc6d459e225c6b7b20a1a3927c4df7a70c
Author: Nicolas Pitre <nico@org.rmk.(none)>
Date:   Fri Apr 30 22:51:18 2004 +0100

    [ARM PATCH] 1839/1: fix lubbock_flash.c which used a bogus reg name
    
    Patch from Nicolas Pitre
    
    Before previous patch this driver compiled OK but was buggy.
    Now it doesn't compile anymore as the bogus macro has been
    deleted.  Fix that in any case.
    
    The same fix has been committed to the MTD CVS already, but please forward
    this to Linus otherwise Lubbock won't compile from kernel.org tree anymore
    (waiting for dwmw2 to update this might prove ... hrm ... long)

commit 8a8477d7b7951fda43b8c166aac75b6e363bc453
Author: Nicolas Pitre <nico@org.rmk.(none)>
Date:   Fri Apr 30 22:47:10 2004 +0100

    [ARM PATCH] 1838/1: Lubbock leds and macro namespace cleanup
    
    Patch from Nicolas Pitre
    
    Too many macro with too generic names.  Let's remove unneeded code and
    redundant/unused macros.  This also prevent namespace clash with upcoming
    patches.

commit bcbcfdfa3e6c2e37f5562076341e4b809872813b
Author: Nicolas Pitre <nico@org.rmk.(none)>
Date:   Fri Apr 30 22:43:05 2004 +0100

    [ARM PATCH] 1837/1: small Lubbock cleanup
    
    Patch from Nicolas Pitre
    
    Minor cleanup of Lubbock specific code, like removal of
    redundant mappings.
    Also a prerequisite for some upcoming patches.

commit 8a68214cccb7f41482cf16528c1f8e3d3e413ec6
Author: Nicolas Pitre <nico@org.rmk.(none)>
Date:   Fri Apr 30 22:39:17 2004 +0100

    [ARM PATCH] 1836/1: don't hardcode virtual addresses
    
    Patch from Nicolas Pitre
    
    virtual address mapping can change.

commit 978b7ac2c3ef8984c2d7473e21f8dec772cfb147
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri Apr 30 00:51:54 2004 -0700

    [PATCH] task_struct alignment fix
    
    The recent slab alignment changes broke an unknown number of architectures
    (parisc and x86_64 for sure) by causing task_structs to be insufficiently
    aligned.
    
    We need good alignemnt because architectures do things like dumping FP state
    into the task_struct with instructions which require particular alignment (I
    think).
    
    So change the default alignment to L1_CACHE_BYTES, which is what we used to
    have, via SLAB_HW_CACHE_ALIGN.

commit 5d3c500bc7ad03ec118c66bca735fd93fc7e804e
Author: Russell King <rmk@arm.linux.org.uk>
Date:   Thu Apr 29 22:37:45 2004 -0700

    [PATCH] Update MTD concatenating driver
    
    This patch updates the MTD concatenating driver from MTD CVS, which
    fixes issues found with this driver which concatenates multiple MTD
    devices into one MTD device.
    
    From David Woodhouse, through CVS:
    
    	revision 1.8
    	date: 2003/06/30 11:01:26;  author: dwmw2;  state: Exp;  lines: +5 -5
    	I will not commit stuff whilst pissed
    	I will not commit stuff whilst pissed
    
    	revision 1.7
    	date: 2003/06/29 21:26:34;  author: dwmw2;  state: Exp;  lines: +9 -9
    	Fix ecc/oob subdev comparisions
    
    	revision 1.6
    	date: 2003/06/25 12:37:50;  author: dwmw2;  state: Exp;  lines: +14 -6
    	Don't pretend to have {read,write}_{oob,ecc} functions if subdevices don't
    
    	revision 1.5
    	date: 2003/06/25 12:21:16;  author: dwmw2;  state: Exp;  lines: +390 -397
    	coding style cleanup

commit 791c0db53ff861c87bd6376afc6139aeaee6d51b
Merge: 4c04146... 133bb3a...
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Thu Apr 29 22:11:01 2004 -0700

    Merge http://lia64.bkbits.net/to-linus-2.5
    into ppc970.osdl.org:/home/torvalds/v2.6/linux

commit 133bb3a8f7bd0e409f28f11902c54350989f5f1a
Author: David Mosberger <davidm@tiger.hpl.hp.com>
Date:   Thu Apr 29 20:26:18 2004 -0700

    Cset exclude: davidm@tiger.hpl.hp.com|ChangeSet|20040427053149|28511

commit 4c04146f42cae0d0dc1a4150b7c2915608c74008
Author: Andrew Morton <akpm@osdl.org>
Date:   Thu Apr 29 17:42:49 2004 -0700

    [PATCH] fadvise length handling fix
    
    POSIX sez: "If len is zero, all data following offset is specified."

commit e408f0655a224c6899ccff2436f2b25af117b5d8
Author: Andrew Morton <akpm@osdl.org>
Date:   Thu Apr 29 17:42:38 2004 -0700

    [PATCH] ppc64: shmget() translation bugfix
    
    From: David Gibson <david@gibson.dropbear.id.au>
    
    The 32->64 bit syscall translation layer on ppc64 incorrectly sign-
    extends rather than zero-extending the second parameter to shmget(),
    which should be a size_t.  This means that it is impossible to shmget()
    more 2GB or more from a 32-bit process.

commit 7ead32b4a0e86675bee0c7ab8737da036ef2f83c
Author: Andrew Morton <akpm@osdl.org>
Date:   Thu Apr 29 17:42:26 2004 -0700

    [PATCH] make ikconfig quiet
    
    From: "Randy.Dunlap" <rddunlap@osdl.org>
    
    From: Pavel Machek <pavel@ucw.cz>
    
    Kill uninformative boot-time message.

commit 978cd874f1b184c4d7e6e1ca366a43b4b4f44b2c
Author: Andrew Morton <akpm@osdl.org>
Date:   Thu Apr 29 17:42:14 2004 -0700

    [PATCH] s390: oprofile Kconfig fixes
    
    From: Arnd Bergmann <arnd@arndb.de>
    
    Enable basic profiling code on s390 depending on CONFIG_PROFILING, not
    CONFIG_OPROFILE.
    
    CONFIG_PROFILING should enable the generic profiling code here, even if
    CONFIG_OPROFILE is not set.  Note that the identical code on i386 is always
    compiled in, regardless of CONFIG_PROFILING and CONFIG_OPROFILE.

commit 0978a2982c2a4db046f9bde4bbdfaef5a4a60df1
Author: Andrew Morton <akpm@osdl.org>
Date:   Thu Apr 29 17:42:01 2004 -0700

    [PATCH] DVB:Fix adapter module removal bug
    
    From: Michael Hunold <hunold@convergence.de>
    
    unfortunately it's possible to remove a DVB adapter module even if a DVB
    network device has been set up using this adapter.
    
    The attached patch fixes this problem.

commit 8be18297f09d0dec013ee245bbf7196b50bf3f88
Author: Andrew Morton <akpm@osdl.org>
Date:   Thu Apr 29 17:41:49 2004 -0700

    [PATCH] efivars sysfs fix
    
    From: Matt Tolentino <metolent@snoqualmie.dp.intel.com>
    
    This trailing space in sysfs contents is not needed.

commit bc66945a8f907beb62baa490200b4a2ae1b970fb
Author: Andrew Morton <akpm@osdl.org>
Date:   Thu Apr 29 17:41:36 2004 -0700

    [PATCH] nfs printk warning fix
    
    From: Trond Myklebust <trond.myklebust@fys.uio.no>
    
    fs/nfs/direct.c: In function `nfs_direct_IO':
    fs/nfs/direct.c:458: warning: int format, different type arg (arg 2)

commit 96289450e3411c2b0d95f01c0f0ca97ab5d0989b
Author: Andrew Morton <akpm@osdl.org>
Date:   Thu Apr 29 08:17:22 2004 -0700

    [PATCH] parport pnp detection fix
    
    From: Adam Belay <ambx1@neo.rr.com>
    
    Fix http://bugme.osdl.org/show_bug.cgi?id=2540
    
    It prevents PnP detection if devices were already detected by SuperIO.

commit f155a04d8fa1301a18efdd278189cd51cff4f197
Author: Trond Myklebust <trond.myklebust@fys.uio.no>
Date:   Thu Apr 29 08:17:01 2004 -0700

    [PATCH] NFSv3: Fix SETATTR call after O_EXCL create
    
    Ensure that when we send the SETATTR call after doing an O_EXCL create,
    we always set the atime and ctime fields.
    
    See RFC1813 for details on why the server is allowed to clobber these
    two fields in order to cache a verifier that protects CREATE in case of
    a timeout+resend from the client.
    
    Patch is by Olaf Kirch.

commit 6fad9f57160e54dbfb99b0793cf5261e8d255576
Author: Stephen Hemminger <shemminger@osdl.org>
Date:   Thu Apr 29 02:26:49 2004 -0700

    [NET]: More network layer static funcs and data.

commit 1daa1f21190252f7dac6091690a79c3f5c1a03ee
Merge: bbf2b79... 1014e33...
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Thu Apr 29 01:25:17 2004 -0700

    Merge http://lia64.bkbits.net/to-linus-2.5
    into ppc970.osdl.org:/home/torvalds/v2.6/linux

commit 1014e3348745de6bbe2e6319973bacc835f0ac8e
Author: Pat Gefre <pfg@sgi.com>
Date:   Thu Apr 29 01:15:15 2004 -0700

    [PATCH] ia64: SN2 fix
    
    Move HW interrupt register init. to the proper place
    and don't force an interrupt if the IRQ is disabled
    or in progress.

commit b4c39b3012cb41017fc45607c5b15d1274f21bef
Author: David Mosberger <davidm@tiger.hpl.hp.com>
Date:   Thu Apr 29 01:14:05 2004 -0700

    ia64: Fix Exec-Only stack patch so X can work again.
    
    No pun intended, but X can't work if it can't turn on eXecute-permission
    on the some data pages...

commit bbf2b79a071781f14dca38987fed676d722be1d1
Author: Hugh Dickins <hugh@veritas.com>
Date:   Thu Apr 29 00:13:28 2004 -0700

    [PATCH] mremap offset type
    
    Just found I never changed type of move_page_tables when I changed it to
    return offset: einormous mremap moves would fail on 64-bit.

commit 1b0b1987c8d852e5f0a8575b50edb5f184755539
Merge: 8419e5f... bc97fc2...
Author: David Mosberger <davidm@tiger.hpl.hp.com>
Date:   Wed Apr 28 23:57:12 2004 -0700

    Merge tiger.hpl.hp.com:/data1/bk/vanilla/linux-2.5
    into tiger.hpl.hp.com:/data1/bk/lia64/to-linus-2.5

commit 294947ec18ff7e752304756b2e8433184bc688bb
Author: Andrew Morton <akpm@osdl.org>
Date:   Wed Apr 28 17:21:10 2004 -0700

    [PATCH] writeback livelock fix
    
    To avoid various livelocks, the writeback code parks all the dirty inodes onto
    sb->s_io and then works through that list until it is empty.  This assumes
    that each inode will be moved to some other list as it is processed.
    
    But there's a loophole: if the ->writepages() implementation does nothing at
    all, the inode is not redirtied (which would move it to s_dirty).  This causes
    s_io to not empty and pdflush goes nuts.
    
    So when this happens, move the inode onto s_dirty within
    __sync_single_inode().  Use list_move_tail() to attempt to preserve the
    time-ordering of the s_dirty list.

commit ec5510b9e9bcee9f6fadc1fbd3fd336a91fba4c2
Author: Andrew Morton <akpm@osdl.org>
Date:   Wed Apr 28 17:20:56 2004 -0700

    [PATCH] gcc-3.4.0 fixes
    
    From: Mikael Pettersson <mikpe@user.it.uu.se>
    
    This patch fixes three warnings from gcc-3.4.0 in 2.6.6-rc3:
    
    - arch/i386/pci/pcbios.c: use of "+m" constraint
    
    - drivers/char/ftape/: use of cast-as-lvalue
    
    - drivers/char/ftape/: __attribute__((packed)) on something containing only
      bytes

commit bd08b0a9713a52ba51c4779ca131ad7918608e5c
Author: Andrew Morton <akpm@osdl.org>
Date:   Wed Apr 28 17:20:44 2004 -0700

    [PATCH] Fix support for the Motorola PrPMC800
    
    From: Tom Rini <trini@kernel.crashing.org>
    
    Makes the Motorola PrPMC800 platform functional again.  This comes from Randy
    Vinson <rvinson@mvista.com>.

commit 51a58c58b6c2709a1ba15b36eebcf00260df93a9
Author: Andrew Morton <akpm@osdl.org>
Date:   Wed Apr 28 17:20:22 2004 -0700

    [PATCH] static functions in as-iosched.c
    
    From: Stephen Hemminger <shemminger@osdl.org>

commit 6d8c651aa1b67d8efa07823301c35f685fd1c885
Author: Andrew Morton <akpm@osdl.org>
Date:   Wed Apr 28 17:20:11 2004 -0700

    [PATCH] s390: oprofile for s390
    
    From: Martin Schwidefsky <schwidefsky@de.ibm.com>
    
    Add oprofile support for s/390.

commit eff7461e20d1d80fc1f0a1982e30f6ca75d4e372
Author: Andrew Morton <akpm@osdl.org>
Date:   Wed Apr 28 17:19:55 2004 -0700

    [PATCH] s390: zfcp host adapter
    
    From: Martin Schwidefsky <schwidefsky@de.ibm.com>
    
    zfcp host adapter change:
     - Fix addressing exception due to uninitialized host_scribble pointer.

commit 942c6825417f51eba3d6af01947203ddadc384f3
Author: Andrew Morton <akpm@osdl.org>
Date:   Wed Apr 28 17:19:43 2004 -0700

    [PATCH] s390: 3270 console driver
    
    From: Martin Schwidefsky <schwidefsky@de.ibm.com>
    
    3270 device driver change:
     - Add missing irb error checking.

commit 1ca0642998b91d289350ca5ce2676821136b2dc1
Author: Andrew Morton <akpm@osdl.org>
Date:   Wed Apr 28 17:19:30 2004 -0700

    [PATCH] s390: network driver
    
    From: Martin Schwidefsky <schwidefsky@de.ibm.com>
    
    Network driver changes:
     - ctc: Add missing irb error checking.
     - iucv: Add name of net_device to iucvMagic to more than one
             connection between two guests.
     - qeth: Don't send IPA command if card is not in state SOFTSETUP or UP.
     - qeth: Fix number base in simple_strtoul call for buffer_count attribute.
     - qeth: Fix reallocating of buffers when buffer_count attribute is changed.
     - qeth: Correct handling of return codes in qeth_realloc_buffer_pool.
     - qeth: Don't call dev_close/dev_open on STOPLAN/STARTLAN commands.
             Use netif_carrier_off/netif_carrier_on instead.

commit 10281b07345d28b1fc65879951da202704500111
Author: Andrew Morton <akpm@osdl.org>
Date:   Wed Apr 28 17:19:17 2004 -0700

    [PATCH] s390: common i/o layer
    
    From: Martin Schwidefsky <schwidefsky@de.ibm.com>
    
    Common i/o layer changes:
     - Don't use bus ids in crw debug feature.
     - Use cio_oper for oper notification to disconnected devices.
     - Remove __get_subchannel_by_stsch.
     - Make cio workqueue a single threaded workqueue.
     - Introduce addiotnal cio_notify workqueue for device driver notification.
     - Switch off path in vpm if cio_start returned -ENODEV.
     - Fix rescan for new subchannels after a logical vary on.

commit 9dfdf818b7fa47c82ced2a259c20cce08dcc6f08
Author: Andrew Morton <akpm@osdl.org>
Date:   Wed Apr 28 17:19:03 2004 -0700

    [PATCH] s390: core s390
    
    From: Martin Schwidefsky <schwidefsky@de.ibm.com>
    
    s390 core changes:
     - Move setting/clearing of TIF_31BIT thread flag to SET_PERSONALITY.
     - Use TASK_UNMAPPED_BASE in elf_map32 for mmaps with address 0.
     - Define ARCH_KMALLOC_MINALIGN.
     - Define ARCH_MIN_TASKALIGN.

commit 60d5399425e61d2ca18ce23b46b4c77693ea423d
Author: Andrew Morton <akpm@osdl.org>
Date:   Wed Apr 28 17:18:52 2004 -0700

    [PATCH] cciss MAINTAINERS update
    
    From: <mikem@beardog.cca.cpqcorp.net>
    
    Here's an update for the MAINTAINERS file.

commit 5a1b759d1fa3c9b95a6b4c2e45b992de6d941071
Author: Andrew Morton <akpm@osdl.org>
Date:   Wed Apr 28 17:18:37 2004 -0700

    [PATCH] cciss build fix
    
    From: <mikem@beardog.cca.cpqcorp.net>
    
    This patch fixes the linux/include/cciss_ioctl.h file.  When support for the
    cciss big ioctl was added the stucture in the header was put in the wrong
    place.  If an application includes the file it will fail to compile.

commit 2acf06fa079c67c8283915a5471be73427e9b174
Author: Andrew Morton <akpm@osdl.org>
Date:   Wed Apr 28 17:18:25 2004 -0700

    [PATCH] Update kerneltraffic link in SubmittingDrivers and kernel-docs.txt
    
    From: Coywolf Qi Hunt <coywolf@greatcn.org>
    
    This updates the kerneltraffic url link found in
    Documentation/SubmittingDrivers and Documentation/kernel-docs.txt.

commit 37b35320831dc7adff9ba561c571889e80cfa13c
Author: Andrew Morton <akpm@osdl.org>
Date:   Wed Apr 28 17:18:11 2004 -0700

    [PATCH] ppc32: compile error in signal.c
    
    From: Meelis Roos <mroos@linux.ee>
    
    arch/ppc/kernel/signal.c: In function `handle_signal':
    arch/ppc/kernel/signal.c:518: error: `newspp' undeclared (first use in this function)
    arch/ppc/kernel/signal.c:518: error: (Each undeclared identifier is reported only once
    arch/ppc/kernel/signal.c:518: error: for each function it appears in.)
    arch/ppc/kernel/signal.c:518: warning: long unsigned int format, pointer arg (arg 3)

commit c0951c410582954a3a924bb7944d5bb6862c80d7
Author: Andrew Morton <akpm@osdl.org>
Date:   Wed Apr 28 17:17:59 2004 -0700

    [PATCH] cifssmb.c warning fix
    
    On ppc64, __u64 is `unsigned long', so:
    
    fs/cifs/cifssmb.c: In function `CIFSSMBSetFileSize':
    fs/cifs/cifssmb.c:2466: warning: long long int format, __u64 arg (arg 2)

commit c6845c0ca139cf5b27855481b1cb7179b990296d
Author: Alexander Viro <viro@parcelfarce.linux.theplanet.co.uk>
Date:   Wed Apr 28 17:15:20 2004 -0700

    [PATCH] Fix might_sleep in /proc/swaps code
    
    This fixes a locking problem noted by Tim Hockin:
        * /proc/swaps uses seq_file code, calling seq_path() with swaplock held
        * seq_path() calls d_path()
        * d_path() calls mntput() which might_sleep()
    
    We add a new semaphore protecting insertions/removals in the set of swap
    components + switch of ->start()/->stop() to the same semaphore [fixes
    deadlocks] + trivial cleanup of ->next().

commit ae08d237f10fab2abdd315362571b02862789f7b
Author: David Gibson <david@gibson.dropbear.id.au>
Date:   Wed Apr 28 17:12:31 2004 -0700

    [PATCH] POWER5 erratum workaround
    
    Early POWER5 revisions (<DD2.1) have a problem requiring slbie
    instructions to be repeated under some circumstances.  The patch below
    adds a workaround (patch made by Anton Blanchard).

commit e375620095157b2859051c733973808f07d684b4
Author: David Gibson <david@gibson.dropbear.id.au>
Date:   Wed Apr 28 17:11:59 2004 -0700

    [PATCH] Fix overeager stack-expansion on ppc64
    
    This fix is from Paul Mackerras and was applied in 2.4 sometime late
    last year.
    
    On ppc64, touching addresses between the highest other mapping and the
    stack can cause the stack to be extended way, way down, rather than
    causing a SEGV as you would expect.  This patch only allows the stack
    mapping to be extended to cover addresses actually within the stack
    (as determined by looking at the process's r1).  This fix is ported
    from 2.4
    
    This fixes failures on the LTP's shmdt01, munmap01 and munmap02 tests.

commit 4734c153536f7ac4a899ef8dcd50b88778fe879b
Author: Bartlomiej Zolnierkiewicz <b.zolnierkiewicz@elka.pw.edu.pl>
Date:   Wed Apr 28 17:11:24 2004 -0700

    [PATCH] fix default IDE interfaces initialization for PPC32
    
    In ide_init_default_irq() patch I overlooked that ppc_ide_md.init_hwif_ports()
    called from generic ide_init_hwif_ports() can set hwif->irq and it will
    be overwritten by ide_init_default_irq() if CONFIG_PCI is defined.  Fix
    it.
    
    I will clean it up properly later after killing ide_init_hwif_ports() on
    ARM{26}.  Doing it now is just wasted effort.

commit cd6f295380033aee935282366616166f60d3c803
Merge: 8419e5f... 70cc3df...
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Wed Apr 28 17:10:01 2004 -0700

    Merge bk://bk.arm.linux.org.uk/linux-2.6-rmk
    into ppc970.osdl.org:/home/torvalds/v2.6/linux

commit 70cc3dfaa20b515a3cdf36db1db6456835dee39f
Author: Dirk Behme <dirk.behme@com.rmk.(none)>
Date:   Thu Apr 29 16:08:42 2004 +0100

    [ARM PATCH] 1835/1: Make ALTERA Excalibur work again in 2.6.5
    
    Patch from Dirk Behme
    
    Make ALTERA Excalibur work again in 2.6.4. Update serial driver uart00.c and defconfig.
    
    This is an update of patch 1833/1.
    
    Remove #include <config/pld/hotswap.h>, it isn't necessary at all.

commit f3fea91519aea87d00a1dd38bedeb1f22fb78dff
Author: Russell King <rmk@flint.arm.linux.org.uk>
Date:   Thu Apr 29 14:50:28 2004 +0100

    [ARM] Add Versatile default configuration

commit de837a59a327c24f04b0dc9ef9cc92fd4e364131
Author: Russell King <rmk@flint.arm.linux.org.uk>
Date:   Thu Apr 29 11:59:19 2004 +0100

    [ARM] Move all page fault handling code to fault.c

commit 4b72375d25b17fd3f707b52bcd93799425e5a31e
Author: Russell King <rmk@flint.arm.linux.org.uk>
Date:   Thu Apr 29 00:24:57 2004 +0100

    [ARM] Fix atomic bitops earlyclobber
    
    atomic_dec_and_test and atomic_add_negative didn't mark their
    temporary variables as early-clobber.  Fix this.

commit e66bbef5e3356797cbd814249b0ac13f2eb3198c
Author: Russell King <rmk@flint.arm.linux.org.uk>
Date:   Wed Apr 28 22:32:24 2004 +0100

    [ARM] Fix read_cpuid()

commit 4197692eef113eeb8e3e413cc70993a5e667e5b8
Author: Russell King <rmk@flint.arm.linux.org.uk>
Date:   Wed Apr 28 22:22:33 2004 +0100

    [ARM] Fix shared mmap()ings for ARM VIPT caches.
    
    This allows us to appropriately align shared mappings on VIPT caches
    with aliasing issues.

commit bb3c779f12c0163dfebf958da45821cd1cd0c495
Author: Russell King <rmk@flint.arm.linux.org.uk>
Date:   Wed Apr 28 21:06:49 2004 +0100

    [ARM] Remove Anakin default configuration file.

commit 00e35a54fcbd190cb0440140b7f6fa06e663c5fa
Author: Russell King <rmk@flint.arm.linux.org.uk>
Date:   Wed Apr 28 19:51:49 2004 +0100

    [ARM] Fix monspecs in ARM-related framebuffer drivers.
    
    Use named initialisers for monspecs; the format of the structure
    changed a while back and it broke.

commit d63f2a5a2ec50a2cf422ffb165170063a67753a2
Author: Russell King <rmk@flint.arm.linux.org.uk>
Date:   Wed Apr 28 19:33:54 2004 +0100

    [ARM] Oprofile should use asm/irq.h not asm/arch/irqs.h

commit a9c64f5c9afeebda070668ac9d0ada606f8110fa
Author: Russell King <rmk@flint.arm.linux.org.uk>
Date:   Wed Apr 28 19:24:24 2004 +0100

    [ARM] Fix dependencies of SERIO_AMBAKMI and SERIO_RPCKBD

commit 19188f5afa1cbae487b373eb20823b17299486c2
Author: Russell King <rmk@flint.arm.linux.org.uk>
Date:   Wed Apr 28 18:52:43 2004 +0100

    [ARM] Update ioremap implementation.
    
    Use flush_cache_vmap() after creating mappings.  Also use BUG_ON()
    rather than if() BUG().

commit cac923d20980d4065d53a23443b4a42a30fa9a3c
Author: Russell King <rmk@flint.arm.linux.org.uk>
Date:   Wed Apr 28 18:16:11 2004 +0100

    [ARM] Update assabet_defconfig.

commit 9a2bf4cc878bdc38bd4c0b43ed0560377d7a9aee
Author: Russell King <rmk@flint.arm.linux.org.uk>
Date:   Wed Apr 28 16:15:04 2004 +0100

    [ARM] Fix BE find_*_bit operations
    
    These broke when find_first_bit/find_next_bit was added.

commit 5fdc760e5e8bb95555c78ac89cc7ccc7c1d60ea0
Author: Russell King <rmk@flint.arm.linux.org.uk>
Date:   Wed Apr 28 16:02:29 2004 +0100

    [ARM] Add read_cpuid() to aid reading CPU ID registers.

commit a621283933ed95bc677911f92858e2f29a01ec36
Author: David Vrabel <dvrabel@com.rmk.(none)>
Date:   Wed Apr 28 14:58:49 2004 +0100

    [ARM PATCH] 1832/1: Typo in dma_unregister_dev printk
    
    Patch from David Vrabel
    
    Fix a trivial typo in a dma_unregister_dev printk.

commit 12b00b39baa26468f96946e1c2aca1a0e9c0800b
Merge: 4a95234... 16bd713...
Author: Anton Altaparmakov <aia21@cantab.net>
Date:   Wed Apr 28 13:19:09 2004 +0100

    Merge cantab.net:/home/src/bklinux-2.6
    into cantab.net:/home/src/ntfs-2.6

commit 4a95234986de4dda0e8b75e244176e9f27857d7b
Author: Anton Altaparmakov <aia21@cantab.net>
Date:   Wed Apr 28 12:14:05 2004 +0100

    NTFS: - Fix compiler warnings related to type casting.
          - Move %L to %ll as %L is floating point and %ll is integer which
            is what we want.
          - Add logfile inode to ntfs_volume structure and the code to clean
            it up in super.c.

commit 8419e5fe21f911303394b3190d928a4240955709
Merge: 551800f... a6ff950...
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Wed Apr 28 03:06:47 2004 -0700

    Merge bk://kernel.bkbits.net/davem/net-2.6
    into ppc970.osdl.org:/home/torvalds/v2.6/linux

commit a6ff950a6a26eb78c438be679f7a837dfa9e508e
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Wed Apr 28 02:08:37 2004 -0700

    Tell the sparse checker to use 64-bit mode when checking
    a ppc64 tree.

commit 6df4b730f4baafa4753eb7b9a042fa6a718aa7a8
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Wed Apr 28 02:06:55 2004 -0700

    Add __user annotations to ppc64 user access functions.

commit 9fbc6c6cc4f6a82216d9325d6e0a82fa28be4b19
Author: Stephen Hemminger <shemminger@osdl.org>
Date:   Wed Apr 28 02:05:29 2004 -0700

    [NETLINK]: Mark some functions/data static.

commit 551800ffdcb341c84d14c3b0df41f309d8e0173b
Merge: 7e5000e... 533a071...
Author: David S. Miller <davem@kernel.bkbits.net>
Date:   Tue Apr 27 23:10:27 2004 -0700

    Merge davem@nuts.davemloft.net:/disk1/BK/net-2.6
    into kernel.bkbits.net:/home/davem/net-2.6

commit 7e5000e4cb55cb9e3260d8dc0c524a446ccea6d7
Author: David S. Miller <davem@nuts.davemloft.net>
Date:   Tue Apr 27 22:51:11 2004 -0700

    [SPARC64]: Update defconfig.

commit 8f8fd38b2660a73dbe9b0de8dc21aeb31df8e766
Author: Clay Haapala <chaapala@cisco.com>
Date:   Tue Apr 27 22:34:04 2004 -0700

    [CRYPTO]: Provide crc32c as a type of digest.

commit 7cf5ff202627803e9bdd8c924f572eb8104cc3b8
Author: Clay Haapala <chaapala@cisco.com>
Date:   Tue Apr 27 22:30:17 2004 -0700

    [LIB]: Use compiler.h's pure attribute macros in crc32.c.

commit 37574f10f10a5dcc5809e6f99d9cb973be4c4991
Author: Clay Haapala <chaapala@cisco.com>
Date:   Tue Apr 27 22:29:12 2004 -0700

    [LIB]: Add CRC32c (Castagnoli, et al Cyclic Redundancy-Check)

commit 9397dee2ba39f298c428816fc611464cafeb3946
Author: Stephen Hemminger <shemminger@osdl.org>
Date:   Tue Apr 27 22:26:48 2004 -0700

    [IPV4]: Use static in several places.
    
    More functions and data that should be static.

commit 533a071fbc819080f1e70da2ef99337d26912a74
Author: Ivan Kokshaysky <ink@jurassic.park.msu.ru>
Date:   Tue Apr 27 19:58:52 2004 -0700

    [PATCH] Fix rwsem contention case on alpha/s390x
    
    Thanks to Dru <andru@treshna.com>, who provided an easy way to reproduce
    the problem.
    
    What we have in lib/rwsem.c:__rwsem_do_wake():
    	int woken, loop;
    	^^^
    and several lines below:
    	loop = woken;
    	woken *= RWSEM_ACTIVE_BIAS-RWSEM_WAITING_BIAS;
    	woken -= RWSEM_ACTIVE_BIAS;
    
    However, rw_semaphore->count is 64-bit on Alpha, so
    RWSEM_WAITING_BIAS has been defined as -0x0000000100000000L.
    Obviously, this blows up in the write contention case.

commit c631700d2d729980137611b32d6b56723d1d57e5
Author: Armin Schindler <armin@melware.de>
Date:   Tue Apr 27 18:50:59 2004 -0700

    [PATCH] ISDN CAPI: fix ncci list semaphore
    
    Fix new ISDN CAPI's internal ncci list semaphore if
    CONFIG_ISDN_CAPI_MIDDLEWARE is disabled.
    
    Thanks to Florian Schirmer.

commit 165bcfcf0442101ef6e95e3d7d6a33570f757911
Merge: 4c9ff8d... abfd7fc...
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Tue Apr 27 18:28:34 2004 -0700

    Merge http://xfs.org:8090/xfs-linux-2.6
    into ppc970.osdl.org:/home/torvalds/v2.6/linux

commit 4c9ff8d06c103ccfe82c2abd730e654920951942
Merge: f2ef8e8... 04a3dfa...
Author: Nathan Scott <nathans@sgi.com>
Date:   Thu Apr 29 11:12:50 2004 +1000

    Merge nathans@xfs.org:/export/hose/bkroot/xfs-linux-2.6
    into sgi.com:/source2/xfs-linux-2.6

commit f2ef8e82a31c5af3ec7f698fdc08d57da7cc70ac
Author: Christoph Hellwig <hch@sgi.com>
Date:   Thu Apr 29 10:45:34 2004 +1000

    [XFS] close external blockdevice after final flush
    
    SGI Modid: xfs-linux:xfs-kern:170489a

commit b606f6bf62cb9cec6328f9d9e6d24efc05b79f84
Author: Dean Roehrich <roehrich@sgi.com>
Date:   Thu Apr 29 10:39:46 2004 +1000

    [XFS] Remove <linux/mman.h> now that linvfs_mprotect doesn't need it.
    
    SGI Modid: xfs-linux:xfs-kern:170509a

commit 6e26c0a3fc342510a901c08ec6df594e03e4fcf9
Author: Dean Roehrich <roehrich@sgi.com>
Date:   Thu Apr 29 10:24:24 2004 +1000

    [XFS] Fix dmapi/mprotect interaction
    
    SGI Modid: xfs-linux:xfs-kern:170448a

commit adda10937c78955b4e51c837f7f00a1bb6fa445f
Merge: 16bd713... d61a4de...
Author: Nathan Scott <nathans@sgi.com>
Date:   Thu Apr 29 10:19:56 2004 +1000

    Merge sgi.com:/source2/linux-2.6 into sgi.com:/source2/xfs-linux-2.6

commit abfd7fc483570825d4e6c556d62acf90750ffb90
Author: Andrew Morton <akpm@osdl.org>
Date:   Tue Apr 27 18:16:03 2004 -0700

    [PATCH] ppc32: Update Motorola PrPMC750 support
    
    From: Tom Rini <trini@kernel.crashing.org>
    
    This patch updates support for the Motorola PrPMC750 platform.  Most of the
    size in this patch comes from merging prpmc750_pci.c and prpmc750_setup.c into
    just prpmc750.c.

commit 6c4f928be7a68599cc89c0519f6bd5c83b1a53be
Author: Andrew Morton <akpm@osdl.org>
Date:   Tue Apr 27 18:15:12 2004 -0700

    [PATCH] ppc32: Add openpic_hookup_cascade()
    
    From: Tom Rini <trini@kernel.crashing.org>
    
    This patch adds openpic_hookup_cascade(offset, name, handler) which allows for
    an arbitrary interrupt controller to be hooked up as a cascade to the openpic.
     This also allows for platforms to just not have a cascaded controller.

commit 9be15f90120eb63f7b948f2343ecd62a0d20a59c
Author: Andrew Morton <akpm@osdl.org>
Date:   Tue Apr 27 18:15:00 2004 -0700

    [PATCH] ppc32: Update SBS K2 support
    
    From: Tom Rini <trini@kernel.crashing.org>
    
    This patch updates support for the SBS K2 platform.  Most of the size in this
    patch comes from merging k2_pci.c and k2_setup.c into just k2.c.

commit 3e0dd373fff6ffb884293cfaaa9be4a93cbb76ab
Author: Andrew Morton <akpm@osdl.org>
Date:   Tue Apr 27 18:14:38 2004 -0700

    [PATCH] fix warning in arch/ppc/boot/simple/misc.c
    
    From: Christoph Hellwig <hch@lst.de>
    
    asm-ppc/elf.h uses a pointer to struct task_struct without any
    forward-declaration.
    
    In file included from include/linux/elf.h:5,
                     from arch/ppc/boot/simple/misc.c:20:
    include/asm/elf.h:102: warning: `struct task_struct' declared inside parameter list
    include/asm/elf.h:102: warning: its scope is only this definition or declaration, which is probably not what you want

commit caff0e5e69eae3f18e306c04c00d613dd4c80045
Author: Andrew Morton <akpm@osdl.org>
Date:   Tue Apr 27 18:14:27 2004 -0700

    [PATCH] Fix thinkos in #if -> #ifdef conversions #2
    
    From: Tom Rini <trini@kernel.crashing.org>
    
    And when trying to catch up on old patches, I forgot this hunk:

commit d61a4de11ca55278c8874cb3f91d03518c2052c9
Merge: 8528376... 78ba94e...
Author: Nathan Scott <nathans@sgi.com>
Date:   Wed Apr 28 11:14:14 2004 +1000

    Merge sgi.com:/source2/linux-2.6 into sgi.com:/source2/xfs-linux-2.6

commit 95c063134596e2f887945bc6cebd692ff5f90678
Author: Andrew Morton <akpm@osdl.org>
Date:   Tue Apr 27 18:14:13 2004 -0700

    [PATCH] Fix thinkos in #if -> #ifdef conversions
    
    From: Tom Rini <trini@kernel.crashing.org>
    
    When I changed some '#if FOO' tests to '#ifdef FOO' I forgot to make sure
    that nothing was doing #define FOO 0.  So after auditing all of the changes
    I made, the following is needed:

commit f6364f273bae083d8bb19ea872d6c72623d95d03
Author: Andrew Morton <akpm@osdl.org>
Date:   Tue Apr 27 18:14:02 2004 -0700

    [PATCH] ppc64: Set memory-only nodes online
    
    From: Olof Johansson <olof@austin.ibm.com>
    
    On pSeries LPARs we might end up with NUMA nodes that only have memory and
    no CPUs.  Only the CPU configuration code actually set a node online, so
    memory-only nodes wouldn't show up in sysfs.  Below patch adds the
    set_online call to the memory loop too.

commit aa995aac65c36bade5d2101de519ae08c3d6c593
Author: Andrew Morton <akpm@osdl.org>
Date:   Tue Apr 27 18:13:48 2004 -0700

    [PATCH] fix warning in fs/dquot.c
    
    From: "Luiz Fernando N. Capitulino" <lcapitulino@prefeitura.sp.gov.br>
    
    fs/dquot.c: In function `vfs_quota_off':
    fs/dquot.c:1328: warning: label `out' defined but not used

commit cd51e1841f557648e732879c5871c6d0b52c67b0
Merge: b166412... 762a222...
Author: Len Brown <len.brown@intel.com>
Date:   Tue Apr 27 20:19:52 2004 -0400

    Merge intel.com:/home/lenb/src/linux-acpi-test-2.6.5
    into intel.com:/home/lenb/src/linux-acpi-test-2.6.6

commit 762a222a4abf38a3f7253d42a553e9729d0618c7
Author: Len Brown <len.brown@intel.com>
Date:   Tue Apr 27 20:18:25 2004 -0400

    [ACPI] button build fix

commit b16641235b8ea6187d95e6ea1d91d7859f6c38ec
Merge: 39140b9... 8735c65...
Author: Len Brown <len.brown@intel.com>
Date:   Tue Apr 27 19:29:09 2004 -0400

    Merge intel.com:/home/lenb/src/linux-acpi-test-2.6.5
    into intel.com:/home/lenb/src/linux-acpi-test-2.6.6

commit 8735c65b6a3439e31c230b729d888a97dd6c3a00
Author: Len Brown <len.brown@intel.com>
Date:   Tue Apr 27 19:27:33 2004 -0400

    [ACPI] fix build warning in dmi_scan

commit 39140b97f5c2949369c979e79302bc4493c60080
Merge: b3a026d... b39d913...
Author: Len Brown <len.brown@intel.com>
Date:   Tue Apr 27 19:18:06 2004 -0400

    Merge intel.com:/home/lenb/src/linux-acpi-test-2.6.5
    into intel.com:/home/lenb/src/linux-acpi-test-2.6.6

commit b39d913e9fa913931b73f8730f59dd30391a3282
Author: Len Brown <len.brown@intel.com>
Date:   Tue Apr 27 19:12:21 2004 -0400

    [ACPI] support button driver unload (Luming Yu)
    http://bugzilla.kernel.org/show_bug.cgi?id=2281

commit b3a026dc3f38f11196cdbc57cf17d6896a55e8bb
Merge: 32f82c0... 62560d6...
Author: Len Brown <len.brown@intel.com>
Date:   Tue Apr 27 19:09:42 2004 -0400

    Merge intel.com:/home/lenb/src/linux-acpi-test-2.6.5
    into intel.com:/home/lenb/src/linux-acpi-test-2.6.6

commit 62560d62bdd8c6e7ea760efdb5c5e6e67fb5f448
Author: Len Brown <len.brown@intel.com>
Date:   Tue Apr 27 18:32:44 2004 -0400

    [ACPI] toshiba_acpi driver if acpi_disabled (David Shaohua Li)
    http://bugzilla.kernel.org/show_bug.cgi?id=2465

commit da6a1551584399ffd2881a21fe287eddbc0eaf35
Author: Len Brown <len.brown@intel.com>
Date:   Tue Apr 27 18:19:03 2004 -0400

    [ACPI] rmmod ACPI modules vs /proc
    from Anil S Keshavamurthy and David Shaohua Li
    http://bugzilla.kernel.org/show_bug.cgi?id=2457

commit b7b8c5cb1821d700844aa5397de54af068bc5c8f
Author: Len Brown <len.brown@intel.com>
Date:   Tue Apr 27 18:04:06 2004 -0400

    [ACPI] pci-link may not always be SHARED (SuSE via Luming Yu)
    http://bugzilla.kernel.org/show_bug.cgi?id=2404

commit 0d56df4024da1b6b2e77c0747354332c3afd4a4c
Author: Len Brown <len.brown@intel.com>
Date:   Tue Apr 27 17:28:10 2004 -0400

    [ACPI] battery "charged" instead of "unknown" (Luming Yu)
    http://bugzilla.kernel.org/show_bug.cgi?id=1863

commit dff9ecd03e4684c4281036c72ffc0cd6e2024f7f
Author: Karol Kozimor <sziwan@hell.org.pl>
Date:   Tue Apr 27 16:41:56 2004 -0400

    [PATCH] acpi4asus 0.28 (Karol 'sziwan' Kozimor)
    - Added support for Samsung P30
    - Fixed an oops triggered by non-standard hardware (Samsung P30)
    - Added support for L4400L and M6800N
    
    The patch also removes some superfluous data. It doesn't include the
    copy_from_user() conversion, it will be released as a separate patch.

commit f1369bc800b1433714423354655ed97653798c10
Author: Andrew Morton <akpm@osdl.org>
Date:   Tue Apr 27 16:39:07 2004 -0400

    [PATCH] acpi build fix
    setup.c:608: `acpi_skip_timer_override' undeclared

commit 04a3dfacc6be251e78e3373eecffc966c929f4a6
Merge: 16bd713... 78ba94e...
Author: Nathan Scott <nathans@lips.borg.umn.edu>
Date:   Tue Apr 27 13:56:35 2004 -0500

    Merge bk://linux.bkbits.net/linux-2.5
    into lips.borg.umn.edu:/export/music/bkroot/xfs-linux-2.6

commit 7ab6405529004cf01fddbbec9254103a496a2197
Author: David S. Miller <davem@nuts.davemloft.net>
Date:   Tue Apr 27 06:35:28 2004 -0700

    [SPARC64]: Fix MAP_FIXED+shared address check, noticed by rmk.

commit 0cc4d622060662632d97ab1dd9f040affff8bccd
Author: Stephen Hemminger <shemminger@osdl.org>
Date:   Tue Apr 27 06:29:45 2004 -0700

    [TCP]: tcp_send_skb code pruning
    
    The function tcp_send_skb is only called from tcp_fin, and is always called
    with force_queue=1.  Therefore, it no longer needs to be global and the code
    to send right now can be removed.  Because it always queues, change the
    name as well, and fix up the comment.

commit aea571fcad94946dbf91c475a465abf402778e3c
Merge: 9fa12b0... 93b62d3...
Author: Anton Altaparmakov <aia21@cantab.net>
Date:   Tue Apr 27 14:29:14 2004 +0100

    Merge cantab.net:/home/src/bklinux-2.6
    into cantab.net:/home/src/ntfs-2.6

commit 93b62d3ac3a12a32d1f2fdc11381d2d2f28a7ab8
Author: Anton Altaparmakov <aia21@cantab.net>
Date:   Tue Apr 27 14:27:16 2004 +0100

    NTFS: Load the mft mirror at mount time and compare the mft records
          stored in it to the ones in the mft (fs/ntfs/super.c).

commit 9b4ea1a1614168c51afe0e6dff12e0b373d11e8b
Merge: 9b153b2... 16bd713...
Author: David S. Miller <davem@nuts.davemloft.net>
Date:   Tue Apr 27 06:25:01 2004 -0700

    Merge nuts.davemloft.net:/disk1/BK/network-2.6
    into nuts.davemloft.net:/disk1/BK/net-2.6

commit 16bd713551a4857a002e8e28e3d6e7c6421d63bf
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Tue Apr 27 04:31:21 2004 -0700

    Linux 2.6.6-rc3

commit 7cd8ebe7d68ef0816df4a1a4efe977f7d70d7c04
Author: Rusty Russell <rusty@rustcorp.com.au>
Date:   Tue Apr 27 04:30:50 2004 -0700

    [PATCH] Fix cpumask iterator over empty cpu set
    
    Can't use _ffs() without first checking for zero, and if bits beyond
    NR_CPUS set it'll give bogus results.  Use find_first_bit

commit 6e2139cb1971ac8cae7afb9c4ed47cb0d6a11c5a
Merge: 6e305f2... 0eaa6e8...
Author: Steve French <cifs.adm@hostme.bitkeeper.com>
Date:   Tue Apr 27 04:09:22 2004 -0700

    Merge bk://linux.bkbits.net/linux-2.5
    into hostme.bitkeeper.com:/repos/c/cifs/linux-2.5cifs

commit 6e305f2421906dcdcafbf9dea5e660bcadfffed7
Author: Steve French <stevef@stevef95.austin.ibm.com>
Date:   Tue Apr 27 06:50:50 2004 -0500

    fix double entry typo

commit bb550c6e75da3f0fef0469a89bb2a5f2bc931557
Author: Steve French <stevef@stevef95.austin.ibm.com>
Date:   Tue Apr 27 06:43:22 2004 -0500

    fixes for socket retry and error handling of misc. error paths

commit 9b153b25320a92f5d81f1f71121897ad7f263c81
Author: Stephen Hemminger <shemminger@osdl.org>
Date:   Tue Apr 27 01:05:49 2004 -0700

    [NET]: Eliminate large inlines in skbuff.h

commit 0eaa6e8ab2e28b8fc2992d0360f8d178de8106a5
Merge: aa7c5aa... 5435f08...
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Mon Apr 26 21:57:18 2004 -0700

    Merge bk://kernel.bkbits.net/davem/sparc-2.6
    into ppc970.osdl.org:/home/torvalds/v2.6/linux

commit 5435f08fd0bf540cb69db3eb9150aad6eb0029e6
Author: Eric Brower <ebrower@usa.net>
Date:   Mon Apr 26 21:45:32 2004 -0700

    [COMPAT]: HDIO_DRIVE_TASK is a compatible ioctl.

commit aa7c5aa0953e5f14d06e3769ec832dd7f65fbb29
Author: David S. Miller <davem@nuts.davemloft.net>
Date:   Mon Apr 26 20:31:55 2004 -0700

    [TG3]: Undo comment typo fix, it was wrong.

commit 69a7bf9b022150ddabb5e94f90559152a601263e
Author: Michal Ludvig <mludvig@suse.cz>
Date:   Mon Apr 26 20:26:32 2004 -0700

    [CRYPTO]: Add module aliases for des and sha512.

commit fe43789959ad0a50a99b8510520f58260a47ec73
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Mon Apr 26 19:26:47 2004 -0700

    Include <linux/syscalls.h> in files that need them.

commit 38aad1bc14f077a40ae0a617ff0f25fed867a437
Merge: a771662... 8571157...
Author: Steve French <cifs.adm@hostme.bitkeeper.com>
Date:   Mon Apr 26 19:01:09 2004 -0700

    Merge bk://linux.bkbits.net/linux-2.5
    into hostme.bitkeeper.com:/repos/c/cifs/linux-2.5cifs

commit a7716627dd19f0ea48f8ed785baadbb2e956a515
Author: Jens Axboe <axboe@suse.de>
Date:   Mon Apr 26 18:27:53 2004 -0700

    [PATCH] fix SG_IO page leak
    
    We cannot always rely on ->biotail remaining untouched. Currently we
    leak all the pinned user pages when doing cdda ripping at least, so I
    see no way around keeping the bio pointer seperate and passing it back
    in for unmap. Alternatively, we could invent a struct blk_map_data and
    put it on the stack for passing to both map and unmap.

commit 2f04ba946810e409f29a8d3a6b0d5ff7a26491f6
Merge: 53ef168... 2c58a71...
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Mon Apr 26 18:13:17 2004 -0700

    Merge http://jfs.bkbits.net/linux-2.5
    into ppc970.osdl.org:/home/torvalds/v2.6/linux

commit 2c58a71fbc93c84da84a67a2ba54526b0f967157
Author: Dave Kleikamp <shaggy@austin.ibm.com>
Date:   Mon Apr 26 23:04:53 2004 -0500

    JFS: Fix non-ascii file name problem
    
    An unintentional sign extention caused non-ascii characters to be
    stored incorrectly, leading to inaccessible files.  Changing a
    declaration to unsigned char fixes the problem.

commit 53ef168a1c54850d14b83450ebfab51355382120
Merge: 9fa12b0... 07d78b7...
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Mon Apr 26 16:55:06 2004 -0700

    Merge bk://ppc.bkbits.net/for-linus-ppc
    into ppc970.osdl.org:/home/torvalds/v2.6/linux

commit c9dba577d9e9d59f4d977fe63479d9be1481f2dc
Merge: 09b9f93... 0de89e2...
Author: Anton Altaparmakov <aia21@cantab.net>
Date:   Mon Apr 26 23:48:20 2004 +0100

    Merge cantab.net:/home/src/bklinux-2.6
    into cantab.net:/home/src/ntfs-2.6

commit 85711571fab1bcf4a9d04fb3e99778aeb8e5bb35
Merge: c0bebb3... 02f2435...
Author: Steve French <stevef@smfhome.smfsambadom>
Date:   Mon Apr 26 14:42:42 2004 -0500

    Merge bk://cifs.bkbits.net/linux-2.5cifs
    into smfhome.smfsambadom:/suse/home/stevef/bk/linux-2.5cifs

commit 02f243585561e9c8de5d994515fa0b5fb8618c8a
Author: Steve French <stevef@smfhome.smfsambadom>
Date:   Mon Apr 26 14:33:08 2004 -0500

    do not block (writing back to the filesystem potentially) while allocating smb buffers

commit 9fa12b00fc33468238cb6a9e2bff10c30189be9b
Merge: 5ca259f... 36774bc...
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Mon Apr 26 09:20:17 2004 -0700

    Merge bk://kernel.bkbits.net/davem/net-2.6
    into ppc970.osdl.org:/home/torvalds/v2.6/linux

commit 5ca259f3ee3bdeb92e524a72b0787e8d59e30a70
Merge: 95065ad... 632b9c9...
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Mon Apr 26 09:19:22 2004 -0700

    Merge bk://kernel.bkbits.net/davem/tg3-2.6
    into ppc970.osdl.org:/home/torvalds/v2.6/linux

commit 95065ad3fa787c417008a36d3a5d9a3bab17ab98
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon Apr 26 09:16:34 2004 -0700

    [PATCH] kbuild: Improved external module support
    
    From: Sam Ravnborg <sam@ravnborg.org>
    
    The external module support recently introduced caused a number of problems:
    - To build an external module the Module.symvers file was needed
    - To create the Module.symvers file a module was required
    - If Module.symvers was missing kbuild boiled out with an error
    - If vmlinux was missing also the stage 2 of module build failed (make -k)
    - It was not documented what was needed to actually bauild a module
    
    The following patch addresses this by adding the following functionality:
    - Always generate the Module.symvers file
    - Ignore a missing Module.symvers file
    - Add a new target modules_prepare, it prepares the kernel for building
      external modules, and is also usefull with O=
    - And it adds some more comments to Makefile.modpost, so others may follow
      it with some luck
    - .modpost.cmd is no longer generated
    
    This should close all reports on issues with respect to building external
    modules with current kernel - which has been identified as kernel problems.

commit e354a56d5cdeeced8b3e18d23f68e436237c9dda
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon Apr 26 09:04:34 2004 -0700

    [PATCH] doc: specifiying module parameters
    
    From: "Randy.Dunlap" <rddunlap@osdl.org>
    
    kernel-parameters.txt: add info on how to specify loadable module
    parameters vs.  built-in module parameters

commit 96cc4727e704cad4c2db7f64e13f6697a9864770
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon Apr 26 09:04:25 2004 -0700

    [PATCH] SELinux ptrace race fix
    
    From: Stephen Smalley <sds@epoch.ncsc.mil>
    
    Looking again at the SELinux ptrace check, I believe that there is an
    unrelated race due to the fact that the parent link is only updated after
    releasing the task lock in ptrace_attach (and this is necessary as task lock
    doesn't nest with write lock of tasklist_lock).
    
    The patch below changes SELinux to save the tracing process' SID upon a
    successful selinux_ptrace hook call and then use that SID in the ptrace check
    in apply_creds in order to avoid such races.  This allows us to preserve the
    fine-grained process-to-process ptrace check upon exec (vs.  the global
    CAP_SYS_PTRACE privilege => PT_PTRACE_CAP flag used by the capability module)
    while still avoiding races.

commit c5fe7586efc496d3d97d5277f3f9ff5dd0e89a75
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon Apr 26 09:04:15 2004 -0700

    [PATCH] ppc64: remove duplicated mb() and comment from __cpu_up
    
    From: Nathan Lynch <nathanl@austin.ibm.com>
    
    This seems to have slipped in during a manual merge at some point.

commit e768ae0eaf19e3298106cc88d515708808dccfe1
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon Apr 26 09:04:06 2004 -0700

    [PATCH] SubmittingPatches diffing update.
    
    From: Zwane Mwaikambo <zwane@arm.linux.org.uk>
    
    A kernel janitor recently got confused by the advice in SubmittingPatches
    and was sending patches with the wrong strip level, i think just about
    everyone would prefer standard patches.  Also mention various patch
    management scripts for batching up large deltas.

commit 657824003d9623e793f12a1a9f3554c7e2c6aa8d
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon Apr 26 09:03:56 2004 -0700

    [PATCH] Set module license in mcheck/non-fatal.c
    
    From: Herbert Xu <herbert@gondor.apana.org.au>
    
    This patch sets the module license for mcheck/non-fatal.c.  The module
    doesn't work at all without this as one of the symbols it needs is only
    exported as GPL.

commit f13fcc318ff7dbc3738420d145ca353bd8ebada7
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon Apr 26 09:03:46 2004 -0700

    [PATCH] remove Documentation/DocBook/parportbook.tmpl
    
    From: Christoph Hellwig <hch@lst.de>
    
    The partportbook is licensed under the GFDL and Linus agreed to remove
    all GFDL licensed files in
    http://www.ussg.iu.edu/hypermail/linux/kernel/0306.1/1968.html.
    
    I pinged the author the first time on the 2nd of april but still didn't get
    a reply, then send a patch to Linus to remove it last week but linus
    ignored it.  Here's the patch again:

commit c44d197447c984b4e008e2683a5c6885a9169742
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon Apr 26 09:03:36 2004 -0700

    [PATCH] fix fs/proc/task_nommu.c compile
    
    From: Christoph Hellwig <hch@lst.de>
    
    this file has been broken for ages, but it seems few !CONFIG_MMU users use
    mainline at all.

commit 52bfefbc37ad692a77d0c68e8a9ca7189c67f523
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon Apr 26 09:03:24 2004 -0700

    [PATCH] ppc32: dma_unmap_page() fix
    
    From: <a.othieno@bluewin.ch> (Arthur Othieno)
    
    Duplicate definition of dma_unmap_single() should actually be
    dma_unmap_page().
    
    (acked by Tom Rini)

commit 3376cbf369302d94dfeb9403d13123697a47734d
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon Apr 26 09:03:14 2004 -0700

    [PATCH] nfs_writepage() retval fix
    
    Both ->writepage() and ->writepages() should return 0 or a negative error
    code.  It shouldn't return the number of bytes which were written.
    
    From: Trond Myklebust <trond.myklebust@fys.uio.no>
    
       Redirty the page if all of the modified parts of the page weren't
       written out.

commit cf259c1c917243a9d1ad46492e5092f8191bb789
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon Apr 26 09:03:05 2004 -0700

    [PATCH] blkdev.h: functions no longer inline
    
    From: "Randy.Dunlap" <rddunlap@osdl.org>
    
    These are EXPORTed SYMBOLs; 'inline' was removed from them in ll_rw_blk.c
    on 2002-11-25.

commit 8d67bea68e189c0552e7734f3d78baeff8beef7e
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon Apr 26 09:02:54 2004 -0700

    [PATCH] fs/proc/array.c: workaround for gcc-2.96
    
    From: Alan Stern <stern@rowland.harvard.edu>
    
    This patch is needed to work around gcc-2.96's limited ability to cope with
    long long intermediate expression types.  I don't know why the code
    compiled okay earlier and failed now.

commit 1c9cdbfc27d0a0a6f9a876145a226d50fcb8aa80
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon Apr 26 09:02:44 2004 -0700

    [PATCH] ppc32: fix head_44x.S copyrights
    
    From: Matt Porter <mporter@kernel.crashing.org>
    
    A copyright change to properly show the lineage of this file.

commit 6356aaa9230d2181257bcbfea2fdbd218330e5b7
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon Apr 26 09:02:34 2004 -0700

    [PATCH] doc: tips for S3 resume on radeon cards
    
    From: Pavel Machek <pavel@ucw.cz>
    
    Stefan has pretty useful tips for getting S3 to work on radeon notebooks.
    This brings whole new class of systems to be usable for S3.

commit 4a99dc71f18552e8c6b219ff522c3bb5572075a4
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon Apr 26 09:02:25 2004 -0700

    [PATCH] ISDN Eicon driver: remove call to trap usermode helper
    
    From: Armin Schindler <armin@melware.de>
    
    This patch removes the function to call a usermode helper if the hardware
    and its firmware has a problem.  This feature is already implemented in the
    user utility and the driver does not need to care about it.

commit 6d576c069f9f56d719cb42e5631082ad935696c1
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon Apr 26 09:02:14 2004 -0700

    [PATCH] hugepage fixes
    
    From: William Lee Irwin III <wli@holomorphy.com>
    
    mm/hugetlb.c is putting the destructor in head->lru.prev not head[1].mapping;
    fix below along with nuking huge_page_release(), which simply duplicates
    put_page().

commit 65ea1afff7c4b1453996a7f8713dd132e5118a7c
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon Apr 26 09:02:05 2004 -0700

    [PATCH] simplify put_page()
    
    By requiring that compound pages implement destructors we can drop some code
    from put_page().

commit c8c855b5251716b6a397a3350050711bd6dab217
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon Apr 26 09:01:55 2004 -0700

    [PATCH] smb_writepage retval fix
    
    ->writepage() is supposed to return zero or a negative error code.  Returning
    the number of bytes written will confuse the VFS.

commit 1b2569fb4487dda5216cc8c609bfe8668444b0e9
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon Apr 26 09:01:44 2004 -0700

    [PATCH] slab: use order 0 for vfs caches
    
    We have interesting deadlocks when slab decides to use order-1 allocations for
    ext3_inode_cache.  This is because ext3_alloc_inode() needs to perform a
    GFP_NOFS 1-order allocation.
    
    Sometimes the 1-order allocation needs to free a huge number of pages (tens of
    megabytes) before a 1-order grouping becomes available.  But the GFP_NOFS
    allocator cannot free dcache (and hence icache) due to the deadlock problems
    identified in shrink_dcache_memory().
    
    So change slab so that it will force 0-order allocations for shrinkable VFS
    objects.  We can handle those OK.

commit b3f25c2b2e31146b844042b50cff3bb46a9cf11c
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon Apr 26 09:01:34 2004 -0700

    [PATCH] isofs "default NLS charset not used" fix
    
    From: Marek Szuba <scriptkiddie@wp.pl>
    
    Use the configured default NLS rather than hardwire it.

commit 81567845df111cb89264475fd83b1ca4b94cff61
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon Apr 26 09:01:25 2004 -0700

    [PATCH] fix CONFIG_SYSFS=n compile warning
    
    From: Matt Mackall <mpm@selenic.com>

commit 9aa8863fb8b0ac9f3c68c58c1abe91e5dfc8be90
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon Apr 26 09:01:14 2004 -0700

    [PATCH] dio_bio_reap() return value fix
    
    This function doesn't correctly accumulate -EIO for its caller.

commit 81779415b076751d6f5b577270c3a2b9cb7f7b3b
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon Apr 26 09:01:02 2004 -0700

    [PATCH] task_lock() comment update

commit 1bd4c02c645161959a69be858ee1efc4d0273507
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon Apr 26 09:00:52 2004 -0700

    [PATCH] s390: no timer interrupts in idle.
    
    From: Martin Schwidefsky <schwidefsky@de.ibm.com>
    
    This patch add a system control that allows to switch off the jiffies timer
    interrupts while a cpu sleeps in idle.  This is useful for a system running
    with virtual cpus under z/VM.

commit 30c1ec2b947a5f264dcb574bdc603ec99123712c
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon Apr 26 09:00:41 2004 -0700

    [PATCH] efibootmgr location change
    
    From: Matt Domsch <Matt_Domsch@dell.com>
    
    I moved the home of the efibootmgr utility from domsch.com to
    linux.dell.com.  Note the move in drivers/firmware/Kconfig, also note
    version 0.5.0-test3 or above is necessary.

commit 03d1c495cbeed575926dfd1c3b6dd1c61ad0ff25
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon Apr 26 09:00:32 2004 -0700

    [PATCH] efivars fixes
    
    From: Matt Domsch <Matt_Domsch@dell.com>
    
    Patch below fixes three small bugs in efivars.c as posted by Matt Tolentino
    last week and included in the latest -mm.  Aside from this small patch, I'm
    quite pleased with Matt T's work, thanks!
    
    - dummy() used for reading write-only sysfs files should return -ENODEV to
      indicate failure, not 0.
    
    - efivar_create() should return the number of bytes written on success, not
      zero.
    
    - efivar_delete() should return the number of bytes written on success, not
      zero.

commit 1079344cf85f7cbd24dc184a813f82bd754d1e85
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon Apr 26 09:00:23 2004 -0700

    [PATCH] efivars: remove x86 references
    
    From: Matt Tolentino <metolent@snoqualmie.dp.intel.com>
    
    Third efivars driver update patch that removes x86 references to the /proc
    version of the driver.

commit d621c98a93e407bf1cf9b13f756e30c2ecc4fa11
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon Apr 26 09:00:13 2004 -0700

    [PATCH] efivars: add to drivers/firmware
    
    From: Matt Tolentino <metolent@snoqualmie.dp.intel.com>
    
    Second efivars driver update patch that adds efivars into the drivers/firmware
    directory.

commit 855647c4e7f860cc957c08d0705d5a920aaca414
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon Apr 26 09:00:00 2004 -0700

    [PATCH] efivars: remove from arch/ia64
    
    From: Matt Tolentino <metolent@snoqualmie.dp.intel.com>
    
    I broke up the efivars driver update patch I had sent out quite a while ago
    into several smaller patches.  This includes several fixes and suggestions
    that were pointed out.  The patches are broken down as follows:
    
    1 - remove all traces of efivars from arch/ia64/
    2 - add new sysfs based efivars driver into
        drivers/firmware with accompanying Kconfig/Makefile
        changes to make it fully functional for ia64 again.
    3 - cleans up x86 references to the /proc version of
        the efivars driver.

commit b13496e81fc0ae1a7f7806d5ea5188df435ea977
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon Apr 26 08:59:49 2004 -0700

    [PATCH] m68k bitops
    
    From: Geert Uytterhoeven <geert@linux-m68k.org>
    
    M68k bitops updates (from Roman Zippel):
      - Optimize find_{first,next}_zero_bit()
      - Add missing implementations of find_{first,next}_bit()

commit 009c5ed6d5ee38797a5ed82dfacf1d8c6d0d3dcd
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon Apr 26 08:59:38 2004 -0700

    [PATCH] m68k: Amiga A2065 Ethernet KERN_*
    
    From: Geert Uytterhoeven <geert@linux-m68k.org>
    
    Amiga A2065 Ethernet: Add KERN_* prefixes to printk() messages

commit 5324408b32d94f2d0ba612a9c5a5c8d444ac5804
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon Apr 26 08:59:23 2004 -0700

    [PATCH] prune_dcache comment fix
    
    From: Maneesh Soni <maneesh@in.ibm.com>
    
    Clarify some things which were confusing poeple...

commit afcd93a406ce973ad480947610596f582620deb3
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon Apr 26 08:59:12 2004 -0700

    [PATCH] slab alignment fixes
    
    From: Manfred Spraul <manfred@colorfullife.com>
    
    Below is a patch that redefines the kmem_cache_alloc `align' argument:
    
    - align not zero: use the specified alignment.  I think values smaller than
      sizeof(void*) will work, even on archs with strict alignment requirement (or
      at least: slab shouldn't crash.  Obviously the user must handle the
      alignment properly).
    
    - align zero:
    * debug on: align to sizeof(void*)
    * debug off, SLAB_HWCACHE_ALIGN clear: align to sizeof(void*)
    * debug off, SLAB_HWCACHE_ALIGN set: align to the smaller of
       - cache_line_size()
       - the object size, rounded up to the next power of two.
      Slab never honored cache align for tiny objects: otherwise the 32-byte
      kmalloc objects would use 128 byte objects.
    
    There is one additional point: right now slab uses ints for the bufctls.
    Using short would save two bytes for each object.  Initially I had used short,
    but davem objected.  IIRC because some archs do not handle short efficiently.
    Should I allow arch overrides for the bufctls?  On i386, saving two bytes
    might allow a few additional anon_vma objects in each page.

commit 01305153702021e4a15e9fcc26d46aa847df58fc
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon Apr 26 08:59:01 2004 -0700

    [PATCH] hugetlbpage: remove include linux/module.h
    
    From: Paul Jackson <pj@sgi.com>
    
    The #include of linux/module.h in several arch/*/mm/hugetlbpage.c files for
    EXPORT_SYMBOL(hugetlb_total_pages) is now unneeded.

commit 59e8d5c9d9db0f96819ff22c30c33584275ef02f
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon Apr 26 08:58:50 2004 -0700

    [PATCH] ppc64: prom.c fix for CONFIG_BLK_DEV_INITRD=n
    
    From: Rusty Russell <rusty@rustcorp.com.au>
    
    Doesn't compile with CONFIG_BLK_DEV_INITRD=n.  Be more careful with the
    conditionals.
    
    Spotted by Dave Boutcher...

commit e51a23c6ec3e3dbefbcb3658150658f107d4248d
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon Apr 26 08:58:38 2004 -0700

    [PATCH] ppc64: Move Initrd
    
    From: Rusty Russell <rusty@rustcorp.com.au>
    
    This patch moves the initrd when "make_room" runs out of space, rather than
    stepping over it.  The problem with stepping over it is that it gets copied
    with the kernel when this happens, which wastes space.
    
    Also ensures that the initrd isn't where the kernel wants to be moved to: if
    it is, it gets moved out the way.

commit 54c832af87a3b96c0af92bb11e8ddc4f72c29508
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon Apr 26 08:58:27 2004 -0700

    [PATCH] ppc64: Initrd Cleanup
    
    From: Rusty Russell <rusty@rustcorp.com.au>
    
    Clean up initrd handling.
    
    1) Expose initrd_start and initrd_end to prom.c (replacing its local
       initrd_start and initrd_len).
    
    2) Don't hand mem (aka klimit) through functions which don't need it.
    
    3) Add more debugging under DEBUG_PROM in case we broke anything.

commit 792932549f422b1cfd6ae5397f0ab8ae4ee8ae10
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon Apr 26 08:58:17 2004 -0700

    [PATCH] ppc64: Clean up prom functions in prom.c
    
    From: Rusty Russell <rusty@rustcorp.com.au>
    
    1) Define PROM_ERROR: checks for call_prom() < 0 are bogus (returns ulong)
    2) All OF access functions should be marked __init.
    3) prom_strtoul isn't used at all.

commit 8b66a490ca00957a54c47f7a060cd6772ee15c20
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon Apr 26 08:58:06 2004 -0700

    [PATCH] ppc64: Fix prom.c to boot on G5 after make_room fix
    
    From: Rusty Russell <rusty@rustcorp.com.au>
    
    Ben Herrenschmidt made this actually boot.

commit efa8a179174d8ea89367c9bf08bbe45f10cf1a1c
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon Apr 26 08:57:56 2004 -0700

    [PATCH] ppc64: make_room macro for ppc64 prom.c
    
    From: Rusty Russell <rusty@rustcorp.com.au>
    
    copy_device_tree calls inspect_node() which recurses to copy the Open Firmware
    device tree.  It just copied into memory above the kernel for about 8MB, which
    can overwrite the initrd, and/or get truncated on big machines.
    
    The real solution is to allocate memory properly for all the prom_init memory
    users.  However, that's quite a change.  This patch introduces a "make_room"
    macro which inspect_node uses to get memory.  This does the same as before,
    except skips over the initrd if neccessary.

commit d6d33678f8fdb469a743bab4497c7c9c74f413b4
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon Apr 26 08:57:46 2004 -0700

    [PATCH] ppc64: Make finish_device_tree use lmb_alloc, not klimit
    
    From: Rusty Russell <rusty@rustcorp.com.au>
    
    finish_device_tree simply allocates nodes by incrementing klimit (ie.  using
    memory on top of the kernel).  Change it to figure out how much memory it
    needs, then use lmb_alloc to allocate that, then fill it in.
    
    This gets rid of the only manipulation of klimit after prom_init.

commit 196431fd9c365c5781ac30cdef9b1cb2d7a59408
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon Apr 26 08:57:35 2004 -0700

    [PATCH] ppc64: Rearrage Rest of prom.c in C Order
    
    From: Rusty Russell <rusty@rustcorp.com.au>
    
    Rather than pre-declaring static functions, order them so it's not neccessary.
    This makes the code easier to navigate and patch.

commit 9f06f65e314ea0683df6cbe9d414e8e09526a8ba
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon Apr 26 08:57:24 2004 -0700

    [PATCH] ppc64: Rearrage interpret_funcs in C Order
    
    From: Rusty Russell <rusty@rustcorp.com.au>
    
    Rather than pre-declaring static functions, order them so it's not neccessary.
    This makes the code easier to navigate and patch.

commit cde5f62f0e6897dfb6e380072596d31d69458e34
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon Apr 26 08:57:14 2004 -0700

    [PATCH] ppc64: Rearrage copy_device_tree() and its functions in C Order
    
    From: Rusty Russell <rusty@rustcorp.com.au>
    
    Rather than pre-declaring static functions, order them so it's not neccessary.
    This makes the code easier to navigate and patch.

commit 5fa5de94a47388d9c06180cdb1ebbcb2648b097c
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon Apr 26 08:57:04 2004 -0700

    [PATCH] ppc64: Rearrage finish_device_tree() and its functions in C Order
    
    From: Rusty Russell <rusty@rustcorp.com.au>
    
    Rather than pre-declaring static functions, order them so it's not neccessary.
    This makes the code easier to navigate and patch.

commit c8fbc7b9ce59e44abb5715e535164af5d17b63bd
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon Apr 26 08:56:53 2004 -0700

    [PATCH] ppc64: Split prom.c Into pre-reloc and post-reloc Functions
    
    From: Rusty Russell <rusty@rustcorp.com.au>
    
    Move all the functions that run normally (ie.  with the kernel in the correct
    address) to the bottom of prom.c, and keep all the functions which use RELOC()
    to the top, above "prom_init()" which calls them.
    
    Also, make prom_initialize_dart_table and prom_initialize_tce_table static.

commit fe6ec59f6229fdd0d1476e05d54f4802cccb669f
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon Apr 26 08:56:42 2004 -0700

    [PATCH] Minor fixes for ext3 journalled quotas
    
    From: Jan Kara <jack@ucw.cz>
    
    It fixes a memory leak when turning journalled quotas off.

commit 87d218f98b50087dcfb3c895bd2136153ca95ae5
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon Apr 26 08:56:32 2004 -0700

    [PATCH] dquot: remove unneeded test
    
    We're testing the nullness of `sb' potentially after rereferencing it
    (although the compiler will have reordered things to avoid such a bug).
    
    Just remove the test - the superblock pointer shouldn't be null in there.

commit 984e695365b2b60997a41f496854e597ecbf196f
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon Apr 26 08:56:22 2004 -0700

    [PATCH] Per-sb dquot dirty lists
    
    From: Jan Kara <jack@ucw.cz>
    
    When there are lots of dirty dquots the vfs_quota_sync() is too slow (it has
    O(N^2) behaviour).  Attached patch implements list of dirty dquots for each
    superblock and quota type.  Using this lists sync is trivially linear.
    Attached patch is against 2.6.5 with journalled quota and previous patch for
    hash table size.
    
    (Jan had a test which went from 8 minutes to 0.8 seconds...)

commit 2187a5e40da5350c3c7c95ae1b5091bc4a5b68ad
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon Apr 26 08:56:11 2004 -0700

    [PATCH] Bigger quota hashtable
    
    From: Jan Kara <jack@ucw.cz>
    
    I found out that quota uses hash table with just 43 entries to hash dquot
    entries.  I guess that we can afford using one page for that
    (quotactl(Q_GETQUOTA...), got faster like 3x for 4000 users).  Attached patch
    implements that.

commit fa24b7f29fd262cfbba7a255da5aaf478d4edf0a
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon Apr 26 08:56:01 2004 -0700

    [PATCH] ext3 journalled quota locking fix
    
    From: Jan Kara <jack@ucw.cz>
    
    I've attached a fix for a problem in ext3 journalled quota patch - the problem
    is that detecting whether dqput() sleeps was wrong and so we could possibly
    schedule when holding a spinlock.

commit 10c189cdc6b127955068fcfb812d021b5ed32be6
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon Apr 26 08:55:51 2004 -0700

    [PATCH] credentials locking fix
    
    From: Chris Wright <chrisw@osdl.org>
    
    Contributions from:
    Stephen Smalley <sds@epoch.ncsc.mil>
    Andy Lutomirski <luto@stanford.edu>
    
    During exec the LSM bprm_apply_creds() hooks may tranisition the program to a
    new security context (like setuid binaries).  The security context of the new
    task is dependent on state such as if the task is being ptraced.
    
    ptrace_detach() doesn't take the task_lock() when clearing task->ptrace.  So
    there is a race possible where a process starts off being ptraced, the
    malicious ptracer detaches and if any checks agains task->ptrace are done more
    than once, the results are indeterminate.
    
    This patch ensures task_lock() is held while bprm_apply_creds() hooks are
    called, keeping it safe against ptrace_attach() races.  Additionally, tests
    against task->ptrace (and ->fs->count, ->files->count and ->sighand->count all
    of which signify potential unsafe resource sharing during a security context
    transition) are done only once the results are passed down to hooks, making it
    safe against ptrace_detach() races.
    
    Additionally:
    
    - s/must_must_not_trace_exec/unsafe_exec/
    - move unsafe_exec() call above security_bprm_apply_creds() call rather than
      in call for readability.
    - fix dummy hook to honor the case where root is ptracing
    - couple minor formatting/spelling fixes

commit f6cfe4f8ce4b5bc13a0ade4daf267fdf5b0e61c9
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon Apr 26 08:55:41 2004 -0700

    [PATCH] reiserfs: ignore prepared and locked buffers
    
    From: Chris Mason <mason@suse.com>
    
    block_write_full_page might see and lock clean metadata buffers, which leads
    to bogus vs-12339 messages.  Change the message to ignore bh locked.

commit 35f4fc9f6bb92dc2d425c472971927ced12547d4
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon Apr 26 08:55:31 2004 -0700

    [PATCH] Use workqueue for call_usermodehelper
    
    From: Rusty Russell <rusty@rustcorp.com.au>
    
    call_usermodehelper uses keventd to create a thread, guaranteeing a nice,
    clean kernel thread.  Unfortunately, there is a case where
    call_usermodehelper is called with &bus->subsys.rwsem held (via
    bus_add_driver()), but keventd could be running bus_add_device(), which is
    blocked on the same lock.  The result is deadlock, and it comes from using
    keventd for both.
    
    In this case, it can be fixed by using a completely independent thread for
    call_usermodehelper, or an independent workqueue.  Workqueues have the
    infrastructure we need, so we use one.
    
    Move EXPORT_SYMBOL while we're there, too.
    
    akpm fixes: Make it compile with !CONFIG_KMOD

commit bf9e688d76438678a6d5a902a2a57f7d866e2b51
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon Apr 26 08:55:21 2004 -0700

    [PATCH] create singlethread_workqueue()
    
    From: Rusty Russell <rusty@rustcorp.com.au>
    
    Workqueues are a great primitive for running things from user context from
    a completely clean environment.  Unfortunately, they currently insist on
    creating one thread per CPU, which is overkill for many situations, so the
    more generic keventd workqueue is used for these.  Recently deadlocks using
    keventd were demonstrated, showing that it is not suitable for all uses.
    
    1) Clean up CPU iterators.  Always a nice touch.
    
    2) Add __create_workqueue() and create_singlethread_workqueue(),
       keeping source compatibility.
    
    3) Put workqueues in workqueue list even if !CONFIG_HOTPLUG_CPU (means
       we need a lock to protect that list).  Now we can tell if a wq is
       single-threaded using list_empty(&wq->list).
    
    4) For single-threaded workqueues, override CPU in queue_work,
       delayed_work_timer_fn and flush_workqueue to be 0.  flush_workqueue
       now does redundant passes for single-threaded workqueues, but the
       code remains simple.
    
    5) Make create_workqueue_thread return the thread, so we can easily
       kthread_bind for multi-threaded workqueues.
    
    
    akpm fixes:
    
    - Fix up is_single_threaded() handling
    
    - single-threaded wq thread does not have "/0" appended.

commit bc97fc23c3dc2c8cc02abd28b3811fbd2193e35b
Author: David Mosberger <davidm@tiger.hpl.hp.com>
Date:   Mon Apr 26 08:31:49 2004 -0700

    [PATCH] ia64: BUG if smp_call_function is called with interrupts disabled
    
    smp_call_function() may not be called with interrupts disabled.
    Violating this precondition leads to bugs that are hard to reproduce
    and even harder to diagnose.  Thus, catch violations with BUG_ON().

commit 36774bcb0d167846dabd82058bf077204dae1faf
Merge: 8528376... 6959a63...
Author: David S. Miller <davem@kernel.bkbits.net>
Date:   Mon Apr 26 08:28:18 2004 -0700

    Merge davem@nuts.davemloft.net:/disk1/BK/net-2.6
    into kernel.bkbits.net:/home/davem/net-2.6

commit 632b9c99952dd29fb80aff43db050e5cbced8430
Merge: 8528376... 2758a19...
Author: David S. Miller <davem@kernel.bkbits.net>
Date:   Mon Apr 26 08:23:34 2004 -0700

    Merge davem@nuts.davemloft.net:/disk1/BK/tg3-2.6
    into kernel.bkbits.net:/home/davem/tg3-2.6

commit 2758a19ef0d65124741d17f0fa027f58ce1e9c83
Author: David S. Miller <davem@nuts.davemloft.net>
Date:   Mon Apr 26 08:17:10 2004 -0700

    [TG3]: Update driver version and reldate.

commit 31ab1506c7859ca28184cc0bbab9db30a1f33e1b
Author: Jeff Garzik <jgarzik@redhat.com>
Date:   Mon Apr 26 08:00:16 2004 -0700

    [TG3]: Dump NIC-specific statistics via ethtool.
    
    Contributed by Tony Cureington @ HP, updated (from pre-ethtool_ops)
    and modified by me.

commit 986afeb32d626968f2239054d67f97788e17a437
Author: Grant Grundler <grundler@parisc-linux.org>
Date:   Mon Apr 26 07:23:39 2004 -0700

    [TG3]: Fix comment typo.

commit eb7a4190733d5445a2b2f6b7245bd17c8588989d
Merge: 3dcad07... c71413f...
Author: David S. Miller <davem@nuts.davemloft.net>
Date:   Mon Apr 26 07:07:09 2004 -0700

    Merge nuts.davemloft.net:/disk1/BK/tg3work-2.6
    into nuts.davemloft.net:/disk1/BK/tg3-2.6

commit c71413f854fb4fbb78f680b27cce64318a72f490
Author: Michael Chan <mchan@broadcom.com>
Date:   Mon Apr 26 07:02:26 2004 -0700

    [TG3]: Fix jimbo frame PHY programming.
    
    1. Added new workaround for 5705 to improve bit error rate.
    
    2. Changed to use read-modify-write to set the extended packet bit in
    tg3_phy_reset.
    
    3. Removed some phy setup code in tg3_phy_probe. All of that is already
    in the end of tg3_phy_reset. Writing to the phy during probe time may
    contend with ASF because ASF is constantly reading phy registers to
    determine the link.
    
    
    4. Removed the write to phy register 0x18 in tg3_phy_copper_begin. Not
    sure what it was for and it will overwrite that regsiter.

commit c0bebb330ce5428623f3f3cdf4d8ab8b60cae5d1
Merge: 8528376... b7df0fd...
Author: Steve French <cifs.adm@hostme.bitkeeper.com>
Date:   Mon Apr 26 05:43:57 2004 -0700

    Merge bk://linux.bkbits.net/linux-2.5
    into hostme.bitkeeper.com:/repos/c/cifs/linux-2.5cifs

commit b7df0fd6dabf8e0073f74db2eb363130275fa499
Author: Steve French <stevef@steveft21.ltcsamba>
Date:   Mon Apr 26 14:56:04 2004 -0500

    rfc1001 session init name parsing fix

commit c745d58efa3308b1ac6b6b934a5d656aece309c3
Author: Steve French <stevef@stevef95.austin.ibm.com>
Date:   Mon Apr 26 07:32:50 2004 -0500

    update rfc1001 handling

commit 18d0f1510dde10149ba59cc3b97083c99fb3e3b5
Author: David Brownell <david-b@pacbell.net>
Date:   Mon Apr 26 04:51:43 2004 -0700

    [PATCH] One more USB fix
    
    Here's another fix it'd be good to merge ...
    
    No changes to the Linux code at all, but it'll makes the Windows
    configuration of a Linux device running the Ethernet/RNDIS gadget behave
    correctly on more versions of Windows.  (It might prevent some
    Bluescreening too.)

commit 0de89e246e42e755e4aee96f99d89dc4a64a9b5b
Merge: 63d5381... b1c51d2...
Author: Anton Altaparmakov <aia21@cantab.net>
Date:   Mon Apr 26 12:51:23 2004 +0100

    Merge cantab.net:/home/src/bklinux-2.6
    into cantab.net:/home/src/ntfs-2.6

commit 830cb0bc45fc6df9d32788928c44f7d1f14dc0c9
Merge: 8528376... 67cd8c8...
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Mon Apr 26 04:22:44 2004 -0700

    Merge http://lia64.bkbits.net/to-linus-2.5
    into ppc970.osdl.org:/home/torvalds/v2.6/linux

commit 4370970f267c5b9b54178debcd58e5d1e53e6610
Author: Keith Owens <kaos@sgi.com>
Date:   Mon Apr 26 03:10:47 2004 -0700

    [PATCH] ia64: SN_SAL_PRINT_ERROR is reentrant

commit 6959a630cabeba2c897eead031d37ea3c60881b8
Author: Petri T. Koistinen <petri.koistinen@iki.fi>
Date:   Mon Apr 26 02:37:38 2004 -0700

    [SUNRPC]: Missing NULL kmalloc check in unix_domain_find().

commit b3b62b7fabb27de5467dced5387a99e30e4fe352
Author: Stephen Hemminger <shemminger@osdl.org>
Date:   Mon Apr 26 02:33:37 2004 -0700

    [IRDA]: Export irda_task_delete.

commit 21e0d9c8ec8782796be0d2bc592a0bd80d9efcb9
Author: Stephen Hemminger <shemminger@osdl.org>
Date:   Mon Apr 26 02:32:48 2004 -0700

    [IPV4]: Spelling fixed for ip-sysctl.txt

commit d6bb1a59ebc0aa47dad29155152ac1eba10d2fca
Author: Stephen Hemminger <shemminger@osdl.org>
Date:   Mon Apr 26 02:31:03 2004 -0700

    [TCP]: Add vegas sysctl docs.

commit 7cadd63df10c6267bc36ed6f6451a072727578f4
Author: Steve French <stevef@stevef95.austin.ibm.com>
Date:   Mon Apr 26 04:12:28 2004 -0500

    fix memory allocation of rfc1002 sess init struct

commit 67cd8c87d04d43c9db0a11e86be221b312976796
Author: Greg Edwards <edwardsg@sgi.com>
Date:   Mon Apr 26 00:39:13 2004 -0700

    [PATCH] ia64: Remove SN PDA page overflow check
    
    There's an obsolete check in sn_init_pdas() left over from the 2.4
    days that panics if the cpu PDA and cpu_data area span more than a page.
    With 2.6, we're not limited to a page, so remove the check entirely.

commit d88ad34ee4d238705394a2b94cdfea4c572ec9ef
Author: Alex Williamson <alex.williamson@hp.com>
Date:   Mon Apr 26 00:13:52 2004 -0700

    [PATCH] ia64: bug w/ shared interrupts
    
    I just ran into a bug introduced by the most recent iosapic.c patch.
    The scenario is a builtin driver is up and running happily.  A module
    loads for a devices that happens to share the same interrupt vector,
    in this case a network driver.  The module calls pci_enable_device()
    as it should, which eventually lands in iosapic_enable_intr().  We
    then proceed to mask the interrupt and kill the device that's already
    running.  As a bonus, request_interrupt() doesn't fix the problem
    because we only call the startup for the interrupt handler on the
    first action attached to the interrupt.
    
    I think the best way out of this is simply to detect when an action is
    already attached to a vector and leave it alone.  This also prevents
    interrupts from moving to other cpus (on boxes w/o irq redirection)
    for no good reason.

commit 852837640d278c7b9f7090dacaf93ff0390a963d
Merge: 2436e28... 09b9f93...
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Mon Apr 26 00:12:00 2004 -0700

    Merge bk://kernel.bkbits.net/gregkh/linux/fix-2.6
    into ppc970.osdl.org:/home/torvalds/v2.6/linux

commit ac51bef86a31bd5a3e67cf3dfa0d351a483e039d
Merge: f5762f2... b4a5b80...
Author: Steve French <stevef@stevef95.austin.ibm.com>
Date:   Mon Apr 26 01:38:19 2004 -0500

    Merge bk://cifs.bkbits.net/linux-2.5cifs
    into stevef95.austin.ibm.com:/usr/src/bk/linux-2.5cifs

commit b4a5b80b5cce5df5bf6fe6a02d45f26f92c3ea90
Author: Steve French <stevef@stevef95.austin.ibm.com>
Date:   Mon Apr 26 01:34:15 2004 -0500

    Flush writebehind before invalidate in file open path

commit 09b9f933f5ba8c64ec41c7ca33ebb4aa32a47278
Author: Jens Axboe <axboe@suse.de>
Date:   Sun Apr 25 22:17:44 2004 -0700

    [PATCH] correct LoEj logic
    
    The logic got a little foo-bar'ed in the last patch, we should have keep
    the old logic.  Ie LoEj bit (2nd) must always be set, just clear it for
    known non-capable of loading drives.

commit 2436e28230e60365c85f3996e44c653933f442e4
Author: Greg Kroah-Hartman <greg@kroah.com>
Date:   Sun Apr 25 22:09:47 2004 -0700

    [PATCH] USB: further cleanup of the hiddev driver, fixing another possible oops on disconnect.

commit d07cc72d5b12fe5520131ff078616cd24c8f9083
Author: Greg Kroah-Hartman <greg@kroah.com>
Date:   Sun Apr 25 22:03:46 2004 -0700

    [PATCH] USB: fix up fake usb_interface structure in hiddev
    
    This fixes a oops in the current kernel tree.

commit 3dcad070088554e0452117c783029bbfaf5a21d5
Author: Jens Axboe <axboe@suse.de>
Date:   Sun Apr 25 19:10:32 2004 -0700

    [PATCH] don't log drive loading failures
    
    This is an old bug that often confuses people, rightfully.
    
    For some laptop and server type cdroms, the drives advertise themselves
    as tray loading even if they are caddy-like or slot-in loaders.  This
    means they cannot insert the media on their own, and this generates a
    5/24/00 error to START_STOP_UNIT.
    
    This prevents the logging of such a failure, and also fixes the
    generation of such a bad command in case the mech type was correctly set
    by the drive.

commit 303729f39994de7787addfd51016d72915fc1360
Author: Armin Schindler <armin@melware.de>
Date:   Sun Apr 25 19:10:23 2004 -0700

    [PATCH] ISDN CAPI: add ncci list semaphore
    
    Fix race conditions of ISDN CAPI's internal ncci list handling by using
    a per capidev semaphore.

commit 5ac16be863f3a830d716989fd33bd27fcd8aa43d
Merge: 2ce6c0f... c2d26a9...
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Sun Apr 25 19:02:02 2004 -0700

    Merge bk://kernel.bkbits.net/davem/net-2.6
    into ppc970.osdl.org:/home/torvalds/v2.6/linux

commit 2ce6c0f56af9a2db006129f2fd83d727543ade2a
Merge: af9037d... 804ca07...
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Sun Apr 25 19:01:15 2004 -0700

    Merge bk://kernel.bkbits.net/davem/sparc-2.6
    into ppc970.osdl.org:/home/torvalds/v2.6/linux

commit 804ca075d25251a5e8a4f416199f2da0f218e62d
Merge: 63d5381... 2a4e095...
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Sun Apr 25 19:00:10 2004 -0700

    Merge DVB updates

commit 2a4e095a7562286c4cd6cc0dd2aad390f2941cbc
Author: Michael Hunold <hunold@linuxtv.org>
Date:   Sun Apr 25 18:53:51 2004 -0700

    [PATCH] DVB: Follow saa7146 changes in affected V4L drivers
    
     - [V4L] follow changes in saa7146 driver: mxb, dpc7146, hexium_orion,
       hexium_gemini

commit b8bd49a4670831f71c5eb609be3bc519121c92f6
Author: Michael Hunold <hunold@linuxtv.org>
Date:   Sun Apr 25 18:53:40 2004 -0700

    [PATCH] DVB: Misc. DVB USB driver updates
    
     - [DVB] ttusb-dec:
       - Add a parameter to dvb_filter_pes2ts function to specify whether
         the packet is a payload unit start or not
       - Use the hotplug firmware loader for 2.6 kernels instead of
         compiling the firmware into the module.
       - Correct the USB id of the DEC3000-s, add basic support
    
     - [DVB] ttusb-budget:
        - Remove spurious discontinuity message when starting streaming

commit 76aec2dc25f20ce1c819f58e3cf22475437bf6d0
Author: Michael Hunold <hunold@linuxtv.org>
Date:   Sun Apr 25 18:53:29 2004 -0700

    [PATCH] DVB: Misc. DVB frontend driver updates
    
     - [DVB] follow changes in dvb-core for frontend drivers (ves1x93,
       ves1820, nxt6000, sp887x, tda1004x, stv0299, mt312, alps_tdlb7,
       alps_tdmb7, at76c651, cx24110, dst, dvb_dummy_fe, grundig_29504-401,
       grundig_29504-491)
     - [DVB] tda1004x: updated timeout to 800ms, implemented FE_SLEEP
     - [DVB] cx24110: add FE_CAN_RECOVER to reduce kdvb-fe CPU load
     - [DVB] grundig_29504-401: added 200ms delay after first FE_INIT,
       Implemented FE_GET_FRONTEND
     - [DVB] alps_tdlb7, alps_tdmb7: upped tuning delays to fix tuning

commit a652d124b0a0bdb63afa5c0a001fc6b80d4c77a2
Author: Michael Hunold <hunold@linuxtv.org>
Date:   Sun Apr 25 18:53:18 2004 -0700

    [PATCH] DVB: AV7110 DVB driver updates
    
     - [DVB] av7110 update:
       - speed up firmware loading
       - follow internal API changes in saa7146 driver
       - introduced some symbolic constants for a/v dec cmds
       - change default for hw_sections to 0 to enable crc checks

commit eb5908c7e4c11402f9d663f0e9b4a54263b7076d
Author: Michael Hunold <hunold@linuxtv.org>
Date:   Sun Apr 25 18:53:08 2004 -0700

    [PATCH] DVB: Other DVB core updates
    
     - [DVB] remove superflous memset() which caused section data to be
       overwritten when a) there are two sections in one TS packet, and b)
       the first section was smaller than 18 bytes; thanks to Jean-Claude
       Repetto for tracking this down
     - [DVB] starting a ts filter on a running section filter's pid did
       break the section filter; fixed.
     - [DVB] integrate ULE Decapsulation code, thanks to gcs - Global
       Communication & Services GmbH.  and Institute for Computer Sciences
       Salzburg University.  Hilmar Linder <hlinder@cosy.sbg.ac.at> and
       Wolfram Stering <wstering@cosy.sbg.ac.at>
     - [DVB] fix the module use count bugs, thanks to Hernan A.Perez Masci
       for his initial work on this problem
     - [DVB] if dvb_frontend_internal_ioctl() returns an error code, be sure
       to deliver it to the calling application, don't ignore it (fixes the
       bug that the frontend0 doesn't respond properly to unknown ioctls...)
     - [DVB] major frontend code clean up, rewritten core tuning loop.
       Thanks to Andrew de Quincey.
     - [DVB] follow changes in dvb-core in skystar2, dvb-bt8xx

commit 7679ba7b629fcb896b1bdbfd11472aef6e7012de
Author: Michael Hunold <hunold@linuxtv.org>
Date:   Sun Apr 25 18:52:57 2004 -0700

    [PATCH] DVB: Add EN50221 cam support to dvb-core
    
     - [DVB] add generic functions for EN50221 CAM interfaces

commit 2b7f4a04aecd29d510258b9d1e7c9d9d008dad21
Author: Michael Hunold <hunold@linuxtv.org>
Date:   Sun Apr 25 18:52:47 2004 -0700

    [PATCH] DVB: Update DVB budget drivers
    
     - [DVB] budget-av: patch by Kenneth Aafl√∏y to add support for Typhoon
       DVB-S budget card
     - [DVB] budget.c: support for Fujitsu-Siemens Activy Card
     - [DVB] budget-ci: add preliminary CI support

commit 2343a8c0b4f9a572c4753801bdc1da4badc131ff
Author: Michael Hunold <hunold@linuxtv.org>
Date:   Sun Apr 25 18:52:35 2004 -0700

    [PATCH] DVB: Documentation and Kconfig updazes
    
     - [DVB] misc. documentation updates, KConfig help file updates
     - [DVB] make Twinhan driver depend on bt8xx

commit 9dab501baa8cab962e014213529c3dce960e2ef4
Author: Michael Hunold <hunold@linuxtv.org>
Date:   Sun Apr 25 18:52:23 2004 -0700

    [PATCH] V4L: Update the saa7146 driver
    
     - [DVB] saa7146 driver updates:
       - remove bogus v_calc and h_calc parameters, which can be easily
         retrieved from other values
       - add class parameter to i2c initialization
       - let resource handling provide more useful informations
       - sanitize overlay/capture locking

commit f5762f2484db99b79ed8bca3dd70741a8fae8fd3
Merge: 63d5381... e3b4af4...
Author: Steve French <cifs.adm@hostme.bitkeeper.com>
Date:   Sun Apr 25 18:08:38 2004 -0700

    Merge bk://linux.bkbits.net/linux-2.5
    into hostme.bitkeeper.com:/repos/c/cifs/linux-2.5cifs

commit b1c51d26483b6713c8211bdc927f3dec64fc0412
Author: Anton Altaparmakov <aia21@cantab.net>
Date:   Mon Apr 26 00:04:57 2004 +0100

    NTFS: Determine the mft mirror size as the number of mirrored mft records
          and store it in ntfs_volume->mftmirr_size (fs/ntfs/super.c).

commit 63d5381ed20e9e6a5723cfaf5a2ddce018c0a39e
Merge: fc3b617... 2210dfe...
Author: Jeff Garzik <jgarzik@redhat.com>
Date:   Sun Apr 25 14:27:09 2004 -0400

    Merge redhat.com:/spare/repo/netdev-2.6/misc
    into redhat.com:/spare/repo/net-drivers-2.6

commit fc3b6177b5008c5708079a3afbfdac177dea88c8
Merge: 2d095b6... 8cee269...
Author: Jeff Garzik <jgarzik@redhat.com>
Date:   Sun Apr 25 14:26:11 2004 -0400

    Merge redhat.com:/spare/repo/netdev-2.6/mips
    into redhat.com:/spare/repo/net-drivers-2.6

commit 2d095b6c5cb2bd9e13f66f1c7f7956791140a3b5
Merge: 7789650... 5e18a11...
Author: Jeff Garzik <jgarzik@redhat.com>
Date:   Sun Apr 25 14:25:13 2004 -0400

    Merge redhat.com:/spare/repo/netdev-2.6/e100
    into redhat.com:/spare/repo/net-drivers-2.6

commit 2210dfec14407ea8604873fe071e084899efafef
Author: Krzysztof Halasa <khc@pm.waw.pl>
Date:   Sun Apr 25 13:43:37 2004 -0400

    [netdrvr tulip] fix use-after-free
    
    The attached patch fixes an "oops" in tulip driver when a live interface
    is deactivated (i.e. PC Card ejected or module unloaded) without being
    brought down first.

commit e3b4af471a79a5dda605de32b0eeb92b54468b04
Author: Steve French <stevef@smfhome.smfsambadom>
Date:   Sun Apr 25 12:43:20 2004 -0500

    Remove unneeded debug statement

commit c1500d962668352b814a83afe40b8ec3a2eb8828
Author: Steve French <stevef@smfhome.smfsambadom>
Date:   Sun Apr 25 12:41:35 2004 -0500

    Fix port 139 connections to Windows 2K adding missing RFC1002 session_init

commit 2722e5dda48734e1e3066df241ccd112a4f6b89c
Author: Anton Altaparmakov <aia21@cantab.net>
Date:   Sun Apr 25 17:22:09 2004 +0100

    NTFS: Move typedefs for ntfs_attr and test_t from fs/ntfs/inode.c to
          fs/ntfs/inode.h so they can be used elsewhere.

commit b56079110def496c8c060cd80db736f11854287e
Author: Anton Altaparmakov <aia21@cantab.net>
Date:   Sun Apr 25 17:11:52 2004 +0100

    NTFS: Add NInoTestSetFoo() and NInoTestClearFoo() macro magic to
          fs/ntfs/inode.h and use it to declare NInoTest{Set,Clear}Dirty.

commit c7ebe657d02bfa644f1c66f153ba197f663e98ff
Author: Anton Altaparmakov <aia21@cantab.net>
Date:   Sun Apr 25 17:03:50 2004 +0100

    NTFS: Wrap flush_dcache_mft_record_page() in #ifdef NTFS_RW.

commit 4aaad6107ebd1096a0c9fe8c437252c6df98a745
Author: Anton Altaparmakov <aia21@cantab.net>
Date:   Sun Apr 25 16:42:00 2004 +0100

    NTFS: - Remove unused ntfs_dirty_inode().
          - Cleanup super operations declaration.

commit c2d26a96a9571b92d996c10ab9336d01a0801df1
Merge: 63d5381... fa58cfc...
Author: David S. Miller <davem@kernel.bkbits.net>
Date:   Sun Apr 25 08:25:18 2004 -0700

    Merge davem@nuts.davemloft.net:/disk1/BK/net-2.6
    into kernel.bkbits.net:/home/davem/net-2.6

commit fa58cfcf4bb82b9d29c9ea5d0c8c581f4f6b0719
Author: Chas Williams <chas@cmf.nrl.navy.mil>
Date:   Sun Apr 25 07:35:58 2004 -0700

    [ATM]: [fore200e] make use tasklet configurable

commit 9ed124a318f54902a208dc8660c55ed4b2ea36f8
Author: Chas Williams <chas@cmf.nrl.navy.mil>
Date:   Sun Apr 25 07:35:28 2004 -0700

    [ATM]: [fore200e] 0.3e version by Christophe Lizzi (lizzi@cnam.fr)

commit af9037dd1d87e057f5d4a638231b12ebf90e107c
Merge: 63d5381... 99aa13d...
Author: David S. Miller <davem@nuts.davemloft.net>
Date:   Sun Apr 25 07:09:58 2004 -0700

    Merge nuts.davemloft.net:/disk1/BK/sparcwork-2.6
    into nuts.davemloft.net:/disk1/BK/sparc-2.6

commit 7789650ffb188cac3b8a40fff515c020d3b4dde4
Merge: 79c914d... 54f9663...
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Sun Apr 25 04:59:50 2004 -0700

    Merge bk://kernel.bkbits.net/davem/sparc-2.6
    into ppc970.osdl.org:/home/torvalds/v2.6/linux

commit 79c914d99eff62b80074b5952dfc194c0a677220
Merge: d9fd3c1... 7eebd09...
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Sun Apr 25 04:58:58 2004 -0700

    Merge http://linux-ntfs.bkbits.net/ntfs-2.6
    into ppc970.osdl.org:/home/torvalds/v2.6/linux

commit d9fd3c1cc9308648c70b811d00e333e61c1792a1
Merge: 44ce64b... b596fd1...
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Sun Apr 25 04:57:57 2004 -0700

    Merge bk://cifs.bkbits.net/linux-2.5cifs
    into ppc970.osdl.org:/home/torvalds/v2.6/linux

commit b596fd12aba588e0d993dc89a8b2971b22621995
Author: Bartlomiej Zolnierkiewicz <b.zolnierkiewicz@elka.pw.edu.pl>
Date:   Sun Apr 25 04:50:17 2004 -0700

    [PATCH] prevent module unloading for legacy IDE chipset drivers
    
    It is unsafe thing to do (no locking, no reference counting etc).
    Just remove module_exit() as it was done for IDE PCI drivers.

commit 9d8bbc624978a06fc5a5595e6cc9b8ce1c456893
Author: Bartlomiej Zolnierkiewicz <b.zolnierkiewicz@elka.pw.edu.pl>
Date:   Sun Apr 25 04:50:03 2004 -0700

    [PATCH] use kernel min/max in IDE code (2/2)
    
    From: Randy Dunlap <rddunlap@osdl.org>
    From: Michael Veeck <michael.veeck@gmx.net>
    
    Removes unnecessary IDE_MIN()/IDE_MAX() macros
    and changes calls to use kernel.h macros instead.

commit 0b15a1402f6e51966694ed462490813b61177f3f
Author: Bartlomiej Zolnierkiewicz <b.zolnierkiewicz@elka.pw.edu.pl>
Date:   Sun Apr 25 04:49:54 2004 -0700

    [PATCH] use kernel min/max in IDE code (1/2)
    
    From: Randy Dunlap <rddunlap@osdl.org>
    From: Michael Veeck <michael.veeck@gmx.net>
    
    ide-cd.h: remove unnecessary MIN() macro
    ide-cd.c: change MIN() calls to use kernel.h calls
    ide-tape.c: use min_t()/max_t() instead of min()/max()

commit d550231dc9558d3973809dd03dac8f6f957cea93
Author: Bartlomiej Zolnierkiewicz <b.zolnierkiewicz@elka.pw.edu.pl>
Date:   Sun Apr 25 04:49:42 2004 -0700

    [PATCH] generic PCI IDE support for Toshiba Piccolo chips
    
    From: Daniel Drake <dsd@gentoo.org>
    
    Adds Toshiba chips to the list supported by the generic PCI IDE driver.
    The 2.4 tree already contained an entry for 0x1179:0x0102, this patch
    adds that entry to 2.6 as well as two new ones (0x0103 and 0x0105).
    This then allows DMA to be enabled on disks.

commit 5f1d3202819e201d1bf1473987d0924c8224dd13
Author: Keith M. Wesolowski <wesolows@foobazco.org>
Date:   Sun Apr 25 04:31:28 2004 -0700

    [SPARC32]: Ensure swap entries do not overlap the PRESENT or FILE bits.
    
    Recent changes to the swap code force us to actually support the
    entire range of swap encodings.  The old encodings could cause the
    FILE bit to be set, causing a BUG.

commit 5541b4278d607ecdf064226818a7dddcd9d31b92
Merge: 7ce42ae... c2e26dd...
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Sun Apr 25 04:21:52 2004 -0700

    Merge bk://bk.arm.linux.org.uk/linux-2.6-rmk
    into ppc970.osdl.org:/home/torvalds/v2.6/linux

commit 2eb323cb67905d6af9ef4bd93292b1c8d529759f
Author: Anton Altaparmakov <aia21@cantab.net>
Date:   Sun Apr 25 00:52:18 2004 +0100

    NTFS: - Modify fs/ntfs/time.c::ntfs2utc(), get_current_ntfs_time(), and
            utc2ntfs() to work with struct timespec instead of time_t on the
            Linux UTC time side thus preserving the full precision of the NTFS
            time and only loosing up to 99 nano-seconds in the Linux UTC time.
          - Move fs/ntfs/time.c to fs/ntfs/time.h and make the time functions
            static inline.

commit d3497ef69a250ecb458ec8e3c6b1d5115024b24b
Author: Anton Altaparmakov <aia21@cantab.net>
Date:   Sun Apr 25 00:32:35 2004 +0100

    NTFS: Use get_bh() instead of manual atomic_inc() in fs/ntfs/compress.c.

commit c2e26dd2a08599cd24ffd7629ab263b3ddf5d4e7
Author: Deepak Saxena <dsaxena@net.rmk.(none)>
Date:   Sun Apr 25 00:19:55 2004 +0100

    [ARM PATCH] 1815/1: Generic DMA buffer bouncing support for ARM targets
    
    Patch from Deepak Saxena
    
    Latest (and hopefully last :) patch for generic DMA buffer bouncing.
    
    - Fixed SA1111 dma_needs_bounce
    - Added check for out of bounds buffers.
    - Made dmabounce.c directly implement dma_* API
    
    Note that I didn't do the following:
    
    #ifndef CONFIG_DMABOUNCE
    inline implementations of all functions
    #else
    extern declarations
    #endif
    
    Instead I wrapped it individual in #ifndef/#else blocks to keep the
    comments in the same area as function declarations.  IMHO this makes
    it easier for someone to go look at the comments if they need to know
    what a specific API does.

commit a70018bc9c1ae271b7511014be7031b517834296
Author: Russell King <rmk@flint.arm.linux.org.uk>
Date:   Sat Apr 24 23:47:18 2004 +0100

    [ARM] Remove extraneous "volatile" from atomic_t pointers.

commit 32f82c01517835b8820d9c9d4c2e30769a27c5a8
Author: Len Brown <len.brown@intel.com>
Date:   Sat Apr 24 15:20:27 2004 -0400

    ACPI irq->gsi naming (Bjorn Helgaas)

commit 5e18a111b6b1c4a3999ab660ff9058ca4c148f8c
Author: Scott Feldman <scott.feldman@intel.com>
Date:   Sat Apr 24 14:19:01 2004 -0400

    [PATCH] e100: ICH 10/H Tx hang fix
    
    * Need to carry forward this workaround from old e100 driver to
      avoid a Tx hang on ICH systems linked at 10/Half.  Workaround
      adds a stall before each Tx command queued by issuing a NOP
      command followed by 1us delay.  Yuck!  Otherwise HW locks hard.
      (Probably needed for eepro100 also ;-).

commit 3dae285a3bd7b29b220d2e6136cb316cabfc8b8e
Author: Nicolas Pitre <nico@org.rmk.(none)>
Date:   Sat Apr 24 00:34:47 2004 +0100

    [ARM PATCH] 1825/1: abort on bad code generation with div64 in some cases
    
    Patch from Nicolas Pitre
    
    One case was found when the kernel is compiled with -O2 (instead of the
    default -Os).  However, all gcc-3.* versions seem to have a problem with
    this.  Instead of blacklisting them all unconditionally, better just abort
    when a bad case occurs especially since this bad case doesn't seem to
    appear with current default compiler flags.  Depends on patch #1824.

commit 74708ced1dc6eec1b60d154ee8e2459a44609d69
Author: Nicolas Pitre <nico@org.rmk.(none)>
Date:   Sat Apr 24 00:31:14 2004 +0100

    [ARM PATCH] 1824/1: guard against gcc not respecting local variable register assignment
    
    Patch from Nicolas Pitre
    
    The recent discovery of a problem with gcc not always respecting register
    assignment for local variables to be used with inline assembly is worrisome.
    If unnoticed, such problems can cover bugs that might prove hard to find
    especially when the code is right but silently ignored.  This patch adds a
    test where needed to have the assembler confirm our register selection and
    fail the kernel build if the wrong registers are allocated.

commit fb715e7ee31f07befc5790cc209bfa915e81bfcf
Merge: 3006655... 71271be...
Author: Len Brown <len.brown@intel.com>
Date:   Fri Apr 23 18:22:37 2004 -0400

    Merge intel.com:/home/lenb/src/linux-acpi-test-2.6.5
    into intel.com:/home/lenb/src/linux-acpi-test-2.6.6

commit 71271be3686691f9020f0fa302b09d9d0eef58a6
Author: Len Brown <len.brown@intel.com>
Date:   Fri Apr 23 18:18:14 2004 -0400

    [ACPI] No IRQ known... - using IRQ 255 (Bjarni R√∫nar Einarsson)
    http://bugzilla.kernel.org/show_bug.cgi?id=2148

commit 7eebd09bfefc312896fcb7d031cffaa7323cc721
Merge: 3c23072... 7ce42ae...
Author: Anton Altaparmakov <aia21@cantab.net>
Date:   Fri Apr 23 18:48:55 2004 +0100

    Merge cantab.net:/usr/src/bklinux-2.6 into cantab.net:/usr/src/ntfs-2.6

commit 3c23072ef1e12a0175513c76dd67c0d182fbcf66
Author: Anton Altaparmakov <aia21@cantab.net>
Date:   Fri Apr 23 18:22:42 2004 +0100

    NTFS: Finally fix NFS exporting of mounted NTFS volumes by checking the
    return of d_splice_alias() and acting accordingly rather than just
    ignoring the returned dentry.

commit ce812c288d2b8c5f66c0d5f9fdd7313d2a9c67a1
Author: Anton Altaparmakov <aia21@cantab.net>
Date:   Fri Apr 23 14:12:25 2004 +0100

    NTFS: Move a few assignments after a NULL check in fs/ntfs/attrib.c.

commit 300665573047e7f8d07efdce038e0398a243e737
Merge: 7ce42ae... f8bdcc5...
Author: Len Brown <len.brown@intel.com>
Date:   Fri Apr 23 07:43:23 2004 -0400

    Merge intel.com:/home/lenb/src/linux-acpi-test-2.6.5
    into intel.com:/home/lenb/src/linux-acpi-test-2.6.6

commit 9c82a749ab84eae895da3ff44454243837415419
Merge: 8a51bee... 3ddbbf3...
Author: Anton Altaparmakov <aia21@cantab.net>
Date:   Fri Apr 23 11:19:18 2004 +0100

    Merge cantab.net:/home/src/bklinux-2.6
    into cantab.net:/home/src/ntfs-2.6

commit cce248573c85760b508f77fea8a7c7550ad22e11
Author: Arjan van de Ven <arjanv@redhat.com>
Date:   Fri Apr 23 02:42:22 2004 -0700

    [NET]: linux/if.h needs linux/compiler.h for __user.

commit 1e739c682f137fc3e96ce7ba8b9c9056b4fd6c05
Author: Michal Ludvig <mludvig@suse.cz>
Date:   Fri Apr 23 02:39:48 2004 -0700

    [CRYPTO]: Add module autoloads for null module.

commit 46f3dece4eeefa26f3fe223849d83b3333ad3676
Author: Stephen Hemminger <shemminger@osdl.org>
Date:   Fri Apr 23 02:28:42 2004 -0700

    [TCP]: Report vegas info via tcp_diag.

commit 99aa13d706d0ac2f4e53e898c3355b47c5c54444
Author: David S. Miller <davem@nuts.davemloft.net>
Date:   Fri Apr 23 02:16:16 2004 -0700

    [SPARC64]: Fix zero-extension issues wrt. {pgd,pmd}_val().

commit f8bdcc5123b9bdf94c04e39eec0416225473dbe9
Author: Len Brown <len.brown@intel.com>
Date:   Fri Apr 23 05:15:31 2004 -0400

    [ACPI] workaround for nForce2 BIOS bug: XT-PIC timer in IOAPIC mode
    "acpi_skip_timer_override" boot parameter
    dmi_scan for common platforms, may be replaced with PCI-ID in future.
    http://bugzilla.kernel.org/show_bug.cgi?id=1203

commit 381b26f06d927129e4f35650da2c455fdf3cdf51
Author: Len Brown <len.brown@intel.com>
Date:   Fri Apr 23 05:14:36 2004 -0400

    [ACPI] Workaround "_BBN 0" BIOS bug
    enhance "pci=noacpi" to skip ACPI PCI configuration and interrupt config
    add "acpi=noirq" to skip just ACPI interrupt config (David Shaohua Li)
    http://bugzilla.kernel.org/show_bug.cgi?id=1662

commit 54f96635439f76c68259475a1046a49c8c516eae
Author: David S. Miller <davem@nuts.davemloft.net>
Date:   Thu Apr 22 23:29:15 2004 -0700

    [SPARC64]: Update defconfig.

commit 44ce64b18b82cb5ad23ee46c0eac14390c392834
Merge: da47673... 7ce42ae...
Author: Steve French <cifs.adm@hostme.bitkeeper.com>
Date:   Thu Apr 22 23:22:35 2004 -0700

    Merge bk://linux.bkbits.net/linux-2.5
    into hostme.bitkeeper.com:/repos/c/cifs/linux-2.5cifs

commit cee35debd1b4bc1be3195e7c5c26fa37ad751064
Merge: 16b2cbc... e47da81...
Author: David S. Miller <davem@nuts.davemloft.net>
Date:   Thu Apr 22 23:13:10 2004 -0700

    Merge bk://kernel.bkbits.net/wesolows/sparc32-2.6
    into nuts.davemloft.net:/disk1/BK/sparc-2.6

commit 16b2cbc33b663c395abf691f3c0c120e926e4774
Merge: 7ce42ae... 7b9a3b3...
Author: David S. Miller <davem@nuts.davemloft.net>
Date:   Thu Apr 22 23:09:44 2004 -0700

    Merge nuts.davemloft.net:/disk1/BK/sparcwork-2.6
    into nuts.davemloft.net:/disk1/BK/sparc-2.6

commit 07d78b7f05e6f950240b6275ca055070b84e1e2f
Merge: d1b44f9... a07af8e...
Author: Tom Rini <trini@kernel.crashing.org>
Date:   Thu Apr 22 23:08:03 2004 -0700

    Merge

commit d1b44f9575fb1b08e75ce675f531447ceca740be
Merge: ed2f05a... e43784f...
Author: Tom Rini <trini@kernel.crashing.org>
Date:   Thu Apr 22 20:41:08 2004 -0700

    Merge

commit ed2f05a9b0525cc407926fc1c1836b91036a9815
Merge: 7ce42ae... bcd1182...
Author: Tom Rini <trini@kernel.crashing.org>
Date:   Thu Apr 22 20:33:39 2004 -0700

    Merge kernel.crashing.org:/home/trini/work/kernel/pristine/linux-2.6
    into kernel.crashing.org:/home/trini/work/kernel/pristine/for-linus-ppc

commit 7ce42ae14e32016ac8e83003db5811a33e3b16e3
Merge: 1ed7353... 400da24...
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Thu Apr 22 16:32:40 2004 -0700

    Merge http://lia64.bkbits.net/to-linus-2.5
    into ppc970.osdl.org:/home/torvalds/v2.6/linux

commit 1ed73535789d5558f91d214e089a659ab59ae80f
Author: Andrew Morton <akpm@osdl.org>
Date:   Thu Apr 22 16:32:08 2004 -0700

    [PATCH] writeback livelock fix
    
    If a filesystem's ->writepage implementation repeatedly refuses to write the
    page (it keeps on redirtying it instead) (reiserfs seems to do this) then the
    writeback logic can get stuck repeately trying to write the same page.
    
    Fix that up by correctly setting wbc->pages_skipped, to tell the writeback
    logic that things aren't working out.

commit da47673488795d423e1035b6a10f5d5134a50be4
Merge: eb968ca... 8a51bee...
Author: Steve French <cifs.adm@hostme.bitkeeper.com>
Date:   Thu Apr 22 15:59:40 2004 -0700

    Merge bk://linux.bkbits.net/linux-2.5
    into hostme.bitkeeper.com:/repos/c/cifs/linux-2.5cifs

commit eb968ca8bc4be5732a63ef30a31c7a081ccc78e3
Author: Steve French <stevef@steveft21.ltcsamba>
Date:   Thu Apr 22 20:36:35 2004 -0500

    do not allow routine user signals to kill SendReceive wait for response (which was damaging performance badly)

commit 78ba94ec370e23a054f24d36bda2623ed51028fe
Merge: a858852... 5d68762...
Author: Nathan Scott <nathans@sgi.com>
Date:   Fri Apr 23 04:48:02 2004 +1000

    Merge sgi.com:/source2/linux-2.6 into sgi.com:/source2/xfs-linux-2.6

commit 5d68762136beb3f5bd29df48e40e7233cd6a767c
Author: Nathan Scott <nathans@sgi.com>
Date:   Fri Apr 23 04:30:42 2004 +1000

    [XFS] Revive an accidentally dropped pagesize > blocksize assert.

commit bf4269d7634286aff7e622c9f2a39352bb640cae
Author: Christoph Hellwig <hch@sgi.com>
Date:   Fri Apr 23 03:59:11 2004 +1000

    [XFS] Don't reset buffer offset before using it.
    
    SGI Modid: xfs-linux:xfs-kern:168692a

commit 00f6a9756099ede46cd5882bfffc9c76cd673580
Author: Steve French <stevef@stevef95.austin.ibm.com>
Date:   Thu Apr 22 12:55:12 2004 -0500

    fix timeout on close operation when pending signal

commit afba7f60c23d49e8631c0740d23e9e7f098e444e
Author: Steve French <stevef@steveft21.ltcsamba>
Date:   Thu Apr 22 16:18:21 2004 -0500

    fix error code mapping on bad host

commit 450734ddf4b71914284dbea8cd1652ecbc8030f2
Author: Steve French <stevef@steveft21.ltcsamba>
Date:   Thu Apr 22 15:59:28 2004 -0500

    proper rc on host down

commit 8df2fe60a1377188968b89bbac977df6eeda2f65
Merge: 8a51bee... 400da24...
Author: David Mosberger <davidm@tiger.hpl.hp.com>
Date:   Thu Apr 22 09:55:04 2004 -0700

    Merge tiger.hpl.hp.com:/data1/bk/vanilla/linux-2.5
    into tiger.hpl.hp.com:/data1/bk/lia64/to-linus-2.5

commit 400da241ed7c0ebdc44b2b19863a8512b9536ded
Author: David Mosberger <davidm@tiger.hpl.hp.com>
Date:   Thu Apr 22 09:38:25 2004 -0700

    ia64: Add message-queue support to copy_siginfo_from_user().

commit fa551dbc258898e29092d2b45c289a9959f1a737
Author: Steve French <stevef@stevef95.austin.ibm.com>
Date:   Thu Apr 22 08:38:48 2004 -0500

    Update change log for 1.10 cifs vfs

commit 7336402f28bbe1a5e1b29777b2304dfb1ff0e502
Author: Steve French <stevef@stevef95.austin.ibm.com>
Date:   Thu Apr 22 08:17:11 2004 -0500

    exit from waiting on smb response when session dead

commit 54aaf1b95c50cac85c9501614a2628ec4a29f80e
Merge: 388f8f3... 6ec0145...
Author: Steve French <stevef@stevef95.austin.ibm.com>
Date:   Thu Apr 22 06:29:05 2004 -0500

    resolve merge conflict

commit f7e2224adb3fe288f35c763954c45e15ec292c7b
Author: Len Brown <len.brown@intel.com>
Date:   Thu Apr 22 07:15:17 2004 -0400

    [ACPI] allow IRQ2 to be used in ACPI/IOAPIC mode
    http://bugzilla.kernel.org/show_bug.cgi?id=2564

commit 0482a634ccf7b93b2940a9e66993d8166584f0ec
Author: Len Brown <len.brown@intel.com>
Date:   Thu Apr 22 07:13:43 2004 -0400

    [ACPI] if acpi_os_name= is used, print what it finds

commit 6ec01455d7873fee6fbe5515b005e8a07772047b
Author: Steve French <stevef@stevef95.austin.ibm.com>
Date:   Thu Apr 22 06:02:53 2004 -0500

    RFC1002 fixup

commit 388f8f388fe995e2076953ab1b26623fc901690b
Merge: 287c92d... 7c34073...
Author: Steve French <stevef@smfhome.smfdom>
Date:   Thu Apr 22 05:51:42 2004 -0500

    Merge bk://cifs.bkbits.net/linux-2.5cifs
    into smfhome.smfdom:/home/stevef/bk/linux-2.5cifs

commit 8a51beef39cfd11a4f0ba850813cd99c5adac2c3
Merge: 88d0505... c8682fb...
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Thu Apr 22 01:46:28 2004 -0700

    Merge bk://kernel.bkbits.net/davem/net-2.6
    into ppc970.osdl.org:/home/torvalds/v2.6/linux

commit c8682fb009008380c4ed3a000d64eb482ce2ecd0
Merge: bad3b71... 1c710c6...
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Thu Apr 22 01:35:45 2004 -0700

    Merge bk://kernel.bkbits.net/gregkh/linux/driver-2.6
    into ppc970.osdl.org:/home/torvalds/v2.6/linux

commit 88d0505c93f592c135ea730df4cebad96fd0df64
Merge: 16a76bd... 98a5d35...
Author: David S. Miller <davem@nuts.davemloft.net>
Date:   Thu Apr 22 01:25:25 2004 -0700

    Merge nuts.davemloft.net:/disk1/BK/network-2.6
    into nuts.davemloft.net:/disk1/BK/net-2.6

commit 1c710c64d9c40be68971ad4cc1073e4a8bf7394a
Author: Linda Xie <lxiep@us.ibm.com>
Date:   Thu Apr 22 01:11:12 2004 -0700

    [PATCH] symlink doesn't support kobj name > 20 charaters (KOBJ_NAME_LEN)
    
    Since symlink.c uses "name" field of a kobj when it calculates the
    length,  it gets a wrong value if the kobj's name  has more than 20
    charathers.  A correct way to do that is to call kobject_name(kobj)
    instead of using kobj->name directly.

commit bad3b71748cd7666ea3e03f716f463302fe8a0ca
Merge: eb757e4... 98a5d35...
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Thu Apr 22 01:03:47 2004 -0700

    Merge bk://kernel.bkbits.net/gregkh/linux/usb-2.6
    into ppc970.osdl.org:/home/torvalds/v2.6/linux

commit c0b3a38f48329d6224822a5c05c37919e14505e4
Author: Romain Li√©vin <lkml@lievin.net>
Date:   Thu Apr 22 00:36:55 2004 -0700

    [PATCH] tipar char driver: wrong timeout value
    
    this patch (2.4 & 2.6) fixes a bug about the timeout value. The formula
    used to calculate jiffies from timeout is wrong.
    The new formula is ok and takes care of integer computation/rounding.
    There is the same bug in the tiglusb.c module which will be fixed by another
    patch.

commit eb757e4f2218a4be2330519e53c6f0752ef14f55
Author: David Brownell <david-b@pacbell.net>
Date:   Wed Apr 21 23:53:58 2004 -0700

    [PATCH] USB: usbnet and pl2301/2302 reset
    
    Handle some PL-2301/2302 devices better.

commit 78bf7a14d40ec95a631c56a4187705c0abff3b5a
Author: Jan Capek <jan@ccsinfo.com>
Date:   Wed Apr 21 23:53:33 2004 -0700

    [PATCH] USB: ftdi patch fixup
    
    I just checked out the latest 2.6.6-rc1-mm1 to see that the ID patch for
    ftdi has applied cleanly, but apparently someone was faster and in the
    combined ID table our ID's were missing.
    Most probably the patch program got confused and applied the hung at wrong
    spot..
    
    Attached is a patch that places that 2 lines in the correct spot.

commit 52f62ca406f5d8e3e92e2ffa70d9f1a130d3a309
Author: Romain Li√©vin <lkml@lievin.net>
Date:   Wed Apr 21 23:53:08 2004 -0700

    [PATCH] USB: tiglusb: wrong timeout value
    
    Hi,
    
    this patch (cumulative; 2.4 & 2.6) fixes another bug in the tiglusb
    driver. The formula used to calculate jiffies from timeout is wrong.
    The new formula is ok and takes care of integer computation/rounding.
    This is the same kind of bug than in the tipar char driver.

commit b157e37fdfdc932e2935e3adf5d594668c794bf3
Author: William Lee Irwin III <wli@holomorphy.com>
Date:   Wed Apr 21 23:52:40 2004 -0700

    [PATCH] USB: silence dpcm warning
    
    Warnings aren't terribly important in and of themselves, but there
    isn't really much the warning tells us to do here, so it would appear
    that caving in to the compiler is the thing to do for now.

commit 920f873ad9d90c6e48d6370c8e59f1919df2728e
Author: David Brownell <david-b@pacbell.net>
Date:   Wed Apr 21 23:43:39 2004 -0700

    [PATCH] USB: rndis gadget driver updates
    
    Various build fixes:  64bit (Andrew Morton), static linking,
    broken on big-endian, etc.
    
    Tighten up the integration with the main "ether" driver, so
    state transitions and host ethernet addresses are shared too.
    Add missing spinlock calls around RNDIS command outcall,
    fix GET_INTERFACE issue, host mustn't clobber netdev flags.
    
    Minor code cleanups.

commit 836115bf98d9fb23da197c5e1da3be49480bcf27
Author: David Brownell <david-b@pacbell.net>
Date:   Wed Apr 21 23:43:11 2004 -0700

    [PATCH] USB: ehci handles pci misbehavior better
    
    Cope better when PCI misbehaves badly and registers misbehave:
    
        - terminate some loops before they get to infinity
           * capability scan
           * port reset
        - after init failure, memory may already be cleaned up
    
    Some systems have been reporting such problems after ACPI resume.

commit 98a5d354daf5357590bfc25521c91d67dc93de96
Author: Mikael Pettersson <mikpe@csd.uu.se>
Date:   Wed Apr 21 23:38:54 2004 -0700

    [PATCH] use smp_processor_id() in init_IRQ()
    
    This replaces current_thread_info()->cpu in i386' init_IRQ() by the
    equivalent smp_processor_id().
    
    Reduces overhead on UP, and makes the code cleaner.

commit 7bc2551d9ac0f5bce0386523d6d8e4c7afac3de8
Author: Mikael Pettersson <mikpe@csd.uu.se>
Date:   Wed Apr 21 23:38:42 2004 -0700

    [PATCH] clean up Pentium M quirk code in nmi.c
    
    This simplifies the Pentium M quirk code in nmi.c, and eliminates an
    unnecessary apic_read().
    
    Local APIC accesses are not zero-cycle; let's not inflict more damage
    than we must.

commit f377a8228fed60be22b1483fe92f23f5f3ffbc8c
Author: Andrew Morton <akpm@osdl.org>
Date:   Wed Apr 21 23:38:29 2004 -0700

    [PATCH] ppc64: Set ARCH_MIN_TASKALIGN
    
    From: Benjamin Herrenschmidt <benh@kernel.crashing.org>
    
    We need some alignement of those structs for proper operations especially
    with FP and Altivec, or SLAB_DEBUG can break us.

commit cec75551495ed8cef9bedcc6517441400e89bf2d
Author: Andrew Morton <akpm@osdl.org>
Date:   Wed Apr 21 23:38:16 2004 -0700

    [PATCH] ppc64: add some iSeries proc entries
    
    From: Stephen Rothwell <sfr@canb.auug.org.au>
    
    This patch just adds some proc entries for the virtual tape and cdrom
    drivers to allow mapping between linux devices and OS/400 ones.  This is
    expected by existing users and there is no other way to do this
    translation.

commit 32419a40f3a9a700dba410e717476c67f79b2b0e
Author: Andrew Morton <akpm@osdl.org>
Date:   Wed Apr 21 23:38:04 2004 -0700

    [PATCH] sunrpc rmmod oops fix
    
    From: "J. Bruce Fields" <bfields@fieldses.org>
    
    Unregister svcauth_gss caches on exit from gss module; fixes an oops on
    rmmod.

commit 39b000cfc34206b2a2a55644859dd7a7fd4b1bb5
Author: Andrew Morton <akpm@osdl.org>
Date:   Wed Apr 21 23:37:51 2004 -0700

    [PATCH] Set ARCH_MIN_TASKALIGN on ppc32
    
    From: Benjamin Herrenschmidt <benh@kernel.crashing.org>
    
    From: David Woodhouse <dwmw2@infradead.org>
    
    Without this the task struct gets unaligned when using SLAB_DEBUG, causing
    random problems with FP and Altivec.

commit 366779f7212192866f7254dd96c194cd3d1991d4
Author: Andrew Morton <akpm@osdl.org>
Date:   Wed Apr 21 23:37:38 2004 -0700

    [PATCH] Update comment in fs/compat.c
    
    From: Ralf Baechle <ralf@linux-mips.org>
    
    MIPS now also uses the generic ioctl compat code.

commit 479308add74d247681f90a04daefc100684abe38
Author: Andrew Morton <akpm@osdl.org>
Date:   Wed Apr 21 23:37:25 2004 -0700

    [PATCH] MIPS is an a.out free zone
    
    From: Ralf Baechle <ralf@linux-mips.org>
    
    MIPS never uses a.out

commit 2b7058b32c3f1706a80d54b06ad238f3c0bd09e9
Author: Andrew Morton <akpm@osdl.org>
Date:   Wed Apr 21 23:37:12 2004 -0700

    [PATCH] Merge missing MIPS i8042 bits
    
    From: Ralf Baechle <ralf@linux-mips.org>
    
    - Add HPC3 PS/2 driver bits for SGI IP22 aka Indy
    - Add Mace PS/2 driver bits for SGI IP32 aka O2
    - Add R4030 PS/2 driver bits for Jazz family
    - Don't register I/O ports where we're using the I/O port memory window
       to access the i8042 registers

commit 0ef7471d97cce9cf96fc4ccf2ba99afa311be260
Author: Andrew Morton <akpm@osdl.org>
Date:   Wed Apr 21 23:36:59 2004 -0700

    [PATCH] Add Pete Popov to credits
    
    From: Ralf Baechle <ralf@linux-mips.org>
    
    Add Pete to CREDITS for all the time he's invested into supporting the AMD
    Alchemy of SOCs and eval boards.

commit c833da0bc63c8c980d5ba086d4a21173097e6b05
Author: Andrew Morton <akpm@osdl.org>
Date:   Wed Apr 21 23:36:45 2004 -0700

    [PATCH] MIPS: PCI code is now shared.
    
    From: Ralf Baechle <ralf@linux-mips.org>
    
    All MIPS systems use the same PCI code now.

commit 82e07b2ce71688f7e3fd1dbe6bef645ed7aa104c
Author: Andrew Morton <akpm@osdl.org>
Date:   Wed Apr 21 23:36:32 2004 -0700

    [PATCH] fbdev comment fix
    
    Fix the incorrect comment which caused the fb_ioctl confusion.

commit e5c7f247d6701be52bb10044db6dfbb1099135e4
Author: Andrew Morton <akpm@osdl.org>
Date:   Wed Apr 21 23:36:19 2004 -0700

    [PATCH] dynamic proc cleanups
    
    From: Matt Mackall <mpm@selenic.com>
    
    Delete obsolete comment and kill test of obsolete define.

commit 507662e17a13f499770b98e6e6b5c6a13b737e63
Author: Andrew Morton <akpm@osdl.org>
Date:   Wed Apr 21 23:36:07 2004 -0700

    [PATCH] EDD: set sysfs attr owner field
    
    From: Matt Domsch <Matt_Domsch@dell.com>
    
    The patch below from Michael E.  Brown properly sets the owner field of a
    sysfs attribute.  Without this patch, it is possible to crash the kernel with
    a simultaneous insmod/rmmod while reading files exported by the module.

commit fcde14075d7839bca1cbb01c8afb6221d25e0447
Author: Andrew Morton <akpm@osdl.org>
Date:   Wed Apr 21 23:35:53 2004 -0700

    [PATCH] s390: crypto api.
    
    From: Martin Schwidefsky <schwidefsky@de.ibm.com>
    
    Add support for z990 crypto instructions to in-kernel crypto api.

commit 35a52a805863e7127f973574ed98f3a3b48ccd77
Author: Andrew Morton <akpm@osdl.org>
Date:   Wed Apr 21 23:35:40 2004 -0700

    [PATCH] s390: zfcp adapter fixes.
    
    From: Martin Schwidefsky <schwidefsky@de.ibm.com>
    
    zfcp host adapter changes:
     - Fix error recovery stall in case of unavailable nameserver.
     - Reset host_scribble field to NULL in scsi_cmd.
     - Remove request debug code.

commit 19edabfd60ba30c49c15a122cc90b87d96bcff91
Author: Andrew Morton <akpm@osdl.org>
Date:   Wed Apr 21 23:35:26 2004 -0700

    [PATCH] s390: dasd device driver.
    
    From: Martin Schwidefsky <schwidefsky@de.ibm.com>
    
    dasd device driver changes:
     - Initialize open_count with -1 to account for blkdev_open in
       dasd_scan_partitions.
     - Introduce USE_ERP request flag to selectivly switch off error
       recovery for reserve, release & unconditional reserve ioctls.

commit 8d21a7e30685ac7632c4fdc199d08ac7325ed9ca
Author: Andrew Morton <akpm@osdl.org>
Date:   Wed Apr 21 23:35:12 2004 -0700

    [PATCH] s390: network device drivers.
    
    From: Martin Schwidefsky <schwidefsky@de.ibm.com>
    
    Network driver changes:
     - qeth: Fix reference counting in regard to sysfs backing store patches.
     - qeth: Prefix kernel thread names with qeth_.
     - qeth: Remove inbound and outbound tasklets. Handle buffers directly
             in the interrupts handlers.
     - iucv: Add missing kfree in iucv_register_program.
     - iucv: Add missing return in netiucv_transmit_skb.
     - iucv: Check for NULL pointer in conn_action_txdone.

commit c6f7f898c2e50fa4c1051c1ebfaba1846ddfa600
Author: Andrew Morton <akpm@osdl.org>
Date:   Wed Apr 21 23:34:58 2004 -0700

    [PATCH] s390: 3270 device driver.
    
    From: Martin Schwidefsky <schwidefsky@de.ibm.com>
    
    3270 device driver changes:
     - Add NULL pointer checks.

commit 3b1e24687d92686c252eda15ab15c53a28c4f11e
Author: Andrew Morton <akpm@osdl.org>
Date:   Wed Apr 21 23:34:46 2004 -0700

    [PATCH] s390: common i/o layer.
    
    From: Martin Schwidefsky <schwidefsky@de.ibm.com>
    
    Common i/o layer changes:
     - Quiesce active subchannels for lpar reipl.
     - Delete timer after reception of interrupt for kill on timeout.
     - Cleanup some comments in qdio.

commit a23d373404446a925269e6146ddda703a694d6b8
Author: Andrew Morton <akpm@osdl.org>
Date:   Wed Apr 21 23:34:32 2004 -0700

    [PATCH] s390: core s390.
    
    From: Martin Schwidefsky <schwidefsky@de.ibm.com>
    
    s390 core changes:
     - Fix race in do_call_softirq in regard to kernel preemption.
     - Fix typo in compat mq system call wrappers.
     - Add s390 to Kconfig for AUDITSYSCALL.
     - Redefine TASK_SIZE to TASK31_SIZE for compilation of binfmt_elf32.
     - Use correct error value for sys32_ipc when called with an invalid number.
     - New default configuration.

commit ff15d3ec1ea31bb8196d3a85c41255e9a5b81267
Author: Andrew Morton <akpm@osdl.org>
Date:   Wed Apr 21 23:34:19 2004 -0700

    [PATCH] ppc64: iSeries virtual cdrom module fix
    
    From: Stephen Rothwell <sfr@canb.auug.org.au>
    
    This patch fixes loading viocd as a module.  It would oops because I was
    passing the address of a static buffer to dma_map_single and when loaded as
    a module, this address is not valid for that purpose.
    
    There are a couple of simple cleanups here as well.

commit d8932719104b259b0c15633d8766c872621eb851
Author: Andrew Morton <akpm@osdl.org>
Date:   Wed Apr 21 23:34:05 2004 -0700

    [PATCH] remove show_trace_task()
    
    It no longer has any callers.

commit 1246206fc3822cbb6a764379cd79b2d69cf8e2e2
Author: Greg Kroah-Hartman <greg@kroah.com>
Date:   Wed Apr 21 23:32:53 2004 -0700

    [PATCH] USB: fix cdc-acm warnings due to previous patch

commit 998835d52a5d12263bb8e94343b46e874721bbcb
Author: Colin Leroy <colin@colino.net>
Date:   Wed Apr 21 23:32:24 2004 -0700

    [PATCH] USB: fix cdc-acm as it is still (differently) broken

commit c3998736d678f1562cf0b93c93615351ddd84c8e
Author: Alan Stern <stern@rowland.harvard.edu>
Date:   Wed Apr 21 23:03:22 2004 -0700

    [PATCH] USB: Important bugfix for UHCI list management code
    
    A major bug in the UHCI driver turned up recently.  Thanks to a lot of
    help from Simone Gotti it was identified and fixed late last week.  It
    turned out to be entirely my fault -- a previous patch had introduced two
    (!) errors.  (A combination of carelessness and a nasty thinko, and
    somehow it passed the regression tests...)
    
    Anyway, it's entirely possible that many of the problems people have been
    seeing are caused by that bug.  This patch is the solution.

commit 78fdb0c470f685df81f2d8cc2dce59bac9be1b12
Author: Michael E. Brown <mebrown@michaels-house.net>
Date:   Wed Apr 21 22:19:51 2004 -0700

    [PATCH] sysfs module unload race fix for bin_attributes
    
     -  Add module locking to sysfs bin_attribute files. Update all in-tree
        users to set module owner.
    
    	Compile tested. booted. stress tests pass:
    
    while true; do modprobe mymod; rmmod mymod; done &
    while true; do hexdump -C /sys/path/to/sysfs/binary/file; done

commit 8ae141b2e2910923441635bcc54dba8e65d254a7
Author: Greg Kroah-Hartman <greg@kroah.com>
Date:   Wed Apr 21 22:10:05 2004 -0700

    [PATCH] USB: Don't try to suspend devices that do not support it.
    
    Patch originally from luming.yu@intel.com and closes bug #1557

commit 596f9494c8d5a037ae979b98bc42acc2eed4e59e
Author: Nathan Scott <nathans@sgi.com>
Date:   Thu Apr 22 13:57:18 2004 +1000

    [XFS] Fix up a trivial merge botch.

commit 822e10dacf8f085b130785024e52ec12f325814e
Author: Nathan Scott <nathans@sgi.com>
Date:   Thu Apr 22 13:47:47 2004 +1000

    [XFS] cleanup pagebuf flag usage and simplify pagebuf_free.
    
    SGI Modid: xfs-linux:xfs-kern:169276a

commit 63c642fd16f829cf42555753d914bf12720ee171
Author: Nathan Scott <nathans@sgi.com>
Date:   Thu Apr 22 12:14:20 2004 +1000

    [XFS] Fix vmtruncate abuse in the XFS setattr ATTR_SIZE operation.
    
    SGI Modid: xfs-linux:xfs-kern:170344a

commit a9bbe1cfb5599f500e56881b1ba7b7e7fb802acf
Author: Russell Cattelan <cattelan@sgi.com>
Date:   Thu Apr 22 12:08:37 2004 +1000

    [XFS] Fix for the xfs dir2 rebalance bug.
    
    SGI Modid: xfs-linux:xfs-kern:170221a

commit 829eb1cc10e2aa152c503b5e1acc31a5f2fcc029
Author: Nathan Scott <nathans@sgi.com>
Date:   Thu Apr 22 12:03:50 2004 +1000

    [XFS] Bump up age_buffer and sync_interval maxima for laptop mode.  From Bart Samwel.
    
    SGI Modid: xfs-linux:xfs-kern:170057a

commit c96d330fa22e8e911a930d457aeed3555dad29f6
Author: Nathan Scott <nathans@sgi.com>
Date:   Thu Apr 22 11:35:32 2004 +1000

    [XFS] Use USER_HZ in XFS sysctl interfaces.  Fix from Bart Samwel.
    
    SGI Modid: xfs-linux:xfs-kern:170056a

commit c73e4ef252b12bbf0b23e29bc8852681bec21f0a
Author: Nathan Scott <nathans@sgi.com>
Date:   Thu Apr 22 11:13:01 2004 +1000

    [XFS] Allow xfsbufd flush intervals to take immediate effect after changing the flush sysctl value.  Fix from Bart Samwel.
    
    SGI Modid: xfs-linux:xfs-kern:170053a

commit e415172fd36f472c8f871731e160cd8bb5e2d974
Author: Nathan Scott <nathans@sgi.com>
Date:   Thu Apr 22 11:01:47 2004 +1000

    [XFS] Fix some cases where we returned fill_super success, instead
    of failing.
    
    SGI Modid: xfs-linux:xfs-kern:169865a

commit 7beb00cebbcdd294f979b569c29d581e1845ebec
Author: Nathan Scott <nathans@sgi.com>
Date:   Thu Apr 22 10:54:39 2004 +1000

    [XFS] Only use page->private to track page state for page cache pages
    
    SGI Modid: xfs-linux:xfs-kern:169801a

commit 15a935ded71f52e6f8517cc238c4ee61a45d38ee
Author: Jon Krueger <jpk@sgi.com>
Date:   Thu Apr 22 10:48:24 2004 +1000

    [XFS] Correct the (file size >= stripe unit) check inside
    xfs_iomap_write_delay.  It was comparing the file size, in
    bytes, against the stripe unit size, in FSBs. (PV 911469)
    
    SGI Modid: xfs-linux:xfs-kern:169744b

commit 28474d943be66421928d8e24bd531f1c7ee5ba71
Author: Nathan Scott <nathans@sgi.com>
Date:   Thu Apr 22 10:33:51 2004 +1000

    [XFS] Return the right error code on an ACL xattr version mismatch.
    
    SGI Modid: xfs-linux:xfs-kern:169622a

commit a3b924e3fcf92ebc69dd7f9d536b20373e997f60
Author: Nathan Scott <nathans@sgi.com>
Date:   Thu Apr 22 10:17:04 2004 +1000

    [XFS] Make buffer error checking consistent, add a value range check.
    
    SGI Modid: xfs-linux:xfs-kern:169542a

commit 8f20dd0f228a4adb2b2d8f3ae89eb56578a4cfa8
Author: Nathan Scott <nathans@sgi.com>
Date:   Thu Apr 22 09:30:04 2004 +1000

    [XFS] Fix delayed write buffer handling to use the correct list
    interfaces, add validity checks, remove unused code, fix comments.
    
    SGI Modid: xfs-linux:xfs-kern:169043a

commit c582fee9f15e9e1854eb9b2a86ca17be9a76e5e9
Author: Nathan Scott <nathans@sgi.com>
Date:   Thu Apr 22 09:04:38 2004 +1000

    [XFS] Fix a very hard-to-hit, small-block-size only corruption.
    
    SGI Modid: xfs-linux:xfs-kern:168987a

commit eef2c0717030c5e352691965bfa37200923d4390
Author: Eric Sandeen <sandeen@sgi.com>
Date:   Thu Apr 22 08:52:18 2004 +1000

    [XFS] Use pgoff_t for page indices, and remove other type confusion
    
    SGI Modid: xfs-linux:xfs-kern:168484a

commit c54e4da3ece8e13b52bd3d44f4af677732c67d68
Author: Christoph Hellwig <hch@sgi.com>
Date:   Thu Apr 22 08:45:09 2004 +1000

    [XFS] clarify pagebuf page lookup logic
    
    SGI Modid: xfs-linux:xfs-kern:168168a

commit 1463079f09b28d43f5f8f44afbb47506d23a14bc
Author: Christoph Hellwig <hch@sgi.com>
Date:   Thu Apr 22 08:36:08 2004 +1000

    [XFS] really kill the pagebuf vs xfs_buf confusion
    
    SGI Modid: xfs-linux:xfs-kern:167628a

commit b2d94fa0ffa8603e75f4514c2b7993878abe6ff1
Author: Christoph Hellwig <hch@sgi.com>
Date:   Thu Apr 22 08:27:47 2004 +1000

    [XFS] kill the pagebuf vs xfs_buf confusion
    
    SGI Modid: xfs-linux:xfs-kern:167627a

commit 048062572aa455859a2d4ac1527e089212378a91
Author: Christoph Hellwig <hch@sgi.com>
Date:   Thu Apr 22 07:26:12 2004 +1000

    [XFS] use kmem_alloc for noaddr buffers
    
    SGI Modid: xfs-linux:xfs-kern:167609a

commit 8cee26957ea8c94e02d675d9aee0c40173627eea
Author: Ralf B√§chle <ralf@linux-mips.org>
Date:   Wed Apr 21 14:31:41 2004 -0400

    [PATCH] declance updates
    
    Various small changes, DEC still doesn't work under 2.6.

commit 30d05ef40bfd6e3809e9b979d70435713f984aea
Author: Ralf B√§chle <ralf@linux-mips.org>
Date:   Wed Apr 21 14:10:31 2004 -0400

    [PATCH] IOC3 updates
    
    Use generic MII code, compile time configurable rx and tx checksumming.
    Try to handle IOC3 attached 16552 serials.  Fix descriptor setup when
    crossing a 16kB page.  Use generic PCI API.  Use generic ethtool code,
    small cleanups, use a temporary kludge to exploit virtual device
    functionality for significantly better performance.

commit 7c340734984e64ef62fd1e363e6ee01ae1693e32
Author: Steve French <stevef@smfhome.smfdom>
Date:   Wed Apr 21 13:08:55 2004 -0500

    Retry 2nd time after failure on correct port

commit 0bfbd71ed5a7d6e210f1a79d510241e33e17ef7a
Author: Ralf B√§chle <ralf@linux-mips.org>
Date:   Wed Apr 21 13:52:14 2004 -0400

    [PATCH] sgiseeq fixes
    
    Resurrect into working order for 2.6.

commit 9724d3b7fffd32cd6f7969aeae4fe9b6d3df8600
Author: Ralf B√§chle <ralf@linux-mips.org>
Date:   Wed Apr 21 13:52:06 2004 -0400

    [PATCH] BCM1250 network driver updates
    
    Resurrect into working order for 2.6.

commit 787a62121ae5853ebf1753a203228b60bcdb54df
Author: Ralf B√§chle <ralf@linux-mips.org>
Date:   Wed Apr 21 13:51:58 2004 -0400

    [PATCH] meth updates
    
    More work on the meth driver for SGI IP32 aka O2.

commit c1350c273c27c0a6ee5094b153c001604b916f40
Author: Ralf B√§chle <ralf@linux-mips.org>
Date:   Wed Apr 21 13:51:51 2004 -0400

    [PATCH] Remove RCS Id string

commit 3975cb41cad7a02e2a9af28d6e761d278d97dc96
Author: Ralf B√§chle <ralf@linux-mips.org>
Date:   Wed Apr 21 13:51:43 2004 -0400

    [PATCH] Au1000 IrDA driver update
    
    Get to build under 2.6, random updates to debugging code, new eval boards.

commit 1eb6501c482b3e7ef2f8d204c0bd4c1acb9f1fd2
Author: Andrew Morton <akpm@osdl.org>
Date:   Wed Apr 21 13:00:25 2004 -0400

    [PATCH] pcmcia netdev ordering fixes
    
    From: Russell King <rmk+pcmcia@arm.linux.org.uk>
    
    This is an *untested* patch (PCMCIA people, please test) to fix
    initialisation ordering issues in these network device drivers.  I don't
    have the hardware to be able to test these changes, although it passes a
    modular build without warnings.
    
    Andrew - it may be worth sticking these in -mm so they get some visibility
    via your tree as well.
    
    Many of these drivers were calling register_netdev() before they had
    completed their initialisation.
    
    In addition, they were calling register_netdev with the
    "DEV_CONFIG_PENDING" flag still set, which prevents hotplug scripts from
    bringing up the interface.
    
    Also, we take care to ensure that link->dev is correctly set - this is used
    to tell the PCMCIA release code if the netdev is currently registered (yes,
    that's probably racy at present, but lets sort one problem at a time.)
    
    I've arranged that all drivers register the netdevice as close as possible
    to the end of their initialisation, copy the net device's name for cardmgr
    to pass to it's network scripts, and then print out whatever information
    the driver wants to.
    
    Finally, a note about ibmtr - it seemed to assume that cardmgr wanted "tr0"
    or "tr1" depending on the base address, and completely ignoring the real
    device which the netdev layer allocated it.  I've assumed that this is
    wrong (since the netdev name is used in printk messages), and changed it to
    behave the same as the other drivers.

commit 4f6ed5f845cdf555e3af9291cd6a3f5223e9fda8
Author: Simon Kelley <simon@thekelleys.org.uk>
Date:   Wed Apr 21 12:47:42 2004 -0400

    [PATCH] atmel wireless update
    
    Fixes to avoid problems when the driver shares an interrupt. These were
    caused because the ISR cannot determine the status of the chip without
    changing its state and the driver was only disabling the interrupts from
    the card during some critical regions. An interrupt originating from
    another device at the wrong moment could run the ISR and corrupt chip
    state. Fixed by blocking interupts in the processor in critical regions
    and never checking the chip interrupt status before the driver is fully
    up.
    
    
    Added the ability to override the Regulatory Domain stored in ROM. The
    following command achieves this
    
    iwpriv <interface> regdomain <domain>
    
    vaild domains are USA,Canada,Europe,Spain,France,MKK,MKK1,Israel
    
    The current regulatory domain affects which radio channels are available
    for use.
    
    
    Some minor tidying to calibrate busy-wait loops using udelay and remove
    inclusion of obsolete include/linux/802_11.h

commit 16a76bdbafd6c681dd15419183308bba1dd58063
Author: David S. Miller <davem@nuts.davemloft.net>
Date:   Wed Apr 21 09:10:52 2004 -0700

    [TCP]: Add vegas congestion avoidance support.
    
    A forward port of an old 2.3.x kernel hack done
    years ago.  I (DaveM) did the first rough port,
    Stephen Hemminger actually cleaned it up and
    made it usable.

commit 91a793870dd95b4b337339de10b87803fce3433c
Author: David S. Miller <davem@nuts.davemloft.net>
Date:   Wed Apr 21 08:47:05 2004 -0700

    [TCP]: Abstract out all settings of tcp_opt->ca_state into a function.

commit 287c92dbdc94e7e49177aebd415542cb53e6c604
Merge: 4bc8f93... 17d5007...
Author: Steve French <cifs.adm@hostme.bitkeeper.com>
Date:   Wed Apr 21 07:08:28 2004 -0700

    Merge bk://linux.bkbits.net/linux-2.5
    into hostme.bitkeeper.com:/repos/c/cifs/linux-2.5cifs

commit 424be00c07439f26e2ff0cf9003e02abff2820b2
Author: Stephen Hemminger <shemminger@osdl.org>
Date:   Wed Apr 21 03:00:02 2004 -0700

    [TCP]: Add sysctl to turn off matrics caching.

commit 719c06b8d9c738a689a71a73f7f42f3113245c1d
Author: Stephen Hemminger <shemminger@osdl.org>
Date:   Wed Apr 21 02:57:58 2004 -0700

    [TCP]: Better packing of frto fields into tcp_opt.

commit a9e8c907e59852ea67d2ca43b9764a2c451d8f56
Author: Rusty Russell <rusty@rustcorp.com.au>
Date:   Wed Apr 21 02:49:05 2004 -0700

    [NETFILTER]: Missing ip_rt_put in ipt_MASQUERADE.

commit be7692305339fc912611c7303c9c53750a26ff83
Author: Chris Wright <chrisw@osdl.org>
Date:   Wed Apr 21 02:45:18 2004 -0700

    [IPV4]: Fix return value on MCAST_MSFILTER error case.

commit 17d5007f3f65fa3de08ed8466da05a5d2bab077d
Merge: 4918451... ad4c196...
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Wed Apr 21 02:23:37 2004 -0700

    Merge bk://linux-dj.bkbits.net/cpufreq
    into ppc970.osdl.org:/home/torvalds/v2.6/linux

commit ad4c196a84b161214275b73fbc08fedd5959c715
Author: Dave Jones <davej@redhat.com>
Date:   Wed Apr 21 21:49:59 2004 +0100

    [CPUFREQ] Fix security hole in proc handler.
    Brad Spengler <spender@grsecurity.net> found an exploitable bug in the proc handler
    of cpufreq, where a user-supplied unsigned int is cast to a signed int and then
    passed on to copy_[to|from]_user() allowing arbitary amounts of memory to be written
    (root only thankfully), or read (as any user).
    
    The Common Vulnerabilities and Exposures project (cve.mitre.org) has assigned
    the name CAN-2004-0228 to this issue.

commit 160df0e8789ab451196510d2941930064531ffdc
Author: Dave Jones <davej@redhat.com>
Date:   Wed Apr 21 21:20:17 2004 +0100

    [CPUFREQ] Export an array of acpi driver supported frequencies in sysfs
    From Dominik.

commit b68ab93140e4dd2e910e039a0ecfb4dd2124a2ea
Author: Dave Jones <davej@redhat.com>
Date:   Wed Apr 21 21:18:57 2004 +0100

    [CPUFREQ] Make an educated guess at the current P-state in the ACPI driver.
    One big limitation of the ACPI specification is that it's impossible to
    detect the current P-State by reading from ACPI-defined registers. And the
    CPU isn't always at P0 when the system boots. So, try to "guess" the current
    P-State by analyzing cpu_khz.
    
    From Dominik.

commit 9b9eb592d3719f91c089e57aa37fbb747b3175d6
Author: Dave Jones <davej@redhat.com>
Date:   Wed Apr 21 19:58:29 2004 +0100

    [CPUFREQ] Remove redundant part of powernow-k7 module parm
    If used as a bootparam, this would've become powernow-k7.powernow_acpi_force which looks silly.

commit 34c3789db605f6abbcb34ce3b7efc2e8938c35ca
Author: Dave Jones <davej@redhat.com>
Date:   Wed Apr 21 19:07:29 2004 +0100

    [CPUFREQ] Fix unbalanced try_get_module/put_module
    Spotted by Charles Coffing <ccoffing@novell.com>

commit 4918451f5b065f031e90d724fafdfece6b53afa8
Author: Jan-Benedict Glaw <jbglaw@lug-owl.de>
Date:   Wed Apr 21 02:23:05 2004 -0700

    [PATCH] lkkbd: Current version
    
    This updates the lkkbd driver to it's current version.
    
    It also incorporates two patches suggested on LKML (fixing
    some leading whitespace and an unneccessary check).

commit 35eea7a338fcc82a4fde88f2d686e6c203d6a9e9
Author: Jan-Benedict Glaw <jbglaw@lug-owl.de>
Date:   Wed Apr 21 02:22:53 2004 -0700

    [PATCH] New set of input patches
    
    This  updates the vsxxx driver to it's current version.
    
    Even DEC tablet support (VSXXX-AB) is now tested - it works:)
    You can even hotplug between mouse and digitizer...

commit e56a48b14a3388913ca74a59e4df03ee3c103d9b
Author: Stephen Rothwell <sfr@canb.auug.org.au>
Date:   Wed Apr 21 02:22:42 2004 -0700

    [PATCH] PPC64 iSeries virtual ethernet fix
    
    This patch is needed due to other patches that were applied in parallel
    with the inclusion of the iSeries virtual ethernet driver.

commit 766ab5a1ef0f3add5c05b1833dd5a9920dfcab1a
Author: Bartlomiej Zolnierkiewicz <b.zolnierkiewicz@elka.pw.edu.pl>
Date:   Wed Apr 21 02:16:05 2004 -0700

    [PATCH] removal of MOD_{INC,DEC}_USE_COUNT in ide-cs.c
    
    From: Pavel Roskin <proski@gnu.org>
    
    The "ide-cs" module cannot be unloaded because it uses obsolete
    MOD_INC_USE_COUNT and MOD_DEC_USE_COUNT macros.  In fact, they are not
    needed in ide-cs.c in 2.6 kernels.  The generic PCMCIA code already
    increases use count for every device served by the driver, so it's
    impossible to unload the ide-cs driver while it's in use.
    
    I was told that the removal of IDE interfaces may be unsafe in 2.6
    kernels.  However, MOD_INC_USE_COUNT only prevents removal of the module,
    not the interface.  It's also the first obstacle, albeit a trivial one,
    for anybody debugging those problems (i.e. loading a modified module
    requires "rmmod -f" or reboot to unload the old version).

commit cbf67c1c335fa3df7d00ea37565d52c4724f1fd9
Author: Bartlomiej Zolnierkiewicz <b.zolnierkiewicz@elka.pw.edu.pl>
Date:   Wed Apr 21 02:15:54 2004 -0700

    [PATCH] ide-probe.c: kill duplicate #include
    
    From: Arthur Othieno <a.othieno@bluewin.ch>

commit 343bf06ba0bf8f9d3b6e82077dc680d8e76a2ae3
Author: Bartlomiej Zolnierkiewicz <b.zolnierkiewicz@elka.pw.edu.pl>
Date:   Wed Apr 21 02:15:42 2004 -0700

    [PATCH] ide-disk.c: fix for IDE CF card ejection with devfs
    
    From: Pavel Roskin <proski@gnu.org>
    
    If I eject IDE CompactFlash card, I get a stack dump from
    devfs_remove() because ide/host2/bus0/target0/lun0 doesn't exist.
    
    After del_gendisk() is called from idedisk_cleanup() drive->devfs_name refers
    to a non-existent directory and should be erased, so that ide_unregister()
    doesn't try to remove that directory again.

commit 0fa272e56f61f064ecfb1f4188ac591b0f60090e
Merge: 5157e5c... ae0f55b...
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Wed Apr 21 02:13:25 2004 -0700

    Merge bk://bk.arm.linux.org.uk/linux-2.6-serial
    into ppc970.osdl.org:/home/torvalds/v2.6/linux

commit ae0f55b0ce8961fb4ec19fdcdc974d2d703c80f8
Author: Russell King <rmk@flint.arm.linux.org.uk>
Date:   Thu Apr 22 01:39:45 2004 +0100

    [SERIAL] Correct PL011 help text.

commit 5157e5c7bb8e05cba540b1929103165fd3c576ca
Merge: a858852... d8371fc...
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Wed Apr 21 02:02:21 2004 -0700

    Merge bk://bk.arm.linux.org.uk/linux-2.6-rmk
    into ppc970.osdl.org:/home/torvalds/v2.6/linux

commit d8371fcd7cc2ad658932083728ad1984f5328a4f
Author: Russell King <rmk@flint.arm.linux.org.uk>
Date:   Thu Apr 22 01:33:52 2004 +0100

    [ARM] Add support for ARM Versatile platform.
    
    This cset adds minimal support for ARM Ltd's ARM926EJ-S "Versatile"
    platform.

commit 2116be645e92e0b842fc7b98bac070b0881a9c21
Author: Jakub Jel√≠nek <jakub@redhat.com>
Date:   Wed Apr 21 00:47:01 2004 -0700

    [PATCH] ia64: add mq support for ia64

commit 9034e510e19bc3917c4a75cbc7fcce72fb77d8c7
Merge: a858852... a09f2c1...
Author: David Mosberger <davidm@tiger.hpl.hp.com>
Date:   Wed Apr 21 00:26:14 2004 -0700

    Merge tiger.hpl.hp.com:/data1/bk/vanilla/linux-2.5
    into tiger.hpl.hp.com:/data1/bk/lia64/to-linus-2.5

commit a85885213f8486b7195ee3f841c9cd6d8f37752e
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Tue Apr 20 22:02:58 2004 -0700

    Revert fb_ioctl "fix" with extreme prejudice.
    
    As Arjan points out, the patch does exactly the opposite
    of what it was claimed to do.
    
    Andrea: tssk tssk.
    
    Cset exclude: akpm@osdl.org[torvalds]|ChangeSet|20040421144431|15930

commit cd5468975cbab2414fcbce23867c9a7c34f411d7
Author: Andrew Morton <akpm@osdl.org>
Date:   Tue Apr 20 17:44:58 2004 -0700

    [PATCH] loop_set_fd() sendfile check fix
    
    From: Yury Umanets <torque@ukrpost.net>
    
    I have found small inconsistency in loop_set_fd().  It checks if
    ->sendfile() is implemented for passed block device file.  But in fact,
    loop back device driver never calls it.  It uses ->sendfile() from backing
    store file.

commit 57a3170ca0edefccb0d425216be7237852c894d3
Author: Andrew Morton <akpm@osdl.org>
Date:   Tue Apr 20 17:44:44 2004 -0700

    [PATCH] i386 hugetlb tlb correction
    
    From: William Lee Irwin III <wli@holomorphy.com>
    
    i386 does hardware interpretation of pagetables, so pte_clear() can't be
    used on present ptes, as it sets the upper half of the hugepte prior to
    setting the lower half (which includes the valid bit).  i.e.  there is a
    window where having a hugepage mapped at 56GB and doing pte_clear() in
    unmap_hugepage_range() allows other threads of the process to see a
    hugepage at 0 in place of the original hugepage at 56GB.
    
    This patch corrects the situation by using ptep_get_and_clear(), which
    clears the lower word of the pte prior to clearing the upper word.
    
    There is another nasty where huge_page_release() needs to wait for TLB
    flushes before returning the hugepages to the free pool, analogous to the
    issue tlb_remove_page() and tlb_flush_mm() repair.

commit 5ae4516e3fdfce99a33f937ff5be7e9f556144b3
Author: Andrew Morton <akpm@osdl.org>
Date:   Tue Apr 20 17:44:31 2004 -0700

    [PATCH] fb_ioctl() usercopy fix
    
    From: Andrea Arcangeli <andrea@suse.de>
    
    Arrange for ioctl(FBIOPUTCMAP) to do copy_to_user() rather than memcpy.

commit 87b9e30d490ee09c8c44111ba8c046bd74053a71
Author: Andrew Morton <akpm@osdl.org>
Date:   Tue Apr 20 17:44:18 2004 -0700

    [PATCH] i810_dma range check
    
    From: Andrea Arcangeli <andrea@suse.de>
    
    Correctly range-check an incoming-from-userspace argument.  Found by the
    Stanford checker.

commit ed3280822a048d1b92b2bbf968fd9e60861400b0
Author: Andrew Morton <akpm@osdl.org>
Date:   Tue Apr 20 17:44:05 2004 -0700

    [PATCH] selinux: remove hardcoded policy assumption from get_user_sids() logic
    
    From: Stephen Smalley <sds@epoch.ncsc.mil>
    
    This patch removes a hardcoded policy assumption from the get_user_sids logic
    in the SELinux module that was preventing it from returning contexts that had
    the same type as the caller even if the policy allowed such a transition.  The
    assumption is not valid for all policies, and can be handled via policy
    configuration and userspace rather than hardcoding it in the module logic.

commit c59f3ad7826ada93c3216d8bb0796997d3d16388
Author: Andrew Morton <akpm@osdl.org>
Date:   Tue Apr 20 17:43:53 2004 -0700

    [PATCH] selinux: add runtime disable
    
    From: Stephen Smalley <sds@epoch.ncsc.mil>
    
    This patch adds a kernel configuration option that enables writing to a new
    selinuxfs node 'disable' that allows SELinux to be disabled at runtime prior
    to initial policy load.  SELinux will then remain disabled until next boot.
    This option is similar to the selinux=0 boot parameter, but is to support
    runtime disabling of SELinux, e.g.  from /sbin/init, for portability across
    platforms where boot parameters are difficult to employ (based on feedback by
    Jeremy Katz).

commit 77782961e520439fef9fa1506c9bdf901f6add37
Author: Andrew Morton <akpm@osdl.org>
Date:   Tue Apr 20 17:43:42 2004 -0700

    [PATCH] selinux: change context_to_sid handling for no-policy case
    
    From: Stephen Smalley <sds@epoch.ncsc.mil>
    
    This patch changes the behavior of security_context_to_sid in the no-policy
    case so that it simply accepts all contexts and maps them to the kernel SID
    rather than rejecting anything other than an initial SID.  The change avoids
    error conditions when using SELinux in permissive/no-policy mode, so that any
    file contexts left on disk from prior use of SELinux with a policy will not
    cause an error when they are looked up and userspace attempts to set contexts
    can succeed.

commit 014df416805b44b22d335e376ac30d6b6fc301b5
Author: Andrew Morton <akpm@osdl.org>
Date:   Tue Apr 20 17:43:30 2004 -0700

    [PATCH] i4l: add compat ioctl's for CAPI
    
    From: Marcel Holtmann <marcel@holtmann.org>
    
    This patch adds the needed compat ioctl's for the CAPI on 64bit platforms.

commit 82fec55c97ecf2fde7431a250e5dbf07a9d67cb7
Author: Andrew Morton <akpm@osdl.org>
Date:   Tue Apr 20 17:43:17 2004 -0700

    [PATCH] lockfs - dm bits
    
    From: Christoph Hellwig <hch@lst.de>
    
    This patch makes the device mapper use the new freeze_bdev/thaw_bdev
    interface.  Extracted from Chris Mason's patch.

commit 46f769396fe3ff39e242ebbf2e49510834b3ba1c
Author: Andrew Morton <akpm@osdl.org>
Date:   Tue Apr 20 17:43:05 2004 -0700

    [PATCH] lockfs - xfs bits
    
    From: Christoph Hellwig <hch@lst.de>
    
    Remove all the code now in the VFS, make XFS's freeze ioctls use the new
    infastructure and reorganize some code.
    
    This code needs some work so the source files shared with 2.4 aren't
    exposed to the new VFS interfaces directly.  You'll get an update once this
    has been discussed with the other XFS developers and is implemented.  Note
    that the current patch works fine and I wouldn't complain if it gets into
    Linus' tree as-is.

commit 472336a4a920d0521416e690ede701941e651bee
Author: Andrew Morton <akpm@osdl.org>
Date:   Tue Apr 20 17:42:53 2004 -0700

    [PATCH] lockfs: reiserfs fix
    
    From: Chris Mason <mason@suse.com>
    
    reiserfs_write_super_lockfs() is supposed to wait for the transaction to
    commit.

commit 137718ec5f67102faf88e87e900d3188936e039b
Author: Andrew Morton <akpm@osdl.org>
Date:   Tue Apr 20 17:42:39 2004 -0700

    [PATCH] lockfs - vfs bits
    
    From: Christoph Hellwig <hch@lst.de>
    
    These are the generic lockfs bits.  Basically it takes the XFS freezing
    statemachine into the VFS.  It's all behind the kernel-doc documented
    freeze_bdev and thaw_bdev interfaces.
    
    Based on an older patch from Chris Mason.

commit 4aa3ba95023de7129d2d11ad4d05f4e2d53668d3
Author: Andrew Morton <akpm@osdl.org>
Date:   Tue Apr 20 17:42:28 2004 -0700

    [PATCH] remove amd7xx_tco
    
    From: Zwane Mwaikambo <zwane@linuxpower.ca>
    
    We've had trouble with this driver, it appears to work but the hardware
    never does the final reboot.  I have yet to come across someone with a
    board which works and don't have personal access to one.  So how about
    scrapping the whole thing.

commit d8d03c0fd974d03201505fd359ee9f3b03a1220b
Author: Andrew Morton <akpm@osdl.org>
Date:   Tue Apr 20 17:42:18 2004 -0700

    [PATCH] Call populate_rootfs later in boot
    
    populate_rootfs() is called rather early - before we've called init_idle().
    
    But populate_rootfs() does file I/O, which involves calls to cond_resched(),
    and downing of semaphores, etc.  If it scheules, the scheduler emits
    scheduling-while-atomic warnings and sometimes oopses.
    
    So run populate_rootfs() later, after the scheduler is all set up.

commit c13b1e723329b828f1a7904625fcecc0c22307be
Author: Andrew Morton <akpm@osdl.org>
Date:   Tue Apr 20 17:42:05 2004 -0700

    [PATCH] ext3 avoid writing kernel memory to disk
    
    From: Marc-Christian Petersen <m.c.p@kernel.linux-systeme.com>
    
    Solar Designer discovered an information leak in the ext3 code of Linux.
    In a worst case an attacker could read sensitive data such as cryptographic
    keys which would otherwise never hit disk media.  Theodore Ts'o developed a
    correction for this.

commit b7fbe52c11d0c7b535ba75487d7e0913ede3671b
Author: Andrew Morton <akpm@osdl.org>
Date:   Tue Apr 20 17:41:53 2004 -0700

    [PATCH] compute_creds race
    
    From: Andy Lutomirski <luto@myrealbox.com>
    
    Fixes from me, Olaf Dietsche <olaf+list.linux-kernel@olafdietsche.de>
    
    In fs/exec.c, compute_creds does:
    
    	task_lock(current);
    	if (bprm->e_uid != current->uid || bprm->e_gid != current->gid) {
                     current->mm->dumpable = 0;
    
    		if (must_not_trace_exec(current)
    		    || atomic_read(&current->fs->count) > 1
    		    || atomic_read(&current->files->count) > 1
    		    || atomic_read(&current->sighand->count) > 1) {
    			if(!capable(CAP_SETUID)) {
    				bprm->e_uid = current->uid;
    				bprm->e_gid = current->gid;
    			}
    		}
    	}
    
             current->suid = current->euid = current->fsuid = bprm->e_uid;
             current->sgid = current->egid = current->fsgid = bprm->e_gid;
    
    	task_unlock(current);
    
    	security_bprm_compute_creds(bprm);
    
    I assume the task_lock is to prevent another process (on SMP or preempt)
    from ptracing the execing process between the check and the assignment.  If
    that's the concern then the fact that the lock is dropped before the call
    to security_brpm_compute_creds means that, if security_bprm_compute_creds
    does anything interesting, there's a race.
    
    For my (nearly complete) caps patch, I obviously need to fix this.  But I
    think it may be exploitable now.  Suppose there are two processes, A (the
    malicious code) and B (which uses exec).  B starts out unprivileged (A and
    B have, e.g., uid and euid = 500).
    
    1. A ptraces B.
    
    2. B calls exec on some setuid-root program.
    
    3. in cap_bprm_set_security, B sets bprm->cap_permitted to the full
       set.
    
    4. B gets to compute_creds in exec.c, calls task_lock, and does not
       change its uid.
    
    5. B calls task_unlock.
    
    6. A detaches from B (on preempt or SMP).
    
    7. B gets to task_lock in cap_bprm_compute_creds, changes its
       capabilities, and returns from compute_creds into load_elf_binary.
    
    8. load_elf_binary calls create_elf_tables (line 852 in 2.6.5-mm1),
       which calls cap_bprm_secureexec (through LSM), which returns false (!).
    
    9. exec finishes.
    
    The setuid program is now running with uid=euid=500 but full permitted
    capabilities.  There are two (or three) ways to effectively get local root
    now:
    
    1.  IIRC, linux 2.4 doesn't check capabilities in ptrace, so A could
       just ptrace B again.
    
    2. LD_PRELOAD.
    
    3.  There are probably programs that will misbehave on their own under
       these circumstances.
    
    Is there some reason why this is not doable?
    
    The patch renames bprm_compute_creds to bprm_apply_creds and moves all uid
    logic into the hook, where the test and the resulting modification can both
    happen under task_lock().
    
    This way, out-of-tree LSMs will fail to compile instead of malfunctioning.
    It should also make life easier for LSMs and will certainly make it easier
    for me to finish the cap patch.

commit ce0cbde11f79c665ccc0d4ed01a4dd6976808b6b
Author: Andrew Morton <akpm@osdl.org>
Date:   Tue Apr 20 17:41:40 2004 -0700

    [PATCH] Fix nfsroot option handling
    
    From: Trond Myklebust <trond.myklebust@fys.uio.no>
    
    The following patch fixes up a number of bugs in the NFSroot parser
    rewrite from patchset
    trond.myklebust@fys.uio.no|ChangeSet|20040411182341|00938
    
    It also ensures that NFSroot mount options are consistent with the userland
    "mount" program.

commit e7086e68cad636dc5df6cdbc534932af54fcae38
Author: Ulrich Drepper <drepper@redhat.com>
Date:   Tue Apr 20 17:24:51 2004 -0700

    [PATCH] Add missing __initdata
    
    One of the stack size optimizations introduced a new static variable in
    a function marked with __init.  But the variable is not marked
    appropriately and so 1k of data is never freed.

commit 7a928ead369c5d24be14ed57227477679966fa5d
Author: Russell King <rmk@flint.arm.linux.org.uk>
Date:   Tue Apr 20 17:58:21 2004 +0100

    [ARM] Add find_first_bit and find_next_bit.

commit 20f6b19e52b5582f8892d6042802c23f673f571c
Author: Len Brown <len.brown@intel.com>
Date:   Tue Apr 20 12:55:53 2004 -0400

    ACPI] Delete IRQ2 "cascade" in ACPI IOAPIC mode
    no such concept exists in ACPI, frees IRQ2 for use.

commit 72c550fcbb379b2f130c0204a930fe4f1f1930bd
Author: Len Brown <len.brown@intel.com>
Date:   Tue Apr 20 12:54:14 2004 -0400

    [ACPI] enhance intr-src-override parsing to handle ES7000
    http://bugme.osdl.org/show_bug.cgi?id=2520

commit 171e020517e14cc4f1af72e1bc631df15aff87f7
Merge: 347f616... 7a928ea...
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Tue Apr 20 02:15:51 2004 -0700

    Merge bk://bk.arm.linux.org.uk/linux-2.6-rmk
    into ppc970.osdl.org:/home/torvalds/v2.6/linux

commit 4bc8f933bb9178379c36fedb2d6a285e59b2796c
Author: Steve French <stevef@stevef95.austin.ibm.com>
Date:   Tue Apr 20 02:31:50 2004 -0500

    Do not cache inode metadata when cache time set to 0 (fix hardlink count caching)

commit 347f6162fbc260a4f0dd3ea3f4e9cc3f4fbe7874
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Tue Apr 20 00:24:38 2004 -0700

    Linux 2.6.6-rc2

commit 7b9a3b36bc52d2ca61fb4504f8475a8eccfa293e
Author: Jakub Jel√≠nek <jakub@redhat.com>
Date:   Mon Apr 19 21:06:13 2004 -0700

    [SPARC64]: Missing part of posix timers fix.

commit c910f1cd77dbd1fef167c83c50c39354e08a5266
Merge: 7539add... dfb9c43...
Author: Ben Collins <bcollins@debian.org>
Date:   Mon Apr 19 23:22:13 2004 -0400

    Merge http://linux.bkbits.net/linux-2.5
    into debian.org:/usr/src/kernel/ieee1394-2.6

commit 9361782e9a83915ba8eb40fc62a14f1e6b868312
Author: Jakub Jel√≠nek <jakub@redhat.com>
Date:   Mon Apr 19 19:56:50 2004 -0700

    [SPARC64]: Fix 32-bit posix timers.

commit 9b10f4bafacdb6d7b98a922805cc79ce688f2eaa
Merge: 28f9542... 9e13029...
Author: David S. Miller <davem@nuts.davemloft.net>
Date:   Mon Apr 19 19:52:08 2004 -0700

    Merge nuts.davemloft.net:/disk1/BK/network-2.6
    into nuts.davemloft.net:/disk1/BK/net-2.6

commit 12475cc4b6fea013d2f75e8a3fe8340991e87df1
Merge: fa31b02... 28f9542...
Author: Steve French <cifs.adm@hostme.bitkeeper.com>
Date:   Mon Apr 19 19:20:29 2004 -0700

    Merge bk://linux.bkbits.net/linux-2.5
    into hostme.bitkeeper.com:/repos/c/cifs/linux-2.5cifs

commit 28f9542583e4e7408eda53c45aecf7b8c827fac8
Author: Jens Axboe <axboe@suse.de>
Date:   Mon Apr 19 18:02:57 2004 -0700

    [PATCH] Fix CFQ elevator problem
    
    Remove bogus assert in CFQ and remove merge hints.

commit 70e2d422332806f48d95b02716b019d9dfe2ef43
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon Apr 19 17:59:56 2004 -0700

    [PATCH] MIPS update
    
    From: Ralf Baechle <ralf@linux-mips.org>
    
    - more work on resurrecting AMD Alchemy platforms
    - cleanup of unnecessary <asm/pgalloc.h> inclusions
    - update default config files
    - cleanup 32-bit compat ioctl code
    - support for Montum Jaguar ATX
    - workarounds for early revs of the RM9000
    - fixes for RM5000 and RM7000 cache handling
    - add support for PMC-Sierra Yosemite eval board
    - further cleanup and bugfixes for SGI IP27
    - make LASAT and VR41xx build and work in 2.6
    - improved SGI IP32 support
    - plenty of small fixes

commit fb4e0779895245c02e06181a6bb4d3201734e498
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon Apr 19 17:23:10 2004 -0700

    [PATCH] MIPS: update documentation files
    
    From: Ralf Baechle <ralf@linux-mips.org>
    
    The pending changes to the MIPS doc files, more changes needed...

commit c93def0b14d290faa7e4a3bad45e4aebd4a7b789
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon Apr 19 17:23:00 2004 -0700

    [PATCH] MIPS: don't offer SERIAL_DZ on 64-bit DEC
    
    From: Ralf Baechle <ralf@linux-mips.org>
    
    Limit the DZ driver to MIPS32 as the supported hardware is only present in
    R2k/R3k-based systems (unless someone sends Maciej a PMAC-A board for driver
    development).

commit d4047c3ff58705968e47d98654ff57443febae48
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon Apr 19 17:22:40 2004 -0700

    [PATCH] remove duplicated COPYING file in fs/hfs/
    
    From: Christoph Hellwig <hch@lst.de>
    
    We don't need a copy of COPYING down in fs/hfs.  Roman said he didn't mind,
    so..

commit 83de2fa53b22686dc07e00d46e7bc83d5046b919
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon Apr 19 17:22:29 2004 -0700

    [PATCH] hlist_add_after() fix
    
    From: "Pedro Emanuel M. D. Pinto" <pepinto@student.dei.uc.pt>
    
    This currently-unused function is incorrectly implemented.  Fix.

commit 717a2c9cb13e078b75cc34489775c173d3a2920b
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon Apr 19 17:22:16 2004 -0700

    [PATCH] pcnet32.c build fix
    
    Remove a duplicated case which recently snuck in there.

commit d614d3153f8acc606f0c0644831b7c0d359a6b2c
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon Apr 19 17:22:03 2004 -0700

    [PATCH] fix madvise(MADV_DONTNEED) for nonlinear vmas
    
    From: Hugh Dickins <hugh@veritas.com>
    
    Jamie points out that madvise(MADV_DONTNEED) should unmap pages from a
    nonlinear area in such a way that the nonlinear offsets are preserved if the
    pages do turn out to be needed later after all, instead of reverting them to
    linearity: needs to pass down a zap_details block.
    
    (But this still leaves mincore unaware of nonlinear vmas: bigger job.)

commit e8b338d65b58d871751253d3357cda7143053040
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon Apr 19 17:21:51 2004 -0700

    [PATCH] reiserfs use-after-free fix
    
    From: Chris Mason <mason@suse.com>
    
    reiserfs-delayed-work started using queue_delayed_work, but did not make sure
    the timer was finished before it freed the work queue structs during unmount.
    This leads to timer oopsen if you unmount at just the right time.

commit f3276a186a0cb1157d771768bf5e79f020e4c746
Author: Roland McGrath <roland@redhat.com>
Date:   Mon Apr 19 17:20:06 2004 -0700

    [PATCH] fix for potential deadlock after posix-timers change
    
    Ulrich has been working on the glibc code using posix-timers and
    stressing it more now than it has before.  He ran into an SMP deadlock
    on process exit in the case there are pending queued signals from a
    timer.
    
    The deadlock arises because in the path through exit_itimers, the
    tasklist_lock is already held (for writing).  When a timer is being
    deleted, sigqueue_free will try to take it (for reading) in the case
    where that timer has a pending signal queued on somebody's queue.  This
    patch avoids the problem by making sure the queues are flushed before
    calling exit_itimers, thus ensuring its code path won't try to take
    tasklist_lock.

commit 9e130292a66ee3659c031a85b33220de10d18784
Merge: dfb9c43... cc8995c...
Author: David S. Miller <davem@nuts.davemloft.net>
Date:   Mon Apr 19 08:16:40 2004 -0700

    Merge http://linux-lksctp.bkbits.net/lksctp-2.5.work
    into nuts.davemloft.net:/disk1/BK/net-2.6

commit b4389817f141203a4cd10ffc7890dd9139df65e7
Author: Benjamin Herrenschmidt <benh@kernel.crashing.org>
Date:   Mon Apr 19 04:39:52 2004 -0700

    [PATCH] ppc64: siginfo conversion fix
    
    My message queue patch fixes the 64 bits -> 32 bits conversion of
    siginfo, but didn't change the 32 -> 64 bits conversion done in
    sys32_rt_sigqueueinfo() which was apparently bogus as well.
    
    After much discussion & debate on the right way of converting that
    structure, I decided to go the sparc64 / s390 way, and not the x86_64
    way, that is to copy the various unions data "as is". This guarantees
    that whatever a 32 bist app passes there, another 32 bits app will
    understand it. Crossover between 32 and 64 bits apps on such things
    as home-made userland siginfo isn't something we can help with anyway.
    
    The x86_64 choice of converting as if it was an RT signal, thus
    converting the sigval, cannot easily be applied to big endian archs
    since the sigval is a union of a ptr and an int, on BE, the int
    happens to be on the wrong half of the 64 bits ptr, thus  we can't
    do a simple conversion.

commit ad2ba7e65a02b100136ac046ed6c8cf037ad72d5
Author: Dave Jones <davej@redhat.com>
Date:   Mon Apr 19 11:23:44 2004 +0100

    [CPUFREQ] Fix broken cast.
    This breaks on x86-64 with the following warning.
    
    drivers/cpufreq/cpufreq_userspace.c: In function `cpufreq_procctl':
    drivers/cpufreq/cpufreq_userspace.c:170: warning: cast from pointer to integer of different size
    drivers/cpufreq/cpufreq_userspace.c: In function `cpufreq_sysctl':
    drivers/cpufreq/cpufreq_userspace.c:208: warning: cast from pointer to integer of different size

commit 763cd576c0968951825a3ea22d1f287d03028d9a
Author: Dave Jones <davej@redhat.com>
Date:   Mon Apr 19 11:20:19 2004 +0100

    [CPUFREQ] Fix up missing CONFIG_X86_POWERNOW_K8_ACPI
    We don't need this, we can infer from CONFIG_ACPI_PROCESSOR

commit 38fc4e8bc0fc6328e79c81fcc397b491fdb163eb
Author: Bartlomiej Zolnierkiewicz <b.zolnierkiewicz@elka.pw.edu.pl>
Date:   Mon Apr 19 02:31:45 2004 -0700

    [PATCH] generic ide_init_hwif_ports()
    
    Add generic ide_init_hwif_ports() to <linux/ide.h> and remove arch specific
    versions except arm26, arm, h8300, i386-pc9800, m68k and m68knommu ones.

commit c407acc1b35868f8d6b74d08fa0db7c3b6d74a79
Author: Bartlomiej Zolnierkiewicz <b.zolnierkiewicz@elka.pw.edu.pl>
Date:   Mon Apr 19 02:31:32 2004 -0700

    [PATCH] ide_init_default_hwifs() -> ide_init_default_irq()
    
    init_ide_data() initializes default IDE interfaces but without default IRQ
    (hwif->irq and hwif->hw.irq fields) so introduce ide_init_default_irq() and
    remove redundant ide_init_default_hwifs() (except arm26 and arm ones).
    
    As a side-effect it fixes:
    - CONFIG_BLK_DEV_HD_IDE if !CONFIG_BLK_DEV_IDEPCI (i386)
    - hwif->noprobe shouldn't be 0 if !hwif->io_ports[IDE_DATA_OFFSET]
      (alpha, i386, ia64, mips, sh, x86_64)

commit fa31b02f87fc8d3268f9f21f22e74633332f83f1
Author: Steve French <stevef@stevef95.austin.ibm.com>
Date:   Mon Apr 19 04:31:26 2004 -0500

    Add in cifs fcntl handling to fix remote dnotify problem

commit f9e6dd14fa15d41ef790c9bebb319eee847c3f79
Author: Bartlomiej Zolnierkiewicz <b.zolnierkiewicz@elka.pw.edu.pl>
Date:   Mon Apr 19 02:31:19 2004 -0700

    [PATCH] ide.c: split init_hwif_default() out of init_hwif_data()

commit 5a383eb1e375acf2a5f7c2a6cfbea6b7008442f3
Author: Dave Jones <davej@redhat.com>
Date:   Mon Apr 19 10:08:52 2004 +0100

    [CPUFREQ] Fix debug build of powernow-k8
    From Paul Devriendt

commit 88b6548eaf2cf8130580138c2b395ec385e5f54e
Merge: dfb9c43... b35a676...
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Mon Apr 19 01:21:40 2004 -0700

    Merge evo:v2.6/linux into ppc970.osdl.org:/home/torvalds/v2.6/linux

commit b35a6769c113563a88f6d0919b8b8b93bc9bd638
Author: Linus Torvalds <torvalds@evo.osdl.org>
Date:   Mon Apr 19 01:20:19 2004 -0700

    Remove unnecessary declaration of inline functions

commit 2f1df3824ebe08402242a6858833826f0d2f18b5
Merge: 9c7df5b... 3a913ea...
Author: Steve French <stevef@stevef95.austin.ibm.com>
Date:   Mon Apr 19 02:20:11 2004 -0500

    Merge bk://cifs.bkbits.net/linux-2.5cifs
    into stevef95.austin.ibm.com:/usr/src/bk/linux-2.5cifs

commit 3a913ea6e552439756715a4f86faedb8266a208c
Author: Steve French <stevef@stevef95.austin.ibm.com>
Date:   Mon Apr 19 02:18:17 2004 -0500

    Remove "badness in remove_proc_entry" warning logged on module unload of cifs

commit dfb9c436d78ca78c7c3fdc879e4c4691e19e95d1
Merge: 299b664... 987793d...
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Sun Apr 18 23:57:11 2004 -0700

    Merge master.kernel.org:/home/davem/BK/net-2.6
    into ppc970.osdl.org:/home/torvalds/v2.6/linux

commit 299b664abcaf14bcc83d06a31cb2d0061ab1d69a
Merge: 1e6ad21... 36377f6...
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Sun Apr 18 22:20:21 2004 -0700

    Merge bk://gkernel.bkbits.net/misc-2.6
    into ppc970.osdl.org:/home/torvalds/v2.6/linux

commit 36377f617e13e18736858a231de5431ddbe16ed9
Author: Bjorn Helgaas <bjorn.helgaas@hp.com>
Date:   Mon Apr 19 04:54:45 2004 -0400

    [PATCH] Fix hw_random build on ia64
    
    The following patch allows hw_random.c to build on ia64.  (The problem
    was just that the VIA stuff has i386 assembly in it.  The current code
    only probes for VIA on i386 anyway, so this patch just adds more ifdefs
    so the VIA code is only built for i386.)

commit 1e6ad211832ae313ee617e7d15ef8723a9936021
Merge: d86d6aa... ce4e5cd...
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Sun Apr 18 22:19:26 2004 -0700

    Merge bk://gkernel.bkbits.net/net-drivers-2.6
    into ppc970.osdl.org:/home/torvalds/v2.6/linux

commit d86d6aaa684d759b9125295392fa2c1b4812d398
Author: Pavel Roskin <proski@gnu.org>
Date:   Mon Apr 19 05:04:06 2004 -0400

    [PATCH] Tulip endianess fix
    
    My tulip ethernet card doesn't work on Blue&White G3 PowerMac with Linux
    2.6.5-rc2.  The card is shown by lspci as
    
    01:03.0 Ethernet controller: Linksys Network Everywhere Fast Ethernet
    10/100 model NC100 (rev 11)
    
    The kernel detects it as "ADMtek Comet rev 17".
    
    The MAC address reported by the kernel looked obviously wrong.  Also, I
    could only ping the system successfully if the interface was in promiscuous
    mode (running Ethereal).
    
    Those two symptoms indicated two different problems - one for reading the
    MAC address from the card on module load (tulip_init_one), and the other
    for writing the address to the card when the interface was brought up
    (tulip_up).  I have fixed both, and here's the explanation:
    
    tulip_init_one:
    
    When reading the first 4 bytes of the address, inl() returns the same data
    to the CPU on all platforms, interpreting the data from the lowest port
    address as the least significant byte.  In other words, I/O is little
    endian on all platforms; it's the memory that differs across platforms.
    We want to write the data to memory preserving little-endianness of the
    PCI bus.  To force little endian write to the memory, the data should be
    converted to the little endian format.
    
    When reading the remaining 2 bytes, the CPU gets them in 2 least
    significant bytes.  To write those 2 bytes to the memory in a 16-bit
    operation, they should be byte-swapped for the 16-bit operation.
    
    tulip_up:
    
    The first 4 bytes are processed correctly, but the code is confusing.
    Reading from memory needs conversion to CPU format, while writing to I/O
    ports doesn't.  So I replaced cpu_to_le32() to le32_to_cpu().
    
    The second 2 bytes are read in a 16-bit memory operation, so they should
    be passed to le16_to_cpu() rather than cpu_to_le32() to make them CPU
    independent and suitable for outl().
    
    
    All those conversions do nothing on little-endian machines, so they should
    not be affected.
    
    The patch has been tested.  The driver is working fine.  ping is OK, ssh
    is OK, X11 over ssh is OK.  Even netconsole is working fine.

commit 0d61de3fac7db0d8df335d943a8c5aa8ccaa6aef
Author: Daniel Ritz <daniel.ritz@gmx.ch>
Date:   Mon Apr 19 05:02:52 2004 -0400

    [PATCH] missing s/dev->priv/netdev_priv(dev) in drivers/net/pcmcia/
    
    On Wednesday 24 March 2004 23:25, Jeff Garzik wrote:
    > Daniel Ritz wrote:
    > > clean up the last two instances of dev->priv in drivers/net/pcmcia.
    > > against 2.6.5-rc2-bk.
    > >
    > > --- 1.27/drivers/net/pcmcia/3c589_cs.c	Wed Mar  3 01:03:51 2004
    > > +++ edited/drivers/net/pcmcia/3c589_cs.c	Wed Mar 24 22:29:35 2004
    > > @@ -716,7 +716,7 @@
    > >  	  "status %4.4x.\n", dev->name, (long)skb->len,
    > >  	  inw(ioaddr + EL3_STATUS));
    > >
    > > -    ((struct el3_private *)dev->priv)->stats.tx_bytes += skb->len;
    > > +    ((struct el3_private *)netdev_priv(dev))->stats.tx_bytes += skb->len;
    > >
    > >      /* Put out the doubleword header... */
    > >      outw(skb->len, ioaddr + TX_FIFO);
    > > --- 1.24/drivers/net/pcmcia/ibmtr_cs.c	Wed Mar  3 01:06:03 2004
    > > +++ edited/drivers/net/pcmcia/ibmtr_cs.c	Wed Mar 24 22:29:51 2004
    > > @@ -444,7 +444,7 @@
    > >          link->state &= ~DEV_PRESENT;
    > >          if (link->state & DEV_CONFIG) {
    > >  	    /* set flag to bypass normal interrupt code */
    > > -	    ((struct tok_info *)dev->priv)->sram_virt |= 1;
    > > +	    ((struct tok_info *)netdev_priv(dev))->sram_virt |= 1;
    > >  	    netif_device_detach(dev);
    > >  	    ibmtr_release(link);
    >
    >
    > although the patch is OK, the code itself is a bit yucky.
    >
    > Can you please create a temporary variable, of struct el3_private or
    > tok_info type, and eliminate that cast?
    >
    > struct el3_private *priv = netdev_priv(dev);
    > priv->stats.tx_bytes += skb->len;
    >
    > Much nicer :)
    >
    
    agreed. here we go...

commit 513f042e5bbb6c89ea7d331a31887319b3dd76d5
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon Apr 19 05:01:38 2004 -0400

    [PATCH] Call SET_NETDEV_DEV() in a bunch of net drivers
    
    Used for sysfs support.

commit ece91eb208283881e1e9e69159e09d3361bfb78e
Author: Don Fry <brazilnut@us.ibm.com>
Date:   Mon Apr 19 05:00:12 2004 -0400

    [PATCH] pcnet32.c add support for 79C976
    
    Please apply the following patch to 2.6.5-rc2-bk9 and 2.4.26-rc1 to
    include support for the 79C976. Tested on IA32.

commit 4e21d3f587450f8d7a3442915616b8f4d4c67f93
Author: Stephen Hemminger <shemminger@osdl.org>
Date:   Mon Apr 19 05:00:04 2004 -0400

    [PATCH] remove 8139too ring size option.
    
    On Wed, 31 Mar 2004 15:05:16 -0500
    Jeff Garzik <jgarzik@pobox.com> wrote:
    
    > I really should remove the ability to configure 8139_RXBUF_IDX=3.

commit d54bf49a84d29dc3e6a32db65a8c95278b742a4d
Author: Javier Achirica <achirica@telefonica.net>
Date:   Mon Apr 19 04:58:55 2004 -0400

    [PATCH] airo: Fix suspend support

commit eb659532054ccc511621310cd5ad9998c88d9f33
Author: Russell King <rmk@arm.linux.org.uk>
Date:   Mon Apr 19 04:50:20 2004 -0400

    [PATCH] fix arm/etherh.c
    
    On Tue, Apr 13, 2004 at 02:35:40PM -0400, Jeff Garzik wrote:
    > Russell,
    >
    > Would you be willing to provide an updated diff of this?
    
    I didn't particularly like the PRIV() method implemented previously -
    gcc appears to want to avoid some optimisations it if its an inline
    function rather than a macro.
    
    Also, 'ei_local' may look unused in some functions, but it's your
    typical hidden-use-in-a-macro crap which 8390 likes.

commit 66dbee3519317165af92518fa4cc841731b2f238
Author: Stephen Hemminger <shemminger@osdl.org>
Date:   Mon Apr 19 04:49:10 2004 -0400

    [PATCH] Mixed PCI/ISA device name conflicts
    
    In systems with mixed network cards, and all drivers compiled into
    the kernel; the PCI device (eth0) will get probed first, before the ISA.
    
    The problem is that the ISA device can mistakenly try to probe
    for eth0.  The problem is that the ISA driver will not detect the failure
    until it goes to call register_netdevice, and not all drivers have
    perfect error unwind code.
    
    This patch short circuits the device probe, so it won't bother
    looking for devices that already are registered.

commit bf31652c0229b2724679e94db2e0d5f8c0a26756
Author: Chris Wright <chrisw@osdl.org>
Date:   Mon Apr 19 04:46:18 2004 -0400

    [PATCH] e1000: fix probable security hole
    
    * Ken Ashcraft (ken@coverity.com) wrote:
    > [BUG]
    > /home/kash/linux/linux-2.6.5/drivers/net/e1000/e1000_ethtool.c:1494:e1000_ethtool_ioctl: ERROR:TAINT: 1487:1494:Passing unbounded user value "(regs).len" as arg 2 to function "copy_to_user", which uses it unsafely in model [SOURCE_MODEL=(lib,copy_from_user,user,taintscalar)] [SINK_MODEL=(lib,copy_to_user,user,trustingsink)]    [PATH=]
    > 	}
    > 	case ETHTOOL_GREGS: {
    > 		struct ethtool_regs regs = {ETHTOOL_GREGS};
    > 		uint32_t regs_buff[E1000_REGS_LEN];
    >
    > Start --->
    > 		if(copy_from_user(&regs, addr, sizeof(regs)))
    > 			return -EFAULT;
    > 		e1000_ethtool_gregs(adapter, &regs, regs_buff);
    > 		if(copy_to_user(addr, &regs, sizeof(regs)))
    > 			return -EFAULT;
    >
    > 		addr += offsetof(struct ethtool_regs, data);
    > Error --->
    > 		if(copy_to_user(addr, regs_buff, regs.len))
    > 			return -EFAULT;
    >
    > 		return 0;
    
    Looks like a bug.  Possible patch below zeros the buffer (since it's not
    filled completely by e1000_ethtool_gregs()), and truncates len.

commit 27de746666f2ed03e0173f84b7e6ec7c751e4bbb
Author: Adrian Bunk <bunk@fs.tum.de>
Date:   Mon Apr 19 04:43:04 2004 -0400

    [PATCH] fix warning in drivers/net/tulip/timer.c
    
    I get the following warning in 2.6.5-mm6 and 2.6.6-rc1:
    
    <--  snip  -->
    
    ...
      CC      drivers/net/tulip/timer.o
    drivers/net/tulip/timer.c: In function `comet_timer':
    drivers/net/tulip/timer.c:156: warning: unused variable `ioaddr'
    ...
    
    <--  snip  -->
    
    
    Since the
       [netdrvr tulip] add MII support for Comet chips
    patch has removed the only use of this variable, the fix is simple:

commit 35fd5c4b9462b2629e2d2e6ae85c6d0951df09c8
Author: Jeff Garzik <jgarzik@redhat.com>
Date:   Mon Apr 19 04:42:41 2004 -0400

    [netdrvr r8169] remove driver-local DMA_xxBIT_MASK definitions
    
    They are now upstream, we don't need driver-local ones anymore.

commit 96f2c4a48f495cde4fb4524711340176d24fd4a9
Author: Jeff Garzik <jgarzik@redhat.com>
Date:   Mon Apr 19 04:41:18 2004 -0400

    [netdrvr rcpci] Remove bogus check in ->remove handler

commit 6242434842721d611ef02f42435fc0fff186bda8
Author: Jeff Garzik <jgarzik@redhat.com>
Date:   Mon Apr 19 04:39:30 2004 -0400

    [hamradio baycom] Remove bogus check in interrupt handler
    
    Tangentially noticed by Stanford checker.

commit 395ac66078fca638ca518ec875fb738d2c9f3d29
Author: Chris Wright <chrisw@osdl.org>
Date:   Mon Apr 19 04:38:01 2004 -0400

    [PATCH] remove redundant check in de2104x ->get_regs()
    
    Trivial patchlet...ethtool core already caps regs.len at a max of
    ->get_regs_len():
    
    	reglen = ops->get_regs_len(dev);
    	if (regs.len > reglen)
    		regs.len = reglen;
    
    So doing the same in the in de2104x driver ->get_regs() is redundant.
    Patch below simply removes it to clarify the guarantee of the API.

commit 98cd917c1ac348d5cd94beabecc3011dcaa0a0f2
Author: Chris Wright <chrisw@osdl.org>
Date:   Mon Apr 19 04:26:30 2004 -0400

    [PATCH] wan sdla:  fix probable security hole
    
    > [BUG] minor
    > /home/kash/linux/linux-2.6.5/drivers/net/wan/sdla.c:1206:sdla_xfer:
    > ERROR:TAINT: 1201:1206:Passing unbounded user value "(mem).len" as arg 0
    > to function "kmalloc", which uses it unsafely in model
    > [SOURCE_MODEL=(lib,copy_from_user,user,taintscalar)]
    > [SINK_MODEL=(lib,kmalloc,user,trustingsink)]  [MINOR]  [PATH=] [Also
    > used at, line 1219 in argument 0 to function "kmalloc"]
    > static int sdla_xfer(struct net_device *dev, struct sdla_mem *info, int
    > read)
    > {
    > 	struct sdla_mem mem;
    > 	char	*temp;
    >
    > Start --->
    > 	if(copy_from_user(&mem, info, sizeof(mem)))
    > 		return -EFAULT;
    >
    > 	if (read)
    > 	{
    > Error --->
    > 		temp = kmalloc(mem.len, GFP_KERNEL);
    > 		if (!temp)
    > 			return(-ENOMEM);
    > 		sdla_read(dev, mem.addr, temp, mem.len);
    
    Hrm, I believe you could use this to read 128k of kernel memory.
    sdla_read() takes len as a short, whereas mem.len is an int.  So,
    if mem.len == 0x20000, the allocation could still succeed.  When cast
    to short, len will be 0x0, causing the read loop to copy nothing into
    the buffer.  At least it's protected by a capable() check.  I don't
    know what proper upper bound is for this hardware, or how much it's
    used/cared about.  Simple memset() is trivial fix.

commit 3ce12aab463fc05cc70f3b844a06c7857d920781
Author: Jeff Garzik <jgarzik@redhat.com>
Date:   Mon Apr 19 04:22:28 2004 -0400

    [wireless orinoco] Remove bogus !dev check
    
    Caught by Stanford checker.

commit e059aa85572873685e1dabef068efe80a9cf38da
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon Apr 19 03:57:04 2004 -0400

    [PATCH] 3c509 oops fix
    
    If __ISAPNP__ and CONFIG_X86_PC9800 are not set, we forget to link the device
    into the global chain and el3_init_module dereferences NULL.

commit 0847467e17c7bbf1fb25bf7add3d8164a3129ddb
Author: Olaf Hering <olh@suse.de>
Date:   Mon Apr 19 03:56:56 2004 -0400

    [PATCH] mace register_netdev printk
    
    small cosmetic fix for powermac mace network driver.
    
    eth%d: MACE at 00:05:02:f4:1b:1d, chip revision 25.64
    vs.
    eth0: MACE at 00:05:02:f4:1b:1d, chip revision 25.64

commit ce4e5cd4df2bed02fb7dc2484a3838af5de7949f
Merge: a355eaa... 517acd7...
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Sun Apr 18 22:16:31 2004 -0700

    Merge master.kernel.org:/home/davem/BK/sparc-2.6
    into ppc970.osdl.org:/home/torvalds/v2.6/linux

commit 517acd7f1ea4605970fc0f09318c1be1c4ccad63
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 18 22:07:58 2004 -0700

    [PATCH] Warn if module_param and MODULE_PARM mixed
    
    From: Rusty Russell <rusty@rustcorp.com.au>
    
    From: Pavel Roskin <proski@gnu.org>
    
    If you use both module_param (new) and MODULE_PARM (obsolete) in a module,
    only the second gets recognised.  Warn.

commit 5acb75744f0442b4e6faa451a66e6b2d3e312769
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 18 22:07:44 2004 -0700

    [PATCH] nfs token table can be  __initdata
    
    nfs token table can be  __initdata

commit 2901f6ba8db12019d45f5d6e9cfd2db3c8f33290
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 18 22:07:33 2004 -0700

    [PATCH] sparc32 stack bounds checking
    
    From: William Lee Irwin III <wli@holomorphy.com>
    
    The stack is now shared with struct thread_info on most arches, not task_t.
    This mostly affects get_wchan() and stack usage debug.

commit 7bad0e6d55ed9c7ff2ec4fe312c40aa1b5a850bd
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 18 22:07:19 2004 -0700

    [PATCH] ppc32 stack bounds checking
    
    From: William Lee Irwin III <wli@holomorphy.com>
    
    The stack is now shared with struct thread_info on most arches, not task_t.
    This mostly affects get_wchan() and stack usage debug.

commit 34f77ac0dde78c5cdcbb4d80bd4d02e64166e907
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 18 22:07:08 2004 -0700

    [PATCH] m68knommu stack bounds checking
    
    From: William Lee Irwin III <wli@holomorphy.com>
    
    The stack is now shared with struct thread_info on most arches, not task_t.
    This mostly affects get_wchan() and stack usage debug.

commit 6fd0e1055dcecd6ead23f608f4968154449f4951
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 18 22:06:55 2004 -0700

    [PATCH] m68k stack bounds checking
    
    From: William Lee Irwin III <wli@holomorphy.com>
    
    The stack is now shared with struct thread_info on most arches, not task_t.
    This mostly affects get_wchan() and stack usage debug.

commit 8e9b32e77792589086a09abda17616cc9e0c585f
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 18 22:06:44 2004 -0700

    [PATCH] h8300 stack bounds checking
    
    From: William Lee Irwin III <wli@holomorphy.com>
    
    The stack is now shared with struct thread_info on most arches, not task_t.
    This mostly affects get_wchan() and stack usage debug.

commit 49c18faa72569c6b2dfdfa6a833aa2414e5e3b86
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 18 22:06:30 2004 -0700

    [PATCH] From: David Gibson <david@gibson.dropbear.id.au>
    
    hugepage_vma() is both misleadingly named and unnecessary.  On most archs it
    always returns NULL, and on IA64 the vma it returns is never used.  The
    function's real purpose is to determine whether the address it is passed is a
    special hugepage address which must be looked up in hugepage pagetables,
    rather than being looked up in the normal pagetables (which might have
    specially marked hugepage PMDs or PTEs).
    
    This patch kills off hugepage_vma() and folds the logic it really needs into
    follow_huge_addr().  That now returns a (page *) if called on a special
    hugepage address, and an error encoded with ERR_PTR otherwise.  This also
    requires tweaking the IA64 code to check that the hugepage PTE is present in
    follow_huge_addr() - previously this was guaranteed, since it was only called
    if the address was in an existing hugepage VMA, and hugepages are always
    prefaulted.

commit 3d9d1320db840f032f47b3ad1cd31dde18675057
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 18 22:06:16 2004 -0700

    [PATCH] Fix default value for commit interval for older reiserfs filesystems.
    
    From: Bart Samwel <bart@samwel.tk>
    
    The reiserfs patch that adds support for "commit=0" saves the default max
    commit age in a variable when the fs is originally mounted, so that it can
    later restore it.  Unfortunately it makes some mistakes with that:
    
    - The default is not saved when the original mount has a commit=NNN option.
    
    - The default is not correctly saved for older reiserfs filesystems, where
      the default was not stored on disk.
    
    This patch fixes these mistakes.

commit 59fed502a431f604111642f27bb7a64bd6719f46
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 18 22:06:03 2004 -0700

    [PATCH] direct-IO return type fixes
    
    From: me, Badari Pulavarty <pbadari@us.ibm.com>
    
    Currently a direct-IO read or write of more than 2G on 64-bit machines is
    broken.  Replace int with ssize_t in various places to fix that up.

commit fdc519457a3d4e49e3f8e22d8ea4dae79194a3d2
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 18 22:05:51 2004 -0700

    [PATCH] Increase number of dynamic inodes in procfs
    
    From: Nathan Lynch <nathanl@austin.ibm.com>
    
    On some larger ppc64 configurations /proc/device-tree is exhausting procfs'
    dynamic (non-pid) inode range (16K).  This patch makes the dynamic inode
    range 0xf0000000-0xffffffff and changes the inode number allocator to use
    the idr.c allocator for the first-fit allocations.

commit 178036e36fbec128450e39314a5042bb8a9af941
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 18 22:05:40 2004 -0700

    [PATCH] fix load_elf_binary error path on unshare_files error
    
    From: Chris Wright <chrisw@osdl.org>
    
    Make sure to return proper retval on unshare_files() error in load_elf_binary.
    
    Error noted by Kirill Korotaev <kirillx@7ka.mipt.ru>.

commit 8cc89540826b8426aaaef985c8d76443ceb9a990
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 18 22:05:29 2004 -0700

    [PATCH] idr.c: extra features enhancements
    
    From: Jim Houston <jim.houston@comcast.net>
    
    - Adds idr_get_new_above(), whihc permits us to do a first-fit search
      from a specified offset rather than always from zero.
    
    - Add IDR_INIT() DEFINE_IDR() constructors.  Often idr's are singletons
      and having to cook up an initcall for them is a pain.
    
    This is needed by the "Increase number of dynamic inodes in procfs" patch.

commit ef29bf03ef66e8c00f2917668ffb0c15e75bce8b
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 18 22:05:17 2004 -0700

    [PATCH] Rename PF_IOTHREAD to PF_NOFREEZE
    
    From: Nigel Cunningham <ncunningham@users.sourceforge.net>
    
    A few weeks ago, Pavel and I agreed that PF_IOTHREAD should be renamed to
    PF_NOFREEZE.  This reflects the fact that some threads so marked aren't
    actually used for IO while suspending, but simply shouldn't be frozen.
    This patch, against 2.6.5 vanilla, applies that change.  In the
    refrigerator calls, the actual value doesn't matter (so long as it's
    non-zero) and it makes more sense to use PF_FREEZE so I've used that.

commit 8488dd95ee9f05ba43f7f41e99ed34da00c313a6
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 18 22:05:02 2004 -0700

    [PATCH] CPU_MASK_ALL fix
    
    From: Nick Piggin <nickpiggin@yahoo.com.au>
    
    Do the typecast thing to permit CPU_MASK_ALL to be used both as an
    initialiser and as a normal rvalue.

commit eeb3e3b9e796443c999cd9e753ae766b26b7b58a
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 18 22:04:49 2004 -0700

    [PATCH] ppc/ppc64: Add posix message queue syscalls
    
    From: Benjamin Herrenschmidt <benh@kernel.crashing.org>
    
    This patch adds the posix message queue syscalls to ppc32 and 64 and fixes
    our implementation of compat copy siginfo to 32 bits userland which wasn't
    using the si_code but still doing a switch/case on the signal number.
    
    I also reserved some syscalls for the numa API

commit 987793dcac3ab8dfa05924a5baf42d4fcbf87668
Author: Brian Buesker <bbuesker@qualcomm.com>
Date:   Sun Apr 18 21:42:50 2004 -0700

    [IPSEC]: Add SPD priority for PF_KEY interface.

commit 297c5dee580093e646d3b734be47e79af27a86a0
Author: Herbert Xu <herbert@gondor.apana.org.au>
Date:   Sun Apr 18 21:42:10 2004 -0700

    [IPV6]: Prevent IPV6=m and IP6_NF_QUEUE=y

commit fbb39d77fec94c8b5f47630804df2ff3ba0280ef
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 18 21:41:20 2004 -0700

    [NET]: Fix pc300_drv warnings.

commit 85319bace4d665f8e3a9233f3c4aeb55ef566b78
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 18 21:40:41 2004 -0700

    [ATM]: Warning fix for lec.h

commit cc8995c1c65ca1b68662aa127029dca48eb68f23
Author: Sridhar Samudrala <sri@us.ibm.com>
Date:   Sun Apr 18 21:26:22 2004 -0700

    [SCTP] Propagate error from sctp_proc_init. (Olaf Kirch)

commit 7fb596b6e8229981d411cd73d66dddfdb56dcb51
Author: Andreas Jochens <aj@andaco.de>
Date:   Sun Apr 18 21:24:47 2004 -0700

    [TG3]: Fix typo in TG3_TSO_FW_RODATA_ADDR definition.

commit a355eaae9acd872e88eb3f8ae7a488d73c62b4ac
Merge: d5b1f48... 6af83b7...
Author: David S. Miller <davem@hera.kernel.org>
Date:   Sun Apr 18 21:19:10 2004 -0700

    Merge davem@nuts.davemloft.net:/disk1/BK/sparc-2.6
    into hera.kernel.org:/home/davem/BK/sparc-2.6

commit febb7e5dddc5103aa8f8fbb1bd19abd597bd8602
Author: Sridhar Samudrala <sri@us.ibm.com>
Date:   Sun Apr 18 20:58:26 2004 -0700

    [SCTP] Partial Reliability Extension support.

commit 982f0efd698f3a93257aab8fc50d002e46611e21
Author: Sridhar Samudrala <sri@us.ibm.com>
Date:   Sun Apr 18 20:46:21 2004 -0700

    [SCTP] Cleanup sctp_packet and sctp_outq infrastructure.

commit fe27663798f93789f23b7bcafcb5f8c9da09ec17
Author: Sridhar Samudrala <sri@us.ibm.com>
Date:   Sun Apr 18 20:36:56 2004 -0700

    [SCTP] Avoid the use of constant SCTP_IP_OVERHEAD to determine the
    max data size in a SCTP packet.
    
    Calculate the overhead based on the socket's protocol family header
    length.

commit 6af83b78ed4db43e176a779f1c34c20271acb343
Author: Jakub Jel√≠nek <jakub@redhat.com>
Date:   Sun Apr 18 20:35:59 2004 -0700

    [SPARC]: Add MQ syscall support.

commit 9c7df5bc4b96b333d76633f1a8add922cba3bb9f
Merge: a0df2f5... d5b1f48...
Author: Steve French <cifs.adm@hostme.bitkeeper.com>
Date:   Sun Apr 18 18:42:31 2004 -0700

    Merge bk://linux.bkbits.net/linux-2.5
    into hostme.bitkeeper.com:/repos/c/cifs/linux-2.5cifs

commit e1d642ef9d2a2efbac9ff7a99724238ae680b6e3
Merge: 3fd2eaa... 5a11095...
Author: David S. Miller <davem@nuts.davemloft.net>
Date:   Sun Apr 18 09:02:42 2004 -0700

    Merge nuts.davemloft.net:/disk1/BK/sparcwork-2.6
    into nuts.davemloft.net:/disk1/BK/sparc-2.6

commit d5b1f484632dcf7aeedd43d17eb576c2f498827c
Merge: a5d43dc... 53bfadf...
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Sun Apr 18 08:12:31 2004 -0700

    Merge bk://bk.arm.linux.org.uk/linux-2.6-rmk
    into ppc970.osdl.org:/home/torvalds/v2.6/linux

commit 53bfadf7e744055c68d25b41ce61e907a1734be6
Author: Russell King <rmk@flint.arm.linux.org.uk>
Date:   Mon Apr 19 00:32:07 2004 +0100

    [ARM] Clean up ARM includes
    
    This removes a number of unnecessary includes from the ARM specific
    files throughout the kernel.  Most notably asm/pgalloc.h is
    needlessly included in several places.  There were some places
    including it as a means to get at the cache flushing functions,
    so this has been corrected.

commit a5d43dcf7905c867c7c2b2a966f7700809679226
Author: Benjamin Herrenschmidt <benh@kernel.crashing.org>
Date:   Sun Apr 18 08:04:12 2004 -0700

    [PATCH] Fix typo in previous patch
    
    This is my brown paper bag day, I sent you the wrong patch for
    fixing the deadlock in rtas.c, here's one to apply on top of current
    bk that fixes build.

commit 3fd2eaadb3ebe7c03dc13fea3a021fbe92c15a90
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Sat Apr 17 22:18:59 2004 -0700

    Fix permission problem on include/video/neomagic.h

commit 29f9b4d82dfa98b80f5287bbf0c1652becbf23dd
Author: Geert Uytterhoeven <geert@linux-m68k.org>
Date:   Sat Apr 17 21:14:36 2004 -0700

    [PATCH] Amiga Zorro8390 Ethernet KERN_*
    
    Amiga Zorro8390 Ethernet: Add KERN_* prefixes to printk() messages

commit 0243dbb6d80d58bd9b7ac30c6768463902251de5
Author: Geert Uytterhoeven <geert@linux-m68k.org>
Date:   Sat Apr 17 21:14:22 2004 -0700

    [PATCH] Amiga Hydra Ethernet KERN_*
    
    Amiga Hydra Ethernet: Add KERN_* prefixes to printk() messages

commit d79459dafae977f2303af6c99abcb70646c8d765
Author: Geert Uytterhoeven <geert@linux-m68k.org>
Date:   Sat Apr 17 21:14:10 2004 -0700

    [PATCH] Amiga Ariadne Ethernet KERN_*
    
    Amiga Ariadne Ethernet: Add KERN_* prefixes to printk() messages

commit c934f504e6eba3c0dfc8d8a6e1a948f6894a44f0
Author: Geert Uytterhoeven <geert@linux-m68k.org>
Date:   Sat Apr 17 21:13:57 2004 -0700

    [PATCH] Amiga A2065 Ethernet debug
    
    Amiga A2065 Ethernet: Add missing variable in debug code

commit 2b2f6d9a772275562dd38e96b56fdf28e305e739
Author: Andrew Morton <akpm@osdl.org>
Date:   Sat Apr 17 20:56:22 2004 -0700

    [PATCH] fix visws build
    
    From: Andrey Panin <pazke@donpac.ru>
    
    this small patch fixes visws build error in 2.6.5.

commit 247aea288be034d9e3b04050b9676017c873f5f6
Author: Andrew Morton <akpm@osdl.org>
Date:   Sat Apr 17 20:56:09 2004 -0700

    [PATCH] Fix laptop mode writeback triggered by hdparm -y.
    
    From: Bart Samwel <bart@samwel.tk>
    
    Currently, an `hdparm -Y' can trigger a sync in laptop mode.  We should
    only count fs-originated requests as being "disk activity".

commit 4e79ee427ef9b9d15b8646da697259e95a16fd9d
Author: Andrew Morton <akpm@osdl.org>
Date:   Sat Apr 17 20:55:56 2004 -0700

    [PATCH] set_anon_super locking fix
    
    Take the idr's lock while removing an element on the error path.  Spotted by
    Nathan Lynch <nathanl@austin.ibm.com>.

commit 8eeff89bfa5b07f4688b78ab81e1879906574a66
Author: Andrew Morton <akpm@osdl.org>
Date:   Sat Apr 17 20:55:43 2004 -0700

    [PATCH] Print warning for common symbols in modules
    
    From: Rusty Russell <rusty@rustcorp.com.au>
    
    People still build modules wrong, particularly without -fno-common.  The
    resulting modules don't load, but we should at least warn about it.

commit 2c941f7702e963dc5902c70ddfd959b89bedbe8c
Author: Andrew Morton <akpm@osdl.org>
Date:   Sat Apr 17 20:55:31 2004 -0700

    [PATCH] jbd: journal_dirty_metadata locking speedup
    
    Reduce the locking coverage of the oft-used j_list_lock: the per-bh
    jbd_lock_bh_state() gives us sufficient locking of buffer_head and
    journal_head internals.

commit dd9fd0e03de648c6cc189adfc21d349f2a6b69b8
Author: Andrew Morton <akpm@osdl.org>
Date:   Sat Apr 17 20:55:18 2004 -0700

    [PATCH] rmap: nonlinear truncation
    
    From: Hugh Dickins <hugh@veritas.com>
    
    The earlier changes introducing PageAnon left truncated pages mapped into
    nonlinear vmas unswappable.  Once we go to object-based rmap, it's
    impossible to find where file page is mapped once page->mapping cleared:
    switching them to anonymous is odd, and breaks strict commit accounting.
    
    So now handle truncation of nonlinear vmas correctly.  And factor in
    Daniel's cluster filesystem needs while we're there: when invalidating
    local cache, we do want to unmap shared pages from all mms, but we do not
    want to discard private COWed modifications of those pages (which
    truncation discards to satisfy the SIGBUS semantics demanded by specs).
    
    Drew from Daniel's patch (LKML 2 Mar 04), but didn't always follow it;
    fewer name changes, but still some - "unmap" rather than "invalidate".
    zap_page_range is not exported, safe to give it and all the too-many layers
    an extra zap_details arg, in normal cases just NULL.
    
    Given details, zap_pte_range checks page mapping or index to skip anon or
    untruncated pages.  I didn't realize before implementing, that in nonlinear
    case, it should set a file pte when truncating - otherwise linear pages
    might appear in place of SIGBUS.  I suspect this implies that ->populate
    functions ought to set file ptes beyond EOF instead of failing, but haven't
    changed them as yet.
    
    To avoid making yet another copy of that ugly linear pgidx test, added
    inline function linear_page_index (to pagemap.h to get PAGE_CACHE_SIZE,
    though as usual things don't really work if it differs from PAGE_SIZE).
    Ooh, I thought I'd removed ___add_to_page_cache last time, do so now.
    
    unmap_page_range static, shift its hugepage check up into sole caller
    unmap_vmas.  Killed "killme" debug from unmap_vmas, not seen it trigger.
    unmap_mapping_range is exported without restriction: I'm one of those who
    believe it should be generally available.  But I'm wrongly placed to decide
    that, probably just sob quietly to myself if _GPL added later.

commit 3df9aaf34e68c9256b08d02ca65ced12bf9e8d9e
Author: Andrew Morton <akpm@osdl.org>
Date:   Sat Apr 17 20:55:06 2004 -0700

    [PATCH] rmap: swap_unplug page
    
    From: Hugh Dickins <hugh@veritas.com>
    
    Good example of "swapper_space considered harmful": swap_unplug_io_fn was
    originally designed for calling via swapper_space.backing_dev_info; but
    that way it loses track of which device is to be unplugged, so had to
    unplug all swap devices.  But now sync_page tests SwapCache anyway, can
    call swap_unplug_io_fn with page, which leads direct to the device.
    
    Reverted -mc4's CONFIG_SWAP=n fix, just add another NOTHING for it.
    Reverted -mc3's editorial adjustments to swap_backing_dev_info and
    swapper_space initializations: they document the few fields which are
    actually used now, as comment above them says (sound of slapped wrist).

commit c4d92e6b147b133848e8d89a734efdd2c3302d14
Author: Andrew Morton <akpm@osdl.org>
Date:   Sat Apr 17 20:54:52 2004 -0700

    [PATCH] rmap: flush_dcache revisited
    
    From: Hugh Dickins <hugh@veritas.com>
    
    One of the callers of flush_dcache_page is do_generic_mapping_read, where
    file is read without i_sem and without page lock: concurrent truncation may
    at any moment remove page from cache, NULLing ->mapping, making
    flush_dcache_page liable to oops.  Put result of page_mapping in a local
    variable and apply mapping_mapped to that (if we were to check for NULL
    within mapping_mapped, it's unclear whether to say yes or no).
    
    parisc and arm do have other locking unsafety in their i_mmap(_shared)
    searching, but that's a larger issue to be dealt with down the line.

commit 1896ae13fb37ccbd62aab739b4ee6ff2be9e21d9
Author: Andrew Morton <akpm@osdl.org>
Date:   Sat Apr 17 20:54:39 2004 -0700

    [PATCH] Oprofilefs cant handle > 99 cpus
    
    From: Anton Blanchard <anton@samba.org>
    
    Oprofilefs cant handle > 99 cpus. This should fix it.

commit 17ee20aef8a91f8692b76b1f0428619c5b4176d0
Author: Andrew Morton <akpm@osdl.org>
Date:   Sat Apr 17 20:54:27 2004 -0700

    [PATCH] Fix unix module
    
    From: Rusty Russell <rusty@rustcorp.com.au>
    
    # lsmod
    Module                  Size  Used by
    1                      26060  6
    #
    
    The compiler #define's unix to 1: we use -DKBUILD_MODNAME=unix.  We used to
    #undef unix at the top of af_unix.c, but now the name is inserted by
    modpost, that doesn't help.
    
    #undef unix in modpost.c's generated C file.

commit 26214e32af9e14d10cf558669cb7fdd6494e70ed
Author: Andrew Morton <akpm@osdl.org>
Date:   Sat Apr 17 20:54:15 2004 -0700

    [PATCH] ppc64: Fix CPU hot unplug deadlock
    
    From: Benjamin Herrenschmidt <benh@kernel.crashing.org>
    
    My RTAS locking fixes incorrectly added a spinlock around the function used
    to stop a CPU, that function never returns, thus the lock becomes stale.
    The correct fix is to disable interrupts instead (the RTAS params beeing
    per-CPU, this should be safe enough)

commit f5e277c5d5c6efcdde203d83ea8689d7e49f6576
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Sat Apr 17 20:51:30 2004 -0700

    Allow non-LFS sendfile to work on LFS files.
    
    But obviously only if we're not passing in any offset pointer.
    
    This is how 2.4.x worked, and vsftpd relies on it.
    
    Bug reported by Chris < chris@scary.beasts.org>

commit a9eb9eb7415c26c71a25a73bd0c734f397c8c021
Merge: e9fae7f... e4cf826...
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Sat Apr 17 20:47:28 2004 -0700

    Merge master.kernel.org:/home/davem/BK/net-2.6
    into ppc970.osdl.org:/home/torvalds/v2.6/linux

commit f6e8a90d6de9a279238be29f07b33b04d5cddb42
Author: Russell King <rmk@flint.arm.linux.org.uk>
Date:   Sun Apr 18 00:19:03 2004 +0100

    [ARM] Add detailed documentation concerning ARM page tables
    
    This adds detailed documentation concerning how we map the Linux
    page table structure onto the hardware tables on ARM.  In addition,
    it also adds documentation describing how we emulate the "dirty"
    and "young" or "accessed" page table bits.
    
    This should be of interest to Linux MM developers.

commit e4cf8264fa0bbc0b113442df03ceb9606d2ec428
Author: Hugh Dickins <hugh@veritas.com>
Date:   Sat Apr 17 03:50:14 2004 -0700

    [PATCH] Fix vma corruption
    
    It occurred to me that if vma and new_vma are one and the same, then
    vma_relink_file will not do a good job of linking it after itself - in
    that pretty unlikely case when move_page_tables fails.
    
    And more generally, whenever copy_vma's vma_merge succeeds, we have no
    guarantee that old vma comes before new_vma in the i_mmap lists, as we
    need to satisfy Rajesh's point: that ordering is only guaranteed in the
    newly allocated case.
    
    We have to abandon the ordering method when/if we move from lists to
    prio_trees, so this patch switches to the less glamorous use of
    i_shared_sem exclusion, as in my prio_tree mremap.

commit 3ba9ac07443fbcf68424a12daeadae36d2bc8b23
Author: Alexander Viro <viro@parcelfarce.linux.theplanet.co.uk>
Date:   Sat Apr 17 03:45:53 2004 -0700

    [PATCH] Remove unused 'kobject' from superblock
    
    The field in question is
      a) unused
      b) damn next to impossible to use correctly, due to struct super_block
         lifetime and locking rules.

commit f8f9945f3f2f8c617a1398033f0f509bdc5ba25f
Merge: 32ee9ee... 1ea0721...
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Sat Apr 17 03:44:47 2004 -0700

    Merge bk://bk.arm.linux.org.uk/linux-2.6-pcmcia
    into ppc970.osdl.org:/home/torvalds/v2.6/linux

commit 1ea0721d139249271889ee40352b1ef3db331195
Merge: 2dff057... c7a7273...
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Sat Apr 17 03:43:18 2004 -0700

    Merge bk://bk.arm.linux.org.uk/linux-2.6-serial
    into ppc970.osdl.org:/home/torvalds/v2.6/linux

commit 2dff05799af5c9317c08c8d71bb58197ccca14c5
Author: Russell King <rmk@flint.arm.linux.org.uk>
Date:   Sat Apr 17 13:08:39 2004 +0100

    [SERIAL] Use module_param/module_param_array
    
    Update serial to use new module parameters rather than
    MODULE_PARM.

commit ae1b4721427c6700b10a747b909828ddde287f5f
Author: Russell King <rmk@flint.arm.linux.org.uk>
Date:   Sat Apr 17 12:31:25 2004 +0100

    [SERIAL] Remove check_region()

commit c7a7273c34ffb0c84004de2ff09510e798caf7f4
Merge: f6e8a90... d8fbf4f...
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Sat Apr 17 03:41:41 2004 -0700

    Merge bk://bk.arm.linux.org.uk/linux-2.6-rmk
    into ppc970.osdl.org:/home/torvalds/v2.6/linux

commit 32ee9eec9f9e3eda7e5d948cd2c09127b15b1e90
Author: Pavel Roskin <proski@org.rmk.(none)>
Date:   Sat Apr 17 11:41:18 2004 +0100

    [PCMCIA] Conversion to module_param
    
    Patch from: Pavel Roskin
    
    As it turns out, mixing MODULE_PARM and module_param in one module is
    wrong.  The parameters specified in module_param are ignored.  I've just
    posted a patch to LKML that will detect this condition and warn about it.
    
    The new debugging code used the new-style module_param, which means that
    all instances of MODULE_PARM should be converted.  The attached patch does
    that.
    
    An additional bonus is that module_param_array provides the number of
    array elements.  This allowed me to change tcic.c and i82365.c to use
    this number for IRQ list.  This change was tested with i82365.  If
    "irq_list" is not specified, irq_list_count is 0.
    
    I set all permissions to 0444 to be safe.  I think we have no secrets
    from the users regarding those parameters.  If some parameters can be
    changed safely at the runtime, the permissions could be changed to 0644.
    I didn't examine how safe (and how useful) it would be, so it's 0444 for
    now.

commit d8fbf4f1d7a5dc45ccf426ce010061024e976a6c
Author: Andrew Morton <akpm@osdl.org>
Date:   Sat Apr 17 03:32:46 2004 -0700

    [PATCH] ARM-related ptep_to_address() fix
    
    From: William Lee Irwin III <wli@holomorphy.com>
    
    rmk mentioned that ARM was borked as the relation, assumed by generic rmap,
    PTRS_PER_PTE*sizeof(pte_t) == PAGE_SIZE, fails to hold.  The following
    patch, developed jointly with him (or depending on POV, by him with me
    acting as codemonkey), is reported to resolve the issue.
    
    Specifically, while ARM dedicates an entire PAGE_SIZE -sized block of
    memory to each PTE table, the PTE table itself only spans half that, the
    remainder being dedicated to hardware-interpreted structures.  As the
    hardware structure must be contiguous, wider ptes can't be used.  So the
    core-visible PTE table only spans PAGE_SIZE/2 bytes, violating the
    assumption.  This corrects masking and scaling done in ptep_to_address().

commit 5450c6c13e6ebb764c38aff386596741eb11d24d
Author: Andrew Morton <akpm@osdl.org>
Date:   Sat Apr 17 03:29:32 2004 -0700

    [PATCH] aty128fb dereference before null check
    
    From: Dave Jones <davej@redhat.com>

commit 25aa73df408537bcdbfcafd08ee2696b0db90edc
Author: Andrew Morton <akpm@osdl.org>
Date:   Sat Apr 17 03:29:22 2004 -0700

    [PATCH] mqueue permission fix
    
    From: Manfred Spraul <manfred@colorfullife.com>
    
    Any user can delete any entries in a mqueue mounted filesystem.  The attached
    patch prevents that.
    
    - remove the writable test from mq_unlink.
    
    - set the sticky bit in the root inode.  This affects both mq_unlink and
      sys_unlink: only the owner (and root) should be allowed to remove queues.

commit 485583e1488ed55b3ee2d52e4ef238ae647966d2
Author: Andrew Morton <akpm@osdl.org>
Date:   Sat Apr 17 03:29:12 2004 -0700

    [PATCH] Fix bogus get_page() calls in hugepage code
    
    From: David Gibson <david@gibson.dropbear.id.au>
    
    Some versions of follow_huge_addr() and follow_huge_pmd() are doing a
    get_page() on the target page.  They shouldn't: follow_page() returns an
    unpinned page and it is the caller's responsibility to pin the page (if
    desired) before dropping page_table_lock.

commit 9c59105ecf560ff59d4b923928f0e0ef4b82d05d
Author: Andrew Morton <akpm@osdl.org>
Date:   Sat Apr 17 03:29:02 2004 -0700

    [PATCH] ppc64: yet another hugepage cleanup
    
    From: David Gibson <david@gibson.dropbear.id.au>
    
    Trivial cleanup to flush_hash_hugepage() in the ppc64 hugepage code.

commit fbdae6e40f226683d3b1be709c9262036ce32a2e
Author: Andrew Morton <akpm@osdl.org>
Date:   Sat Apr 17 03:28:52 2004 -0700

    [PATCH] ipmi build fix
    
    From: Geert Uytterhoeven <geert@linux-m68k.org>
    
    While compiling drivers/char/ipmi/ipmi_si_intf.c in 2.6.6-rc1 on m68k, I
    noticed a missing include (needed for disable_irq_nosync() and enable_irq())

commit f36b42e76f560af5ca0f7ac345559f0fbb54c6d0
Author: Andrew Morton <akpm@osdl.org>
Date:   Sat Apr 17 03:28:36 2004 -0700

    [PATCH] floppy98.c build fixes
    
    From: "Randy.Dunlap" <rddunlap@osdl.org>
    
    floppy98.c (along with other PC-9800 files) has not been updated lately.  It
    won't build currently (2.6.5).
    
    This patch makes floppy98 build cleanly.

commit 13ba0403d5f32d53829926c5d35f22d7263734fb
Author: Andrew Morton <akpm@osdl.org>
Date:   Sat Apr 17 03:28:24 2004 -0700

    [PATCH] reiserfs: remove final sleep_on
    
    From: Chris Mason <mason@suse.com>
    
    Get rid of the last sleep_on in the reiserfs code

commit f2a0b4d83496a16e0744d422217644d9c9629bb4
Author: Andrew Morton <akpm@osdl.org>
Date:   Sat Apr 17 03:28:13 2004 -0700

    [PATCH] reiserfs: fsync() speedup
    
    From: Chris Mason <mason@suse.com>
    
    Updates the reiserfs-logging improvements to use schedule_timeout instead of
    yield when letting the transaction grow a little before forcing a commit for
    fsync/O_SYNC/O_DIRECT.
    
    Also, when one process forces a transaction to end and plans on doing the
    commit (like fsync), it sets a flag on the transaction so the journal code
    knows not to bother kicking the journal work queue.
    
    queue_delayed_work is used so that if we get a bunch of tiny transactions
    ended quickly, we aren't constantly kicking the work queue.
    
    These significantly improve reiserfs performance during fsync heavy
    workloads.

commit c4373a9a8415758b91a004293643d60e698d347c
Author: Andrew Morton <akpm@osdl.org>
Date:   Sat Apr 17 03:28:02 2004 -0700

    [PATCH] Add "commit=0" to reiserfs
    
    From: Bart Samwel <bart@samwel.tk>
    
    Add support for value 0 to the commit option of reiserfs.  Means "restore
    to the default value".  For the maximum commit age, this default value is
    normally read from the journal; this patch adds an extra variable to cache
    the default value for the maximum commit age.

commit 21c2358c7c6cd58322f0edca61dbfef4013fa123
Author: Andrew Morton <akpm@osdl.org>
Date:   Sat Apr 17 03:27:51 2004 -0700

    [PATCH] ppc64: hugepage cleanup
    
    From: David Gibson <david@gibson.dropbear.id.au>
    
    This is a small cleanup to the PPC64 hugepage code.  It removes an
    unhelpful function, removing some studlyCaps in the process.  It was
    originally this way to match the normal page path, but that has all been
    rewritten since.

commit 8886bdb02d844fd4790fc39397d9020deb2bc451
Author: Andrew Morton <akpm@osdl.org>
Date:   Sat Apr 17 03:27:40 2004 -0700

    [PATCH] Fix mq 32-bit compatibility
    
    From: Jakub Jelinek <jakub@redhat.com>
    
    The first change removes just a useless put_user (si_int and si_ptr are
    part of the same union, si_ptr is on all arches covering whole union), the
    rest is fixes for signal handling of SI_MESGQ.

commit 4f990f49474ef93e2b47f451cf289c9e30234e0f
Author: Andrew Morton <akpm@osdl.org>
Date:   Sat Apr 17 03:27:28 2004 -0700

    [PATCH] remove buffer_error()
    
    From: Jeff Garzik <jgarzik@pobox.com>
    
    It was debug code, no longer required.

commit d012f668272fe3dc39a66fc2ce90a04cb43e13d2
Author: Andrew Morton <akpm@osdl.org>
Date:   Sat Apr 17 03:27:17 2004 -0700

    [PATCH] PCI MSI Kconfig consolidation
    
    From: Bjorn Helgaas <bjorn.helgaas@hp.com>
    
    This consolidates the PCI MSI configuration into drivers/pci/Kconfig,
    removing it from the i386, x86_64, and ia64 Kconfig.
    
    It also changes the default for ia64 from "y" to "n".  The default on i386
    is "n" already, and I'm not sure why ia64 should be different.

commit 01d86f023be81c6b96cca5a3db2383469b0e7a41
Author: Andrew Morton <akpm@osdl.org>
Date:   Sat Apr 17 03:27:06 2004 -0700

    [PATCH] kill submit_{bh,bio} return value
    
    From: Jeff Garzik <jgarzik@pobox.com>
    
    Nobody ever checks the return value of submit_bh(), and submit_bh() is the
    only caller that checks the submit_bio() return value.
    
    This changes the kernel I/O submission path -- a fast path -- so this
    cleanup is also a microoptimization.

commit cba16655c63f8ed2f6d308d423ce0ce47b91c892
Author: Andrew Morton <akpm@osdl.org>
Date:   Sat Apr 17 03:26:55 2004 -0700

    [PATCH] kNFSdv4: Implement server-side reboot recovery (mostly)
    
    From: NeilBrown <neilb@cse.unsw.edu.au>
    
    From: "J. Bruce Fields" <bfields@fieldses.org>
    
    From: Andros: Implement server-side reboot recovery (server now handles
    open and lock reclaims).  Not completely to spec: we don't yet store the
    state in stable storage that would be required to recover correctly in
    certain situations.

commit b889edc78a2af540897a8f92581d9e15ceedf9bd
Author: Andrew Morton <akpm@osdl.org>
Date:   Sat Apr 17 03:26:39 2004 -0700

    [PATCH] kNFSdv4: Set credentials properly when puutrootfh is used
    
    From: NeilBrown <neilb@cse.unsw.edu.au>
    
    The credentials (uid/gid) of a process are set when a filehandle is
    verified.  Nfsv4 allows requests without an explicit filehandle (instead,
    an implicit 'root' filehandle) so we much make sure the credentials are set
    for these requests too.
    
    From: "J. Bruce Fields" <bfields@fieldses.org>
    
    From: Andros: added a call to nfsd_setuser in nfsd4_putrootfh so that nfsd
    runs as the rpc->cred user.

commit 9e13fc5b846a973fce0302d72e6db0802bc7fd69
Author: Andrew Morton <akpm@osdl.org>
Date:   Sat Apr 17 03:26:28 2004 -0700

    [PATCH] kNFSdv4: Improve how locking copes with replays
    
    From: NeilBrown <neilb@cse.unsw.edu.au>
    
    From: "J. Bruce Fields" <bfields@fieldses.org>
    
    From: Andros: Hold state_lock longer so the stateowner doesn't diseappear
    out from under us before we get the chance to encode the replay.  Don't
    attempt to save replay if we failed to find a stateowner.

commit 3145847e3f7177f6690aa64ea1c9f33d8b75a827
Author: Andrew Morton <akpm@osdl.org>
Date:   Sat Apr 17 03:26:12 2004 -0700

    [PATCH] kNFSdv4: Allow locku replays aswell
    
    From: NeilBrown <neilb@cse.unsw.edu.au>
    
    From: "J. Bruce Fields" <bfields@fieldses.org>
    
    From: Andros: locku replies should be saved for possible replay as well.

commit 599692fc635da0e613702fbde2c1ccbd427c6d2f
Author: Andrew Morton <akpm@osdl.org>
Date:   Sat Apr 17 03:25:57 2004 -0700

    [PATCH] kNFSdv4: Keep state to allow replays for 'close' to work.
    
    From: NeilBrown <neilb@cse.unsw.edu.au>
    
    From: "J. Bruce Fields" <bfields@fieldses.org>
    
    From: Andros: Idea is to keep around a list of openowners recently released
    by closes, and make sure they stay around long enough so that replays still
    work.

commit 020e39c532f4d1983b0c7828b655a8a27301288b
Author: Andrew Morton <akpm@osdl.org>
Date:   Sat Apr 17 03:25:42 2004 -0700

    [PATCH] kNFSdv4: Fix bad error returm from svcauth_gss_accept
    
    From: NeilBrown <neilb@cse.unsw.edu.au>
    
    From: "J. Bruce Fields" <bfields@fieldses.org>
    
    Error return when the client supplies a bad service should be badcred.

commit 065eae6c389ef6d5d1a09d03ec3d1f201aec5424
Author: Andrew Morton <akpm@osdl.org>
Date:   Sat Apr 17 03:25:31 2004 -0700

    [PATCH] kNFSdv4: nfsd4_readdir fixes
    
    From: NeilBrown <neilb@cse.unsw.edu.au>
    
    From: "J. Bruce Fields" <bfields@fieldses.org>
    
    Fix out-of-spec errors in nfs4 readdir.  Add checks for bad cookie values.
    
    (plus compile fix from akpm)

commit 44e2317eea9a41cdb383d212ce05317522878874
Author: Andrew Morton <akpm@osdl.org>
Date:   Sat Apr 17 03:25:21 2004 -0700

    [PATCH] dm: Use an EMIT macro in the status function.
    
    From: Kevin Corry <kevcorry@us.ibm.com>
    
    Striped: Use an EMIT macro in the status function.

commit 702a8edf677582f42d16eb27f767baf21df5d329
Author: Andrew Morton <akpm@osdl.org>
Date:   Sat Apr 17 03:25:10 2004 -0700

    [PATCH] dm: avoid ioctl buffer overrun
    
    From: Kevin Corry <kevcorry@us.ibm.com>
    
    dm-ioctl.c::retrieve_status(): Prevent overrunning the ioctl buffer by making
    sure we don't call the target status routine with a buffer size limit of
    zero.  [Kevin Corry, Alasdair Kergon]

commit e79ed99a7914f7c0792243dc7cd1a8af9baed58e
Author: Andrew Morton <akpm@osdl.org>
Date:   Sat Apr 17 03:24:54 2004 -0700

    [PATCH] dm: fix a comment
    
    From: Kevin Corry <kevcorry@us.ibm.com>
    
    Clarify the comment regarding the "next" field in struct dm_target_spec.  The
    "next" field has different behavior if you're performing a DM_TABLE_STATUS
    command than it does if you're performing a DM_TABLE_LOAD command.
    
    See populate_table() and retrieve_status() in drivers/md/dm-ioctl.c for more
    details on how this field is used.

commit e1489536b4ea1269c25364febb6c104963e191c0
Author: Andrew Morton <akpm@osdl.org>
Date:   Sat Apr 17 03:24:39 2004 -0700

    [PATCH] dm: Correctly align the dm_target_spec structures during retrieve_status().
    
    From: Kevin Corry <kevcorry@us.ibm.com>
    
    Correctly align the dm_target_spec structures during retrieve_status().

commit ca6cf8bf54c475bdae563502a3acce27c61ec617
Author: Andrew Morton <akpm@osdl.org>
Date:   Sat Apr 17 03:24:28 2004 -0700

    [PATCH] dm: Log an error if the target has unknown target type, or zero length.
    
    From: Kevin Corry <kevcorry@us.ibm.com>
    
    Log an error if the target has unknown target type, or zero length.

commit fa89976375d5c68b15400401773764f440a466e7
Author: Andrew Morton <akpm@osdl.org>
Date:   Sat Apr 17 03:24:16 2004 -0700

    [PATCH] dm: Use wake_up() rather than wake_up_interruptible()
    
    From: Kevin Corry <kevcorry@us.ibm.com>
    
    dm.c: Use wake_up() rather than wake_up_interruptible() with the eventq.

commit 2daba2224dbd2791b593e73b6200c59731b38da6
Author: Andrew Morton <akpm@osdl.org>
Date:   Sat Apr 17 03:24:04 2004 -0700

    [PATCH] dm: Handle interrupts within suspend.
    
    From: Kevin Corry <kevcorry@us.ibm.com>
    
    Handle interrupts within suspend.

commit 8ceccffc783f4848ba06417ee569cce66ee7d214
Author: Andrew Morton <akpm@osdl.org>
Date:   Sat Apr 17 03:23:52 2004 -0700

    [PATCH] dm: Check the uptodate flag in sub-bios to see if there was an error.
    
    From: Kevin Corry <kevcorry@us.ibm.com>
    
    Check the uptodate flag in sub-bios to see if there was an error.  [Mike
    Christie]

commit abfd0ec555be01df13a9e38ba543c2ed377df7cf
Author: Andrew Morton <akpm@osdl.org>
Date:   Sat Apr 17 03:23:39 2004 -0700

    [PATCH] dm: Fix 64/32 bit ioctl problems.
    
    From: Kevin Corry <kevcorry@us.ibm.com>
    
    Fix 64/32 bit ioctl problems.

commit bea63af0ef1dfa0ac32814f3ee67ec4aa96d57bc
Author: Petr Vandrovec <vandrove@vc.cvut.cz>
Date:   Sat Apr 17 03:08:23 2004 -0700

    [PATCH] Fix exec in multithreaded application
    
    The recent controlling terminal changes broke exec from multithreaded
    application because de_thread was not upgraded to new arrangement.  I
    know that I should not have LD_PRELOAD library which automatically
    creates one thread, but it looked like a cool solution to the problem I
    had.
    
    de_thread must initialize the controlling terminal information in the
    new thread group.

commit a0df2f5cac2e1eed0f7e975fd2cc682db9a51db9
Merge: 8e0e956... 3b32207...
Author: Steve French <cifs.adm@hostme.bitkeeper.com>
Date:   Fri Apr 16 17:53:46 2004 -0700

    Merge bk://linux.bkbits.net/linux-2.5
    into hostme.bitkeeper.com:/repos/c/cifs/linux-2.5cifs

commit f3995c320482f63fae6bcd350ff2ab0d99827d20
Author: Len Brown <len.brown@intel.com>
Date:   Fri Apr 16 14:03:45 2004 -0400

    [ACPI] enable 440GX PIRQ router workaround

commit b1841e5ba6b5e1ff771d1d8b8d114f911ed1c9aa
Author: Dave Jones <davej@redhat.com>
Date:   Fri Apr 16 18:41:34 2004 +0100

    [CPUFREQ] Not all powernow-K7 BIOS's put the frequency at MAX at POST.

commit e9fae7f4e0d3e4eaedb8922ed48c93a08fd7ebae
Merge: eb30e17... 3b32207...
Author: David S. Miller <davem@nuts.davemloft.net>
Date:   Fri Apr 16 08:50:51 2004 -0700

    Merge nuts.davemloft.net:/disk1/BK/network-2.6
    into nuts.davemloft.net:/disk1/BK/net-2.6

commit eb30e17b76311e26b47bfd3a4ef70dd2cffbf295
Author: David S. Miller <davem@nuts.davemloft.net>
Date:   Fri Apr 16 08:29:09 2004 -0700

    [IPV6]: Fix esp6.c typo in LIMIT_NETDEBUG changes.

commit 3b32207738936ea61c3d796ae4840e70b5fc21d5
Merge: 757fd8a... 92a16de...
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Fri Apr 16 03:50:41 2004 -0700

    Merge evo:v2.6/linux into ppc970.osdl.org:/home/torvalds/v2.6/linux

commit 92a16de9ca6fab675fa67f83ae35466c43a22022
Author: Linus Torvalds <torvalds@evo.osdl.org>
Date:   Fri Apr 16 03:49:32 2004 -0700

    Add sparse __safe annotation

commit 6ff18bfff615d73bf3ca6f818036a4b34f6d8311
Author: Linus Torvalds <torvalds@evo.osdl.org>
Date:   Fri Apr 16 03:48:52 2004 -0700

    Make sock_no_{get|set}opt() use the proper __user annotation

commit 8e0e956d27f582385eb7e6150056cbc0e1db12e1
Merge: 3811a94... 757fd8a...
Author: Steve French <cifs.adm@hostme.bitkeeper.com>
Date:   Fri Apr 16 03:32:36 2004 -0700

    Merge bk://linux.bkbits.net/linux-2.5
    into hostme.bitkeeper.com:/repos/c/cifs/linux-2.5cifs

commit 757fd8a625124aa886ab31bcb62646da323b1bf8
Author: Marcel Holtmann <marcel@holtmann.org>
Date:   Fri Apr 16 02:18:05 2004 -0700

    [PATCH] Fix typo in the openpromfs remount patch
    
    The just merged openpromfs remount patch contains a silly typo in the
    field of the super_operations structure.
    
    Fixed like this.

commit 0874802cd174e9770b98d8a10ea93aefd7323d85
Merge: 32686b9... d63bce0...
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Fri Apr 16 02:17:28 2004 -0700

    Merge bk://gkernel.bkbits.net/misc-2.6
    into ppc970.osdl.org:/home/torvalds/v2.6/linux

commit 32686b9d8bc6001d7365caa517adef393548021d
Merge: 532de20... fc252a2...
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Fri Apr 16 02:16:31 2004 -0700

    Merge bk://gkernel.bkbits.net/net-drivers-2.6
    into ppc970.osdl.org:/home/torvalds/v2.6/linux

commit 532de20cdce829c1af0f53eb01389005f2bc5966
Merge: fcd93c9... a9403f0...
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Fri Apr 16 02:15:36 2004 -0700

    Merge bk://gkernel.bkbits.net/libata-2.6
    into ppc970.osdl.org:/home/torvalds/v2.6/linux

commit fc252a2b4ef0ba7783511f7cb1d532f75d08f03e
Author: Don Fry <brazilnut@us.ibm.com>
Date:   Fri Apr 16 05:01:59 2004 -0400

    [PATCH] pcnet32 transmit performance fix
    
    When the pcnet32 adapter is installed in a system with long PCI latency
    and the read burst bit is not set, performance on transmission is very
    low (under 20Mbit on a 100Mbit link).  This patch against 2.6.6-rc1 will
    make sure that read and write bursts are enabled.  Tested on ppc64 and
    ia32.

commit 73da2ff683cb51fa5f6590a0d97b23d41b8d524c
Author: Jeff Garzik <jgarzik@redhat.com>
Date:   Fri Apr 16 05:01:32 2004 -0400

    [netdrvr via-rhine] Fix MII phy scanning
    
    Noticed by Roger Luethi, via-rhine maintainer.

commit 1e785100aac62a5ce0e467d6cc504b8e7f1d3bc5
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri Apr 16 04:59:08 2004 -0400

    [PATCH] amd8111e retval fix
    
    drivers/net/amd8111e.c: In function `amd8111e_vlan_rx':
    drivers/net/amd8111e.c:677: warning: control reaches end of non-void function

commit 86014f1b6c5d06f063c2cc89d93387e583a65833
Merge: fbd532e... ce99046...
Author: Jeff Garzik <jgarzik@redhat.com>
Date:   Fri Apr 16 04:55:41 2004 -0400

    Merge redhat.com:/spare/repo/netdev-2.6/misc
    into redhat.com:/spare/repo/net-drivers-2.6

commit 281100563c6565e302d835fac10e22fa86444b75
Author: David S. Miller <davem@nuts.davemloft.net>
Date:   Fri Apr 16 01:55:37 2004 -0700

    [BRIDGE]: br_fdb.c needs init.h

commit fcd93c96df287c9631b2066ed16f9f0299b67f7e
Merge: 71aa96e... 6819f2c...
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Fri Apr 16 01:14:24 2004 -0700

    Merge bk://bk.arm.linux.org.uk/linux-2.6-rmk
    into ppc970.osdl.org:/home/torvalds/v2.6/linux

commit 6819f2cb551dd5dfbd85b0dbb6509928386b8aa3
Author: Russell King <rmk@flint.arm.linux.org.uk>
Date:   Sat Apr 17 00:09:02 2004 +0100

    [ARM] Add __user address space identifiers for sparse.

commit 859f08ee961a27559371b823e5f55716cd7bb8f6
Author: Russell King <rmk@flint.arm.linux.org.uk>
Date:   Sat Apr 17 00:02:08 2004 +0100

    [ARM] Update mach-types file.

commit e251f65f428cb783b6c9a6b97876405e02507852
Author: Russell King <rmk@flint.arm.linux.org.uk>
Date:   Fri Apr 16 23:54:40 2004 +0100

    [ARM] Remove needless export of __do_softirq()

commit eecf6c1b4c441f2b641da3bbd65484dfcb3e021a
Author: Russell King <rmk@flint.arm.linux.org.uk>
Date:   Fri Apr 16 17:27:18 2004 +0100

    [ARM] Add --no-undefined to linker command line.
    
    Many binutils versions over the last year appear to silently build
    assembler files with undefined constants, and able to successfully
    create executables from such files.  The assembler appears to add
    undefined symbols to the symbol table without any corresponding
    relocation information.  Obviously this is bad news since the
    resulting executable may not be what the programmer intended.
    Work around the problem by forcing the linker to fail if there are
    any undefined symbols in the final object(s).

commit 71aa96e98eccce31f89fb531c04d65be548ec593
Merge: c6026d0... cbbf50f...
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Fri Apr 16 01:05:17 2004 -0700

    Merge master.kernel.org:/home/davem/BK/tg3-2.6
    into ppc970.osdl.org:/home/torvalds/v2.6/linux

commit cbbf50f07d825f22c65110c858b0ea355ba2e7ac
Author: Dave Jones <davej@redhat.com>
Date:   Fri Apr 16 01:03:33 2004 -0700

    [PATCH] Fix mprotect bogus check.
    
    If we want to trap NULL vma's, we'd better be sure
    that we don't dereference it first..

commit 62b6df250b3b7c0866e8d7402e522105b19a7a19
Author: Dave Jones <davej@redhat.com>
Date:   Fri Apr 16 01:03:20 2004 -0700

    [PATCH] Fix edd driver dereferencing before pointer checks.
    
    Lots of occurences of the same bug..

commit bb1c650217a64bf011aeb55b03c7a73471039c85
Author: Bartlomiej Zolnierkiewicz <b.zolnierkiewicz@elka.pw.edu.pl>
Date:   Fri Apr 16 01:03:09 2004 -0700

    [PATCH] ide-probe.c: SanDisk is flash
    
    From: Meelis Roos <mroos@linux.ee>
    
    This is self-explanatory - former SunDisk renamed itself to SanDisk and
    now there are flash disks with both names.

commit b4d95eb3435fdd89eede127bf3c43923e89716b6
Author: Stephen Hemminger <shemminger@osdl.org>
Date:   Fri Apr 16 00:59:31 2004 -0700

    [NET]: Fix lapbether bad scheduling while atomic.
    
    Bring up/down network devices with lapbether causes scheduling while
    atomic (if preempt enabled).
    
    The calls to rcu_read_lock are unnecessary since lapb_device_event
    is called from notifier with the rtnetlink semaphore held, it is
    already protected from the labp_devices list changing.

commit 60e45e04e297d1d3056f86f6f0a5bbd4b630b456
Author: Noriaki Takamiya <takamiya@po.ntts.co.jp>
Date:   Fri Apr 16 00:53:50 2004 -0700

    [IPV6]: Fix OOPS in udp6 with extension headers using ancillary data.

commit 7e2baac6153e54236cc11f6bee0241b13c716134
Author: Masahide Nakamura <nakam@linux-ipv6.org>
Date:   Fri Apr 16 00:52:22 2004 -0700

    [IPV6]: Fix IPSEC AH typo.

commit c1b816ec4dbcc2d03ec6167f5f487c2a4690b727
Author: Hideaki Yoshifuji <yoshfuji@linux-ipv6.org>
Date:   Fri Apr 16 00:51:15 2004 -0700

    [IPV6]: Use IANA icmpv6 type for MLDv2 report.

commit ec7d884beb3dd5bc7a7e7fee282f5f0b7daf579e
Author: Jean Tourrilhes <jt@bougret.hpl.hp.com>
Date:   Fri Apr 16 00:50:17 2004 -0700

    [IRDA]: Replace sleep_on with wait_event
    
    From Stephen Hemminger.

commit 63777167c24e0a4112ba41cee2e345d9a361924b
Author: Jean Tourrilhes <jt@bougret.hpl.hp.com>
Date:   Fri Apr 16 00:49:46 2004 -0700

    [IRDA]: irlan_eth cleanup.
    
    Use IrTTP flow control to stop/wake netif
      From Stephen Hemminger.
    Change irlan_eth device initialization:
    *bug* address never set in DIRECT mode because access not set
          in alloc_netdev -> irlan_eth_setup path
    + make eth_XXX handles static and provide alloc_irlandev hook
    + use netdev_priv (and get rid of truly impossible ASSERT's)
    + use skb_queue_purge

commit 6a0642d8776e9a3a875d6d35895653682dcc3ae8
Author: Jean Tourrilhes <jt@bougret.hpl.hp.com>
Date:   Fri Apr 16 00:48:29 2004 -0700

    [IRDA]: irlan_common cleanup.
    
    Minor type changes in irlan_common for clarity:
    - use const
    - init and exit can be static
    - use skb_queue_purge to flush queue
    - get rid of noisy old comment
    
    From Stephen Hemminger.

commit c408d7e510c8499f79cd5e4fcd3a1423faae7ce4
Author: Jean Tourrilhes <jt@bougret.hpl.hp.com>
Date:   Fri Apr 16 00:47:38 2004 -0700

    [IRDA]: Rename handle_filter_request to irlan_filter_request.
    
    From Stephen Hemminger.

commit a58379ac1b34e01c177c2876a5dccede8d75ce5b
Author: Jean Tourrilhes <jt@bougret.hpl.hp.com>
Date:   Fri Apr 16 00:47:03 2004 -0700

    [IRDA]: Fix namespace pollution of print_ret_code.
    
    From Stephen Hemminger.

commit dc17955e2dfc68847c582fab4269c5305e46eee2
Author: Jean Tourrilhes <jt@bougret.hpl.hp.com>
Date:   Fri Apr 16 00:46:32 2004 -0700

    [IRDA]: Get rid of local CRC table in donauboe.
    
    From Stephen Hemminger.

commit 461fa1023511ebf6a017036ea7f929671c7e83a9
Author: Jean Tourrilhes <jt@bougret.hpl.hp.com>
Date:   Fri Apr 16 00:45:58 2004 -0700

    [IRDA]: Fix handling of RD:RSP to be spec compliant
    
    From Martin Diehl.

commit bc206d40dba5cbb115ad50396f04a9f9d885e8a0
Author: Jean Tourrilhes <jt@bougret.hpl.hp.com>
Date:   Fri Apr 16 00:45:26 2004 -0700

    [IRDA]: Convert vlsi_ir /proc/driver to seq_file.
    
    From Stephen Hemminger.

commit 5a11095b1f8bec3b96e7dcf6205fd45611549f6d
Author: Meelis Roos <mroos@linux.ee>
Date:   Fri Apr 16 00:30:18 2004 -0700

    [SPARC64]: Fix binfmt_elf32.c warning by redefining TASK_SIZE.

commit 6a0e29ef195d9cd2769101efa63a5fc4031e9ae3
Author: Alexander Viro <viro@www.linux.org.uk>
Date:   Fri Apr 16 00:27:54 2004 -0700

    [PATCH] remount: mount flags filtering
    
     - we could pass MS_ACTIVE in mount flags and it would be passed into
       ->get_sb(), leading to interesting failure modes.  This flag is only
       for internal use (it's set once fill_super is complete and reset
       before the inode eviction on umount); made sure that we never get
       tricked into having it set it too early.

commit 8636df83d3d577f0f1d7e72246998f3912ef03da
Author: Alexander Viro <viro@www.linux.org.uk>
Date:   Fri Apr 16 00:27:41 2004 -0700

    [PATCH] remount: forced-nodiratime filesystems
    
     - a bunch of filesystems force MS_NODIRATIME on mount but forgot to do
       the same on remount.  Fixed.

commit 360ee2d5d39a2dfc88d9d6ac63da6c1bb4402bfe
Author: Alexander Viro <viro@www.linux.org.uk>
Date:   Fri Apr 16 00:27:28 2004 -0700

    [PATCH] remount: forced-ro filesystems
    
     - a bunch of r/o filesystems did force MS_RDONLY on mount but forgot to
       do the same on remount.  Fixed.

commit b7a7eb6ea03b62c195273eb50d4b9fe909914403
Author: Alexander Viro <viro@www.linux.org.uk>
Date:   Fri Apr 16 00:27:14 2004 -0700

    [PATCH] remount: fs/jffs2
    
     - jff2->remount_fs() was buggy - it played with sb->s_flags instead of
       doing modifications to *flags (->s_flags will be overwritten using
       *flags right after the call of ->remount_fs()).  Moreover, it tried
       to do the wrong thing - it should just enforce noatime and be done
       with that.  Fixed, ACKed by maintainer.

commit f3745470c237c5ca8ae2a2fa51617cabf79e60c6
Author: Alexander Viro <viro@www.linux.org.uk>
Date:   Fri Apr 16 00:27:00 2004 -0700

    [PATCH] remount: fs/openpromfs
    
     - we should force noatime both on mount and remount.  Fixed.

commit 9eafdd135d0dc55174c343e8b4f80ee73b8737eb
Author: Alexander Viro <viro@www.linux.org.uk>
Date:   Fri Apr 16 00:26:48 2004 -0700

    [PATCH] remount: fs/udf fixes
    
     - same problem as with sysv - mount-time checks for fs being good for
       writing are absent on remount.  Check added.

commit 466341bae2c891e86c0e2d4c64a890e51b158c1c
Author: Alexander Viro <viro@www.linux.org.uk>
Date:   Fri Apr 16 00:26:34 2004 -0700

    [PATCH] remount: fs/sysv fixes
    
     - several variants of sysv fs are supported only r/o.  Driver does
       force r/o on mount, but doesn't do anything on remount.  As the
       result, one can remount them r/w and results are Not Pretty(tm).
       Missing checks added, code cleaned up.
    
     - we had double-brelse() in v7fs - if sanity checks on root inode will
       succeed, but allocation of root dentry fails, we brelse() the same
       buffer_head twice.  Fixed.

commit 8f9ba4e7409ba859d01bd90496c8e4d623db6e54
Author: Stephen Hemminger <shemminger@osdl.org>
Date:   Fri Apr 16 00:23:28 2004 -0700

    [BRIDGE]: Replace CLEAR_BITMAP with memset.

commit 20b6126e34cc8cab028a6312be3d503daa88cd07
Author: Stephen Hemminger <shemminger@osdl.org>
Date:   Fri Apr 16 00:22:49 2004 -0700

    [BRIDGE]: FDB cache alloc.
    
    Since forwarding database gets a lot of memory alloc/free on a busy
    bridge, use kmem_cache_alloc to provide cache and better stats.

commit f93a354b921041c70b5c6335e0b0d0abfce3f49f
Author: Stephen Hemminger <shemminger@osdl.org>
Date:   Fri Apr 16 00:21:57 2004 -0700

    [BRIDGE]: Support lots of 1k ports.
    
    Support >256 ports on a bridge.  Use the suggestion of reducing
    the number of bits of priority and increasing the number of bits
    for port number.
    
    Easy to increase to even larger if necessary.

commit 48134e548024d265edb113b6170e76d2a67622b2
Author: Stephen Hemminger <shemminger@osdl.org>
Date:   Fri Apr 16 00:21:12 2004 -0700

    [BRIDGE]: STP unsigned fields.
    
    Use correct types for fields related to spanning tree protocols.
      * costs are 32 bit unsigned
      * ports are 16 bit unsigned
      * booleans are bytes rather than bitfield
      * arrange for better packing

commit 5c648dca17cbe6be1b1a0f3fe5f0542cf79c65cd
Author: Stephen Hemminger <shemminger@osdl.org>
Date:   Fri Apr 16 00:19:54 2004 -0700

    [BRIDGE]: Forwarding database changes.
    
    Make forwarding database more robust.
      + Don't insert invalid ether address,
      + Report errors back so adding an interface to bridge can fail
      + get rid of unneeded explicit pads in data structure
      + replace bitfields with byte's for simple booleans.

commit 045b897431e39d926ace8c46bac58acc4a3e2d34
Author: Stephen Hemminger <shemminger@osdl.org>
Date:   Fri Apr 16 00:15:24 2004 -0700

    [BRIDGE]: Multicast address as const.

commit 3de1c3716726b8dbb8c2edd28de57a6aba73bf10
Author: Stephen Hemminger <shemminger@osdl.org>
Date:   Fri Apr 16 00:14:41 2004 -0700

    [BRIDGE]: Use ethtool to get port speed.
    
    The bridge code needs to keep track of a cost estimate for each
    port in the bridge.  Instead of a hack based on device name, try
    and use ethtool to get port speed from device.  This has been tested
    on e100 (uses ethtool_ops) and e1000 (does ethtool the hard way)
    and dummy (no ethtool).
    
    Need to export dev_ethtool() to allow bridge module to get to
    it easily.
    
    Code takes care to maintain same locking and semantics as if ioctl
    was being done from application.

commit ef443d0f02bb66d8ed4976e459ddd11b8b1407b7
Author: Stephen Hemminger <shemminger@osdl.org>
Date:   Fri Apr 16 00:13:29 2004 -0700

    [BRIDGE]: Make use of jiffies_to_clock.

commit 597ae14899c9c77b523544b52d78adadad2b5089
Author: Stephen Hemminger <shemminger@osdl.org>
Date:   Fri Apr 16 00:12:55 2004 -0700

    [BRIDGE]: Fix rmmod race.
    
    Fix observed race between removing bridge module and ip packets
    in flight.  Need to remove the hook last, after all bridges are gone
    not the other way around.

commit 6223c7b9ef285484807296574f50121008d96e59
Author: Stephen Hemminger <shemminger@osdl.org>
Date:   Fri Apr 16 00:11:59 2004 -0700

    [BRIDGE]: Include file cleanup.
    
    Cleanup some of the include file's in the bridge code.
    * if_bridge.h defines net_bridge, but not needed as part of the API.
    * get rid of places that include if_bridge.h and uaccess.h but don't
      actually do API work.

commit c6026d08ee512cde6dff61e4dfc15f0e04a16476
Merge: eccf6f1... 0a4a188...
Author: David S. Miller <davem@nuts.davemloft.net>
Date:   Fri Apr 16 00:05:19 2004 -0700

    Merge nuts.davemloft.net:/disk1/BK/tg3work-2.6
    into nuts.davemloft.net:/disk1/BK/tg3-2.6

commit 64b0f9e29e5a4b02077d0d048865e7bd44036715
Author: Arjan van de Ven <arjanv@redhat.com>
Date:   Thu Apr 15 23:56:23 2004 -0700

    [NET]: Add some sparse annotations to network driver stack.

commit ea38ba8c40b4b81991112d792387d739951bbd1f
Author: Andi Kleen <ak@suse.de>
Date:   Thu Apr 15 23:55:01 2004 -0700

    [IPV6]: Limit network triggerable printks.

commit 7c9c0ff60eb9d4b0524f81ae15152f544439e360
Author: Andi Kleen <ak@suse.de>
Date:   Thu Apr 15 23:49:08 2004 -0700

    [NET]: Do lazy gettimeofday for network packets.

commit a09f2c119ae2df7bcb95ba41964193459e30dbef
Author: Martin Pool <mbp@vexed.ozlabs.hp.com>
Date:   Thu Apr 15 23:37:58 2004 -0700

    [PATCH] ia64: fpswa_interface needs to be exported
    
    efivars can be built as a module, but it depends on 'fpswa_interface'
    which is not exported by fpswa.c.  Patch below fixes this problem.

commit 3811a94211fb801f87a18143237459c3139f4f9b
Author: Steve French <stevef@stevef95.austin.ibm.com>
Date:   Fri Apr 16 01:20:24 2004 -0500

    Remove 64 bit compiler warning

commit 7539add64e203010d993dcb3053f767cace23088
Merge: b0e15db... 50dc875...
Author: Ben Collins <bcollins@debian.org>
Date:   Fri Apr 16 01:39:18 2004 -0400

    Merge http://linux.bkbits.net/linux-2.5
    into debian.org:/usr/src/kernel/ieee1394-2.6

commit 588edddc8a46ed3ddc77320b1d86b7991b3c21e3
Author: David S. Miller <davem@nuts.davemloft.net>
Date:   Thu Apr 15 22:30:50 2004 -0700

    [SPARC64]: Fix branch prediction in switch_to().

commit eccf6f14dabaa5aa012400c14c0cbb05a8c4c345
Merge: 0180f94... 516e49e...
Author: David S. Miller <davem@nuts.davemloft.net>
Date:   Thu Apr 15 21:36:57 2004 -0700

    Merge

commit 0180f9469d14877d9912d126e3e9dced4382f5be
Merge: 2160211... e180d34...
Author: David S. Miller <davem@nuts.davemloft.net>
Date:   Thu Apr 15 20:39:56 2004 -0700

    Merge nuts.davemloft.net:/disk1/BK/net-2.6.6
    into nuts.davemloft.net:/disk1/BK/net-2.6

commit 2160211c3a9f0f6f3b9a0a5998b74ee9be30ce3e
Merge: 583953a... 6264f96...
Author: David S. Miller <davem@nuts.davemloft.net>
Date:   Thu Apr 15 20:37:13 2004 -0700

    Merge.

commit a9ff99a8d7609029a5d0f9e346b9c866ade9b11e
Merge: 9a7aaef... 583953a...
Author: Steve French <cifs.adm@hostme.bitkeeper.com>
Date:   Thu Apr 15 17:47:47 2004 -0700

    Merge bk://linux.bkbits.net/linux-2.5
    into hostme.bitkeeper.com:/repos/c/cifs/linux-2.5cifs

commit 583953a5146bc419c630089ae9f17c178e0a1eb1
Merge: 9add6ea... 6de145d...
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Thu Apr 15 17:01:03 2004 -0700

    Merge master.kernel.org:/home/davem/BK/sparc-2.6
    into ppc970.osdl.org:/home/torvalds/v2.6/linux

commit 9add6eadb287262382fff1915930b6008b17e8dd
Merge: b0e15db... 3caef8d...
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Thu Apr 15 16:58:40 2004 -0700

    Merge bk://bk.linux1394.org/ieee1394-2.6
    into ppc970.osdl.org:/home/torvalds/v2.6/linux

commit 3caef8d2279a602ff48865fa6938915f03436ebd
Merge: 87d6f51... 07f7a9e...
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Thu Apr 15 16:56:30 2004 -0700

    Merge bk://linuxusb.bkbits.net/d
    into ppc970.osdl.org:/home/torvalds/v2.6/linux

commit 87d6f5143f07b225ae69bc0a1a9e4331a9a13f4f
Author: Benjamin Herrenschmidt <benh@kernel.crashing.org>
Date:   Thu Apr 15 16:55:37 2004 -0700

    [PATCH] ppc64: Fix RTAS races on pSeries
    
    The low level kernel interface to RTAS (the firmware runtime services)
    was plagued with races that could cause from bogus results of RTAS
    operations to total machine crashes in some circumstances. This patch
    fix the ones I could identify, hoping I didn't miss any. I also added
    a WARN_ON (well, it's asm equivalent) to enter_rtas to make sure we
    never _ever_ try to call that with interrupts enabled.

commit 514fb5be0ba392dbc524f56f307d2c48227e7065
Author: Anton Blanchard <anton@samba.org>
Date:   Thu Apr 15 16:53:12 2004 -0700

    [PATCH] ppc64: always initialise dn->type and dn->name
    
    This fix comes from ppc32. Always initialise dn->type and dn->name so
    that code doesnt have to check for NULL everywhere. There is at least
    one bug report where we oopsed because of this.

commit 8509eb5efb18c9b09bc2a934f24691fb1a1ba349
Author: Anton Blanchard <anton@samba.org>
Date:   Thu Apr 15 16:52:58 2004 -0700

    [PATCH] ppc64: catch branch to 0 in real mode
    
    We have been debugging some strange fails where we branch to 0 in real
    mode. At the moment this results in the cpu running through the
    initialisation code and failing somewhere well into it.
    
    The following patch uses the featuring nop'ing code to remove the branch
    at real address 0 so it falls through to a trap instruction and gets
    caught early.

commit 50dc875a406c647631acaa56bbcc13ce856e3d9c
Author: Adam Goode <adam@evdebs.org>
Date:   Thu Apr 15 16:44:35 2004 -0700

    [PATCH] NMI watchdog Pentium M support
    
    This adda nmi_watchdog=2 support to the Pentium M processor.  The P-M is
    a P6 chip, but it shares some chipset logic with the Pentium 4, so it
    requires this workaround to function.
    
    Without this patch, NMI gets stuck after 1 count.  With it, the NMI
    fires and breaks me out of UHCI-related hard lockups.
    
    This patch is basically a modified version of the same patch for
    oprofile. See the threaded discussion here:
    
    	http://lkml.org/lkml/2004/2/12/181

commit 9a7aaef711020c9b072b5ed3cb4f2218cf518b59
Author: Steve French <stevef@smfhome.smfdom>
Date:   Thu Apr 15 12:17:31 2004 -0500

    check permission locally for servers that do not support the CIFS Unix Extensions (allowing file_mode and dir_mode to augment the
    server permission check, by doing local vfs_permission check)

commit 6de145dc6176fb8704bfa26c91682c5aa2adec4a
Author: David S. Miller <davem@nuts.davemloft.net>
Date:   Thu Apr 15 09:55:02 2004 -0700

    [IXGB]: ixgb.h needs dma-mapping.h

commit d7caa791227e4c49308e2aeee47d8a8e1b52ffa4
Author: David S. Miller <davem@nuts.davemloft.net>
Date:   Thu Apr 15 09:54:31 2004 -0700

    [E1000]: e1000.h needs dma-mapping.h

commit b0e15db00565280e7be262437c6fc13217c864c2
Merge: 162ed08... bd6b55b...
Author: Ben Collins <bcollins@debian.org>
Date:   Thu Apr 15 11:28:52 2004 -0400

    Merge http://linux.bkbits.net/linux-2.5
    into debian.org:/usr/src/kernel/ieee1394-2.6

commit e3404d5fddbe07d22bcf25948bb544b1b84f467e
Merge: c0fc6f2... 162ed08...
Author: Steve French <cifs.adm@hostme.bitkeeper.com>
Date:   Thu Apr 15 05:09:11 2004 -0700

    Merge bk://linux.bkbits.net/linux-2.5
    into hostme.bitkeeper.com:/repos/c/cifs/linux-2.5cifs

commit c0fc6f25cd62309b78f23f1f97991d338a804ca9
Merge: 5abccd4... 8b55008...
Author: Steve French <stevef@stevef95.austin.ibm.com>
Date:   Thu Apr 15 08:02:12 2004 -0500

    Merge bk://cifs.bkbits.net/linux-2.5cifs
    into stevef95.austin.ibm.com:/usr/src/bk/linux-2.5cifs

commit 8b55008840573c0c8d307c2c540e3820e01df551
Author: Steve French <stevef@stevef95.austin.ibm.com>
Date:   Thu Apr 15 07:51:05 2004 -0500

    Fix major page leak in read code caused by extra page_cache_get call

commit 162ed0824be3d5e3662b0d4f19e4239920b49f72
Author: Geert Uytterhoeven <geert@linux-m68k.org>
Date:   Wed Apr 14 21:57:06 2004 -0700

    [PATCH] Amiga Zorro8390 Ethernet section conflict
    
    Jeff Garzik notes that the previous cleanup highlights a bug:
    >
    > 	static const struct card_info {
    > 	    zorro_id id;
    > 	    const char *name;
    > 	    unsigned int offset;
    > 	} cards[] __initdata = {
    >
    > and the lone user is __devinit:
    >
    > static int __devinit zorro8390_init_one(struct zorro_dev *z,
    >                                        const struct zorro_device_id *ent)
    
    Here's the fix..

commit 8aabc781b2143b6ab8161e415ad4429ced811880
Author: James Bottomley <james.bottomley@steeleye.com>
Date:   Wed Apr 14 21:56:52 2004 -0700

    [PATCH] fix non-PC subarchs which were broken by i386 probe_roms change
    
    The author apparently didn't understand that only the mach-default
    include directory is included by fallback for header files only.  You
    can't stick a .c file in mach-default and expect all subarchs to be able
    to use it.
    
    The correct fix is to put std_resources.c in the kernel directory and
    give it its own Kconfig symbol for conditional compile so that subarchs
    may choose to include it or not.

commit fbd532e3977a9c785b9fb2c7f9b698febaaf3a6a
Author: Michal Schmidt <xschmi00@stud.feec.vutbr.cz>
Date:   Wed Apr 14 20:29:23 2004 -0700

    [PATCH] USB: Fix vicam debug compile, fix user access
    
    The last copy_from_user patch to the vicam driver broke compilation with
    VICAM_DEBUG on.
    
    There is also another copy_from_user missing in case VIDIOCSPICT.
    
    This fixes both issues.

commit 96a750f54e89860ebfcfbd873b576e7bf5b26b31
Merge: abb33de... c608aed...
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Wed Apr 14 20:24:09 2004 -0700

    Merge bk://linuxusb.bkbits.net/pci-2.6
    into ppc970.osdl.org:/home/torvalds/v2.6/linux

commit c608aedd5ae37592960476b2d96c0f2b8d719dcf
Author: James Bottomley <james.bottomley@steeleye.com>
Date:   Wed Apr 14 19:20:00 2004 -0700

    [PATCH] fix 4k irqstacks on x86 (and add voyager support)
    
    There's a bug in the x86 code in that it sets the boot CPU to zero.
    
    This isn't correct since some subarch's use physically indexed CPUs.
    However, subarchs have either set the boot cpu before irq_INIT() (or
    just inherited the default zero from INIT_THREAD_INFO()), so it's safe
    to believe current_thread_info()->cpu about the boot cpu.

commit 07f7a9e85f229974bb4b8bd16d7a34560e5e01d4
Merge: 39d6ca0... 53387be...
Author: Greg Kroah-Hartman <greg@kroah.com>
Date:   Wed Apr 14 18:39:55 2004 -0700

    Merge kroah.com:/home/greg/linux/BK/bleed-2.6
    into kroah.com:/home/greg/linux/BK/driver-2.6

commit abb33def14b8e204464d12cd9247b987bef53cd6
Merge: 39d6ca0... 8c8079c...
Author: Greg Kroah-Hartman <greg@kroah.com>
Date:   Wed Apr 14 18:22:54 2004 -0700

    merge

commit 39d6ca017f9ef6c8e7d03a805a28a6d86d0e3c44
Author: Benjamin Herrenschmidt <benh@kernel.crashing.org>
Date:   Wed Apr 14 17:04:22 2004 -0700

    [PATCH] ppc64: update g5_defconfig
    
    This adds IOMMU support & IOMU virtual merging to the default g5 config.
    
    This will not impair performances of machines that don't need the iommu
    (the kernel will only enable it if you have more than 2Gb of RAM, though
    you can explicitely enable it using a command line argument).

commit cc8a7ced219e199fc522a82acff2582701b2c304
Author: Benjamin Herrenschmidt <benh@kernel.crashing.org>
Date:   Wed Apr 14 17:04:10 2004 -0700

    [PATCH] ppc64: Fix possible duplicate MMU hash entries
    
    The current code has a subtle race where 2 hash PTEs can be inserted
    for the same virtual address for a short period of time. There should
    not be a stale one as the "old" one ultimately gets flushed, but the
    architecture specifies that having two hash PTE is illegal and can
    result in undefined behaviour.
    
    This patch fixes it by never clearing the _PAGE_HASHPTE bit when
    doing test_and_clear_{young,dirty}. That means that subsequent faults
    on those pages will have a bit more overhead to "discover" that the
    hash entry was indeed evicted.
    
    It also adds a small optisation to avoid doing the atomic operation
    and the hash flush in test_and_clear_dirty when the page isn't dirty
    or when setting write protect while it's already set.

commit 95c49c775434596184dd0f1a6dbd1e048055b500
Author: Andrew Morton <akpm@osdl.org>
Date:   Wed Apr 14 17:03:54 2004 -0700

    [PATCH] posix messages queues for s390.
    
    From: Martin Schwidefsky <schwidefsky@de.ibm.com>
    
    The new message queue interface needs the following patch to get it working
    on s390 (31-bit, 64-bit and 31-bit compat).

commit 76620e0942dcd81f0e02ca4b531ee785995cb5ac
Author: Andrew Morton <akpm@osdl.org>
Date:   Wed Apr 14 17:03:43 2004 -0700

    [PATCH] light-weight auditing framework for s390.
    
    From: Martin Schwidefsky <schwidefsky@de.ibm.com>
    
    This patch adds the TIF_SYSCALL_AUDIT option to the s390 ptrace interface.

commit 302be020ed7c9115cab9f2de84a946ce289e2931
Author: Andrew Morton <akpm@osdl.org>
Date:   Wed Apr 14 17:03:32 2004 -0700

    [PATCH] Add mqueue support to x86-64
    
    From: Andi Kleen <ak@suse.de>
    
    Add POSIX mqueue support to x86-64.

commit 2df2c24aa6d2cd56777570d96494b921568b4405
Author: Andrew Morton <akpm@osdl.org>
Date:   Wed Apr 14 17:03:20 2004 -0700

    [PATCH] ext3: journalled quotas
    
    From: Jan Kara <jack@ucw.cz>
    
    Journalled quota support for ext3: The patch consists of two parts - ext3
    changes and changes in generic quota code.  The main idea of the changes is
    that a transaction is always started before any operation which changes quota
    file and dirtifying of the quota causes its write to disk.  These two changes
    assure that quota change is journalled into the same transaction as the file
    change and hence after journal replay quota is consistent with the filesystem
    state.  As during journal replay inodes from orphan list are deleted/truncated
    we have to do quota_on before the replay of the orphan list - this problem is
    solved by additional mount options to ext3 with quota file names and format.
    
    Some changes in generic code were also needed to assure that quota structure
    in file is always allocated and so ordinary quota operations (like
    adding/deleting a block/inode) need only a few blocks from the transaction.

commit 6ea4e45463726b8a5adcba50315b3bec4ea78a1e
Author: Andrew Morton <akpm@osdl.org>
Date:   Wed Apr 14 17:03:05 2004 -0700

    [PATCH] mq_open() and close_on_exec
    
    From: Chris Wright <chrisw@osdl.org>
    
    SUSv3 doesn't seem to specify one way or the other.  I don't have the POSIX
    specs, and the old docs I have suggest that mq_open() creates an object
    which is to be closed upon exec.
    
    Jakub said:
    
      I think it is valid and required:
    
        http://www.opengroup.org/onlinepubs/007904975/functions/exec.html
    
        All open message queue descriptors in the calling process shall be
        closed, as described in mq_close()
    
      I'll add a new test for this into glibc testsuite.

commit ae931b63bab89b28010cf9b0f16d12cdb4dbd08d
Author: Andrew Morton <akpm@osdl.org>
Date:   Wed Apr 14 17:02:51 2004 -0700

    [PATCH] radix-tree comment fix
    
    Fix various bogons and outright lies.

commit 4c5385148b60b9c88df8635ceb6ec81a49cab0ab
Author: Andrew Morton <akpm@osdl.org>
Date:   Wed Apr 14 17:02:37 2004 -0700

    [PATCH] Fix mq_notify with SIGEV_NONE notification
    
    From: Jakub Jelinek <jakub@redhat.com>
    
    	mq_notify (q, NULL)
    
    and
    	struct sigevent ev = { .sigev_notify = SIGEV_NONE };
    	mq_notify (q, &ev)
    
    are not the same thing in POSIX, yet the kernel treats them the same.  Only
    the former makes the notification available to other processes immediately,
    see
    
    	http://www.opengroup.org/onlinepubs/007904975/functions/mq_notify.html
    
    Without the patch below,
    
    	http://sources.redhat.com/ml/libc-hacker/2004-04/msg00028.html
    
    glibc test fails.
    
    I looked at mq in Solaris and they behave the same in this regard as Linux
    with this patch.  Kernel with this patch passes both Intel POSIX testsuite
    (with testsuite fixes from Ulrich) and glibc mq testsuite.

commit 14e8b22d8a953a9cdf1db5f3ae61564f3cf782f7
Author: Dave Jones <davej@redhat.com>
Date:   Thu Apr 15 00:26:47 2004 +0100

    [CPUFREQ] clear defaults before powernow-k7 acpi fallback
    Decoding the legacy tables may have set these values.

commit 8a9a9b4e965b9e00ca0d92c5c28842f1f2ddd7da
Author: Dave Jones <davej@redhat.com>
Date:   Thu Apr 15 00:22:30 2004 +0100

    [CPUFREQ] powernow-k7 ACPI->PST values were a factor of 10 off.
    As much as I like the idea of a 13GHz laptop, setting it to 1.3GHz is probably
    for the best for the time being.

commit 449d887bb4c7eb6bb313c36b2e2bf6e7838b1b93
Author: Dave Jones <davej@redhat.com>
Date:   Thu Apr 15 00:20:31 2004 +0100

    [CPUFREQ] Make powernow-k7 acpi debug output a little less verbose.

commit 968e73537362d40d22fe804de5bf737dd6004dfe
Author: Dave Jones <davej@redhat.com>
Date:   Thu Apr 15 00:18:39 2004 +0100

    [CPUFREQ] Add a module parameter to force ACPI to be used.

commit bce44e9f1382a5bec5009c92eea420b6fb4eec06
Author: Dave Jones <davej@redhat.com>
Date:   Wed Apr 14 20:21:08 2004 +0100

    [CPUFREQ] Remove bogus newline in powernow-k7 driver.

commit d63bce0550760bbde8ed65cffbdb91b1e36cb5d5
Merge: 62e88cf... aa617bb4...
Author: Jeff Garzik <jgarzik@redhat.com>
Date:   Wed Apr 14 14:34:22 2004 -0400

    Merge redhat.com:/spare/repo/linux-2.6
    into redhat.com:/spare/repo/misc-2.6

commit 798e2cdee942868f467766e894d14a95fa50998f
Merge: 45f96af... 21a0a7b...
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Wed Apr 14 11:25:59 2004 -0700

    Merge master.kernel.org:/home/davem/BK/sparc-2.6
    into ppc970.osdl.org:/home/torvalds/v2.6/linux

commit a9403f0ab02d745580df89865bdb07afa17b74a5
Author: Jeff Garzik <jgarzik@redhat.com>
Date:   Wed Apr 14 13:04:48 2004 -0400

    [libata sata_promise] fix taskfile delivery cases
    
    We should only be touching the ATA shadow registers if we are doing
    PIO.

commit 702287312f8ad8c0a969877f85083f8cb4858e88
Author: Jeff Garzik <jgarzik@redhat.com>
Date:   Wed Apr 14 13:04:35 2004 -0400

    [libata] move some PIO state init to its proper place

commit fdb36f50e7fea070f8924a3f1d06f5d06cbe8871
Author: Jeff Garzik <jgarzik@redhat.com>
Date:   Wed Apr 14 13:03:15 2004 -0400

    [libata] abstract SCSI->ATA translation a bit

commit de78c311dfcd2adfda3da8e7eb3b02f31f7f4277
Author: Dave Jones <davej@redhat.com>
Date:   Wed Apr 14 17:15:56 2004 +0100

    [CPUFREQ] powernow-k7 needs to init later.
    Due to the possible dependancy on ACPI.

commit 77d4fd7801fee7250ac85d593bf52672b4b6b369
Author: Dave Jones <davej@redhat.com>
Date:   Wed Apr 14 17:14:35 2004 +0100

    [CPUFREQ] Drop unneeded part of last patch.
    acpi fallback is handled already in the init function.

commit 18b6dc79f7422cea81135537eeabdeff39dd6053
Author: Dave Jones <davej@redhat.com>
Date:   Wed Apr 14 15:26:15 2004 +0100

    [CPUFREQ] powernow-k7 ACPI integration.
    More from Bruno Ducrot.
    
    Warning: it will only half work on the ACER Aspire, though: there is
    no pstate in the DSDT corresponding to the max frequency...
    I'm looking how to handle that correctly, probably at the init stage,
    if the max frequency is not given, then add it to powernow_table.
    
    * Integrate acpi perflib from Dominik.
    * Use acpi if the PST tables are known to be broken (ASUS Aspire match one PST,
      but give brain damaged values), or use ACPI if no PST found.

commit 1bc0ea3b091a10db86fc68d6d6797aa8a7e08880
Author: Dave Jones <davej@redhat.com>
Date:   Wed Apr 14 14:22:15 2004 +0100

    [CPUFREQ] don't use speedstep-centrino on unsupported CPUs
    
    From: Dominik Brodowski <linux@dominikbrodowski.de>
    
    Don't use the ACPI data on CPUs we don't know nothing about.

commit 92b51edaca98ac62cea48d30dfd27745135ba7c3
Merge: 4d72de2... 7b34955...
Author: Dave Jones <davej@delerium.codemonkey.org.uk>
Date:   Wed Apr 14 13:49:47 2004 +0100

    Merge delerium.codemonkey.org.uk:/mnt/nfs/sepia/bar/src/kernel/2.6/trees/bk-linus
    into delerium.codemonkey.org.uk:/mnt/nfs/sepia/bar/src/kernel/2.6/trees/cpufreq

commit 7b349554c7a0e21bc21e8f622d5455880448ba5b
Author: Dave Jones <davej@redhat.com>
Date:   Wed Apr 14 13:40:42 2004 +0100

    [CPUFREQ] Correcting SGTC.  Timer is based upon FSB
    From: Bruno Ducrot <ducrot@poupinou.org>
    
    I think this patch is needed especially if the FSB is around 166MHz or
    200MHz, or else I believe we get instabilities on some K7's motherboard
    powernow capable (it's called Cool'n Quiet IIRC).
    
    
    * Deduce fsb from cpu_khz and the max multiplier.  It will be given as kHz now,
      so that frequency associated to a multiplier will be computate more
      accurately.  Also, we need it for SGTC (see below).
    * Fix how cpuid is computed in powernow_decode_bios().
    * Be more restrictive for PST.  It may be possible (on desktop shipped with
      low power Athlon models) that FSB can be changed by dip switchs on
      motherboard for example.
    * Fix computation for SGTC.  It use the bus timer (and then the bus
      frequency given by fsb).

commit 3006d859d40ea1615fe53873a4367c0d7d8cf57c
Author: Steve French <stevef@stevef95.austin.ibm.com>
Date:   Wed Apr 14 06:45:54 2004 -0500

    free cifs read buffer on retry

commit 5abccd42336bb55ab9343ab4dc4e652284e7a987
Merge: 3006d85... 5d4bb59...
Author: Steve French <cifs.adm@hostme.bitkeeper.com>
Date:   Wed Apr 14 04:43:59 2004 -0700

    Merge bk://linux.bkbits.net/linux-2.5
    into hostme.bitkeeper.com:/repos/c/cifs/linux-2.5cifs

commit 5d4bb599d8bc0e53eb6ee1e2049353f34c66c0f2
Merge: 62e88cf... fb320b9...
Author: Jeff Garzik <jgarzik@redhat.com>
Date:   Wed Apr 14 12:50:03 2004 -0400

    Merge redhat.com:/spare/repo/netdev-2.6/janitor
    into redhat.com:/spare/repo/net-drivers-2.6

commit 21a0a7b13ed9de877e765c250bc0fe2f107bf139
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Wed Apr 14 04:31:20 2004 -0700

    Linux 2.6.6-rc1

commit f4b6700062a62cbfe7de71f61d35508613126494
Author: Len Brown <len.brown@intel.com>
Date:   Wed Apr 14 05:15:03 2004 -0400

    [ACPI] fix x86_64 mis-merge

commit 62e88cfdeabf75516364a9ab914c4120b4a25221
Merge: 340de76... de2bd6e...
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Wed Apr 14 01:47:05 2004 -0700

    Merge bk://linuxusb.bkbits.net/i2c-2.6
    into ppc970.osdl.org:/home/torvalds/v2.6/linux

commit 340de76c4bed374f0913872b188fa519ac3b756b
Merge: 491a0f4... e19cd00...
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Wed Apr 14 01:12:43 2004 -0700

    Merge bk://linuxusb.bkbits.net/usb-2.6
    into ppc970.osdl.org:/home/torvalds/v2.6/linux

commit 491a0f428301ebf9d63f955695e31014d13d54b9
Merge: 7635947... e86f59c...
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Wed Apr 14 01:11:34 2004 -0700

    Merge bk://bk.arm.linux.org.uk/linux-2.6-serial
    into ppc970.osdl.org:/home/torvalds/v2.6/linux

commit e86f59c38f2b1ac0bdd12e59ca563232b43b4309
Author: Deepak Saxena <dsaxena@net.rmk.(none)>
Date:   Wed Apr 14 20:39:05 2004 +0100

    [ARM PATCH] 1810/1: Support for non-PXA XScale UARTs
    
    Patch from Deepak Saxena
    
    Supersedes 1809/1

commit 157c0342e591acff4b80ad2869ab7702b40e69d5
Author: Russell King <rmk@flint.arm.linux.org.uk>
Date:   Wed Apr 14 19:33:32 2004 +0100

    [SERIAL] Add ARM PL011 uart primecell support.
    
    This adds support for the AMBA PL011 UART primecell, and moves the
    existing AMBA UART support to indicate it covers the AMBA PL010
    primecell.

commit 7635947f63bee4eae9003f423513f0a4c9ca6011
Author: Daniel Ritz <daniel.ritz@gmx.ch>
Date:   Wed Apr 14 00:46:25 2004 -0700

    [PATCH] yenta: interrupt routing for TI briges
    
    Some TI cardbus bridges found in notebooks and PCI add-on cards are
    uninitialized.  This means the interrupt mode and the interrupt routing
    is wrong in most cases, ending up in non working PCI interrupts.
    
    This makes the TI Yenta driver probe the PCI interrupt and adjust the
    interrupt setting if no interrupts are delivered.  It's done in a safe
    way, that doesn't hurt working setups.
    
    Function 1 on two slot devices is handled differently from function 0
    since both share the settings.

commit 2660f05833d610f4abd497e1267abba0ed7e7084
Merge: f44ce2e... 4670ef7...
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Wed Apr 14 00:44:30 2004 -0700

    Merge bk://bk.arm.linux.org.uk/linux-2.6-rmk
    into ppc970.osdl.org:/home/torvalds/v2.6/linux

commit f44ce2e5c9336745c730f31922f6ce59d2dc22d8
Author: Russell King <rmk@flint.arm.linux.org.uk>
Date:   Wed Apr 14 22:44:50 2004 +0100

    [ARM] Use #defined constants for handle_mm_fault and __do_page_fault.

commit 03a3cda8a3240185b2ed4c6f7b12a1a7d02f0b15
Author: Russell King <rmk@flint.arm.linux.org.uk>
Date:   Wed Apr 14 22:37:11 2004 +0100

    [ARM] Fix __do_softirq breakage.

commit eae6183a340d0850f206fbca2c5152317fdba3ab
Author: Russell King <rmk@flint.arm.linux.org.uk>
Date:   Wed Apr 14 14:49:33 2004 +0100

    [ARM] Fix builds using O=

commit b8b8a34655d18cdb4fc8c8b3e162dfb6dbd64521
Author: Deepak Saxena <dsaxena@net.rmk.(none)>
Date:   Wed Apr 14 13:43:01 2004 +0100

    [ARM PATCH] 1811/1: Set dma_handle to ~0 when coherent allocation too big
    
    Patch from Deepak Saxena

commit e19cd00eadbce30d9908a2c1296bec3e44cec056
Author: Marc-Christian Petersen <m.c.p@kernel.linux-systeme.com>
Date:   Wed Apr 14 00:30:34 2004 -0700

    [PATCH] USB: fix CAN-2004-0075
    
    Okay, now while we are at fixing security holes, is there any chance we
    can _finally_ get the attached patch in?
    
    The Vicam USB driver in all Linux Kernels 2.6 mainline does not use the
    copy_from_user function when copying data from userspace to kernel space,
    which crosses security boundaries and allows local users to cause a denial
    of service.
    
    Already ACKed by Greg. Only complaint was inproper coding style which is done
    with attached patch ;)
    
    ciao, Marc

commit 7e47b7af553ffd2956269adbe90baf6d2415a84a
Merge: fae319a... 6920257...
Author: Steve French <cifs.adm@hostme.bitkeeper.com>
Date:   Wed Apr 14 00:27:58 2004 -0700

    Merge bk://linux.bkbits.net/linux-2.5
    into hostme.bitkeeper.com:/repos/c/cifs/linux-2.5cifs

commit fae319a59923b22b5b9dfbaea2a6f8457ed6fd5f
Author: Steve French <stevef@stevef95.austin.ibm.com>
Date:   Wed Apr 14 06:19:59 2004 -0500

    Fix misc. minor memory leaks in error paths

commit 4670ef7a163bb4aa7118b78f270723a7db177e2f
Author: Sam Ravnborg <sam@ravnborg.org>
Date:   Wed Apr 14 00:05:38 2004 -0700

    [PATCH] kbuild: fix modules_install
    
    The directory .tmp_versions/ was deleted during make vmlinux.
    
    This eliminated the list of modules used for moudles_install.
    The effect was that the following scenario failed:
    
    	make
    	make install
    	make modules_install
    
    The solution is to only cleanup .tmp_versions when building modules.

commit de2bd6e93a2bbd83cacd7925f94ce05957bc68b5
Merge: 6920257... a27bfa9...
Author: Greg Kroah-Hartman <greg@kroah.com>
Date:   Tue Apr 13 23:33:29 2004 -0700

    Merge kroah.com:/home/greg/linux/BK/bleed-2.6
    into kroah.com:/home/greg/linux/BK/i2c-2.6

commit a27bfa92df32ff05f9222dde4805dc28814e8aa7
Author: Jean Delvare <khali@linux-fr.org>
Date:   Tue Apr 13 23:10:38 2004 -0700

    [PATCH] I2C: Fix voltage rounding in asb100
    
    This one line patch fixes voltage rounding in the asb100 chip driver.
    It's very similar to a patch I submitted for the lm80 a few days ago.

commit 0862742d24aa96c155cee9ff30867006c49d3195
Merge: 6920257... b5579ca...
Author: Greg Kroah-Hartman <greg@kroah.com>
Date:   Tue Apr 13 22:42:08 2004 -0700

    Merge kroah.com:/home/greg/linux/BK/bleed-2.6
    into kroah.com:/home/greg/linux/BK/usb-2.6

commit c49429a6723c9818ae4fd67b38142654cc3816ef
Author: Jaroslav Kysela <perex@suse.cz>
Date:   Wed Apr 14 04:37:48 2004 +0000

    [ISAPNP] MEM32 fix in read resources
    
    Corrects isapnp_read_resources so that it gets MEM32 information properly.

commit 3c4694bed46f933585015125e231f515d3929626
Author: Adam Belay <ambx1@neo.rr.com>
Date:   Wed Apr 14 04:34:24 2004 +0000

    [PNPBIOS] avoid making potentially broken calls in proc.c
    
    This patch prevents /proc/bus/pnp/devices from requesting on-boot node
    information.  Dynamic information is used instead.

commit 045e0aec19af487b0013738c18f2d57765798aec
Author: Adam Belay <ambx1@neo.rr.com>
Date:   Wed Apr 14 04:32:32 2004 +0000

    [PNPBIOS] blacklist asus P4P800
    
    The ASUS p4p800 motherboard's BIOS has a broken PnPBIOS implementation.  This
    patch will disable PnPBIOS support if this hardware is detected by DMI.

commit 6faff072818a3bee0bdf4bed2c600c3d005efbb1
Author: Adam Belay <ambx1@neo.rr.com>
Date:   Wed Apr 14 04:30:17 2004 +0000

    [PNP] sysfs entry "resource" fix
    
    This patch ensures the proper count is returned in pnp_set_current_resources.

commit fb6647a62f4b27b0d17dd023f8fa4575fc3dc7b2
Author: Adam Belay <ambx1@neo.rr.com>
Date:   Wed Apr 14 04:28:04 2004 +0000

    [PNP] minor resource management fixes
    
    This patch fixes a bug in pnp_auto_config_dev in which it wouldn't always report
    allocation failures.  It also corrects the return codes.

commit 9a2fc853724a8e2dc094bbe13584289e7611f603
Author: Adam Belay <ambx1@neo.rr.com>
Date:   Wed Apr 14 04:24:50 2004 +0000

    [PNPBIOS] parse asci text name
    
    This patch fixes the unknown tag warning by adding support for the asci text
    tag.

commit 69202577667bf8b90bbae934880302d055cf3e15
Author: Anton Blanchard <anton@samba.org>
Date:   Tue Apr 13 21:09:46 2004 -0700

    [PATCH] large cpumask fix
    
    The RCU code was missing cpus_empty() in one place, required with large
    cpumasks.

commit e8c797a8d8816447a101d1f3a3c6913c2827813a
Author: Anton Blanchard <anton@samba.org>
Date:   Tue Apr 13 21:09:33 2004 -0700

    [PATCH] ppc64 signal frame issue
    
    Fix a corruption bug, we were copying too much information back off
    the signal frame.
    
    While in the area help with gccs sign extension optimisation problems
    and convert some things to long. (Saves about 30 instructions in signal.c)

commit e1fdc3810d561cf939fb7970abb624eaa3502fe1
Merge: 6b4e4b9... 309811e...
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Tue Apr 13 21:08:17 2004 -0700

    Merge http://jfs.bkbits.net/linux-2.5
    into ppc970.osdl.org:/home/torvalds/v2.6/linux

commit 6b4e4b904b9ce38319646241c767085d5305167e
Author: Dave Jones <davej@redhat.com>
Date:   Tue Apr 13 20:21:28 2004 -0700

    [PATCH] isofs buffer overflow fix
    
    Merged in 2.4, and various vendor kernels..
    
      iDefense reported a buffer overflow flaw in the ISO9660 filesystem code.
      An attacker could create a malicious filesystem in such a way that they
      could gain root privileges if that filesystem is mounted. The Common
      Vulnerabilities and Exposures project (cve.mitre.org) has assigned the name
      CAN-2004-0109 to this issue.
    
    Ernie Petrides came up with the following patch which I fixed up a slight
    reject in to apply to 2.6. Otherwise, unchanged from the 2.4 patch.

commit b5579ca5586f6c4e0807b3669abb49e7b9512d6f
Author: Martin Lubich <martin.lubich@gmx.at>
Date:   Tue Apr 13 20:04:33 2004 -0700

    [PATCH] USB: Patch for Clie TH55 Support in visor kernel module
    
    I just want to explain the changes I've made, since I tried to adhere to the
    more organized structure in the 2.6 visor module to incorporate my changes.
    
    I didn't want to pollute this with some ugly hack.
    
    I created a new device id table with name clie_id_5_table to cleanly separate
    the UX50/TH55 from the rest.
    
    Along with this I added a new usb_serial_device_type which is essentially a
    copy of handspring_device but has its own attach function.
    
    This new attach function ( clie_5_attach ) will do the actual magic.
    
    I think it is justified to introduce a new type ( which I called clie_5 )
    since I suspect that Sony is intentionally changing the interface spec ( As
    it has done so in the past ). I dare to predict that we will see more clie
    devices coming this year which will require this new attachment procedure. At
    the moment I am only aware of the UX50 and TH55 to implement that weird
    configuration.

commit 0df15e3b33e01f0757b162475f75b22cdfaea8b1
Author: Jan Capek <jan@ccsinfo.com>
Date:   Tue Apr 13 19:56:46 2004 -0700

    [PATCH] USB: more ftdi devices

commit 83a3154c79c6c955e516f74eb3d755cf8e24019c
Author: Duncan Sands <baldrick@free.fr>
Date:   Tue Apr 13 19:51:12 2004 -0700

    [PATCH] USB speedtouch: bump the version number
    
    Hi Greg, this patch bumps the speedtouch driver's version number.
    It also adds the version number to the module description, so people
    can see it with modinfo.  I also added a MODULE_VERSION line (why?
    because it was there...)  The patch is against your 2.6 kernel tree.

commit 192fda431429b6a9fa5f9d0e307e2bfee7301564
Author: Duncan Sands <baldrick@free.fr>
Date:   Tue Apr 13 19:50:29 2004 -0700

    [PATCH] USB speedtouch: fix memory leak in error path
    
    Hi Greg, this patch fixes a memory leak in the speedtouch driver.
    The leak occurs when the ATM layer submits a skbuff for transmission,
    but the driver rejects it (because the device has been unplugged for
    example).  The ATM layer requires the driver to free the skbuff in this
    case.  The patch is against your 2.6 kernel tree.

commit 555371f675a0184d2823d1c53ea591ceca220eeb
Author: Duncan Sands <baldrick@free.fr>
Date:   Tue Apr 13 19:49:54 2004 -0700

    [PATCH] USB speedtouch: turn on debugging if CONFIG_USB_DEBUG is set
    
    Hi Greg, this causes the speedtouch driver to output non-verbose
    debugging messages if the kernel was configured with CONFIG_USB_DEBUG.
    The patch is against your 2.6 kernel tree.

commit a9075dec378b9d23529eb74d3907af5ef8bca31d
Merge: 837f8c8... 51af77d...
Author: Steve French <cifs.adm@hostme.bitkeeper.com>
Date:   Tue Apr 13 19:20:13 2004 -0700

    Merge bk://linux.bkbits.net/linux-2.5
    into hostme.bitkeeper.com:/repos/c/cifs/linux-2.5cifs

commit 45f96af1e303ff666cb3c6ac2bf241e667c6f856
Merge: 51af77d... 697a7d5...
Author: David S. Miller <davem@nuts.davemloft.net>
Date:   Tue Apr 13 08:53:43 2004 -0700

    Merge nuts.davemloft.net:/disk1/BK/sparcwork-2.6
    into nuts.davemloft.net:/disk1/BK/sparc-2.6

commit 51af77dbb806a3df044de15301d51488202bdfce
Author: Andi Kleen <ak@suse.de>
Date:   Tue Apr 13 06:18:37 2004 -0700

    [PATCH] x86-64 update
    
    Various fixes and cleanups for x86-64.
    
     - Update defconfig
     - Fix some problems in ROM resource scanning (Rene Herman)
     - Initialize APIC id of CPU 0 (Venkatesh Pallipadi)
     - Always enable swiotlb for GART_IOMMU
     - Fix compilation without IOMMU_GART
     - Remove nodes_present; use standard node_online_map instead.
       This also fixes a bug with no memory on node 0.
     - Switch node<->cpu mapping to arrays. This fixes some awkward
       special cases with no nodes and empty nodes.
     - Move K8 fallback node setup to common code
     - Eliminate old fake_node.
     - Fix wrong fields in MCE handling (Marc Bevand)
     - Make pci_dma_consistent behave more similar to i386 to fix Alsa

commit 837f8c8267bd49e6d589a8869fdfea43b045648a
Author: Steve French <stevef@stevef95.austin.ibm.com>
Date:   Tue Apr 13 06:58:22 2004 -0500

    fix merge problem with 2.6.5 (rename of page struct field list to lru)

commit 5cd6bfe8908c97a36a300a10a59753f79bac8969
Author: Andrew Morton <akpm@osdl.org>
Date:   Tue Apr 13 04:49:20 2004 -0700

    [PATCH] update fix for potential integer overflow in zoran driver
    
    From: Dave Jones <davej@redhat.com>
    
    2.4 already had this fixed, but uses a somewhat larger value to clip at.
    For uniformity sake, perhaps they should be the same?  Patch below makes
    it match 2.4-bk

commit cd449d5e1e510f6cdb4aa07f3b7ce1e9d46f0176
Author: Andrew Morton <akpm@osdl.org>
Date:   Tue Apr 13 04:49:07 2004 -0700

    [PATCH] Fix MSI IA64 Support Build Breakage
    
    From: "Nguyen, Tom L" <tom.l.nguyen@intel.com>
    
    The patch showed up in Linus' tree last night breaks the
    "generic_defconfig" build for ia64.
    
    Fix it by adding the NR_VECTORS device to ia64.

commit d7fb2760847761c22ef73117a5de5642ab720434
Author: Andrew Morton <akpm@osdl.org>
Date:   Tue Apr 13 04:48:54 2004 -0700

    [PATCH] Fix ext3 add_nondir d_instantiate()
    
    It should be unconditional.

commit e0ae6ae65f205b0018d41e14a0887de198abd9b3
Author: Andrew Morton <akpm@osdl.org>
Date:   Tue Apr 13 04:48:41 2004 -0700

    [PATCH] jbd copyout fix
    
    When I converted journal_write_metadata_buffer() to kmap_atomic() I screwed
    up the handling of the copyout buffers - we're currently writing four zeroes
    into the user's page rather than into the data which is to be written to the
    journal (oops).
    
    Net effect: any block which starts with 0xC03B3998 gets scribbled on in
    data=journal mode.

commit df9b57fa1c59c7b150c8e681fc834904060e586a
Author: Bartlomiej Zolnierkiewicz <b.zolnierkiewicz@elka.pw.edu.pl>
Date:   Tue Apr 13 04:29:30 2004 -0700

    [PATCH] obsolete asm/hdreg.h

commit 7d7827100cf5e0ca6b06f7dceca8b34470f0c08e
Author: Bartlomiej Zolnierkiewicz <b.zolnierkiewicz@elka.pw.edu.pl>
Date:   Tue Apr 13 04:29:19 2004 -0700

    [PATCH] asm-ia64/ide.h: use unsigned long instead of ide_ioreg_t

commit 767b80a9781eb4619c32a12a4d2b4cefac039f5f
Author: Bartlomiej Zolnierkiewicz <b.zolnierkiewicz@elka.pw.edu.pl>
Date:   Tue Apr 13 04:29:08 2004 -0700

    [PATCH] asm/ide.h: ide_ioreg_t cleanup
    
    ide_ioreg_t is deprecated and hasn't been used by IDE driver for some time.
    Use unsigned long directly on alpha, arm26, arm, mips, parisc, ppc64 and sh.
    
    asm-ia64/ide.h (ide_ioreg_t is unsigned short) and asm-m68knommu/ide.h
    (broken - ide_ioreg_t is not defined) are the only users of ide_ioreg_t left.

commit 76fff7dbcd13e7437f49db01b4807b34e8ccbb2d
Author: Bartlomiej Zolnierkiewicz <b.zolnierkiewicz@elka.pw.edu.pl>
Date:   Tue Apr 13 04:28:56 2004 -0700

    [PATCH] add asm-generic/hdreg.h
    
    Use it on all archs which define ide_ioreg_t to unsigned long.

commit b7c2214d20086ce345144d377b38a1002394ca44
Author: Bartlomiej Zolnierkiewicz <b.zolnierkiewicz@elka.pw.edu.pl>
Date:   Tue Apr 13 04:28:41 2004 -0700

    [PATCH] asm-arm26/hdreg.h: use unsigned long for ide_ioreg_t

commit 7c501ddc38fa300299dc5932a5139bd3af5a7f73
Author: Bartlomiej Zolnierkiewicz <b.zolnierkiewicz@elka.pw.edu.pl>
Date:   Tue Apr 13 04:28:29 2004 -0700

    [PATCH] zero 'hw_regs_t hw' allocated from stack in ide.c and ide-cs.c

commit 1b803805bb5f4d9989162c3e2eb6a6abbd1f7943
Author: Bartlomiej Zolnierkiewicz <b.zolnierkiewicz@elka.pw.edu.pl>
Date:   Tue Apr 13 04:28:16 2004 -0700

    [PATCH] hpt366.c: fix 'cat /proc/ide/hpt366' crash
    
    Disable code doing outb() without any locking in /proc handler.
    Otherwise 'cat /proc/ide/hpt366' crashes if done during I/O.
    
    Noticed by John Stoffel <stoffel@lucent.com>.

commit 2ce4ee6a935c49f349042c223b991cd2be46e15d
Author: Bartlomiej Zolnierkiewicz <b.zolnierkiewicz@elka.pw.edu.pl>
Date:   Tue Apr 13 04:28:03 2004 -0700

    [PATCH] ide-disk.c: workaround for bogus LBA48 drives
    
    From: Geert Uytterhoeven <geert@linux-m68k.org>
    
    Apparently some IDE drives (e.g. a pile of 80 GB ST380020ACE drives I have
    access to) advertise to support LBA48, but don't, causing kernels that support
    LBA48 (i.e. anything newer than 2.4.18, including 2.4.25 and 2.6.4) to fail on
    them.  Older kernels (including 2.2.20 on the Debian woody CDs) work fine.
    
    Check for id->lba_capacity_2 being non-zero in idedisk_supports_lba48().

commit 9529973894d67d6529050348bb70464dc46c1d3d
Author: Jeff Garzik <jgarzik@redhat.com>
Date:   Tue Apr 13 08:53:32 2004 -0400

    [netdrvr r8169] temporary build fix, until DMA_xxBIT_MASK is upstream

commit 00dfe26f6020cd9ef98777e3d51d82fc47a9373a
Author: Jeff Garzik <jgarzik@redhat.com>
Date:   Tue Apr 13 07:10:19 2004 -0400

    Delete sis190 net driver.
    
    The driver was copied from the very-buggy r8169 (pre-Francois),
    and is for hardware that isn't even out of the lab yet.

commit 507226e42a611c416cc0c59bb2640d8a4fb5cc80
Merge: 3b55888... f85c907...
Author: Jeff Garzik <jgarzik@redhat.com>
Date:   Tue Apr 13 07:03:03 2004 -0400

    Merge redhat.com:/spare/repo/netdev-2.6/tulip
    into redhat.com:/spare/repo/net-drivers-2.6

commit 3b55888b03a13453e316b3564d56235046fdd406
Merge: 523f051... 82255f9...
Author: Jeff Garzik <jgarzik@redhat.com>
Date:   Tue Apr 13 07:01:53 2004 -0400

    Merge redhat.com:/spare/repo/netdev-2.6/s2io
    into redhat.com:/spare/repo/net-drivers-2.6

commit 523f051914788a27c6642801965b3a9235788bb9
Merge: 62c6cb1... 86af9cf...
Author: Jeff Garzik <jgarzik@redhat.com>
Date:   Tue Apr 13 07:00:08 2004 -0400

    Merge redhat.com:/spare/repo/netdev-2.6/r8169
    into redhat.com:/spare/repo/net-drivers-2.6

commit 62c6cb138b879faf94a179fcabefd6094e881c9c
Merge: 0f300cb... 3893fcd...
Author: Jeff Garzik <jgarzik@redhat.com>
Date:   Tue Apr 13 06:59:03 2004 -0400

    Merge redhat.com:/spare/repo/netdev-2.6/pcnet32
    into redhat.com:/spare/repo/net-drivers-2.6

commit 0f300cbf86015790a5224c57fb91ebf067ea6dbc
Merge: 4ec21f9... d9224c2...
Author: Jeff Garzik <jgarzik@redhat.com>
Date:   Tue Apr 13 06:57:44 2004 -0400

    Merge redhat.com:/spare/repo/netdev-2.6/e1000
    into redhat.com:/spare/repo/net-drivers-2.6

commit d9224c2cfdb05384d29948a4c5e60a00a953a9b0
Merge: e0d3e32... 0f54bd3...
Author: Jeff Garzik <jgarzik@redhat.com>
Date:   Tue Apr 13 06:56:28 2004 -0400

    Merge redhat.com:/spare/repo/netdev-2.6/b44
    into redhat.com:/spare/repo/net-drivers-2.6

commit e0d3e322be607f2196415b42155eab21bc78e040
Merge: 4d72de2... 93eb743...
Author: Jeff Garzik <jgarzik@redhat.com>
Date:   Tue Apr 13 06:54:27 2004 -0400

    Merge redhat.com:/spare/repo/netdev-2.6/8139cp
    into redhat.com:/spare/repo/net-drivers-2.6

commit fb320b95ffb2f406ccff907f60704cd88ff2c047
Author: Randy Dunlap <rddunlap@osdl.org>
Date:   Tue Apr 13 06:28:52 2004 -0400

    [PATCH] remove concat. with __FUNCTION__ (drivers/net/) (V2)
    
    Hi,
    
    Previous patch had a small problem.  This patch replaces the
    previous version.  I can/will send a relative/differential diff
    if you want/need it.
    
    
    Problem:
    
    On Tue, 2004-04-06 at 14:45, Randy.Dunlap wrote:
    > From: Tony Breeds <tony@bakeyournoodle.com>
    >
    > "concatenation of string literals with __FUNCTION__ is deprecated"
    > -#define TRACE_ENTER(devname) DEBUG(2, "%s: -> " __FUNCTION__ "()\n", devname);
    > -#define TRACE_EXIT(devname)  DEBUG(2, "%s: <- " __FUNCTION__ "()\n", devname);
    > +#define TRACE_ENTER(devname) DEBUG(2, "%s: -> %s()\n", __FUNCTION__, devname);
    > +#define TRACE_EXIT(devname)  DEBUG(2, "%s: <- %s()\n", __FUNCTION__, devname);
    
    | Hi.  This isn't the same.  It should be:
    |
    | +#define TRACE_ENTER(devname) DEBUG(2, "%s: -> %s()\n", devname, __FUNCTION__);
    | +#define TRACE_EXIT(devname)  DEBUG(2, "%s: <- %s()\n", devname, __FUNCTION__ );
    
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    
    
     drivers/net/gt96100eth.c       |    2 +-
     drivers/net/irda/smsc-ircc2.c  |    6 +++---
     drivers/net/irda/via-ircc.c    |    2 +-
     drivers/net/wireless/orinoco.h |    4 ++--
     4 files changed, 7 insertions(+), 7 deletions(-)

commit 86af9cf003ce664c03fefea97318012736d08089
Author: Fran√ßois Romieu <romieu@fr.zoreil.com>
Date:   Tue Apr 13 06:25:12 2004 -0400

    [PATCH] r8169: mod_timer() expects an absolute time, not a relative offset.

commit 8d6eb2db8f64d2811dd992a4b0216e2a71fcb5b4
Author: Fran√ßois Romieu <romieu@fr.zoreil.com>
Date:   Tue Apr 13 06:25:05 2004 -0400

    [PATCH] r8169: correct irq handler return value
    
    The irq handler must not return 1 when the status register is null
    during the firt iteration.

commit ffccc2f44b83adb607eeabd187dade8924b09bbc
Author: Fran√ßois Romieu <romieu@fr.zoreil.com>
Date:   Tue Apr 13 06:24:58 2004 -0400

    [PATCH] r8169: Missing 'static' qualifier for functions.

commit a159fe178ef25ebb98bb046ea69815888f753aac
Author: David Mosberger <davidm@tiger.hpl.hp.com>
Date:   Tue Apr 13 03:19:16 2004 -0700

    ia64: When delivering a signal, force byte-order to little-endian.

commit 7f03cebed27408f69312318bf0e73b8d9a188540
Author: David Mosberger <davidm@tiger.hpl.hp.com>
Date:   Tue Apr 13 03:17:41 2004 -0700

    ia64: Drop pci_sal_ext_{read,write}() and instead simply switch to
    	extended config-space addresses when needed.  This avoids
    	the fragile SAL version testing.

commit 7067d292c93262c29f713f5be8c429a9d3fbebca
Author: David Mosberger <davidm@tiger.hpl.hp.com>
Date:   Tue Apr 13 03:14:59 2004 -0700

    ia64: Quiet another compiler-warning.

commit 542ab8960ef9a44ab85fe8a7727dc81fd0da1292
Author: Fran√ßois Romieu <romieu@fr.zoreil.com>
Date:   Tue Apr 13 06:14:40 2004 -0400

    [PATCH] MAINTAINER entry for the r8169 driver.

commit ce99046f5b8e8219b43d038204b15b106cb891a6
Author: Paul Gortmaker <p_gortmaker@yahoo.com>
Date:   Tue Apr 13 06:12:12 2004 -0400

    [netdrvr 8390] Fix 8390 log spam
    
    It seems that PCMCIA 8390 users get spammed with a few annoying
    messages upon card removal. I guess 8390 could be taught to better
    detect and deal with these things, but here is a quick fix.

commit 0c00a913fe06bb5a6f7dcf424df18d953172ea1f
Author: Matt Mackall <mpm@selenic.com>
Date:   Tue Apr 13 06:07:53 2004 -0400

    [PATCH] netpoll transmit busy bugfix
    
    Fix for handling of full transmit queue when netpoll trap is enabled.
    
    From Stelian Pop <stelian@popies.net>

commit ae50bfca6656c70dba5a2076037341bd8e8a2e68
Author: Matt Mackall <mpm@selenic.com>
Date:   Tue Apr 13 06:07:45 2004 -0400

    [PATCH] netpoll early ARP handling
    
    Handle ARP requests while device is trapped before in_dev is
    initialized using netpoll config. Allows early kgdboe usage.
    
    From Stelian Pop <stelian@popies.net>

commit f6dd59bcc00e6025075fd7a6801afe54682b0bd1
Author: Russell King <rmk@arm.linux.org.uk>
Date:   Tue Apr 13 06:07:24 2004 -0400

    [PATCH] etherh updates
    
    Update Acorn EtherH driver - convert to use mmio instead of emulated
    PIO.  Convert card-specific parameters to a data structure rather
    than code-based selected.
    
    Please review and submit upstream.  Thanks.

commit 00ec66dfffa492fe8d40bf2892d6520759404b42
Author: Andrew Morton <akpm@osdl.org>
Date:   Tue Apr 13 06:07:12 2004 -0400

    [PATCH] sk_mca multicast fix
    
    Spotted by Jean Delvare <khali@linux-fr.org>: it has its memset arguments the
    wrong way round.

commit 3893fcd90e2053809252c79dd234a539e8e50bf6
Author: Don Fry <brazilnut@us.ibm.com>
Date:   Tue Apr 13 06:06:34 2004 -0400

    [PATCH] pcnet32 fix hang/crash with loopback test
    
    If the pcnet32 interface is not up, running the loopback test may hang or
    crash the system.  This patch provided by Jim Lewis fixes that problem.
    Tested on ia32 and ppc systems.

commit 4ec21f9f8dfcc63db47badfd836ee42cef4e079a
Author: Ganesh Venkatesan <ganesh.venkatesan@intel.com>
Date:   Tue Apr 13 05:40:44 2004 -0400

    [PATCH] e1000: replace if(retval=fn()) with retval=fn(); if (retval)

commit e933a428235677bfe7dbb0478fb8326f57142266
Author: Ganesh Venkatesan <ganesh.venkatesan@intel.com>
Date:   Tue Apr 13 05:40:37 2004 -0400

    [PATCH] e1000: all other white space fixes, changelog

commit f05d9ab00fc6d45aaccd9037c75e741314d578b8
Author: Ganesh Venkatesan <ganesh.venkatesan@intel.com>
Date:   Tue Apr 13 05:40:29 2004 -0400

    [PATCH] e1000: New bit definitions, fix comments on loadtime parameters

commit d97755e69265e6afa030b4df92d218aa3d42c430
Author: Ganesh Venkatesan <ganesh.venkatesan@intel.com>
Date:   Tue Apr 13 05:40:22 2004 -0400

    [PATCH] e1000: Set Attla PHY to Class A
    
    Some LOM implementation of our controllers pass IEEE tests (Tx
    distortion/Symmetry) while operating in Class A mode rather than in
    class AB mode.

commit a5a765084caa6485d223c574a6b41f39de315f17
Author: Ganesh Venkatesan <ganesh.venkatesan@intel.com>
Date:   Tue Apr 13 05:40:14 2004 -0400

    [PATCH] e1000: remove polarity reversal workaround for forced 10H/10F links
    
    Adding this caused the adapter to fail while operating at 10 mbps, half
    duplex. Hence the fix is not complete. We are still investigating a more
    complete fix for the polarity reversal issue.

commit dfe15779f3cbbf660af67061a0a3a04a5a70f6c3
Author: Ganesh Venkatesan <ganesh.venkatesan@intel.com>
Date:   Tue Apr 13 05:40:07 2004 -0400

    [PATCH] e1000: fix eeprom update to include e1000_standby_eeprom
    
    A Bug in e1000_spi_eeprom_ready where the Chip Select bit wasn't being
    toggled after every status register read (if the eeprom wasn't ready after
    the first status register read). The call to e1000_standby_eeprom manages
    the CS bit correctly

commit ea225c9f3f92050e677e1a289371c1e89febc86e
Author: Ganesh Venkatesan <ganesh.venkatesan@intel.com>
Date:   Tue Apr 13 05:39:59 2004 -0400

    [PATCH] e1000: ethtool set/get ring param support

commit cd81ecfdcb08ccb5c90f4b01d2b5768442f82638
Author: Ganesh Venkatesan <ganesh.venkatesan@intel.com>
Date:   Tue Apr 13 05:39:52 2004 -0400

    [PATCH] e1000: ethtool set/get eeprom fixes

commit 30ea9e1f97afdbfb1f581a077fc2002d21c02886
Merge: 76c178d... 4d72de2...
Author: Steve French <stevef@stevef95.austin.ibm.com>
Date:   Tue Apr 13 04:31:41 2004 -0500

    Resolve merge conflict due to list to lru field renaming in page struct

commit 4d72de2391fe2c02ef972bffc8829b03af38699e
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon Apr 12 19:26:35 2004 -0700

    [PATCH] ppc64: restore r13 in an unrecoverable exception
    
    From: Anton Blanchard <anton@samba.org>
    
    We have to restore r13 when entering unrecoverable_exception.

commit 6e9d79e266bc7ec2327cdef1c6f8f8db34397a2d
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon Apr 12 19:26:22 2004 -0700

    [PATCH] ppc64: Fix ibmveth.c compilation
    
    From: Paul Mackerras <paulus@samba.org>
    
    This patch changes PCI_DMA_TODEVICE to DMA_TO_DEVICE in a couple of
    places in drivers/net/ibmveth.c, since it doesn't compile without this
    change and it does compile with it.  It also reformats a couple of
    over-long lines in the vicinity of the other changes.

commit 99ac3092f4b894ce0e1e045f38a99ee06ab2500d
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon Apr 12 19:26:09 2004 -0700

    [PATCH] ufs2_frag_map_fix : fixes wrong content reading in ufs2  code
    
    From: Niraj Kumar <niraj17@iitbombay.org>
    
    This is in continuation of the ufs2 read-only code that went into 2.6.5.
    
    This patch fixes a bug where wrong content was being read off the disk
    after around 4 MB mark.

commit 957ce1abc8f00f5f3930f1f2d334d143cea9058d
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon Apr 12 19:25:55 2004 -0700

    [PATCH] binfmt_misc: remove attribute(unused)
    
    From: Anton Blanchard <anton@samba.org>
    
    It's been there since the kernel was first imported into bk.  We see no
    reason for this.

commit 4543d758269b7a46fbcc198a4c2e4e2be2bcefa0
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon Apr 12 19:25:41 2004 -0700

    [PATCH] stack reductions: nfs root
    
    From: Arjan van de Ven <arjanv@redhat.com>
    
    root_nfs_name is called one in single threaded environment; can use static.

commit 3de1b14f68700a4e35c63c3a85c5859fe32ec05b
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon Apr 12 19:25:29 2004 -0700

    [PATCH] Compile fix for macserial
    
    From: Jeff Mahoney <jeffm@suse.com>
    
    This patch fixes a problem with the serial conversion to tiocm[sg]et.
    
    The paste from rs_ioctl included the command sanity checking, but there's no
    command for tiocm[sg]et.  The compile ends up failing.

commit 8d5f7e2700d5632c24a0fcbbb0c23c5370d4e65a
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon Apr 12 19:25:15 2004 -0700

    [PATCH] pcmcia/rsrc_mgr.c warning fix.
    
    From: "Luiz Fernando N. Capitulino" <lcapitulino@prefeitura.sp.gov.br>,
          me
    
    drivers/pcmcia/rsrc_mgr.c: In function `find_io_region':
    drivers/pcmcia/rsrc_mgr.c:604: warning: large integer implicitly truncated to unsigned type
    
    We don't really know what underlying type an ioaddr_t has, so just use an
    integer here and let the compiler promote it appropriately.

commit 7b78461e24d48310b5d850093e90aa2a2e29754a
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon Apr 12 19:25:02 2004 -0700

    [PATCH] another mips build fix
    
    From: Samium Gromoff <deepfire@sic-elvis.zel.ru>
    
    Without this one it fails to build, too.

commit bc30464f312825013bd4860d9b9102ceb71041d3
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon Apr 12 19:24:49 2004 -0700

    [PATCH] mips build fix
    
    From: Samium Gromoff <deepfire@sic-elvis.zel.ru>
    
    Without this one it fails to build.

commit c241a7a9ea1ecd46aa0434f87df3ccb4815b998f
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon Apr 12 19:24:35 2004 -0700

    [PATCH] Wrong return value in hfs_fill_super
    
    From: Nick Wellnhofer <wellnhofer@aevum.de>
    
    hfs_fill_super in 2.6.5 returns -EIO instead of -EINVAL if a valid supe=
    block isn't found.  So mount_block_root in init/do_mounts.c bails out before
    trying to mount the root device as XFS.

commit 53fc8f8c8a1fd63b20bb65e9213cc0d58b4541f3
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon Apr 12 19:24:22 2004 -0700

    [PATCH] m68knommu: fixes to the 68328 DragonBall serial driver
    
    From: <gerg@snapgear.com>
    
    A few fixes for the 68328 "DragonBall" serial driver:
    
    . use irqreturn_t for interrupt handlers
    . correct a few variable types (stop compiler warnings)
    . correctly use return values from put_user(), get_user() and copy_to_user()
    
    Many of these originaly from kernel janitors.

commit 137fd8d52dc02320cee8440d2a8c37a61c4230b8
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon Apr 12 19:24:08 2004 -0700

    [PATCH] m68knommu: fixes to the ColdFire serial driver
    
    From: <gerg@snapgear.com>
    
    A whole bunch of fixes for the ColdFire serial driver:
    
    . remove unused CONFIG_LEDMAN code
    . reformat port definitions to new style structure init
    . change "addr" field type to reduce casting in ColdFire serial driver
    . cleanup locking problems in mcfrs_write().
    . implement fraction baud rate clock support for hardware that
      supports it (namely the ColdFire 5272)
    . implement wait_until_sent, some ColdFire parts of hardware support
      for this (again the 5272).
    . correctly use return values from put_user(), get_user() and copy_to_user()
    
    Many of these originaly from kernel janitors.

commit 2ab3753847dd79e298849561b5439c48e2dc361b
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon Apr 12 19:23:56 2004 -0700

    [PATCH] m68knommu: change addr type to reduce casting in ColdFire serial driver
    
    From: <gerg@snapgear.com>
    
    Change "addr" field type to reduce casting in ColdFire serial driver.

commit f0db3afb0006c5ab9268f56b0dec65bf8baa8548
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon Apr 12 19:23:42 2004 -0700

    [PATCH] Fix tmscsim on amd64
    
    From: Jeff Garzik <jgarzik@pobox.com>
    
    DC390_init() takes a long, not an int.

commit cefd356ae1d0b860f8876dddb74b63efe7aa4606
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon Apr 12 19:23:29 2004 -0700

    [PATCH] uninline copy_to_user() and copy_from_user()
    
    40k reduction in my vmlinux.
    
    Thanks to Denis Vlasenko <vda@port.imtp.ilyichevsk.odessa.ua> for performing
    the analysis.

commit af86cdc67311004c81894ac69e981abfd2d65a90
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon Apr 12 19:23:16 2004 -0700

    [PATCH] uninline seq_puts() and seq_putc()
    
    Saves 3.4k from my vmlinux.
    
    Thanks to Denis Vlasenko <vda@port.imtp.ilyichevsk.odessa.ua> for performing
    the analysis.

commit 467769abc79de002e75cdfb0d8f43695dfb4ffab
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon Apr 12 19:23:02 2004 -0700

    [PATCH] uninline put_page()
    
    Shrinks my vmlinux by an astonishing 28k.
    
       text    data     bss     dec     hex filename
    3038796  589890  150612 3779298  39aae2 vmlinux.before
    3009761  590107  150612 3750480  393a50 vmlinux.after
    
    Thanks to Denis Vlasenko <vda@port.imtp.ilyichevsk.odessa.ua> for performing
    the analysis.

commit 03e95cafe7417e31fa78e827d714e1c077ab089e
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon Apr 12 19:22:50 2004 -0700

    [PATCH] fix vga16fb.c frame buffer bad memory mapping
    
    From: Vincent Sanders <vince@kyllikki.org>
    
    The vga16fb driver uses a direct ioremap on 0xa00000 to gain access to the
    vga card.  This is wrong on architectures other than x86, every other driver
    uses VGA_MAP_MEM macro from vga.h to ensure the correct memory mapping.

commit b52b3a2b853bad27052de3357c198ec59dbe8674
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon Apr 12 19:22:37 2004 -0700

    [PATCH] shrink VFS hash sizes on small machines
    
    From: Matt Mackall <mpm@selenic.com>
    
    Base hash sizes on available memory rather than total memory.  An
    additional 50% above current used memory is considered reserved for the
    purposes of hash sizing to compensate for the hashes themselves and the
    remainder of kernel and userspace initialization.

commit a16129b8509728ae92ce205114ab453509e200f0
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon Apr 12 19:22:25 2004 -0700

    [PATCH] get_files_struct cleanup
    
    From: Russell King <rmk@arm.linux.org.uk>
    
    Cleanup the 4 duplicate "get_files_struct" implementations into one
    get_files_struct() function to compliment put_files_struct().

commit c2bd12474ca2323e84fa40eed61de4fc8311d4a3
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon Apr 12 19:22:13 2004 -0700

    [PATCH] put ia32 pgds and pmds back into slab
    
    From: William Lee Irwin III <wli@holomorphy.com>
    
    This optimisation was reverted when I was removing all users of page->list.
    Bill fixed it up, so unrevert it again.

commit 24b5a6a3025278a1717798901f665114a1655831
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon Apr 12 19:21:59 2004 -0700

    [PATCH] kbuild: Create .tmp_versions when building external modules
    
    From: Sam Ravnborg <sam@ravnborg.org>
    
    When building external modules the $PWD/.tmp_versions directory is used.
    The .tmp_versions directory in the kernel tree cannot be used because this
    would clutter up the kernel tree especially when more than one external
    module is being build for the same kernel tree.
    
    This patch make sure to create $PWD/.tmp_versions, and to delete it during
    make clean.  It also removes warning about 'messed with SUBDIRS', this is
    no longer relevant when .tmp_versions is made outside the kernel tree.

commit 8a358cff5aab455c3f820e600c1c4e4af511efea
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon Apr 12 19:21:45 2004 -0700

    [PATCH] hugetlbpage highmem fix
    
    From: Andy Whitcroft <apw@shadowen.org>
    
    When clearing a large page allocation ensure we use a page clear function
    which will correctly clear a ZONE_HIGHMEM page.

commit 9515fdf192fee0ff2fc1bd4a277ee952fb9b13d5
Merge: f48c54a... 2aebc5b...
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Mon Apr 12 18:52:00 2004 -0700

    Merge bk://linux-dj.bkbits.net/cpufreq
    into ppc970.osdl.org:/home/torvalds/v2.6/linux

commit f48c54a39e3d709f0e6072c4d9c7eb43ae01f1da
Merge: 5b1d3f3... 36ab795...
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Mon Apr 12 18:16:54 2004 -0700

    Merge bk://linux-dj.bkbits.net/agpgart
    into ppc970.osdl.org:/home/torvalds/v2.6/linux

commit 5b1d3f39c6f6ed7c7bd5dd9241583f60b7f8ff99
Author: Geert Uytterhoeven <geert@linux-m68k.org>
Date:   Mon Apr 12 17:32:38 2004 -0700

    [PATCH] m68k show_interrupts bug
    
    M68k: Make sure machine-specific interrupts are always printed (bug introduced
    by show_interrupts() conversion)

commit 69449862f7228825d63a6198e2d873969e3ee6c6
Author: Geert Uytterhoeven <geert@linux-m68k.org>
Date:   Mon Apr 12 17:32:24 2004 -0700

    [PATCH] Amiga eth%d
    
    Amiga Ethernet drivers: Print card info after calling register_netdev(), to
    avoid dev->name still being 'eth%d'.

commit a25d25dddc2dfc3046cdaecf531dd78934923eda
Author: Geert Uytterhoeven <geert@linux-m68k.org>
Date:   Mon Apr 12 17:32:12 2004 -0700

    [PATCH] M68k time update
    
    M68k: Update time adjustment code cfr. other architectures.
    (perhaps do_gettimeofday() is a good candidate for consolidation across archs?)

commit 5e23698f44cd158656babbbcea75d3ec1dbf9a0f
Author: Geert Uytterhoeven <geert@linux-m68k.org>
Date:   Mon Apr 12 17:31:58 2004 -0700

    [PATCH] M68k TLB fixes
    
    M68k TLB fixes from Roman Zippel:
      - Check current->active_mm for currently active mm
      - Set correct context to flush the right ATC entry
    This is especially important for kswapd to correctly flush unmapped entries (it
    caused random segfaults during large compiles)

commit 782cf01e7f6392c537c74297a0ee869f42234625
Author: Geert Uytterhoeven <geert@linux-m68k.org>
Date:   Mon Apr 12 17:31:46 2004 -0700

    [PATCH] m68k I/O
    
    m68k: Use explicit-sized types for I/O accesses

commit a6f199d3658b51e2ed213009a44c185e560376df
Author: Geert Uytterhoeven <geert@linux-m68k.org>
Date:   Mon Apr 12 17:31:32 2004 -0700

    [PATCH] Amikbd C99 cleanup
    
    Amikbd: Use C99 array initializers and standard key defines

commit 4b07ff6f8fd31cb2acea9e5af7d9882c82877164
Author: Geert Uytterhoeven <geert@linux-m68k.org>
Date:   Mon Apr 12 17:31:19 2004 -0700

    [PATCH] M68k initializers cleanup
    
    M68k: Clean up initializers:
      - Convert struct/array initializers to C99 style
      - Do not initialize data to 0 or NULL explicitly so it can move to bss

commit 2564f5f5a9f265eb76bce20e54a20ad1af86b38b
Author: Geert Uytterhoeven <geert@linux-m68k.org>
Date:   Mon Apr 12 17:31:05 2004 -0700

    [PATCH] M68k vector definitions
    
    M68k: Add remaining CPU vector definitions

commit 89a8bf17113cca14f0bd48f18958a93516e98a13
Author: Geert Uytterhoeven <geert@linux-m68k.org>
Date:   Mon Apr 12 17:30:52 2004 -0700

    [PATCH] Sun-3 duplicates
    
    Sun-3: Kill duplicate definitions:
      - FC_CONTROL is defined in <asm/sun3-head.h>
      - vectors[] is declared in <asm/traps.h>

commit f21618ed824cc9951faa1302da8a6752706a57fc
Author: Geert Uytterhoeven <geert@linux-m68k.org>
Date:   Mon Apr 12 17:30:39 2004 -0700

    [PATCH] MVME16x RTC const
    
    MVME16x RTC: Make days_in_mo[] const

commit 998f824a00d68ef9c04e63f8ab6c6e191904b0c0
Author: Geert Uytterhoeven <geert@linux-m68k.org>
Date:   Mon Apr 12 17:30:24 2004 -0700

    [PATCH] Amiga Zorro8390 Ethernet section conflict
    
    Zorro8390: const data cannot be in the init data section (from Roman Zippel)

commit 60c138f8c96456053562804787ea2ab6fb4ce6f9
Author: Geert Uytterhoeven <geert@linux-m68k.org>
Date:   Mon Apr 12 17:30:10 2004 -0700

    [PATCH] pm2fb barrier cleanup
    
    Permedia2: Always use the standard barrier macros (they do exist on m68k, and
    map to barrier())

commit a88825cdea6dc5e45b966698ff2c2e83bade58f3
Author: Geert Uytterhoeven <geert@linux-m68k.org>
Date:   Mon Apr 12 17:29:57 2004 -0700

    [PATCH] Pm2fb is broken on Amiga
    
    Permedia2: Mark pm2fb broken on Amiga, until somebody fixes it (pm2fb.c
    explicitly tests for CONFIG_PCI right now)

commit a0b67e8fd0f57a81e48a56a26438e66c8c93c77d
Author: Geert Uytterhoeven <geert@linux-m68k.org>
Date:   Mon Apr 12 17:29:44 2004 -0700

    [PATCH] Zorro devlist.h kbuild
    
    Zorro: Quieten building of devlist.h (cfr. PCI)

commit 697a7d5de2b1465a7d6e83c8651921a301f27e42
Author: David S. Miller <davem@nuts.davemloft.net>
Date:   Mon Apr 12 07:46:19 2004 -0700

    [SPARC64]: Disable -Werror for a bit.

commit 3e12535b29a4ab4e294c9125a462d1f0d0a8d08b
Merge: 99d6df7... eb880e5...
Author: David S. Miller <davem@nuts.davemloft.net>
Date:   Mon Apr 12 05:30:08 2004 -0700

    Merge nuts.davemloft.net:/disk1/BK/sparcwork-2.6
    into nuts.davemloft.net:/disk1/BK/sparc-2.6

commit 1740c41cdb8eba8a1d59e6f9e4320102f34a63f3
Merge: 4c268c6... 4006f66...
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Mon Apr 12 04:50:49 2004 -0700

    Merge http://lia64.bkbits.net/to-linus-2.5
    into ppc970.osdl.org:/home/torvalds/v2.6/linux

commit 4c268c6b6a86ec9309fe02c60b8b1e164e842b99
Merge: 6cd7a7d... 246756e...
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Mon Apr 12 04:27:11 2004 -0700

    Merge bk://linux-scsi.bkbits.net/scsi-for-linus-2.6
    into ppc970.osdl.org:/home/torvalds/v2.6/linux

commit 8c8079c3c2c1fae0326e3c6073c696fdb2dd558b
Author: Linda Xie <lxiep@us.ibm.com>
Date:   Mon Apr 12 02:57:12 2004 -0700

    [PATCH] PCI Hotplug: php_phy_location.patch
    
    Adds a file to show the pci hotplug slot location for the ppc64 driver
    only.

commit 53387be8b224d38de0c870fc72fbab37ba311e1d
Author: Marcel Holtmann <marcel@holtmann.org>
Date:   Mon Apr 12 02:46:07 2004 -0700

    [PATCH] Fix sysfs class support for CAPI
    
    this patch fixes a bug in the CAPI TTY support, because the ->name value
    of the TTY driver shouldn't contain a "/". After changing this there are
    now a "capi20" TTY device and a "capi20" control device and so I renamed
    the control device to "capi". The userspace visible part must be done by
    udev and I added these two rules to restore the old namespace:
    
    	# CAPI devices
    	KERNEL="capi",          NAME="capi20", SYMLINK="isdn/capi20"
    	KERNEL="capi*",         NAME="capi/%n"

commit 5f783bb8e554edc1ffc67003964c3ded989c27b3
Author: Luca Tettamanti <kronos@kronoz.cjb.net>
Date:   Mon Apr 12 02:38:31 2004 -0700

    [PATCH] USB: New ID for ftdi_sio
    
    Hi,
    I have an USB contactless reader which uses a FTDI chip. It works well with the
     current ftdi_sio driver, it's just a matter of adding an ID:

commit 6cd7a7d161353a29b191d927871721b8eec366c6
Merge: da0cefc... 193ce3b...
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Mon Apr 12 02:32:12 2004 -0700

    Merge bk://gkernel.bkbits.net/libata-2.6
    into ppc970.osdl.org:/home/torvalds/v2.6/linux

commit 193ce3bea659ee78cff8288b5e9ec9186fcb1b30
Merge: f2d816e... 78a21ca...
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Mon Apr 12 02:31:17 2004 -0700

    Merge NFS conflicts

commit f2d816ef30bba85a850166fa3a6404a544f8849f
Merge: 5566c10... 7347d80...
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Mon Apr 12 02:24:49 2004 -0700

    Merge bk://bk.arm.linux.org.uk/linux-2.6-pcmcia
    into ppc970.osdl.org:/home/torvalds/v2.6/linux

commit 7347d800b0ec77f34ae1069adc93312a15ab549e
Author: Randy Dunlap <rddunlap@org.rmk.(none)>
Date:   Mon Apr 12 19:54:09 2004 +0100

    [PCMCIA] init_pcmcia_cs() to return error from class_register()
    
    Patch from: Randy Dunlap
    
    From: Walter Harms
    
    Now init_pcmcia_cs() returns the result of class_register().
    Therefore init_pcmcia_cs() will possibly return an error.

commit 5566c10d86a29929678d626398a59298e90b7a52
Merge: 0d61fc5... d6a03f1...
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Mon Apr 12 02:22:59 2004 -0700

    Merge bk://bk.arm.linux.org.uk/linux-2.6-serial
    into ppc970.osdl.org:/home/torvalds/v2.6/linux

commit 0d61fc5ea78015def4d2fcf9b598ecfe25210cdd
Merge: f2eb250... eb880e5...
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Mon Apr 12 02:21:00 2004 -0700

    Merge bk://bk.arm.linux.org.uk/linux-2.6-rmk
    into ppc970.osdl.org:/home/torvalds/v2.6/linux

commit f2eb250f07ba4695c2474cb8b6edbf64b5457d65
Author: Randy Dunlap <rddunlap@org.rmk.(none)>
Date:   Mon Apr 12 20:03:14 2004 +0100

    [ARM] use errno #defines in assembly
    
    Patch from: Randy Dunlap
    
    From: Danilo Piazzalunga
    
    Some assembly code (on various archs) either
     1. uses hardcoded errno numbers instead of the canonical macro
        names, or
     2. defines them locally, instead of including the appropriate
        header (while including other headers).
    
    This patch "fixes" such usage in
     - getuser.S for arm
     - putuser.S for arm

commit eb880e5457f8b4a61ff7fd36d47dd14fe51cb030
Author: Linus Torvalds <torvalds@ppc970.osdl.org>
Date:   Mon Apr 12 02:05:30 2004 -0700

    Delete unused files in sound/oss
    
    From Herbert Xu; the files aren't used anywhere, and
    shouldn't be there in the first place.

commit 309811e3e20d5b51c2a558108518a39e5e795dcf
Author: Dave Kleikamp <shaggy@austin.ibm.com>
Date:   Mon Apr 12 03:17:58 2004 -0500

    JFS: Fix race in jfs_sync
    
    Don't let final iput happen while jfs_sync is processing inode.

commit 6088582c2bc76462716daa9fe84dbd82259ff8bf
Author: Jean Delvare <khali@linux-fr.org>
Date:   Mon Apr 12 01:17:46 2004 -0700

    [PATCH] I2C: No reset not limit init in via686a
    
    The following patch removes limits initialization in the via686a driver.
    It was decided some times ago that this belongs to user-space, not
    kernel. See the thread here:
    http://archives.andrew.net.au/lm-sensors/msg06134.html
    
    It also prevents the sensor chip from being savagely reset at load time.
    This too follows a decision taken long ago that drivers should do as
    little as possible in their init procedure. See the thread here:
    http://archives.andrew.net.au/lm-sensors/msg04593.html
    
    This should make the driver smaller, safer and faster to load. The same
    was done to our 2.4/CVS version of the driver 5 months ago and it seems
    to work just fine.

commit 02dd2c14cfe4daefde15497c96cc15eef4724e8f
Author: Jean Delvare <khali@linux-fr.org>
Date:   Mon Apr 12 01:17:24 2004 -0700

    [PATCH] I2C: Fix voltage rounding in lm80
    
    This one line patch fixes voltage rounding in the lm80 chip driver.

commit 998f14c4b726ca273f59b787aa22705030a102ba
Author: Mark M. Hoffman <mhoffman@lightlink.com>
Date:   Mon Apr 12 01:17:01 2004 -0700

    [PATCH] I2C: fix asb100 bug
    
    Hi nymisi, Greg:
    
    * Nyeste Mih√°ly <nymisi@freemail.hu> [2004-01-27 16:02:04 +0100]:
    > Hi!
    >
    > I reported a bug of asb100 chip at:
    > http://www2.lm-sensors.nu/~lm78/readticket.cgi?ticket=1539
    >
    > The reply was the follow:
    >
    > "Is there a BIOS option you can disable, e.g. Asus "COP",
    > "QFAN", or some such?  My guess is that the BIOS is
    > somehow interfering with the asb100 driver.  Otherwise
    > I don¬¥t know how this could happen.
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    
    Yeah, I wrote that.
    
    "You do that, you go to the box, you know.  Two minutes by
    yourself, and you feel shame, you know." - Denis the goalie
    
    Greg, please apply this fix (vs. 2.6.5):

commit 07b21537c76e6734d678099bea4a497d10693d04
Author: Jean Delvare <khali@linux-fr.org>
Date:   Mon Apr 12 01:16:36 2004 -0700

    [PATCH] I2C: make I2C chip drivers return -EINVAL on error

commit a30b044ac7194c0a7ce973a8f592b0008c6ec731
Author: Jean Delvare <khali@linux-fr.org>
Date:   Mon Apr 12 01:16:08 2004 -0700

    [PATCH] I2C: pwm support in w83781d.c
    
    Here is a general pwm support cleanup patch for the w83781d chip driver.
    Featuring:
    
    * Don't pretend that we handle PWM on AS99127F chips. We don't know how
    it works, and one of the register we are accessing for now is clearly
    not a PWM register, and changing its value usually breaks temperature
    readings.
    
    * Discard irrelevant comments.
    
    * Rewrite show_pwmenable_reg. It was obviously taken from the 2.4
    driver, with unneeded tests and the code was much too complicated
    anyway. And now we handle errors correctly.
    
    * Initialize pwm_enable at load time. So far it was done conditionally
    (if init=1) while it should always be done. And pwm2_enable wasn't read
    from the chip, while it should.
    
    I could test that my AS99127F doesn't expose pwm files through ssysfs
    anymore. Which means that I couldn't test the rest of the pwm changes,
    unfortunately.
    
    I've applied similar changes to our 2.4/CVS repository.

commit ee23f4b726fef7381d9fe851efa35dcfc482a54c
Author: Jean Delvare <khali@linux-fr.org>
Date:   Mon Apr 12 01:15:36 2004 -0700

    [PATCH] I2C: Error paths in it87 and via686a drivers
    
    Here comes the patch that fixes error paths in the it87 and via686a
    detection functions. The it87 part also adds missing error values.

commit 2dbac5971bcb467b73346b04281da95d96b74f17
Author: Jean Delvare <khali@linux-fr.org>
Date:   Mon Apr 12 01:15:13 2004 -0700

    [PATCH] I2C: Rework memory allocation in i2c chip drivers
    
    Additional remarks:
    
    1* This patch also removes an unused struct member in via686a and fixes
    an error message in ds1621.
    
    2* I discovered error path problems in it87 and via686a detection
    functions. For the it87, I think that this patch makes it even more
    broken. I will fix both drivers in a later patch (really soon).

commit 469e04de313aa6a55462d052bdfa869189e3b11c
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon Apr 12 01:07:11 2004 -0700

    [PATCH] Oprofile: ARM/XScale PMU driver
    
    From: Zwane Mwaikambo <zwane@linuxpower.ca>
    
    The following patch adds support for the XScale performance monitoring unit
    to OProfile.  It uses not only the performance monitoring counters, but
    also the clock cycle counter (CCNT) allowing for upto 5 usable counters.
    
    The code has been developed and tested on an IOP331 (hardware courtesy of
    Intel) therefore i haven't been able to test it on XScale PMU1 systems.
    Testing on said systems would be appreciated, and if done, please uncomment
    the #define DEBUG line at the top of op_model_xscale.c
    
    OProfile userspace support has already been committed and should be
    available via CVS.

commit 6451af4da3e2aee9c8d65f75002e7a80dfd185e5
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon Apr 12 01:06:59 2004 -0700

    [PATCH] pmdisk is x86 only
    
    Only x86 implements pmdisk_arch_suspend().  So mark pmdisk as ia32-only, to
    avoid breaking allyesconfig.

commit f2b12e0966f8427aa45007aac377052d0c79d668
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon Apr 12 01:06:45 2004 -0700

    [PATCH] cciss_scsi warning
    
    drivers/block/cciss_scsi.c: In function `scsi_cmd_stack_free':
    drivers/block/cciss_scsi.c:241: warning: cast from pointer to integer of different size

commit e43bd8693735488f5756ed5b9b0e1ff0bbaf2ec5
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon Apr 12 01:06:33 2004 -0700

    [PATCH] cciss: /proc fix
    
    From: <mikem@beardog.cca.cpqcorp.net>
    
    This patch fixes a bug where /proc displays 1 less logical volume than is
    actually configured.  This causes problems for some installers.

commit c28abd70dfe80c4806d0b39fa7314aa50754dbf3
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon Apr 12 01:06:19 2004 -0700

    [PATCH] JBD: BH_Revoke cleanup
    
    Use the bh bit test/set infrastructure rather than open-coding everything.
    No functional changes.

commit d0d15d849f62d00edbc95de914f3bc655d3b8f7b
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon Apr 12 01:06:06 2004 -0700

    [PATCH] Add CONFIG_SYSFS
    
    From: Patrick Mochel <mochel@digitalimplant.org>
    
    Here is a patch to make sysfs optional.  Note that with CONFIG_SYSFS=n you
    must specify the boot device's major:minor on the kernel boot command line
    with
    
    	root=03:01
    
    For embedded systems, it will save a significant amount of memory during
    runtime.  And, it saves 4k from the built kernel image for me.

commit e4730c3ececcceb36c8cc4d8c8e0569e09e7894b
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon Apr 12 01:05:52 2004 -0700

    [PATCH] parport: no procfs warning fix
    
    drivers/parport/procfs.c: In function `parport_default_proc_unregister':
    drivers/parport/procfs.c:529: warning: `return' with a value, in function returning void

commit 07e5823127155b3a29003aca926f87c9843f6810
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon Apr 12 01:05:40 2004 -0700

    [PATCH] kbuild: external module support
    
    From: Sam Ravnborg <sam@ravnborg.org>
    
    Based on initial patch from Andreas Gruenbacher there is now better support
    for building external modules with kbuild.
    
    The preferred syntax is now:
    make -C $KERNELSRC M=$PWD
    
    but the old syntax:
    make -C $KERNELSRC SUBDIRS=$PWD modules
    will remain supported.
    
    The major differences compared to before are that:
    1) No attempt is made to neither check nor update any files in $KERNELSRC
    2) Module versions are now supported
    
    During stage 2 of kernel compilation where the modules are built, a new file
    Module.symvers is created.  This file contains the version for all symbols
    exported by the kernel and any module compiled within the kernel tree.
    
    When the external module is build the Module.symvers file is being read and
    symbol versions are used from that file.
    
    The purpose of avoiding any updates in the kernel src is that usually in a
    distribution the kernel src will be read-only, and there is no need to try to
    update it.  And when building an external module the focus is on the module,
    not the kernel.
    
    I expect the distributions will start using something like this:
    
    kernel src - with no generated files. Not even .config:
    /usr/src/linux-<version>
    
    Output from build:
    /lib/modules/linux-<version>/build
    
    where build is a real directory with relevant output files and the
    appropriate .config.
    
    I have some Documentation in the pipe-line, but wants to see how this
    approach is received before completing it.
    
    This patch is made on top of the previously posted patch to divide
    make clean in three steps.
    
    And you may need to edit the following line in the patch to make it apply:
     %docs: scripts_basic FORCE
    to
     %docs: scripts FORCE

commit a065cde36a7889a058dcbcbebfb01c78cc19b0a8
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon Apr 12 01:05:26 2004 -0700

    [PATCH] kbuild: cleaning in three steps
    
    From: Sam Ravnborg <sam@ravnborg.org>
    
    Previously 'make clean' deleted all automatically generated files.  The
    following patch revert this behaviour, and now 'make clean' leaves enough
    behind to allow external modules to be built.
    
    The cleaning is now done in three steps:
    
    make clean     - delete everything not needed for building external modules
    make mrproper  - delete all generated files, including .config
    make distclean - delete all temporary files such as *.orig, *~, *.rej etc.
    
    This fixes reports about nvidia and vmware build issues.

commit c70b9371a50789aa84ee802013eb627bb875ff4f
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon Apr 12 01:05:14 2004 -0700

    [PATCH] Make %docs depend on scripts_basic
    
    From: Sam Ravnborg <sam@ravnborg.org>
    
    From: Herbert Xu <herbert@gondor.apana.org.au>
    
    It seems that the %docs targets only needs scripts_basic.  The following
    patch does just that.  This removes its dependency on the existence of a
    .config file.

commit 9a6c9ba25d626c3fbb15cb262ea30e528f8a48f2
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon Apr 12 01:04:59 2004 -0700

    [PATCH] fb_copy_cmap() fix
    
    From: Arjan van de Ven <arjanv@redhat.com>
    
    fb_copy_cmap() takes an argument about wether to do memcpy, copy_from_user or
    copy_to_user.  0 is memcpy, 2 is copy_to_user.  In the ioctl you want
    copy_to_user for copying the colormap to userspace.

commit e01d652a1e635ecb86d30c6537e45a7123deed28
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon Apr 12 01:04:47 2004 -0700

    [PATCH] framebuffer bugfix
    
    From: Arjan van de Ven <arjanv@redhat.com>
    
    Patch below fixes a thinko in the frame buffer drivers; the code does
    
    cursor.image.data = kmalloc(size, GFP_KERNEL);
    ....
    cursor.mask = kmalloc(size, GFP_KERNEL);
    ....
                    if (copy_from_user(&cursor.image.data, sprite->image.data, size) ||
                        copy_from_user(cursor.mask, sprite->mask, size)) {
    ....
    
    where it's clear that the & in the first copy_from_user is utterly bogus
    since the destination is the content of the newly allocated buffer, and not
    the pointer to it as the code does.

commit 7285840f8745b467b111a908eb20a1d9b845c98c
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon Apr 12 01:04:34 2004 -0700

    [PATCH] BSD accounting oops fix
    
    oopses have been reported in do_acct_process(), with premption enabled, when
    threaded applications are exitting.
    
    It appears that we're racing with another thread which is nulling out
    current->tty.  I think this race is still there after we moved current->tty
    into current->signal->tty, so let's take the needed lock.

commit 177ddd528e5dd02a1093a539474d7556f3c36b99
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon Apr 12 01:04:21 2004 -0700

    [PATCH] tpqic02 warnings
    
    drivers/char/tpqic02.c: In function `rdstatus':
    drivers/char/tpqic02.c:700: warning: int format, different type arg (arg 2)
    drivers/char/tpqic02.c:700: warning: int format, different type arg (arg 2)

commit fe91397f4907b76885a2fccdfdfb225206496c3d
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon Apr 12 01:04:08 2004 -0700

    [PATCH] applicom warnings and usercopy-in-cli fix
    
    drivers/char/applicom.c: In function `ac_write':
    drivers/char/applicom.c:363: warning: int format, different type arg (arg 2)
    drivers/char/applicom.c:363: warning: int format, different type arg (arg 3)
    drivers/char/applicom.c:363: warning: int format, different type arg (arg 2)
    drivers/char/applicom.c:363: warning: int format, different type arg (arg 3)
    drivers/char/applicom.c:523:2: warning: #warning "Je suis stupide. DW. - copy*user in cli"
    drivers/char/applicom.c: In function `ac_read':
    drivers/char/applicom.c:546: warning: int format, different type arg (arg 2)
    drivers/char/applicom.c:546: warning: int format, different type arg (arg 3)
    drivers/char/applicom.c:546: warning: int format, different type arg (arg 2)
    drivers/char/applicom.c:546: warning: int format, different type arg (arg 3)

commit c40853f23d2a575abf72c704c098710681d7c002
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon Apr 12 01:03:56 2004 -0700

    [PATCH] policydb printk warnings
    
    security/selinux/ss/policydb.c:1160: warning: signed size_t format, different type arg (arg 3)
    security/selinux/ss/policydb.c:1160: warning: signed size_t format, different type arg (arg 3)

commit 9c8b76eb5e417e5e8f33338a9fff1636a092e118
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon Apr 12 01:03:42 2004 -0700

    [PATCH] i2c-dev warning fixes
    
    drivers/i2c/i2c-dev.c: In function `i2cdev_read':
    drivers/i2c/i2c-dev.c:140: warning: int format, different type arg (arg 3)
    drivers/i2c/i2c-dev.c: In function `i2cdev_write':
    drivers/i2c/i2c-dev.c:168: warning: int format, different type arg (arg 3)

commit 8447ac2688647d261af7a7397a53548a2a1afc13
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon Apr 12 01:03:29 2004 -0700

    [PATCH] Rename bitmap_clear to bitmap_zero, remove CLEAR_BITMAP
    
    From: Rusty Russell <rusty@rustcorp.com.au>
    
    clear_bit(n, addr) clears the nth bit.
    test_and_clear_bit(n, addr) clears the nth bit.
    cpu_clear(n, cpumask) clears the nth bit (vs. cpus_clear()).
    bitmap_clear(bitmap, n) clears out all the bits up to n.
    
    Moreover, there's a CLEAR_BITMAP() in linux/types.h which bitmap_clear() is
    a wrapper for.
    
    Rename bitmap_clear to bitmap_zero, which is harder to confuse (yes, it bit
    me), and make everyone use it.

commit 6ab26f0a7443f4d4e2b13c31717088ad410cb64b
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon Apr 12 01:03:15 2004 -0700

    [PATCH] Fix More Problems Introduced By Module Structure Added in modpost.c
    
    From: Rusty Russell <rusty@rustcorp.com.au>
    
    Sam Ravnborg found these.
    
    1) have_vmlinux is a global, and should not be reset every time.
    
    2) We pretend every module needs cleanup_module so it gets versioned,
       but that isn't defined for CONFIG_MODULE_UNLOAD=n.
    
    3) The visible effect of this is that modpost will start complaning about
       undefined symbols - previously this happened only when the module was
       isntalled.

commit 2386894043fc3be2c0d2d25edb8c741f18c592ec
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon Apr 12 01:03:03 2004 -0700

    [PATCH] do_fork() error path memory leak
    
    From: <john.l.byrne@hp.com>
    
    In do_fork(), if an error occurs after the mm_struct for the child has been
    allocated, it is never freed.  The exit_mm() meant to free it increments
    the mm_count and this count is never decremented.  (For a running process
    that is exitting, schedule() takes care this; however, the child process
    being cleaned up is not running.) In the CLONE_VM case, the parent's
    mm_struct will get an extra mm_count and so it will never be freed.
    
    This patch should fix both the CLONE_VM and the not CLONE_VM case; the test
    of p->active_mm prevents a panic in the case that a kernel-thread is being
    cloned.

commit 94ce318546808714dbbdc8a00a1332df9ab79fad
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon Apr 12 01:02:49 2004 -0700

    [PATCH] mdacon.c warning fix.
    
    From: "Luiz Fernando N. Capitulino" <lcapitulino@prefeitura.sp.gov.br>
    
    drivers/video/console/mdacon.c:599: warning: initialization from incompatible pointer type

commit 8afc52a52f1a0a732929d226b62f0a3846cf5056
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon Apr 12 01:02:37 2004 -0700

    [PATCH] fix for potential integer overflow in zoran driver
    
    From: "Ronald S. Bultje" <R.S.Bultje@students.uu.nl>
    
    Attached patch fixes a potential integer overflow in zoran_procs.c (part of
    the zr36067 driver).  Bug was detected by Ken Ashcraft with the Stanford
    checker.

commit de2350c597517585bdd10283832c6b55b0a0ce03
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon Apr 12 01:02:23 2004 -0700

    [PATCH] ext3fs sb= mount option fix
    
    From: <achurch@achurch.org> (Andrew Church)
    
    The following patch fixes a bug in the processing of the sb= (alternate
    superblock) mount option for ext3: when changing the device block size, the
    given superblock is ignored and the code reverts to using block 1.

commit 27efbbafb2201ec9d5d83ca44e39a0f1f911c110
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon Apr 12 01:02:11 2004 -0700

    [PATCH] ext2fs sb= mount option fix
    
    From: <achurch@achurch.org> (Andrew Church)
    
    The following patch fixes a bug in the processing of the sb= (alternate
    superblock) mount option for ext2: when changing the device block size, the
    given superblock is ignored and the code reverts to using block 1.

commit dbb1a307d5ba76355030e7bb4200fbef1a659539
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon Apr 12 01:01:57 2004 -0700

    [PATCH] fix test_and_change_bit comment
    
    From: Paul Jackson <pj@sgi.com>
    
    I've read over the code in each case, built and ran a test case for i386 in
    particular, and studied the other uses and definitions of
    test_and_change_bit().  Everything I see recommends this change.
    
    - Fix test_and_change_bit() comment: returns old value, not new one.

commit ed459323250efe979acbbc6c34b91047b39c078c
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon Apr 12 01:01:45 2004 -0700

    [PATCH] make ibmasm driver uart support depend on SERIAL_8250
    
    From: Max Asbock <masbock@us.ibm.com>
    
    This patch makes serial line registration in the ibmasm service processor
    driver depend on CONFIG_SERIAL_8250.  Previously the driver wouldn't
    compile when serial driver support wasn't enabled.

commit 4fbd14380484c466338108b59fbc04062c01f1df
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon Apr 12 01:01:30 2004 -0700

    [PATCH] Fix Raid5/6 above 2 Terabytes
    
    From: Evan Felix <evan.felix@pnl.gov>
    
    Here is a patch that fixes a major issue in the raid5/6 code.  It seems
    that the code:
    
    logical_sector = bi->bi_sector & ~(STRIPE_SECTORS-1);
    (sector_t)     = (sector_t)    & (constant)
    
    that the right side of the & does not get extended correctly when the
    constant is promoted to the sector_t type.  I have CONFIG_LBD turned on so
    sector_t should be 64bits wide.  This fails to properly mask the value of
    4294967296 (2TB/512) to 4294967296.  in my case it was coming out 0.  this
    cause the loop following this code to read from 0 to 4294967296 blocks so
    it could write one character.
    
    As you might imagine this makes a format of a 3.5TB filesystem take a very
    long time.

commit dfe2c6262c7cffaa5087d6562cacbbf406594df0
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon Apr 12 01:01:18 2004 -0700

    [PATCH] remove concatenation with __FUNCTION__ sound/*
    
    From: Tony Breeds <tony@bakeyournoodle.com>

commit 93616c25b89090f28ad3ee509c33d69bddbeb7a8
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon Apr 12 01:01:04 2004 -0700

    [PATCH] remove concatenation with __FUNCTION__ include/*
    
    From: Tony Breeds <tony@bakeyournoodle.com>

commit a562b03a367cac8c622316177a2d8846f3ba33a2
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon Apr 12 01:00:51 2004 -0700

    [PATCH] remove concatenation with __FUNCTION__ drivers/*
    
    From: Tony Breeds <tony@bakeyournoodle.com>

commit 0f3fa4b042615894738e77576fe9181338c689b3
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon Apr 12 01:00:37 2004 -0700

    [PATCH] remove concatenation with __FUNCTION__ arch/*
    
    From: Tony Breeds <tony@bakeyournoodle.com>

commit c1179fa6c49d2fe39bae7f00c19462c87b6a2f48
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon Apr 12 01:00:24 2004 -0700

    [PATCH] don't offer GEN_RTC on ia64
    
    From: Bjorn Helgaas <bjorn.helgaas@hp.com>
    
    gen_rtc.c doesn't work on ia64 (we don't have asm/rtc.h, for starters), so
    don't offer it there.

commit 423f871bbcfa64ff19c010752f1b2612f73b58bd
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon Apr 12 01:00:11 2004 -0700

    [PATCH] pdaudiocf.c needs init.h
    
    From: Herbert Xu <herbert@gondor.apana.org.au>
    
    This patch makes this file includes linux/init.h since it uses the __init
    tag.

commit 025f1e99e6fd94d7d4073ed16c490aae0b4b560c
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon Apr 12 00:59:59 2004 -0700

    [PATCH] saa7134 - Add two inputs for Asus TV FM
    
    From: Martin Hicks <mort@bork.org>
    
    I just bought an ASUS TV FM capture card, based on the saa7134 chip.  It only
    had one input specified, coax.  This patch adds the Composite and S-Video
    inputs.  It seems to work correctly for me.

commit 70fef640e704e24c9f053382582bbdbe52453793
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon Apr 12 00:59:45 2004 -0700

    [PATCH] Fix parportbook build again
    
    From: Herbert Xu <herbert@gondor.apana.org.au>
    
    The previous fix causes a syntax error when building:
    
    Working on: /home/gondolin/herbert/src/debian/work/kernel/build/2.6/kernel-source-2.6.5-2.6.5/Documentation/DocBook/parportbook.sgml
    jade:/home/gondolin/herbert/src/debian/work/kernel/build/2.6/kernel-source-2.6.5-2.6.5/Documentation/DocBook/parportbook.sgml:4059:2:E: invalid comment declaration: found character "!" outside comment but inside comment declaration
    jade:/home/gondolin/herbert/src/debian/work/kernel/build/2.6/kernel-source-2.6.5-2.6.5/Documentation/DocBook/parportbook.sgml:4058:0: comment declaration started here
    jade:/home/gondolin/herbert/src/debian/work/kernel/build/2.6/kernel-source-2.6.5-2.6.5/Documentation/DocBook/parportbook.sgml:4059:4:E: character data is not allowed here
    
    This patch removes the offending line completely since that file is probably
    not coming back anyway.

commit 340a59bfa70710094f1745417817c87f60e3e291
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon Apr 12 00:59:33 2004 -0700

    [PATCH] QD65xx I/O ports fix
    
    From: Geert Uytterhoeven <geert@linux-m68k.org>
    
    I/O port numbers can be larger than 8-bit on many platforms (this caused a
    warning when {out,in}b() cast reg to a pointer on platforms with memory
    mapped I/O)

commit 832c2852492d791d4973e8176dbfc3b6df807ace
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon Apr 12 00:59:19 2004 -0700

    [PATCH] isicom error path fix
    
    From: Geert Uytterhoeven <geert@linux-m68k.org>
    
    Variable error is not initialized, but printed if tty_unregister_driver()
    fails.

commit 3894c1f1efa539e1f5c3c1c513ff5b627f10175c
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon Apr 12 00:59:06 2004 -0700

    [PATCH] DVB dependency fix
    
    From: Geert Uytterhoeven <geert@linux-m68k.org>
    
    DVB_TWINHAN_DST depends on DVB_BT8XX (dependency is explicitly mentioned in
    help text, but not enforced)

commit f2973ffbce8baf0a7931da6498fea9d3044afd71
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon Apr 12 00:58:53 2004 -0700

    [PATCH] parport dependency fix
    
    From: Geert Uytterhoeven <geert@linux-m68k.org>
    
    PCI multi-IO card support depends on PCI

commit 488ddba584b5a734a28d1d2c0a66ffb093855ea0
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon Apr 12 00:58:40 2004 -0700

    [PATCH] isicom.c: unused vars
    
    From: Geert Uytterhoeven <geert@linux-m68k.org>
    
    Recent serial changes moved some code, causing unused variable warnings.

commit 90cfa1691dd523db7b712f58c015eba223e21000
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon Apr 12 00:58:27 2004 -0700

    [PATCH] isicom.c: jiffies must be unsigned long
    
    From: Geert Uytterhoeven <geert@linux-m68k.org>
    
    jiffies must be unsigned long

commit dd151b39c4bde217cef5a32b7066521346717b06
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon Apr 12 00:58:14 2004 -0700

    [PATCH] get_user_pages shortcut for anonymous pages
    
    From: Martin Schwidefsky <schwidefsky@de.ibm.com>
    
    The patch avoids the instantiation of pagetables for not-present pages in
    get_user_pages().  Without this, the coredump code can cause total memory
    exhaustion in pagetables.  Consider a store to current stack - 1TB.  The
    stack vma is extended to include this address because of VM_GROWSDOWN.  If
    such a process dies (which is likely for a defunc process) then the elf core
    dumper will cause the system to hang because of too many page tables.
    
    We especially recognise this situation and simply return a ref to the zero
    page.

commit a3f84eac096459b75c28365c63b869b0dc88898e
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon Apr 12 00:58:01 2004 -0700

    [PATCH] Correct kernel-doc comment with incorrect parameters documented
    
    From: "Randy.Dunlap" <rddunlap@osdl.org>
    
    From: Michael Still <mikal@stillhq.com>
    
    Correct kernel-doc comment with incorrect parameters documented

commit d386fe6e327eb7d7808e5cf69fceaba671621ef8
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon Apr 12 00:57:48 2004 -0700

    [PATCH] Swsusp should not wake up stopped processes
    
    From: Pavel Machek <pavel@suse.cz>
    
    If you stop process with ^Z, then suspend, process is awakened.  Thats a
    bug.  Solution is to simply leave already stopped processes alone.  Plus we
    no longer use TASK_STOPPED for processes in refrigerator.  Userland might
    see us and get confused.

commit 2c22f5c85acb9bc1bc6cde1167d2836b0b3868e1
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon Apr 12 00:57:34 2004 -0700

    [PATCH] swsusp update: supports discontingmem/highmem fixes
    
    From: Pavel Machek <pavel@ucw.cz>
    
    It makes swsusp behave correctly w.r.t.  discontingmem, and adds highmem
    handling.

commit 69a03dedc92b7968fc9ca5c701e8d2d6c481750d
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon Apr 12 00:57:22 2004 -0700

    [PATCH] swsusp update: supports discontingmem/highmem
    
    From: Pavel Machek <pavel@ucw.cz>
    
    Bill Irwin did some work on this.  It makes swsusp behave correctly w.r.t.
    discontingmem, and adds highmem handling (very simple-minded, but should work
    ok with 1GB).  It now should behave correctly w.r.t.  more than one swap
    device, and fixes double restoring of console.

commit 31a359d2a66831b23be5baba111107d9e63b6fa8
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon Apr 12 00:57:08 2004 -0700

    [PATCH] i386 probe_roms(): fixes
    
    From: Rene Herman <rene.herman@keyaccess.nl>
    
    This patch tries to improve the i386/mach-default probe_roms().  This also
    c99ifies the data, adds an IORESOURCE_IO flag for the I/O port resources,
    an IORESOURCE_MEM flag for the VRAM resource, IORESOURCE_READONLY |
    IORESOURCE_MEM for the ROM resources and adds two additional "adapter ROM
    slots" (for a total of 6) since it now also scans the 0xe0000 segment.

commit 816d607321a4ec72f203d350f93e027e3434d7a4
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon Apr 12 00:56:55 2004 -0700

    [PATCH] i386 probe_roms(): preparation
    
    From: Rene Herman <rene.herman@keyaccess.nl>
    
    The i386 probe_roms() function has a fair number of problems currently:
    
    - When you actually have an adapter ROM in the machine, your video ROM
      disappears.  This is due to the pc9800 subarch merge that split it up in
      probe_video_rom(int roms) and probe_extension_roms(int roms), but expects a
      "roms++" in probe_video_roms() to have an effect outside of that function.
    
    - The majority of VGA adapters these days host a ROM larger then 32K, yet
      the current code hardcodes a 32K ROM.  The VGA BIOS "length" byte is
      normally valid (it in fact needs to be for a regular mainboard BIOS to
      accept it) and I've verified on a few dozen very new to very old VGAs that
      it is.  However, assuming someone actually did not check for the length and
      checksum there for a reason, the safe thing to do here is accept the length
      byte when we also get a valid checksum.
    
    - The current code scans 0xc0000 to 0xdffff for a video ROM while the
      standard PC thing to do (that which the BIOS does) is only scan for a video
      ROM starting between 0xc0000 and 0xc7fff.  This means that on a headless-
      (or BIOS-less monochrome adapter-) box, the first adapter ROM found
      triggers the registration of a 32K "Video ROM" at hardcoded address
      0xc0000, even when _nothing_ is present between 0xc0000 and 0xc7fff.
    
    - The current adapter ROM scan stops at 0xdffff, whether or not an
      extension ROM is present at 0xe0000.  The PC thing to do is scan 0xc8000
      upto 0xdffff if an extension ROM is present, and upto 0xeffff when it's not
      (it's not/hardly ever).
    
    - Adapter ROMs are called "Extension ROM", but the latter term is really
      better reserved for a motherboard extension ROM.
    
    - Currently, the code happily starts scanning through a ROM it just
      registered looking for the next one (just does += 2048, even when that's
      inside the previous ROM) which is at least silly.
    
    Unfortunately, this code is "subarched" between mach-default and
    mach-pc9800, meaning the patch got a bit involved. Currently all this
    code, and gobs of data, is defined (not just declared) in the header:
    
       include/asm-i386/mach-{default,pc9800}/mach_resources.h
    
    which isn't nice. That .h really wants to be a .c. The first patch, in
    the next message, does not change any code but only undoes the
    probe_video_rom / probe_extension_roms split and moves the code to a new
    file
    
       arch/i386/mach-{default,pc9800}/std_resources.c
    
    with a header
    
       include/asm-i386/std_resources.h
    
    for the prototypes only. The second patch overhauls the code itself for
    mach-default. Please see comments on top of that patch for (yet more)
    comments. It's tested on various machines, with and without adapter ROMs.
    
    I haven't touched pc9800. Nothing should have changed though. The pc9800
    author, as given in the code, is CCed.
    
    Also, x86-64 inherits the probe_roms() code from 2.4, and while it
    doesn't have the subarch specific problems, it has all others. I'll
    convert it to if this i386 version is deemed desirable.
    
    
    
    This patch doesn't change any code, just moves stuff from the
    "mach_resources.h" header to a "std_resources.c" subarch specific file, and
    introduces a "std_resources.h" header for the prototypes.

commit a1fa32d72861365f10e584421cdb0d932b1ce03c
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon Apr 12 00:55:49 2004 -0700

    [PATCH] jbd: b_transaction zeroing cleanup
    
    Almost everywhere where JBD removes a buffer from the transaction lists the
    caller then nulls out jh->b_transaction.  Sometimes, the caller does that
    without holding the locks which are defined to protect b_transaction.  This
    makes me queazy.
    
    So change things so that __journal_unfile_buffer() nulls out b_transaction
    inside both j_list_lock and jbd_lock_bh_state().
    
    It cleans things up a bit, too.

commit cd5f8bb0fee0bdbeca2da7a2a8526944afe3939e
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon Apr 12 00:55:38 2004 -0700

    [PATCH] jbd: do_get_write_access lock contention reduction
    
    We're seeing heavy contention against j_list_lock on 8-way in
    do_get_write_access().
    
    We actually don't need j_list_lock in there except for one little case - the
    per-bh jbd_lock_bh_state() is sufficient to protect this buffer's internal
    state.
    
    On some nice quick LVM array Ram Pai measured an overall 3x speedup from this
    patch:
    
    the script took the following time on 265mm1
     real    0m57.504s
     user    0m0.400s
     sys     7m29.867s
    
    
     and with the 2patches it took
     real 	0m19.983s
     user    0m0.438s
     sys     1m55.896s

commit 073c11c2cb00ef491bf6d085b84ffe72c1462671
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon Apr 12 00:55:23 2004 -0700

    [PATCH] Feed floppy.c through Lindent
    
    From: "Randy.Dunlap" <rddunlap@osdl.org>

commit 0079e33e338af24fd44913bba1c335cda4b61d09
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon Apr 12 00:55:11 2004 -0700

    [PATCH] dnotify_parent speedup
    
    From: Anton Blanchard <anton@samba.org>
    
    Directory notify code was showing up in a dd bs=1024k from 2 raid arrays
    on an emulex FC adapter:
    
    3635     69.4896  vmlinux-2.6.5            .default_idle
    332       6.3468  vmlinux-2.6.5            .__copy_tofrom_user
    112       2.1411  vmlinux-2.6.5            .save_remaining_regs
    76        1.4529  vmlinux-2.6.5            .scsi_dispatch_cmd
    64        1.2235  vmlinux-2.6.5            .dnotify_parent
    61        1.1661  vmlinux-2.6.5            .do_generic_mapping_read
    
    We already have a sysctl to enable/disable it, the patch below uses it
    in dnotify_parent. dnotify_parent disappears and idle time goes up:
    
    4508     70.8582  vmlinux-2.6.5            .default_idle
    253       3.9767  vmlinux-2.6.5            .__copy_tofrom_user
    142       2.2320  vmlinux-2.6.5            .save_remaining_regs
    88        1.3832  vmlinux-2.6.5            .shrink_zone
    84        1.3203  vmlinux-2.6.5            .elx_drvr_unlock
    75        1.1789  vmlinux-2.6.5            .scsi_dispatch_cmd
    69        1.0846  vmlinux-2.6.5            .do_generic_mapping_read
    
    Of course, to gain this small speedup isers need to know to set
    /proc/sys/fs/dir-notify-enable to zero.  Nobody does that.

commit 2c1dcf6cdb93586b59b6d2d473de5a6607cf46ea
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon Apr 12 00:54:58 2004 -0700

    [PATCH] cyclades works OK on SMP
    
    From: Marcelo Tosatti <marcelo.tosatti@cyclades.com>
    
    The cyclades.c driver was marked BROKEN_ON_SMP during early 2.6.  It was
    fixed later on but the tag was left in Kconfig.
    
    The driver is not very smart wrt SMP locking, it can be improved.  There is
    only one spinlock per card which guarantees command block ordering and
    protects different shared data, which can be held for long periods.
    
    _But_ the locking works reliably, so remove the BROKEN_ON_SMP tag.

commit 66fb1123391ed704997523cb6daea7fae00dcb83
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon Apr 12 00:54:44 2004 -0700

    [PATCH] rename page_to_nodenum()
    
    From: "Martin J. Bligh" <mbligh@aracnet.com>
    
    I'd prefer we renamed this to page_to_nid() before anyone starts using it.
    This fits with the naming convention of everything else (pfn_to_nid, etc).
    Nobody uses it right now - I grepped the whole tree.

commit fbf7adfafae19dd118facbbfe011510ba6aa8315
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon Apr 12 00:54:31 2004 -0700

    [PATCH] rmap 3 arches + mapping_mapped
    
    From: Hugh Dickins <hugh@veritas.com>
    
    Some arches refer to page->mapping for their dcache flushing: use
    page_mapping(page) for safety, to avoid confusion on anon pages, which will
    store a different pointer there - though in most cases flush_dcache_page is
    being applied to pagecache pages.
    
    arm has a useful mapping_mapped macro: move that to generic, and add
    mapping_writably_mapped, to avoid explicit list_empty checks on i_mmap and
    i_mmap_shared in several places.
    
    Very tempted to add page_mapped(page) tests, perhaps along with the
    mapping_writably_mapped tests in do_generic_mapping_read and
    do_shmem_file_read, to cut down on wasted flush_dcache effort; but the
    serialization is not obvious, too unsafe to do in a hurry.

commit da47ca23dfeb76d99add903af69726ffcb2d999d
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon Apr 12 00:54:17 2004 -0700

    [PATCH] rw_swap_page_sync fixes
    
    Fix up the rw_swap_page_sync() gorrors by fully decoupling this function
    from the VM - it is now just a helper function which reads a page from or
    writes a page to swap.

commit 4875a6018bcc53201ddbf745bff35ed723b468eb
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon Apr 12 00:54:03 2004 -0700

    [PATCH] rmap 2 anon and swapcache
    
    From: Hugh Dickins <hugh@veritas.com>
    
    Tracking anonymous pages by anon_vma,pgoff or mm,address needs a
    pointer,offset pair in struct page: mapping,index the natural choice.  But
    swapcache uses those for &swapper_space,swp_entry_t.
    
    It's trivial to separate swapcache from pagecache with radix tree; most of
    swapper_space is actually unused, just a fiction to pretend swap like file;
    and page->private is a good place to keep swp_entry_t, now that swap never
    uses bufferheads.
    
    Define PG_anon bit, page_add_rmap SetPageAnon and put an oopsable address in
    page->mapping to test that we're not confused by it.  Define
    page_mapping(page) macro to give NULL when PageAnon, whatever may be in
    page->mapping.  Define PG_swapcache bit, deduce swapper_space from that in
    the few places we need it.
    
    add_to_swap_cache now distinct from add_to_page_cache.  Separating the caches
    somewhat simplifies the tmpfs swizzling in swap_state.c, now the page can
    briefly be in both caches.
    
    The rmap method remains pte chains, no change to that yet.  But one small
    functional difference: the use of PageAnon implies that a page truncated
    while still mapped will no longer be found and freed (swapped out) by
    try_to_unmap, will only be freed by exit or munmap.  But normally pages are
    unmapped by vmtruncate: this should only affect nonlinear mappings, and a
    later patch not in this batch will fix that.

commit 4c4acd2447ef473f23aee53f04518f93840a8693
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon Apr 12 00:53:50 2004 -0700

    [PATCH] rmap 1 linux/rmap.h
    
    From: Hugh Dickins <hugh@veritas.com>
    
    First of a batch of three rmap patches: this initial batch of three paving
    the way for a move to some form of object-based rmap (probably Andrea's, but
    drawing from mine too), and making almost no functional change by itself.  A
    few days will intervene before the next batch, to give the struct page
    changes in the second patch some exposure before proceeding.
    
    rmap 1 create include/linux/rmap.h
    
    Start small: linux/rmap-locking.h has already gathered some declarations
    unrelated to locking, and the rest of the rmap declarations were over in
    linux/swap.h: gather them all together in linux/rmap.h, and rename the
    pte_chain_lock to rmap_lock.

commit 3e2ea65d7be031644c6d6a3ed5bd89af5ef2f090
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon Apr 12 00:16:44 2004 -0700

    [PATCH] CFQ io scheduler
    
    From: Jens Axboe <axboe@suse.de>
    
    CFQ I/O scheduler

commit 1dc841edc41a3014ece92b72013b3b57b0424e6b
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon Apr 12 00:16:32 2004 -0700

    [PATCH] Correct unplugs on nr_queued
    
    From: Jens Axboe <axboe@suse.de>
    
    There's a small discrepancy in when we decide to unplug a queue based on
    q->unplug_thresh.  Basically it doesn't work for tagged queues, since
    q->rq.count[READ] + q->rq.count[WRITE] is just the number of allocated
    requests, not the number of requests stuck in the io scheduler.  We could
    just change the nr_queued == to a nr_queued >=, however that is still
    suboptimal.
    
    This patch adds accounting for requests that have been dequeued from the io
    scheduler, but not freed yet.  These are q->in_flight.  allocated_requests
    - q->in_flight == requests_in_scheduler.  So the condition correctly
    becomes
    
    	if (requests_in_scheduler == q->unplug_thresh)
    
    instead.  I did a quick round of testing, and for dbench on a SCSI disk the
    number of timer induced unplugs was reduced from 13 to 5 :-).  Not a huge
    number, but there might be cases where it's more significant.  Either way,
    it gets ->unplug_thresh always right, which the old logic didn't.

commit 66db15b4577185624ae95ffe99a66305c8c63ef7
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon Apr 12 00:16:17 2004 -0700

    [PATCH] unplugging: md update
    
    From: Neil Brown <neilb@cse.unsw.edu.au>
    
    I've made a bunch of changes to the 'md' bits - largely moving the
    unplugging into the individual personalities which know more about which
    drives are actually in use.

commit b1c72a96797037b7e62c1fc02bfefbb157ff5f48
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon Apr 12 00:16:04 2004 -0700

    [PATCH] Use BIO_RW_SYNC in swap write page
    
    From: Jens Axboe <axboe@suse.de>
    
    Dog slow software suspend found this one. If WB_SYNC_ALL, then you need
    to mark the bio as sync as well.
    
    This is because swap_writepage() does a remove_exclusive_swap_page() (going
    to __delete_from_swap_cache -> __remove_from_page_cache) which can kill
    page->mapping, thus aops->sync_page() has nothing to work with for unplugging
    the address space.

commit 6d27f67bf6ee2b9ad0c8814118264bc273d916a1
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon Apr 12 00:15:51 2004 -0700

    [PATCH] per-backing dev unplugging
    
    From: Jens Axboe <axboe@suse.de>,
          Chris Mason,
          me, others.
    
    The global unplug list causes horrid spinlock contention on many-disk
    many-CPU setups - throughput is worse than halved.
    
    The other problem with the global unplugging is of course that it will cause
    the unplugging of queues which are unrelated to the I/O upon which the caller
    is about to wait.
    
    So what we do to solve these problems is to remove the global unplug and set
    up the infrastructure under which the VFS can tell the block layer to unplug
    only those queues which are relevant to the page or buffer_head whcih is
    about to be waited upon.
    
    We do this via the very appropriate address_space->backing_dev_info structure.
    
    Most of the complexity is in devicemapper, MD and swapper_space, because for
    these backing devices, multiple queues may need to be unplugged to complete a
    page/buffer I/O.  In each case we ensure that data structures are in place to
    permit us to identify all the lower-level queues which contribute to the
    higher-level backing_dev_info.  Each contributing queue is told to unplug in
    response to a higher-level unplug.
    
    To simplify things in various places we also introduce the concept of a
    "synchronous BIO": it is tagged with BIO_RW_SYNC.  The block layer will
    perform an immediate unplug when it sees one of these go past.

commit 3749bf2c1fb31ffd3f95b9843890a7132fa06c06
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon Apr 12 00:15:36 2004 -0700

    [PATCH] dmL remove __dm_request
    
    From: Joe Thornber <thornber@redhat.com>
    
    dm.c: remove __dm_request (merge with previous patch).

commit 1fe10e2fe95d278cc83226abfb7fa4bf2adb92df
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon Apr 12 00:15:25 2004 -0700

    [PATCH] Implement queue congestion callout for device mapper
    
    From: Miquel van Smoorenburg <miquels@cistron.nl>
          Joe Thornber <thornber@redhat.com>
    
    This implements the queue congestion callout for DM stacks.  To make
    bdi_read/write_congested() return correct information.
    
    - md->lock protects all fields in md _except_ md->map
    - md->map_lock protects md->map
    - Anyone who wants to read md->map should use dm_get_table() which
      increments the tables reference count.
    
    This means the spin lock is now only held for the duration of a
    reference count increment.
    
    Udpate:
    
    dm.c: protect md->map with a rw spin lock rather than the md->lock
    semaphore.  Also ensure that everyone accesses md->map through
    dm_get_table(), rather than directly.

commit 6a435d69de04e96de8001edbd4a3da94eaec56b3
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon Apr 12 00:15:12 2004 -0700

    [PATCH] Add queue congestion callout
    
    From: Miquel van Smoorenburg <miquels@cistron.nl>
    
    The VM and VFS use the address_space_backing_dev_info to track the realtime
    status of the device which backs the mapping.  The read_congested and
    write_congested fields are used to determine whether a read or write
    against that device may block.
    
    We use this infrastructure to
    
    a) allow pdflush to service many queues in parallel (by not getting
       stuck on any particular one) and
    
    b) to avoid undesirable and uncontrolled latencies in places such as
       page reclaim and
    
    c) To avoid blocking in readahead operations
    
    The current code only supports simple disk queues (and I have a patch here
    for NFS).  Stacked queues (MD and DM) don't get this information right and
    problems were expected.  Efficiency problems have now been noted and it's
    time to fix it.
    
    This patch lays down the infrastructure which permits the queue
    implementation to get control when someone at a higher level is querying
    the queue's congestion state.  So DM (for example) can run around and
    examine all the queues which contribute to the higher-level queue.
    
    
    It also adds bdi_rw_congested() for code in xfs and ext2 that calls both
    bdi_read_congested() and bdi_write_congested() in a row, and it was "free"
    anyway.

commit fa7bb531f6f268a5836a36e689b27c5652dcba05
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon Apr 12 00:14:58 2004 -0700

    [PATCH] s390: rewritten qeth driver
    
    From: Martin Schwidefsky <schwidefsky@de.ibm.com>
    
    The rewritten qeth network driver.

commit 4006f663dca76cc183314b22346608121bb02dff
Author: Kenji Kaneshige <kaneshige.kenji@jp.fujitsu.com>
Date:   Sun Apr 11 23:58:20 2004 -0700

    [PATCH] ia64: set_rte() should get iosapic_lock
    
    Currently set_rte() changes RTE without iosapic_lock held. I guess it
    assumes to be called only at the boot time. But set_rte() can be
    called by PCI driver not only at the boot time. So I think set_rte()
    should get iosapic_lock.
    
    pci_enable_device(drivers/pci/pci.c)
    |
    +-> pci_enable_device_bars(drivers/pci/pci.c)
        |
        +-> pcibios_enable_device(arch/ia64/pci/pci.c)
            |
            +-> acpi_pci_irq_enable (drivers/acpi/pci_irq.c)
                |
                +-> iosapic_enable_intr (arch/ia64/kernel/iosapic.c)
                    |
                    +-> set_rte (arch_ia64/kernel/iosapic.c)
    
    A following patch fixes this issue.

commit 57f668bf8576c0f448478695db6578ef936897b0
Author: Bjorn Helgaas <bjorn.helgaas@hp.com>
Date:   Sun Apr 11 23:45:57 2004 -0700

    [PATCH] ia64: Allow IO port space without EFI RT attribute
    
    Some firmware does not require run-time mapping of the legacy IO port
    space.  (It may not need to perform any IO port operations, or it may
    do them with translation disabled.)
    
    (efi_get_iobase): Don't require that IO port space be marked RT, since
    there's no reason the firmware should require mappings for it.
    Thanks to Greg Albrecht for noticing this.
    
    Also, allow attributes in addition to EFI_MEMORY_UC.  I can't
    think of another current attribute that makes sense, but the
    kernel only depends on being able to use UC.

commit a1171283041fe4c6c7e8990cabe9cb3b3444bf31
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 23:44:01 2004 -0700

    [PATCH] s390: crypto device driver part 2
    
    From: Martin Schwidefsky <schwidefsky@de.ibm.com>
    
    The crypto device driver for PCICA & PCICC cards, part 2.

commit 58ebaaf0b9eeca5846c44b2e9414b48d39a09c96
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 23:43:48 2004 -0700

    [PATCH] s390: crypto device driver part 1
    
    From: Martin Schwidefsky <schwidefsky@de.ibm.com>
    
    The crypto device driver for PCICA & PCICC cards, part 1.

commit 57f8dc818b19037900dcd9bf90cc2aba02d29cf7
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 23:43:34 2004 -0700

    [PATCH] s390: zfcp log messages part 2
    
    From: Martin Schwidefsky <schwidefsky@de.ibm.com>
    
    zfcp host adapter log message cleanup part 2:
     - Shorten log output.
     - Increase log level for some messages.
     - Always print leading zeroes for wwpn and fcp-lun.

commit 12c845ae4fd6844b8e09bb6316f22b56f1486dd7
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 23:43:21 2004 -0700

    [PATCH] s390: zfcp log messages part 1
    
    From: Martin Schwidefsky <schwidefsky@de.ibm.com>
    
    zfcp host adapter log message cleanup part 1:
     - Shorten log output.
     - Increase log level for some messages.
     - Always print leading zeroes for wwpn and fcp-lun.

commit f9a56f8af3cdecf14ab5e504403d924ef3fc46a9
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 23:43:08 2004 -0700

    [PATCH] s390: zfcp fixes (without kfree hack)
    
    From: Martin Schwidefsky <schwidefsky@de.ibm.com>
    
    zfcp host adapter fixes:
     - Reuse freed scsi_ids and scsi_luns for mappings.
     - Order list of ports/units by assigned scsi_id/scsi_lun.
     - Don't update max_id/max_lun in scsi_host anymore.
     - Get rid of all magics.
     - Add owner field to ccw_driver structure.
     - Avoid deadlock on bus->subsys.rwsem.
     - Use a macro for all scsi device sysfs attributes.
     - Change proc_name from "dummy" to "zfcp".
     - Don't wait for scsi_add_device to complete while holding a semaphore.
     - Cleanup include files in zfcp_aux.c & zfcp_def.h.
     - Get rid of zfcp_erp_fsf_req_handler.
     - Proper link up/down handling.
     - Avoid possible NULL pointer dereference in zfcp_erp_schedule_work.
     - Remove module_exit function. Without an external release function for
       the zfcp_port/zfcp_unit objects module unloading is racy.

commit d959cc9f0e101ae2ed4dbffb4c97aad24cce5630
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 23:42:53 2004 -0700

    [PATCH] s390: dcss block driver fix
    
    From: Martin Schwidefsky <schwidefsky@de.ibm.com>
    
    DCSS block device driver changes:
     - Fix remove_store function, put_device is called too early.

commit f86f3b688605c02fc2b4bb0efb9a369fed448d5f
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 23:42:41 2004 -0700

    [PATCH] s390: network driver fixes
    
    From: Martin Schwidefsky <schwidefsky@de.ibm.com>
    
    Network driver changes:
     - ctc: move kfree of driver structure after the last use of it.
     - netiucv: stay in state startwait if peer is down.
     - lcs: initialize ipm_list and unregister netdev only if it is present.

commit 482ac5937686db6ad3c730d7c8e7dc0a26247513
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 23:42:28 2004 -0700

    [PATCH] s390: dasd driver fix
    
    From: Martin Schwidefsky <schwidefsky@de.ibm.com>
    
    dasd driver changes:
     - Fix check for device type in error recovery for fba devices.

commit 2152527fdadd2710bc5551c35a95504f2ca39636
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 23:42:16 2004 -0700

    [PATCH] s390: tape driver fixes
    
    From: Martin Schwidefsky <schwidefsky@de.ibm.com>
    
    Tape driver changes:
     - Add missing break in tape_34xx_work_handler to avoid misleading message.
     - Cleanup offline/remove code.

commit 6a562864ff04f35dbd47ae35defd3547c2a4472a
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 23:42:02 2004 -0700

    [PATCH] s390: common i/o layer
    
    From: Martin Schwidefsky <schwidefsky@de.ibm.com>
    
    Common i/o layer changes:
     - Avoid de-registering a ccwgroup device multiple times.
     - Remove check for channel path objects in get_subchannel_by_schid.
       Channel patch objects are never in the bus list.
     - Avoid NULL pointer deref. in qdio_unmark_q.
     - Fix reference counting on subchannel objects.
     - Add shutdown function to terminate i/o and disable subchannels at reipl.
     - Remove all ccwgroup devices if the ccwgroup driver is unregistered.

commit 74216ef57713a9cb85aa0e1bb240b766d77a1351
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 23:41:49 2004 -0700

    [PATCH] s390: core s390
    
    From: Martin Schwidefsky <schwidefsky@de.ibm.com>
    
    s390 core changes:
     - Fix _raw_spin_trylock for 64 bit.
     - Add clarification to s390 debug debug documentation.

commit c8b976af1af10de3d92968bf7d4bd5415e8a3778
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 23:41:36 2004 -0700

    [PATCH] hugetlb consolidation
    
    From: William Lee Irwin III <wli@holomorphy.com>
    
    The following patch consolidates redundant code in various hugetlb
    implementations.  I took the liberty of renaming a few things, since the
    code was all moved anyway, and it has the benefit of helping to catch
    missed conversions and/or consolidations.

commit 618e7f449ebbd72f5d2c0e7fce05319d058a0700
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 23:41:23 2004 -0700

    [PATCH] missing \n in timer_tsc.c
    
    From: Arjan van de Ven <arjanv@redhat.com>
    
    patch below fixes a missing \n in a printk; without this you get to see a
    <4> in the middle of that line...

commit 3549c6242ae5fcffa4470457577a57fec2f83181
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 23:41:09 2004 -0700

    [PATCH] 68knommu: add support for 64MHz clock for ColdFire boards
    
    From: <gerg@snapgear.com>
    
    Add support for boards that have a 64MHz clock to common Coldfire header.

commit 977732982dee1da8bc27510ae6b7435cf8957e67
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 23:40:57 2004 -0700

    [PATCH] 68knommu: 68EZ328/ucdimm setup code printk cleanup
    
    From: <gerg@snapgear.com>
    
    Add type specifier to printk calls in 68EZ328/ucdimm setup code.  Patch
    original from kernel janitors.

commit aa19aafa4f6e1794f74e8ef0057d4db82e80636f
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 23:40:43 2004 -0700

    [PATCH] 68knommu: cleanup startup code for 68EZ328 DragonEngine board
    
    From: <gerg@snapgear.com>
    
    Clean up debug trace in startup code of 68EZ328 DragonEngine board.

commit cd18c683fceb4cda8f4ce637c9b3351ad969b252
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 23:40:31 2004 -0700

    [PATCH] 68knommu: mk68knommu DragonEngine setup code printk cleanup
    
    From: <gerg@snapgear.com>
    
    A couple of fixes for the DragonEngine sepcific setup code:
    
    . remove cs8900 ethernet setup from here
    . add type specifier to printk calls (from kernel janitors)

commit 6086d4fe21e8a9fc1398927df1c9a7597e22f359
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 23:40:17 2004 -0700

    [PATCH] 68knommu: cleanup Motorola 68360 ints code
    
    From: <gerg@snapgear.com>
    
    Some fixes for the 68360 common ints management code:
    
    . use irqreturn_t for return type of interrupt handlers
    . add type field to printk calls (from kernel janitors)
    . there is no loop in show_interrupts(), don't use continue

commit 66b801038d8cef21d173f137198ad4c6e386ab9c
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 23:40:05 2004 -0700

    [PATCH] 68knommu: cleanup Motorola 68328 ints code
    
    From: <gerg@snapgear.com>
    
    Some fixes for the 68328 common ints management code:
    
    . use irqreturn_t for return type of interrupt handlers
    . clean up asm code to be gcc-3.3.x clean
    . add type field to printk calls (from kernel janitors)
    . there is no loop in show_interrupts(), don't use continue

commit c4cc53e3be79d4239c8be5121c553b6608253ed4
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 23:39:51 2004 -0700

    [PATCH] 68knommu: use irqreturn_t in Motorola 68328 setup code
    
    From: <gerg@snapgear.com>
    
    A number of small fixes for the Motorola 68328 setup code:
    
    . fix interrupt routine return types to be irqreturn_t
    . add type specifier to printk calls (from kernel janitors)
    . rework asm code to be gcc-3.3.x clean

commit 1bb13b4cfc1de9e12bca1d17dd406fc39be7f5ad
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 23:39:39 2004 -0700

    [PATCH] 68knommu: use irqreturn_t in ColdFire 5407 setup code
    
    From: <gerg@snapgear.com>
    
    Fixes to the Motorola ColdFire 5407 setup code:
    
    . fix interrupt routine return types to be irqreturn_t
    . add DMA base addresses array
    . support compile time setting of kernel boot arguments

commit fc571490560afb1a601dac1d48587d8fa5a842ee
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 23:39:26 2004 -0700

    [PATCH] m68knommu: 68EZ328 config.c printk cleanup
    
    From: <gerg@snapgear.com>
    
    Add type specifier to printk calls.  Patch originally from kernel janitors.

commit 43cba448ccbe13ba85718e259906a50e92a2a40a
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 23:39:13 2004 -0700

    [PATCH] m68knommu: 68360 config.c printk cleanup
    
    From: <gerg@snapgear.com>
    
    Add type specifier to printk calls.  Patch originally from kernel janitors.

commit 7b5bbf5d79bbf79aaec0965f378d9b8de261ad4a
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 23:39:00 2004 -0700

    [PATCH] m68knommu: 68360 commproc.c printk cleanup
    
    From: <gerg@snapgear.com>
    
    Add type specifier to printk calls.  Original patch from kernel janitors.

commit 49e7053a8d4066b789503d424099a9c69b90649f
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 23:38:48 2004 -0700

    [PATCH] m68knommu: conditional ROMfs copy for 5407 CLEOPATRA board
    
    From: <gerg@snapgear.com>
    
    Conditionaly copy an attached ROMfs filesystem in memory on kernel startup.
    This should only be done if there really is a ROMfs there.

commit 5db0ebea5df1e3995251a366ca0f5692047f1818
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 23:38:35 2004 -0700

    [PATCH] m68knommu: mm/5307/vectors.c printk cleanup
    
    From: <gerg@snapgear.com>
    
    Add type field to printk call.  Original patch supplied bu kernel janitors.

commit 810738b61e60bd300c597ab6871fce24614fa68c
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 23:38:21 2004 -0700

    [PATCH] m68knommu: use irqreturn_t in ColdFire 5307 setup code
    
    From: <gerg@snapgear.com>
    
    Fixes to the Motorola ColdFire 5307 setup code:
    
    . fix interrupt routine return types to be irqreturn_t
    . add DMA base addresses array

commit ebce3d3db0dacf03dfe8bd1875c969f47ddfd85f
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 23:38:08 2004 -0700

    [PATCH] m68knommu: cleanup ColdFire/5307 ints code
    
    From: <gerg@snapgear.com>
    
    . add type field to printk calls (from kernel janitors)
    . there is no loop in show_interrupts(), don't use continue

commit 57f5029b055eddba7385321f08a86ac38129e779
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 23:37:56 2004 -0700

    [PATCH] m68knommu: add start code for COBRA5282 board
    
    From: <gerg@snapgear.com>
    
    Add start up code specific to the newly added COBRA5282 board.

commit deb09fa247136d7c8e568331719a717c96604acd
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 23:37:43 2004 -0700

    [PATCH] m68knommu: use irqreturn_t in ColdFire 5282 setup code
    
    From: <gerg@snapgear.com>
    
    Fixes to the Motorola ColdFire 5282 setup code:
    
    . fix interrupt routine return types to be irqreturn_t
    . add DMA base addresses array

commit 267c130945d01e6a0b9c5aebfbf9def6d58848b6
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 23:37:30 2004 -0700

    [PATCH] m68knommu: add start code for COBRA5272 board
    
    From: <gerg@snapgear.com>
    
    Add startup code specific to newly supported COBRA5272 board.

commit 6378e963700c0b06c0de3697f80fffc9f48c7717
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 23:37:16 2004 -0700

    [PATCH] m68knommu: auto-size DRAM on Motorola/5272 ColdFire board
    
    From: <gerg@snapgear.com>
    
    Allow for auto-detecting the size of the DRAM in the startup code for the
    Motorola/5272 (ColdFire) board.  Use the DRAM sizing register, since it will
    have been setup by the debug boot monitor (dBUG).

commit 486cb8104c29e86fc2944e4e0497723fe338aed7
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 23:37:03 2004 -0700

    [PATCH] m68knommu: timers.c printk cleanup
    
    From: <gerg@snapgear.com>
    
    Add type field to printk calls in m68knommu timers.c

commit 540699a2bcd0c95e92e11395b9e44f8a37b031b7
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 23:36:50 2004 -0700

    [PATCH] m68knommu/ColdFire base DMA addresses
    
    From: <gerg@snapgear.com>
    
    Define the DMA register set base address array for those m68knommu/ColdFire
    CPU's that have a DMA engines.

commit 19ae7f2d7ce29f84ed72d2190adb54a332386282
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 23:36:37 2004 -0700

    [PATCH] m68knommu: mm/init.c printk cleanup
    
    From: <gerg@snapgear.com>
    
    Add type field to printk calls in m68knommu mm/init.c.  Patch originally
    from kernel janitors.

commit fe11cbda0755a372819250477d6ed9cfde210d71
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 23:36:26 2004 -0700

    [PATCH] m68knommu: fault.c printk cleanup
    
    From: <gerg@snapgear.com>
    
    Add type field to printk calls.  Patch original provided by kernel
    janitors.

commit 936c9a5457507353a02af353a071bc4a34f8a502
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 23:36:13 2004 -0700

    [PATCH] m68knommu: add senTec vendor support to Makefile
    
    From: <gerg@snapgear.com>
    
    Add build support for the senTec vendor to m68knommu architecture Makefile.

commit 0cd04dcb99707ca2a332dd40aa5de05ba6d8c1d2
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 23:35:59 2004 -0700

    [PATCH] m68knommu/coldfire: fix gcc cpu define
    
    From: <gerg@snapgear.com>
    
    Fix architecture/cpu defines to support those used by modern versions of
    gcc (that is gcc > 3.3.x) for m68knommu.  The standard for defining
    ColdFire architectures is no longer __mcf5200__, it is now __mcoldfire__.
    This patch fixes all the occurances in the m68knommu/lib functions.

commit 8f9c1be72408cb32beacb8fbbe455dc9b8a87194
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 23:35:47 2004 -0700

    [PATCH] m68knommu: platform additions in linker script
    
    From: <gerg@snapgear.com>
    
    A couple of additions to the linker script for m68knommu platforms:
    
    . add support for COBRA5272 and COBRA5282 boards
    . link in .rodata.str1 generated by gcc-3.3.x compilers

commit 4ce40a47088b7bfc471a22e8db99099d8f784c53
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 23:35:33 2004 -0700

    [PATCH] m68knommu cleanup traps.c (printk and dump_stack)
    
    From: <gerg@snapgear.com>
    
    Add type to all printk calls in m68knommu traps.c.  Also added a modern
    dump_stack function.

commit b5a15efc3189813b3f20d7118667d343432cbc84
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 23:35:21 2004 -0700

    [PATCH] m68knommu cleanup setup.c (printk and irqreturn_t)
    
    From: <gerg@snapgear.com>
    
    Cleanup m68knommu/kernel/setup.c.  Add type to all printk calls, remove
    obsolete framebuffer setup and fix a few irqreturn_t for interrupt handlers
    in prototypes.
    
    Printk cleanup originally from kernel janitors.

commit ad0e2f8ea3666dffb99e7d2a987d004592f622f3
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 23:35:08 2004 -0700

    [PATCH] m68knommu: build dma.c
    
    From: <gerg@snapgear.com>
    
    Add local m68knommu dma allocation code to build list.

commit 9f0c1105305dd09d8917432cf37c8ba8e2b291ac
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 23:34:55 2004 -0700

    [PATCH] m68knommu: coherent dma allocation
    
    From: <gerg@snapgear.com>
    
    Create the coherent DMA allocation functions for m68knommu.  No current
    hardware in this class requires anything special, so it just just does
    normal allocations after sanity checks.

commit 7e694749f382c7832d98cf22330fa8191f3f3b1b
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 23:34:41 2004 -0700

    [PATCH] m68knommu: comempci.c printk cleanup
    
    From: <gerg@snapgear.com>
    
    Cleanup m68knommu's comempci.c support code.  Add type to all printk calls.
    Patch originally from kernel janitors.

commit 07419de6eecb9417edcaa84270d17c2e92e1f9c3
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 23:34:27 2004 -0700

    [PATCH] m68knommu: Kconfig cleanup
    
    From: <gerg@snapgear.com>
    
    A few changes to the m68knommu Kconfig:
    
    . Add support for 64MHz clocked CPU's
    . Add support for selecting the COBRA5272 and COBRA5282 boards
    . Use drivers/Kconfig for driver configuration
    . Allow configuring compilation with frame-pointer

commit a10412a3449135294a5eec321b0ee0fd36f7bf3e
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 23:34:13 2004 -0700

    [PATCH] m68knommu: fix kernel_thread()
    
    From: <gerg@snapgear.com>
    
    Some kernel janitor clean ups of printk for the m68knommu specific process
    code.
    
    And more importantly a fix to the kernel_thread() asm code to correctly
    return the pid back to the return var from the clone system call.

commit 7400bc459f574c60ff62b139bf97b1abf5386f4c
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 23:34:01 2004 -0700

    [PATCH] m68knommu: create dma-mapping.h
    
    From: <gerg@snapgear.com>
    
    Create a dma-mapping.h for m68knommu architecture.

commit ba5ff4c5edef262f74b1f96b83f09af8be4a20a3
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 23:33:47 2004 -0700

    [PATCH] v850: make v850 dma-mapping.h header work when !CONFIG_PCI
    
    From: <miles@mcspd15.ucom.lsi.nec.co.jp> (Miles Bader)
    
    Is this something that should be done in <asm-generic/dma-mapping.h>?

commit d54f0b47beed8ad9cf98ede8a76d106f7d878c7e
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 23:33:35 2004 -0700

    [PATCH] v850: use volatile qualifier on v850 test-n-bitop asm statements
    
    From: <miles@mcspd15.ucom.lsi.nec.co.jp> (Miles Bader)
    
    Otherwise the compiler can delete them (this is one of those "how on earth
    did it ever work before" moments).

commit 0e568881178ff0e0aceeafdb51f9fecab39e1923
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 23:33:21 2004 -0700

    [PATCH] fix posix-timers to have proper per-process scope
    
    From: Roland McGrath <roland@redhat.com>
    
    The posix-timers implementation associates timers with the creating thread
    and destroys timers when their creator thread dies.  POSIX clearly
    specifies that these timers are per-process, and a timer should not be torn
    down when the thread that created it exits.  I hope there won't be any
    controversy on what the correct semantics are here, since POSIX is clear
    and the Linux feature is called "posix-timers".
    
    The attached program built with NPTL -lrt -lpthread demonstrates the bug.
    The program is correct by POSIX, but fails on Linux.  Note that a until
    just the other day, NPTL had a trivial bug that always disabled its use of
    kernel timer syscalls (check strace for lack of timer_create/SYS_259).  So
    unless you have built your own NPTL libs very recently, you probably won't
    see the kernel calls actually used by this program.
    
    Also attached is my patch to fix this.  It (you guessed it) moves the
    posix_timers field from task_struct to signal_struct.  Access is now
    governed by the siglock instead of the task lock.  exit_itimers is called
    from __exit_signal, i.e.  only on the death of the last thread in the
    group, rather than from do_exit for every thread.  Timers' it_process
    fields store the group leader's pointer, which won't die.  For the case of
    SIGEV_THREAD_ID, I hold a ref on the task_struct for it_process to stay
    robust in case the target thread dies; the ref is released and the dangling
    pointer cleared when the timer fires and the target thread is dead.  (This
    should only come up in a buggy user program, so noone cares exactly how the
    kernel handles that case.  But I think what I did is robust and sensical.)
    
    /* Test for bogus per-thread deletion of timers.  */
    
    #include <stdio.h>
    #include <error.h>
    #include <time.h>
    #include <signal.h>
    #include <stdint.h>
    #include <sys/time.h>
    #include <sys/resource.h>
    #include <unistd.h>
    #include <pthread.h>
    
    /* Creating timers in another thread should work too.  */
    static void *do_timer_create(void *arg)
    {
    	struct sigevent *const sigev = arg;
    	timer_t *const timerId = sigev->sigev_value.sival_ptr;
    	if (timer_create(CLOCK_REALTIME, sigev, timerId) < 0) {
    		perror("timer_create");
    		return NULL;
    	}
    	return timerId;
    }
    
    int main(void)
    {
    	int i, res;
    	timer_t timerId;
    	struct itimerspec itval;
    	struct sigevent sigev;
    
    	itval.it_interval.tv_sec = 2;
    	itval.it_interval.tv_nsec = 0;
    	itval.it_value.tv_sec = 2;
    	itval.it_value.tv_nsec = 0;
    
    	sigev.sigev_notify = SIGEV_SIGNAL;
    	sigev.sigev_signo = SIGALRM;
    	sigev.sigev_value.sival_ptr = (void *)&timerId;
    
    	for (i = 0; i < 100; i++) {
    		printf("cnt = %d\n", i);
    
    		pthread_t thr;
    		res = pthread_create(&thr, NULL, &do_timer_create, &sigev);
    		if (res) {
    			error(0, res, "pthread_create");
    			continue;
    		}
    		void *val;
    		res = pthread_join(thr, &val);
    		if (res) {
    			error(0, res, "pthread_join");
    			continue;
    		}
    		if (val == NULL)
    			continue;
    
    		res = timer_settime(timerId, 0, &itval, NULL);
    		if (res < 0)
    			perror("timer_settime");
    
    		res = timer_delete(timerId);
    		if (res < 0)
    			perror("timer_delete");
    	}
    
    	return 0;
    }

commit 2aa53d1884db24b1e7364487a23e5ed2b49b9b14
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 23:33:08 2004 -0700

    [PATCH] sh-sci compile error fix patch
    
    From: Yoshinori Sato <ysato@users.sourceforge.jp>
    
    - add Kconfig depends H8300
    - H8/300 support compile error fixed.

commit 8d94c528b039ab11e66a0f0ae2137a75974c1f10
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 23:32:54 2004 -0700

    [PATCH] H8/300 support update
    
    From: Yoshinori Sato <ysato@users.sourceforge.jp>
    
    - fix any error/warning
    - fix {request,freee}_irq interrupt control fix
    - add dump_stack
    - fix show_trace_task
    - fix typo

commit 092ed9514b86fb028067a38f3dd44d484d91a202
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 23:32:42 2004 -0700

    [PATCH] H8/300 support update (3/3) - others
    
    From: Yoshinori Sato <ysato@users.sourceforge.jp>
    
    - use new serial driver (drivers/serial/sh-sci.[ch])
    - typo fix
    - add message level

commit 4280119ecb74057f40ce149f54d279c35d4c9d85
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 23:32:28 2004 -0700

    [PATCH] H8/300 support update (2/3) - entry.S cleanup
    
    From: Yoshinori Sato <ysato@users.sourceforge.jp>
    
    - cleanup define

commit 4f9ad28f535ebe88803e7129a455338e5949d02d
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 23:32:16 2004 -0700

    [PATCH] H8/300 support update (1/3) - ptrace fix
    
    From: Yoshinori Sato <ysato@users.sourceforge.jp>
    
    - fix PTRACE_SIGLESTEP bug.
    - separate to CPU depend.

commit 219c7ea1d17a2cadb30f49bab887c7e4ed82237f
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 23:32:02 2004 -0700

    [PATCH] use EFLAGS #defines instead of inline constants
    
    From: "Randy.Dunlap" <rddunlap@osdl.org>
    
    Use x86 EFLAGS defines in place of hardwired constants.

commit 76e62eba4d6938035ca8caa95b2463fb785087ca
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 23:31:49 2004 -0700

    [PATCH] stack reduction: ISDN
    
    From: Arjan van de Ven <arjanv@redhat.com>
    
    isdn: dynamically allocate big structures

commit 1a92fb136122984b5f2748c47f455d12f7e030e4
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 23:31:36 2004 -0700

    [PATCH] stack reductions: ide
    
    From: Arjan van de Ven <arjanv@redhat.com>
    
    ide.c: constant array of strings can be static

commit ff94e4aead4ee886b943040d7780bd4746cccc89
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 23:31:23 2004 -0700

    [PATCH] stack reduction: ide-cd
    
    From: Arjan van de Ven <arjanv@redhat.com>
    
    ide-cd: a few 512 byte scratch buffers can be static; they are just for
    putting "padding" sectors in that aren't used.
    
    (acked by Jens)

commit 9b2bc42186460c9449abae2b02fb9d5464d9ba14
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 23:31:10 2004 -0700

    [PATCH] binfmt_elf.c fix for 32-bit apps with large bss
    
    From: Julie DeWandel <jdewand@redhat.com>
    
    A problem exists where a 32-bit application can have a huge bss, one that
    is so large that an overflow of the TASK_SIZE happens.  But in this case,
    the overflow is not detected in load_elf_binary().  Instead, because
    arithmetic is being done using 32-bit containers, a truncation occurs and
    the program gets loaded when it shouldn't have been.  Subsequent execution
    yields unpredictable results.
    
    The attached patch fixes this problem by checking for the overflow
    condition and sending a SIGKILL to the application if the overflow is
    detected.  This problem can in theory exist when loading the elf
    interpreter as well, so a similar check was added there.

commit a804dbaf0e0feb822e0e72a8716c5a4829c7421c
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 23:30:58 2004 -0700

    [PATCH] es1688 Definition redundancy
    
    From: Fabian Frederick <Fabian.Frederick@skynet.be>
    
    Here's a trivial patch to avoid definition redundancy in es1688.

commit 7804ee5abf45424e88f3c4fa5e01a9be95dfc2a6
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 23:30:44 2004 -0700

    [PATCH] intermezzo leak fixes
    
    - Don't leak a pathname ref on error
    
    - Don't do putname() on a nameidata.

commit 8ae81ff5bea950a985da39f49e7adc7521ac9523
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 23:30:32 2004 -0700

    [PATCH] more i386 head.S cleanups
    
    From: Brian Gerst <bgerst@didntduck.org>
    
    - Move empty_zero_page and swapper_pg_dir to BSS.  This requires that BSS
      is cleared earlier, but reclaims over 3k that was lost due to page
      alignment.
    
    - Move stack_start, ready, and int_msg, boot_gdt_descr, idt_descr, and
      cpu_gdt_descr to .data.  They were interfering with disassembly while in
      .text.

commit f0d53a527b33d15f9c5d41b1aea04da3a9da1cfb
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 23:30:18 2004 -0700

    [PATCH] unmap_vmas latency improvement
    
    unmap_vmas() will cause scheduling latency when tearing down really big vmas
    on !CONFIG_PREEMPT.  That's a bit unkind to the non-preempt case, so let's do
    a cond_resched() after zapping 1024 pages.

commit b3548dd4d756861bd74ab5b1c780f1e06e4f78c0
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 23:30:05 2004 -0700

    [PATCH] CONFIG_SND_MIXART doesn't compile
    
    From: Bernhard Rosenkraenzer <bero@arklinux.org>
    
    mixart.h uses tasklet_struct without including linux/interrupt.h -- fix
    attached.

commit 1eb3edb2fa38625c44ad217137ae4be8ac5b9862
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 23:29:52 2004 -0700

    [PATCH] selinux: remove ratelimit from avc
    
    From: Stephen Smalley <sds@epoch.ncsc.mil>
    
    This patch drops the ratelimit code from the SELinux avc, as this can now
    be handled by the audit framework.  Enabling and setting the ratelimit is
    then left to userspace.

commit df25ad33a36b1eee0a1cebb9c834529b0353b4bc
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 23:29:39 2004 -0700

    [PATCH] selinux: Audit compute_sid errors
    
    From: Stephen Smalley <sds@epoch.ncsc.mil>
    
    This patch changes an error message printk'd by security_compute_sid to use
    the audit framework instead.  These errors reflect situations where a
    security transition would normally occur due to policy, but the resulting
    security context is not valid.  The patch also changes the code to always
    call the audit framework rather than only doing so when permissive as this
    was causing problems with testing policy, and does some code cleanup.

commit 7787c5a437ddd2c95315163920d6b97c95bbfa8c
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 23:29:25 2004 -0700

    [PATCH] selinux: make IPv6 code work with audit framework
    
    From: James Morris <jmorris@redhat.com>
    
    This patch makes the IPv6 code work with the audit framework, following the
    merge of both.

commit f85a96f63f300878dcc785cf2333cab15eef48f0
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 23:29:12 2004 -0700

    [PATCH] Light-weight Auditing Framework
    
    From: Rik Faith <faith@redhat.com>
    
    This patch provides a low-overhead system-call auditing framework for Linux
    that is usable by LSM components (e.g., SELinux).  This is an update of the
    patch discussed in this thread:
    
        http://marc.theaimsgroup.com/?t=107815888100001&r=1&w=2
    
    In brief, it provides for netlink-based logging of audit records that have
    been generated in other parts of the kernel (e.g., SELinux) as well as the
    ability to audit system calls, either independently (using simple
    filtering) or as a compliment to the audit record that another part of the
    kernel generated.
    
    The main goals were to provide system call auditing with 1) as low overhead
    as possible, and 2) without duplicating functionality that is already
    provided by SELinux (and/or other security infrastructures).  This
    framework will work "stand-alone", but is not designed to provide, e.g.,
    CAPP functionality without another security component in place.
    
    This updated patch includes changes from feedback I have received,
    including the ability to compile without CONFIG_NET (and better use of
    tabs, so use -w if you diff against the older patch).
    
    Please see http://people.redhat.com/faith/audit/ for an early example
    user-space client (auditd-0.4.tar.gz) and instructions on how to try it.
    
    My future intentions at the kernel level include improving filtering (e.g.,
    syscall personality/exit codes) and syscall support for more architectures.
     First, though, I'm going to work on documentation, a (real) audit daemon,
    and patches for other user-space tools so that people can play with the
    framework and understand how it can be used with and without SELinux.
    
    
    Update:
    
    Light-weight Auditing Framework receive filter fixes
    From: Rik Faith <faith@redhat.com>
    
    Since audit_receive_filter() is only called with audit_netlink_sem held, it
    cannot race with either audit_del_rule() or audit_add_rule(), so the
    list_for_each_entry_rcu()s may be replaced by list_for_each_entry()s, and
    the rcu_read_{un,}lock()s removed.  A fix for this is part of the attached
    patch.
    
    Other features of the attached patch are:
    
    1) generalized the ability to test for inequality
    
    2) added syscall exit status reporting and testing
    
    3) added ability to report and test first 4 syscall arguments (this adds
       a large amount of flexibility for little cost; not implemented or tested
       on ppc64)
    
    4) added ability to report and test personality
    
    User-space demo program enhanced for new fields and inequality testing:
    http://people.redhat.com/faith/audit/auditd-0.5.tar.gz

commit 0e8e57e384ff71241e9552827237920343968226
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 23:28:57 2004 -0700

    [PATCH] From: James Morris <jmorris@redhat.com>
    
    This patch removes a harmless duplicate assignment from the IPv6 code.

commit 5e752b7e934265eb51f82ae5e3eae6f0d6db36eb
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 23:28:45 2004 -0700

    [PATCH] selinux: add IPv6 support
    
    From: James Morris <jmorris@redhat.com>
    
    The patch below adds explicit IPv6 support to SELinux.
    
    Brief description of changes:
    
    o IPv6 networking is now subject to the same controls as IPv4 (in
      addition to the generic socket permissions which cover all protocols),
      namely: bind to local node address; bind to local port; send & receive
      TCP/UDP and raw IP packets based on local network interface and remote
      node address.
    
    o Packet parsing has been extended to IPv6 packets for logging and
      control, and simplified for IPv4.
    
    o Support for logging of IPv6 addresses has also been added.
    
    o The kernel policy database code has been modified to support IPv6, and
      reworked to provide generic security policy version handling so that
      older policy versions will still work, making upgrading simpler.
    
    Corresponding userspace patches are available at
    <http://people.redhat.com/jmorris/selinux/ipv6/>, although current
    userspace tools will continue to function normally (but without explicit
    IPv6 support).
    
    For more details at the security management level, see
    <http://marc.theaimsgroup.com/?l=selinux&m=108068187630948&w=2>
    
    This code has been under testing and review for several weeks.

commit bcf506bdb08995822437a566316f93763bd19ce1
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 23:28:31 2004 -0700

    [PATCH] reiserfs writepage race with data=ordered
    
    From: Chris Mason <mason@suse.com>
    
    reiserfs-writepage-ordered-race needs a minor update to include your latest
    __block_write_full_page fixes for the direct_read_under bug Daniel was
    hitting.

commit b566678f923387aa0cf3ec6d56ff368c3053ea0f
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 23:28:19 2004 -0700

    [PATCH] reiserfs_kfree warning fix
    
    fs/reiserfs/journal.c: In function `reiserfs_end_persistent_transaction':
    fs/reiserfs/journal.c:2616: warning: unused variable `s'
    
    Make the functions static inline so that typechecking is enabled if
    !CONFIG_REISERFS_CHECK.

commit 77ae13bcf65004e91631d76f7a4a8e3c8a41fba6
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 23:28:05 2004 -0700

    [PATCH] reiserfs: fix dirty-buffer warnings
    
    From: Chris Mason <mason@suse.com>
    
    block_write_full_page() might see and lock clean metadata buffers, which leads
    to journal-1777 messages.  Change the message to ignore bh locked.

commit 6f2085c0678521291341fb0cbea8a22c5995fdb4
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 23:27:53 2004 -0700

    [PATCH] reiserfs: scheduling latency improvements
    
    From: Chris Mason <mason@suse.com>
    
    Some latency improvements for the reiserfs data=ordered code from Takashi.

commit e2de7edb6f6c49dab9d792e569fcfe53e4f2a0b9
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 23:27:39 2004 -0700

    [PATCH] reiserfs: truncate leak fix
    
    From: Chris Mason <mason@suse.com>
    
    reiserfs_unmap_buffer should clean and wait on all buffers.  This fixes a
    leak under fsx workloads.

commit 008c597b875b55e37287fc6240e857ebf68c3ebe
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 23:27:26 2004 -0700

    [PATCH] reiserfs: laptop-mode support
    
    From: Chris Mason <mason@suse.com>
    
    Add reiserfs support for laptop mode.

commit 34cd780264467a783805e8e719508a11ea5fb72e
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 23:27:13 2004 -0700

    [PATCH] reiserfs: sparse file handling fix
    
    From: Chris Mason <mason@suse.com>
    
    reiserfs_file_write makes a hole one block too large if it is the first thing
    in the file.

commit 7a06b83d437c79e1a01b58e910eff06d7e09b6d5
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 23:27:00 2004 -0700

    [PATCH] reiserfs: fix race with writepage
    
    From: Chris Mason <mason@suse.com>
    
    Fix reiserfs_writepage so it doesn't race with data=ordered writes.  This
    still has a pending fix to redirty the page when it finds a locked buffer.
    Waiting for Andrew to finish sorting that out on ext3 first.

commit fb1b3b0470cf3e5533f6af14be1b22568726961c
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 23:26:47 2004 -0700

    [PATCH] reiserfs: tail repacking fix
    
    From: Chris Mason <mason@suse.com>
    
    Repacking a tail might leave a journal handle attached to an unmapped buffer.
     If that buffer gets dirtied again (via mmap for example), the reiserfs
    data=ordered code might try to write the dirty unmapped buffer to disk.
    
    The fix is to make sure we remove the journal handle when we unmap buffers.

commit d12e339295aff38dde9a2a728014ce2509362c19
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 23:26:34 2004 -0700

    [PATCH] reiserfs: preallocation support
    
    From: Chris Mason <mason@suse.com>
    
    Enable preallocation for reiserfs_file_write when the write size is smaller
    than the default preallocation size.

commit ec6f95531a122885453f7ada3a16cf3d15c207fc
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 23:26:21 2004 -0700

    [PATCH] reiserfs: locking fix
    
    From: Chris Mason <mason@suse.com>
    
    Make sure to hold the BKL while ending a transaction in the error path or
    reiserfs_prepare_write.

commit bb0d96728fb63cf1d2294bb1dcafd60926e49cd5
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 23:26:08 2004 -0700

    [PATCH] reiserfs: data=ordered support
    
    From: Chris Mason <mason@suse.com>
    
    reiserfs data=ordered support.

commit 7c563ced265e3134a5c5c5b7ca2b31218993a204
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 23:25:50 2004 -0700

    [PATCH] reiserfs: logging rework
    
    From: Chris Mason <mason@suse.com>
    
    reiserfs logging rework, making things much faster for small transactions.
    metadata buffers are dirtied when they are safe to write, so normal kernel
    mechanisms can contribute to log cleaning.

commit 8f57688237995959aee38d48a0c92e203dbec676
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 23:25:37 2004 -0700

    [PATCH] reiserfs: cleanups
    
    From: Chris Mason <mason@suse.com>
    
    reiserfs cleanup, get rid of old debugging code.

commit 7a10b433f0911d25b4fd1d1b033cbd119be8fc5f
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 23:25:23 2004 -0700

    [PATCH] reiserfs: support for nested transactions
    
    From: Chris Mason <mason@suse.com>
    
    reiserfs support for nested transactions.  This originally came from Peter
    Braam for 2.4.x and was ported forward by Jeff Mahoney.

commit 545b08408d306f156c24421b0f9575b5b84c7afe
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 23:25:11 2004 -0700

    [PATCH] Fix ext3 transaction batching
    
    ext3 transaction batching has been ineffective since the scheduler changes
    forced us to replace the yield() with a schedule().
    
    Using schedule_timeout(1) fixes it up again.  Benchmarking is positive with
    wither a 1 or 10 millisecond delay in there, so there appears to be no need
    to play around with HZ.

commit 01cc53b25e1883ff537d19adc87097e1833deeaa
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 23:24:57 2004 -0700

    [PATCH] Non-Exec stack support
    
    From: Kurt Garloff <garloff@suse.de>
    
    A patch to parse the elf binaries for a PT_GNU_STACK section to set the stack
    non-executable if possible.  Most parts have been shamelessly stolen from
    Ingo Molnar's more ambitious stackshield
    http://people.redhat.com/mingo/exec-shield/exec-shield-2.6.4-C9
    
    The toolchain has meanwhile support for marking the binaries with a
    PT_GNU_STACK section wwithout x bit as needed.
    
    If no such section is found, we leave the stack to whatever the arch defaults
    to.  If there is one, we explicitly disabled the VM_EXEC bit if no x bit is
    found, otherwise explicitly enable.

commit 492361a6d915137590a8eba787dd878d71137358
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 23:24:44 2004 -0700

    [PATCH] list.h cleanup
    
    - s/__inline__/inline/
    
    - Remove lots of extraneous andi-was-here trailing whitespace

commit 0109dc6d2d874ea81bc1e9e34bed612959d70365
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 23:24:32 2004 -0700

    [PATCH] Improve list.h documentation for _rcu() primitives
    
    From: "Paul E. McKenney" <paulmck@us.ibm.com>
    
    The attached patch improves the documentation of the _rcu list primitives.

commit c9a7032d296f8f8f8d915197ccb0fe0d1cfbe3ba
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 23:24:19 2004 -0700

    [PATCH] ibmlana needs CONFIG_MCA_LEGACY
    
    From: "Luiz Fernando N. Capitulino" <lcapitulino@prefeitura.sp.gov.br>
    
    IBM LAN Adapter/A driver depends on mca-legacy.

commit ed87121106003ee92c6623ebe9da70f2b1a2fdc3
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 23:24:06 2004 -0700

    [PATCH] cycx_drv.c warning fix.
    
    From: "Luiz Fernando N. Capitulino" <lcapitulino@prefeitura.sp.gov.br>
    
    drivers/net/wan/cycx_drv.c: In function `load_cyc2x':
    drivers/net/wan/cycx_drv.c:430: warning: unsigned int format, long unsigned int arg (arg 3)

commit fa736caa043b56b67cf988e9962e941aa26c64f4
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 23:23:53 2004 -0700

    [PATCH] pmdisk needs asmlinkage
    
    From: Pavel Machek <pavel@ucw.cz>
    
    This function will break with -mregparm, so mark it asmlinkage.

commit 4b99e75b617ed08420fb950750c8531ac2023ed3
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 23:23:40 2004 -0700

    [PATCH] tda1004x.c var not used.
    
    From: "Luiz Fernando N. Capitulino" <lcapitulino@prefeitura.sp.gov.br>
    
    drivers/media/dvb/frontends/tda1004x.c:191: warning: `errno' defined but not used

commit e77a6be97104571d73f6c1c2da54559463a1fd33
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 23:23:27 2004 -0700

    [PATCH] wavefront_synth.c var not used.
    
    From: "Luiz Fernando N. Capitulino" <lcapitulino@prefeitura.sp.gov.br>
    
    sound/isa/wavefront/wavefront_synth.c:1923: warning: `errno' defined but not used

commit f6ff7fe5959225d8e01f6a2767278a06fe0c275f
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 23:23:14 2004 -0700

    [PATCH] nfs-32bit-statfs-fix warning fix
    
    With CONFIG_LBD=n:
    
    fs/open.c: In function `vfs_statfs_native':
    fs/open.c:67: warning: comparison is always true due to limited range of data type
    fs/open.c:70: warning: comparison is always true due to limited range of data type

commit 678736c95c24a2aade3d72861e2d4ac10ce2eb6e
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 23:23:02 2004 -0700

    [PATCH] Fix 32bit statfs on NFS
    
    From: Olaf Kirch <okir@suse.de>
    
    The attached patch fixes a problem with the 32bit statfs call on NFS file
    systems.  Some NFS servers return a value of -1 for the f_files and f_ffree.
    The current code would think this is a 64bit value that cannot be converted
    to 32bits.  Consequently, the system call would always fail.
    
    The patch adds two special if() to detect a value of -1 for f_files and
    f_ffree.

commit a11317b11c05858ed17967ff2bff434f1b7a4652
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 23:22:48 2004 -0700

    [PATCH] Subject: [PATCH] Fix overflow bug in READDIRPLUS...
    
    From: Trond Myklebust <trond.myklebust@fys.uio.no>
    
    Fixes the Oops reported by Paul Blazejowski.  Bug turned out to be in the page
    overflow checking for READDIRPLUS.

commit 1908da86623cb242df778c347349bbd33bf448ff
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 23:22:36 2004 -0700

    [PATCH] drivers/base/platform.c typo fix
    
    From: Geert Uytterhoeven <Geert.Uytterhoeven@sonycom.com>

commit 6cd80eb73637cc15e24d5a19e88b675fed6c092f
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 23:22:22 2004 -0700

    [PATCH] cx88 update.
    
    From: Gerd Knorr <kraxel@bytesex.org>
    
    This is a update for the cx88 driver.  There are *lots* of changes:
    
      * vbi support was added.
      * plenty of fixes for audio support (there are still problems
        through).
      * new cards added.
      * serveral minor tweaks.

commit d4953f472e12591d90c611f6856b182392266d71
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 23:22:11 2004 -0700

    [PATCH] v4l: documentation update
    
    From: Gerd Knorr <kraxel@bytesex.org>
    
    This patch updates the documentation for the v4l drivers.

commit 2b12289cf7d246ca1d012776b002a970916c4620
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 23:21:57 2004 -0700

    [PATCH] v4l: bttv driver update
    
    From: Gerd Knorr <kraxel@bytesex.org>
    
    This patch updates the bttv driver.  Changes:
    
      (1) several card-specific tweaks.
      (2) make software vs. hardware i2c configurable per TV card.
      (3) reinitialize image parameters after chip reset.
      (4) make bttv quite by default on frame drops.
      (5) new insmod option: "debug_latency=1" to enable frame drop
          debug messages.
    
    bttv is quite sensitive to irq latencies, especially when capturing both
    video and vbi.  There are several reports about problems due to this, I don't
    see that on my machines through.  (5) dumps a stracktrace if the driver
    thinks the frame drop is is caused by high latencies as experiment, lets see
    whenever that helps ...

commit ba2fab99f0bdd23e0f59c8dced4d9adcec8670f7
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 23:21:44 2004 -0700

    [PATCH] v4l-saa7134-update fix
    
    drivers/built-in.o(.text+0x32912b): In function `dsp_buffer_init':
    drivers/media/video/saa7134/saa7134-oss.c:77: undefined reference to `videobuf_dma_init'

commit 5478e1cee32537d76970de8ac15b6023f0cbad13
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 23:21:31 2004 -0700

    [PATCH] v4l: saa7134 driver update
    
    From: Gerd Knorr <kraxel@bytesex.org>
    
    This is a update for the saa7134 driver.  Changes:
    
      * add cropping support.
      * fix Makefile to build the saa6752hs module.
      * fix locking bug in oss dsp driver.
      * infrared remote keytable update.
      * some card-specific fixes.

commit df5f63d97aee16d75140ec50a1de5616fd47d9d2
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 23:21:18 2004 -0700

    [PATCH] v4l: add support for pv951 remote to ir-kbd-i2c
    
    From: Gerd Knorr <kraxel@bytesex.org>
    
    Trivial patch, $subject says all, just a new keytable.

commit 3cfba98413fa46ce20da284d8bda4fc1d314ce49
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 23:21:05 2004 -0700

    [PATCH] v4l: msp3400 update
    
    From: Gerd Knorr <kraxel@bytesex.org>
    
    This patch allows to use switch to the second external input of the msp34xx
    chips.  Also has some minor cleanups and more verbose debug info.

commit c7d543e9b81fdd2bf70a48f85ea81ff5b6684e6d
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 23:20:52 2004 -0700

    [PATCH] v4l: tuner fix
    
    From: Gerd Knorr <kraxel@bytesex.org>
    
    This patch fixes a bug in the tuner descriptions and prepares for the removal
    of the type= insmod option by printing a warning when it is used.

commit 831434861116756312a982d2082d91d20fed1de0
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 23:20:39 2004 -0700

    [PATCH] v4l: v4l1-compat fix
    
    From: Gerd Knorr <kraxel@bytesex.org>
    
    Minor tweak in the v4l1 compatibility layer: Make sure that capture actually
    is active before going to wait for a frame so we don't block forever.

commit 2e061730cce0ec9d6157ee2f548625336647b7db
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 23:20:27 2004 -0700

    [PATCH] v4l: cropcap ioctl fix
    
    From: Gerd Knorr <kraxel@bytesex.org>
    
    The VIDIOC_CROPCAP ioctl had wrong R/W bits, this patch fixes it.

commit d570ea4b647ab5addc0646d16bb203b00de90023
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 23:20:13 2004 -0700

    [PATCH] ACL version mismatch error code fix
    
    From: Andreas Gruenbacher <agruen@suse.de>
    
    Return EOPNOTSUPP rather than EINVAL when we discover an ACL version
    mismatch.

commit 620bde45b3b3d8a7206c65f6224a9f3c007fb3ce
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 23:20:00 2004 -0700

    [PATCH] sunrpc: connection dropping tweaks
    
    From: Olaf Kirch <okir@suse.de>
    
    Some NFS clients respond badly to a TCP connection being reset immediately
    after it has been accepted so:
    
    - Accept more connections before starting to drop them
    
    - Always drop the oldest connection - Random Early Drop doesn't really help
      here, and can hurt
    
    - ratelimit the friendly warnings.

commit d1e069e24b6da75b8177ca523916309e27cd08e3
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 23:19:47 2004 -0700

    [PATCH] add stop_machine barriers
    
    From: Andrea Arcangeli <andrea@suse.de>
    
    We need a barrier before checking for kthread_should_stop in do_stop.

commit 26abb4bd6527eb5c26cb3fc861806c2265595284
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 23:19:35 2004 -0700

    [PATCH] epoll comment fix
    
    From: Davide Libenzi <davidel@xmailserver.org>
    
    When I split evenpoll_release() in an inline fast path plus an
    eventpoll_release_file() slow path, I forgot to change comments.

commit e0ecc25cc0b47c9ae1892d8c43be33dcc281cb49
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 23:19:21 2004 -0700

    [PATCH] build fails on sparc64 in hugetlbpage.c
    
    From: Romain Francoise <romain@orebokech.com>
    
    arch/sparc64/mm/hugetlbpage.c does not include linux/module.h so
    EXPORT_SYMBOL prints out warnings, and since sparc64 Makefiles have
    -Werror, the build fails.

commit 4c886627378d0efc943442e4ec19df4a27bd1636
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 23:19:09 2004 -0700

    [PATCH] ppc64: NUMA fix for 16MB LMBs
    
    From: Olof Johansson <olof@austin.ibm.com>
    
    As discussed on the ppc64 list yesterday and today:
    
    On some ppc64 systems, Open Firmware will give memory device nodes that are
    only 16MB in size, instead of the 256MB that our NUMA code currently
    expects (see MEMORY_INCREMENT in mmzone.h).
    
    Just changing the defines from 256MB to 16MB makes the table blow up from
    32KB to 512KB, so this patch also makes it dynamically allocated based on
    actual memory size.  Since all this is done before (well, during) bootmem
    init so we need to use lmb_alloc().
    
    Finally, there's no need to use a full int for node ID. Current max is 16
    nodes, so a signed char still leaves plenty of room to grow.

commit 9b8696f2a9f201f1a71eb0c53e8239846a2ebd67
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 23:18:56 2004 -0700

    [PATCH] procfs LoadAVG/load_avg scaling fix
    
    From: Ingo Molnar <mingo@elte.hu>
    
    Dave reported that /proc/*/status sometimes shows 101% as LoadAVG, which
    makes no sense.
    
    the reason of the bug is slightly incorrect scaling of the load_avg value.
    The patch below fixes this.

commit 95f238eac82907c4ccbc301cd5788e67db0715ce
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 23:18:43 2004 -0700

    [PATCH] ia32: 4Kb stacks (and irqstacks) patch
    
    From: Arjan van de Ven <arjanv@redhat.com>
    
    Below is a patch to enable 4Kb stacks for x86. The goal of this is to
    
    1) Reduce footprint per thread so that systems can run many more threads
       (for the java people)
    
    2) Reduce the pressure on the VM for order > 0 allocations. We see real life
       workloads (granted with 2.4 but the fundamental fragmentation issue isn't
       solved in 2.6 and isn't solvable in theory) where this can be a problem.
       In addition order > 0 allocations can make the VM "stutter" and give more
       latency due to having to do much much more work trying to defragment
    
    The first 2 bits of the patch actually affect compiler options in a generic
    way: I propose to disable the -funit-at-a-time feature from gcc.  With this
    enabled (and it's default with -O2), gcc will very agressively inline
    functions, which is nice and all for userspace, but for the kernel this makes
    us suffer a gcc deficiency more: gcc is extremely bad at sharing stackslots,
    for example a situation like this:
    
    if (some_condition)
    	function_A();
    else
    	function_B();
    
    with -funit-at-a-time, both function_A() and _B() might get inlined, however
    the stack usage of both functions of the parent function grows the stack
    usage of both functions COMBINED instead of the maximum of the two.  Even
    with the normal 8Kb stacks this is a danger since we see some functions grow
    3Kb to 4Kb of stack use this way.  With 4Kb stacks, 4Kb of stack usage growth
    obviously is deadly ;-( but even with 8Kb stacks it's pure lottery.
    Disabling -funit-at-a-time also exposes another thing in the -mm tree; the
    attribute always_inline is considered harmful by gcc folks in that when gcc
    makes a decision to NOT inline a function marked this way, it throws an
    error.  Disabling -funit-at-a-time disables some of the agressive inlining
    (eg of large functions that come later in the .c file) so this would make
    your tree not compile.
    
    The 4k stackness of the kernel is included in modversions, so people don't
    load 4k-stack modules into 8k-stack kernels.
    
    At present 4k stacks are selectable in config.  When the feature has settled
    in we should remove the 8k option.  This will break the nvidia modules.  But
    Fedora uses 4k stacks so a new nvidia driver is expected soon.

commit 124187e5946cb24afbfb41eecfcf9e7ff70b84b0
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 23:18:28 2004 -0700

    [PATCH] acpi printk fix
    
    drivers/acpi/events/evmisc.c: In function `acpi_ev_queue_notify_request':
    drivers/acpi/events/evmisc.c:143: warning: too many arguments for format

commit 94721b16208ad28b496807f0e8251d91f9ed0ba6
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 23:18:16 2004 -0700

    [PATCH] Fix logic in filemap_nopage()
    
    The filempa_nopage() logic will go into a tight loop if
    do_page_cache_readahead() doesn't actually start I/O against the target page.
    This can happen if the disk is read-congested, or if the filesystem doesn't
    want to read that part of the file for some reason.
    
    We will accidentally break out of the loop because
    
    	 (ra->mmap_miss > ra->mmap_hit + MMAP_LOTSAMISS)
    
    will eventually become true.
    
    Fix that up.

commit 80b1573f2a01c5138a4f87d46fde2148864cb312
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 23:18:04 2004 -0700

    [PATCH] Honour the readahead tunable in filemap_nopage()
    
    Remove the hardwired pagefault readaround distance in filemap_nopage() and
    use the per-file readahead setting.
    
    The main reason for this is in fact laptop-mode.  If you want to prevent the
    disk from spinning up then you want all of your application's pages to be
    pulled into memory in one hit.  Otherwise the disk will spin up each time you
    use a new part of whatever application(s) you are running.

commit 26f14a5727b9447f87ba4cdd8e83fb9e8af79631
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 23:17:51 2004 -0700

    [PATCH] Add commit=0 to ext3, meaning "set commit to default".
    
    From: Bart Samwel <bart@samwel.tk>
    
    Add support for the value "0" to ext3's "commit" option.  When this value
    is given, ext3 substitutes it by the default commit interval.  Introduce a
    constant JBD_DEFAULT_MAX_COMMIT_AGE for this.

commit 93d33a4885a483c708ccb7d24b56e0d5fef7bcab
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 23:17:38 2004 -0700

    [PATCH] laptop mode
    
    From: Bart Samwel <bart@samwel.tk>
    
    Adds /proc/sys/vm/laptop-mode: a special knob which says "this is a laptop".
    In this mode the kernel will attempt to avoid spinning disks up.
    
    Algorithm: the idea is to hold dirty data in memory for a long time, but to
    flush everything which has been accumulated if the disk happens to spin up
    for other reasons.
    
    - Whenever a disk request completes (read or write), schedule a timer a few
      seconds hence.  If the timer was already pending, reset it to a few seconds
      hence.
    
    - When the timer expires, write back the whole world.  We use
      sync_filesystems() for this because it will force ext3 journal commits as
      well.
    
    - In balance_dirty_pages(), kick off background writeback when we hit the
      high threshold (dirty_ratio), not when we hit the low threshold.  This has
      the effect of causing "lumpy" writeback which is something I spent a year
      fixing, but in laptop mode, it is desirable.
    
    - In try_to_free_pages(), only kick pdflush if the VM is getting into
      distress: we want to keep scanning for clean pages, deferring writeback.
    
    - In page reclaim, avoid writing back the odd random dirty page off the
      LRU: only start I/O if the scanning is working harder.
    
    The effect is to perform a sync() a few seconds after all I/O has ceased.
    
    The value which was written into /proc/sys/vm/laptop-mode determines, in
    seconds, the delay between the final I/O and the flush.
    
    Additionally, the patch adds tools which help answer the question "why the
    heck does my disk spin up all the time?".  The user may set
    /proc/sys/vm/block_dump to a non-zero value and the kernel will print out
    information which will identify the process which is performing disk reads or
    which is dirtying pagecache.
    
    The user should probably disable syslogd before setting block-dump.

commit 77fe0a196cfbed9157daf35e695893ca6d718260
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 23:17:24 2004 -0700

    [PATCH] kswapd: remove pages_scanned local
    
    This is always equal to constant zero.

commit 2d47875a16974f40f883ecfd0d7a3d0a3a101dd4
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 23:17:11 2004 -0700

    [PATCH] Fix rmap comment
    
    From: Hugh Dickins <hugh@veritas.com>
    
    rmap's try_to_unmap_one comments on find_vma failure, that a page may
    temporarily be absent from a vma during mremap: no longer, though it is still
    possible for this find_vma to fail, while unmap_vmas drops page_table_lock
    (but that is no problem for file truncation).

commit 59da95c4ae5888f21b0b005bcb71b20d7c4c9aef
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 23:16:58 2004 -0700

    [PATCH] mremap: check map_count
    
    From: Hugh Dickins <hugh@veritas.com>
    
    mremap's move_vma should think ahead to lessen the chance of failure during
    its rewind on failure: running out of memory always possible, but it's silly
    for it to embark when it's near the map_count limit.

commit 2039e7b519e24f743a708a5f10bdc95273d1e077
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 23:16:45 2004 -0700

    [PATCH] mremap: vma_relink_file race fix
    
    From: Hugh Dickins <hugh@veritas.com>
    
    Subtle point from Rajesh Venkatasubramanian: when mremap's move_vma fails and
    so rewinds, before moving the file-based ptes back, we must move new_vma
    before old vma in the i_mmap or i_mmap_shared list, so that when racing
    against vmtruncate we cannot propagate pages to be truncated back from
    new_vma into the just cleaned old_vma.

commit e2ea83742133d581a0422f1b2d276e690a81f043
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 23:16:32 2004 -0700

    [PATCH] mremap: move_vma fixes and cleanup
    
    From: Hugh Dickins <hugh@veritas.com>
    
    Partial rewrite of mremap's move_vma.  Rajesh Venkatasubramanian has pointed
    out that vmtruncate could miss ptes, leaving orphaned pages, because move_vma
    only made the new vma visible after filling it.  We see no good reason for
    that, and time to make move_vma more robust.
    
    Removed all its vma merging decisions, leave them to mmap.c's vma_merge, with
    copy_vma added.  Removed duplicated is_mergeable_vma test from vma_merge, and
    duplicated validate_mm from insert_vm_struct.
    
    move_vma move from old to new then unmap old; but on error move back from new
    to old and unmap new.  Don't unwind within move_page_tables, let move_vma
    call it explicitly to unwind, with the right source vma.  Get the
    VM_ACCOUNTing right even when the final do_munmap fails.

commit 209b450cc4e91c47cd38c42266840a90638c9b22
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 23:16:13 2004 -0700

    [PATCH] mremap: copy_one_pte cleanup
    
    From: Hugh Dickins <hugh@veritas.com>
    
    Clean up mremap move's copy_one_pte:
    
    - get_one_pte_map_nested already weeded out the pte_none case,
      now don't even call copy_one_pte if it has nothing to do.
    
    - check pfn_valid before passing page to page_remove_rmap.

commit 424e44d11e16e6a64c307f9a29e6b2716319b202
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 23:15:59 2004 -0700

    [PATCH] fork vma ordering during fork
    
    From: Hugh Dickins <hugh@veritas.com>
    
    First of six patches against 2.6.5-rc3, cleaning up mremap's move_vma, and
    fixing truncation orphan issues raised by Rajesh Venkatasubramanian.
    Originally done as part of the anonymous objrmap work on mremap move, but
    useful fixes now extracted for mainline.  The mremap changes need some
    exposure in the -mm tree first, but the first (fork one-liner) is safe enough
    to go straight into 2.6.5.
    
    
    
    From: Rajesh Venkatasubramanian.  Despite the comment that child vma should
    be inserted just after parent vma, 2.5.6 did exactly the reverse: thus a
    racing vmtruncate may free the child's ptes, then advance to the parent, and
    meanwhile copy_page_range has propagated more ptes from the parent to the
    child, leaving file pages still mapped after truncation.

commit 3c7011b3e90508f2f3adb895d712d36b1cfdcfd2
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 23:15:46 2004 -0700

    [PATCH] use compound pages for hugetlb pages only
    
    The compound page logic is a little fragile - it relies on additional
    metadata in the pageframes which some other kernel code likes to stomp on
    (xfs was doing this).
    
    Also, because we're treating all higher-order pages as compound pages it is
    no longer possible to free individual lower-order pages from the middle of
    higher-order pages.  At least one ARM driver insists on doing this.
    
    We only really need the compound page logic for higher-order pages which can
    be mapped into user pagetables and placed under direct-io.  This covers
    hugetlb pages and, conceivably, soundcard DMA buffers which were allcoated
    with a higher-order allocation but which weren't marked PageReserved.
    
    The patch arranges for the hugetlb implications to allocate their pages with
    compound page metadata, and all other higher-order allocations go back to the
    old way.
    
    (Andrea supplied the GFP_LEVEL_MASK fix)

commit 60af4464478e1511998ad82d7cba3fbfb6c258dd
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 23:15:33 2004 -0700

    [PATCH] mpage_writepages() cleanup
    
    Rework the code layout a bit.  No logic change.

commit 082825b67cf534c0ddee9168133b160ca4ba593f
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 23:15:19 2004 -0700

    [PATCH] Add mpage_writepages() scheduling point
    
    From: Jens Axboe <axboe@suse.de>
    
    Takashi did some nice latency testing of the current kernel (with -mm
    writeback changes), and the biggest offender in general core is
    mpage_writepages().

commit 9672a337305358ecc81dc17700e58ce3f42c11f6
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 23:15:07 2004 -0700

    [PATCH] writeback efficiency and QoS improvements
    
    The radix-tree walk for writeback has a couple of problems:
    
    a) It always scans a file from its first dirty page, so if someone
       is repeatedly dirtying the front part of a file, pages near the end
       may be starved of writeout.  (Well, not completely: the `kupdate'
       function will write an entire file once the file's dirty timestamp
       has expired).
    
    b) When the disk queues are huge (10000 requests), there can be a
       very large number of locked pages.  Scanning past these in writeback
       consumes quite some CPU time.
    
    So in each address_space we record the index at which the last batch of
    writeout terminated and start the next batch of writeback from that
    point.

commit bd134f2720aa6fe1544a76360999d8e18e5f3e02
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 23:14:52 2004 -0700

    [PATCH] don't allow background writes to hide dirty buffers
    
    If pdflush hits a locked-and-clean buffer in __block_write_full_page() it
    will just pass over the buffer.  Typically the buffer is an ext3 data=ordered
    buffer which is being written by kjournald, but a similar thing can happen
    with blockdev buffers and ll_rw_block().
    
    This is bad because the buffer is still under I/O and a subsequent fsync's
    fdatawait() needs to know about it.
    
    It is not practical to tag the page for writeback - only the submitter of the
    I/O can do that, because the submitter has control of the end_io handler.
    
    So instead, redirty the page so a subsequent fsync's fdatawrite() will wait on
    the underway I/O.
    
    There is a risk that pdflush::background_writeout() will lock up, repeatedly
    trying and failing to write the same page.  This is prevented by ensuring
    that background_writeout() always throttles when it made no progress.

commit d3eb546e203ab717237566e5762d97796e58f41f
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 23:14:39 2004 -0700

    [PATCH] fdatasync integrity fix
    
    fdatasync can fail to wait on some pages due to a race.
    
    If some task (eg pdflush) is flushing the same mapping it can remove a page's
    dirty tag but not then mark that page as being under writeback, because
    pdflush hit a locked buffer in __block_write_full_page().  This will happen
    because kjournald is writing the buffer.  In this situation
    __block_write_full_page() will redirty the page so that fsync notices it, but
    there is a window where the page eludes the radix tree dirty page walk.
    
    Consequently a concurrent fsync will fail to notice the page when walking the
    radix tree's dirty pages.
    
    The approach taken by this patch is to leave the page marked as dirty in the
    radix tree while ->writepage is working out what to do with it.  This ensures
    that a concurrent write-for-sync will successfully locate the page and will
    then block in lock_page() until the non-write-for-sync code has finished
    altering the page state.

commit be5ceb401d4853c6b31f3f0c79d6b14ef5847288
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 23:14:26 2004 -0700

    [PATCH] remove page.list
    
    Remove the now-unneeded page.list field.

commit 67817afb902270c3b7a0af03ee90dc598f79f96f
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 23:14:13 2004 -0700

    [PATCH] switch the m68k pointer-table code over to page->lru
    
    Switch the m68k pointer-table code over to page->lru.

commit de8940138dcb60255ba4325f1d136135ed5cb8c7
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 23:13:59 2004 -0700

    [PATCH] arm: stop using page->list
    
    Switch the ARM `small_page' code over to page->lru.

commit 0fcb51fd7ee151a03aab2d07493bbadf176a1457
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 23:13:47 2004 -0700

    [PATCH] stop using page->lru in compound pages
    
    The compound page logic is using page->lru, and these get will scribbled on
    in various places so switch the Compound page logic over to using ->mapping
    and ->private.

commit bd64f049f52553234586f7e825a4ddcee0794c2f
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 23:13:34 2004 -0700

    [PATCH] stop using page.list in readahead
    
    The address_space.readapges() function currently takes a list of pages,
    strung together via page->list.  Switch it to using page->lru.
    
    This changes the API into filesystems.

commit 90687aa1befb2d75eb57f965efc5b8c2977ef09a
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 23:13:22 2004 -0700

    [PATCH] stop using page.list in pageattr.c
    
    Switch it to ->lru

commit c41bb9c4e31dfa3e9e60f5ff57a02eae7a0d940e
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 23:13:09 2004 -0700

    [PATCH] stop using page->list in the hugetlbpage implementations
    
    Switch them over to page.lru

commit 62e52945661bf53f461d218e9fa253fc5ce5a85d
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 23:12:56 2004 -0700

    [PATCH] stop using page.list in the page allocator
    
    Switch the page allocator over to using page.lru for the buddy lists.

commit 02979dcbfcab5aee309a0c995283622cea4c5e6d
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 23:12:42 2004 -0700

    [PATCH] slab: stop using page.list
    
    slab.c is using page->list.  Switch it over to using page->lru so we can
    remove page.list.

commit c33c9e78434fbf8c3ffb4f72bb2a57d12c4b70af
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 23:12:30 2004 -0700

    [PATCH] revert the slabification of i386 pgd's and pmd's
    
    This code is playing with page->lru from pages which came from slab.  But to
    remove page->list we need to convert slab over to using page->lru.  So we
    cannot allow the i386 pagetable code to go scribbling on the ->lru field of
    active slab pages.
    
    This optimisation was pretty thin, and it is more important to shrink the
    pageframe (on all architectures).

commit d672c382411ffafbf2b8ed608dfdb8bd8e67307d
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 23:12:13 2004 -0700

    [PATCH] stop using address_space.clean_pages
    
    Remove remaining references to address_space.clean_pages.

commit a15133091ee83b0a97913cd48d6131188af093e1
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 23:12:01 2004 -0700

    [PATCH] Stop using address_space.locked_pages
    
    Instead, use a radix-tree walk of the pages which are tagged as being under
    writeback.
    
    The new function wait_on_page_writeback_range() was generalised out of
    filemap_fdatawait().  We can later use this to provide concurrent fsync of
    just a section of a file.

commit 3c1ed9b2ce95145ba1c0434a7a7b63261fd7c15d
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 23:11:47 2004 -0700

    [PATCH] remove address_space.io_pages
    
    Now remove address_space.io_pages.

commit b79a84082a343912ee4cc7c4999726b53aa4c64b
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 23:11:35 2004 -0700

    [PATCH] fix the kupdate function
    
    Juggle dirty pages and dirty inodes and dirty superblocks and various
    different writeback modes and livelock avoidance and fairness to recover from
    the loss of mapping->io_pages.

commit 1d7d3304e9845f61cab6b6091e8952f6fb05009a
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 23:11:21 2004 -0700

    [PATCH] stop using the address_space dirty_pages list
    
    Move everything over to walking the radix tree via the PAGECACHE_TAG_DIRTY
    tag.  Remove address_space.dirty_pages.

commit 40c8348ec03fa2c525e13ca6ee54279735563ee4
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 23:11:08 2004 -0700

    [PATCH] tag writeback pages as such in their radix tree
    
    Arrange for under-writeback pages to be marked thus in their pagecache radix
    tree.

commit 8ece6262c5fef1b935a944f5d16965ff7dd5d1cc
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 23:10:54 2004 -0700

    [PATCH] tag dirty pages as such in the radix tree
    
    Arrange for all dirty pagecache pages to be tagged as dirty within their
    radix tree.

commit 89261aab0c7064ca9766bc79e7867b6104274f56
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 23:10:41 2004 -0700

    [PATCH] make the pagecache lock irq-safe.
    
    Intro to these patches:
    
    - Major surgery against the pagecache, radix-tree and writeback code.  This
      work is to address the O_DIRECT-vs-buffered data exposure horrors which
      we've been struggling with for months.
    
      As a side-effect, 32 bytes are saved from struct inode and eight bytes
      are removed from struct page.  At a cost of approximately 2.5 bits per page
      in the radix tree nodes on 4k pagesize, assuming the pagecache is densely
      populated.  Not all pages are pagecache; other pages gain the full 8 byte
      saving.
    
      This change will break any arch code which is using page->list and will
      also break any arch code which is using page->lru of memory which was
      obtained from slab.
    
      The basic problem which we (mainly Daniel McNeil) have been struggling
      with is in getting a really reliable fsync() across the page lists while
      other processes are performing writeback against the same file.  It's like
      juggling four bars of wet soap with your eyes shut while someone is
      whacking you with a baseball bat.  Daniel pretty much has the problem
      plugged but I suspect that's just because we don't have testcases to
      trigger the remaining problems.  The complexity and additional locking
      which those patches add is worrisome.
    
      So the approach taken here is to remove the page lists altogether and
      replace the list-based writeback and wait operations with in-order
      radix-tree walks.
    
      The radix-tree code has been enhanced to support "tagging" of pages, for
      later searches for pages which have a particular tag set.  This means that
      we can ask the radix tree code "find me the next 16 dirty pages starting at
      pagecache index N" and it will do that in O(log64(N)) time.
    
      This affects I/O scheduling potentially quite significantly.  It is no
      longer the case that the kernel will submit pages for I/O in the order in
      which the application dirtied them.  We instead submit them in file-offset
      order all the time.
    
      This is likely to be advantageous when applications are seeking all over
      a large file randomly writing small amounts of data.  I haven't performed
      much benchmarking, but tiobench random write throughput seems to be
      increased by 30%.  Other tests appear to be unaltered.  dbench may have got
      10-20% quicker, but it's variable.
    
      There is one large file which everyone seeks all over randomly writing
      small amounts of data: the blockdev mapping which caches filesystem
      metadata.  The kernel's IO submission patterns for this are now ideal.
    
    
      Because writeback and wait-for-writeback use a tree walk instead of a
      list walk they are no longer livelockable.  This probably means that we no
      longer need to hold i_sem across O_SYNC writes and perhaps fsync() and
      fdatasync().  This may be beneficial for databases: multiple processes
      writing and syncing different parts of the same file at the same time can
      now all submit and wait upon writes to just their own little bit of the
      file, so we can get a lot more data into the queues.
    
      It is trivial to implement a part-file-fdatasync() as well, so
      applications can say "sync the file from byte N to byte M", and multiple
      applications can do this concurrently.  This is easy for ext2 filesystems,
      but probably needs lots of work for data-journalled filesystems and XFS and
      it probably doesn't offer much benefit over an i_semless O_SYNC write.
    
    
      These patches can end up making ext3 (even) slower:
    
    	for i in 1 2 3 4
    	do
    		dd if=/dev/zero of=$i bs=1M count=2000 &
    	done
    
      runs awfully slow on SMP.  This is, yet again, because all the file
      blocks are jumbled up and the per-file linear writeout causes tons of
      seeking.  The above test runs sweetly on UP because the on UP we don't
      allocate blocks to different files in parallel.
    
      Mingming and Badari are working on getting block reservation working for
      ext3 (preallocation on steroids).  That should fix ext3 up.
    
    
    This patch:
    
    - Later, we'll need to access the radix trees from inside disk I/O
      completion handlers.  So make mapping->page_lock irq-safe.  And rename it
      to tree_lock to reliably break any missed conversions.

commit 8691fb836b268c622c61281238219fc166f0eee5
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 23:10:27 2004 -0700

    [PATCH] radix-tree tags for selective lookup
    
    Add radix-tree tagging so we can look up dirty or writeback pages in
    O(log64(n)) time.
    
    Each radix-tree node gains two bits for each slot: one for page dirtiness and
    one for page writebackness.
    
    If a tag bit is set on a leaf node, it indicates that item at the
    corresponding slot is tagged (say, a dirty page).
    
    If a tag bit is set in a non-leaf node it indicates that the same tag bit is
    set in the subtree which lies under the corresponding slot.  ie: "there is a
    dirty page under here somewhere, but you need to search down further to find
    it".
    
    A gang lookup function is provided which can walk the radix tree in
    logarithmic time looking for items which are tagged, starting from a
    specified offset.  We use this for in-order searches for dirty or writeback
    pages.
    
    There is a userspace test harness for this code at
    
    http://www.zip.com.au/~akpm/linux/patches/stuff/rtth.tar.gz

commit e279bfef94ec8ab13043eee1a185769fd7874473
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 23:10:17 2004 -0700

    [PATCH] rw_swap_page_sync(): place the pages in swapcache
    
    This function is setting page->mapping = swapper_space, but isn't actually
    adding the page to swapcache.  This triggers soon-to-be-added BUGs in the
    radix tree code.
    
    So temporarily add these pages to swapcache for real.
    
    Also, make rw_swap_page_sync() go away if it has no callers.

commit c58d3aeb27b8dbc52525e39089017f7e67473d4f
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 23:10:03 2004 -0700

    [PATCH] AIO+DIO bio_count race fix
    
    From: Suparna Bhattacharya <suparna@in.ibm.com>,
          Daniel McNeil <daniel@osdl.org>
    
    This patch ensures that when the DIO code falls back to buffered i/o after
    having submitted part of the i/o, then buffered i/o is issued only for the
    remaining part of the request (i.e.  the part not already covered by DIO),
    rather than redo the entire i/o.  Now, instead of returning written ==
    -ENOTBLK, generic_file_direct_IO returns the number of bytes already handled
    by DIO, so that the caller knows how much of the I/O is left to be handled
    via fallback to buffered write.
    
    We need to careful not to access dio fields if its possible that the dio
    could already have been freed asynchronously during i/o completion.  A tricky
    part of this involves plugging the window between the decrement of bio_count
    and accessing dio->waiter during i/o completion where the dio could get freed
    by the submission path.  This potential "bio_count race" was tackled (by
    Daniel) by changing bio_list_lock into bio_lock and using that for all the
    bio fields.  Now bio_count and bios_in_flight have been converted from
    atomics into int and are both protected by the bio_lock.  The race in
    finished_one_bio() could thus be fixed by leaving the bio_count at 1 until
    after the dio_complete() and then doing the bio_count decrement and wakeup
    holding the bio_lock.  It appears that shifting to the spin_lock instead of
    atomic_inc/decs is ok performance wise as well.
    
    Update:
    
    An AIO O_DIRECT request was extending the file so it was done
    synchronously.  However, the request got an EFAULT and direct_io_worker()
    was calling aio_complete() on the iocb and returning the EFAULT.  When
    io_submit_one() got the EFAULT return, it assume it had to call
    aio_complete() since the i/o never got queued.
    
    The fix is for direct_io_worker() to only call aio_complete() when the
    upper layer is going to return -EIOCBQUEUED and not when getting errors
    that are being return to the submit path.

commit 332c8cf13bc8266fcae14579c3be4d7cfed734c0
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 23:09:51 2004 -0700

    [PATCH] direct-io AIO fixes
    
    From: Suparna Bhattacharya <suparna@in.ibm.com>
    
    Fixes the following remaining issues with the DIO code:
    
    1. During DIO file extends, intermediate writes could extend i_size
       exposing unwritten blocks to intermediate reads (Soln: Don't drop i_sem
       for file extends)
    
    2. AIO-DIO file extends may update i_size before I/O completes,
       exposing unwritten blocks to intermediate reads.  (Soln: Force AIO-DIO
       file extends to be synchronous)
    
    3. AIO-DIO writes to holes call aio_complete() before falling back to
       buffered I/O !  (Soln: Avoid calling aio_complete() if -ENOTBLK)
    
    4. AIO-DIO writes to an allocated region followed by a hole, falls back
       to buffered i/o without waiting for already submitted i/o to complete;
       might return to user-space, which could overwrite the buffer contents
       while they are still being written out by the kernel (Soln: Always wait
       for submitted i/o to complete before falling back to buffered i/o)

commit aa34baa28ec02492e258e3605cd32e5da74e6e9a
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 23:09:37 2004 -0700

    [PATCH] blockdev direct-io speedups
    
    From: Badari Pulavarty <pbadari@us.ibm.com>
    
    1) blkdev_direct_IO() calls blockdev_direct_IO() instead of
       blockdev_direct_IO_no_locking().
    
    2) writev entry point is generic_file_writev() which grabs i_sem.  It
       should use generic_file_write_nolock() instead.

commit c2179a486bcda7961524ec3c6eb9a33fcbc52541
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 23:09:25 2004 -0700

    [PATCH] Fix race between ll_rw_block() and block_write_full_page()
    
    Fix a race which was identified by Daniel McNeil <daniel@osdl.org>
    
    If a buffer_head is under I/O due to JBD's ordered data writeout (which uses
    ll_rw_block()) then either filemap_fdatawrite() or filemap_fdatawait() need
    to wait on the buffer's existing I/O.
    
    Presently neither will do so, because __block_write_full_page() will not
    actually submit any I/O and will hence not mark the page as being under
    writeback.
    
    The best-performing fix would be to somehow mark the page as being under
    writeback and defer waiting for the ll_rw_block-initiated I/O until
    filemap_fdatawait()-time.  But this is hard, because in
    __block_write_full_page() we do not have control of the buffer_head's end_io
    handler.  Possibly we could make JBD call into end_buffer_async_write(), but
    that gets nasty.
    
    This patch makes __block_write_full_page() wait for any buffer_head I/O to
    complete before inspecting the buffer_head state.  It only does this in the
    case where __block_write_full_page() was called for a "data-integrity" write:
    (wbc->sync_mode != WB_SYNC_NONE).
    
    Probably it doesn't matter, because kjournald is currently submitting (or has
    already submitted) all dirty buffers anyway.

commit bc0e2bbf8f0c8e77501677116798e8d7c6a8f49f
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 23:09:10 2004 -0700

    [PATCH] O_DIRECT data exposure fixes
    
    From: Badari Pulavarty, Suparna Bhattacharya, Andrew Morton
    
    Forward port of Stephen Tweedie's DIO fixes from 2.4, to fix various DIO vs
    buffered IO exposures involving races causing:
    
    (a) stale data from uninstantiated blocks to be read, e.g.
    
        - O_DIRECT reads against buffered writes to a sparse region
    
        - O_DIRECT writes to a sparse region against buffered reads
    
    (b) potential data corruption with
    
        - O_DIRECT IOs against truncate
    
        due to writes to truncated blocks (which may have been reallocated to
        another file).
    
    Summary of fixes:
    
    1) All the changes affect only regular files.  RAW/O_DIRECT on block are
       unaffected.
    
    2) The DIO code will not fill in sparse regions on a write.  Instead
       -ENOTBLK is returned and the generic file write code would fallthrough to
       buffered IO in this case followed by writing through the pages to disk
       using filemap_fdatawrite/wait.
    
    3) i_sem is held during both DIO reads and writes.  For reads, and writes
       to already allocated blocks, it is released right after IO is issued,
       while for writes to newly allocated blocks (e.g file extending writes and
       hole overwrites) it is held all the way through until IO completes (and
       data is committed to disk).
    
    4) filemap_fdatawrite/wait are called under i_sem to synchronize buffered
       pages to disk blocks before issuing DIO.
    
    5) A new rwsem (i_alloc_sem) is held in shared mode all the while a DIO
       (read or write) is in progress, and in exclusive mode by truncate to guard
       against deallocation of data blocks during DIO.
    
    6) All this new locking has been pushed down into blockdev_direct_IO to
       avoid interfering with NFS direct IO.  The locks are taken in the order
       i_sem followed by i_alloc_sem.  While i_sem may be released after IO
       submission in some cases, i_alloc_sem is held through until dio_complete
       (in the case of AIO-DIO this happens through the IO completion callback).
    
    7) i_sem and i_alloc_sem are not held for the _nolock versions of write
       routines, as used by blockdev and XFS.  Filesystems can specify the
       needs_special_locking parameter to __blockdev_direct_IO from their direct
       IO address space op accordingly.
    
    Note from Badari:
    Here is the locking (when needs_special_locking is true):
    
    (1) generic_file_*_write() holds i_sem (as before) and calls
        ->direct_IO().  blockdev_direct_IO gets i_alloc_sem and call
        direct_io_worker().
    
    (2) generic_file_*_read() does not hold any locks.  blockdev_direct_IO()
        gets i_sem and then i_alloc_sem and calls direct_io_worker() to do the
        work
    
    (3) direct_io_worker() does the work and drops i_sem after submitting IOs
        if appropriate and drops i_alloc_sem after completing IOs.

commit 62a36b1f8db45ded106d35858a03964365eb44cf
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 23:08:58 2004 -0700

    [PATCH] enable suspend-on-halt for NS Geode
    
    From: Matt Mackall <mpm@selenic.com>
    
    From: Zwane Mwaikambo <zwane@arm.linux.org.uk>
    
    This enables deep powersaving mode on Geode boxes.

commit 87217f471c7d293548938c4d396fbafde664dde4
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 23:08:45 2004 -0700

    [PATCH] shrink inode when quota is disabled
    
    From: Matt Mackall <mpm@selenic.com>
    
    drop quota array in inode struct if no quota support

commit 8398bcc6b3eb950a1242f6dc4cfb151b6b9238c3
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 23:08:32 2004 -0700

    [PATCH] eliminate nswap and cnswap
    
    From: Matt Mackall <mpm@selenic.com>
    
    The nswap and cnswap variables counters have never been incremented as
    Linux doesn't do task swapping.

commit b931abdbe485f7471f7b6d23d4123610cb8b558c
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 23:08:19 2004 -0700

    [PATCH] improve CONFIG_EMBEDDED help text
    
    From: Matt Mackall <mpm@selenic.com>
    
    Make CONFIG_EMBEDDED description more accurate

commit cc66b6fcb8c424bfec6c4fc230eaae7a378244ba
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 23:08:06 2004 -0700

    [PATCH] remove bogus MOD_{INC,DEC}_USE_COUNT from hysdn
    
    From: Christoph Hellwig <hch@lst.de>
    
    the maintainer doesn't response unfortauntely, but removing these from
    net_devices unconditionally is the 2.6 way to go, there's no more module
    refcounting on net devices.

commit 36bf1087c804e7bdde82ffeb6c7ddc5f85da643c
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 23:07:53 2004 -0700

    [PATCH] oss/wavfront.c warning fix.
    
    From: "Luiz Fernando N. Capitulino" <lcapitulino@prefeitura.sp.gov.br>
    
    sound/oss/wavfront.c: At top level:
    sound/oss/wavfront.c:2498: warning: `errno' defined but not used

commit ffe52a4ad78700325df3ca8c4d44ba04a1149545
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 23:07:40 2004 -0700

    [PATCH] kill spurious MAKDEV scripts
    
    From: Christoph Hellwig <hch@lst.de>
    
    Kill magic ide/sound makedev scripts in scripts/.  The userland MAKEDEV is
    the proper place and already has support for them.

commit 7653e3ac4901d2f7f3c98980aeb1a19d2d6f19e7
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 23:07:26 2004 -0700

    [PATCH] missing NULL pointer check in pte_alloc_one.
    
    From: Martin Schwidefsky <schwidefsky@de.ibm.com>
    
    Just found an small bug in pgalloc for s390*.  Comparing notes with other
    architectures I found that pte_alloc_one is sick for alpha and sparc64 as
    well.

commit d15128eb539b325df2d71c331ac4994da5f97740
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 23:07:13 2004 -0700

    [PATCH] selinux: fix struct type
    
    From: Stephen Smalley <sds@epoch.ncsc.mil>
    
    This patch fixes the type of the ssec pointer in the sk_free_security
    function.  This has no current impact as the magic element is the top of each
    structure.  Thanks to Chad Hanson of TCS for discovering the bug and
    submitting the patch.

commit 25c1c70bfdb5f3c2f17129cd324258da15924f7f
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 23:07:00 2004 -0700

    [PATCH] stv0299.c unused variable
    
    From: "Luiz Fernando N. Capitulino" <lcapitulino@prefeitura.sp.gov.br>
    
    drivers/media/dvb/frontends/stv0299.c:356: warning: unused variable `i'

commit 9938e2c218f2c86f344bf8e9c707666a4cf0736b
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 23:06:47 2004 -0700

    [PATCH] ia64 MSI support
    
    From: "Nguyen, Tom L" <tom.l.nguyen@intel.com>
    
    Adds MSI support for ia64.
    
    - Modified existing code in drivers/pci/msi.c and drivers/pci/msi.h to
      include MSI support on IA64 platform.
    
    - Based on the comments received from Zwane Mwaikambo and David Mosberger,
      this patch consolidates the vector allocators as
      assign_irq_vector(AUTO_ASSIGN) has the same semantics as
      ia64_alloc_vector() by converting the existing uses of ia64_alloc_vector()
      to assign_irq_vector(AUTO_ASSIGN).
    
    - Based on the comments received from Zwane Mwaikambo, this patch
      consolidates the semantics of vector allocator assign_irq_vector() in
      drivers/pci/msi.c into the relevant architecture's vector allocator
      assign_irq_vector() in arch/i386/kernel/io_apic.c.
    
    - Regarding vector allocation, this patch modifies the existing function
      assign_irq_vector() to maximize the number of allocated vectors to 188
      before going -ENOSPC.
    
    - Based on your comments, this patch creates <asm-i386/msi.h>,
      <asm-ia64/msi.h> and <asm-x86_64/msi.h>, includes <asm/msi.h> from within
      drivers/pci/msi.h and then places all the code which is currently under
      ifdef in msi.h into the relevant architecture's <asm/msi.h> file.
    
    - Based on your comments, this patch places pci_vector_resources() in
      existing drivers/pci/msi.c in the relevant architecture implementations
      such as into arch/.../pci/irq.c.

commit 27b5c750bb8e5f2e01e1e7a605da7ae3383305a0
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 23:06:32 2004 -0700

    [PATCH] summmit: increase MAX_MP_BUSSES
    
    From: James Cleverdon <jamesclv@us.ibm.com>
    
    Bump up MAX_MP_BUSSES for summit/generic subarch to cope with big IBM x440
    systems.

commit 15e98d5d7a15045e2c0d3dc0f27b9100f50b5fe5
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 23:06:21 2004 -0700

    [PATCH] summit: per-subarch NR_IRQ_VECTORS
    
    From: James Cleverdon <jamesclv@us.ibm.com>
    
    Break out the definition of NR_IRQ_VECTORS, etc from irq_vectors.h into
    irq_vectors_limits.h, so we can change it per subarch without having code
    duplication for the rest of the file.  Stick the same values back for
    mach-default, and override them for mach-summit/generic which needs bigger
    limits.

commit 8e1aabbc236128b9e696ae61235b17165bb73ada
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 23:06:08 2004 -0700

    [PATCH] Strip quotes from kernel parameters
    
    From: Rusty Russell <rusty@rustcorp.com.au>
    
    Agustin Martin <agmartin@debian.org> pointed out that this doesn't work:
    
    	options ide-mod options="ide=nodma hdc=cdrom"
    
    The quotes are understood by kernel/params.c (ie.  it skips over spaces
    inside them), but are not stripped before handing to the underlying
    function.  They should be.

commit 7feebd5c337842ba67cbba5e2d9a74893e3b81cf
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 23:05:54 2004 -0700

    [PATCH] Fix huge sparse tmpfs files
    
    From: Hugh Dickins <hugh@veritas.com>
    
    Kevin P.  Fleming pointed out that the 2.6 tmpfs does not allow writing huge
    sparse files.  This is an unintended side-effect of the strict memory commit
    changes: which should make no difference.
    
    The solution is to treat the tmpfs files (of variable size) and the shmem
    objects (of fixed size) differently: sounds nasty but works out well.  The
    shmem objects follow the VM preallocation convention as before, but the tmpfs
    files revert to allocation on demand as a filesystem would.  If there's not
    enough memory to write to a tmpfs hole, it is reported as -ENOSPC rather than
    -ENOMEM, so the mmap writer gets SIGBUS rather than everyone else getting
    OOM-killed.

commit 77c8efaeba52f0ebe0aaab689bdbb53bf6f5a723
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 23:05:41 2004 -0700

    [PATCH] Remove bitmap_shift_*() bitmap length limits
    
    From: William Lee Irwin III <wli@holomorphy.com>
    
    Chang bitmap_shift_left()/bitmap_shift_right() to have O(1) stackspace
    requirements.
    
    Given zeroed tail preconditions these implementations satisfy zeroed tail
    postconditions, which makes them compatible with whatever changes from Paul
    Jackson one may want to merge in the future.  No particular effort was
    required to ensure this.
    
    A small (but hopefully forgiveable) cleanup is a spelling correction:
    s/bitmap_shift_write/bitmap_shift_right/ in one of the kerneldoc comments.
    
    The primary effect of the patch is to remove the MAX_BITMAP_BITS
    limitation, so restoring the NR_CPUS to be limited only by stackspace and
    slab allocator maximums.  They also look vaguely more efficient than the
    current code, though as this was not done for performance reasons, no
    performance testing was done.

commit 387f7c83eb26b4f45e6d843f2ef703aafbe6c80f
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 23:05:28 2004 -0700

    [PATCH] Support for floppies whose sectors are numbered from zero instead of one
    
    From: Marcelo Tosatti <marcelo.tosatti@cyclades.com>
    
    From: Alain Knaff <alain.knaff@lll.lu>
    
    This patch adds support for floppy disks whose sectors are numbered
    starting at 0 rather than 1 as usual disks would be.  This format is used
    for some CP/M disks, and also for certain music samplers (such as Ensoniq
    Ensoniq EPS 16plus).
    
    In order to use it, you need an fdutils with the current patch from
    http://fdutils.linux.lu as well, and then do setfdrpm /dev/fd0 dd zerobased
    sect=10 or setfdprm /dev/fd0 hd zerobased sect.
    
    In addtion, the patch also fixes my email addresses.  I no longer use
    pobox.com.

commit 7fdaa12102db8aa6bf3ecfcd11bd8b655585a87e
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 23:05:15 2004 -0700

    [PATCH] fix modversions now __this_module is created only in .ko
    
    From: Rusty Russell <rusty@rustcorp.com.au>
    
    Brian Gerst's patch which moved __this_module out from module.h into the
    module post-processing had a side effect.  genksyms didn't see the
    undefined symbols for modules without a module_init (or module_exit), and
    hence didn't generate a version for them, causing the kernel to be tainted.
    
    The simple solution is to always include the versions for these functions.
    Also includes two cleanups:
    
    1) alloc_symbol is easier to use if it populates ->next for us.
    
    2) add_exported_symbol should set owner to module, not head of module
       list (we don't use this field in entries in that list, fortunately).

commit 7ee168c0b7a988210cc8024d105dfd1cb3e956e6
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 23:05:02 2004 -0700

    [PATCH] Move __this_module to modpost
    
    From: Brian Gerst <bgerst@didntduck.org>
    
    Move the __this_module structure to the modpost code where it really
    belongs.

commit a05fc485ee36ccca83808dae14a2487ab46d4c56
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 23:04:48 2004 -0700

    [PATCH] speed up fget() and fget_light()
    
    Eric Dumazet <dada1@cosmosbay.com>
    
    We can avoid evaluating `current' in a few places.

commit a18fde09ee97c4cd592ee5cb7c31c5b0f5f3030e
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 23:04:36 2004 -0700

    [PATCH] cpu5wdt.c warning fix
    
    From: Heiko Ronsdorf <hero@persua.de>
    
    - Remvoe a volatile which causes a warning via module_param()
    
    - Remove an unused variable.

commit 47b54fbff358a1d5ee4738cec8a53a08bead72e4
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 23:04:22 2004 -0700

    [PATCH] /dev/urandom scalability improvement
    
    From: David Mosberger <davidm@napali.hpl.hp.com>
    
    Somebody recently pointed out a performance-anomaly to me where an unusual
    amount of time was being spent reading from /dev/urandom.  The problem
    isn't really surprising as it happened only on >= 4-way machines and the
    random driver isn't terribly scalable the way it is written today.  If
    scalability _really_ mattered, I suppose per-CPU data structures would be
    the way to go.  However, I found that at least for 4-way machines,
    performance can be improved considerably with the attached patch.  In
    particular, I saw the following performance on a 4-way ia64 machine:
    
    Test: 3 tasks running "dd if=/dev/urandom of=/dev/null bs=1024":
    
    			throughput:

commit ce334bb8f0f084112dcfe96214cacfa0afba7e10
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 23:04:10 2004 -0700

    [PATCH] export complete_all()
    
    From: Mike Waychison <Michael.Waychison@Sun.COM>
    
    Export complete_all for module use.

commit 50a1d632ab8d8b8fab3f3e0fe1dda0bbfbe0567b
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 23:03:56 2004 -0700

    [PATCH] i830 DRM missing put_user
    
    From: Arjan van de Ven <arjanv@redhat.com>
    
    The patch below adds a few missing put_user()'s to the i810/i830 drm
    modules.  Users reported oopses with 4g/4g split in action, and sparse
    annotations indeed found the offender in the function in question.  I've
    kept the sparse __user annotations since those are generally useful anyway.
     I can't test it myself but a few people reported that the oopses went away
    so far.

commit 1079b18707c78ea1a31ca66f3e1e17fe86fd9894
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 23:03:44 2004 -0700

    [PATCH] Update Documentation/Changes
    
    From: Trivial Patch Monkey <trivial@rustcorp.com.au>
    
    From:  Thomas Molina <tmolina@cablespeed.com>

commit 73007d9ba77ac46b40a9ad4231cfe9d9d4101dd1
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 23:03:31 2004 -0700

    [PATCH] ne2k-pci.c compile fix on ppc[64]
    
    From: Rusty Russell <rusty@rustcorp.com.au>
    
    These macros are redefined here.  Previously definitions are in
    asm-ppc(64)/io.h

commit 64ea79c76c286ecdeffdf92a9c0f5bc812673d68
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 23:03:18 2004 -0700

    [PATCH] Add CC Trivial Patch Monkey to SubmittingPatches
    
    From: Rusty Russell <rusty@rustcorp.com.au>
    
    From: maximilian attems <janitor@sternwelten.at>
    
    Add the Monkey to SubmittingPatches.

commit 7275fb97a2b37cf2c146d73b07747b1ef4a65dd3
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 23:03:05 2004 -0700

    [PATCH] Use valid node number when unmapping x86 CPUs
    
    From: Rusty Russell <rusty@rustcorp.com.au>
    
    From:  colpatch@us.ibm.com
    
    The cpu_2_node[] array for i386 is initialized to all 0's, meaning that
    until modified at CPU bring-up, all CPUs are mapped to node 0.
    
    When CPUs are brought online, they are mapped to the appropriate node by
    various mechanisms, depending on the underlying hardware.
    
    When we unmap CPUs (hotplug time), we should return the mapping for the CPU
    that is going away to its original state, ie: 0.
    
    When this code was initially submitted, the misguided poster (me) made the
    mistake of putting a -1 in the cpu_2_node[] array for the CPU going away.
    
    This patch fixes this mistake, and allows code to get a valid node number
    for all valid CPU numbers.  This is important, because most (if not all)
    callers do not error check the value returned by the cpu_to_node() macro,
    and they should not have to.  The API specifies that a valid node number be
    returned for any valid CPU number.

commit 3a2d85eabe55ed976c74a4fc2c7dd079a0ba8bcc
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 23:02:53 2004 -0700

    [PATCH] Kill duplicate #include <linux_ioport.h>
    
    From: Rusty Russell <rusty@rustcorp.com.au>
    
    include/linux/device.h includes include/linux/ioport.h twice.

commit 17ec30a37eb34530738ce15ffe6c5057f22b5cd9
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 23:02:39 2004 -0700

    [PATCH] updating email info in CREDITS
    
    From: Rusty Russell <rusty@rustcorp.com.au>
    
    From:  Thomas Molina <tmolina@cablespeed.com>

commit e1319f38af229c25a1a9f849eb7cead940e9f69c
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 23:02:27 2004 -0700

    [PATCH] CONFIG_X86_GENERIC description fixup
    
    From: Rusty Russell <rusty@rustcorp.com.au>
    
    From:  Stewart Smith <stewart@linux.org.au>
    
    A better explanation of the X86_GENERIC config option follows.

commit f17ea0566ba38378df8e10a5f1f67cf1f6cc2c66
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 23:02:14 2004 -0700

    [PATCH] Fix genksyms parsing
    
    From: Rusty Russell <rusty@rustcorp.com.au>
    
    From: Andreas Schwab <schwab@suse.de> I'm getting a warning when building
    for ia64 with MODVERSIONS enabled.  This is a bug in genksyms, it can't
    cope with some arguments of __typeof__.
    
    The following patch will fix that.  Actually the argument of __typeof__ is
    an abstract declarator, but the genksyms parser has no production for that;
    decl_specifier_seq also matches some invalid constructs, but I don't think
    this is a problem in practice, since the compiler will reject them.

commit fa79e47badfbf9945c8062dd6174615abfda5a43
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 23:02:03 2004 -0700

    [PATCH] Trivial Patch Monkey should be in MAINTAINERS
    
    From: Rusty Russell <rusty@rustcorp.com.au>
    
    From:  Petri Koistinen <petri.koistinen@iki.fi>

commit f333f50d3f7a3a265b6beef4430f296323fa8cb7
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 23:01:49 2004 -0700

    [PATCH] Fix firmware loader docs
    
    From: Rusty Russell <rusty@rustcorp.com.au>
    
    From:  Pavel Machek <pavel@ucw.cz>
    
    sysfs should be mounted on /sys these days.

commit bc344a644424e15496f4411eefbbb52bfe9b6cd3
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 23:01:37 2004 -0700

    [PATCH] i386 irq.c ifdef cleanup
    
    From: Rusty Russell <rusty@rustcorp.com.au>
    
    From:  Josef 'Jeff' Sipek <jeffpc@optonline.net>
    
    I just noticed the nested ifdefs, and made it little more readable.

commit 387ec9eb40bdf724d6474aabd88fdd1b8f1fa568
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 23:01:24 2004 -0700

    [PATCH] fix sch_ingress help
    
    From: Rusty Russell <rusty@rustcorp.com.au>
    
    From:  John Levon <levon@movementarian.org>

commit bd9646e696ea35b3192f4bc22eabc6ec6863c8c3
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 23:01:13 2004 -0700

    [PATCH] SGML: close tag with ">"
    
    From: Rusty Russell <rusty@rustcorp.com.au>
    
    From:  Hans Ulrich Niedermann <linux-kernel@n-dimensional.de>
    
    doc patch: close tag with ">"

commit c02dc9a86f2222191e66f3f82ac50d47e5294b09
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 23:01:01 2004 -0700

    [PATCH] Consistently use quotes for SGML attributes
    
    From: Rusty Russell <rusty@rustcorp.com.au>
    
    From:  Hans Ulrich Niedermann <linux-kernel@n-dimensional.de>
    
    doc patch: Consistently use quotes for SGML attributes This makes it
    possible to process the SGML files without SHORTTAG YES.

commit 2b5f94088fd373eba0dba4077077965440c4457f
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 23:00:48 2004 -0700

    [PATCH] document unused pte bits on i386
    
    From: Rusty Russell <rusty@rustcorp.com.au>
    
    From:  Ed L Cashin <ecashin@uga.edu>
    
    This small patch documents that bits 9, 10, and 11 are unused by the Linux
    kernel.  The IA-32 Intel Architecture Software Developer's Manual says that
    these bits are available for programmer use.

commit b4ecf1b0b8faea29c3a479cafc163f1630ff9337
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 23:00:36 2004 -0700

    [PATCH] Update CodingStyle hints for Emacs users.
    
    From: Trivial Patch Monkey <trivial@rustcorp.com.au>
    
    From:  Ben Greear <greearb@candelatech.com>
    
    Depending on one's default emacs settings, the suggestion in the
    CodingStyle may or may not work.  This patch adds a few more commands to
    ensure it works in more cases.

commit 3bca5aa3e53f330d9f239503639b24308418bb2e
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 23:00:24 2004 -0700

    [PATCH] ver_linux fix
    
    From: Rusty Russell <rusty@rustcorp.com.au>
    
    From:  Adrian Bunk <bunk@fs.tum.de>
    
    Some versions of ps print non-version lines when ps --version is invoked.
    grep them out.

commit f951179269c98ac7b58dcfa3de2e68d4a0a3d680
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 23:00:10 2004 -0700

    [PATCH] Broken bitmap_parse for ncpus > 32
    
    From: Joe Korty <joe.korty@ccur.com>
    
    This patch replaces the call to bitmap_shift_right() in bitmap_parse() with
    bitmap_shift_left().
    
    I also prepended comments to the bitmap_shift_* functions defining what
    'left' and 'right' means.  This is under the theory that if I and all the
    reviewers were bamboozled, others in the future occasionally might be too.

commit 5362a3548872e1d7c7b3926f1519999b315e9825
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 22:59:58 2004 -0700

    [PATCH] Fix sys_time() to get subtick correction from the new xtime
    
    From: "La Monte H.P. Yarroll" <piggy@timesys.com>
    
    This is a Scott Wood patch against 2.6.3.
    
    
    Use gettimeofday() rather than xtime.tv_sec in sys_time(), since
    sys_stime() uses settimeofday() and thus subtracts the subtick correction
    from the new xtime.
    
    stime() used settimeofday(), but time() did not use gettimeofday().  Since
    settimeofday() subtracts out the current intra-tick correction, and nsec
    was 0 (since stime() only allows seconds), this resulted in xtime being
    slightly earlier than the time that was set.
    
    If time() had used gettimeofday(), the correction would have been applied,
    and everything would be fine.  However, instead time just reads the current
    xtime.tv_sec, so if time() is called immediately after stime(), you'll
    usually get a value one second earlier.

commit cea39746deca7ce8b10f21e4a4b3e96c33381e2e
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 22:59:45 2004 -0700

    [PATCH] add file_operations.fcntl
    
    From: Chuck Lever <cel@citi.umich.edu>
    
    O_DIRECT|O_APPEND cannot possibly work on NFS, so NFS needs some way of
    preventing the user from setting this combination.  We felt that the best
    way of implementing this restriction is to allow the filesytem to implement
    its own fcntl() handler.
    
    This patch does, that, and provide the appropriate handler for NFS.
    
    Additional details from Chuck:
    
    Forgetting O_DIRECT for a moment, O_APPEND writes on NFS don't work in any
    case when multiple clients are writing to a file, since an NFS client can
    never guarantee it knows where the true end of file is 100% of the time.
    it works as expected iff only one client writes to an O_APPEND file at a
    time.
    
    Multi-client O_APPEND writing doesn't seem to be a problem for any
    application I'm aware of.  Since it can be made to behave in the
    multi-client case with careful application logic or by using file locking,
    I don't think we should disallow it.
    
    I want to drop the inode semaphore when doing NFS direct I/O because it is
    synchronous; holding the i_sem means we reduce direct I/O concurrency to
    one I/O per file at a time.  the important thing sct was worried about was
    the case where a single client is writing with O_APPEND and O_DIRECT, and
    we don't hold the i_sem during the write.
    
    We must at least hold the i_sem when determining where the end of file is
    to do the O_APPEND write.  In 2.6, I believe that is handled correctly in
    the VFS layer, so this is not an issue for 2.6, right?

commit 3f66b056e1b56427eec0b26e0a20ac08fb8a6dc9
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 22:59:32 2004 -0700

    [PATCH] pmdisk: fix strcmp in sysfs store
    
    From: Herbert Xu <herbert@gondor.apana.org.au>
    
    This patch fixes the sysfs store functions for pmdisk when the input
    contains a trailing newline.

commit 77abb2f0af010c753dd1fea4b4594da802551a98
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 22:59:18 2004 -0700

    [PATCH] sb_mixer bounds checking
    
    From: Muli Ben-Yehuda <mulix@mulix.org>
    
    This patch add proper bounds checking to the sb_mixer.c code, found by the
    stanford checker[0].  It fixes bugzilla bugs 252[1], 253[2] and 254[3].
    Patch is against 2.6.5-rc2.  It was tested by Rene Herman on SN AWE64 gold
    and sound still works.  The issue was previously discussed on lkml[4], but
    apparently no fix was applied.
    
    The patch is a bit more intrusive than I would've liked, but I don't think
    it can be helped without really intrusive changes.  sb_devc has a pointer
    to an array (iomap) that is set at run time to point to arrays of variable
    sizes.  The patch adds an 'iomap_sz' member to sb_devc that is set to the
    length of the array, and does bounds checking in sb_common_mixer_set() and
    smw_mixer_set() agains that.

commit 59b46ce5bc9f2f2b704e905d39dfd4507f59c450
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 22:59:06 2004 -0700

    [PATCH] fs/proc/proc_tty.c comment fixes
    
    From: Marc-Christian Petersen <m.c.p@wolk-project.de>

commit 07ebe427f0289a322c96c38906bb3bb7aacf15b6
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 22:58:52 2004 -0700

    [PATCH] set mod->waiter before calling stop_machine
    
    From: Rusty Russell <rusty@rustcorp.com.au>
    
    mod->waiter needs to be set before we try to stop the module: setting it in
    __try_stop_module means it gets set to the kthread, not rmmod.

commit b9e55f3d300af426885d7b0a13e45cd2841118a2
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 22:58:40 2004 -0700

    [PATCH] slab: updates for per-arch alignments
    
    From: Manfred Spraul <manfred@colorfullife.com>
    
    Description:
    
    Right now kmem_cache_create automatically decides about the alignment of
    allocated objects. The automatic decisions are sometimes wrong:
    
    - for some objects, it's better to keep them as small as possible to
      reduce the memory usage.  Ingo already added a parameter to
      kmem_cache_create for the sigqueue cache, but it wasn't implemented.
    
    - for s390, normal kmalloc must be 8-byte aligned.  With debugging
      enabled, the default allocation was 4-bytes.  This means that s390 cannot
      enable slab debugging.
    
    - arm26 needs 1 kB aligned objects.  Previously this was impossible to
      generate, therefore arm has its own allocator in
      arm26/machine/small_page.c
    
    - most objects should be cache line aligned, to avoid false sharing.  But
      the cache line size was set at compile time, often to 128 bytes for
      generic kernels.  This wastes memory.  The new code uses the runtime
      determined cache line size instead.
    
    - some caches want an explicit alignment.  One example are the pte_chain
      objects: they must find the start of the object with addr&mask.  Right
      now pte_chain objects are scaled to the cache line size, because that was
      the only alignment that could be generated reliably.
    
    The implementation reuses the "offset" parameter of kmem_cache_create and
    now uses it to pass in the requested alignment.  offset was ignored by the
    current implementation, and the only user I found is sigqueue, which
    intended to set the alignment.
    
    In the long run, it might be interesting for the main tree: due to the 128
    byte alignment, only 7 inodes fit into one page, with 64-byte alignment, 9
    inodes - 20% memory recovered for Athlon systems.
    
    
    
    For generic kernels  running on P6 cpus (i.e. 32 byte cachelines), it means
    
    Number of objects per page:
    
     ext2_inode_cache: 8 instead of 7
     ext3_inode_cache: 8 instead of 7
     fat_inode_cache: 9 instead of 7
     rpc_tasks: 24 instead of 15
     tcp_tw_bucket: 40 instead of 30
     arp_cache: 40 instead of 30
     nfs_write_data: 9 instead of 7

commit 1aa6c0d1cbfcd0608a029a805952a2ecae0794da
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 22:58:26 2004 -0700

    [PATCH] Fix scripts/kernel-doc to handle __attribute__
    
    From: Tom Rini <trini@kernel.crashing.org>
    
    The following patch is needed so that kernel-doc can handle functions which
    have __attribute__'s on them (such as __attribute__ ((weak))).

commit fb14ef35baa4128d8ead9729678a251c5ea50559
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 22:58:16 2004 -0700

    [PATCH] readv/writev range checking fix
    
    do-readv_writev() is trying to fail if
    
    a) any of the segments have a length < 0 or
    
    b) the sum of the segments wraps negative.
    
    But it gets b) wrong because local variable tot_len is unsigned.
    
    Fix that up.

commit b1ee3feafbe4f538ce4d65412d6bc9e83a96ee80
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 22:58:02 2004 -0700

    [PATCH] jbd: fix I/O error handling
    
    Fix a few buglets spotted by Jeff Mahoney <jeffm@suse.com>.  We're currently
    only checking for I/O errors against journal buffers if they were locked when
    they were first inspected.
    
    We need to check buffer_uptodate() even if the buffers were already unlocked.

commit 2b38960cbf6a500bb8d2d8afd7e0cd546c72efe6
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 22:57:51 2004 -0700

    [PATCH] JBD: ordered-data commit cleanup
    
    For data=ordered, kjournald at commit time has to write out and wait upon a
    long list of buffers.  It does this in a rather awkward way with a single
    list.  it causes complexity and long lock hold times, and makes the addition
    of rescheduling points quite hard
    
    So what we do instead (based on Chris Mason's suggestion) is to add a new
    buffer list (t_locked_list) to the journal.  It contains buffers which have
    been placed under I/O.
    
    So as we walk the t_sync_datalist list we move buffers over to t_locked_list
    as they are written out.
    
    When t_sync_datalist is empty we may then walk t_locked_list waiting for the
    I/O to complete.
    
    As a side-effect this means that we can remove the nasty synchronous wait in
    journal_dirty_data which is there to avoid the kjournald livelock which would
    otherwise occur when someone is continuously dirtying a buffer.

commit 376fd482d39e4f51685cd9d33b099e9cfc3b21e3
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 22:57:38 2004 -0700

    [PATCH] jbd: fix ordered-data writeout logic
    
    There's some nasty code in commit which deals with a lock ranking problem.
    Currently if it fails to get the lock when and local variable `bufs' is zero
    we forget to write out some ordered-data buffers.  So a subsequent
    crash+recovery could yield stale data in existing files.
    
    Fix it by correctly restarting the t_sync_datalist search.

commit 7176142ac11b365db1d118412849cbf0a29a02a5
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 22:57:26 2004 -0700

    [PATCH] speed up ext2 fsync() and fdatasync()
    
    ext2_sync_file() forgets to clear the inode's dirty bits, so we write the
    inode on every fsync(), even if it hasn't changed.
    
    Fix that up via the new sync_file() API which correctly manages the inode
    state bits and the superblock inode lists.
    
    When performing file overwrite on IDE with and without writeback caching
    enabled this patch approximately doubles fsync() speed, bringing it into line
    with O_SYNC writes.
    
    Also, fix up the return value handling in ext2_sync_file().
    
    Credit due to Jeffrey Siegal <jbs@quiotix.com> who noticed the performance
    discrepancy and wrote a test app.

commit a1ff5989c622e78d2266237396545876359f5edf
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 22:57:12 2004 -0700

    [PATCH] ext3 fsync() and fdatasync() speedup
    
    ext3's fsync/fdatasync implementation is currently syncing the inode via a
    full journal commit even if it was unaltered.
    
    Fix that up by exporting the core VFS's inode sync function to modules and
    calling it if the inode is dirty.  We need to do it this way so that the
    inode is moved to the appropriate superblock list and so that the i_state
    dirty flags are appropriately updated.
    
    This speeds up ext3 fsync() for file overwrites by a factor of four (disk
    non-writeback) to forty (disk in writeback mode).

commit af70f7673155616ffd004d551e1b612002a58bf0
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 22:56:59 2004 -0700

    [PATCH] Fix page allocator lower zone protection for NUMA
    
    From: Martin Hicks <mort@wildopensource.com>
    
    This changes __alloc_pages() so it uses precalculated values for the "min".
    This should prevent the problem of min incrementing from zone to zone across
    many nodes on a NUMA machine.  The result of falling back to other nodes with
    the old incremental min calculations was that the min value became very
    large.

commit 7860b37198b0650f51bfafebac820386b552a071
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 22:56:46 2004 -0700

    [PATCH] move job control fields from task_struct to signal_struct
    
    From: Roland McGrath <roland@redhat.com>
    
    This patch moves all the fields relating to job control from task_struct to
    signal_struct, so that all this info is properly per-process rather than
    being per-thread.

commit 0ab2d6681c4e8502990523d46d928f37b764d52d
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 22:56:34 2004 -0700

    [PATCH] IPMI driver updates
    
    From: Corey Minyard <minyard@acm.org>
    
    - Add support for messaging through an IPMI LAN interface, which is
      required for some system software that already exists on other IPMI
      drivers.  It also does some renaming and a lot of little cleanups.
    
    - Add the "System Interface" driver.  The previous driver for system
      interfaces only supported the KCS interface, this driver supports all
      system interfaces defined in the IPMI standard.  It also does a much better
      job of handling ACPI and SMBIOS tables for detecting IPMI system
      interfaces.

commit 87c22e8470366e81aa82bcbadaf147c4ecdfb182
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 22:55:45 2004 -0700

    [PATCH] compat emulation for posix message queues
    
    From: Arnd Bergmann <arnd@arndb.de>
    
    I have tested the code with the open posix test suite and found the same
    four failures for both 64-bit and compat mode, most tests pass.  The patch
    is against -mc1, but I guess it also applies to the other trees around.
    
    What worries me more than mq_attr compatibility is the conversion of struct
    sigevent, which might turn out really hard when more fields in there are
    used.  AFAICS, the only other part in the kernel ABI is sys_timer_create(),
    so maybe it's not too late to deprecate the current structure and create a
    structure that can be used properly for compat syscalls.

commit 34b98f223bb21673f4cab2f5079a763c34a67946
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 22:55:32 2004 -0700

    [PATCH] posix message queues: send notifications via netlink
    
    From: Manfred Spraul <manfred@colorfullife.com>
    
    SIGEV_THREAD means that a given callback should be called in the context on a
    new thread.  This must be done by the C library.  The kernel must deliver a
    notice of the event to the C library when the callback should be called.
    
    This patch switches to a new, simpler interface: User space creates a socket
    with socket(PF_NETLINK, SOCK_RAW,0) and passes the fd to the mq_notify call
    together with a cookie.  When the mq_notify() condition is satisfied, the
    kernel "writes" the cookie to the socket.  User space then reads the cookie
    and calls the appropriate callback.

commit ed6dcf4a49c1098e0701762f6cc52b194cb7f661
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 22:55:19 2004 -0700

    [PATCH] split netlink_unicast
    
    From: Manfred Spraul <manfred@colorfullife.com>
    
    The attached patch splits netlink_unicast into three steps:
    
    - netlink_getsock{bypid,byfilp}: lookup the destination socket.
    
    - netlink_attachskb: perform the nonblock checks, sleep if the socket
      queue is longer than the limit, etc.
    
    - netlink_sendskb: actually send the skb.
    
    jamal looked over it and didn't see a problem with the netlink change.  The
    actual use from ipc/mqueue.c is still open (just send back whatever the C
    library passed to mq_notify, add an nlmsghdr or perhaps even make it a
    specialized netlink protocol), but the attached patch is independant from
    the the message queue change.
    
    (acked by davem)

commit b06d7b4c9bc34dd377d54acb7c9beae36d5f745c
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 22:55:07 2004 -0700

    [PATCH] security bugfix for mqueue
    
    From: Manfred Spraul <manfred@colorfullife.com>
    
    I found a security bug in the new mqueue code: a process that has only
    write permissions to a message queue could call mq_notify(SIGEV_THREAD) and
    use the returned notification file descriptor to read from the message
    queue.

commit f3ca8d5dd5c23594bda07893ae374bed7981d473
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 22:54:54 2004 -0700

    [PATCH] posix message queue update
    
    From: Manfred Spraul <manfred@colorfullife.com>
    
    My discussion with Ulrich had one result:
    
    - mq_setattr can accept implementation defined flags.  Right now we have
      none, but we might add some later (e.g.  switch to CLOCK_MONOTONIC for
      mq_timed{send,receive} or something similar).  When we add flags, we
      might need the fields for additional information.  And they don't hurt.
      Therefore add four __reserved fields to mq_attr.
    
    - fail mq_setattr if we get unknown flags - otherwise glibc can't detect
      if it's running on a future kernel that supports new features.
    
    - use memset to initialize the mq_attr structure - theoretically we could
      leak kernel memory.
    
    - Only set O_NONBLOCK in mq_attr, explicitely clear O_RDWR & friends.
      openposix uses getattr, attr |=O_NONBLOCK, setattr - a sane approach.
      Without clearing O_RDWR, this fails.
    
    I've retested all openposix conformance tests with the new patch - the two
    new FAILED tests check undefined behavior.  Note that I won't have net
    access until Sunday - if the message queue patch breaks something important
    either ask Krzysztof or drop it.
    
    Ulrich had another good idea for SIGEV_THREAD, but I must think about it.
    It would mean less complexitiy in glibc, but more code in the kernel.  I'm
    not yet convinced that it's overall better.

commit b95db64258b96d862b2d24ba825b98ac05f9c2fd
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 22:54:42 2004 -0700

    [PATCH] posix message queues: made user mountable
    
    From: Manfred Spraul <manfred@colorfullife.com>
    
    Make the posix message queue mountable by the user.  This replaces ipcs and
    ipcrm for posix message queue: The admin can check which queues exist with ls
    and remove stale queues with rm.
    
    I'd like a final confirmation from Ulrich that our SIGEV_THREAD approach is
    the right thing(tm): He's aware of the design and didn't object, but I think
    he hasn't seen the final API yet.

commit 0301b50bb63dd4149019b1fdb5fc7b168c6c12f7
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 22:54:29 2004 -0700

    [PATCH] posix message queues: linux-specific poll extension
    
    From: Manfred Spraul <manfred@colorfullife.com>
    
    Linux specific extension: make the message queue identifiers pollable.  It's
    simple and could be useful.

commit be94d44e818a56406016111fc48a1084b9f8e435
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 22:54:16 2004 -0700

    [PATCH] posix message queues: implementation
    
    From: Manfred Spraul <manfred@colorfullife.com>
    
    Actual implementation of the posix message queues, written by Krzysztof
    Benedyczak and Michal Wronski.  The complete implementation is dependant on
    CONFIG_POSIX_MQUEUE.
    
    It passed the openposix test suite with two exceptions: one mq_unlink test
    was bad and tested undefined behavior.  And Linux succeeds
    mq_close(open(,,,)).  The spec mandates EBADF, but we have decided to ignore
    that: we would have to add a new syscall just for the right error code.
    
    The patch intentionally doesn't use all helpers from fs/libfs for kernel-only
    filesystems: step 5 allows user space mounts of the file system.
    
    
    
    Signal changes:
    
    The patch redefines SI_MESGQ using __SI_CODE: The generic Linux ABI uses
    a negative value (i.e.  from user) for SI_MESGQ, but the kernel internal
    value must be posive to pass check_kill_value.  Additionally, the patch
    adds support into copy_siginfo_to_user to copy the "new" signal type to
    user space.
    
    
    
    Changes in signal code caused by POSIX message queues patch:
    
    General & rationale:
    
      mqueues generated signals (only upon notification) must have si_code
      == SI_MESGQ.  In fact such a signal is send from one process which
      caused notification (== sent message to empty message queue) to
      another which requested it.  Both processes can be of course unrelated
      in terms of uids/euids.  So SI_MESGQ signals must be classified as
      SI_FROMKERNEL to pass check_kill_permissions (not need to say that
      this signals ARE from kernel).
    
      Signals generated by message queues notification need the same
      fields in siginfo struct's union _sifields as POSIX.1b signals and we
      can reuse its union entry.
    
      SI_MESGQ was previously defined to -3 in kernel and also in glibc.
      So in userspace SI_MESGQ must be still visible as -3.
    
    Solution:
    
      SI_MESGQ is defined in the same style as SI_TIMER using __SI_CODE macro.
    
      Details:
    
        Fortunately copy_siginfo_to_user copies si_code as short.  So we
        can use remaining part of int value freely.  __SI_CODE does the
        work.  SI_MESGQ is in kernel:
    
     		6<<16 | (-3 & 0xffff) what is > 0
    
        but to userspace is copied
    
     		(short) SI_MESGQ == -3
    
    Actual changes:
    
      Changes in include/asm-generic/siginfo.h
    
      __SI_MESGQ added in signal.h to represent inside-kernel prefix of
      SI_MESGQ.  SI_MESGQ is redefined from -3 to __SI_CODE(__SI_MESGQ, -3)
    
      Except mips architecture those changes should be arch independent
      (asm-generic/siginfo.h is included in arch versions).  On mips
      SI_MESGQ is redefined to -4 in order to be compatible with IRIX.  But
      the same schema can be used.
    
      Change in copy_siginfo_to_user: We only add one line to order the
      same copy semantics as for _SI_RT.
    
      This change isn't very portable - some arch have its own
      copy_siginfo_to_user.  All those should have similar change (but
      possibly not one-line as _SI_RT case was sometimes ignored because i
      wasn't used yet, e.g.  see ia64 signal.c).
    
    Update:
    mq: only fail with invalid timespec if mq_timed{send,receive} needs to block
    From: Jakub Jelinek <jakub@redhat.com>
    
    POSIX requires EINVAL to be set if:
    "The process or thread would have blocked, and the abs_timeout parameter
    specified a nanoseconds field value less than zero or greater than or equal
    to 1000 million."
    but 2.6.5-mm3 returns -EINVAL even if the process or thread would not block
    (if the queue is not empty for timedreceive or not full for timedsend).

commit c50142a5433ed504fff2b1af152f8f7628830dfb
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 22:54:03 2004 -0700

    [PATCH] posix message queues: syscall stubs
    
    From: Manfred Spraul <manfred@colorfullife.com>
    
    Add -ENOSYS stubs for the posix message queue syscalls.  The API is a direct
    mapping of the api from the unix spec, with two exceptions:
    
    - mq_close() doesn't exist.  Message queue file descriptors can be closed
      with close().
    
    - mq_notify(SIGEV_THREAD) cannot be implemented in the kernel.  The kernel
      returns a pollable file descriptor .  User space must poll (or read) this
      descriptor and call the notifier function if the file descriptor is
      signaled.

commit c334f752d8e9d3847d4459d06f7544dea9a49923
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 22:53:50 2004 -0700

    [PATCH] posix message queues: code move
    
    From: Manfred Spraul <manfred@colorfullife.com>
    
    cleanup of sysv ipc as a preparation for posix message queues:
    
    - replace !CONFIG_SYSVIPC wrappers for copy_semundo and exit_sem with
      static inline wrappers.  Now the whole ipc/util.c file is only used if
      CONFIG_SYSVIPC is set, use makefile magic instead of #ifdef.
    
    - remove the prototypes for copy_semundo and exit_sem from kernel/fork.c
    
    - they belong into a header file.
    
    - create a new msgutil.c with the helper functions for message queues.
    
    - cleanup the helper functions: run Lindent, add __user tags.

commit 00d1b0e9990815e31be7e502801f3a421fcccafa
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 22:53:36 2004 -0700

    [PATCH] md: merge_bvec_fn needs to know about partitions.
    
    From: Neil Brown <neilb@cse.unsw.edu.au>
    
    Addresses http://bugme.osdl.org/show_bug.cgi?id=2355
    
    It seems that a merge_bvec_fn needs to be aware of partitioning...  who
    would have thought it :-(
    
    The following patch should fix the merge_bvec_fn for both linear and raid0.
    We teach linear and raid0 about partitions in the merge_bvec_fn.
    
    ->merge_bvec_fn needs to make decisions based on the physical geometry of the
    device.  For raid0, it needs to decide if adding the bvec to the bio will
    make the bio span two drives.
    
    To do this, it needs to know where the request is (what the sector number is)
    in the whole device.
    
    However when called from bio_add_page, bi_sector is the sector number
    relative to the current partition, as generic_make_request hasn't been called
    yet.
    
    So raid_mergeable_bvec needs to map bio->bi_sector (which is partition
    relative) to a bi_sector which is device relative, so it can perform proper
    calculations about when chunk boundaries are.

commit 9abdc6608d7c5e3cb09c05bd6c726d04dc59ace4
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 22:53:24 2004 -0700

    [PATCH] knfsd: Add data integrity to serve rside gss
    
    From: NeilBrown <neilb@cse.unsw.edu.au>
    
    From: "J. Bruce Fields" <bfields@fieldses.org>
    
    rpcsec_gss supports three security levels:
    
    1.  authentication only: sign the header of each rpc request and response.
    
    2. integrity: sign the header and body of each rpc request and response.
    
    3.  privacy: sign the header and encrypt the body of each rpc request and
       response.
    
    The first 2 are already supported on the client; this adds integrity support
    on the server.

commit 238a06e203a96960843faec4ec8f553f453082b9
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 22:53:09 2004 -0700

    [PATCH] knfsd: Export a symbol needed by auth_gss
    
    From: NeilBrown <neilb@cse.unsw.edu.au>
    
    From: "J. Bruce Fields" <bfields@fieldses.org>
    
    Without this compiling auth_gss as module fails.

commit 1a260c78830bfaeafcde9509e4c5f874e9ad6ab8
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 22:52:57 2004 -0700

    [PATCH] knfsd: Improve UTF8 checking.
    
    From: NeilBrown <neilb@cse.unsw.edu.au>
    
    From: Fred.  We don't do all the utf8 checking we could in the kernel, but we
    do some simple checks.  Implement slightly stricter, and probably more
    efficient, checking.

commit c02c0886973521cd77904d8f07aa98d99c63cb3b
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 22:52:44 2004 -0700

    [PATCH] knfsd: Add server-side support for the nfsv4 mounted_on_fileid attribute.
    
    From: NeilBrown <neilb@cse.unsw.edu.au>

commit 94b1c3ebf78bd58c2f45b78f2c24c7c939c34a9e
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 22:52:32 2004 -0700

    [PATCH] knfsd: Remove name_lookup.h that noone is using anymore.
    
    From: NeilBrown <neilb@cse.unsw.edu.au>

commit 5b2b9a8100c1125f075a824aebba06ffb5a4c2c2
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 22:52:19 2004 -0700

    [PATCH] knfsd: fix a problem with incorrectly formatted auth_error returns.
    
    From: NeilBrown <neilb@cse.unsw.edu.au>
    
    From: Fred Isaman

commit d4658c7462be125476fa860477535c550f160e59
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 22:52:07 2004 -0700

    [PATCH] knfsd: Minor fix to error return when updating server authentication information
    
    From: NeilBrown <neilb@cse.unsw.edu.au>

commit 4f9c4e9d3cedd4dadb8aa94de3a467869e725a2e
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 22:51:53 2004 -0700

    [PATCH] knfsd: Return -EOPNOTSUPP when unknown mechanism name encountered
    
    From: NeilBrown <neilb@cse.unsw.edu.au>
    
    It's better than oopsing.

commit 8b770c1dc72baf52fe6a267bf19aa9ba1d2229a5
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 22:51:41 2004 -0700

    [PATCH] search for /init for initramfs boots
    
    From: Olaf Hering <olh@suse.de>
    
    initramfs can not be used in current 2.6 kernels, the files will never be
    executed because prepare_namespace doesn't care about them.  The only way to
    workaround that limitation is a root=0:0 cmdline option to force rootfs as
    root filesystem.  This will break further booting because rootfs is not the
    final root filesystem.
    
    This patch checks for the presence of /init which comes from the cpio archive
    (and thats the only way to store files into the rootfs).  This binary/script
    has to do all the work of prepare_namespace().

commit 27d2e5e51d0cd98243735c2cf0de0f8168d70807
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 22:51:28 2004 -0700

    [PATCH] fs/inode.c list_head cleanup
    
    Teach inode.c about list_move().

commit ed678f13aec6fdd86c952b05200f741aa473dba8
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 22:51:16 2004 -0700

    [PATCH] Quota locking fixes
    
    From: Jan Kara <jack@ucw.cz>
    
    Change locking rules in quota code to fix lock ordering especially wrt
    journal lock.  Also some unnecessary spinlocking is removed.  The locking
    changes are mainly: dqptr_sem, dqio_sem are acquired only when transaction is
    already started, dqonoff_sem before a transaction is started.  This change
    requires some callbacks to ext3 (also implemented in this patch) to start
    transaction before the locks are acquired.

commit a97de48b693b787fab0a47a1cf35de001ac50a6b
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 22:51:02 2004 -0700

    [PATCH] ppc44x: fix memory leak
    
    From: Matt Porter <mporter@kernel.crashing.org>
    
    This fixes a memory leak when freeing pgds on PPC44x.

commit 425c968789241f168b67fa3eaaf4fe50f9d0ca39
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 22:50:50 2004 -0700

    [PATCH] ppc64: UP compile fixes
    
    From: Anton Blanchard <anton@samba.org>
    
    UP compile fixes

commit acfc20f7d6adf612704b97528b8bb465637ba6f2
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 22:50:37 2004 -0700

    [PATCH] ppc64: Quieten NVRAM driver
    
    From: Anton Blanchard <anton@samba.org>
    
    Quieten NVRAM driver

commit ec19a28db34aeb29720c658e5ebf4e60ccee4f6d
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 22:50:24 2004 -0700

    [PATCH] ppc64: Remove unused rtas functions
    
    From: Joel Schopp <jschopp@austin.ibm.com>
    
    I was looking at rtas serialization for reasons I won't go into here.
    While wandering through the code I found that two functions were not
    properly serialized.  phys_call_rtas and phys_call_rtas_display_status are
    the functions.  After looking further they are redundant and not
    used anywhere at all.

commit 9ed9e7e5eb0ab64f58ef41e36779cb96abc17076
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 22:50:11 2004 -0700

    [PATCH] ppc64: DMA API updates
    
    From: Anton Blanchard <anton@samba.org>
    
    DMA API updates, in particular adding the new cache flush interfaces.

commit b7ceb1452399ef59ab14868337d2d74a9b5c4c8d
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 22:49:59 2004 -0700

    [PATCH] ppc64: Add smt_snooze_delay cpu sysfs attribute
    
    From: Anton Blanchard <anton@samba.org>
    
    Add smt_snooze_delay cpu sysfs attribute

commit c3a85f1fb88cfa30ab4af65348eaf4290233cac8
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 22:49:46 2004 -0700

    [PATCH] ppc64: Oops cleanup
    
    From: Anton Blanchard <anton@samba.org>
    
    Oops cleanup:
    
    - Move prototypes into system.h
    - Move the debugger hooks into die, all the calls sites were calling them.
    - Handle bad values passed to prregs

commit fbe3e9b6ef357ffbb02b9976ae3b6181c12344ed
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 22:49:34 2004 -0700

    [PATCH] ppc64: add platform identification to oops messages
    
    From: Anton Blanchard <anton@samba.org>

commit 53e8cdeb3bd9eea4ccd67de4a3b5b479680ca063
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 22:49:21 2004 -0700

    [PATCH] ppc64: replace vio_dma_mapping_error with dma_mapping_error everywhere.
    
    From: Stephen Rothwell <sfr@canb.auug.org.au>
    
    James Bottomley is right, this was a mistake.  This patch replaces
    vio_dma_mapping_error with dma_mapping_error everywhere.

commit 8277a1fa5618d97660e8c1de25ce712fa8ae750a
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 22:49:07 2004 -0700

    [PATCH] ppc64: change the iSeries virtual device drivers to use the vio infrastructure for DMA mapping
    
    From: Stephen Rothwell <sfr@canb.auug.org.au>
    
    This patch changes the iSeries virtual device drivers to use the
    vio infrastructure for DMA mapping instead of the PCI infrastructure.
    This is a step along the way to integrating them correctly into the
    driver model.

commit e1df56ff96e6b7be4a651dad58ba38cda5f0d8b3
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 22:48:54 2004 -0700

    [PATCH] ppc64: Consolidate some of the iommu DMA mapping routines.
    
    From: Stephen Rothwell <sfr@canb.auug.org.au>
    
    This patch consolidates some of the iommu DMA mapping routines.

commit 9b678c1e2247e6dddf4bf245554bd3c099e456ab
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 22:48:41 2004 -0700

    [PATCH] ppc64: Use enum dma_data_direction for all APIs
    
    From: Stephen Rothwell <sfr@canb.auug.org.au>
    
    This is just a cleanup to use enum dma_data_direction for all APIs
    except the pci_dma_ ones (since they are defined generically).
    
    Also make most of the functions in arch/ppc64/kernel/pci_iommu.c
    static.

commit f4421b9c28e02a7260d6896b25fc4ac4f158baf0
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 22:48:25 2004 -0700

    [PATCH] ppc64: Use enum dma_data_direction for the vio DMA api routines.
    
    From: Stephen Rothwell <sfr@canb.auug.org.au>
    
    This patch uses enum dma_data_direction for the vio DMA api routines.
    This allows us to remove some include of linux/pci.h.
    
    Also missed some pci_dma_mapping_error uses.

commit 61d5b6893098c1be04e2f385e0167266c8db4f2d
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 22:48:13 2004 -0700

    [PATCH] ppc64: Register secondary threads in NUMA init code
    
    From: Anton Blanchard <anton@samba.org>
    
    Register secondary threads in NUMA init code

commit 36af1eb0b185770824acedf4840b30024531a0ed
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 22:47:59 2004 -0700

    [PATCH] ppc64: Add HW PMC support to oprofile
    
    From: Anton Blanchard <anton@samba.org>
    
    Add HW PMC support to oprofile

commit 12c9ae0de28d9fef2766c4ae5a1f01b7ab6aca20
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 22:47:39 2004 -0700

    [PATCH] ppc64: Add PMCs to sysfs
    
    From: Anton Blanchard <anton@samba.org>
    
    Add PMCs to sysfs.

commit c1a86d3b4fb53cd954a18edb6157b58584209c8b
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 22:47:25 2004 -0700

    [PATCH] ppc64: Add some POWER5 specific optimisations
    
    From: Anton Blanchard <anton@samba.org>
    
    Add some POWER5 specific optimisations:
    - icache is coherent, no need to explicitly flush
    - tlbie lock no longer required

commit 01007b4e6fd7c056565b201f68b00bd011b6e6ce
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 22:47:13 2004 -0700

    [PATCH] ppc64: Move sysfs specific stuff into sysfs.c
    
    From: Anton Blanchard <anton@samba.org>
    
    Move sysfs specific stuff into sysfs.c

commit 0e75cd7813f82e49975d3ba8a1bf6113aa497547
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 22:46:59 2004 -0700

    [PATCH] ppc64: Update CPU features
    
    From: Anton Blanchard <anton@samba.org>
    
    Update CPU features. Remove DABR feature, all cpus have it. Add MMCRA,
    PMC8, SMT, COHERENT_ICACHE, LOCKLESS_TLBIE features

commit 0a8d8fbcc525cc2a12fef8202618423bc290ee0d
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 22:46:47 2004 -0700

    [PATCH] ppc64: Put SMT threads into global interrupt queue
    
    From: David Engebretsen <engebret@us.ibm.com>
    
    Put SMT threads into global interrupt queue

commit 0b29d5e7e86cb4f99afa10fe6f43f3972fcf4b76
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 22:46:34 2004 -0700

    [PATCH] ppc64: Create xics get_irq_server
    
    From: Anton Blanchard <anton@samba.org>
    
    Create xics get_irq_server and use it in enable/disable code.

commit b902751692396b28b9dc5b9c7266bfc32090f333
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 22:46:22 2004 -0700

    [PATCH] ppc64: irq cleanups
    
    From: Paul Mackerras <paulus@samba.org>
    
    Create and use irq_offset_up/down, get_irq_desc, for_each_irq

commit 23f217fa3d35901ed10acf533045a9c08d98c3a0
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 22:46:07 2004 -0700

    [PATCH] ppc64: Fix xics irq affinity bug
    
    From: Anton Blanchard <anton@samba.org>
    
    Fix xics irq affinity bug. We were anding with cpu_online_map but werent
    using the result later on.

commit 69bc70b9552bcf74b35053ba91bc4c909522dcf0
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 22:45:56 2004 -0700

    [PATCH] ppc64: Add RTAS os-term call for panic on pSeries
    
    From: Michael Strosaker <strosake@us.ibm.com>
    
    Add RTAS os-term call for panic on pSeries

commit 15cddddb837495b9b6441ae201d3be66e897614e
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 22:45:43 2004 -0700

    [PATCH] ppc64: Add support for hotplug cpus
    
    From: Joel Schopp <jschopp@austin.ibm.com>
    
    Add support for hotplug cpus

commit eabf4910ec4465cf192cd2d5c025fbd9c6acb0c4
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 22:45:31 2004 -0700

    [PATCH] ppc64: Additional PVR value for power5 processor
    
    From: Will Schmidt <willschm@us.ibm.com>
    
    Additional PVR value for power5 processor

commit d90fba56a0efa35e28fe8a96bc659d09d7d2a068
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 22:45:17 2004 -0700

    [PATCH] ppc64: Misc rtasd fixes
    
    From: Jake Moilanen <moilanen@austin.ibm.com>
    
    Misc rtasd fixes for some broken firmware versions.

commit 18e0d8165490314299f87a29a9e70a4dc7c4ed07
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 22:45:05 2004 -0700

    [PATCH] ppc64: Fix xmon compile warning
    
    From: Joel Schopp <jschopp@austin.ibm.com>
    
    Fix includes to avoid the compiler warning:
    arch/ppc64/xmon/start.c: In function `xmon_readchar':
    arch/ppc64/xmon/start.c:104: warning: implicit declaration of function
    `xmon_printf'

commit 87fb698cd58394a5e1729a9ee56b4ada4fb0a51b
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 22:44:51 2004 -0700

    [PATCH] ppc64: Make rtasd dump KERN_DEBUG
    
    From: Jake Moilanen <moilanen@austin.ibm.com>
    
    Change the loglevel of an error log printed so it
    does not goto the console.  Since error logs can
    be upto 2k in size, it can spam the console.

commit e80bc2ce5fd11792993c43d02a6425cc0a2138b8
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 22:44:40 2004 -0700

    [PATCH] ppc64: Correct comments for the offsets of fields in paca
    
    From: Will Schmidt <willschm@us.ibm.com>
    
    Correct comments for the offsets of fields in paca

commit 565010b990a52fc1fd8d4a2caa0355e5946e6f80
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 22:44:27 2004 -0700

    [PATCH] ppc64: JS20 PHB devfn fix
    
    From: Jake Moilanen <moilanen@austin.ibm.com>
    
    The JS20 uses devfn 0 for a HT->PCI bridge.  The PHB devfn
    assumption does not hold for this case.

commit d9110d3abbe16e21ea3d16ed8f37f22354ca9d4e
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 22:44:15 2004 -0700

    [PATCH] ppc64: Allow PCI devices to use address that happens to fall in the ISA range
    
    From: Jake Moilanen <moilanen@austin.ibm.com>
    
    Allow PCI devices to use address that happens to fall in the ISA range,
    but still protect against ISA device accesses when there is not an ISA
    bus.

commit 285321964a0b7c076521a21924020fcab7523d71
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 22:44:02 2004 -0700

    [PATCH] ppc64: Disable SMT snooze by default
    
    From: Anton Blanchard <anton@samba.org>
    
    Disable SMT snooze by default

commit ac55528c8f71c31c809978943479a7ea79d83914
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 22:43:50 2004 -0700

    [PATCH] ppc64: Move EPOW log buffer to BSS
    
    From: Olof Johansson <olof@austin.ibm.com>
    
    RTAS on IBM pSeries runs in real mode, so all pointers being passed in to
    it need to be in low memory.  There's two places in the RAS code that
    passes in pointers to items on the stack, which might end up being above
    the limit.
    
    Below patch resolves this by creating a buffer in BSS + a lock for
    serialization.  There's no reason to worry about contention on the lock,
    since rtas_call() also serializes on a single spinlock and this is an
    infrequent code path in the first place.

commit 81c31b894ebb3d1409ffa3d54e477a91b5a5ebf3
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 22:43:37 2004 -0700

    [PATCH] ppc64: allow hugepages anywhere in low 4GB
    
    From: David Gibson <david@gibson.dropbear.id.au>
    
    On PPC64, to deal with the restrictions imposed by the PPC MMU's segment
    design, hugepages are only allowed to be mapping in two fixed address
    ranges, one 2-3G (for use by 32-bit processes) and one 1-1.5T (for use in
    64-bit processes).  This is quite limiting, particularly for 32-bit
    processes which want to use a lot of large page memory.
    
    This patch relaxes this restriction, and allows any of the low 16 segments
    (i.e.  those below 4G) to be individually switched over to allow hugepage
    mappings (provided the segment does not already have any normal page
    mappings).  The 1-1.5T fixed range for 64-bit processes remains.

commit 291780513431b41aa3c0302169d48863466998fc
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 22:43:24 2004 -0700

    [PATCH] PPC64: iSeries virtual ethernet driver
    
    From: Stephen Rothwell <sfr@canb.auug.org.au>
    
    This is the iSeries virtual ethernet driver.  David Gibson has taken you
    previous comments and hopefully sitisfied most of them.  The driver has
    also undergone some more testing which showed up some bugs which have been
    addressed.
    
    Unfortunately, Anton is about to submit some other patches of mine which
    will sightly comflict with this.  I will send a patch shortly that will
    (hopefully) fix that.

commit 2b62c4aceb1aaa6137f186d5a070343d07fbbab7
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 22:43:10 2004 -0700

    [PATCH] ppc64: export itLpNaca on iSeries
    
    From: Paul Mackerras <paulus@samba.org>
    
    This patch from Julie DeWandel exports the symbol itLpNaca on iSeries
    machines, for the use of the viodasd driver.

commit db9626cde8a96b75e7efb3057a02cbc509dd4294
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 22:42:58 2004 -0700

    [PATCH] disable VT on iSeries by default
    
    From: Paul Mackerras <paulus@samba.org>
    
    This patch from Julie DeWandel makes CONFIG_VT default to N on iSeries
    machines which are using the iSeries virtual console driver viocons.c.  The
    VT console and the viocons code can't coexist because they use the same tty
    numbers, that is, viocons supplies /dev/tty1.  Without this patch the user
    has to figure out somehow that s/he has to turn on CONFIG_EMBEDDED in order
    to be able to turn off CONFIG_VT, which is really very non-obvious.

commit 8ff9c6ef226bf718bc128f42d38d15e9d52e4aff
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 22:42:47 2004 -0700

    [PATCH] ppc64: Fix G5 build with DART (iommu) support
    
    From: Benjamin Herrenschmidt <benh@kernel.crashing.org>
    
    A recent patch that cleaned up some absolute/virt translation macros forgot
    one occurence, thus breaking g5 build with iommu support.

commit 728be84f48493cc13cdfcd36e3dab14c0ed1b002
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 22:42:35 2004 -0700

    [PATCH] ppc64: fix failure return codes from {pci,vio}_alloc_consistent()
    
    From: Olof Johansson <olof@austin.ibm.com>
    
    A bug snuck in during the rewrite of ppc64 IOMMU code.  When a
    {pci,vio}_alloc_consistent() call fails, DMA_ERROR_CODE is returned instead
    of NULL.

commit d0ebc08f1ae0e0ac5d4a38242dd9853b6fe84911
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 22:42:22 2004 -0700

    [PATCH] ppc64: hugepage bugfix
    
    From: David Gibson <david@gibson.dropbear.id.au>
    
    Found this again while looking at hugepage extensions.  Haven't actually had
    it bite yet - the race is small and the other bug will never be triggered in
    32-bit processes, and the function is rarely called on 64-bit processes.
    
    This patch fixes two bugs in the (same part of the) PPC64 hugepage code.
    First the method we were using to free stale PTE pages was not safe with some
    recent changes (race condition).  BenH has fixed this to work in the new way.
     Second, we were not checking for a valid PGD entry before dereferencing the
    PMD page when scanning for stale PTE page pointers.

commit b4e0dd09f6ee56aa1c25ca9dfb4e897f241a5b57
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 22:42:11 2004 -0700

    [PATCH] ppc64: Fix bug in hugepage support
    
    From: David Gibson <david@gibson.dropbear.id.au>
    
    The PPC64 version of is_aligned_hugepage_range() is buggy.  It is supposed to
    test not only that the given range is hugepage aligned, but that it lies
    within the address space allowed for hugepages.  We were checking only that
    the given range intersected the hugepage range, not that it lay entirely
    within it.  This patch fixes the problem and changes the name of some macros
    to make it less likely to make that misunderstanding again.

commit 5c57dda868330ebe9e8b149c3f8789db60f88255
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 22:41:57 2004 -0700

    [PATCH] ppc64: si_addr fix
    
    From: Benjamin Herrenschmidt <benh@kernel.crashing.org>
    
    This patch fixes si_addr on some segfaults in 64 bits mode, it used to be
    bogus (address not passed to do_page_fault by the asm code after a failure
    to set an SLB entry).

commit dbf5a5af5bdc773b6624bcb360c9bdf7f772a591
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 22:41:46 2004 -0700

    [PATCH] ppc32: Fix thinko in the altivec exception code
    
    From: Benjamin Herrenschmidt <benh@kernel.crashing.org>
    
    Without this patch, executing an altivec instruction on an altivec capable
    CPU with a kernel that do not have CONFIG_ALTIVEC set would result in a
    kernel crash.
    
    (Fix forward ported from 2.4 by John Whitney
    <jwhitney-linuxppc@sands-edge.com>)

commit 906648b4864649cd72317718ae25ce5b33b0b8c7
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 22:41:32 2004 -0700

    [PATCH] get_wchan() sparc64 fix
    
    From: William Lee Irwin III <wli@holomorphy.com>
    
    Now the scheduler text is in its own ELF section this branch is asking for
    an illegal displacement.

commit b283f09cf8f51c29bf90e42e22099f76d0f33378
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 22:41:20 2004 -0700

    [PATCH] Fix get_wchan() FIXME wrt. order of functions
    
    From: William Lee Irwin III <wli@holomorphy.com>
    
    This addresses the issue with get_wchan() that the various functions acting
    as scheduling-related primitives are not, in fact, contiguous in the text
    segment.  It creates an ELF section for scheduling primitives to be placed
    in, and places currently-detected (i.e.  skipped during stack decoding)
    scheduling primitives and others like io_schedule() and down(), which are
    currently missed by get_wchan() code, into this section also.
    
    The net effects are more reliability of get_wchan()'s results and the new
    ability, made use of by this code, to arbitrarily place scheduling
    primitives in the source code without disturbing get_wchan()'s accuracy.
    
    Suggestions by Arnd Bergmann and Matthew Wilcox regarding reducing the
    invasiveness of the patch were incorporated during prior rounds of review.
    I've at least tried to sweep all arches in this patch.

commit ee28db843649533f5650186251ae4a8bd49a3da9
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 22:41:07 2004 -0700

    [PATCH] i4l: kernelcapi receive workqueue and locking rework
    
    From: Armin Schindler <armin@melware.de>
    
    With this patch the ISDN kernel CAPI code uses a per application workqueue
    with proper locking to prevent message re-ordering due to the fact a
    workqueue may run on another CPU at the same time.  Also some locks for
    internal data is added.
    
    Removed global recv_queue work, use per application workqueue.  Added
    proper locking mechanisms for application, controller and application
    workqueue function.  Increased max.  number of possible applications and
    controllers.

commit efffe9c8536bf9ee28f2f381bd285824bedcdbcd
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 22:40:55 2004 -0700

    [PATCH] Fix VT open/close race
    
    The race is that con_close() can sleep, and drops the BKL while
    tty->count==1.  But another thread can come into init_dev() and will take a
    new ref against the tty and start using it.
    
    But con_close() doesn't notice that new ref and proceeds to null out
    tty->driver_data while someone else is using the resurrected tty.
    
    So the patch serialises con_close() against init_dev() with tty_sem.
    
    
    Here's a test app which reproduced the oops instantly on 2-way.  It realy
    needs to be run against all tty-capable devices.
    
    /*
     * Run this against a tty which nobody currently has open, such as /dev/tty9
     */
    
    #include <stdio.h>
    #include <stdlib.h>
    #include <unistd.h>
    #include <fcntl.h>
    #include <sys/ioctl.h>
    #include <linux/kd.h>
    
    void doit(char *filename)
    {
    	int fd,x;
    
    	fd = open(filename, O_RDWR);
    	if (fd < 0) {
    		perror("open");
    		exit(1);
    	}
    	ioctl(fd, KDKBDREP, &x);
    	close(fd);
    }
    
    main(int argc, char *argv[])
    {
    	char *filename = argv[1];
    
    	for ( ; ; )
    		doit(filename);
    }

commit ef00e3553796bb93c5fa573f926a6003e92b35b4
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 22:40:42 2004 -0700

    [PATCH] remove down_tty_sem()
    
    Remove the down_tty_sem() and up_tty_sem() and replace them with open-coded
    up() and down().  This is an equivalent transformation.
    
    I assume these functions were created to open the possibility of per-tty
    semaphores at some time in the future.  But the code which is protected by
    this lock deals with two tty's at the same time, and the next patch will need
    to release the lock after the tty has been destroyed.

commit c0719c5a128df01e2edf7ee722e7409f0addb094
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 22:40:30 2004 -0700

    [PATCH] con_open() speedup/cleanup
    
    con_open() is called on every open of the tty, even if the tty is already all
    set up.  We only need to do that initialisation if the tty is being set up
    for the very first time (tty->count == 1).
    
    So do that: check for tty_count == 1 inside console_sem() and if so, bypass
    all the unnecessary initialisation.
    
    
    
    Note that this patch reintroduces the con_close()-vs-init_dev() race+oops.
    This is because that oops is accidentally prevented because when it happens,
    con_open() reinstalls tty->driver_data even when tty->count > 1.
    
    But that's bogus, and when the race happens we end up running
    vcs_make_devfs() and vcs_remove_devfs() against the same console at the same
    time, producing indeterminate results.
    
    So the race needs to be fixed again, for real.

commit 49b8290a99887edd525f87707038f13049fba6b9
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 22:40:17 2004 -0700

    [PATCH] vt.c cleanup
    
    - Remove unneeded casts of a void *
    
    - whitespace consistency.

commit 0eb217f9b539fccf5aafaba8c9a06e170825f68b
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 22:40:05 2004 -0700

    [PATCH] generalise system_running
    
    From: Olof Johansson <olof@austin.ibm.com>
    
    It's currently a boolean, but that means that system_running goes to zero
    again when shutting down.  So we then use code (in the page allocator) which
    is only designed to be used during bootup - it is marked __init.
    
    So we need to be able to distinguish early boot state from late shutdown
    state.  Rename system_running to system_state and give it the three
    appropriate states.

commit 243c64b2cfea7e49e074c80db65fa7b90d765c6f
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 22:39:51 2004 -0700

    [PATCH] feed devfs through Lindent
    
    Nobody seems to have any outstanding work against devfs, so...

commit 77b92f5b13c7f025ad46dbbf3feccd85b2954feb
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 22:39:40 2004 -0700

    [PATCH] Fix URLs in Kconfig files
    
    From: Rusty Russell <rusty@rustcorp.com.au>
    
    From: "Petri T. Koistinen" <petri.koistinen@iki.fi>
    
    1) Various URLs in the Kconfig files are out of date: update them.
    
    2) URLs should be of form <http://url-goes-here>.
    
    3) References to files in the source should be of form
       <file:path-from-top>
    
    4) Email addresses should be of form <foo@bar.com>

commit 3dccf5d07f68e850b84daede79f3c8bc121f1546
Author: Andrew Morton <akpm@osdl.org>
Date:   Sun Apr 11 22:39:25 2004 -0700

    [PATCH] x86-64 update
    
    From: Andi Kleen <ak@muc.de>
    
    Current x86-64 patchkit for 2.6.5.
    
    - Add drivers/firmware/Kconfig
    
    - Clarify description of CONFIG_IOMMU_DEBUG
    
    - Use correct gcc option to optimize for Intel CPUs
    
    - Add EDD support (Matt Domsch)
    
    - Add workaround for broken IOMMU on VIA hardware.  Uses swiotlb there now.
    
    - Handle more than 8 local APICs (Suresh B Siddha)
    
    - Delete obsolete mtrr Makefile
    
    - Add x86_cache_alignment and set it up properly for P4 (128 bytes instead
      of 64bytes).  Also report in /proc/cpuinfo
    
    - Minor cleanup in in_gate_area
    
    - Make asm-generic/dma-mapping.h compile with !CONFIG_PCI Just stub out all
      functions in this case.  This is mainly to work around sysfs.
    
    - More !CONFIG_PCI compile fixes
    
    - Make u64 sector_t unconditional

commit b5c7a2ddc7612ba2b77cd11c6b0146d191f7c065
Author: Ivan Kokshaysky <ink@jurassic.park.msu.ru>
Date:   Sun Apr 11 21:19:20 2004 -0700

    [PATCH] Fix unaligned stxncpy again
    
    Herbert Xu noted:
      "The current stxncpy on alpha is still broken when it comes to single
       word, unaligned, src misalignment > dest misalignment copies.
    
       I've attached a program which demonstrates this problem."
    
    Ugh, indeed. It fails when there is a zero byte before the data.
    Thanks.
    
    Here is the fix for this (both regular and ev6 version).

commit 6264f96f9e15f7c4c6a1377e957d7c0f9174330f
Merge: 90aaef2... 297636f...
Author: David S. Miller <davem@nuts.davemloft.net>
Date:   Sun Apr 11 21:13:31 2004 -0700

    Merge http://linux-mh.bkbits.net/bluetooth-2.6
    into nuts.davemloft.net:/disk1/BK/net-2.6

commit d6a03f195ac2dcdec0416b2ae67b773c1d214217
Author: Russell King <rmk@flint.arm.linux.org.uk>
Date:   Sun Apr 11 21:08:55 2004 +0100

    [SERIAL] Add support for TI16C750 hardware flow control.

commit 46d322c90c2b2221872b5e88f458b06f6643caf2
Author: Russell King <rmk@flint.arm.linux.org.uk>
Date:   Sun Apr 11 16:44:24 2004 +0100

    [ARM] Fix spacing in arch/arm/boot/Makefile and arch/arm/mm/Kconfig.

commit 99d6df732eae67df97bb24d898a730ad252a41cf
Author: David S. Miller <davem@nuts.davemloft.net>
Date:   Sun Apr 11 03:39:07 2004 -0700

    [SPARC64]: Provide _mcount as well as mcount.

commit 297636fb9e05e68073d5802a6ab5d526c252002c
Author: Jon Oberheide <jon@focalhost.com>
Date:   Sun Apr 11 00:16:46 2004 -0700

    [CRYPTO]: ARC4 Kconfig clarification.

commit db52539e3b71369345f948826e9cacc562184809
Author: Jamal Hadi Salim <hadi@cyberus.ca>
Date:   Sun Apr 11 00:14:55 2004 -0700

    [NET_SCHED]: Check for NULL opt in dsmark_init.

commit b5395344dd8bd65d6cbe90610f9df96e97f01254
Author: David S. Miller <davem@nuts.davemloft.net>
Date:   Sun Apr 11 00:08:46 2004 -0700

    [SPARC64]: Control -fomit-frame-pointer using CONFIG_FRAME_POINTER.

commit 78a21ca05cd8217251d1bcb96b72f9dca11a4eaf
Author: Trond Myklebust <trond.myklebust@fys.uio.no>
Date:   Sat Apr 10 21:50:56 2004 -0700

    NFSv3: Fix an XDR overflow bug in READDIRPLUS

commit b14d09be66a6fc4b033052daff995923213b0bf7
Author: Trond Myklebust <trond.myklebust@fys.uio.no>
Date:   Sat Apr 10 21:50:04 2004 -0700

    RPC: Ensure that we only schedule one RPC request at a time.
       In theory the current code could cause two to be scheduled
       if something wakes up xprt->snd_task before keventd has
       had a chance to run xprt_sock_connect()

commit 5d36d77c586552ebf2ed5003b0f1052e5e9c3293
Author: Trond Myklebust <trond.myklebust@fys.uio.no>
Date:   Sat Apr 10 21:47:16 2004 -0700

    Lockd: Fix waiting on the server grace period.
      The old code was wrong in that it assumed that we are out the grace
      period as soon as the client is finished doing lock recovery.
      Also ensure that we respect signals when waiting for the server grace
      period to end.

commit 0a4960965d144a10ad98668c79167376415128e8
Author: Trond Myklebust <trond.myklebust@fys.uio.no>
Date:   Sat Apr 10 21:46:02 2004 -0700

    RPC: Fix a bug introduced by trond.myklebust@fys.uio.no|ChangeSet|20040314024328|33542.
      portmap can fail due to the call to xprt_close() in xprt_connect():
        xprt_disconnect() wakes up xprt->snd_task, and sets -ENOTCONN,
        which again gets converted to EIO by xprt_connect_status()
    
      Fix is to remove call to xprt_disconnect(). We don't need it in the
      case when we are reconnecting. However we do need to ensure that we
      wake up xprt->snd_task if reconnection fails.
    
      Diagnosis & proposed solution by Olaf Kirch

commit 4e2cf61913691c2820ff3d748c4ec81633e8e011
Author: Trond Myklebust <trond.myklebust@fys.uio.no>
Date:   Sat Apr 10 21:43:43 2004 -0700

    NFSv4: Check server capabilities at mount time so that we can optimize away
    requests for attributes that are not supported. In particular, we wish to
    determine whether or not the server supports ACLs.

commit 64596af09b60f5e5dcf563a9ff72a7773484faee
Author: Trond Myklebust <trond.myklebust@fys.uio.no>
Date:   Sat Apr 10 21:42:23 2004 -0700

    RPC: add a field to the xdr_buf that explicitly contains the maximum buffer
         length.
    RPC: make the client receive xdr_buf return the actual length of the RPC
         length.
    NFSv4/RPC: improved checks to prevent XDR reading beyond the actual end of
         the RPC reply.

commit d9d762e75ae8b2d55bf94b869c82206715a53f0b
Author: Trond Myklebust <trond.myklebust@fys.uio.no>
Date:   Sat Apr 10 21:40:18 2004 -0700

    NFSv4: clean up the FSINFO XDR code to conform to the new scheme for GETATTR.

commit ea6cacaf00b9e7fa2a32ac46a25e72d0214fcc9c
Author: Trond Myklebust <trond.myklebust@fys.uio.no>
Date:   Sat Apr 10 21:39:33 2004 -0700

    NFSv4: assorted code readability cleanups in the XDR

commit 829186b78226c75821d8955c63dcb45966313058
Author: Trond Myklebust <trond.myklebust@fys.uio.no>
Date:   Sat Apr 10 21:38:51 2004 -0700

    NFSv4: use the (more efficient) NFSv2/v3-like XDR scheme for generating
    READDIR RPC calls.

commit 1513be7e1eead93049ea2481fb6ebeaa4ca5df51
Author: Trond Myklebust <trond.myklebust@fys.uio.no>
Date:   Sat Apr 10 21:37:43 2004 -0700

    NFSv4: use the (more efficient) NFSv2/v3-like XDR scheme for generating
    READLINK RPC calls.

commit 15c5fef529e2a875bb2af3af13744feea6d6586c
Author: Trond Myklebust <trond.myklebust@fys.uio.no>
Date:   Sat Apr 10 21:36:57 2004 -0700

    NFSv4: use the (more efficient) NFSv2/v3-like XDR scheme when doing
    sillyrename() completion.

commit 33abaafc6b105f09aeda7263b5db06f070eebc9a
Author: Trond Myklebust <trond.myklebust@fys.uio.no>
Date:   Sat Apr 10 21:36:11 2004 -0700

    NFSv4: use the (more efficient) NFSv2/v3-like XDR scheme for generating
    STATFS RPC calls.

commit f3e5aa184cb8e31a8915d70c9e0a0700e8b9a483
Author: Trond Myklebust <trond.myklebust@fys.uio.no>
Date:   Sat Apr 10 21:35:03 2004 -0700

    NFSv4: use the (more efficient) NFSv2/v3-like XDR scheme for generating
    PATHCONF RPC calls.

commit 4e55f94bcda6f49994ff9da514ced664a9908d46
Author: Trond Myklebust <trond.myklebust@fys.uio.no>
Date:   Sat Apr 10 21:34:14 2004 -0700

    NFSv4: use the (more efficient) NFSv2/v3-like XDR scheme for generating
    CREATE RPC calls.

commit 4e7473b804fd25415fbb58ba3452ec13d889da8a
Author: Trond Myklebust <trond.myklebust@fys.uio.no>
Date:   Sat Apr 10 21:33:21 2004 -0700

    NFSv4: use the (more efficient) NFSv2/v3-like XDR scheme for hard linking

commit 6aedfa2dd5cf85bcd4ccc79af920b2bcb3a10101
Author: Trond Myklebust <trond.myklebust@fys.uio.no>
Date:   Sat Apr 10 21:32:26 2004 -0700

    NFSv4: use the (more efficient) NFSv2/v3-like XDR scheme for generating
    RENAME RPC calls.

commit c8e46334ca284863a76174719a617f392d8941cc
Author: Trond Myklebust <trond.myklebust@fys.uio.no>
Date:   Sat Apr 10 21:31:33 2004 -0700

    NFSv4: use the (more efficient) NFSv2/v3-like XDR scheme for generating
    REMOVE RPC calls.

commit fba5d3c4dcd1fa79698728c26bef24f15b9f2f41
Author: Trond Myklebust <trond.myklebust@fys.uio.no>
Date:   Sat Apr 10 21:30:19 2004 -0700

    NFSv4: use the (more efficient) NFSv2/v3-like XDR scheme for looking up the
    mountpoint.

commit efec5fa4566c0b75949bdbe790f765d8b17fae1e
Author: Trond Myklebust <trond.myklebust@fys.uio.no>
Date:   Sat Apr 10 21:29:17 2004 -0700

    NFSv4: use the (more efficient) NFSv2/v3-like XDR scheme for generating
    LOOKUP RPC calls.

commit abd795e959b3818aa3495c0d0119dab1ed1e6166
Author: Trond Myklebust <trond.myklebust@fys.uio.no>
Date:   Sat Apr 10 21:27:57 2004 -0700

    NFSv4: Remove unnecessary post-op attributes from read/write/... calls. The
    new attribute revalidation scheme doesn't rely on them.

commit 85ac427f21bbb9d73722f9c287b478843198776d
Author: Trond Myklebust <trond.myklebust@fys.uio.no>
Date:   Sat Apr 10 21:26:43 2004 -0700

    NFSv4: use the (more efficient) NFSv2/v3-like XDR scheme for generating
    GETATTR RPC calls.

commit 9c0c8d90a1aa0225fd2dc45e6f1e1d25ee71fb25
Author: Trond Myklebust <trond.myklebust@fys.uio.no>
Date:   Sat Apr 10 21:25:55 2004 -0700

    NFSv4: use the (more efficient) NFSv2/v3-like XDR scheme for generating
    ACCESS RPC calls.

commit 677da9bf8a3ac83a1d2f9f2df21b1549583b416e
Author: Trond Myklebust <trond.myklebust@fys.uio.no>
Date:   Sat Apr 10 21:25:10 2004 -0700

    NFSv4: attribute bitmap values need to be unsigned long integers.

commit 01d37f031f0cda3caeeafa599c8e7e54b862d93c
Author: Trond Myklebust <trond.myklebust@fys.uio.no>
Date:   Sat Apr 10 21:24:37 2004 -0700

    RPCSEC_GSS: Fix RPC padding in two instances of RPCSEC_GSS code.
    RPC: Clean up XDR encoding of opaque data.

commit bcb23e3c86a64106b899fa6d96c84c4a925dc374
Author: Trond Myklebust <trond.myklebust@fys.uio.no>
Date:   Sat Apr 10 21:23:41 2004 -0700

    NFSROOT: clean up the parser routines (patch by Fabian Frederic)

commit 1582077363b9ab452317051777874efe22e67d50
Author: Trond Myklebust <trond.myklebust@fys.uio.no>
Date:   Sat Apr 10 21:23:05 2004 -0700

    NFSv2/v3/v4: Fix a slowdown of O_SYNC and O_DIRECT writes that resulted
    from over-aggressive attribute cache revalidation.

commit a9156c090edbe89c51e7dbf414334d9d07fd5184
Author: Trond Myklebust <trond.myklebust@fys.uio.no>
Date:   Sat Apr 10 21:22:21 2004 -0700

    RPCSEC_GSS: Fix integrity checksum bugs. Need to take into account the
    starting offset when calculating the page length.

commit c20a2f14b159d83ea9074fad1c1cb8582f1e2bfc
Author: Trond Myklebust <trond.myklebust@fys.uio.no>
Date:   Sat Apr 10 21:20:59 2004 -0700

    NFSv2/v3/v4: Deal with the case where the server reads/writes fewer
    bytes than we requested due to resource limitations etc.

commit f657eb851cfa8cf3a0365cfcd9eb6a64b600fecc
Author: Trond Myklebust <trond.myklebust@fys.uio.no>
Date:   Sat Apr 10 21:20:03 2004 -0700

    RPC: Close some potential scheduler races in rpciod.

commit 1fe8529da9bae95b6b81d3d45509747e3c63c9b5
Author: Trond Myklebust <trond.myklebust@fys.uio.no>
Date:   Sat Apr 10 21:19:27 2004 -0700

    RPC: add fair queueing to the RPC scheduler.
    If a wait queue is defined as a "priority queue" then requests are dequeued
    in blocks of 16 in order to work well with write gathering + readahead on the
    server.
    There are 3 levels of priority. The high priority tasks get scheduled 16 times
    for each time the default level gets scheduled. The lowest level gets
    scheduled once every 4 times the normal level gets scheduled.
    Original patch contributed by Shantanu Goel.

commit 3208896d58b138023e805a1094834b8f8c06f6ad
Author: Trond Myklebust <trond.myklebust@fys.uio.no>
Date:   Sat Apr 10 21:15:31 2004 -0700

    RPC,NFS: remove instances of tests for waitqueue_active(). Those can be racy.
    RPC: remove unnecessary support for sk->sk_sleep on those sockets that are
      owned by the RPC client.

commit bbc8ea9ee18118bce54c6919235080d6c7f6ae42
Author: Trond Myklebust <trond.myklebust@fys.uio.no>
Date:   Sat Apr 10 21:14:36 2004 -0700

    NFSv2/v3/v4: When pdflush() is trying to free up memory by calling our
      writepages() method, throttle all writes to that mountpoint.

commit b13556045f4e662eb578fd801a5c27b1fc31d492
Author: Trond Myklebust <trond.myklebust@fys.uio.no>
Date:   Sat Apr 10 21:13:40 2004 -0700

    NFSv2/v3/v4: Add support for asynchronous writes even if wsize<PAGE_CACHE_SIZE.

commit 7e19d1900fe80a37e2bd5c4138167b5a6fee9d80
Author: Trond Myklebust <trond.myklebust@fys.uio.no>
Date:   Sat Apr 10 21:11:31 2004 -0700

    NFSv2/v3/v4: Add support for asynchronous reads even if rsize<PAGE_CACHE_SIZE.

commit 6c2689a530cc4a846dc4e36a19812b88b7bfe117
Author: Trond Myklebust <trond.myklebust@fys.uio.no>
Date:   Sat Apr 10 21:04:40 2004 -0700

    NFSv2/v3/v4: Prepare the nfs_page struct to allow for short reads.

commit 9d3ab7c996d25c77bd9f6d6f09e67b682e1496c9
Author: Russell King <rmk@flint.arm.linux.org.uk>
Date:   Sun Apr 11 01:42:37 2004 +0100

    [PCMCIA] Fix warning about truncated integer.

commit d22e25bf9b881abaeb8effea673c51da0745eac2
Author: Russell King <rmk@flint.arm.linux.org.uk>
Date:   Sun Apr 11 01:29:54 2004 +0100

    [PCMCIA] Re-export pci_bus_alloc_resource() from PCI code.
    
    Since PCMCIA now uses this, re-export it.

commit 8b5170ecc720d522e3f014132131d0be9fbf09b0
Author: Russell King <rmk@flint.arm.linux.org.uk>
Date:   Sun Apr 11 00:31:14 2004 +0100

    [ARM] Drop -traditional from assembler command line in decompressor.

commit 40ac26f8f754ba9deb734f705f924f2af4fc52a5
Author: Russell King <rmk@flint.arm.linux.org.uk>
Date:   Sat Apr 10 16:38:50 2004 +0100

    [PCMCIA] Use kernel resource core as primary resource allocator.
    
    Turn the resource management on its head.  Rather than using PCMCIA's
    resource database as the primary object to allocate resources, use
    Linux's standard resource allocation instead.
    
    When we have a socket on a PCI bus, we always use the PCI resource
    allocation functions rather than the kernels core resource allocation,
    so that we can take account of any bridges.

commit bdafa19eba16ea96f4f93215015cbadbe40cc521
Author: Russell King <rmk@flint.arm.linux.org.uk>
Date:   Sat Apr 10 16:33:03 2004 +0100

    [PCMCIA] Remove racy check_io_resource()
    
    Convert do_io_probe() to use claim/free_region() rather than the
    racy check_io_resource().  Remove check_io_resource() and the now
    unused resource_parent() functions.

commit d6ac0fde205c8faef87ab16cd48997fb46e9bd1d
Author: Russell King <rmk@flint.arm.linux.org.uk>
Date:   Sat Apr 10 16:29:05 2004 +0100

    [PCMCIA] Fix resource handling for memory probe
    
    Add claim_region and free_region to claim/free resource regions.
    This ensures that we only attempt to probe memory regions which
    are directly related to the socket in question, rather than any
    memory region we happen to be able to request.
    
    This also fixes a memory leak where we don't kfree the resources
    we previously allocated.

commit 3d3ef37693a0e522aa80414464942036b3dc03b5
Author: Russell King <rmk@flint.arm.linux.org.uk>
Date:   Sat Apr 10 16:08:49 2004 +0100

    [ARM] Reduce the number of unnecessary includes in decompressor.
    
    This appears to work around the gcc problem where gcc adds extra
    .globl directives into the assembly for misc.s for its internal
    libgcc functions.

commit 99ca6b83248eb54e9afe05d46e0c7c7a559aab95
Author: Russell King <rmk@flint.arm.linux.org.uk>
Date:   Sat Apr 10 14:00:44 2004 +0100

    [SERIAL] Add extra suspend/resume functionality to serial_cs.
    
    This calls into the 8250 driver so that the serial port settings can
    be saved and restored over a suspend/resume cycle.  Previous kernels
    have assumed that the port will be re-opened after such an event,
    which may not be the case.

commit 7e403221f307c5c0f172f4e70bb072a7849ce910
Author: Bjorn Helgaas <bjorn.helgaas@com.rmk.(none)>
Date:   Sat Apr 10 12:28:36 2004 +0100

    [SERIAL] HCDP IRQ fixup
    
    Some pre-production firmware has incorrect GSI values in the
    HCDP, which tells us where the serial console port is, so we
    have to do the auto-IRQ thing after all.

commit 246756e9e49711470b21f35fb574d1857ffb1a1e
Author: James Bottomley <jejb@mulgrave.(none)>
Date:   Sat Apr 10 01:06:16 2004 -0400

    Convert sr to a kref and fix sr_open/sr_remove race
    
    We actually fix this race by mediating the object release/get race
    (i.e. we destroy the scsi_cd object when its reference count goes
    1->0, we use a semaphore to prevent something else trying to get a
    reference after or during this).
    
    The open/remove race is actually irrelevant because even if we open an
    already removed object, all that will happen is that we get a
    reference to a device that always returns EIO.

commit c23510ca4c53928ad62b3514dd62934ba3152482
Author: James Bottomley <jejb@mulgrave.(none)>
Date:   Sat Apr 10 01:04:47 2004 -0400

    Convert sd to kref and fix sd_open/sd_remove race
    
    We actually fix this race by mediating the object release/get race
    (i.e. we destroy the scsi_disk object when its reference count goes
    1->0, we use a semaphore to prevent something else trying to get a
    reference after or during this).
    
    The open/remove race is actually irrelevant because even if we open an
    already removed object, all that will happen is that we get a
    reference to a device that always returns EIO.

commit 3555ef9a9e0437b9252f37949674b5b6d57df903
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri Apr 9 20:12:50 2004 -0700

    [NET]: Fix memset args in sk_mca, noticed by Jean Delvare <khali@linux-fr.org>

commit 6d7b1571559423225b708d94fd849743dc2b74aa
Author: Russell King <rmk@flint.arm.linux.org.uk>
Date:   Sat Apr 10 01:01:39 2004 +0100

    [SERIAL] Remove UPF_HUP_NOTIFY; this is no longer used.

commit 90bb1167986b83113a6bf2354c7168d7a951c5cf
Author: Russell King <rmk@flint.arm.linux.org.uk>
Date:   Sat Apr 10 00:57:30 2004 +0100

    [SERIAL] Pass sa11x0 struct device through to tty_register_device.

commit 6cf721a003db3b7e678c3e1c25ac201a52d9a347
Author: Russell King <rmk@flint.arm.linux.org.uk>
Date:   Sat Apr 10 00:52:50 2004 +0100

    [SERIAL] Pass device pointer through to tty_register_device.
    
    This allows drivers to pass their struct device through to
    tty_register_device, which in turn allows sysfs to show which
    device and driver owns the UART.

commit 6503adce60ac67656bad18ac089b7dd9b1b8f4a5
Author: Russell King <rmk@flint.arm.linux.org.uk>
Date:   Sat Apr 10 00:33:45 2004 +0100

    [SERIAL] Don't try to free resources we didn't request.

commit 7518eacc4191ca3e75a492b92cbf3c3095596748
Author: Russell King <rmk@flint.arm.linux.org.uk>
Date:   Sat Apr 10 00:29:22 2004 +0100

    [SERIAL] Correct minor debugging format string error.

commit 4b453bcf38c06e0e4c0442507c65908825860aa0
Author: Russell King <rmk@flint.arm.linux.org.uk>
Date:   Sat Apr 10 00:23:30 2004 +0100

    [SERIAL] Remove some dead declarations.

commit 74ee31b1cb666c1477bf75ffff5a52fceffafd63
Author: Russell King <rmk@flint.arm.linux.org.uk>
Date:   Sat Apr 10 00:16:29 2004 +0100

    [SERIAL] Unuse old SERIAL_IO_xxx macros.
    
    8250.c should be using the replacement UPIO_xxx macros instead.

commit 90aaef2aef3261f43f34bf18d72914aa39a4caf8
Author: Marcel Holtmann <marcel@holtmann.org>
Date:   Fri Apr 9 23:17:36 2004 +0200

    [Bluetooth] Fix race in RX complete routine of the USB drivers
    
    The test of the HCI_RUNNING flags bit in the RX complete routine should
    be made while holding the completion lock. Otherwise there can be a race
    on SMP systems in which RX complete finds the bit is set and on another
    processor the close routine clears the bit, grabs and releases the lock
    and then unlinks all the active URB's. Then the first processor acquires
    the lock and resubmits the URB.
    
    Patch from Alan Stern <stern@rowland.harvard.edu>

commit 14e5719b0fbefc3a94356b12580c008d35789a64
Author: Marcel Holtmann <marcel@holtmann.org>
Date:   Fri Apr 9 23:00:06 2004 +0200

    [Bluetooth] Allow normal users to release the previous created TTY
    
    In the case the RFCOMM device node can't be found, the user must be able to
    release the previous created TTY.

commit 7fe2a4c37e9067b5d531ea5a25052add2d430dcf
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri Apr 9 09:51:52 2004 -0700

    [NET]: Fix printk warnings in strip driver.

commit 498c1003026af00703e85e170c5d2b0b7c99d5e2
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri Apr 9 09:45:53 2004 -0700

    [NET]: Fix printk warnings in wireless/strip.c

commit a7b97e42c727d62daa092d4ae9a8dce3601ff9cd
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri Apr 9 09:43:58 2004 -0700

    [IRDA]: Fix 32-bit pointer bug in donauboe.c

commit 37f13434c2a0d2ef2cc4992dfc533e9bac5e00cb
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri Apr 9 09:43:10 2004 -0700

    [IRDA]: Fix warnings in sir_dev.c

commit 5b85b1800fa98bb8d275ee77d913d7fa0b5ae053
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri Apr 9 07:18:22 2004 -0700

    [ATM]: Fix printk warnings in ambassador driver.

commit 9f58dd0308e64c61dc89089b669015b87394847f
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri Apr 9 07:17:39 2004 -0700

    [SCTP]: Fix printk warnings.

commit 372477dfbc7844047c6d25d09ff9c8c1a90b34b4
Author: Stephen Hemminger <shemminger@osdl.org>
Date:   Fri Apr 9 07:16:29 2004 -0700

    [NET]: Use random address in usbnet driver.

commit e710d91d67ae45c0c53f37ed7b5a873b9e2ed935
Author: Stephen Hemminger <shemminger@osdl.org>
Date:   Fri Apr 9 07:16:06 2004 -0700

    [NET]: Use random address in usb gadget driver.

commit ec731ce0dd7e41ad047b6353664e98ffad417614
Author: Stephen Hemminger <shemminger@osdl.org>
Date:   Fri Apr 9 07:15:42 2004 -0700

    [NET]: Use random address in dummy driver.

commit ed58762a4592e93a7e6af9c8478d4b74cdfd1961
Author: Stephen Hemminger <shemminger@osdl.org>
Date:   Fri Apr 9 07:15:02 2004 -0700

    [NET]: Add random_ether_addr to ether_device.h

commit ee02b9e09dd142a501c209ccabef6feb3e797ec0
Author: Hideaki Yoshifuji <yoshfuji@linux-ipv6.org>
Date:   Fri Apr 9 07:13:22 2004 -0700

    [IPV6]: Mark MLDv2 report as known.
    
    Mark MLDv2 Report as known ICMPv6 type.
    (We just ignore MLDv2 Reports on hosts as the spec says.)

commit 1ab4a54642487b5be5fe366b4fe35307862ba6e9
Author: Jean Tourrilhes <jt@bougret.hpl.hp.com>
Date:   Fri Apr 9 06:52:48 2004 -0700

    [IRDA]: Move IRDA device headers to more appropriate place.

commit f85c9074a9fdbfb8b702ca40f56450fc06e45088
Author: Tim Mattox <tmattox@engr.uky.edu>
Date:   Fri Apr 9 08:54:06 2004 -0400

    [netdrvr tulip] add MII support for Comet chips
    
    Add MII support for ADMtek Comet (Linksys LNE100TX v4.1 & others):
    * tulip_core.c: add HAS_MII flag to COMET entry in tulip_tbl[]
    * timer.c (comet_timer): add missing call to tulip_check_duplex()
    and replace inl() calls with tulip_mdio_read() calls
    Changes modeled after Donald Becker's tulip.c:v0.98 1/8/2004

commit 7d953645baaab4557fbd427ff39d2154614ddb34
Author: Jeff Garzik <jgarzik@redhat.com>
Date:   Fri Apr 9 08:50:50 2004 -0400

    [netdrvr tulip] remove ChangeLog file
    
    It was out of date.  BitKeeper logs are more recent and more accurate.

commit 6f5abb00cf3b81646e4b7f3306381a952a21f325
Author: Chas Williams <chas@cmf.nrl.navy.mil>
Date:   Fri Apr 9 02:37:48 2004 -0700

    [ATM]: [nicstar] using dev_alloc_skb() (reported by Johnston,

commit cd73f64483c6f7688ad6e2fee5b98d7fa32b3c60
Author: Chas Williams <chas@cmf.nrl.navy.mil>
Date:   Fri Apr 9 02:36:55 2004 -0700

    [ATM]: get atm_guess_pdu2truesize() right

commit d23f682eb60674a64cf5cbbab1572f3cfc437af4
Author: Harald Welte <laforge@netfilter.org>
Date:   Fri Apr 9 02:34:52 2004 -0700

    [NETFILTER]: Add more debug info to TFTP helper.
    
    From Vineet Mehta <extreme@zayanionline.com>

commit 7ae476913f75ed09da888a39066fed87c41ed844
Author: Randy Dunlap <rddunlap@osdl.org>
Date:   Fri Apr 9 02:32:02 2004 -0700

    [NET]: Kill __FUNCTION__ string literal concatenation.
    
    From Tony Breeds <tony@bakeyournoodle.com>

commit c4fb41cb7a2ad28bea4fa440a644efbb17d8e57b
Author: Jason Wever <weeve@gentoo.org>
Date:   Fri Apr 9 02:30:19 2004 -0700

    [SOUND]: Add amd7930 to sndmagic.h

commit 5b87484fbb2f6db4c5100dc3aec834ddfbf22882
Author: Jason Wever <weeve@gentoo.org>
Date:   Fri Apr 9 02:29:14 2004 -0700

    [SOUND]: Proper deps for SND_BIT32_EMUL.

commit 2204808fe5e5f187f11bb7a591772198494d5797
Author: Shirley Ma <mashirle@us.ibm.com>
Date:   Fri Apr 9 02:27:28 2004 -0700

    [IPV6]: Add missing MIB counter increments.

commit a0919ff9660d4a65b978be1f0b2e993de2f9eb98
Author: Karsten Keil <kkeil@suse.de>
Date:   Fri Apr 9 02:21:48 2004 -0700

    [ISDN]: Fix kernel PPP/IPPP active/passiv filter code.

commit a26d629529adfbfcdff480cc02bf65686a4acd70
Author: David S. Miller <davem@nuts.davemloft.net>
Date:   Fri Apr 9 02:03:30 2004 -0700

    [ISDN]: Add missing IPPP_FILTER entry to Kconfig.

commit b2c31abe7e6066312896c13daa93bd7794635125
Author: Andreas Gruenbacher <agruen@suse.de>
Date:   Fri Apr 9 01:47:47 2004 -0700

    [IPSEC]: Support draft-ietf-ipsec-udp-encaps-00/01, some ipec impls need it.

commit a318dc62ddf675cb13e7c9376ee109fb1cdf113e
Author: David S. Miller <davem@nuts.davemloft.net>
Date:   Fri Apr 9 01:29:23 2004 -0700

    [IPV6]: In ndisc_netdev_event, handle NETDEV_DOWN.
    
    Based upon patches and commentary from Thomas Spatzier,
    Stephen Hemminger, and Andi Kleen.

commit bd6b55b0d3a832a17de0dd65f348a3cb3b21b296
Author: Ben Collins <bcollins@debian.org>
Date:   Fri Apr 9 02:06:41 2004 -0400

    [SBP2]: Sync revision

commit 801740cb8c4eb01e00a79fd346277b40db930c19
Author: Ben Collins <bcollins@debian.org>
Date:   Fri Apr 9 02:03:57 2004 -0400

    [Kconfig]: eth1394 requires INET

commit 4db943a990d43c50f2355b60f4eda5e8eb46b995
Author: Ben Collins <bcollins@debian.org>
Date:   Fri Apr 9 01:09:02 2004 -0400

    [SBP2]: Fix compile for older gcc's

commit c3f20125b421e0ce8bfe82342c5bd973d5d94219
Author: Greg Kroah-Hartman <greg@kroah.com>
Date:   Thu Apr 8 22:06:16 2004 -0700

    [PATCH] I2C: clean up out of order bus Makefile and Kconfig entries.

commit 14dc9e49a14bd7707064dc2f82328ad69977ef92
Author: Greg Kroah-Hartman <greg@kroah.com>
Date:   Thu Apr 8 22:06:02 2004 -0700

    [PATCH] I2C: minor bugfixes for the pcf8591.c driver and formatting cleanups.

commit fffab9e05930a8dea5867f51ba3b7e94f26f03fe
Author: Aurelien Jarno <aurelien@aurel32.net>
Date:   Thu Apr 8 22:05:44 2004 -0700

    [PATCH] I2C: New chip driver: pcf8591
    
    Please find below a patch against kernel 2.6.5-rc2-mm4 to add the pcf8591
    driver (a 8-bit A/D and D/A converter). I have ported it from the 2.4
    version, and it includes some fixes, improvements and simplifications.
    
    It has been reviewed by Jean Delvare on IRC.
    
    Please also note that the patch also fixes a missing space in
    drivers/i2c/chips/Kconfig, introduced by the previous patch I sent you
    concerning the pcf8574.

commit 640bbbb57bf71cfd0cff8b48624c4b5d3ed9a226
Author: Jean Delvare <khali@linux-fr.org>
Date:   Thu Apr 8 21:58:21 2004 -0700

    [PATCH] I2C: Enable changing fan_divs in lm80 driver
    
    For some reason the original lm80 driver in 2.6 cannot set fan_divs
    (while the 2.4 driver could). This patch brings support back. It was
    lightly tested by one user.
    
    This patch also suggests some code cleanups (fan code refactoring). I'll
    send a different patch later for these.

commit 145f1f3a79b8492497d3cb3acb9c17e7667fb51f
Author: Hanna V. Linder <hannal@us.ibm.com>
Date:   Thu Apr 8 21:51:13 2004 -0700

    [PATCH] Fix class support to istallion.c
    
    Realized I put a / in the filename of this device too.
    
    Here is the fix:

commit 923855f818995edbcfec13014ebd5de30a79263c
Author: Hanna V. Linder <hannal@us.ibm.com>
Date:   Thu Apr 8 21:50:55 2004 -0700

    [PATCH] Fix for patch to add class support to stallion.c
    
    Oops. Realized I had a / in the file name in this patch too.
    
    Please apply to correct it:

commit 26c270c3dd3fe8ea8f366abf6fc12ba8ed7c0577
Author: Hanna V. Linder <hannal@us.ibm.com>
Date:   Thu Apr 8 21:50:34 2004 -0700

    [PATCH] fix sysfs class support to fs/coda/psdev.c
    
    --On Friday, April 09, 2004 12:02:19 AM +0200 Marcel Holtmann <marcel@holtmann.org> wrote:
    >> +static struct class_simple coda_psdev_class;
    >
    > I think coda_psdev_class must be a pointer.
    >
    > Regards
    >
    > Marcel
    
    
    Doh! I tested on one system and fixed this there. Then accidentally mailed out the
    original. Sorry about that. Here is a patch to fix it:

commit 78d35ef9d612884315f2b3e5c8038a4c748b0047
Author: Marcel Holtmann <marcel@holtmann.org>
Date:   Thu Apr 8 21:32:55 2004 -0700

    [PATCH] Add sysfs class support for CAPI
    
    here is a patch that adds class support to the ISDN CAPI module. Without
    it udev won't create the /dev/capi20 device node.

commit 667dc37fbe4ccae254d58c3766b24edd090c98f8
Author: Alan Stern <stern@rowland.harvard.edu>
Date:   Thu Apr 8 21:29:48 2004 -0700

    [PATCH] USB: Updated unusual_dev.h entry
    
    On Thu, 8 Apr 2004, Marcin Juszkiewicz wrote:
    
    > usb-storage: This device (054c,0025,0100 S 04 P 01) has unneeded SubClass and
    > Protocol entries in unusual_devs.h
    
    Thank you for sending this in.

commit a07af8e5b5f7698dfe3a860119a08142d28afeb6
Author: Randy Vinson <rvinson@linuxbox.(none)>
Date:   Thu Apr 8 20:55:30 2004 -0700

    Updating Force PCore to 2.6

commit 1636f8a9980280f898917df8c11ff91bb83da09c
Author: Marcel Holtmann <marcel@holtmann.org>
Date:   Fri Apr 9 05:27:17 2004 +0200

    [Bluetooth] Add support for Anycom CF-300
    
    The Anycom CF-300 compact flash card contains a new Bluetooth chip and
    thus it needs some special handling for the faster UART baud rate. This
    patch detects this new card and does the different initialization.

commit 8ff56285a7d360d833a802871f7f92062e6ad012
Author: Marcel Holtmann <marcel@holtmann.org>
Date:   Fri Apr 9 05:21:54 2004 +0200

    [Bluetooth] Improve NULL pointer handling
    
    This small patch adds more checks for NULL pointers.

commit 643bd1a130869e64452b13a0446e8b9ff0ddcb73
Author: Marcel Holtmann <marcel@holtmann.org>
Date:   Fri Apr 9 05:20:41 2004 +0200

    [Bluetooth] Make use of request_firmware() for the 3Com driver
    
    The 3Com Bluetooth PCMCIA cards need a firmware download every time they
    are inserted. With request_firmware() the file BT3CPCC.bin is now loaded
    directly from the userspace and the external firmware loader program is
    no longer needed.

commit de0100ab2078f0a5fbf83224399b3315755b1bca
Author: Marcel Holtmann <marcel@holtmann.org>
Date:   Fri Apr 9 05:01:09 2004 +0200

    [Bluetooth] Fix URB unlink race in the USB drivers
    
    The code in hci_usb_unlink_urbs() calls usb_unlink_urb() to perform a
    synchronous unlink of each pending URB. It then moves each URB to the
    completed list, and then frees everything on the completed list. By doing
    this, the code implicitly assumes that when usb_unlink_urb() returns the
    URB will have completed and be ready to be deallocated. That's not always
    true. The same applies to the BlueFRITZ! USB driver.
    
    Patch from Alan Stern <stern@rowland.harvard.edu>

commit 9f329fe77b533230a2a33825db82722b2dcb2a48
Author: Russell King <rmk@flint.arm.linux.org.uk>
Date:   Fri Apr 9 00:49:03 2004 +0100

    [ARM] Move definition of the kernel module space to asm-arm
    
    Since all machine classes define module space the same way, we
    move this into the common ARM code.

commit f9ef3fc9ca1677c1349cb9ea2857dd558e323f5e
Author: Russell King <rmk@flint.arm.linux.org.uk>
Date:   Thu Apr 8 22:42:54 2004 +0100

    [ARM] Fix ordering of machine class selection.
    
    The machine class should be in alphabetical order.  Swap ordering
    of the recently added TI and S3C2410 entries to return it to this
    ordering.

commit 353eb8c6b7e16e1758acc2b1dfe2cecce9864fa6
Author: Marc Singer <elf@com.rmk.(none)>
Date:   Thu Apr 8 22:32:47 2004 +0100

    [ARM PATCH] 1806/1: Adding barrier() to show_stack () for proper backtracing
    
    Patch from Marc Singer
    
    As suggested by Russell, we add a barrier() before returning from
    stack_trace().  This was helpful when diagnosing a problem with a
    kernel transition to user-space where the problem was a lack of
    floating point support in the kernel.  Without this change, the
    backtrace reported an error.
    
    It is possible that this change has already been made.  I don't see it
    in any of the applied patches that I can read.

commit e72509c4acfafefcac29c761dcd82a5087da0703
Author: Ben Dooks <ben-linux@org.rmk.(none)>
Date:   Thu Apr 8 21:43:18 2004 +0100

    [ARM PATCH] 1807/1: S3C2410 - onboard serial
    
    Patch from Ben Dooks
    
    Serial driver for S3C2410 on board UARTs. Re-post of 1796/1
    
    Includes BAST driver to register on-board 16550s.

commit 2aebc5b195bc00aa5e09c10dec3a4a5fdb9ba21b
Author: Dave Jones <davej@redhat.com>
Date:   Thu Apr 8 18:57:41 2004 +0100

    [CPUFREQ] Don't bother checking if we need workarounds if we don't support powernow.

commit c2076f465bb8bc3d1d6d4f56a569e24523090216
Author: Dave Jones <davej@redhat.com>
Date:   Thu Apr 8 18:54:57 2004 +0100

    [CPUFREQ] Quieten powernow-k7 in the built-in case.
    The other cpufreq drivers are quiet in the 'dont have hardware' case, so this should follow suit.

commit a9f7dc3fcabff72cfcbb423b5df97ee4658ddb37
Author: David Mosberger <davidm@tiger.hpl.hp.com>
Date:   Thu Apr 8 04:30:19 2004 -0700

    ia64: Make acpi.c compile again: there was an implicit declaration
    	mismatch because the external declaration isn't in the arch-
    	independent ACPI bits yet.

commit cdceba0e0e843f725c5afc3dcb25530dd3b66b63
Author: James Bottomley <james.bottomley@steeleye.com>
Date:   Thu Apr 8 05:43:15 2004 -0500

    [PATCH] SCSI: make DV check device capabilities
    
    the SPI transport class DV should check the data we derive from the
    inquiry to see if the device is capable of supporting wide/sync before
    trying to validate the settings.

commit 02602b3a8a4ba2101c7c50141a5a31f353e081a7
Author: St√©phane Eranian <eranian@hpl.hp.com>
Date:   Thu Apr 8 03:21:53 2004 -0700

    [PATCH] ia64: perfmon update
    
    Here is a new perfmon patch. It is important because it
    fixes the problem of the close() when the file descriptor
    is shared between two related processes. The good thing
    is that it simplifies a lot the cleanup of the sampling
    buffer.
    
    Here is the ChangeLog:
    
    - fix bug in pfm_close() when the descriptor is
      shared between related processed. Introduce
      a pfm_flush() called for each invocation of
      close(). pfm_close() only called for the last
      user.
    
    - fix pfm_restore_monitoring() to also reload
      the debug registers. They could be modified
      while monitoring is masked.
    
    - fix pfm_close() to clear ctx_fl_is_sampling.
    
    - fix a bug in pfm_handle_work() which could cause
      the wrong PMD to be reset.
    
    - converted PROTECT_CTX/UNPROTECT_CTX into
      local_irq_save/restore to keep context protection
      but allow IPI to proceed.
    
    - updated pfm_syswide_force_stop() to use
      local_irq_save/restore now that the context
      is protected from the caller side.
    
    - updated pfm_mck_pmc_check() to check if context is
      loaded before checking for special IBR/DBR combinations.
      Clearing the debug registers is not needed when the context
      is not yet loaded.
    
    - updated perfmon.h to have to correct prototype definitions
      for the pfm_mod_*() functions.
    
    - got rid of the PFM_CTX_TERMINATED state.
    
    - cleanup the DPRINT() statements to remove
      explicit output of current->pid. This is done
       systematically by the macros.
    
    - added a systctl entry (expert_mode) to bypass
      read/write checks on PMC/PMD. As its name indicates
      this is for experts ONLY. Must be root to toggle
      /proc/sys entry.
    
    - corrected pfm_mod_*() to check against the current task.
    
    - removed pfm_mod_fast_read_pmds(). It is never needed.
    
    - added pfm_mod_write_ibrs() and pfm_mod_write_dbrs().

commit d7ee788da700cc529e9a46742b6b693c21f9fa47
Author: Bjorn Helgaas <bjorn.helgaas@hp.com>
Date:   Thu Apr 8 03:03:05 2004 -0700

    [PATCH] ia64: allow simscsi to be a module
    
    Requiring CONFIG_HP_SIMSCSI to be either  "y" or "n" breaks
    allmodconfig, because simscsi ends up built-in, while scsi itself
    is a module.  So allow simscsi to be a module also.

commit 352b39c8d73ce4fbbec2bb226c76bdb3cb7f37c3
Author: Bjorn Helgaas <bjorn.helgaas@hp.com>
Date:   Thu Apr 8 03:02:17 2004 -0700

    [PATCH] ia64: ACPI IRQ cleanup (arch part)
    
    Here's the ia64 part of the ACPI IRQ cleanup I proposed here:
    
    http://www.gelato.unsw.edu.au/linux-ia64/0403/8979.html
    
    After the arch bits are in, I'll post the corresponding ACPI changes.
    I removed the "Found IRQ" printk now because when the ACPI
    change goes in, dev->irq won't be initialized until *after*
    acpi_pci_irq_enable().

commit e00ff58fbb61f76f739d222bb0a487e19f8d7e15
Author: Petri T. Koistinen <petri.koistinen@iki.fi>
Date:   Thu Apr 8 02:55:14 2004 -0700

    [PATCH] ia64: put URLs in documentation files inside angle-brackets
    
    Patch by Petri T. Koistinen.

commit 1328cf2622fb2eb710a5891d7916bca084d75dfb
Author: Hanna V. Linder <hannal@us.ibm.com>
Date:   Thu Apr 8 00:53:05 2004 -0700

    [PATCH] Add sysfs class support to fs/coda/psdev.c
    
    Here is a patch to add class support to psdev.c.
    
    I have verified it compiles and works.

commit 31436269fd725700d867d739a299149f451756e1
Author: Hanna V. Linder <hannal@us.ibm.com>
Date:   Thu Apr 8 00:45:41 2004 -0700

    [PATCH] add class support to dsp56k.c
    
    Here is a patch that adds sysfs class support to /drivers/char/dsp56k.c

commit 43eab8615c1bab7063f4a240ed1e203e1ab6b44d
Author: Greg Kroah-Hartman <greg@kroah.com>
Date:   Thu Apr 8 00:37:52 2004 -0700

    USB: fix empty write issue in pl2303 driver.
    
    Patch originally from Christian Groessler <cpg@aladdin.de> but cleaned up
    by me.

commit 1c5233b21481b41c1b0ae0e5ca389e8c3a328d40
Author: Greg Kroah-Hartman <greg@kroah.com>
Date:   Thu Apr 8 00:37:07 2004 -0700

    USB: fix pl2303 handling of status bits.
    
    Patch originally from Kevin Watkins <kw@cmu.edu>

commit 94da7b6b251edbc1f93acdbfb009ec75df55d8bf
Author: Andrew Morton <akpm@osdl.org>
Date:   Thu Apr 8 00:12:39 2004 -0700

    [PATCH] I2C: i2c-ali1563.c section fix
    
    ali1563_shutdown() is called from __init ali1563_probe() and hence cannot be
    marked __init.

commit a0f8eb34fb8daabc343e8f9f7aaeecdbf7a9ea99
Author: Patrick Mochel <mochel@digitalimplant.org>
Date:   Thu Apr 8 00:12:22 2004 -0700

    [PATCH] I2C: class fixup for the ali1563 driver

commit b94c444e0185d9bc4b7663e62e71e2da0296469a
Author: Stephen Hemminger <shemminger@osdl.org>
Date:   Wed Apr 7 23:34:53 2004 -0700

    [NET]: Use const args in eth_copy_and_sum and is_valid_ether_addr.

commit bcd1182eb5ff331e8ca8a61c8d85277b676f5118
Author: Tom Rini <trini@kernel.crashing.org>
Date:   Wed Apr 7 22:26:23 2004 -0700

    PPC32: Assign an interrupt for the VME chip on PReP MVME* boards.
    From Lutz Rossa <lrossa@web.de>.

commit e6a188235cd61c064fd76a465c20d52bd84c97ec
Author: Jean Delvare <khali@linux-fr.org>
Date:   Wed Apr 7 20:23:27 2004 -0700

    [PATCH] I2C: Refactor swap_bytes in i2c chip drivers
    
    > Ick, no, we should be using the proper kernel call for this, swab16(),
    > right?  Care to redo this patch to just fix the drivers and get rid of
    > our duplicating of this function.
    
    Oh, I didn't know such a function existed, sorry.
    
    Here's a new patch, hope you like it. Tested to work on my as99127f, btw
    (w83781d driver).
    
    Documentation update follows (well, tomorrow it does).

commit 7b0c8bb41679594fd0e78ba2b77a7745fd49ef46
Author: Greg Kroah-Hartman <greg@kroah.com>
Date:   Wed Apr 7 02:53:03 2004 -0700

    [PATCH] USB: fix up previous sysfs patch to actually compile...

commit 7775f7ea6fdab0f2f6323b504c0ecd53bc5c8586
Author: Robert Love <rml@ximian.com>
Date:   Wed Apr 7 02:52:34 2004 -0700

    [PATCH] USB: add missing usb entries to sysfs
    
    We have found in the course of hacking on HAL that some information that
    is in /proc/bus/usb/devices is not in sysfs.  It would be nice to rely
    only on sysfs, so the attached patch adds three files to usb devices in
    sysfs: devnum, maxChild, and version.
    
    This patch is actually by David Zuethen, the HAL maintainer - I told him
    I would clean it up and get it upstream.

commit 606d0900c7b253a674101fa56e1a20c60bf6cad0
Author: David Brownell <david-b@pacbell.net>
Date:   Wed Apr 7 02:52:02 2004 -0700

    [PATCH] USB: fix xsane breakage, hangs on device scan at launch
    
    Disable a usbfs disconnect() synchronization hack, which recently
    started deadlocking because this routine is now called in a different
    context.
    
    It shouldn't be needed any longer now that usbcore shuts down endpoints
    as part of driver unbinding.  (Except maybe on UHCI, which will have
    canceled but not necessarily completed all requests.)

commit 2d0bc3aa8861bc948883418cb9302dd920535b18
Author: David Brownell <david-b@pacbell.net>
Date:   Wed Apr 7 02:51:28 2004 -0700

    [PATCH] USB: retry some descriptor fetches
    
    This helps Linux handle certain enumeration problems better,
    by retrying most stalled descriptor fetches; on some devices,
    those indicate temporary problems.  This match makes at least
    one such (old) device enumerate reliably.

commit e47055965999fb2d5f3db1f6a8ee110912aeb03e
Author: Dely Sy <dlsy@snoqualmie.dp.intel.com>
Date:   Wed Apr 7 02:10:06 2004 -0700

    [PATCH] PCI Hotplug: Fix interpretation of 0/1 for MRL in SHPC & PCI-E hot-plug
    
    This patch contains fixes for interpretation of 0/1 for MRL
    to match pcihpview, bus speed definition in shpchp_hpc.c etc.

commit bedb78474684890a6d961f5c7c34add3c40a3295
Author: Tom Rini <trini@kernel.crashing.org>
Date:   Wed Apr 7 02:03:04 2004 -0700

    PPC32: Two minor Carolina PReP fixes.
    From Hollis Blanchard <hollisb@us.ibm.com>.

commit 397964abad17116c69a466da2ba7915b9370a3eb
Author: Tom Rini <trini@kernel.crashing.org>
Date:   Wed Apr 7 01:55:14 2004 -0700

    PPC32: Change all #if FOO to #ifdef FOO

commit d87f2437eeb6e1e4740f46f5793b829214ab9243
Author: James Bottomley <jejb@mulgrave.(none)>
Date:   Tue Apr 6 22:21:47 2004 -0500

    Add missing header changes from SCSI cdrom disconnection fix

commit 36ab7956d687a26063a684e464ce7f7d85f6ffab
Author: Dave Jones <davej@redhat.com>
Date:   Wed Apr 7 01:44:41 2004 +0100

    [AGPGART] Whitespace cleanup in sis-agp
    use spaces instead of (borked) tabs.

commit 185fdfa0b2a8678e4c8ab7b4394961d45235ec7c
Author: Dave Jones <davej@redhat.com>
Date:   Wed Apr 7 00:12:22 2004 +0100

    [AGPGART] Fix SiS 746 again.
    Turns out that this chipset won't work in AGPv3 mode with the generic AGPv3 routines.
    *somehow*, it works in AGPv3 mode with AGPv2 aperture sizing etc. Very, very strange.
    Still, until we get some docs from SiS, some support is better than none.

commit 94ab2a84e76ffee70576f73f3b16eb41611c322e
Author: Marcel Holtmann <marcel@holtmann.org>
Date:   Tue Apr 6 21:25:16 2004 +0200

    [Bluetooth] Allocate the BCM203x URB buffer seperately
    
    The buffer shares cachelines with other fields of the structure. On
    architectures which require synchronisation before or after doing DMA
    to or from a buffer, any access to such fields sharing cachelines can
    corrupt the content of the buffer. The allocation primitives guarantee
    that cachelines are not shared.
    
    Noticed by Oliver Neukum <oliver@neukum.org>

commit e19e558da4e707b155c577f26f9726882ae0a167
Author: Dave Jones <davej@redhat.com>
Date:   Tue Apr 6 18:07:22 2004 +0100

    [CPUFREQ] Stop preempt count from going negative.
    Broken failure path spotted by Dominik Brodowski.

commit 76c178da1d5cf8b118efd373f99dc471b51d4ab3
Author: Steve French <stevef@steveft21.ltcsamba>
Date:   Tue Apr 6 10:30:33 2004 -0500

    Fix 20 second hang on some deletes of reopened file due to semaphore conflict with vfs_delete on i_sem

commit 17660f347b89006dd1db68bee90e7c08b0c817f7
Author: Dave Jones <davej@redhat.com>
Date:   Tue Apr 6 15:46:55 2004 +0100

    [CPUFREQ] Fix %x printk's in powernow-k8.
    These are hex values. Prefix them all with 0x

commit 3285d8314f8c6261c5d387bf73705395746140aa
Author: Dave Jones <davej@redhat.com>
Date:   Tue Apr 6 15:44:12 2004 +0100

    [CPUFREQ] As we're using ACPI in powernow-k8 now, we need ACPI to initialise first.

commit a8e24e1f7a4cc4df51b93dfc5952c38baeb1d605
Author: Dave Jones <davej@redhat.com>
Date:   Tue Apr 6 15:34:10 2004 +0100

    [CPUFREQ] Bump powernow-k8 revision.

commit 3de581e3bde834277e73feb35412eb90efc33bef
Author: Dave Jones <davej@redhat.com>
Date:   Tue Apr 6 15:30:54 2004 +0100

    [CPUFREQ] ACPI support for powernow-k8.
    We fall back on the legacy PSB table if the ACPI tables don't work out.

commit ef44e465f358358ff5271008e884cd7674162e68
Author: Dave Jones <davej@redhat.com>
Date:   Tue Apr 6 15:19:24 2004 +0100

    [CPUFREQ] numerous powernow-k8 cpu_init() fixes/cleanups.

commit 3395b20146e253bcc13f5e234fd706a475fe5b8b
Author: Dave Jones <davej@redhat.com>
Date:   Tue Apr 6 15:11:36 2004 +0100

    [CPUFREQ] Stuck pending bit is now checked in the init routine.

commit eafae47f2ab965fec541bf51cad9b5f1bcf5b6f1
Author: Dave Jones <davej@redhat.com>
Date:   Tue Apr 6 15:09:28 2004 +0100

    [CPUFREQ] Extra debugging foo.

commit 7f3a3f1eb62d73aad53dedbc88b63404afaf6311
Author: Dave Jones <davej@redhat.com>
Date:   Tue Apr 6 15:08:16 2004 +0100

    [CPUFREQ] Change powernow-k8 over to use its new KHz frequency helpers

commit cac99d4cc798903dd6e7b87f5489745c84e87c62
Author: Dave Jones <davej@redhat.com>
Date:   Tue Apr 6 15:03:26 2004 +0100

    [CPUFREQ] More SMP/preempt fixes, this time powernowk8_target()
    Also some changes to use some helpers.

commit 355edfc405d28d0e0bd531fc2b7c369cded98602
Author: Dave Jones <davej@redhat.com>
Date:   Tue Apr 6 14:56:06 2004 +0100

    [CPUFREQ] Use the new fill_powernow_table() to fill struct instead of doing it inline.

commit f52f1b298ec1c4699e43a7cba52540cfaf606764
Author: Dave Jones <davej@redhat.com>
Date:   Tue Apr 6 14:46:44 2004 +0100

    [CPUFREQ] fill out the powernow_k8_data table.

commit 8f9e244f7952f29e00781ea5e302c39aa533dbb0
Author: Dave Jones <davej@redhat.com>
Date:   Tue Apr 6 14:40:05 2004 +0100

    [CPUFREQ] powernow-k8 header cleanups
    remove unused defines, introduce some new ones, and generally cleanup.

commit 36c2ba6c9a558dd6596a9e3da993dc93675ce281
Author: Dave Jones <davej@redhat.com>
Date:   Tue Apr 6 14:33:47 2004 +0100

    [CPUFREQ] Add missing MSR define to fix the powernow-k8 compile.

commit 92c7e355f493e3836f0a99b278b7b644485772f6
Author: Dave Jones <davej@redhat.com>
Date:   Tue Apr 6 14:30:35 2004 +0100

    [CPUFREQ] printk cleanup in powernow-k8's check_pst_table()

commit 5861b2b07029dce28e8c0b797dd15bd11506b805
Author: Dave Jones <davej@redhat.com>
Date:   Tue Apr 6 14:26:14 2004 +0100

    [CPUFREQ] SMP fixes for powernow-k8's check_supported_cpu()

commit 36ac9d1ab639deb0fa2554b07d823c3c8ff2c41e
Author: Dave Jones <davej@redhat.com>
Date:   Tue Apr 6 14:21:44 2004 +0100

    [CPUFREQ] Serialise fid/vid changes in powernow-k8 driver.

commit 8ccc19efc4c05cec71f17b0584e0ec61d2e895de
Author: Dave Jones <davej@redhat.com>
Date:   Tue Apr 6 14:20:12 2004 +0100

    [CPUFREQ] Merge a bunch of extra powernow-k8 helpers.

commit 0235c1be23404d67800c5e570a8fa9da1afdcf86
Author: Dave Jones <davej@redhat.com>
Date:   Tue Apr 6 14:13:54 2004 +0100

    [CPUFREQ] make powernow-k8 use batps from powernow data struct instead of static struct.

commit 7c3a930bd5f779d9c6b61d3c02bb05d81882a418
Author: Dave Jones <davej@redhat.com>
Date:   Tue Apr 6 14:02:40 2004 +0100

    [CPUFREQ] Kill off inlines in powernow-k8 driver.
    Gcc should be smart enough to do this itself.

commit 105cbe3be34734518bdef5663e07270981579a6e
Merge: f0cc009... 409e5c0...
Author: Steve French <stevef@steveft21.ltcsamba>
Date:   Tue Apr 6 04:36:36 2004 -0500

    Merge bk://cifs.bkbits.net/linux-2.5cifs
    into steveft21.ltcsamba:/usr/src/bk/linux-2.5cifs

commit 3771af67c71fc42854f205cf5fe79d5d60fedb46
Author: Khawar Chaudhry <khawar.chaudhry@amd.com>
Date:   Tue Apr 6 03:38:41 2004 -0400

    Update amd8111 net driver.
    
    version 3.04 for 2.4 kernel:
    +	 1. Added set_mac_address routine for bonding driver support.
    +	 2. Tested the driver for bonding support
    +	 3. Bug fix: Fixed mismach in actual receive buffer lenth and lenth
    +	    indicated to the h/w.
    +	 4. Modified amd8111e_rx() routine to receive all the received packets
    +	    in the first interrupt.
    +	 5. Bug fix: Corrected  rx_errors  reported in get_stats() function.
    
    version 3.05 for 2.6 kernel:
    +	 1. Added NAPI support

commit abfc22becfc19fa03a44d039b1eaf356d49cd10e
Author: James Bottomley <jejb@mulgrave.(none)>
Date:   Tue Apr 6 02:20:20 2004 -0500

    Fix SCSI cdrom disconnection race
    
    This fixes
    
    http://bugme.osdl.org/show_bug.cgi?id=2400

commit 82255f9bc4c4c3ad8d272924124ae1870b3e4353
Author: Andrew Morton <akpm@osdl.org>
Date:   Tue Apr 6 01:23:34 2004 -0400

    [PATCH] s2io.h: gcc-3.5 build fix
    
    In file included from drivers/net/s2io.c:68:
    drivers/net/s2io.h: In function `readq':
    drivers/net/s2io.h:757: error: invalid lvalue in assignment
    drivers/net/s2io.h:758: error: invalid lvalue in assignment

commit fdbf4502809ca984f34b1d4dfd67878eab590b74
Author: Andrew Morton <akpm@osdl.org>
Date:   Tue Apr 6 01:23:17 2004 -0400

    [PATCH] com20020-isa.c warning fix
    
    From: "Luiz Fernando N. Capitulino" <lcapitulino@prefeitura.sp.gov.br>
    
    drivers/net/arcnet/com20020-isa.c:188: warning: unused variable `dev'
    drivers/net/arcnet/com20020-isa.c:189: warning: unused variable `lp'

commit 6ad6ff6a08288e2557e74ed82eb4eaa4c83a93ab
Author: Scott Feldman <scott.feldman@intel.com>
Date:   Tue Apr 6 01:23:04 2004 -0400

    [PATCH] Update MAINTAINERS with new e100/e1000/ixgb maintainers
    
    Jeff, Adding John/Ganesh/Ayyappan for e100/e100/ixgb in 2.6.  Keeping
    myself on for e100 for a couple more 2.6.x releases.
    
    -scott

commit 5e281034586c525ea464516772b9b4cd63bbfbfd
Author: Jeff Garzik <jgarzik@redhat.com>
Date:   Tue Apr 6 01:22:46 2004 -0400

    [netdrvr natsemi] correct DP83816 IntrHoldoff register offset
    
    Spotted by Manfred Spraul.

commit 93eb7437d1e71ea9b22f5d67c3fc8dbc628f9005
Author: Jeff Garzik <jgarzik@redhat.com>
Date:   Tue Apr 6 01:22:30 2004 -0400

    [netdrvr 8139cp] better dev->close() handling, and misc related stuff
    
    * don't synchronize_irq() in cp_stop_hw().  when necessary, do so
      in the callers.
    * call synchronize_irq() in cp_close(), after releasing the spinlock.
    * move netif_stop_queue() and netif_carrier_off() calls inside lock
    * flush last interrupt status write, in cp_stop_hw()
    * add unlikely() check for dev==NULL, first thing in the irq handler

commit e3b0d4517570169158229f88ab96c7ff94bcaa23
Author: Jeff Garzik <jgarzik@redhat.com>
Date:   Tue Apr 6 01:22:17 2004 -0400

    [netdrvr 8139cp] complete 64-bit DMA (PCI DAC) support

commit 5b886e6a34d545f7be93ef6b7224bb75915aca53
Author: Jeff Garzik <jgarzik@redhat.com>
Date:   Tue Apr 6 01:22:05 2004 -0400

    [netdrvr 8139cp] use netdev_priv()

commit bbf59726bfa2587b58af6fb4d722fb42f1bdf3b0
Author: Jeff Garzik <jgarzik@redhat.com>
Date:   Tue Apr 6 01:21:53 2004 -0400

    [netdrvr 8139cp] minor cleanups
    
    * update version, copyright date
    * remove unportable "pci_dev->irq < 2" check in ->probe
    * don't use ioremap_nocache() without a real reason

commit 3b48524dac165ee5cdfde0acca51db3a1983249d
Author: Jeff Garzik <jgarzik@redhat.com>
Date:   Tue Apr 6 01:21:40 2004 -0400

    [NET] define HAVE_NETDEV_PRIV back-compat hook

commit 93751bd247c0672f1942da92bbbdcac26d023359
Author: Jeff Garzik <jgarzik@redhat.com>
Date:   Tue Apr 6 01:21:23 2004 -0400

    [netdrvr 8139cp] locking cleanups
    
    * s/spin_lock_irq/spin_lock_irqsave/ where it was simple and
      easy to verify.
    * release spinlock earlier in interrupt routine.

commit f5c1b335a52d274f6228fe818615df7028773307
Author: Jeff Garzik <jgarzik@redhat.com>
Date:   Tue Apr 6 01:21:10 2004 -0400

    [netdrvr s2io] NAPI build fixes

commit 96f9300355d6c5bbf657d6497468f5f899c016a8
Author: Jeff Garzik <jgarzik@redhat.com>
Date:   Tue Apr 6 01:20:43 2004 -0400

    [netdrvr 8139cp] rearrange priv struct, add cacheline-align markers
    
    suggested by Jes Sorensen.

commit f2f1383c8cf9f7bb2a64483dea3dafab0124e5ee
Author: Jeff Garzik <jgarzik@redhat.com>
Date:   Tue Apr 6 01:18:52 2004 -0400

    [net/fc iph5526] s/rx_dropped/tx_dropped/ in TX routines
    
    Spotted by Denis Valesko(sp?).
    
    Maybe one day we'll either kill this driver, or someone will fix it
    up for the current SCSI API.

commit 6726212da221dc2e16e090a100ced7f95e6ea302
Author: Daniel Ritz <daniel.ritz@gmx.ch>
Date:   Tue Apr 6 01:15:27 2004 -0400

    [PATCH] netdev_priv for xirc2ps_cs, nmclan_cs
    
    s/dev->priv/netdev_priv(dev)/ for xirc2ps_cs.c and nmclan_cs.c
    xircom one is tested. against 2.6.4-bk

commit 75cf9891e83531faf0e66cf3cf73617734b1fb3c
Author: Jeff Muizelaar <muizelaar@rogers.com>
Date:   Tue Apr 6 01:15:10 2004 -0400

    [PATCH] tc35815 cleanup

commit 3bcba88854d49163a90eb43b365f3a14d008d063
Author: Jeff Garzik <jgarzik@redhat.com>
Date:   Tue Apr 6 01:14:45 2004 -0400

    [netdrvr s2io] correct an incorrect cleanup I made

commit 0b19c1e53903f733c6c1beb6865ebb84b281344b
Author: Jeff Garzik <jgarzik@redhat.com>
Date:   Tue Apr 6 01:14:31 2004 -0400

    [netdrvr] Add S2IO 10gige network driver.
    
    Contributed by Leonid Grossman @ S2IO

commit 0f54bd34deebef3d74865f27ffaa9c786f953983
Author: Pavel Machek <pavel@ucw.cz>
Date:   Tue Apr 6 00:32:07 2004 -0400

    [PATCH] Support newer revisions of broadcoms in b44.c
    
    This adds support for newer revisions of the chips. The
    b44_disable_ints at the beggining actually kills machine with newer
    revision, but its removal has no ill effects.

commit f86225ee432e7d0ca8bd6cca78b0a48af7ef2d25
Author: Randy Dunlap <rddunlap@osdl.org>
Date:   Tue Apr 6 00:28:52 2004 -0400

    [PATCH] remove magic '31' for netdev priv. alignment
    
    [resend/rediff]
    
    // linux-2.6.5
    // remove magic number of '31' from net_device and private alignment;

commit 4bbf47f509d4715a36b95caf5987ff17d507ac4f
Author: Fran√ßois Romieu <romieu@fr.zoreil.com>
Date:   Tue Apr 6 00:21:48 2004 -0400

    [netdrvr r8169] TX irq handler looping fix
    
    If a few packets have been scheduled for Tx, it is possible to keep looping
    in the Tx irq handler as soon as the irq for the first packet has been
    received until the descriptor of the last packet has been sent (with
    interrupts disabled btw).

commit 14ef694031316784c7f59e99d22f8eb3d3175dea
Author: Fran√ßois Romieu <romieu@fr.zoreil.com>
Date:   Tue Apr 6 00:19:58 2004 -0400

    [netdrvr r8169] DAC changes:
    - Rx and Tx descriptors rings handled on 64 bit;
    - enable DAC through use of CPlusCmd register (reserved bits apart, this is
      similar to the 8139cp driver);
    - use the higher 32 bits of addresses for the Rx/Tx buffers.

commit 5a99bfde3e304c358854eedc87804ca590c2b247
Author: Fran√ßois Romieu <romieu@fr.zoreil.com>
Date:   Tue Apr 6 00:19:50 2004 -0400

    [netdrvr r8169] Barrier against compiler optimization.

commit b4bf4278d7a2c4e1408f0d2b29cce2c8bd58a89e
Author: Fran√ßois Romieu <romieu@fr.zoreil.com>
Date:   Tue Apr 6 00:19:42 2004 -0400

    [netdrvr r8169] ethtool driver info
    
    Author: Krishnakumar R. <krishnakumar@naturesoft.net>

commit 5097bc46a01b4069b2a780b429a21dfd0a873b7e
Author: Fran√ßois Romieu <romieu@fr.zoreil.com>
Date:   Tue Apr 6 00:19:34 2004 -0400

    [netdrvr r8169] DMA api resync.

commit 7d52d7e314e15b682ebf9110a8e940af335eaab3
Author: Randy Dunlap <rddunlap@osdl.org>
Date:   Tue Apr 6 00:18:03 2004 -0400

    [PATCH] lmc header file not needed
    
    From: Domen Puncer <domen@coderock.org>

commit 60bdd25e331edaa976101f271c2f24dfa7eb2410
Author: Randy Dunlap <rddunlap@osdl.org>
Date:   Tue Apr 6 00:15:58 2004 -0400

    [PATCH] dgrs: add missing iounmaps
    
    [resend]
    
    
    Insert missing iounmap's.
    
    From: Leana Ogasawara <ogasawara@osdl.org>

commit b342ada3661ca93becc7c8feaecfd2b709efde67
Merge: 196c4eb... ccae117...
Author: Jeff Garzik <jgarzik@redhat.com>
Date:   Tue Apr 6 00:09:25 2004 -0400

    Merge redhat.com:/spare/repo/linux-2.6
    into redhat.com:/spare/repo/netdev-2.6/r8169

commit 29494a46945f9beaa6673d90e1143eec17b5af5a
Author: Jeff Garzik <jgarzik@redhat.com>
Date:   Tue Apr 6 00:05:16 2004 -0400

    Remove unused compatibility-defines include wan/lmc/lmc_ver.h.
    
    Noticed by Adrian Bunk.

commit ba4ccb41caa7a64669b42448197becaf2071f336
Author: Don Fry <brazilnut@us.ibm.com>
Date:   Mon Apr 5 23:57:37 2004 -0400

    [PATCH] pcnet32 add led blink capability
    
    Please apply this patch to 2.6.5 to include the capability of blinking
    the LED's for device identification.  Ethtool -p support.

commit 071e776ad978490a6c36b4dac13b714f593fcf0d
Author: Don Fry <brazilnut@us.ibm.com>
Date:   Mon Apr 5 23:57:29 2004 -0400

    [PATCH] pcnet32 correct name display
    
    This displays the device name (eth%d) instead of the device type
    when registering the interrupt handler.

commit 68982a7754ea02874334cb27ef1a3ebd4776255e
Author: Don Fry <brazilnut@us.ibm.com>
Date:   Mon Apr 5 23:57:21 2004 -0400

    [PATCH] pcnet32 all printk under netif_msg
    
    Please apply the following patch to 2.6.5.
    
    All printk's are now done under netif_msg debug level tests.

commit 12a7807a31d3cae378f247dbf71408cba64037ad
Author: Don Fry <brazilnut@us.ibm.com>
Date:   Mon Apr 5 23:57:12 2004 -0400

    [PATCH] pcnet32.c add support for 79C976
    
    Please include this patch to add support for the 79C976 device to the
    pcnet32 driver.

commit 7191d7fe4788b549f0fa844ad3bb9f2cad89fc60
Merge: 321fe6f... bb3959c...
Author: David S. Miller <davem@nuts.davemloft.net>
Date:   Mon Apr 5 20:39:30 2004 -0700

    Merge http://linux-lksctp.bkbits.net/lksctp-2.5.work
    into nuts.davemloft.net:/disk1/BK/net-2.6

commit a4ccbdfac3be806c610948e326ad325635fb2f13
Author: Ben Collins <bcollins@debian.org>
Date:   Mon Apr 5 23:35:19 2004 -0400

    [IEEE-1394] Sync IEEE-1394 to r1203

commit 321fe6f8b00db387f7e05ed5be8d21fff028dbbb
Author: Sridhar Samudrala <sri@us.ibm.com>
Date:   Mon Apr 5 17:32:30 2004 -0700

    [SCTP] Use id to ptr translation service in lib/idr.c to assign and
    validate ids of associations.
    
    This patch avoids the use of virt_addr_valid() to validate the address
    of associations passed by the user. Currently the address of an
    association is used as its id. virt_addr_valid doesn't work as
    expected when PAGEALLOC debugging is enabled.

commit 8843177d413b1c59c57e78a6a55ea3099aca48ca
Author: Sridhar Samudrala <sri@us.ibm.com>
Date:   Mon Apr 5 17:24:04 2004 -0700

    [SCTP] Update sctp_ulpevent structure to include assoc pointer and
    only the receive specific fields of sctp_sndrcvinfo.

commit 813ef93d58851411f994208177e7a6699466e7ee
Author: Dave Jones <davej@redhat.com>
Date:   Tue Apr 6 01:15:07 2004 +0100

    [CPUFREQ] Indentation fix.

commit e002fb4b87340c9fd86d1e69ad924aea85b36801
Author: Dave Jones <davej@redhat.com>
Date:   Tue Apr 6 01:12:30 2004 +0100

    [CPUFREQ] Remove useless goto.
    (Pavel Machek)

commit 9cee74bc9c7b21f149c6040c0bd489f6ec3193ce
Author: Dave Jones <davej@redhat.com>
Date:   Tue Apr 6 01:06:18 2004 +0100

    [CPUFREQ] Grammar fix in p4-clockmod.c
    Noted by Viktor Radnai.

commit bc41a0e127f81144459de405a7546813a98f53b7
Author: Dave Jones <davej@redhat.com>
Date:   Tue Apr 6 01:03:33 2004 +0100

    [CPUFREQ] Fix up docbook parameters on x86 drivers.
    From Michael Still <mikal@stillhq.com>

commit 7b76295ac2a3582117c64aab89b0919b8ae06c70
Author: Hugh Dickins <hugh@com.rmk.(none)>
Date:   Tue Apr 6 00:31:45 2004 +0100

    [PATCH] make_coherent pgoff
    
    Patch from Hugh Dickins
    
    In wandering through the Linus 2.6 tree preparing for changeover of
    i_mmap and i_mmap_shared to Rajesh's prio tree for object-based rmap...
    I noticed that pgoff in make_coherent doesn't add up (plus, I think
    we need to mask out the word "don't" in the comment further down).
    2.4.25 looks equally wrong.

commit 8b042176e182ac66a9635a60ee140ac10837cd78
Author: Petri T. Koistinen <petri.koistinen@fi.rmk.(none)>
Date:   Tue Apr 6 00:22:34 2004 +0100

    [PATCH] update Compaq Personal Server URL
    
    Patch from Petri T. Koistinen
    
    Update of Compaq Personal Server URL.

commit ad6b01f25e9b0080bddc8d39d8112bca70faaaa3
Author: Russell King <rmk@flint.arm.linux.org.uk>
Date:   Tue Apr 6 00:17:46 2004 +0100

    [ARM] Add ecard_(request|release)_resources().

commit 8d71377014a6e07f08c47e4f29b87ed5a853e342
Author: Dave Jones <davej@redhat.com>
Date:   Mon Apr 5 22:08:47 2004 +0100

    [AGPGART] Previous AGPv3 SiS fixes broke AGPv2 users. Oops.

commit 44569f921728da9a01308278a2152b3ac1691f78
Author: Russell King <rmk@flint.arm.linux.org.uk>
Date:   Mon Apr 5 21:53:19 2004 +0100

    [ARM] Fix silent build error caused by undefined symbol.
    
    Current binutils silently ignores certain undefined symbols; this
    cset fixes one such instance.

commit e615be8975a68e40960f2cbb3a77b6b882c22842
Author: Dave Jones <davej@redhat.com>
Date:   Mon Apr 5 21:02:08 2004 +0100

    [CPUFREQ] Transmeta longrun driver fix.
    (From Stelian Pop)
    Upon investigation, the reason is that trying to set the performance
    to 80% in longrun_determine_freqs leaves the performance to 100%.
    The performance level, at least on this particular model, can be lowered
    only in 33% steps. And in order to put the performance to 66%, the
    code should try to set the barrier to 70%.
    
    The following patch does even more, it tries every value from 80%
    to 10% in 10% steps, until it succeeds in lowering the performance.
    I'm not sure this is the best way to do it but in any case,
    it works for me (and should continue to work for everybody else).

commit 3ddbbf30b67b47446132c61d4e5897172f76904b
Merge: 196c4eb... f1ca09a...
Author: Anton Altaparmakov <aia21@cantab.net>
Date:   Mon Apr 5 20:32:23 2004 +0100

    Merge cantab.net:/home/src/bklinux-2.6
    into cantab.net:/home/src/ntfs-2.6

commit 8bb5b4d68c2c9ff97e348a28dc63651943055a0a
Author: Marcel Holtmann <marcel@holtmann.org>
Date:   Mon Apr 5 19:50:57 2004 +0200

    [Bluetooth] Add UART protocol id's for 3-Wire and H4DS
    
    This patch adds the id's for the 3-Wire and H4DS UART transport protocols.

commit de831dd1d0d1261bad64bcfddb256ae1fddf5f85
Author: Sridhar Samudrala <sri@us.ibm.com>
Date:   Mon Apr 5 10:28:31 2004 -0700

    [SCTP] Fix typo in entry name of the remove_proc_entry() call.

commit e0abb6ddc2b06562d8b5d42f5701eb4c220f24f3
Author: Russell King <rmk@flint.arm.linux.org.uk>
Date:   Mon Apr 5 18:05:54 2004 +0100

    [ARM] Clean up formatting of s3c2410 help texts.

commit e1b1ea504a3e32ca1ae5baa87f36e26ae47c3b84
Author: Ben Dooks <ben-linux@org.rmk.(none)>
Date:   Mon Apr 5 18:01:52 2004 +0100

    [ARM PATCH] 1794/1: S3C2410 - arch/arm/kernel patches [ repost 1791/1 ]
    
    Patch from Ben Dooks
    
    arch/arm/kernel patch for S3C2410 support
    
     - default configurations for S3C2410
     - build changes for S3C2410
     - IRQ support for kernel entry
     - debug serial support

commit c7f195892034606a2dca1ca58106b0ed8a957029
Author: Ben Dooks <ben-linux@org.rmk.(none)>
Date:   Mon Apr 5 17:37:18 2004 +0100

    [ARM PATCH] 1792/1: S3C2410 - arch/arm/boot [ fix for 1789/1 ]
    
    Patch from Ben Dooks
    
    arch/arm/boot support for S3C2410
    
    support for boot (and debug) messages via EmbeddedICE (CP14)
    comms registers.
    
    fixed typos from 1789/1

commit 409e5c00369f17364df43bc4147250a7b67c61d7
Author: Steve French <stevef@steveft21.ltcsamba>
Date:   Mon Apr 5 11:34:11 2004 -0500

    Send NTCreateX with ATTR_POSIX if Linux/Unix extensions negotiated
    with server.  This allows files that differ only in case and
    improves performance of file creation and file open to such servers

commit 8a0997a0a2af63d1115c871874ae436d4fb6d66b
Author: Ben Dooks <ben-linux@org.rmk.(none)>
Date:   Mon Apr 5 16:59:51 2004 +0100

    [ARM PATCH] 1793/1: S3C2410 - arch/arm/mach-s3c2410 [ repost of 1790/1 ]
    
    Patch from Ben Dooks
    
    Core support for S3C2410 based machines
    
    machine support for Simtec BAST, VR1000 and
    IPAQ H1940
    
    repost of 1790/1 with configuration definition fixed

commit ae510d4c8fbfc21fdd7fcfa65d9116c6b3ec4700
Author: Ben Dooks <ben-linux@org.rmk.(none)>
Date:   Mon Apr 5 16:54:49 2004 +0100

    [ARM PATCH] 1788/1: SC2410 include/asm-arm/arch-s3c2410 [repost of 1778/1]
    
    Patch from Ben Dooks
    
    This patch is a repost of 1778/1 with the memory.h file fixed.
    
    
    
    This patch contains all the necessary include files for include/asm-arm/arch-s3c2410 for Samsing S3C2410 SoC CPU support.
    
    
    
    The patch also includes the support headers for IPAQ H1940, Simtec BAST and VR1000 board support.

commit d0a65087dbddf4be565b693c8f156b98151a38d0
Author: Marcel Holtmann <marcel@holtmann.org>
Date:   Mon Apr 5 15:36:39 2004 +0200

    [Bluetooth] Allocate hdev before device configuration
    
    The hdev structure must be allocated before the device is configured and
    before any interrupt is started.

commit 7b00dc76e18522fecc6c133fd9b46bbf2a5a065f
Author: Marcel Holtmann <marcel@holtmann.org>
Date:   Mon Apr 5 15:00:19 2004 +0200

    [Bluetooth] Fix broken HCI security filter
    
    The HCI security filter is broken on 64-bit architectures and this patch
    restores the version from 2.4, which is working perfect on 32-bit and
    64-bit machines.

commit e2a786731a0ceb852224bf83c008eed45e7b196d
Author: Marcel Holtmann <marcel@holtmann.org>
Date:   Mon Apr 5 14:51:15 2004 +0200

    [Bluetooth] Remove architecture specific compat ioctl's
    
    The compat ioctl definitions are now maintained in a single place, so
    it is no longer needed to keep the architecture specific defines. This
    patch removes the leftover Bluetooth parts from x86_64 and sparc64.

commit 200884c5f47bb64bdbfb16e1958a6cf326cd9c94
Merge: 16fe57c... ec6527c...
Author: Tom Rini <trini@kernel.crashing.org>
Date:   Mon Apr 5 02:39:24 2004 -0700

    Merge

commit ec6527c44c24e6a1108b7021ec636331d7945166
Merge: af077e5... 897ede6...
Author: Tom Rini <trini@kernel.crashing.org>
Date:   Mon Apr 5 02:36:56 2004 -0700

    Merge

commit e43784f3ba8b2ff27ea9a6316e0b5d6d27471755
Author: Randy Vinson <rvinson@linuxbox.(none)>
Date:   Mon Apr 5 01:33:28 2004 -0700

    Merge bk://linux.bkbits.net/linux-2.5
    into linuxbox.(none):/src/linux/ppc/linux-2.5/linux

commit bb3959cad40e7a5d97776ad891d0d85be689c0f4
Author: Randy Dunlap <rddunlap@osdl.org>
Date:   Mon Apr 5 01:23:03 2004 -0700

    [NET]: Update networking config menu (v3)
    
    Networking support/options and Networking drivers have been, uhm,
    messy to navigate for some time now.   BenH mentioned this
    and I was already looking into options to clean it up.
    
    This is a cleanup of Networking support/options and Networking Drivers.
    It presents a more consistent interface and lists similar driver
    groups and protocol groups closer together.
    It also moves the IBMVETH driver so that it no longer breaks the
    dependency tree, allowing other drivers (nearby in Kconfig file)
    to be presented in a more linear manner.

commit 56cb089070440707053a48654bcec533bd9e071c
Merge: 196c4eb... eab1031...
Author: David Mosberger <davidm@tiger.hpl.hp.com>
Date:   Mon Apr 5 00:59:55 2004 -0700

    Merge tiger.hpl.hp.com:/data1/bk/vanilla/linux-2.5
    into tiger.hpl.hp.com:/data1/bk/lia64/to-linus-2.5

commit 187df21ca2736fd1b95f00edcb9bb9f18fe8b75a
Author: Manfred Spraul <manfred@colorfullife.com>
Date:   Mon Apr 5 00:51:37 2004 -0700

    [NETLINK]: Split up netlink_unicast.

commit e99f19ab0ad947abab96a2baa5cae0e2df7afc01
Author: Shirley Ma <mashirle@us.ibm.com>
Date:   Mon Apr 5 00:42:00 2004 -0700

    [IPV6]: Provide ipv6 multicast/anycast addresses through netlink.

commit 45de4540a86bb7f32c38a8bd05617d74e8d644a3
Merge: 196c4eb... 72c19e1...
Author: Ben Collins <bcollins@debian.org>
Date:   Mon Apr 5 03:31:21 2004 -0400

    Merge http://linux.bkbits.net/linux-2.5
    into debian.org:/usr/src/kernel/ieee1394-2.6

commit eab103122fed0fee50cc4d2ba8fd885a331fed89
Author: Alex Williamson <alex.williamson@hp.com>
Date:   Mon Apr 5 00:22:54 2004 -0700

    [PATCH] ia64: setup max dma addr earlier on hp boxes
    
    sba_iommu was setting up MAX_DMA_ADDRESS way too late to do any
    good.  This patch makes it get setup via platform_setup, so it's ready
    for paging_init().  All pages should show up in zone DMA now.  Against
    latest 2.6.

commit 1ec5fa5c971bc9cd5df73ab1f48fb5c65311ee36
Author: Andreas Schwab <schwab@suse.de>
Date:   Mon Apr 5 00:16:59 2004 -0700

    [PATCH] ia64: Missing include in hugetlbpage.c
    
    This fixes a missing include file in arch/ia64/mm/hugetlbpage.c in 2.6.5.
    module.h is needed for EXPORT_SYMBOL.

commit 9298163f20a7f4e16b9378ec78fca88d54ee84c6
Author: Andreas Schwab <schwab@suse.de>
Date:   Mon Apr 5 00:14:15 2004 -0700

    [PATCH] ia64: Missing overflow check in mmap
    
    Calling mmap with len == -1 was silently accepted.  The test in the generic
    code was fixed in July 2003, but the fix didn't make it into the ia64-
    specific code.

commit d5925c48c7428c0901f07cff720d54d26b26dc84
Author: Nicolas Pitre <nico@org.rmk.(none)>
Date:   Mon Apr 5 00:34:25 2004 +0100

    [ARM PATCH] 1783/1: more PXA reg definitions
    
    Patch from Nicolas Pitre

commit 8d8c166f7d6e74f302c5fc23103d56072ff5202a
Author: Nicolas Pitre <nico@org.rmk.(none)>
Date:   Mon Apr 5 00:08:18 2004 +0100

    [ARM PATCH] 1782/1: discontigmem support for PXA chips
    
    Patch from Nicolas Pitre

commit aa617bb48f67805bf8f9d850f9199f2ae0215ab7
Merge: 196c4eb... c2ab0b0...
Author: Jeff Garzik <jgarzik@redhat.com>
Date:   Sun Apr 4 16:02:12 2004 -0400

    Merge redhat.com:/spare/repo/linux-2.6
    into redhat.com:/spare/repo/misc-2.6

commit da0cefc8bd2c4cca011bceffea23d8e80c38ebaa
Merge: 566ab95... 196c4eb...
Author: Jeff Garzik <jgarzik@redhat.com>
Date:   Sun Apr 4 15:58:58 2004 -0400

    Merge redhat.com:/spare/repo/linux-2.6
    into redhat.com:/spare/repo/libata-2.6

commit 536222bcb91b95f1d0c9399af5f49b260274c45a
Merge: 196c4eb... 81506a2...
Author: David S. Miller <davem@nuts.davemloft.net>
Date:   Sun Apr 4 10:07:13 2004 -0700

    Merge nuts.davemloft.net:/disk1/BK/sparcwork-2.6
    into nuts.davemloft.net:/disk1/BK/sparc-2.6

commit e47da815d0914bc2ccb5af1bf50144c1694f9af9
Merge: 196c4eb... b92e4f8...
Author: Keith M. Wesolowski <wesolows@foobazco.org>
Date:   Sun Apr 4 08:43:19 2004 -0700

    Merge foobazco.org:/sources/2.5-bk
    into foobazco.org:/sources/2.5-sparc-todave

commit e96c4c633cfbe2b777a3066a8c76d09c459a1e34
Author: Tony Lindgren <tony@com.rmk.(none)>
Date:   Sun Apr 4 15:40:31 2004 +0100

    [ARM PATCH] 1781/1: Add TI OMAP support, arch files
    
    Patch from Tony Lindgren
    
    This patch adds the arch files for Texas Instruments OMAP-1510 and
    1610 processors.
    
    OMAP is an embedded ARM processor with integrated DSP.
    
    OMAP-1610 has hardware support for USB OTG, which might be of interest
    to Linux developers. OMAP-1610 could be easily be used as development
    platform to add USB OTG support to Linux.
    
    This patch is an updated version of patch 1769/1 with Russell King's
    comments fixed. This patch requires patch 1777/1 applied.
    
    This patch is brought to you by various linux-omap developers.

commit ca927387a577ec748f0c2fe4cc4dfb456f370f08
Author: Tony Lindgren <tony@com.rmk.(none)>
Date:   Sun Apr 4 15:36:50 2004 +0100

    [ARM PATCH] 1780/1: Add TI OMAP support, include files
    
    Patch from Tony Lindgren
    
    This patch adds the include files for Texas Instruments OMAP-1510 and
    1610 processors.
    
    OMAP is an embedded ARM processor with integrated DSP.
    
    OMAP-1610 has hardware support for USB OTG, which might be of interest
    to Linux developers. OMAP-1610 could be easily be used as development
    platform to add USB OTG support to Linux.
    
    This patch is an updated version of patch 1768/1 with Russell King's
    comments fixed. This patch requires patch 1777/1 applied.
    
    This patch is brought to you by various linux-omap developers.

commit 58486ae8bc6f3f3fb290952962745b8b81bb24c9
Author: Tony Lindgren <tony@com.rmk.(none)>
Date:   Sun Apr 4 15:32:38 2004 +0100

    [ARM PATCH] 1777/1: Add TI OMAP support to ARM core files
    
    Patch from Tony Lindgren
    
    This patch updates the ARM Linux core files to add support for
    Texas Instruments OMAP-1510, 1610, and 730 processors.
    
    OMAP is an embedded ARM processor with integrated DSP.
    
    OMAP-1610 has hardware support for USB OTG, which might be of interest
    to Linux developers. OMAP-1610 could be easily be used as development
    platform to add USB OTG support to Linux.
    
    This patch is an updated version of an earlier patch 1767/1
    with the dummy Kconfig added for OMAP as suggested by Russell King
    here:
    
    http://www.arm.linux.org.uk/developer/patches/viewpatch.php?id=1767/1
    
    This patch is brought to you by various linux-omap developers.

commit 05b649fb2ecf2d7f26e22566b39574d45177d482
Author: Matthew Wilcox <willy@debian.org>
Date:   Sun Apr 4 01:13:38 2004 -0500

    [PATCH] sym 2.1.18j
    
    sym 2.1.18j:
     - Add SPI transport attributes (James Bottomley)
     - Use generic code to do Domain Validation (James Bottomley)
     - Stop using scsi_to_pci_dma_dir() (Christoph Hellwig)
     - Change some constants to their symbolic names (Grant Grundler)
     - Handle a race between a postponed command completing and the EH retrying
       it (James Bottomley)
     - If the auto request sense fails, issue a device reset (James Bottomley)

commit be71c730ca3066d4e898b4794dfb3c7010758095
Author: James Bottomley <jejb@mulgrave.(none)>
Date:   Sun Apr 4 00:01:28 2004 -0500

    Fix scsi_device_get to allow NULL devices
    
    Modification of patch from SLES-9

commit 8378b9c6b97c703296d93072741b4e57354e8c37
Author: Kurt Garloff <garloff@suse.de>
Date:   Sat Apr 3 23:57:01 2004 -0500

    [PATCH] SCSI sense buffer size -> 96
    
    some SCSI devices need more than 64bytes of sense buffer.
    I know about one: The IBM MagStar tapes report the necessity to be
    cleaned at bytes 70 and report 96 bytes in total.
    
    Attached patch increases the sense buffer size to 96 bytes.

commit f0cc009ede0af6410a8d98a67946e5c9ef7a527f
Merge: 082e21d... 196c4eb...
Author: Steve French <cifs.adm@hostme.bitkeeper.com>
Date:   Sat Apr 3 15:41:40 2004 -0700

    Merge bk://linux.bkbits.net/linux-2.5
    into hostme.bitkeeper.com:/repos/c/cifs/linux-2.5cifs

commit 81506a2945389b6a5ed230215dad37df8433ec6d
Author: David S. Miller <davem@nuts.davemloft.net>
Date:   Sat Apr 3 04:32:58 2004 -0800

    [SPARC64]: hugetlbpage.c needs module.h

commit d0bf0688b8a803c5ba2c99fe4a257998382e9dce
Merge: 6a9f6b3... a705421...
Author: David S. Miller <davem@nuts.davemloft.net>
Date:   Sat Apr 3 04:06:01 2004 -0800

    Merge nuts.davemloft.net:/disk1/BK/sparcwork-2.6
    into nuts.davemloft.net:/disk1/BK/sparc-2.6

commit a7054210fc6cbc4cd185d04f2087006f802f534c
Author: Eric Brower <ebrower@usa.net>
Date:   Fri Apr 2 22:43:21 2004 -0800

    [SPARC]: Add sysctl to control serial console power-off restrictions.

commit a3413be49a51fcd58a9dd248c14dbbbeb37b5a12
Author: Shirley Ma <mashirle@us.ibm.com>
Date:   Fri Apr 2 22:30:00 2004 -0800

    [IPV6]: Add MIBs counters in MLD.

commit 0a4a1881352ffe38a2d676e038a559fced578802
Author: David S. Miller <davem@nuts.davemloft.net>
Date:   Fri Apr 2 21:20:34 2004 -0800

    [TG3]: Update driver version and release date.

commit 0e9ead5a2b65306c8dfe3a6c3144d8f1d465bea4
Author: David S. Miller <davem@nuts.davemloft.net>
Date:   Fri Apr 2 21:19:11 2004 -0800

    [TG3]: Reset fixes.
    
    - Put more code into common area in tg3_chip_reset()
    - Set GRC_MODE, even sanes host-stackup bit, after enabling
      memory arbiter.
    - After every core-clock reset, reprobe ASF enabling state.

commit 8ed27151f1c2c64a9409da47df19449c7052e9a4
Author: David S. Miller <davem@nuts.davemloft.net>
Date:   Fri Apr 2 20:25:29 2004 -0800

    [TG3]: Kill uninitialized var warning.

commit a9c0b26469f9667e9b289cc9638a23713228e83d
Author: David S. Miller <davem@nuts.davemloft.net>
Date:   Fri Apr 2 20:20:33 2004 -0800

    [TG3]: Two PHY fixes.
    
    - Do not probe PHY ID register if ASF firmware is running.
    - Fix two errors in PCI subsys to PHY ID table.

commit 87aee134dbe3e57f2401132698ba25203e5d707b
Author: David S. Miller <davem@nuts.davemloft.net>
Date:   Fri Apr 2 08:26:27 2004 -0800

    [TG3]: Print list of important probed capabilities at driver load.

commit 7d613cdaef36106a6e05d6f7e92f36e175ed8212
Author: James Bottomley <james.bottomley@steeleye.com>
Date:   Fri Apr 2 09:58:50 2004 -0500

    [PATCH] sd_shutdown cannot be called when in state SDEV_DEL
    
    sd_remove calls sd_shutdown to finish I/O to the disc.  However, the
    state model puts the device in SDEV_DEL before triggering the
    sd_remove (which won't allow any further I/O at all).
    
    Fix by making SDEV_CANCEL the intermediate state and only transitioning to
    SDEV_DEL after calling device_del().

commit 234658da41d1b16312f7d04f0a0acc001a09e180
Author: Dave Jones <davej@redhat.com>
Date:   Fri Apr 2 14:08:24 2004 +0100

    [CPUFREQ] powernow-k8 SMP work part 2.
    Introduce a per-cpu powernow_k8_data struct, and pass it around between all
    the functions that need to know about it.

commit cc1eeac9a3b3325d4707d904c97e0bf97c239e1c
Author: Dave Jones <davej@redhat.com>
Date:   Fri Apr 2 13:07:05 2004 +0100

    [CPUFREQ] Step 1 of SMP support for powernow-k8.
    Move lots of code to the cpu init routine from the detection routine.
    Do some SMP sanity checks in the detection routine.

commit a1415c9e4ed85908e5f330a505d0cbb8e9747994
Author: Dave Jones <davej@redhat.com>
Date:   Fri Apr 2 12:44:51 2004 +0100

    [AGPGART] EM64T driver should only run when we have a supported CPU.
    Otherwise we see strange things at boottime if we compile in all drivers, like this..
    
    agpgart: Unsupported Intel chipset (device id: 1a30)
    agpgart: Detected an Intel i845 Chipset.

commit 082e21d6ce39ae593ac3a1aad2a0fc6682fb02e6
Merge: 86dfc40... b389cca...
Author: Steve French <stevef@stevef95.austin.ibm.com>
Date:   Fri Apr 2 05:11:36 2004 -0600

    Merge bk://cifs.bkbits.net/linux-2.5cifs
    into stevef95.austin.ibm.com:/usr/src/bk/linux-2.5cifs

commit 86dfc40605c2f8ed6b28be2299c375d6dc437f54
Author: Steve French <stevef@stevef95.austin.ibm.com>
Date:   Fri Apr 2 04:54:19 2004 -0600

    Invalidate readahead data properly when file closed, but other client changed it on server

commit b92e4f815d49cd0f364fd9d0724c2a709d565f7d
Author: Keith M. Wesolowski <wesolows@foobazco.org>
Date:   Fri Apr 2 02:30:51 2004 -0800

    [SPARC32]: Fix wraparound bug in bitmap allocator

commit 16fe57cb60c50e8e9734c908f73ae05275bcd0ea
Author: Randy Vinson <rvinson@linuxbox.(none)>
Date:   Fri Apr 2 02:10:26 2004 -0700

    Updating mcpn765 for 2.6

commit 566ab95da8f9e63010bf8a049d789c8f7d3d37e3
Merge: 23bb8b3... d23a01c...
Author: Jeff Garzik <jgarzik@redhat.com>
Date:   Fri Apr 2 03:23:04 2004 -0500

    Merge redhat.com:/spare/repo/linux-2.6
    into redhat.com:/spare/repo/libata-2.6

commit b389cca8f5b1209c9ce84b88780b30f36dbacd3a
Merge: b10c497... 9be7dd1...
Author: Steve French <cifs.adm@hostme.bitkeeper.com>
Date:   Thu Apr 1 21:50:54 2004 -0800

    Merge bk://linux.bkbits.net/linux-2.5
    into hostme.bitkeeper.com:/repos/c/cifs/linux-2.5cifs

commit 9656974be8b4ecb3a480536ec25b50f19df15109
Author: David Brownell <david-b@pacbell.net>
Date:   Thu Apr 1 20:23:30 2004 -0800

    [PATCH] USB: usbcore blinkenlights
    
    The per-port LEDs on the most USB 2.0 hubs are programmable.
    And the USB spec describes some ways to use them, blinking
    to alert users about hardware (amber) or software (green)
    problems.
    
    This patch is the infrastructure for that blinking.  And
    if you should happen to "modprobe usbcore blinkenlights",
    the LEDs will cycle through all the ports ... which is
    not a USB-standard mode, but it can certainly handy be
    handy as a system heartbeat visible across the room.

commit 11eff1d6fc1da5c7d66938f3184bd7ae910a7cc0
Author: Patrick Mochel <mochel@digitalimplant.org>
Date:   Thu Apr 1 19:05:14 2004 -0800

    [PATCH] I2C: Fix check for DEBUG in i2c-ali1563

commit 7c45e25cf8527bf4bb34bb22f1e2df7fd8c4d011
Author: Patrick Mochel <mochel@digitalimplant.org>
Date:   Thu Apr 1 19:03:04 2004 -0800

    [PATCH] I2C: Add ALi 1563 i2c driver
    
    The i2c interface on the 1563 is totally different than on both the 1533
    and the 1535. It supports i2c 2.0, and happens to be nearly identical to
    the interface on the i810 chipsets.

commit d8ff2b7fe9e1818c2d3ee4855cdfbf2bd1a1d3f3
Author: Patrick Mochel <mochel@digitalimplant.org>
Date:   Thu Apr 1 19:02:40 2004 -0800

    [PATCH] I2C: Add support for the ALi 1563 in the PCI IRQ routing code.

commit bb883e7c039fa5acc903c925de878b76c960eca6
Author: Patrick Mochel <mochel@digitalimplant.org>
Date:   Thu Apr 1 19:02:14 2004 -0800

    [PATCH] I2C: Add ALi 1563 Device ID to pci_ids.h

commit 2dd5477c9c7ba84825447f6598336865b354801c
Author: Dave Jones <davej@redhat.com>
Date:   Fri Apr 2 03:42:56 2004 +0100

    [AGPGART] Actually Call the SiS workaround on SiS 746 too.

commit dd7a61c899044ea15a8d01c2a3aad6653921a706
Author: Dave Jones <davej@redhat.com>
Date:   Fri Apr 2 03:06:07 2004 +0100

    [CPUFREQ] powernow-k8 whitespace changes.
    Trying to get the diffsize down between me & Pavel.

commit c8b17776b82ba924d210b72194a0eedaaf7b52c5
Author: David Brownell <david-b@pacbell.net>
Date:   Thu Apr 1 17:57:49 2004 -0800

    [PATCH] USB Gadget: ethernet/rndis gadget updates
    
    This fixes an oops during "ifconfig usb0 down" after unplug
    from a Windows box.  It also shrinks the driver size to something
    much more reasonable by leaving out debug messaging, and adds
    a few missing newlines.

commit f1a40c850b54a213bd746f91bd7c92786fc744ed
Author: David Brownell <david-b@pacbell.net>
Date:   Thu Apr 1 17:56:28 2004 -0800

    [PATCH] USB: ehci updates:  CONFIG_PCI, integrated TT
    
    Generalize the driver a bit:
    
     - PCI-specific handling is restricted to a small chunk of
       init code.  Non-PCI implementations are in the pipeline.
    
     - Merge support from ARC International (Craig Nadler) for
       their integrated root hub transaction translators (on PCI).
       Other implementations should be similar.

commit 9ed7ef7dc26552b6dca26e2d613f18dc4e8e8555
Author: Dave Jones <davej@redhat.com>
Date:   Fri Apr 2 02:29:20 2004 +0100

    [CPUFREQ] fix compilation of speedstep-lib with DEBUG set

commit 1289da2dd1c706c91c37e623020354b0ede72a02
Author: Dave Jones <davej@redhat.com>
Date:   Thu Apr 1 23:27:11 2004 +0100

    [CPUFREQ] Various updates/fixes to the powernow-k8 comment header.

commit 945a3d285f4b8f0ecb1d6383b7dd86b2cea5e3ad
Merge: 96531b3... 1197daf...
Author: Dave Jones <davej@delerium.codemonkey.org.uk>
Date:   Thu Apr 1 23:10:44 2004 +0100

    Merge delerium.codemonkey.org.uk:/mnt/nfs/sepia/bar/src/kernel/2.6/trees/bk-linus
    into delerium.codemonkey.org.uk:/mnt/nfs/sepia/bar/src/kernel/2.6/trees/cpufreq

commit 03248a76f6778168f2247f0b7ea3970b2e153e8d
Author: Dave Jones <davej@redhat.com>
Date:   Thu Apr 1 21:27:38 2004 +0100

    [AGPGART] Fix SiS workaround printk. This happens on multiple chipsets.

commit bc89086fb374913ae24c1273a3a059621d6cbf1b
Author: Dave Jones <davej@redhat.com>
Date:   Thu Apr 1 21:12:53 2004 +0100

    [AGPGART] SiS 746 chipset also needs extra recovery time when changing mode.

commit 87e7635338c3b09e5ae7e177820780b6562611ab
Merge: 96531b3... 0c18ee9...
Author: Dave Jones <davej@delerium.codemonkey.org.uk>
Date:   Thu Apr 1 20:59:24 2004 +0100

    Merge delerium.codemonkey.org.uk:/mnt/nfs/sepia/bar/src/kernel/2.6/trees/bk-linus
    into delerium.codemonkey.org.uk:/mnt/nfs/sepia/bar/src/kernel/2.6/trees/agpgart

commit 0c18ee95bae7a169ca73791f293f3127b1aa5ca5
Author: Dave Jones <davej@redhat.com>
Date:   Thu Apr 1 19:49:08 2004 +0100

    [AGPGART] Efficeon GART driver can use generic masking routine.

commit 3b540abcfd9e6e632d9d77739bedbf7a7963bb79
Author: Dave Jones <davej@redhat.com>
Date:   Thu Apr 1 19:34:57 2004 +0100

    [AGPGART] VIA GART driver can use the new generic AGPv3 masks.

commit f1ca09a66aeafb6802cf22e9d06db5aef6becfa3
Merge: 96531b3... 5fa5084...
Author: Anton Altaparmakov <aia21@cantab.net>
Date:   Thu Apr 1 18:45:34 2004 +0100

    Merge cantab.net:/home/src/bklinux-2.6
    into cantab.net:/home/src/ntfs-2.6

commit fd3282b142287df47757a8e8b3b21f7466064169
Author: Steve French <stevef@stevef95.austin.ibm.com>
Date:   Thu Apr 1 06:39:11 2004 -0600

    Add missing description about how to specify credentials file

commit 0c5d6e19bd354e24e88b29be267ec199c20b84ce
Author: Jesse Barnes <jbarnes@sgi.com>
Date:   Thu Apr 1 02:19:32 2004 -0800

    [PATCH] ia64: bring ia64 nodes online properly
    
    Andi's libnuma exposed the fact that we don't bring nodes online
    properly as we discover them in ia64.  Here's a quick patch to fix
    that.  Tested with Andi's numademo program; seems to work fine.

commit 3978f15149178beccb5482a4422f29dfaadd75ca
Author: David S. Miller <davem@nuts.davemloft.net>
Date:   Wed Mar 31 22:21:37 2004 -0800

    [TG3]: Bump driver version and reldate.

commit cdcb0f4540109e6af4ccc8931d6d9f191c3daea3
Author: David S. Miller <davem@nuts.davemloft.net>
Date:   Wed Mar 31 22:19:26 2004 -0800

    [TG3]: More PHY programming fixes.
    
    - Break out advertisement register verification into
      a function, tg3_copper_is_advertising_all.
    - At device probe time, reset PHY if not Serdes
      and ASF is not enabled.
    - Add some missing necessary PHY init to PHY probe
      code as well.

commit d68313cad0a65e700b9615b132b6dd4582cbd8a4
Author: Stephen Hemminger <shemminger@osdl.org>
Date:   Wed Mar 31 22:12:40 2004 -0800

    [BRIDGE]: Correctly handle up to 256 ports per bridge.
    
    Bridge code is limited to 256 ports per bridge because the Spanning
    Tree Protocol has limit of one octet for port number.  This code
    fixes:
    	* bogus unlock in error path when port list is full.
    	* passes different error status for out of memory, vs
    	  port list full.
    	* O(n) vs O(n^2) lookup for free port number
    	* since port and priority are both limited to one byte
    	  don't store them as int's
    	* makes limit explicit in code

commit 0e981847b3953b5ed07363b8bdc9d562541c532b
Author: Stephen Hemminger <shemminger@osdl.org>
Date:   Wed Mar 31 21:48:59 2004 -0800

    [BRIDGE]: Lift ioctl limits on number of bridges/ports.
    
    Get rid of some arbitrary API restrictions that limit the kernel
    to 64 bridges and 256 ports.
    
    Retain compatibility in GET_PORT_LIST, the existing bridge API
    passes 0 for the third argument, and expects 256 entries.
    
    Note: there still is limit of 256 ports due to STP, but this
    shouldn't show up in the API, it needs to be handled by the
    'add port to bridge ioctl'.

commit 175aee812e515c663eab02d795e9d2bc47ce4371
Author: David S. Miller <davem@nuts.davemloft.net>
Date:   Wed Mar 31 21:47:12 2004 -0800

    [TG3]: All 5705 chips need PHY reset on link-down.

commit 0c2b1878122582f85e683f7907024975aeba2001
Author: Stephen Hemminger <shemminger@osdl.org>
Date:   Wed Mar 31 21:37:15 2004 -0800

    [BRIDGE]: Allow non-root to inspect the status of a bridge.

commit a4b18f43c67878f67c318df8080b4fa7c74f29bf
Author: David Stevens <dlstevens@us.ibm.com>
Date:   Wed Mar 31 19:49:08 2004 -0800

    [IPV4]: Fix IGMP version number and timer printing for procfs.

commit ba4e814353f7e4459fa39901c70d89ae64511018
Author: Pat Gefre <pfg@sgi.com>
Date:   Wed Mar 31 19:35:06 2004 -0800

    [PATCH] ia64: small SN2 interface.c patch
    
    Change the calls to link_path_walk() to path_walk().  link_path_walk()
    doesn't initialze current->total_link_count and path_walk() does.
    Without the initialization, path_walks start to fail when 40 sym links
    have been followed.

commit 14973a3bb7ccf6fb7ba5b7ef8222bae6a9f65c4f
Author: Jesse Barnes <jbarnes@sgi.com>
Date:   Wed Mar 31 19:33:07 2004 -0800

    [PATCH] ia64: fix sn_serial warning
    
    In my fixes to quiet the sn_serial driver, I made sn_debug_printf only
    get used when the DEBUG define was turned on in the driver but forgot
    to #ifdef out the function definition, causing an 'defined but not
    used' warning.  This patch fixes that.

commit 59ae4b687d8b86df770410320084a81caab6a6ac
Author: Jesse Barnes <jbarnes@sgi.com>
Date:   Wed Mar 31 19:32:25 2004 -0800

    [PATCH] ia64: clean up pcibr_slot.c warnings
    
    A few warnings crept into pcibr_slot.c that this patch takes care of.
      - forward declare pcibr_slot_pwr so it can be used w/o warning
      - fix argument passed to pcibr_slot_attach in pcibr_slot_enable

commit a06704cdb5160b5b8da2f975e68febe64d4a05cd
Author: David S. Miller <davem@nuts.davemloft.net>
Date:   Wed Mar 31 19:31:09 2004 -0800

    [TG3]: Verify link advertisement correctly on 10/100 only chips.

commit 897ede65a05f29ce72917cd07d61e37443e5383e
Merge: 96531b3... 9bf81ea...
Author: Tom Rini <trini@kernel.crashing.org>
Date:   Wed Mar 31 19:39:27 2004 -0700

    Merge kernel.crashing.org:/home/trini/work/kernel/pristine/linux-2.6
    into kernel.crashing.org:/home/trini/work/kernel/pristine/for-linus-ppc

commit ef2f800dfedfc23b80f15501a4534d50aa735c43
Author: Michal Ludvig <mludvig@suse.cz>
Date:   Wed Mar 31 18:38:01 2004 -0800

    [AF_KEY]: pfkey_send_new_mapping marks dest address incorrectly.

commit 9bf81eaa58bfd8894c2abc6e51385212f4b0735e
Merge: 1edcedd... a70fdf2...
Author: Tom Rini <trini@kernel.crashing.org>
Date:   Wed Mar 31 18:17:03 2004 -0700

    Merge kernel.crashing.org:/home/trini/work/kernel/pristine/linux-2.6
    into kernel.crashing.org:/home/trini/work/kernel/pristine/for-linus-ppc

commit e180d34ffd4aab0859cabbe8a0f0c281deb44300
Author: Stephen Hemminger <shemminger@osdl.org>
Date:   Wed Mar 31 07:09:40 2004 -0800

    [NET]: Mark lock_sock and release_sock as FASTCALL.

commit de706cdbfcc584490e7e3d101c1ce16bb2a36b3e
Author: James Bottomley <jejb@mulgrave.(none)>
Date:   Wed Mar 31 07:32:58 2004 -0500

    SCSI: Updates to non-sector size completion calculations
    
    From: Jens Axboe <axboe@suse.de>, Mike Christie <mikenc@us.ibm.com>

commit af077e547c9ec2f355bbecc2977e5634e0e02eac
Author: Randy Vinson <rvinson@linuxbox.(none)>
Date:   Wed Mar 31 02:53:24 2004 -0700

    Renaming pplus_common.c to hawk_common.c to match gt64260_common.c, etc, plus minor
    cleanups.

commit 23bb8b36bae8b4a2e31a24e58869b1a9d4982290
Author: Jeff Garzik <jgarzik@redhat.com>
Date:   Wed Mar 31 04:51:55 2004 -0500

    [libata sata_via] Fix detection of device 1
    
    VIA hardware thinks port 1 (second port) is "SATA primary slave".
    Since the hardware rarely configures SATA to present as slave devices,
    we must pretend that the second hardware port (as the user sees it)
    is the third port (as the VIA PCI config registers see it).

commit 0458380fa71e15db229489cda1014a4376e2688b
Author: Art Haas <ahaas@airmail.net>
Date:   Tue Mar 30 23:20:21 2004 -0800

    [SPARC]: Add C99 initializers to Sparc frame buffer devices.

commit cdf1a041e82818823d0a819c54adc851a779953b
Author: Linda Xie <lxiep@ltcfwd.linux.ibm.com>
Date:   Tue Mar 30 23:20:20 2004 -0800

    [PATCH] kobject_set_name() doesn't allocate enough space

commit 6e302b79611f23f4581e4a6e976a47b5eff636c4
Author: Deepak Saxena <dsaxena@plexity.net>
Date:   Tue Mar 30 22:57:52 2004 -0800

    [PATCH] PCI: Allow arch-specific pci_set_dma_mask and friends
    
    The patch provides the ability for architectures to have custom
    implementations of pci_set_dma_mask() and friends (dac_set_dma_mask
    and set_consistent_dma_mask). The reason I need this is b/c I have
    a chipset (Intel ARM IXP425) that has a broken PCI interface that
    only allows PCI dma to/from the bottom 64MB of system memory.  To get
    around this limitation, I trap a custom dma-mapping implementation that
    bounces buffers outside the 64MB window. At device discover time, my
    custom platform_notify() function gets called and it sets the dma_mask
    to (64MB-1) and in ARM's dma-mapping code, I check for dma_mask != 0xffffffff
    and if that is true, I call the special bounce helpers. This works great
    except that certain drivers (e100, ide-pci) call pci_set_dma_mask()
    with 0xffffffff and the generic implementation only allows for the
    architecture-defined pci_dma_supported() to return true or false. There
    is no method for the architecture to tell the PCI layer "I can't set
    the mask to 0xffffffff, but I can set it to this other value" and there
    is no way to pass that back to the driver. What this means is that if
    I have pci_set_dma_supported() return failure on full 32-bit DMA, the
    driver will not initialize the card; however, if I return true,
    pci_set_dma_mask() will set the dma mask to full 32-bits and I can no
    longer trap and will have buffers that are not dma-able and cause
    PCI master aborts.  Both of those are not acceptable.  IMHO, the
    driver shouldn't care if the architecture has to bounce DMA outside of
    64MB and since this is not something most architectures have to worry
    about, the easiest way to get around the issue is by allowing custom
    pci_set_dma_mask() for arches that need it but keeping the generic
    implementation for those that do not.  In my case, it simply returns
    0 to the driver but keeps the device mask set to 64MB-1 so I can trap.

commit e09e044ad6881bca6ef35a03d94ed4cbd347e805
Author: John Rose <johnrose@austin.ibm.com>
Date:   Tue Mar 30 22:55:47 2004 -0800

    [PATCH] PCI Hotplug: RPA PCI Hotplug - redundant free
    
    Please commit the following patch, which removes a redundant call to a
    cleanup function from an error path of the module init code.

commit 7553ed4648625568bb677f82ba10e9c0a64b250f
Author: Randy Dunlap <rddunlap@osdl.org>
Date:   Tue Mar 30 22:53:59 2004 -0800

    [PATCH] PCI: move DMA_nnBIT_MASK to linux/dma-mapping.h

commit 15fea3dbabbdc084b086a88d03d5ce1f0e666ef7
Merge: 96531b3... 622d3e6...
Author: Greg Kroah-Hartman <greg@kroah.com>
Date:   Tue Mar 30 22:27:14 2004 -0800

    Merge kroah.com:/home/greg/linux/BK/bleed-2.6
    into kroah.com:/home/greg/linux/BK/usb-2.6

commit 622d3e6b0db6e4c6fc97a7e02627148176674d76
Author: Greg Kroah-Hartman <greg@kroah.com>
Date:   Tue Mar 30 22:17:38 2004 -0800

    USB: add usb_get_intf() and usb_put_intf() functions as they will be needed.

commit 4bf49ce4fde820e3dc67ec358c3d982d3cfbc85e
Author: Greg Kroah-Hartman <greg@kroah.com>
Date:   Tue Mar 30 22:08:01 2004 -0800

    USB: clean up usb_get_dev() as it was written quite horribly.

commit 932e04503fd457f1f46406377714b15e87cc9dad
Author: David S. Miller <davem@nuts.davemloft.net>
Date:   Tue Mar 30 22:05:58 2004 -0800

    [TG3]: Wait a bit for BMSR/BMCR bits to settle in PHY setup.

commit ec6dfadbc7f3770381bef2e6b8f7415622b1bffa
Author: David S. Miller <davem@nuts.davemloft.net>
Date:   Tue Mar 30 21:56:46 2004 -0800

    [TG3]: When link is down, set stats coalescing ticks to zero.

commit 9188a5cf6bee5c133e99a99692fe26c68c73ae3e
Author: David S. Miller <davem@nuts.davemloft.net>
Date:   Tue Mar 30 21:50:19 2004 -0800

    [TG3]: Fix serdes cfg programming on 5704.

commit 3ccbb87c83a53639cde9d14854b4976b0fe9e021
Author: Greg Kroah-Hartman <greg@kroah.com>
Date:   Tue Mar 30 21:46:06 2004 -0800

    USB: remove "released" field from struct usb_interface as it is not needed.

commit 8d01d75f9bf2cab5dc1480920ff922aa6b02834a
Author: David S. Miller <davem@nuts.davemloft.net>
Date:   Tue Mar 30 21:35:13 2004 -0800

    [TG3]: Set GRC_MISC_CFG prescaler more safely.

commit e0d47b758e7645993c24c9ebe967c4735b9f0741
Author: David Brownell <david-b@pacbell.net>
Date:   Tue Mar 30 21:35:04 2004 -0800

    [PATCH] USB: remove usb_interface.driver field
    
    Remove usb_interface.driver, and along with it the "half bound" state
    previously associated with drivers binding with claim() instead of probe().
    This changes usb_driver_claim_interface() semantics slightly: drivers must
    now be prepared to accept disconnect() callbacks.
    
    Fixes more locking bugs, and a claim() oops that snuck in with a
    recent patch.

commit 33c65459ab38b70b9dde90ed13494ab7b0f253fe
Author: David Brownell <david-b@pacbell.net>
Date:   Tue Mar 30 21:34:31 2004 -0800

    [PATCH] USB: RNDIS/Ethernet Gadget Driver .inf file

commit 99e812464aeb56c6247c73dcd9220f928a2e487b
Author: David S. Miller <davem@nuts.davemloft.net>
Date:   Tue Mar 30 21:31:13 2004 -0800

    [TG3]: Add missing 5704 BX workaround, and fix typo in autoneg fix.

commit 1114cf18e132f2135fd4efa6b2b7c93a8647665b
Author: Alan Stern <stern@rowland.harvard.edu>
Date:   Tue Mar 30 21:09:56 2004 -0800

    [PATCH] USB Gadget: Rename the dummy_hcd's gadget
    
    When David added an entry to the gadget_chips.h file for the dummy_hcd
    driver, he mistakenly used the name "dummy_udc" rather than "dummy_hcd".
    The mistake is understandable, since other controllers use "_udc" in their
    names and it is illogical to put "_hcd" in a _device_ controller's name.
    
    This patch updates the dummy_hcd driver and changes the gadget name to
    agree with the gadget_chips.h entry.

commit 915801c37130d8346ca0399fb8637f8f53bbd8e6
Author: Alan Stern <stern@rowland.harvard.edu>
Date:   Tue Mar 30 21:09:35 2004 -0800

    [PATCH] USB: Complete all URBs in UHCI when releasing the bus
    
    This patch changes the UHCI driver's bus-release routine; now it will
    correctly finish all pending but not-yet-completed URBs.  This fixes a
    reported bug, when trying to rmmod uhci-hcd while using a USB mouse under
    X.  Also, the patch changes a variable name from ...hs... to ...fs...
    ("high speed" -> "full speed") -- something I accidentally omitted in an
    earlier patch.

commit a5bbb7ea257afa1cd4718f6a4f0c8b980a802d99
Author: Alan Stern <stern@rowland.harvard.edu>
Date:   Tue Mar 30 21:09:04 2004 -0800

    [PATCH] USB Gadget: Use automatic endpoint selection in file-storage
    
    This patch imports the endpoint auto-config library into the file-storage
    gadget, simplifying the code needed for endpoint selection and removing
    almost all dependencies on the controller type from the driver.  It also
    changes some log messages for reporting fatal problems from INFO to ERROR.

commit 354e887285d083dbc431c6d9a725d315d397b149
Author: Alan Stern <stern@rowland.harvard.edu>
Date:   Tue Mar 30 21:08:35 2004 -0800

    [PATCH] USB Gadget: Use configuration-buffer library in file-storage
    
    This patch imports the config-buffer library into the file-storage gadget,
    simplifying and decreasing the amount of code needed for assembling
    configuration descriptors.  It also changes the driver to remove any
    pretense at bus-powered operation and to use the new DUALSPEED
    configuration option.  This is in line with recent changes made to other
    gadget drivers.

commit 4e54702f95a2e7625cdc52ca458462aabe6c0e9b
Author: James Bottomley <jejb@mulgrave.(none)>
Date:   Tue Mar 30 10:02:55 2004 -0500

    SCSI: Add noretry check to the error handler path
    
    This still doesn't give us complete fast fail on
    the eh path because we still get delayed to recover
    the transport.

commit 07899aed053ce87c4b6c5fc077c5d9a371687dcd
Author: Jeff Garzik <jgarzik@redhat.com>
Date:   Tue Mar 30 06:42:18 2004 -0500

    [libata] fix broken delay
    
    Due to rounding and HZ==100, sometimes delays would not occur for
    the desired length of time, or even at all.
    
    Fix call to schedule_timeout() to ensure we delay -at least- for
    the correct amount of time.

commit 47287358aaa36ce4e3bbf71c167157913b94db1e
Author: Randy Dunlap <rddunlap@osdl.org>
Date:   Tue Mar 30 01:26:44 2004 -0800

    [PATCH] PCI: add DMA_{64,32}BIT constants
    
    On Tue, 23 Mar 2004 00:23:05 -0500 Jeff Garzik <jgarzik@pobox.com> wrote:
    >>Yeah well...  in the intervening time, somebody on IRC commented
    >>
    >>"so what is so PCI-specific about those constants?"
    >>
    >>They probably ought to be DMA_{32,64}BIT_MASK or somesuch.
    
    Here's an updated patch, applies to 2.6.5-rc2-bk9.
    I left the DMA_xxBIT_MASK defines in linux/pci.h, although
    they aren't necessarily PCI-specific.  Would we prefer to
    have them in linux/dma-mapping.h ?

commit c5b793bdfdbbd409f44e0d2b8eae849f5d434810
Author: Greg Kroah-Hartman <greg@kroah.com>
Date:   Tue Mar 30 01:24:37 2004 -0800

    Cset exclude: jgarzik@redhat.com|ChangeSet|20040323051558|61282

commit 6334e7866549676f4aa88872993a46114b9031bd
Author: David Brownell <david-b@pacbell.net>
Date:   Tue Mar 30 01:18:44 2004 -0800

    [PATCH] USB: fix dvb-ttusb-budget driver due to set_configuration locking cleanups
    
    > Oops, you forgot to grep:
    >
    > CC [M]  drivers/media/dvb/ttusb-dec/ttusb_dec.o
    > drivers/media/dvb/ttusb-budget/dvb-ttusb-budget.c: In function `ttusb_setup_interfaces':
    > drivers/media/dvb/ttusb-budget/dvb-ttusb-budget.c:1011: warning: implicit declaration of function `usb_set_configuration'
    
    Well, when I did the grep that bug wasn't there; it
    was just integrated on Feb 26!
    
    
    > Care to send a patch to fix it up before Andrew gets grumpy with me for
    > breaking his build?  :)
    
    The first part makes it use usb_reset_configuration() like
    it did before ... I'm surprised this driver hasn't been
    generating "it deadlocks during probe" reports.
    
    The second part prints a diagnostic if the configuration
    wasn't set right; the fix would use hotplug and sysfs.

commit d4f1dca6fb02a3d33aa4beb74e80a3f14fa3c30f
Author: Dave Jones <davej@redhat.com>
Date:   Tue Mar 30 01:18:20 2004 -0800

    [PATCH] USB: w9968cf driver misplaced ;

commit 88adbcd06938a4d3352738ed62c971bd82049e8b
Merge: 86a6028... f0fdf5f...
Author: Jeff Garzik <jgarzik@redhat.com>
Date:   Tue Mar 30 02:31:48 2004 -0500

    Merge redhat.com:/spare/repo/linux-2.6
    into redhat.com:/spare/repo/libata-2.6

commit ff74142ef27bb5886b093fa0de39470473a316e6
Author: Jean Delvare <khali@linux-fr.org>
Date:   Mon Mar 29 22:27:21 2004 -0800

    [PATCH] I2C: Discard pointless comment in via686a
    
    The simple patch below discards a comment in via686a referencing a file
    that doesn't belong to the Linux tree. Now that I tell people not to do
    that in my porting guide, we better follow our own advice.

commit af109398ca4f3b235aaebb5037cd1edf232ccfb6
Author: Jean Delvare <khali@linux-fr.org>
Date:   Mon Mar 29 22:27:06 2004 -0800

    [PATCH] I2C: Incorrect memset in eeprom.c
    
    Quoting Ralf Roesch:
    
    > currently I'm only working with Linux MIPS 2.4 kernel,
    > so it would be nice if you could forward the patch for 2.6.
    
    OK, so here we are. Greg, this is the port to 2.6 of Ralf patch that
    fixes an incorrect memset while initializing the eeprom driver. Please
    apply.

commit a4a5e7cfe379fac657befc526ea1b6add11c0913
Author: Jean Delvare <khali@linux-fr.org>
Date:   Mon Mar 29 22:26:52 2004 -0800

    [PATCH] I2C: i2c documentation update (2/2)
    
    Here is a patch to Documentation/i2c/sysfs-interface. This is mostly my
    intent to make the document more readable. There are also a few
    incorrectnesses fixed, and some comments added.

commit 92e54f42420adf75b7e66103342ed5aa2237e257
Author: Jean Delvare <khali@linux-fr.org>
Date:   Mon Mar 29 22:26:38 2004 -0800

    [PATCH] I2C: i2c documentation update (1/2)
    
    Here is an update to my 2.4 to 2.6 i2c client porting guide. The changes
    were inspired by the feedback I got with the drivers that have been
    ported so far.

commit 9f3e7af6aa633b7c58c3939d9d81a748dfb67bc6
Author: Jean Delvare <khali@linux-fr.org>
Date:   Mon Mar 29 22:26:19 2004 -0800

    [PATCH] I2C: Prevent misdetections in adm1021 driver
    
    Yet another patch for the adm1021 chip driver. I refined the detection
    code a bit in order to prevent chip misdetection. Some chips handled
    by the adm1021 driver are hard to detect and identify (LM84 and
    MAX1617) so we tend to accept any chip it the valid I2C address range
    as one of these. It has caused much, much trouble already. See these
    threads for example:
    
    http://archives.andrew.net.au/lm-sensors/msg04448.html
    http://archives.andrew.net.au/lm-sensors/msg04624.html
    http://archives.andrew.net.au/lm-sensors/msg05560.html
    http://archives.andrew.net.au/lm-sensors/msg05871.html
    http://archives.andrew.net.au/lm-sensors/msg06754.html
    http://archives.andrew.net.au/lm-sensors/msg07181.html
    
    And this ticket:
    
    http://www2.lm-sensors.nu/~lm78/readticket.cgi?ticket=1434
    
    So I thought it would be good to prevent this kind of problems if
    possible, and read the 8 datasheets again in search for ways to refine
    the detection method.
    
    I changed it in sensors-detect already, and had positive feedback from
    one user. I will also backport the changes to the driver to the 2.4
    version we have in CVS.
    
    What the patch does:
    
    * Use unused bits of two more registers (configuration and conversion
    rate) to reduce misdetections.
    
    * Return with -ENODEV if the detection fails.
    
    * Change the order in which we try to identify the chips. We better
    finish with the LM84 and the MAX1617, in this order, because they are
    harder to identify and are more likely to result in false positives.
    
    * Refine LM84 detection. The LM84 has less features than the other
    chips(chip cannot be stopped, conversion rate cannot be set, no low
    limits) so it has extra unused bits.
    
    * Do not intialize the chip if it was detected as an LM84. This one
    cannot be stopped so why would we try to start it again? And as said
    right before, conversion rate isn't changeable either.
    
    Note that I couldn't test the changes on any supported chip since I
    don't own any. Still I believe that they should be applied, since the
    current code already broke one system and seriously harmed several
    others. I believe it's not critical if it turns out that we reject
    valid chips (which shouldn't happen if the datasheets are correct,
    anyway). People will simply let us know and we'll be less restrictive.
    In the meantime they can force the driver. That said, testers are
    welcome, as usual.

commit 1510776bed4e45dd5744b050ac1eb6f5111f714b
Author: Alessandro Zummo <alessandro.zummo@towertech.it>
Date:   Mon Mar 29 22:12:25 2004 -0800

    [PATCH] USB: omninet patch
    
      here's a small patch for omninet.c .

commit ff533b7692cc581756582d575c73177570feb090
Author: Marcel Holtmann <marcel@holtmann.org>
Date:   Mon Mar 29 22:12:10 2004 -0800

    [PATCH] USB: Rename the USB HID driver
    
    > > I like to see this rename as soon as possible. So if nobody minds I send
    > > a patch to LKML and ask Linus for inclusion.
    >
    > Go ahead, but also please patch all relevant documentation in the
    > kernel.
    
    the attached patch should do the renaming everywhere hid or hid.o was
    mentioned. It also removes all references to *.o module names.

commit fea7770cd3e923608e95f944b412e08c14998548
Author: David Brownell <david-b@pacbell.net>
Date:   Mon Mar 29 22:11:48 2004 -0800

    [PATCH] USB: RNDIS/Ethernet Gadget Driver comment changes
    
    Whoops, I missed something.  You should apply this patch too.
    
    The RNDIS spec license agreement does NOT require tacking any
    GPL-incompatible restrictions on the results of _using_ the
    spec:
    
       "... may be used solely for the purpose of implementing
        the RNDIS protocol message set to interface with ..."
       (the two cases identified in the text)
    
    And that's all the implementation does -- end of story.

commit 38c2c0e82d5596bce4cfc650bb578ada26c05009
Author: Dave Jones <davej@redhat.com>
Date:   Mon Mar 29 22:11:25 2004 -0800

    [PATCH] USB: kill off CONFIG_USB_BRLVGER detritus.
    
    This died a while ago, but lingers on in defconfigs.

commit 45fbc50ee99e462fb6d4c9831467c32faa013664
Author: Andries E. Brouwer <andries.brouwer@cwi.nl>
Date:   Mon Mar 29 22:11:00 2004 -0800

    [PATCH] USB Storage: datafab fix and unusual devices
    
    datafab.c has an often-seen bug: the SCSI READ_CAPACITY command
    does not need the number of sectors but the last sector.
    
    I just tried the CF and SM parts of a 5-in-1 card reader.
    The CF part works with US_PR_DATAFAB when the bug mentioned is fixed.
    The SM part works with US_PR_SDDR55.
    (Revision Number is 17.08 - that in case the 0000-ffff
    should prove to be too optimistic.)
    
    We still must discuss what setup to use for readers like this -
    I have several of them - that require different drivers for
    different LUNs. As it is now one has to compile usb-storage
    twice, once with CONFIG_USB_STORAGE_DATAFAB defined and once
    without, and remove one usb-storage.ko and insert the other
    to go from CF to SM. (And that hangs with 2.6.4 so a reboot
    is required..)

commit c3e08bc4f55d44566a1e62f78fe8810c00774d9a
Author: Paulo Marques <pmarques@grupopie.com>
Date:   Mon Mar 29 22:10:36 2004 -0800

    [PATCH] USB: ftdi_sio.c: not unlinking urb on ftdi_close
    
    This patch fixes a bug in ftdi_sio.c where the driver wouldn't unlink the
    read urb if the user application cleared the HUPCL flag on termios->c_cflag.

commit cf2bbebedb323f8cf17ef352663d2d904d00f455
Author: Andrew Morton <akpm@osdl.org>
Date:   Mon Mar 29 22:10:11 2004 -0800

    [PATCH] USB: drivers/usb/gadget/epautoconf.c gcc-3.5 build fix
    
    drivers/usb/gadget/epautoconf.c: In function `ep_matches':
    drivers/usb/gadget/epautoconf.c:175: error: `typeof' applied to a bit-field

commit 10766ddeeaf441451237794ad6c0a7ae6dcbf1f1
Author: David Brownell <david-b@pacbell.net>
Date:   Mon Mar 29 17:25:17 2004 -0800

    [PATCH] USB: set_configuration locking cleanups
    
    I've posted all these before, the only notable change is
    treating that one gphoto2 case as warn-and-continue rather
    than return-with-failure.
    
    
    usb_set_configuration() cleanup
    
     * Remove it from the USB kernel driver API.  No drivers need it now,
       and the sysadmin can change bConfigurationValue using sysfs (say,
       when hotplugging an otherwise problematic device).
    
     * Simpler/cleaner locking:  caller must own dev->serialize.
    
     * Access from usbfs now uses usb_reset_configuration() sometimes,
       preventing sysfs thrash, and warns about some dangerous usage
       (which gphoto2 and other programs may be relying on).  (This is
       from Alan Stern, but I morphed an error return into a warning.)
    
     * Prevent a couple potential "no configuration" oopses. (Alan's?)
    
     * Remove one broken call from usbcore,  in the "device morphed" path
       of usb_reset_device().  This should be more polite now, hanging
       that one device rather than khubd.

commit 394d72563ef8275323cc7bb85e9d087a3f854b2f
Author: David Brownell <david-b@pacbell.net>
Date:   Mon Mar 29 16:56:45 2004 -0800

    [PATCH] USB Gadget: RNDIS/Ethernet Gadget Driver (2/2)
    
    This updates the existing Ethernet gadget driver to
    support an additional RNDIS configuration on all
    current USB controllers that can support one.
    
    It also includes a bit more work to address the complex
    autoconfiguration of this driver.  Needs testing on PXA.
    
    Patch (mostly) contributed by Robert Schwebel, and developed
    with support from Auerswald GmbH.

commit 166685d05122d19ac9e5daf8ac8ba696a7f96d48
Author: David Brownell <david-b@pacbell.net>
Date:   Mon Mar 29 16:56:15 2004 -0800

    [PATCH] USB Gadget: RNDIS/Ethernet Gadget Driver (1/2)
    
    This patch adds the RNDIS message engine and kbuild/kconfig
    support for it.  This is currently labeled EXPERIMENTAL.
    
    Patch contributed by Robert Schwebel, and developed with
    support from Auerswald GmbH.

commit 21d554cc1392cdf41cc360f89ca7c80af7a647a1
Author: David Brownell <david-b@pacbell.net>
Date:   Mon Mar 29 16:55:44 2004 -0800

    [PATCH] USB: ohci unlink tweaks
    
    Minor unlink tweaks, including a case where SMP could oops
    if it were abused, as if from 'usbtest' or 'stir4200'.

commit 976942da2365a7a2ed596c6043442b5a51662fb1
Author: David Brownell <david-b@pacbell.net>
Date:   Mon Mar 29 16:55:23 2004 -0800

    [PATCH] USB: usb/core/config.c null pointers after kfree
    
    Prevents an oops with some other patchsets.
    
    
    Clear some pointers after the memory is kfreed, to avoid
    making some other patch combinations oops.

commit eea93a30dd39d6f7b4c53efaf01f53fa34b36798
Author: David Brownell <david-b@pacbell.net>
Date:   Mon Mar 29 16:53:38 2004 -0800

    [PATCH] USB; minor usbfs locking updates
    
    These are "obvious" locking fixes:  using the right lock
    to protect interface claim/release (should be the driver
    model bus lock, not BKL).

commit b10c49747228153ab3e72be3935c1d2f376cdd4b
Merge: ed426fe... f0fdf5f...
Author: Steve French <cifs.adm@hostme.bitkeeper.com>
Date:   Mon Mar 29 15:34:18 2004 -0800

    Merge bk://linux.bkbits.net/linux-2.5
    into hostme.bitkeeper.com:/repos/c/cifs/linux-2.5cifs

commit 86a6028acc245d40bef18349e5b373b5fd9a3d7c
Author: Jeff Garzik <jgarzik@redhat.com>
Date:   Mon Mar 29 09:30:47 2004 -0500

    [libata] back out duplicated upstream fix
    
    We already fixed this bug locally, so fix up the automerge
    by removing the upstream change.

commit a5f635f8c7af0975c7adb82c10ce1f193947e84f
Merge: 4983868... 26cf269...
Author: Jeff Garzik <jgarzik@redhat.com>
Date:   Mon Mar 29 09:28:22 2004 -0500

    Merge redhat.com:/spare/repo/linux-2.6
    into redhat.com:/spare/repo/libata-2.6

commit 5fa50844a26b3f7458f0a2890e979206a09bed8f
Merge: a9b095e... 288c759...
Author: Anton Altaparmakov <aia21@cantab.net>
Date:   Mon Mar 29 15:26:04 2004 +0100

    Merge cantab.net:/home/src/bklinux-2.6
    into cantab.net:/home/src/ntfs-2.6

commit 516e49e0b1c6d55a2d17e790d3f3ff38f2362ce9
Author: Harald Welte <laforge@netfilter.org>
Date:   Mon Mar 29 04:24:54 2004 -0800

    [NETFILTER]: Add 'raw' table, from Jozsef Kadlecsik.

commit 284bd053ccdb2634c175cb6a29719c4c2b24f491
Author: David S. Miller <davem@nuts.davemloft.net>
Date:   Mon Mar 29 04:22:47 2004 -0800

    [NETFILTER]: Missed these files in nf_log commit.

commit 62c12ea9616ea986ff72acad28aa0044f4790c63
Author: Harald Welte <laforge@netfilter.org>
Date:   Mon Mar 29 04:21:44 2004 -0800

    [NETFILTER]: Add nf_log handler, from Jozsef Kadlecsik.

commit f7e36893be4fc0b953e43ceb25d81113454272ae
Author: Harald Welte <laforge@netfilter.org>
Date:   Mon Mar 29 04:19:08 2004 -0800

    [NETFILTER]: Cleanup conntrack helper API
    
    A: Pablo Neira
    D: This patch changes the conntrack helper API.  Rather than having the
    D: helper allocate an expect on the stack and then have the core
    D: kmalloc and memcpy, it is now the job of a helper to call
    D: ip_conntrack_expect_alloc()

commit f4d9b3c6c2f62e15127ff650c101570da25c9e85
Author: Harald Welte <laforge@netfilter.org>
Date:   Mon Mar 29 04:18:04 2004 -0800

    [NETFILTER]: Locking optimization in ip_conntrack_core
    
    A: Pablo Neira
    D: This patch puts tightens up a lock protected section in
    D: ip_ct_refresh()

commit 6a9378b561f7739c21576a7aff059cefe9a87b50
Author: Harald Welte <laforge@netfilter.org>
Date:   Mon Mar 29 04:17:20 2004 -0800

    [NETFILTER]: Optimization of ip_conntrack_proto_tcp:tcp_packet()
    
    A: Pablo Neira
    D: This patch cleans up tcp_packet().  No semantical change, just juggling
    D: code pieces.

commit 8763960f1f2dd92d0c4e071fd77c3f02a801d111
Author: Martin Hicks <mort@wildopensource.com>
Date:   Mon Mar 29 02:49:45 2004 -0500

    [PATCH] Fix template size calculation in transport attributes
    
    This small patch fixes the template size calculation in
    {spi,fc}_attach_transport().

commit b86366a8642cc00d0a112ed0cd3406a76a8bea35
Author: David S. Miller <davem@nuts.davemloft.net>
Date:   Sun Mar 28 23:11:50 2004 -0800

    [TG3]: Do not allow illegal ethtool advertisement bits.

commit a10e510908dec67fa1d58a6a837bd3e615c9e242
Author: David S. Miller <davem@nuts.davemloft.net>
Date:   Sun Mar 28 22:57:24 2004 -0800

    [TG3]: At start of tg3_phy_copper_begin, force phy out of loopback mode.

commit a3ca50f922a8bd9b64868f8a75bf48f18677a6e0
Author: David S. Miller <davem@nuts.davemloft.net>
Date:   Sun Mar 28 19:43:53 2004 -0800

    [TG3]: Kill 'force' arg to tg3_phy_reset, it is always set.

commit ed426fea547224fbbfac3390d87132cd972f475b
Merge: 370c0dd... 8e764e0...
Author: Steve French <cifs.adm@hostme.bitkeeper.com>
Date:   Sun Mar 28 19:19:03 2004 -0800

    Merge bk://linux.bkbits.net/linux-2.5
    into hostme.bitkeeper.com:/repos/c/cifs/linux-2.5cifs

commit 73e07d1f8716c7738c1fad64735d55f94bd71035
Author: James Bottomley <jejb@mulgrave.(none)>
Date:   Sat Mar 27 01:15:17 2004 -0500

    ServeRAID ( ips ) 7.00.15
    
    ith the completion of testing at Adaptec and IBM, the latest version of
    the ServeRAID Linux device driver ( ips Version 7.00.15 )is now
    available. Attached is the patches against the previous ServeRAID
    releases.  Basically, this is a convergence to a common ips driver code
    base for the 2.4 and 2.6 kernels.
    
    This driver is based on the driver currently in 2.6, so you while there
    appears to be lots of changes to the 2.4 driver,  the changes to the
    current 2.6 driver are trivial ( the only changes are  version number
    changes and the addition of some new adapter ID's ).  For 2.4, this was
    primarily a testing effort to ensure that the 2.6 driver code was stable
    when built for a 2.4 kernel.

commit 547e26c1905e55e974621fab6d8090e68b8c59c3
Author: James Bottomley <jejb@mulgrave.(none)>
Date:   Sat Mar 27 00:38:57 2004 -0500

    MPT Fusion driver 3.01.03 update
    
    From: "Moore, Eric Dean" <Emoore@lsil.com>
    
    Changelog for mpt version 3.01.03:
    
    (1)  Fix fifo memory allocation under 64bit systems
    by merging 3 seperate memory allocations into one call.
    Before this fix, it was possible that these seperate
    pci_alloc_consistent() calls were crossing the 4GB
    hardware boundary.
    Delete the MPTBASE_MEM_ALLOC_FIFO_FIX logic.
    Backout recent ak@muc.de workaround.
    
    (2) Replace wrappers for CHIPREG_XXX with defines;
    per request from Jeff Garzik [jgarzik@pobox.com]
    
    (3) Remove support for FC909.
    
    (4) Remove PortIo modules parameter.
    
    (5) Move procmpt_destroy function before pci_unregister_driver,
    as the memory allocated for the proc was not being deallocated.
    
    (6) Remove mptscshi_reset_timeouts function. The timer was
    already expired when mod_timer is called.
    
    (7) Fix small bug in slave_destroy, which could prevent domain
    validation on hidden drive in a RAID volume.
    
    ----------------------------------------------------------------------
    
    Changelog for mpt version 3.01.02:
    
    (1) Andi Kleen[ak@suse.de]
    put warning "Device (0:0:0) reported QUEUE_FULL!" into debug messages
    
    (2) Alexander Stohr[Alexander.Stohr@gmx.de]
    fix warnings from mptscsih_setup when driver isn't compiled as module
    
    (3) Randy.Dunlap[rddunlap@osdl.org]
    Remove unnecessary min/max macros and change calls to
    use kernel.h macros instead.

commit db2a43a6e38e514a8f45f03c7bf0aec1252967e5
Author: Martin Hicks <mort@wildopensource.com>
Date:   Sat Mar 27 00:27:00 2004 -0500

    [PATCH] Add FC transport attributes support to qla2xxx
    
    Here is a patch that adds FC transport attributes to the qla2xxx driver.
    The patch should apply cleanly to a recent 2.6 kernel with the FC
    attributes update that I just sent to linux-scsi.

commit 632f641d169ed56e272070759bc0148e9c11a9c4
Author: Martin Hicks <mort@wildopensource.com>
Date:   Sat Mar 27 00:24:21 2004 -0500

    [PATCH] Update FC transport attributes API
    
    This patch brings the FC transport attributes up to date with the SPI
    attributes API.
    
    The only major change I made was to separate read-only attributes
    from read-write attributes.

commit 946c4a7fe3c9c7f0d462d80eee4b95e2de1b477a
Author: Andrew Morton <akpm@osdl.org>
Date:   Sat Mar 27 00:21:31 2004 -0500

    [PATCH] stack reduction: aic7xxx_old
    
    From: Arjan van de Ven <arjanv@redhat.com>
    
    aic7xxx_old: constant array of PCI ID's can be static since it's read only

commit 26cf269631e94fa4a6b90dfe1edb7c866a8fe4ae
Author: Jeff Garzik <jgarzik@redhat.com>
Date:   Fri Mar 26 14:21:34 2004 -0500

    [libata] remove synchronize-cache dead code
    
    Just a placeholder, and now that a better way to do this is coming,
    we don't even need the [unused] placeholder anymore.

commit 4e7e03c406f1c390a44b092b8f34d534d5fbd147
Author: Jeff Garzik <jgarzik@redhat.com>
Date:   Fri Mar 26 12:14:11 2004 -0500

    [libata] fix bug with READ(6) and WRITE(6) SCSI commands
    
    Must set the LBA bit on all transfers, not just {read,write}{10,16}
    scsi commands.

commit c769b6dd7d23226dfcd978eee449f1f112a0f746
Author: Jeff Garzik <jgarzik@redhat.com>
Date:   Fri Mar 26 10:40:58 2004 -0500

    [libata sata_promise] better locking and error handling
    
    * Prefer spin_lock() to spin_lock_irq() in interrupt handler
    * Reset each port, before probing the SATA phy
    * Reset port when every time an error occurs

commit 428a467d1d22092fef2846f5a6a9654cda93ea0e
Merge: 4e6e287... 12517cb...
Author: Jeff Garzik <jgarzik@redhat.com>
Date:   Fri Mar 26 09:33:40 2004 -0500

    Merge redhat.com:/spare/repo/linux-2.6
    into redhat.com:/spare/repo/libata-2.6

commit 0086de6f851d0f701fd0dfad3450b25191643129
Author: Jesse Barnes <jbarnes@sgi.com>
Date:   Fri Mar 26 06:05:54 2004 -0800

    [PATCH] ia64: only scan SN2 PCI busses that exist
    
    sn_pci_init was unconditionally scanning 255 PCI busses, even though
    only a few are actually present on most systems.  This patch adds a
    check to make sure a given bus exists before doing the scan, which
    saves a little memory and also makes /sys/devices reflect reality a
    bit more closely.

commit 66c88342882aaf1ba7ccf3761c5405d67eb99d6b
Author: Jesse Barnes <jbarnes@sgi.com>
Date:   Fri Mar 26 06:04:10 2004 -0800

    [PATCH] ia64: implement SN2 version of dma_mapping_error()
    
    On sn2, dma_mapping_error is trivial.  pci_map_single was already returning 0
    in case of failure (0 is an invalid DMA address on sn2), so make
    dma_mapping_error check for that.

commit 12517cba59a2115da64a733cfd3d4233d50d4e27
Author: Jeff Garzik <jgarzik@redhat.com>
Date:   Fri Mar 26 08:02:34 2004 -0500

    [libata] more documentation
    
    libata-scsi.c should now be fully documented.

commit 370c0dd53f709ba6095434c8413a309a0bf15acb
Author: Steve French <stevef@stevef95.austin.ibm.com>
Date:   Fri Mar 26 04:32:07 2004 -0600

    clean up compiler warnings

commit a70fdf26333c34c910d2b87c71f1686b45b039bb
Author: Tom Rini <trini@kernel.crashing.org>
Date:   Fri Mar 26 02:02:12 2004 -0700

    PPC32: Fix two typos in arch/ppc/boot/
    From: Arthur Othieno <a.othieno@bluewin.ch>

commit 6c4986f1850f8ec797245762d83ce7508944a950
Author: Tom Rini <trini@kernel.crashing.org>
Date:   Fri Mar 26 02:01:23 2004 -0700

    PPC32: Add more useful information to the oops output.

commit 05bef07483e20e04aa64ec9458086e4bd68750ef
Author: Tom Rini <trini@kernel.crashing.org>
Date:   Fri Mar 26 02:00:49 2004 -0700

    PPC32: Remove an unneeded include in arch/ppc/boot/

commit a975072b0cf5d1394c87fbb7789b8d890268688f
Author: Matthew Wilcox <willy@debian.org>
Date:   Fri Mar 26 00:32:52 2004 -0800

    [PATCH] PCI Hotplug: Rewrite acpiphp detect_used_resource
    
    There are two unrelated problems in acpiphp that are fixed by this patch.
    First, acpiphp can be a module, so it is unsafe to probe the BARs of each
    device while it initialises -- the device may be active at the time.
    Second, it does not know about PCI-PCI bridge registers and so it reads
    garbage for the last 4 registers of the PCI-PCI bridge card and doesn't
    take into account the ranges that are forwarded by the bridge.
    
    This patch avoids all that by using the struct resources embedded in
    the pci_dev.  Note that we no longer need to recurse as all the devices
    on the other side of a PCI-PCI bridge have their resources entirely
    contained within the PCI-PCI bridge's ranges.

commit 4e3b369f0b0a5fc3f49867825e8dc9b29212e8b6
Author: Matthew Wilcox <willy@debian.org>
Date:   Fri Mar 26 00:32:21 2004 -0800

    [PATCH] PCI Hotplug: Don't up() twice in acpiphp
    
    On the error path, we currently try to up() a semaphore twice.
    There was also a typo in an error message.

commit 25a3a5557282102eb85f60ab4fcfab697a4c009e
Author: Dely Sy <dlsy@snoqualmie.dp.intel.com>
Date:   Fri Mar 26 00:31:44 2004 -0800

    [PATCH] PCI: Updates for PCI Express hot-plug driver

commit bae19b18de6c95fc6a27c24345d5b7cf3ac1e32c
Merge: ec99630... b1776b0...
Author: Greg Kroah-Hartman <greg@kroah.com>
Date:   Fri Mar 26 00:24:34 2004 -0800

    Merge bk://kernel.bkbits.net/jgarzik/pci-dma-mask-2.6
    into kroah.com:/home/greg/linux/BK/pci-2.6

commit ec99630f915525d946d9a3d07a590054617c4934
Author: Greg Kroah-Hartman <greg@kroah.com>
Date:   Fri Mar 26 00:11:41 2004 -0800

    PCI: add ability to access pci extended config space for PCI Express devices
    
    Patch originally written by Intel, cleaned up and made sane by
    Matthew Wilcox <willy@debian.org> and then tweaked a bit more by me.
    
    From Matt's original email:
     - Add cfg_size to struct pci_dev.
     - Use it in sysfs and procfs.
     - Introduce pci_find_ext_capability() for finding extended capabilities.
     - Change the PCI_X_STATUS defines to match the spec (mea culpa there).
     - Add defines for the extended capabilities.

commit 6f58f120e1020bed8f7049e0485849492007ac7a
Author: Alan Stern <stern@rowland.harvard.edu>
Date:   Thu Mar 25 22:39:04 2004 -0800

    [PATCH] USB: Altsetting update for USB input drivers
    
    This patch continues the update process for the cur_altsetting change.
    The drivers in usb/input were all in good shape and needed only minimal
    changes.

commit 18a860b26af73cb4afb86ab480a0cfa017e58925
Author: David Brownell <david-b@pacbell.net>
Date:   Thu Mar 25 22:26:00 2004 -0800

    [PATCH] USB: ohci misc updates
    
    Mostly from Benjamin Herrenschmidt:
    
      - prevent usbcore from asking the HCD root hub code
        to read registers on one more suspend path (some
        hardware gets upset in those cases);
    
      - try handling a "device died" cleanup case better
    
      - add some wmb() calls in spots that could matter
        on some hardware

commit dc6b9d7ff8d383e451392ab132f88632a9cd938a
Author: Deepak Saxena <dsaxena@plexity.net>
Date:   Thu Mar 25 22:25:35 2004 -0800

    [PATCH] IXP425 -> IXP4XX conversion for USB-gadget
    
    The 2.6 code for Intel's IXP4xx NPU line has been updated to
    remove all references to IXP42x or IXP425 and replace it
    with IXP4XX, including config options and file names. This
    patch updates the USB-gadget pxa-udc driver with these changes.

commit 100a165dcdc71cb06b8d55c6910573cc4493e26e
Author: Romain Li√©vin <romain@lievin.net>
Date:   Thu Mar 25 22:24:35 2004 -0800

    [PATCH] tipar char driver (divide by zero)
    
    A patch about the tipar.c char driver has been sent on lkml by Sebastien
    Bourdeau. It fixes a divide-by-zero error when we try to read/write data
    after setting the timeout to 0.

commit 742647e98fcaed231d4fd6f525960251fbf09140
Author: Jean Delvare <khali@linux-fr.org>
Date:   Thu Mar 25 21:53:01 2004 -0800

    [PATCH] I2C: Setting w83627hf fan_div preserves fan_min
    
    Here is a patch that updates the w83627hf driver in the exact same way I
    did recently for the w83781d driver. There were two problems:
    1* Fan divisor storing code was ugly, badly ripped from the 2.4 w83627hf
       driver and/or the 2.6 w83781d driver.
    2* Setting fan divisors wouldn't preserve fan mins.
    
    Exactly the same as w83781d:
    http://archives.andrew.net.au/lm-sensors/msg06952.html
    http://archives.andrew.net.au/lm-sensors/msg07008.html
    
    No surprise since the w83627hf driver is a fork of the w83781d driver.
    
    Since the two drivers are strongly similar, I took the code directly
    from the updated w83781d driver. I cannot test the w83627hf driver
    (testers welcome BTW) but this makes me feel confident that the code is
    correct.
    
    To make it clear, this single patch is the w83627f equivalent of the
    three patches I submitted for the w83781d:
    * Cleanup
    * Refactoring
    * Setting fan_div preserves fan_min
    All in one (much better looking BTW).

commit 4b65ed3affb0e422ead205b7aa27f5988b655a41
Author: Jean Delvare <khali@linux-fr.org>
Date:   Thu Mar 25 21:52:39 2004 -0800

    [PATCH] I2C: adm1021 (probably) does something VERY,VERY BAD
    
    Quoting myself:
    
    > 3* Drop adm1021's limit init. This was already done in the 2.4 driver
    > and should have been done in 2.6 as well.
    
    Here is a patch that does that. It also prevents bit 7 (and unused bits)
    of configuration register from being reset, as was discussed before:
      http://archives.andrew.net.au/lm-sensors/msg04593.html
    That second part needs to be backported to the 2.4 driver, and I will do
    so.
    
    Additionally, we get rid of a useless label.
    
    The patch is untested (I don't own any supported chip) but quite
    straightforward IMHO.

commit 2e3ed9ac32269e7b5a9b27e5a866bae1584b3415
Author: Greg Kroah-Hartman <greg@kroah.com>
Date:   Thu Mar 25 21:45:58 2004 -0800

    USB: fix compiler warning in whiteheat driver.

commit c19158f485ad6328d70b005c6825845deba51328
Author: Corey Edwards <coreyed@linxtechnologies.com>
Date:   Thu Mar 25 21:42:45 2004 -0800

    [PATCH] USB: add ftdi_sio product ids

commit f587996431b7aab68269c49d3a79d7283fade333
Author: Greg Kroah-Hartman <greg@kroah.com>
Date:   Thu Mar 25 21:33:56 2004 -0800

    USB: ftdi_sio merge fixups.

commit 71a8bfa2fa17b83f63d6f86715dc9c5da75ec2ee
Author: Gude Analog- und Digitalsysteme GmbH <info@gudeads.com>
Date:   Thu Mar 25 21:32:06 2004 -0800

    [PATCH] USB: more ftdi_sio ids

commit 0c7989b93e9fa7e89d5bc9aada7e710e1edc9ebe
Author: Alan Stern <stern@rowland.harvard.edu>
Date:   Thu Mar 25 21:29:43 2004 -0800

    [PATCH] USB: Add dummy_hcd to the main kernel
    
    This is a resubmission of as225, together with appropriate changes for the
    g_serial driver.  David Brownell's latest g_ether update makes it
    unnecessary to change that file or gadget_chips.h.
    
    
    
    dummy_hcd is simultaneously a host controller driver and a device
    controller driver.  It creates a simulated HC together with a simulated
    UDC plugged into it.  Gadget drivers can run under the simulated UDC and
    will appear as regular USB devices on the simulated HC.  The simulation is
    reasonably (although not totally) realistic.
    
    It's a wonderful tool for testing and developing gadget drivers without
    the need for lots of additional hardware: Both the host driver and the
    gadget driver can run on the same computer.  It's been available for quite
    some time in David's gadget-2.6 tree and it works well.  I couldn't have
    gotten the file-storage gadget running in any reasonable length of time
    without it.

commit d0d4457b9cf5e95bfbb8f6c21739f2dea62e1b3d
Author: Greg Kroah-Hartman <greg@kroah.com>
Date:   Thu Mar 25 21:23:41 2004 -0800

    USB: mark pwc driver as broken, as it is.
    
    And the maintainer doesn't seem to want to fix it :(

commit 05b905b35da3371922747731edc008bd0d0ea2da
Author: Meelis Roos <mroos@linux.ee>
Date:   Thu Mar 25 20:32:39 2004 -0800

    [PATCH] USB: fix whiteheat USB serial compile failure on PPC
    
    > Bah, looks like PPC doesn't ever define CMSPAR :(
    >
    > How about adding something like:
    > 	#ifndef CMSPAR
    > 	#define CMSPAR 0
    > 	#endif
    > To the beginning of the driver like the cdc-acm.c driver does?  If that
    > works, care to send me a patch?
    
    Yes, it compiles.

commit 7ab4b6bceb921c82411e722e7e0b9f0c4b38d6a1
Author: David Brownell <david-b@pacbell.net>
Date:   Thu Mar 25 20:32:02 2004 -0800

    [PATCH] USB: g_ether does endpoint autoconfig too
    
    Here's an update for the Ethernet gadget that corresponds
    to the earlier one for Gadget Zero ... it gets rid of almost
    all the remaining controller-specific #ifdefs in this driver.
    (And also lets the driver initialize using "dummy_hcd".)
    
    This is a significant step towards doing hardware-specific
    configuration at run time (or at least init-time) rather
    than compile time, but other patches will be needed to take
    it the rest of the way there.   (Especially considering the
    RNDIS support...)  The runtime footprint of the driver shrank
    a bit, mostly because things moved into the init section.

commit 1a8ebef00453a9fc8bd993e2e51dd61bffd1b471
Author: David Brownell <david-b@pacbell.net>
Date:   Thu Mar 25 20:31:37 2004 -0800

    [PATCH] USB: usbnet, minor probe() fault fix
    
    Some hardware had the poor taste to misbehave during probe(),
    which turned up a minor bug.  This fixes it:  don't try to
    free a network device that hasn't been registerd.

commit 69dc1c65dbf699a526337a48b8ca64834f2d2acf
Author: David Brownell <david-b@pacbell.net>
Date:   Thu Mar 25 20:31:15 2004 -0800

    [PATCH] USB: define USB feature bit indices
    
    This patch provides standard symbols for the various USB
    device and endpoint feature bits, so that drivers can
    use symbolic names for them.  It also changes the code
    relating to endpoint halts so it uses those symbols.

commit 0c2b45d0f211cc23ec8ef15ece8614239df9f552
Author: Arjan van de Ven <arjanv@redhat.com>
Date:   Thu Mar 25 20:30:48 2004 -0800

    [PATCH] USB: fix race in whiteheat serial driver
    
    Patch below fixes an obvious race in the whiteheat usb serial driver...

commit 8f8d19fc540ac77482a312fe0f4bf8013289a4c4
Author: Patrick Mochel <mochel@digitalimplant.org>
Date:   Thu Mar 25 19:25:25 2004 -0800

    [PATCH] USB:  Fix drivers/usb/net/Kconfig
    
    This allows the pegasus driver to actually be seen as a config option.
    Apparently it's not that popular, though I have confirmed that it still
    works on at least the netgear fv101.

commit d63ee150165978f1a1a94cf54d2e0f016cfff303
Author: Oliver Neukum <oliver@neukum.org>
Date:   Thu Mar 25 19:24:29 2004 -0800

    [PATCH] USB: fix hfc_usb sleeping in irq
    
    you are using GFP_KERNEL in irq and __devinit with hotpluggable code.
    
          - use proper GFP flags
          - kill __devinit

commit c9c6bf0740818bacd6a2a3ec76dccb73aa185a03
Author: Oliver Neukum <oliver@neukum.org>
Date:   Thu Mar 25 19:23:03 2004 -0800

    [PATCH] USB: fix typo in previous patch
    
    I screwed up. This corrects it.

commit 2d3dd61834344bfb335eb98463811c053d74e130
Author: Oliver Neukum <oliver@neukum.org>
Date:   Thu Mar 25 19:21:48 2004 -0800

    [PATCH] USB: cleanup of st5481
    
    you are using __devinit which must not be used with USB drivers,
    in addition you are using some false GFP values and fail to check
    some error codes.
    
      - check for unlink due to removal of controller
      - correct GFP values
      - no __devinit in USB

commit 1e9a5829551573ff368fc24890ed0a89c8aac02b
Author: Oliver Neukum <oliver@neukum.org>
Date:   Thu Mar 25 19:20:06 2004 -0800

    [PATCH] USB: fix DMA to stack in ftdi driver
    
    this driver is doing DMA to the stack. Here's the obvious fix.

commit d1bc364ee2b218a449837dffad904a5a98b661cc
Author: Patrick Boettcher <patrick.boettcher@desy.de>
Date:   Thu Mar 25 19:18:25 2004 -0800

    [PATCH] USB: fix bug in usb-skeleton.c

commit eccd8f92e88ce35b1f41e15cfb34882969293392
Merge: d55147d... 4e6e287...
Author: Steve French <cifs.adm@hostme.bitkeeper.com>
Date:   Thu Mar 25 19:16:59 2004 -0800

    Merge bk://linux.bkbits.net/linux-2.5
    into hostme.bitkeeper.com:/repos/c/cifs/linux-2.5cifs

commit 1d91974394c08e34db683d3f76d8763c2dac4973
Author: Jeff Garzik <jgarzik@redhat.com>
Date:   Thu Mar 25 18:04:17 2004 -0500

    [libata] more cmd queue path cleanups
    
    Final part in tonight's series of changes to clean up the
    command queueing path.
    
    The simulate-ATA-over-SCSI code is moved to a new function,
    ata_scsi_simulate(), and ata_scsi_rw_queue() is renamed to
    ata_scsi_translate().  With the SCSI CDB debugging dump function
    also moved into its own function, the queue-command path is now
    nice, compact, and readable.

commit 7168c14d40f439b3cb3d1e0c371df25f928beb85
Author: Jeff Garzik <jgarzik@redhat.com>
Date:   Thu Mar 25 17:32:10 2004 -0500

    [libata] more command queue path cleanup
    
    A new helper ata_scsi_xlat_possible(), and the command queue path
    gets a bit more compact.
    
    As side effects we kill the 'cmd_size' argument from two functions,
    and mark ata_scsi_rw_queue() as static, as its only needed
    in libata-scsi.c.

commit 2505cc5c1ddb23f1d726d31e9553868b69126b91
Author: Jeff Garzik <jgarzik@redhat.com>
Date:   Thu Mar 25 17:20:47 2004 -0500

    [libata] clean up command queue/submit path a bit
    
    This change is part of a series that compartmentalizes and consolidates
    ATA taskfile submission.
    
    Here, the device-location-related checks are moved out of the ->queuecommand()
    hook and into an inline helper function.

commit baf3f9d40c6b188572235ea4d7de6c60e7feb41a
Author: Jeff Garzik <jgarzik@redhat.com>
Date:   Thu Mar 25 15:13:20 2004 -0500

    [libata sata_promise] minor initialization updates
    
    * remove incorrect PATA port check
    * enable undocumented bit 13 in flash control register,
      because the Promise driver does so.
    * wait 10 ms after setting TBG mode, for the same reason.

commit 288c759b0a271bc7e21d7ef44c3c87bb3929e7c8
Merge: 67f3362... a81ac25...
Author: Anton Altaparmakov <aia21@cantab.net>
Date:   Thu Mar 25 13:00:53 2004 +0000

    Merge cantab.net:/usr/src/bklinux-2.6 into cantab.net:/usr/src/ntfs-2.6

commit d55147d0c707e4fee412c322f82763b69861a55b
Author: Steve French <stevef@stevef95.austin.ibm.com>
Date:   Thu Mar 25 06:34:51 2004 -0600

    fixes for fsx truncate/readahead/writebehind bug

commit f1a33a9841da69f997e9e1f7639765c48c2be365
Author: Jeff Garzik <jgarzik@redhat.com>
Date:   Thu Mar 25 07:23:41 2004 -0500

    [libata] documentation, and a couple tiny cleanups
    
    Add more per-function source code documentation.  Some of this stuff
    is esoteric ATA crapola, and definitely needed to be documented.
    
    Also, two tiny cleanups spotted while documenting:
    * kill unused arg from internal function ata_dev_try_classify()
    * kill unused return value from ata_dev_id_string()

commit e5e009141dbad3a9f4991a20d6f3175eab7f8942
Author: David Mosberger <davidm@tiger.hpl.hp.com>
Date:   Thu Mar 25 02:06:36 2004 -0800

    ia64: Patch by Stephane Eranian: remove irq_stat from cpuinfo_ia64.
    
    irq_stat isn't needed anymore since its members got rolled into
    thread_info.preempt_count.

commit dc3189583b4dd314271cf688957ed4cff58260d1
Author: Jeff Garzik <jgarzik@redhat.com>
Date:   Thu Mar 25 04:40:17 2004 -0500

    [libata] use scsi host lock
    
    In 2.4 we release io_request_lock and take our own per-host lock,
    in the ->queuecommand() hook.  In 2.6, the SCSI layer provides a
    useful to simply use the lock we already have, via scsi_assign_lock().

commit 2932b498f035c8d2a9648456a5eb03c775dc6342
Author: Jeff Garzik <jgarzik@redhat.com>
Date:   Thu Mar 25 04:36:59 2004 -0500

    [libata] reduce diff with 2.4 libata backport

commit c22f5a78bb31b3e1a5896f6f65abd6e2d675f9f3
Author: Jeff Garzik <jgarzik@redhat.com>
Date:   Thu Mar 25 04:36:27 2004 -0500

    [libata] pci_dma_error() was renamed to pci_dma_mapping_error()

commit 0e80d43297ef120f1e066785671afc6018bb69f2
Author: Arjan van de Ven <arjanv@redhat.com>
Date:   Thu Mar 25 01:19:38 2004 -0800

    [PATCH] USB: usb hiddev stack usage patch
    
    Patch below fixes some obscenely high stack uage;
    struct hiddev_usage_ref_multi is well over 4Kb in size so really doesn't
    belong on the stack.

commit 6f4388bc2c5f5216ebdf2deaa9f2985c9a010cbe
Author: Oliver Neukum <oliver@neukum.org>
Date:   Thu Mar 25 01:19:03 2004 -0800

    [PATCH] USB: fix error paths in kobil_sct
    
    some error codes are incorrect and there's an URB leak in an error path.

commit b9a6892437dced0ffcb438aa4c40bb2db90ce0b4
Merge: f158809... 04b29c9...
Author: Jeff Garzik <jgarzik@redhat.com>
Date:   Thu Mar 25 04:18:04 2004 -0500

    Merge redhat.com:/spare/repo/linux-2.6
    into redhat.com:/spare/repo/libata-2.6

commit 33d61f2420b1e7521a89107ece6a4ed758d25b28
Author: Alan Stern <stern@rowland.harvard.edu>
Date:   Thu Mar 25 01:18:01 2004 -0800

    [PATCH] USB: UHCI: Get rid of excessive spinlocks
    
    This patch introduces a major simplification into the UHCI driver by
    replacing its multiple spinlocks with a single one.  The protected area of
    code is slightly larger and there's more possibilities for contention on
    an SMP system, but I think that shouldn't be a problem.  Stephen Hemminger
    has been kind enough to test this on his SMP computer and he hasn't
    encountered any difficulties.

commit 2212df84bf7b5cf81759829a7854e6ebe9335fcf
Author: Alan Stern <stern@rowland.harvard.edu>
Date:   Thu Mar 25 01:17:18 2004 -0800

    [PATCH] USB: UHCI: Improved handling of short control transfers
    
    This patch simplies the way the UHCI driver handles short control
    transfers.  When a transfer is short the HC will stop handling that
    endpoint, and it's necessary to get it going again so that the status
    stage of the control transfer can take place.  Currently the driver does
    this by allocating a new QH for the transfer and setting its element
    pointer to point at the final status TD.  The old QH is recycled.  But
    it's not necessary to go to all that trouble; the element pointer in the
    original QH can be updated directly.
    
    Normally the element pointer is supposed to be owned by the HC, and it's
    not safe to just change its value since the HC may overwrite it at any
    time.  But when a transfer is stopped because of a short packet, the
    current TD is marked inactive and the HC will not update the element
    pointer.  To write an unchanged pointer value back to memory would be a
    waste of PCI bus cycles.  Now the UHCI spec doesn't say explicitly that an
    HC _can't_ do this, but I've tested both Intel and VIA hardware and
    neither of them does.
    
    As a side effect of this change, some of the code for removing QHs can be
    eliminated.

commit 6bfb25193a1f08dbcdca846153f614b773eb9a67
Author: Alan Stern <stern@rowland.harvard.edu>
Date:   Thu Mar 25 01:16:33 2004 -0800

    [PATCH] USB: UHCI: Do short packet detection correctly
    
    This patch makes some simple changes to the way the UHCI driver does short
    packet detection.  The current implementation is incorrect in several
    ways:
    
    	The Short-Packet-Detect flag is set for OUT transfers, which
    	yields undefined behavior according to the UHCI spec.
    
    	It's not set for URBs with URB_SHORT_NOT_OK, which is just the
    	opposite of what we want!  Those are the ones where short packets
    	do matter.
    
    	It is set for the last packet in a transfer, which causes an
    	unnecessary pause in the data flow (except of course that the
    	pause _is_ necessary when URB_SHORT_NOT_OK is set).
    
    The patch also implements the URB_NO_INTERRUPT flag for bulk transfers,
    which can help improve system performance by reducing interrupt overhead.

commit 5994187764a9ea2a41b26450b74fa53b0970aea1
Author: Alan Stern <stern@rowland.harvard.edu>
Date:   Thu Mar 25 01:06:47 2004 -0800

    [PATCH] USB: Don't trust raw descriptor length in devioc.
    
    This is a very minor point, unlikely ever to come up.  But just in case...
    
    It's conceivable that a device might transmit different values for a
    configuration descriptor's wTotalLength the first time we ask for it (in
    order to get the length) and the second time (to get the entire
    descriptor).  Should that improbable event occur, the rawdescriptor buffer
    could be allocated using a size that's smaller than the length recorded in
    the rawdescriptor itself.  This patch protects devio.c against such a
    problem.
    
    If you feel this sequence of events is too unlikely to worry about, then
    don't bother to apply the patch.

commit af6f5064170ebb6472c9d21928b58d324ae9e544
Author: Oliver Neukum <oliver@neukum.org>
Date:   Thu Mar 25 00:53:25 2004 -0800

    [PATCH] USB: race condition in open of w9968cf
    
    there's a race in how open handles multiple openers.
    You implement exclusive opening and wait for close
    in case of further openers. However if there are more than one
    waiter, only one of them must be allowed to proceed.

commit c107b960d49099e5fd0863134df42db2ca2e4e3b
Author: Alan Stern <stern@rowland.harvard.edu>
Date:   Thu Mar 25 00:52:38 2004 -0800

    [PATCH] USB: Unusual_devs.h update
    
    On Thu, 18 Mar 2004, Urban Borstnik wrote:
    
    > The 2.6.4 and 2.6.3 (and possibly some earlier) kernels log the
    > following message when I plug in a Lexar CompactFlash Reader:
    >
    > usb-storage: This device (05dc,b002,0113 S 06 P 50) has unneeded
    > SubClass and Protocol entries in unusual_devs.h
    >    Please send a copy of this message to <linux-usb-devel@lists.sourceforge.net>
    >
    > Otherwise it has been working very well with the devepment kernels on at
    > least 4 machines ever since a trivial fix was introduced for this device
    > to unusual_devs.c over a year ago.
    >
    > Best regards,
    > Urban.
    
    Thank you for sending this in.  An update will appear soon.

commit befe2d08adcadd38ed7f207df2e616a7f7ab3896
Author: Torrey Hoffman <thoffman@arnor.net>
Date:   Thu Mar 25 00:41:16 2004 -0800

    [PATCH] USB: fix race in ati_remote and small cleanup
    
    On Thu, 2004-03-18 at 07:44, Oliver Neukum wrote:
    > Hi,
    >
    > you must use set_current_state() only after usb_submit_urb() with GFP_KERNEL
    > as second argument, because it may sleep to allocate memory and is woken up
    > resetting the state to TASK_RUNNING. In that case you had a busy polling loop.
    > Furthermore, always use wake_up unconditionally. It checkes anyway.
    
    Thanks for reviewing this code, I'm new to Linux driver development and
    more eyes on my work is a good thing.   I've actually been working on
    some more cleanups to the driver to fix the race between open and
    disconnect, and was just about to send it in...
    
    So, the attached patch against 2.6.5-rc1-mm1 includes a mutex to lock
    the open/disconnect paths, modelled after the usb-skeleton driver. It
    includes Oliver Neukum's fixes and other cleanups as well.

commit df73571ed6ee83e6892adce410ce61aa0bcad607
Author: Michael Still <mikal@stillhq.com>
Date:   Thu Mar 25 00:20:30 2004 -0800

    [PATCH] USB: kernel-doc comment tweak in vicam.c
    
    Correct kernel-doc comment with incorrect parameters documented

commit 3bad5571477d0647df44219efdc4e8edaecde3a6
Author: Alan Stern <stern@rowland.harvard.edu>
Date:   Thu Mar 25 00:15:24 2004 -0800

    [PATCH] USB: Regularize unusual_devs entries for Genesys Logic
    
    I saw that you just added another unusual_devs.h entry submitted by
    Henning Schild, for vendor ID 0x05e3.  It turns out this is our old friend
    Genesys Logic.
    
    A recent message from Brad Campbell included a Windows driver file by
    Genesys, and it included these lines:
    
    USB\VID_05E3&PID_0700.DeviceDesc="USB Card Reader"
    USB\VID_05E3&PID_0701.DeviceDesc="USB Optical Device"
    USB\VID_05E3&PID_0702.DeviceDesc="USB Mass Storage Device"
    
    Based on this information, we can clean up the 0x05e3 entries in
    unusual_devs.h.  This patch puts all three entries into a regularized
    form.

commit 892a303c9f25cd898911e597403ee0183893272c
Author: Alan Stern <stern@rowland.harvard.edu>
Date:   Thu Mar 25 00:14:29 2004 -0800

    [PATCH] USB: Unusual_devs update
    
    On Tue, 16 Mar 2004, John Katzmaier wrote:
    
    > Hi,
    >
    > Just wanted to let you know that when using my Panasonic PV-SD4090 digital
    > camera with kernel 2.6.3, I found this entry in my logs:
    >
    > Mar 16 21:43:27 rocket kernel: usb-storage: Vendor: Panasonic
    > Mar 16 21:43:27 rocket kernel: usb-storage: Product: LS-120 Camera
    > Mar 16 21:43:27 rocket kernel: usb-storage: This device (04da,0901,0109 S 00 P
    > 00) has an unneeded Protocol entry in unusual_devs.h
    > Mar 16 21:43:27 rocket kernel:    Please send a copy of this message to
    > <linux-usb-devel@lists.sourceforge.net>
    >
    > I thought it might be best to follow its instructions and so I did.
    >
    > Thanks.
    >
    > -John Katzmaier
    
    Thank you for sending this in.  An update will appear in a forthcoming
    kernel.
    
    Greg, here's the patch.

commit 9b9f631e788757f7e2ef7429142c754a904c5b1a
Author: David Brownell <david-b@pacbell.net>
Date:   Thu Mar 25 00:06:44 2004 -0800

    [PATCH] USB: fix osdl bugid 2006 (timer init and fault paths)
    
    Need to initialize timers a bit earlier to handle
    certain initialization faults.
    
    
    OSDL bug 2006
    
    Need to initialize some timers a bit earlier to clean up safely
    after very early init HCD failures.
    
    Those early init faults were needlessly mysterious since they
    didn't emit diagnostics except at HCD discretion.

commit ff256570599238cfaaafb7e147e0d971209ce234
Author: David Brownell <david-b@pacbell.net>
Date:   Wed Mar 24 23:56:56 2004 -0800

    [PATCH] USB: fix osdl bugid 481 (USB boot messages)
    
    Some boot-time messages were obnoxiously long because
    they used "old-style" diagnostics.
    
    
    OSDL bugid 481
    
    Get rid of most remaining "old style" diagnostics from usbcore.
    Most messages use driver model style diagnostics.  Messages that
    don't have an associated device use the standard kernel printk
    wrappers and label themselves as from "usbcore".  (Except that
    there's no such wrapper for KERN_ERR.)
    
    This doesn't touch usbfs, "config.c" (Alan's patches do this), or
    usb_reset_device() (needs a more substantial overhaul).  Or any
    other USB drivers (notably HID).

commit c3d3c47239213af161451e5e21583622fea79262
Author: Alan Stern <stern@rowland.harvard.edu>
Date:   Wed Mar 24 23:17:16 2004 -0800

    [PATCH] USB: Code improvements for core/config.c
    
    This patch makes some improvements to the code in config.c.
    
    	Create a subroutine to handle the repeated task of skipping
    	forward to the next descriptor of a certain type.
    
    	Remove some fairly useless debugging messages (they could
    	never even have been enabled in the pre-as221 code).
    
    	Verify that endpoint descriptors don't have an address
    	equal to 0 (as well as not being above 15).
    
    	Rename some local variables so they are a little more
    	consistent and meaningful.
    
    Despite all the changes, the functionality should remain the same.
    Please apply.

commit e51bf644ce8227779006aea1fe9b12cf63b498f1
Author: Alan Stern <stern@rowland.harvard.edu>
Date:   Wed Mar 24 23:16:15 2004 -0800

    [PATCH] USB: Improve core/config.c error messages
    
    This patch improves error reporting in the configuration parsing routines.
    It also adds a few extra minor tweaks.
    
    	#include linux/config.h and make the usual DEBUG settings
    	available.
    
    	Use the driver-model dev_xxx() macros for log output.
    
    	Be much more explicit about the nature of errors, including
    	configuration, interface, and altsetting numbers where
    	appropriate.
    
    	Log fatal problems as errors, non-fatal ones as warnings.
    
    	Remove a #define'd constant that is already set in linux/usb.h.
    
    	Fix some variables declared as pointer to char that really
    	should be pointers to unsigned char.
    
    	Replace a whole bunch of "out-of-memory" error messages with
    	a single message.
    
    	Wrap source lines that are longer than 80 columns (but not
    	log output lines!).
    
    	Clean up the logic for detecting errors when retrieving a
    	configuration descriptor.
    
    Apart from the log messages themselves, this introduces no functional
    changes.

commit b71db443ea7998de4dfddce7adad640db70f221c
Author: David Brownell <david-b@pacbell.net>
Date:   Wed Mar 24 21:43:15 2004 -0800

    [PATCH] USB: USB gadgets can autoconfigure endpoints
    
    This adds some code that gadget drivers can call from
    driver initialization, to simplify the "configure against
    this hardware" step.
    
    
    Add endpoint autoconfiguration for gadget drivers.
    
    Endpoint selection is currently being done with conditional compilation.
    That doesn't look nice, but more importantly it doesn't work well with
    the model that some distributions won't be custom-matched to hardware.
    Say, a PDA distro running on iPaq (pxa2xx_udc) or Axim (mq11xx_udc).
    
    This code just makes it easier for drivers to match to hardware at
    run-time.  It's a convenience function for something they could have
    been doing already, but weren't.

commit f5cd10245b11f86e5f36c4de86775b39a8f1c634
Author: Greg Kroah-Hartman <greg@kroah.com>
Date:   Wed Mar 24 19:53:52 2004 -0800

    [PATCH] USB: add cytherm driver to the build

commit 61e91dd20f9cc8c1f498edfbc20ac46aab44805b
Author: Erik Rigtorp <erik@rigtorp.com>
Date:   Wed Mar 24 19:53:27 2004 -0800

    [PATCH] USB: new cypress thermometer driver

commit 1affd9dab3c738e814d450047220d77e9b859cbb
Author: Petko Manolov <petkan@nucleusys.com>
Date:   Wed Mar 24 19:31:25 2004 -0800

    [PATCH] USB: rtl8150 update
    
    adds two more vid/did and better packet error statistics.  Link
    detection also has been added.

commit 71640f89bd172442f19ecfac4bce9fc71d79f93a
Author: David Brownell <david-b@pacbell.net>
Date:   Wed Mar 24 19:30:58 2004 -0800

    [PATCH] USB: gadget zero does endpoint autoconfig
    
    Here's where all those preceding autoconfig patches start
    to fit together:  one gadget driver gets rid of almost all
    the controller-specific #ifdeffery.
    
    Two of the other gadget drivers can do the same thing,
    and just as easily:  file storage, and serial.  (I'll
    hope their maintainers do those changes though.)
    
    The "ether.c" gadget driver is a lot more complicated to
    do this way since it has to cope with some differences
    by switching to alternate protocols (CDC Ethernet vs
    a subset) and soon be able to handle RNDIS.  So that'll
    be a while yet.
    
    
    Gadget Zero learns to autoconfigure.
    
        - Gets rid of remaining controller-specific #ifdeffery.  Now
          hardware choices can be made at run time too (not just
          compile time).
    
        - Simplifies its use of the "DEBUG" CPP symbol.
    
        - Force device to report itself consistently as self-powered.

commit 4992d46a98f495859d20ca97c5e450d947d10a11
Author: Michael Still <mikal@stillhq.com>
Date:   Wed Mar 24 19:05:11 2004 -0800

    [PATCH] USB: kernel-doc comment tweak
    
    Correct kernel-doc comment with incorrect parameters documented

commit 08e60f3ad445363e0ef05c3edf67c81af0556fb6
Author: Gude Analog- und Digitalsysteme GmbH <mail@gude.info>
Date:   Wed Mar 24 19:04:37 2004 -0800

    [PATCH] USB: FTDI 232BM "USB-RS232 OptoBridge"
    
    we (the german company Gude Analog und Digitalsysteme GmbH,
    http://www.gude.info) have manufactored a USB<->RS232 adapter with
    galvanic isolated RS232 Interface. Data is transmitted by optical
    signals only.
    
    The Product's name is "USB-RS232 OptoBridge".
    We used the FTDI 233BM Chip with PID 0xE889 (VID 0x0403).
    The Product will be released this Cebit 2004.
    
    Could you please extend the ftdi_sio code with this PID.
    You find a .diff file attached which I have tested with kernel 2.6.4
    
    At http://ftdi-usb-sio.sourceforge.net/ I saw that you provide a patch
    for 2.4.x kernels. Will our PID also find it's way in this back-ported
    driver patch?
    
    In the future (in the next 10 month), our company will have some more
    Products using the FTDI Chip. The PID's FTDI already allocated for us
    are: E888 to E88F and E808 to E80F
    
    
    Thank you very much,
       Martin Bachem

commit 7b218f51797e7dc1462bf2130d7135cfccf8cc3b
Author: Jean Delvare <khali@linux-fr.org>
Date:   Wed Mar 24 18:51:45 2004 -0800

    [PATCH] I2C: initialize fan_mins in w83781d, asb100 and lm78
    
    Quoting myself:
    
    > While testing, I found a corner case that isn't handled properly. It
    > doesn't seem to be handled by the lm78 and the asb100 either. Setting
    > fanN_div before ever reading from the chip or setting fanN_min will
    > make use of fanN_min while it was never initialized.
    
    The following patch addesses the issue. Tested to work on my AS99127F
    rev.1 (which means that only the changes to the w83781d driver were
    actually tested). Testers welcome.

commit b3da4be8eba471eb4666f7b27930fad4d43b1112
Author: Jean Delvare <khali@linux-fr.org>
Date:   Wed Mar 24 18:50:47 2004 -0800

    [PATCH] I2C: Discard out-of-date comment in adm1021 driver
    
    This simple patch discards an out-of-date comment in the adm1021 driver.
    I've done the same in our CVS repository where many more drivers were
    affected.
    
    I agree it's not very important, but I prefer it to be done before any
    driver with the error is used as a base to port a new driver, and the
    misinformation spreads.

commit 1e5467ae0bc98f0720d26124adbd5d4e69ed9f2d
Author: Hanna V. Linder <hannal@us.ibm.com>
Date:   Wed Mar 24 18:44:05 2004 -0800

    [PATCH] added class support to istallion.c
    
    Here is a patch to add class support to the Stallion Intelligent multiport
    serial driver.

commit 3efbacde438ab9c774e8b6f8b351d0ce6c329fd4
Author: Hanna V. Linder <hannal@us.ibm.com>
Date:   Wed Mar 24 18:43:11 2004 -0800

    [PATCH] added class support to stallion.c
    
    Here is a patch to add class support to the Stallion multiport
    serial driver.

commit 7713a12dda642d6740932a3ed728eba7108160af
Merge: e56dba3... 3b2c9f6...
Author: Steve French <cifs.adm@hostme.bitkeeper.com>
Date:   Wed Mar 24 16:42:53 2004 -0800

    Merge bk://linux.bkbits.net/linux-2.5
    into hostme.bitkeeper.com:/repos/c/cifs/linux-2.5cifs

commit 04b29c99f52b8bdd20395d35483c45979bce7a26
Author: Jeff Garzik <jgarzik@redhat.com>
Date:   Wed Mar 24 15:57:34 2004 -0500

    [ata] move some generic stuff linux/libata.h -> linux/ata.h
    
    struct ata_taskfile is generic, and so far its flags (ATA_TFLAG_xxx)
    
    Also, move ATA_PROT_xxx definitions into their own enum.

commit 263924d7cd3f91ccdee34bc79216dc520aa6e046
Author: Jeff Garzik <jgarzik@redhat.com>
Date:   Wed Mar 24 15:44:08 2004 -0500

    [libata] consolidate data transfer mode handling
    
    The various ways you can send data to/from your ATA device is
    known as the ATA taskfile protocol:  PIO single sector, PIO
    multiple sector, DMA, DMA TCQ, DMA NCQ, ...
    
    Prior to this change, the data direction (read/write) was encoded
    implicitly into the ATA_PROT_xxx value itself.  This increased
    complexity in some areas, and inhibited flexibility in others.
    
    This change separates data direction from taskfile protocol, and also
    moves the data direction flag (ATA_QCFLAG_WRITE) down to a lower
    level (ATA_TFLAG_WRITE).

commit 3b64bb0c7a16402f8614754bf3424c579cd0e1a6
Author: Jeff Garzik <jgarzik@redhat.com>
Date:   Wed Mar 24 14:53:07 2004 -0500

    [libata] set up some of the per-command data beforehand
    
    The data transfer mode and the set of read/write commands we generate
    during normal operation remains constant until we change the data
    transfer mode.
    
    This removes a series of branches in the read/write fast path,
    and in general cleans up that particular spot of code.

commit afca2f6962bde8e41446b622cea18655c384032f
Author: Jeff Garzik <jgarzik@redhat.com>
Date:   Wed Mar 24 13:50:34 2004 -0500

    [libata sata_promise] check for PATA port on PDC20375
    
    We don't handle it yet, but this prints out a message in its presence,
    permitting verification of the check and informing users why their
    PATA device is not recognized.

commit 83242623d9ccef79cbbe936e13359f1f83d48c2c
Author: Jeff Garzik <jgarzik@redhat.com>
Date:   Tue Mar 23 02:35:54 2004 -0500

    [libata ata_piix] fix combined mode device detection
    
    SATA port detection should not have assumed that a single SATA port
    mapped to a single struct ata_port.  Combined mode breaks this
    assumption.
    
    Change code to simply detect if one or more devices are present
    on the struct ata_port, which is what we really wanted to do.

commit 208d680daaac6564b64b3004db93e2de7f020efa
Author: Jeff Garzik <jgarzik@redhat.com>
Date:   Tue Mar 23 01:52:00 2004 -0500

    [libata ata_piix] clean up combined mode handling

commit bc9ec2ac22f8a7b0df24cc777e1cacc99882dbac
Author: Jeff Garzik <jgarzik@redhat.com>
Date:   Tue Mar 23 01:14:06 2004 -0500

    [libata ata_piix] do not disable SATA port on module unload
    
    We were disabling the SATA port, but not enabling it on module load.
    So, modprobe+rmmod+modprobe would fail.

commit 93fcbf554250b2c9263266e401ff9f8d46d51db6
Author: Jeff Garzik <jgarzik@redhat.com>
Date:   Mon Mar 22 23:20:14 2004 -0500

    [libata] use kmap_atomic() rather than kmap()

commit b1776b04ae7a0623c5fa8611770593011fe3a01f
Author: Jeff Garzik <jgarzik@redhat.com>
Date:   Mon Mar 22 14:15:58 2004 -0500

    Create PCI_DMA_{64,32]BIT constants, for use in passing to
    pci_set_{consistent_}dma_mask().
    
    Use them in e1000 and ixgb.

commit db87fc1bdff4cd7dffc04bd1b3d21d88746472c9
Author: Jeff Garzik <jgarzik@redhat.com>
Date:   Mon Mar 22 13:40:01 2004 -0500

    [libata] use new pci_dma_error() to check for pci_map_single() failure

commit 651d0404d54c1cf37e78756073e71fc61a4eea60
Merge: 6d2b5ef... 1fef2a5...
Author: Jeff Garzik <jgarzik@redhat.com>
Date:   Mon Mar 22 13:25:09 2004 -0500

    Merge redhat.com:/spare/repo/linux-2.6
    into redhat.com:/spare/repo/libata-2.6

commit c2ab0b0995e2c1b43656dbf50ff3f14f0b0eedb7
Author: Jeff Garzik <jgarzik@redhat.com>
Date:   Mon Mar 22 11:48:26 2004 -0500

    [MAINTAINERS] remove mention of defunct linux-via mailing list
    
    Noticed by Adrian Bunk.

commit de56346d09bd39f9903c4f74ab4ad8d50a9001c6
Author: Jeff Garzik <jgarzik@redhat.com>
Date:   Mon Mar 22 11:47:47 2004 -0500

    [BK] ignore build-generated files in scripts/basic/ and drivers/md/

commit 6c2b065d5ceeb2014c62e54f1e8bf37c52a4defc
Author: Jeff Garzik <jgarzik@redhat.com>
Date:   Mon Mar 22 07:24:10 2004 -0500

    Remove mention of non-existent tulip.txt from Doc/netwrk/00-INDEX

commit 1fef2a53d47b6287634f5518e8780e20ac171c9e
Merge: ed40752... 0faf726...
Author: Jeff Garzik <jgarzik@redhat.com>
Date:   Mon Mar 22 04:15:33 2004 -0500

    Merge redhat.com:/spare/repo/linux-2.6
    into redhat.com:/spare/repo/libata-2.6

commit 17e8ea4030fbe1e3f05c247aedff05c7f1c6d04f
Author: Luca Tettamanti <kronos@kronoz.cjb.net>
Date:   Sun Mar 21 19:47:06 2004 -0800

    [PATCH] Sysfs for framebuffer
    
    the following patch (against 2.6.5-rc2) teaches fb to use class_simple.
    With this patch udev will automagically create device nodes for each
    framebuffer registered. Once all drivers are converted to
    framebuffer_{alloc,release} we can switch to our own class.
    
    This is what sysfs dir looks like:
    
    notebook:~# tree /sys/class/graphics/
    /sys/class/graphics/
    `-- fb0
        `-- dev

commit cd06e33f6a29a61fc839905e7938a4210caffb4a
Author: James Bottomley <james.bottomley@steeleye.com>
Date:   Sun Mar 21 02:55:19 2004 -0500

    [PATCH] More domain validation fixes and additions
    
    Following testing in more extreme situations, the following problems
    turned up:
    
    - The error handler can offline the device during DV (most particularly
    true when transport parameters are undetectably mismatched).  Fixed by
    modifying the state model to allow this and then having DV set the
    device back online for the retry.
    
    - DV needs to be serialised.  Fixed by introducing a per device
    semaphore.
    
    - Cosmetically, it's nice to trigger DV from userland, so added a
    revalidate sysfs entry.

commit 1606be01744071039a8814715e38068ba56d60dd
Merge: a21f4a1... 4ad1e20...
Author: James Bottomley <jejb@mulgrave.(none)>
Date:   Sun Mar 21 02:34:41 2004 -0500

    Merge mulgrave.(none):/home/jejb/BK/scsi-for-linus-2.6
    into mulgrave.(none):/home/jejb/BK/scsi-misc-2.6

commit 0faf726978e54773885c18c0f842c43f1106cc0c
Author: Jeff Garzik <jgarzik@redhat.com>
Date:   Sun Mar 21 02:15:16 2004 -0500

    [libata sata_sis] minor cleanups

commit 7e01873d1008a71d1dd080c70858cdff44ae9acd
Author: Uwe Koziolek <uwe.koziolek@gmx.net>
Date:   Sun Mar 21 01:55:35 2004 -0500

    [libata] Add driver for SiS 964/180 SATA.

commit e56dba39793e2fe5b93f349322122f51b3fdd79f
Merge: 5b02299... 366bf3a...
Author: Steve French <cifs.adm@hostme.bitkeeper.com>
Date:   Fri Mar 19 23:27:50 2004 -0800

    Merge bk://linux.bkbits.net/linux-2.5
    into hostme.bitkeeper.com:/repos/c/cifs/linux-2.5cifs

commit a21f4a1cc54102832d7216e76575340a6b40234b
Merge: 5a35e7c... 283038b...
Author: James Bottomley <jejb@mulgrave.(none)>
Date:   Fri Mar 19 23:07:58 2004 -0500

    Merge

commit 283038bdef3d8a08502464cc50678ae9d391ce54
Author: Andrew Morton <akpm@osdl.org>
Date:   Fri Mar 19 22:55:39 2004 -0500

    [PATCH] Fix scsi_transport_spi.c for gcc-2.95.3
    
    Work around the gcc-2.95 token pasting bug.

commit 1197daff04ae44883936e3a994c19a85be4945f7
Author: Dave Jones <davej@redhat.com>
Date:   Fri Mar 19 20:55:49 2004 +0000

    [CPUFREQ] Extra __init section function for longhaul driver.
    From Luiz Fernando Capitulino

commit 632610484f32ea9e4a0aac6e481f75335ef2c6a2
Author: Dave Jones <davej@redhat.com>
Date:   Fri Mar 19 20:54:42 2004 +0000

    [CPUFREQ] Extra __init section function for longrun driver.
    From Luiz Fernando Capitulino

commit 6d94125c6d037193a7097f4493d45de0b44c2685
Author: Dave Jones <davej@redhat.com>
Date:   Fri Mar 19 20:53:17 2004 +0000

    [CPUFREQ] Fix an off-by-10 value in the detection of the Pentium M processor frequency.

commit d9fa7b95f183ae1a1153af82242e4b9cd2a58612
Author: Dave Jones <davej@redhat.com>
Date:   Fri Mar 19 20:51:11 2004 +0000

    [CPUFREQ] SPEEDSTEP_RELAXED_CAP_CHECK option.
    A few SpeedStep-capable systems don't perform according to specification: the
    CPUID and/or some MSRs don't tell us the CPU is SpeedStep capable even though
    it definitely is. Allow a relaxed checking for one such issue by a module
    parameter only available if a config option is turned on. This is done to
    avoid the risk of doing invalid speedstep instructions on systems which do
    not support it, and which might even lead to (hardware) failure.
    
    Patch originally from Andres Aeriksson (?) aeriksson at fastmail (dot) fm

commit f826780003ea6bc6c8cf27f7b45042cc56f339b7
Author: Dave Jones <davej@redhat.com>
Date:   Fri Mar 19 20:47:48 2004 +0000

    [CPUFREQ] Fix up centrino initcall level
    centrino_init needs to be late_initcall so that the ACPI processor module
    is completely up and running.

commit b861df79f78457a8b6340b8bbc6705720d9e1abe
Author: Dave Jones <davej@redhat.com>
Date:   Fri Mar 19 20:46:16 2004 +0000

    [CPUFREQ] Export an array of available frequency settings of the centrino driver.

commit caf8b28d120e45a115d746b56fb5abd2bdbc88b9
Author: Dave Jones <davej@redhat.com>
Date:   Fri Mar 19 20:44:09 2004 +0000

    [CPUFREQ] Merge ACPI perflib.
    Use ACPI _PSS data to determine valid frequency and voltage pairs on Enhanced
    SpeedStep-capable processors. An original form of such ACPI-PentiumM-cpufreq
    interaction was sent to the cpufreq list by David Moore in June last year; the
    attached patch utilizes his code to set _PDC.
    
    The new ACPI "P-States library" is utilized to obtain the correct frequency
    and MSR value pairs for the speedstep-centrino driver. Only if no such proper
    table exists (!CONFIG_ACPI, broken ACPI tables, etc.), fall back to the
    existing hard-coded table.
    
    If anyone has a better idea for the Kconfig section, please tell me so.
    
    This version of this patch has proper acpi_state setting included, and also
    has a hint in the banner of the centrino_cpu_init_acpi() function, as Jeremey
    Fitzhardinge suggested.

commit fff43b92b9775a88e220eee55bb99eaba347f740
Author: Dave Jones <davej@redhat.com>
Date:   Fri Mar 19 20:43:06 2004 +0000

    [CPUFREQ] Move the centrino table matching into an own function
    Only the FEATURE_EST bit for CPU 0 is checked in module_init() directly.
    As cpufreq drivers aren't sticky any longer (see previous patch),
    this will not change user-visible behaviour.

commit cfe97b43f1474fb1c15750cd63183ee94440bb3a
Author: Dave Jones <davej@redhat.com>
Date:   Fri Mar 19 20:36:51 2004 +0000

    [CPUFREQ] Use KERN_WARNING for warning.

commit 7cc9f0d9a1ab04cedc60d64fd8dcf7df224a3b4d
Author: Dave Jones <davej@redhat.com>
Date:   Fri Mar 19 20:35:52 2004 +0000

    [CPUFREQ] If ->init fails, unregister cpufreq driver.
    Some cpufreq drivers can only tell whether they work while the per-CPU
    ->init() function is executed [e.g. the acpi driver]. So that cpufreq_driver
    isn't blocked by such stale drivers, unload them unless the driver sets a
    special flag.

commit a81ac254fae2e6d328c36abcf30ab956a7353f6b
Merge: 6300f69... df8781b...
Author: Anton Altaparmakov <aia21@cantab.net>
Date:   Fri Mar 19 10:26:18 2004 +0000

    Merge cantab.net:/home/src/bklinux-2.6
    into cantab.net:/home/src/ntfs-2.6

commit 2df5f2d5681969e625eb7dafc554b9b065231c6d
Author: Hanna V. Linder <hannal@us.ibm.com>
Date:   Fri Mar 19 00:39:37 2004 -0800

    [PATCH] add class support to floppy tape driver zftape-init.c
    
    Here is a patch to add class support to zftape-init.c:
    
    MODULE_DESCRIPTION(ZFTAPE_VERSION " - "
                       "VFS interface for the Linux floppy tape driver. "
                       "Support for QIC-113 compatible volume table "
                       "and builtin compression (lzrw3 algorithm)");
    
    I have verified it compiles but do not have the hardware to test it.

commit 694b0b328d951e7c6d8714c00a22f3ec9cdf4e2d
Author: Hanna V. Linder <hannal@us.ibm.com>
Date:   Fri Mar 19 00:39:16 2004 -0800

    [PATCH] QIC-02 tape drive hookup to classes in sysfs
    
    Here is a patch to hook up the qic02 tape device to have class
    support in sysfs. I have verified it compiles. I do not have access to
    the hardware to test. Could someone who does please verify?
    
     From the file:
     * This is a driver for the Wangtek 5150 tape drive with
     * a QIC-02 controller for ISA-PC type computers.
     * Hopefully it will work with other QIC-02 tape drives as well.

commit 667de9e824ae559dfb8e67f7cbe5be3ce807c4ad
Author: Greg Kroah-Hartman <greg@kroah.com>
Date:   Thu Mar 18 22:15:17 2004 -0800

    Driver class: remove possible oops
    
    This happens when the device associated with a class device goes away before
    the class does.

commit c395ba5176fa5979ba1a07b321ab96c5918412c4
Author: Aurelien Jarno <aurelien@aurel32.net>
Date:   Thu Mar 18 21:24:39 2004 -0800

    [PATCH] I2C: add new chip driver: pcf8574
    
    Please find below a patch against kernel 2.6.5-rc1 to add the pcf8574
    driver (an I/O expander for the I2C bus). I have ported it from the 2.4
    version, and it includes some fixes and simplifications.
    
    It has been reviewed by Jean Delvare on IRC.

commit 004215f8ce0e321e9082cdb09d2266fbdcc34361
Author: Jean Delvare <khali@linux-fr.org>
Date:   Thu Mar 18 21:24:14 2004 -0800

    [PATCH] I2C: w83781d fan_div code refactoring
    
    Quoting myself:
    
    > This tends to increase the size of the three set_store_regs_fan_div
    > functions, and I am considering refactoring them at some point. Later
    > though.
    
    Here is the promised refactoring. Tested on my AS99127F rev.1, seems to
    work. As for the previous patch, there is a part that I cannot test with
    the AS99127F, so additional testing is welcome.
    
    I agree this makes the code slightly less readable, but this saves 60
    lines of code (1754 bytes, around 3% of the driver total), and is
    actually far less complex that I first feared.

commit 6746ea4db53794205cd21f56fa71c9e21057d13b
Author: Greg Kroah-Hartman <greg@kroah.com>
Date:   Thu Mar 18 21:12:46 2004 -0800

    VC: fix bug in vty_init() where vcs_init() was not called early enough.
    
    It was being used before initialized, not nice :(

commit f7f22d4d89d22e051dcb3aa3e74bfaff50597c40
Author: Greg Kroah-Hartman <greg@kroah.com>
Date:   Thu Mar 18 21:10:22 2004 -0800

    add sysfs support for vc devices.

commit 5f74be2d1d673167e833022d8d6900f09179cd17
Author: Greg Kroah-Hartman <greg@kroah.com>
Date:   Thu Mar 18 21:05:08 2004 -0800

    Driver Core: fix spaces instead of tabs problem in the Kconfig file.

commit 9c4495e3bf055f65c54492e0a6d28078da81f075
Author: David S. Miller <davem@nuts.davemloft.net>
Date:   Thu Mar 18 04:48:58 2004 -0800

    [TG3]: Just completely delete the disabled FTQ reset code.

commit 4712542b324f7a122c053f9200fbd7563a5917cc
Author: Michael Chan <mchan@broadcom.com>
Date:   Thu Mar 18 04:46:50 2004 -0800

    [TG3]: Jumbo frames and FTQ reset patch.
    
    1. Set extended packet length bit in phy register 0x18 shadow register 0
    on all chips that support jumbo frames (i.e. all chips except 5705 and
    its variants). Jumbo frame reception is less reliable (more CRC errors)
    if this bit is not set. This bit can be set regardless of the current
    MTU setting.
    
    
    2. Remove FTQ reset during chip init. This is the best fix for the ASF
    race condition problem that I mentioned a few months ago. The FTQ reset
    is redundant as it is already reset during GRC reset.

commit 6300f6909db7efb807bc64185de2bec5140d569d
Merge: 1a217bc... 8754a8e...
Author: Anton Altaparmakov <aia21@cantab.net>
Date:   Thu Mar 18 09:15:22 2004 +0000

    Merge cantab.net:/home/src/bklinux-2.6
    into cantab.net:/home/src/ntfs-2.6

commit ccae11747c2d4506a41192faa2ba24bfde8e4d4b
Merge: 8754a8e... 508f93c...
Author: Jeff Garzik <jgarzik@redhat.com>
Date:   Wed Mar 17 16:18:07 2004 -0500

    Merge redhat.com:/spare/repo/linux-2.6
    into redhat.com:/spare/repo/netdev-2.6/r8169

commit 1a217bc9b6ca15871aa16f3b2391597962258c7b
Merge: 08fec73... d8f786e...
Author: Anton Altaparmakov <aia21@cantab.net>
Date:   Wed Mar 17 14:20:18 2004 +0000

    Merge cantab.net:/home/src/bklinux-2.6
    into cantab.net:/home/src/ntfs-2.6

commit 5f7b4ba8fe10ad9109b9bfaf3301f7fe3812dc81
Author: James Bottomley <jejb@mulgrave.(none)>
Date:   Wed Mar 17 07:48:19 2004 -0500

    SCSI: correct blacklist entry

commit d8f786ebf141a2b4ddc448ff0239179b59e2a936
Merge: 1b2ed5b... 93beec4...
Author: Anton Altaparmakov <aia21@cantab.net>
Date:   Tue Mar 16 17:01:09 2004 +0000

    Merge cantab.net:/home/src/bklinux-2.6
    into cantab.net:/home/src/ntfs-2.6

commit 060b54e20a721e7d4e4eeb5d708060abe20341ed
Merge: 49ccf84... 2e4420f...
Author: James Bottomley <jejb@mulgrave.(none)>
Date:   Tue Mar 16 10:00:52 2004 -0500

    Merge

commit 2e4420fa419e520fdf1b78bfd86d8075572e2df7
Author: Patrick Mansfield <patmans@us.ibm.com>
Date:   Tue Mar 16 09:55:19 2004 -0500

    [PATCH] Add 192 byte MODE SENSE flag
    
    Add a BLIST_MS_192_BYTES_FOR_3F flag. If it is set, sends a 192 byte MODE
    SENSE in sd.c.

commit 2160d142bf2c3f3db8c4662cdf9813290663178b
Author: Patrick Mansfield <patmans@us.ibm.com>
Date:   Tue Mar 16 09:54:29 2004 -0500

    [PATCH] Replace scsi_host flags with scsi_device sdev_bflags
    
    Replace the scsi_host flags with scsi_device sdev_bflags. Change USB to
    set sdev_bflags in its new slave_alloc function.

commit 49ccf84d3b21b19560312a4aade1165cac9bbb03
Author: Mark Haverkamp <markh@osdl.org>
Date:   Tue Mar 16 09:34:32 2004 -0500

    [PATCH] aacraid reset handler update
    
    This is an update from the Adaptec version of the driver to the aacraid
    reset handler.  The current code has a logic error that is fixed by this
    version.  This builds against 2.6.5-rc1.

commit 638127e579a40e6440026fe659fb5331d781a261
Author: James Bottomley <james.bottomley@steeleye.com>
Date:   Tue Mar 16 09:27:25 2004 -0500

    [PATCH] Fix error handler offline behaviour
    
    No-one seems to have noticed, but there's a bug in our offline handling
    which can cause the eh to loop forever when it tries to offline a device
    (basically offline I/O rejections are done in prep, which doesn't work
    for already prepped commands).
    
    The attached fixes this, and also sweeps offline up into a fairly fully
    fledged scsi state model.
    
    With this applied I can now offline my root device under load without
    causing a SCSI hang (ext2 BUG()s rather unhappily but at least that's
    not a SCSI problem).

commit 998fe797ad1b05201cfc82458d8f44904b3c6cc0
Author: Dave Jones <davej@redhat.com>
Date:   Tue Mar 16 09:25:06 2004 -0500

    [PATCH] USB multi-card reader blacklist updates
    
    Here's a couple more blacklist entries.
    Seems everyone suddenly rushed out and bought one of these multi-card readers.
    
    		Dave

commit 878a6c99f5a3e3c3f70471ce5e66427f3a5d9041
Author: Andrew Vasquez <andrew.vasquez@qlogic.com>
Date:   Tue Mar 16 09:22:39 2004 -0500

    [PATCH] PATCH [15/15] qla2xxx: Update driver version
    
    Update version number to 8.00.00b11-k (to indicate embedded driver).

commit eac9e770718491fd581504f906eb8f923f84979a
Author: James Bottomley <jejb@mulgrave.(none)>
Date:   Tue Mar 16 09:21:55 2004 -0500

    PATCH [14/15] qla2xxx: 23xx/63xx firmware updates
    
    Andrew Vasquez <andrew.vasquez@qlogic.com>
    
    Resync with latest released firmware -- 3.02.26.

commit 801f40638480be0964040c8c0ed58c1bd47cbaac
Author: Andrew Vasquez <andrew.vasquez@qlogic.com>
Date:   Tue Mar 16 09:18:28 2004 -0500

    [PATCH] PATCH [13/15] qla2xxx: Device reset fix
    
    During a back-door device reset call, hold off execution of
    commands until the reset is complete.

commit 65be55a7f0736599d77631794d6fa0552e46038b
Author: Andrew Vasquez <andrew.vasquez@qlogic.com>
Date:   Tue Mar 16 09:16:54 2004 -0500

    [PATCH] PATCH [12/15] qla2xxx: Restore update state during resync
    
    Restore the UPDATE state of the HA if a resync event occurs during
    a device (re)discovery.

commit d6aa0d11db24a12f6aa3acd3608edab5a7a57f49
Author: Andrew Vasquez <andrew.vasquez@qlogic.com>
Date:   Tue Mar 16 09:15:33 2004 -0500

    [PATCH] PATCH [11/15] qla2xxx: Add login-retry-count override
    
    Add a module parameter to override the NVRAM's login retry count
    value.

commit 25c001d776b689499d11b8a093ab28caec53578c
Author: Andrew Vasquez <andrew.vasquez@qlogic.com>
Date:   Tue Mar 16 09:13:59 2004 -0500

    [PATCH] PATCH [10/15] qla2xxx: Use fcports list for targets
    
    Consistently use the fcports list of an HA to iterate through the
    known target devices.

commit 272fa201d89a1a2f58a6b3e274e83325564db4ba
Author: Andrew Vasquez <andrew.vasquez@qlogic.com>
Date:   Tue Mar 16 09:12:08 2004 -0500

    [PATCH] PATCH [9/15] qla2xxx:  NVRAM id-list updates
    
    Resync with latest NVRAM subsystem ID list.

commit 67630392c90a4c2cecfcacb5b9ff151571125a66
Author: Andrew Vasquez <andrew.vasquez@qlogic.com>
Date:   Tue Mar 16 09:10:53 2004 -0500

    [PATCH] PATCH [8/15] qla2xxx:  Use proper HA references
    
    Fix issue where the driver would reference the incorrect HA
    during loop state check.

commit ec5dd9c2375438504619298007c7dd96c33ee9c2
Author: Andrew Vasquez <andrew.vasquez@qlogic.com>
Date:   Tue Mar 16 09:07:36 2004 -0500

    [PATCH] PATCH [7/15] qla2xxx:  Misc. updates with FO resync
    
    Misc. updates due to resync with non-embedded (failover-aware) driver.
    
       o Add ancillary support definitions.
       o Remove extraneous *_IOCTL #ifs.
       o Make qla2x00_cmd_timeout() and its support routines visible to the
         non-embedded driver.

commit 4c5d2df4b21e66de4b2c6afcdd9a5ed852ed939a
Author: Andrew Vasquez <andrew.vasquez@qlogic.com>
Date:   Tue Mar 16 09:05:47 2004 -0500

    [PATCH] PATCH [6/15] qla2xxx:  Track error-state of SBRs
    
    Consistenly track the error-state of a failed SRB.

commit ae33fa86a322ebc24f10ee28b8218404008d4189
Author: Andrew Vasquez <andrew.vasquez@qlogic.com>
Date:   Tue Mar 16 09:00:59 2004 -0500

    [PATCH] RE: PATCH [5/15] qla2xxx:  request entries update
    
    For now, I'd say keep everything in the original patch except the
    hunk that changes SG_ALL -> 32, revised patch attached.

commit 94b6b09c73c62462695056f3a810bf97460b77ed
Author: Andrew Vasquez <andrew.vasquez@qlogic.com>
Date:   Tue Mar 16 08:57:00 2004 -0500

    [PATCH] PATCH [4/15] qla2xxx:  Endianess fix while reading stats
    
    Return firmware statistics retrieved from
    qla2x00_get_link_status() in host-endian form.

commit f885274437bf8bc2633fef98e8bd9712224fba94
Author: Andrew Vasquez <andrew.vasquez@qlogic.com>
Date:   Tue Mar 16 08:54:14 2004 -0500

    [PATCH] PATCH [3/15] qla2xxx:  Increase MBX IOXB timeout
    
    Fix a problem where during heavy I/O the driver would
    improperly timeout an outstanding MBX IOCB before the
    firmware itself had a chance to issue and wait for the
    command to timeout.

commit 968020d45e9656b93ce2b72b6d8a8d9aad1265b2
Author: Andrew Vasquez <andrew.vasquez@qlogic.com>
Date:   Tue Mar 16 08:52:29 2004 -0500

    [PATCH] PATCH [2/15] qla2xxx:  Track DSDs used by an SRB
    
    Track the number of DSDs and request entries required for an
    SRB in case of a request-entry or command-slot shortage.

commit b6b13f960e2766c2fe859af5e7b27073f257f7b2
Author: Andrew Vasquez <andrew.vasquez@qlogic.com>
Date:   Tue Mar 16 08:49:59 2004 -0500

    [PATCH] PATCH [1/15] qla2xxx:  Update copyright banner
    
    Update copyright banner for all source files.

commit d1edf2cd85151660577ca64429f0f8e88f95b600
Author: Tom Rini <trini@kernel.crashing.org>
Date:   Mon Mar 15 21:27:36 2004 -0700

    PPC32: In some cases we need to make all pages _PAGE_COHERENT.
    Controll this via the cpu_table flags since it's a requirement
    in some CPU and host bridge combinations.
    From: Adrian Cox <adrian@humboldt.co.uk>

commit 2379c3f2f2c017882acf035d74f9ebe7b9e8f7d3
Author: Tom Rini <trini@kernel.crashing.org>
Date:   Mon Mar 15 21:16:15 2004 -0700

    PPC32: Add CONFIG_MPC10X_BRIDGE.
    From: Adrian Cox <adrian@humboldt.co.uk>.

commit 72c19e18fddd4dcecae87e1f6833c27881d45ff6
Merge: d3fdc9a... 41a8d72...
Author: Ben Collins <bcollins@debian.org>
Date:   Mon Mar 15 23:12:05 2004 -0500

    Merge http://linux.bkbits.net/linux-2.5
    into debian.org:/usr/src/kernel/ieee1394-2.6

commit 93beec4da0b57423005212d0a0e95a078b69b23c
Author: Anton Altaparmakov <aia21@cantab.net>
Date:   Mon Mar 15 10:52:37 2004 +0000

    NTFS: Enforce no atime and no dir atime updates at mount/remount time
    as they are not implemented yet anyway.

commit 1e5a754c0cc26e61ee6b3903ba4596385f0df483
Merge: da5ca9a... d480174...
Author: Anton Altaparmakov <aia21@cantab.net>
Date:   Mon Mar 15 10:10:54 2004 +0000

    Merge cantab.net:/home/src/bklinux-2.6
    into cantab.net:/home/src/ntfs-2.6

commit d480174601a47c4d07d33c177603b273ee2b2bf5
Merge: 8f42720... 73b0987...
Author: Anton Altaparmakov <aia21@cantab.net>
Date:   Thu Mar 11 10:50:50 2004 +0000

    Merge ssh://linux-ntfs@bkbits.net/ntfs-2.6
    into cantab.net:/home/src/ntfs-2.6

commit 41a8d724054b073a593851fa17f18238753649ad
Author: Manfred Weihs <weihs@linux1394.org>
Date:   Thu Mar 11 05:46:42 2004 -0500

    IEEE1394/Lynx(r1182): Explicitly set LCtrl bit in phy register set.

commit 73b0987444320d336cfd8035bce23a92b4827e78
Merge: 9e07b03... 0a91292...
Author: Anton Altaparmakov <aia21@cantab.net>
Date:   Thu Mar 11 10:45:27 2004 +0000

    Merge cantab.net:/home/src/bklinux-2.6
    into cantab.net:/home/src/ntfs-2.6

commit 0f959dccf2edba496df0f209d6fa53318438f922
Author: Steve Kinneberg <kberg@linux1394.org>
Date:   Thu Mar 11 05:44:40 2004 -0500

    [IEEE1394/OHCI]: Deal with some OHCI implementations that have an invalid max_rec field.

commit 8f427206e8e8ee19faa5ae7d0a1fdfcf5e6af70b
Merge: 9e07b03... 0242b38...
Author: Anton Altaparmakov <aia21@cantab.net>
Date:   Sat Mar 6 10:36:49 2004 +0000

    Merge cantab.net:/usr/src/bklinux-2.6 into cantab.net:/usr/src/ntfs-2.6

commit 9e07b03417ec429876566b7bea01035b9208c2cd
Merge: ba84841... b2d271d...
Author: Anton Altaparmakov <aia21@cantab.net>
Date:   Wed Mar 3 09:26:34 2004 +0000

    Merge cantab.net:/home/src/bklinux-2.6
    into cantab.net:/home/src/ntfs-2.6

commit 508f93cb8219b43fbf867cfb352cb93d958a6df6
Merge: 6a59dff... 11a7756...
Author: Jeff Garzik <jgarzik@redhat.com>
Date:   Mon Mar 1 16:47:41 2004 -0500

    Manually merge with upstream.

commit ba84841a2f807aa0d82033c857a051e19a02c3d8
Merge: 7b9b7fb... 0672b0b...
Author: Anton Altaparmakov <aia21@cantab.net>
Date:   Mon Mar 1 13:05:24 2004 +0000

    Merge cantab.net:/home/src/bklinux-2.6
    into cantab.net:/home/src/ntfs-2.6

commit 7b9b7fb21fc0ebf346ec371367e9884bc6185502
Merge: ce43b47... 61ee834...
Author: Anton Altaparmakov <aia21@cantab.net>
Date:   Fri Feb 27 16:28:05 2004 +0000

    Merge cantab.net:/home/src/bklinux-2.6
    into cantab.net:/home/src/ntfs-2.6

commit 5b02299f22e2615f6f11e149bcf64b3627c8cf2e
Merge: c48f9cf... 49b5de2...
Author: Steve French <cifs.adm@hostme.bitkeeper.com>
Date:   Thu Feb 26 22:48:35 2004 -0800

    Merge bk://linux.bkbits.net/linux-2.5
    into hostme.bitkeeper.com:/repos/c/cifs/linux-2.5cifs

commit ce43b476e42f8344a048326a175140baca938622
Merge: cbb8391... 5ce5ff9...
Author: Anton Altaparmakov <aia21@cantab.net>
Date:   Thu Feb 26 14:42:37 2004 +0000

    Merge ssh://linux-ntfs@bkbits.net/ntfs-2.6
    into cantab.net:/home/src/ntfs-2.6

commit 5ce5ff9f82cdd4b3917af8cd0dd5a960617d38e1
Author: Anton Altaparmakov <aia21@cantab.net>
Date:   Thu Feb 26 14:41:51 2004 +0000

    NTFS: Fix off by one error in ntfs_get_parent().

commit cbb8391b81f86f36e14859f548bd630fa29f7ef2
Merge: 4334057... 04dd677...
Author: Anton Altaparmakov <aia21@cantab.net>
Date:   Tue Feb 24 19:17:45 2004 +0000

    Merge cantab.net:/usr/src/bklinux-2.6 into cantab.net:/usr/src/ntfs-2.6

commit 433405754b49f6dea8aa467821f8794badb1e8db
Merge: e07f4d3... 8afd8ae...
Author: Anton Altaparmakov <aia21@cantab.net>
Date:   Tue Feb 24 09:21:15 2004 +0000

    Merge cantab.net:/home/src/bklinux-2.6
    into cantab.net:/home/src/ntfs-2.6

commit c48f9cf6ba59e21fb611bb5b61527f090e720c2b
Merge: 2895dee... 22a4bcc...
Author: Steve French <cifs.adm@hostme.bitkeeper.com>
Date:   Sat Feb 21 21:58:22 2004 -0800

    Merge bk://linux.bkbits.net/linux-2.5
    into hostme.bitkeeper.com:/repos/c/cifs/linux-2.5cifs

commit 8afd8ae34efdc0432f3b20b9bb9053c3be651661
Merge: 45cf898... 2b8ae52...
Author: Anton Altaparmakov <aia21@cantab.net>
Date:   Sat Feb 21 23:01:32 2004 +0000

    Merge cantab.net:/home/src/bklinux-2.6
    into cantab.net:/home/src/ntfs-2.6

commit 2b8ae525c9332525fd5f6239c6ff102aed367898
Merge: 67da11a... 8660ef5...
Author: Anton Altaparmakov <aia21@cantab.net>
Date:   Fri Feb 20 10:36:30 2004 +0000

    Merge cantab.net:/usr/src/bklinux-2.6 into cantab.net:/usr/src/ntfs-2.6

commit 2895dee3533aa78e7f9b625ccc05db7602fa20ab
Merge: cf62e51... 7de14e1...
Author: Steve French <stevef@stevef95.austin.ibm.com>
Date:   Thu Feb 19 04:43:05 2004 -0600

    Merge bk://cifs.bkbits.net/linux-2.5cifs
    into stevef95.austin.ibm.com:/usr/src/bk/linux-2.5cifs

commit 7de14e15f51d33d35266810c9e2cb546a75b2297
Author: Steve French <stevef@stevef95.austin.ibm.com>
Date:   Thu Feb 19 04:41:23 2004 -0600

    use safer i_size_write mechanism to update i_size

commit c177a22d5fd8b8f1d9fa47af9b6d719466ac96d1
Author: Steve French <stevef@steveft21.ltcsamba>
Date:   Thu Feb 19 08:48:48 2004 -0600

    fix caching data integrity problem

commit cf62e51f30e7dd2acadf57f869e92137254cd6cb
Merge: c177a22... 70b1932...
Author: Steve French <cifs.adm@hostme.bitkeeper.com>
Date:   Wed Feb 18 20:59:33 2004 -0800

    Merge bk://linux.bkbits.net/linux-2.5
    into hostme.bitkeeper.com:/repos/c/cifs/linux-2.5cifs

commit 8660ef5bc0038abd75e54e0dbcc869a44f44f476
Merge: acc8a33... 57d5a22...
Author: Anton Altaparmakov <aia21@cantab.net>
Date:   Wed Feb 18 21:11:59 2004 +0000

    Merge cantab.net:/usr/src/bklinux-2.6 into cantab.net:/usr/src/ntfs-2.6

commit 11a7756b6f82091babaa942bc3576d95dddfe45e
Author: Fran√ßois Romieu <romieu@fr.zoreil.com>
Date:   Wed Feb 18 08:54:54 2004 -0500

    [netdrvr r8169] Rx wrap bug:
    - rtl8169_rx_interrupt() can wrap and process an Rx descriptor that it has
      invalidated a few iterations before. The patch limits the number of
      allowed descriptors between two invocations of the Rx refill function;
    - rtl8169_rx_interrupt() now looks similar to rtl8169_tx_interrupt to
      highlight the issue.

commit 57d5a228258e2184cde7fd14232a9fab463bee9c
Merge: 125e877... 7d202bd...
Author: Anton Altaparmakov <aia21@imp.csi.cam.ac.uk>
Date:   Wed Feb 18 13:11:48 2004 +0000

    Merge ssh://linux-ntfs@bkbits.net/ntfs-2.6
    into imp.csi.cam.ac.uk:/home/aia21/ntfs-2.6

commit 4991a312cb2d031dcedc185213467bde71c3789a
Merge: c98b8ab... 1776300...
Author: Steve French <cifs.adm@hostme.bitkeeper.com>
Date:   Tue Feb 17 17:20:18 2004 -0800

    Merge bk://linux.bkbits.net/linux-2.5
    into hostme.bitkeeper.com:/repos/c/cifs/linux-2.5cifs

commit c98b8abbf9f798cccc6491ea1f43c6d124402a52
Author: Steve French <stevef@stevef95.austin.ibm.com>
Date:   Tue Feb 17 03:59:49 2004 -0600

    Fix the exec, suid, dev mount parms to not log warnings when specified

commit 125e877f382f74ea56a28d8e33d10d389ba48515
Merge: 003cbe4... e93aa38...
Author: Anton Altaparmakov <aia21@cantab.net>
Date:   Mon Feb 16 14:34:21 2004 +0000

    Merge cantab.net:/usr/src/bklinux-2.6 into cantab.net:/usr/src/ntfs-2.6

commit f42ec9099605982dc770910e28c76ed26ecbbeb1
Author: Steve French <stevef@stevef95.austin.ibm.com>
Date:   Mon Feb 16 08:00:07 2004 -0600

    fix problem with inode revalidation and cache page invalidation

commit d720374881cc4ca4e70ce30fb5206468e5c215e1
Merge: d5c7cd8... a60e227...
Author: Steve French <cifs.adm@hostme.bitkeeper.com>
Date:   Sun Feb 15 01:52:42 2004 -0800

    Merge bk://linux.bkbits.net/linux-2.5
    into hostme.bitkeeper.com:/repos/c/cifs/linux-2.5cifs

commit d5c7cd85be1f9162ec6d28183dd2969ed02c2306
Merge: 1b2b978... 17042cb...
Author: Steve French <cifs.adm@hostme.bitkeeper.com>
Date:   Fri Feb 13 20:11:54 2004 -0800

    Merge bk://linux.bkbits.net/linux-2.5
    into hostme.bitkeeper.com:/repos/c/cifs/linux-2.5cifs

commit 003cbe45d1cdfea64d66bd9c340881c0664e1e4a
Author: Anton Altaparmakov <aia21@cantab.net>
Date:   Thu Feb 12 10:58:31 2004 +0000

    NTFS: Add missing return -EOPNOTSUPP; in fs/ntfs/aops.c::ntfs_commit_nonresident_write().

commit 5164ccea406c7bbbd08fe29c795088067466c386
Merge: 9eb08f7... 7a5c468...
Author: Anton Altaparmakov <aia21@cantab.net>
Date:   Thu Feb 12 09:30:25 2004 +0000

    Merge cantab.net:/home/aia21/bklinux-2.6
    into cantab.net:/home/aia21/ntfs-2.6

commit 1b2b978719eefa69cbfd5c30d741b710ac56cd78
Merge: d59d0b0... 9eb08f7...
Author: Steve French <cifs.adm@hostme.bitkeeper.com>
Date:   Wed Feb 11 20:52:31 2004 -0800

    Merge bk://linux.bkbits.net/linux-2.5
    into hostme.bitkeeper.com:/repos/c/cifs/linux-2.5cifs

commit 7a5c468dd32f24586e192bdd283fa6278f36d834
Author: Anton Altaparmakov <aia21@cantab.net>
Date:   Wed Feb 11 23:44:57 2004 +0000

    NTFS: Release 2.1.7 - Enable NFS exporting of mounted NTFS volumes.
    - Implement ntfs_get_parent() and ntfs_get_dentry() as the NTFS specific
      export operations ->get_parent() and ->get_dentry() respectively.

commit ad71d86a631c58e385f7400dccab5cebdd54c44d
Merge: 3dbdb14... cd090b6...
Author: Anton Altaparmakov <aia21@cantab.net>
Date:   Wed Feb 11 15:44:00 2004 +0000

    Merge cantab.net:/home/aia21/bklinux-2.6
    into cantab.net:/home/aia21/ntfs-2.6

commit cd090b6df6b1f021d99ca70b14dd81b2c3419d1f
Merge: 6aedddb... 11dcb0e...
Author: Anton Altaparmakov <aia21@cantab.net>
Date:   Tue Feb 10 10:11:13 2004 +0000

    Merge cantab.net:/home/aia21/bklinux-2.6
    into cantab.net:/home/aia21/ntfs-2.6

commit d59d0b05eb8df349593ee7238296192301675e80
Author: Steve French <stevef@smfhome.smfdom>
Date:   Mon Feb 9 23:41:26 2004 -0600

    allow nosuid mounts

commit 4aba42605339a02722baaa0c9c57a36d005c3f3e
Merge: 7ab139b... 6aedddb...
Author: Steve French <cifs.adm@hostme.bitkeeper.com>
Date:   Mon Feb 9 15:51:11 2004 -0800

    Merge bk://linux.bkbits.net/linux-2.5
    into hostme.bitkeeper.com:/repos/c/cifs/linux-2.5cifs

commit 7ab139bf9feb92636e9e7d13e7a2275f9175125c
Merge: 17ff405b... 7bf675d...
Author: Steve French <stevef@steveft21.ltcsamba>
Date:   Mon Feb 9 15:02:29 2004 -0600

    Merge bk://cifs.bkbits.net/linux-2.5cifs
    into steveft21.ltcsamba:/usr/src/bk/linux-2.5cifs

commit 7bf675d6e857bda2745c91e154e600e2db14186c
Author: Steve French <stevef@steveft21.ltcsamba>
Date:   Mon Feb 9 14:51:42 2004 -0600

    improve resume key resetting logic when filldir returns error and filename is in unicode

commit 11dcb0e277d89aec11ab1abff4998fa86022762d
Author: Anton Altaparmakov <aia21@cantab.net>
Date:   Mon Feb 9 14:22:55 2004 +0000

    NTFS: Make it compile...

commit 6e3ea49e1900b545f4e2d008bce0ef3aaae4cd04
Author: Anton Altaparmakov <aia21@cantab.net>
Date:   Mon Feb 9 13:38:17 2004 +0000

    NTFS: Make ntfs_lookup() NFS export safe, i.e. use d_splice_alias(), etc.

commit a940d783dafbbbbf4c79245c51aa78b6fe5fe128
Merge: a6eebfd... 49a136e...
Author: Anton Altaparmakov <aia21@cantab.net>
Date:   Mon Feb 9 13:35:49 2004 +0000

    Merge cantab.net:/home/aia21/bklinux-2.6
    into cantab.net:/home/aia21/ntfs-2.6

commit 17ff405be1bedcb0321436c33e11bb14497cc7c6
Merge: 47b6530... d9a9168...
Author: Steve French <cifs.adm@hostme.bitkeeper.com>
Date:   Sun Feb 8 18:29:01 2004 -0800

    Merge bk://linux.bkbits.net/linux-2.5
    into hostme.bitkeeper.com:/repos/c/cifs/linux-2.5cifs

commit 49a136e154dc215f33ba8b2371d10e75506e7fda
Author: Anton Altaparmakov <aia21@cantab.net>
Date:   Sun Feb 8 18:45:25 2004 +0000

    NTFS: Set i_generation in VFS inode from seq_no in NTFS inode.

commit 47b65300d9220474b9c4744540112c6617fbd07e
Merge: d0eb893... 4b46cde...
Author: Steve French <stevef@smfhome.smfdom>
Date:   Sat Feb 7 16:21:51 2004 -0600

    Merge bk://cifs.bkbits.net/linux-2.5cifs
    into smfhome.smfdom:/home/stevef/bk/linux-2.5cifs

commit 4b46cdeb66bd6e4c9360db93d212da9d54c134ce
Merge: 6fc19bb... 7a650c8...
Author: Steve French <cifs.adm@hostme.bitkeeper.com>
Date:   Sat Feb 7 21:30:28 2004 -0800

    Merge bk://linux.bkbits.net/linux-2.5
    into hostme.bitkeeper.com:/repos/c/cifs/linux-2.5cifs

commit d0eb893396fe7dd1220041b4ae5bf18fea68a90b
Author: Steve French <stevef@smfhome.smfdom>
Date:   Sat Feb 7 16:16:42 2004 -0600

    Spurious white space and duplicated line cleanup

commit 6fc19bb20250072eae7101b129c4ebff5abc3ecb
Merge: 2ab5999... f4d8611...
Author: Steve French <cifs.adm@hostme.bitkeeper.com>
Date:   Fri Feb 6 16:05:53 2004 -0800

    Merge bk://linux.bkbits.net/linux-2.5
    into hostme.bitkeeper.com:/repos/c/cifs/linux-2.5cifs

commit e24666bb000acb86c2e9684583bdfcb8360cb28a
Merge: f4d8611... 0c998ab...
Author: Jeff Garzik <jgarzik@redhat.com>
Date:   Fri Feb 6 13:55:38 2004 -0500

    Merge redhat.com:/spare/repo/linux-2.5
    into redhat.com:/spare/repo/netdev-2.6/r8169

commit 2ab59992a93d22665a0dbdac7fd2a4419ebf9d83
Author: Steve French <stevef@steveft21.ltcsamba>
Date:   Fri Feb 6 05:37:36 2004 -0600

    ipv6 enablement for cifs vfs fixes

commit 16afd005f8074fbc98aa51bcb2bcc1366d2a6221
Merge: 7ff4737... d619064...
Author: Steve French <cifs.adm@hostme.bitkeeper.com>
Date:   Thu Feb 5 22:06:54 2004 -0800

    Merge bk://linux.bkbits.net/linux-2.5
    into hostme.bitkeeper.com:/repos/c/cifs/linux-2.5cifs

commit 7ff4737051047eed2dff7278a5e44d15ab9be940
Author: Steve French <stevef@stevef95.austin.ibm.com>
Date:   Fri Feb 6 03:56:08 2004 -0600

    reset searches properly when filldir fails

commit aad2e949efac26584fdae706272b8314b80ebbc5
Author: Steve French <stevef@stevef95.austin.ibm.com>
Date:   Fri Feb 6 00:25:38 2004 -0600

    fix problem not connecting to server when port not specified explicitly and port field unitialized

commit c33a6cfb4dadd4249aa7b6c87500b5f9b02127ba
Merge: 54b503e... 25b160e...
Author: Steve French <cifs.adm@hostme.bitkeeper.com>
Date:   Tue Feb 3 21:51:18 2004 -0800

    Merge bk://linux.bkbits.net/linux-2.5
    into hostme.bitkeeper.com:/repos/c/cifs/linux-2.5cifs

commit 54b503e65c07bcd0728f965b0e203e212b93ced9
Author: Steve French <stevef@stevef95.austin.ibm.com>
Date:   Tue Feb 3 02:51:25 2004 -0600

    remove spurious debug messages

commit 22435dc5608344a2f652eee0d93ffb48f91ec5bc
Author: Steve French <stevef@stevef95.austin.ibm.com>
Date:   Mon Feb 2 05:54:45 2004 -0600

    fix remoting caching part 2

commit 97ec921f0748acb3ed4ce1b68308ce9f6b58adb9
Merge: e834096... 7704432...
Author: Steve French <cifs.adm@hostme.bitkeeper.com>
Date:   Fri Jan 30 14:46:46 2004 -0800

    Merge bk://linux.bkbits.net/linux-2.5
    into hostme.bitkeeper.com:/repos/c/cifs/linux-2.5cifs

commit e834096489ac05dfc69bc932b6eade8690ac4e56
Author: Steve French <stevef@stevef95.austin.ibm.com>
Date:   Fri Jan 30 05:20:19 2004 -0600

    Relax requested CIFS permissions on open to simply request GENERIC_READ and GENERIC_WRITE (instead of GENERIC_ALL which
    can unnecessarily conflict with share permissions by asking implicitly for take ownership and other unneeded flags)

commit 07f4e656ec097fdfe9a34170c6fc6e39b889fe18
Author: Steve French <stevef@stevef95.austin.ibm.com>
Date:   Thu Jan 29 06:40:09 2004 -0600

    Fix caching problem with multiply open files from different clients

commit c564757f0e62b97d952e0d352597d6710a8dcb61
Merge: 3eb3a77... e878a1d...
Author: Steve French <cifs.adm@hostme.bitkeeper.com>
Date:   Wed Jan 28 18:26:20 2004 -0800

    Merge bk://linux.bkbits.net/linux-2.5
    into hostme.bitkeeper.com:/repos/c/cifs/linux-2.5cifs

commit 3eb3a77c5722e52a452ee3ca6ca07850e20e1157
Merge: c374f68... 01477f1...
Author: Steve French <cifs.adm@hostme.bitkeeper.com>
Date:   Tue Jan 27 17:55:30 2004 -0800

    Merge bk://linux.bkbits.net/linux-2.5
    into hostme.bitkeeper.com:/repos/c/cifs/linux-2.5cifs

commit c374f68962ff02a70f40ffad0bec0814f33f5b69
Author: Steve French <stevef@steveft21.ltcsamba>
Date:   Mon Jan 26 05:22:34 2004 -0600

    finish off mount parm sep override

commit 0c998ab48eb61eb89be4986e4d4468dfe6a4848d
Author: Fran√ßois Romieu <romieu@fr.zoreil.com>
Date:   Sat Jan 24 10:43:33 2004 -0500

    [netdrvr r8169] fix TX race
    
    - possible tx descriptor index overflow (assume tp->dirty_tx = NUM_TX_DESC/2,
      tp->cur_tx = NUM_TX_DESC - 1 and watch TxDescArray for example);
    - the status of an inadequate descriptor is checked.
    
    NB: the bug will not necessarily noticed when tx_left == 1.

commit 166b8a1dd652d3cc5d174fd6dd3446425c8cf5ed
Merge: 34917aa... 7a63bfc...
Author: Steve French <cifs.adm@hostme.bitkeeper.com>
Date:   Sat Jan 24 00:54:23 2004 -0800

    Merge bk://linux.bkbits.net/linux-2.5
    into hostme.bitkeeper.com:/repos/c/cifs/linux-2.5cifs

commit 34917aa3b19c85a448a67cb05c2f298de739a54b
Author: Steve French <stevef@steveft21.ltcsamba>
Date:   Fri Jan 23 10:34:13 2004 -0600

    finish handling commas in passwords

commit 2b62a8e6745600b947582b63696c142137fb60d4
Merge: 223def7... 6c0be91...
Author: Steve French <stevef@steveft21.ltcsamba>
Date:   Thu Jan 22 06:00:51 2004 -0600

    Merge bk://cifs.bkbits.net/linux-2.5cifs
    into steveft21.ltcsamba:/usr/src/bk/linux-2.5cifs

commit 6c0be91a5a40e537f009f223652e1c50cdfe869f
Author: Steve French <stevef@steveft21.ltcsamba>
Date:   Thu Jan 22 05:51:52 2004 -0600

    Allow null password string pointer and passwords longer than 16 bytes

commit 223def7c2206016e141ed489894dffe8cd300609
Merge: e85c53f... c860941...
Author: Steve French <cifs.adm@hostme.bitkeeper.com>
Date:   Wed Jan 21 23:02:29 2004 -0800

    Merge bk://linux.bkbits.net/linux-2.5
    into hostme.bitkeeper.com:/repos/c/cifs/linux-2.5cifs

commit e85c53f2cf2de8468ff1752387ebc5e63674d08a
Merge: 6b3f9b7... 2e18152...
Author: Steve French <cifs.adm@hostme.bitkeeper.com>
Date:   Wed Jan 21 17:44:23 2004 -0800

    Merge bk://linux.bkbits.net/linux-2.5
    into hostme.bitkeeper.com:/repos/c/cifs/linux-2.5cifs

commit 6b3f9b71dec256de8f5ed23806b2a328ff486b7f
Merge: 56dd15d... cefeddf...
Author: Steve French <cifs.adm@hostme.bitkeeper.com>
Date:   Tue Jan 20 15:55:13 2004 -0800

    Merge bk://linux.bkbits.net/linux-2.5
    into hostme.bitkeeper.com:/repos/c/cifs/linux-2.5cifs

commit 56dd15dc1f525279316092f9f3f80534c42ec165
Author: Steve French <stevef@smfhome.smfdom>
Date:   Tue Jan 20 11:46:57 2004 -0600

    Check return on failed dentry allocation.  Suggested by Randy Dunlap

commit 7ebbcc64c5d2cf583155c6594428e2e736e58b29
Merge: 6b55e22... b2a910c...
Author: Steve French <cifs.adm@hostme.bitkeeper.com>
Date:   Tue Jan 20 04:11:56 2004 -0800

    Merge bk://linux.bkbits.net/linux-2.5
    into hostme.bitkeeper.com:/repos/c/cifs/linux-2.5cifs

commit 84cdd306cf6d6fe2f21201ddbb8c99fee953c5dd
Merge: 0010bc5... 81dafa3...
Author: Jeff Garzik <jgarzik@redhat.com>
Date:   Mon Jan 19 08:14:32 2004 -0500

    Merge redhat.com:/spare/repo/linux-2.5
    into redhat.com:/spare/repo/netdev-2.6/r8169

commit 6b55e229fdd8f97678aabbe3e93e97634b4e693a
Merge: 556ae3d... 755fa12...
Author: Steve French <cifs.adm@hostme.bitkeeper.com>
Date:   Sat Jan 17 17:50:09 2004 -0800

    Merge bk://linux.bkbits.net/linux-2.5
    into hostme.bitkeeper.com:/repos/c/cifs/linux-2.5cifs

commit 556ae3d95a1fa15d47f25939c4b509c1ae1c48ef
Merge: b190669... 4547e81...
Author: Steve French <cifs.adm@hostme.bitkeeper.com>
Date:   Tue Jan 13 19:23:03 2004 -0800

    Merge bk://linux.bkbits.net/linux-2.5
    into hostme.bitkeeper.com:/repos/c/cifs/linux-2.5cifs

commit 81dafa3d94badf519f103ea47fb44cffbec668b9
Author: Fran√ßois Romieu <romieu@fr.zoreil.com>
Date:   Tue Jan 13 06:43:24 2004 -0500

    [netdrvr r8169] fix phy initialization loop init

commit 81a3fa93d6d4e66bbf642400ab2db5ce05f8d631
Author: Fran√ßois Romieu <romieu@fr.zoreil.com>
Date:   Mon Jan 12 07:19:54 2004 -0500

    [netdrvr r8169] fix rx counter masking bug

commit 1ad60382858a66d9c820e877b2eebdb9d8312a78
Author: Fran√ßois Romieu <romieu@fr.zoreil.com>
Date:   Sat Jan 10 06:47:18 2004 -0500

    [netdrvr r8169] fix oops by removing __devinitdata marker

commit 0101bca33a9f87cf2cce161fc4a224b5fdba02a2
Author: Fran√ßois Romieu <romieu@fr.zoreil.com>
Date:   Sat Jan 10 06:46:10 2004 -0500

    [PATCH] 2.6.1-rc1-mm1 - typo of death in the r8169 driver
    
      silly bug in the r8169 driver.

commit 9fe713ff9a1411a35f927fb74feb412ecae9b570
Author: Fran√ßois Romieu <romieu@fr.zoreil.com>
Date:   Sat Jan 10 06:11:57 2004 -0500

    [netdrvr r8169] Stats fix (Fernando Alencar Mar√É¬≥tica <famarost@unimep.br>).

commit 2b145fa0a55a73b90b85440e791095ea8c092910
Author: Fran√ßois Romieu <romieu@fr.zoreil.com>
Date:   Sat Jan 10 06:11:40 2004 -0500

    [netdrvr r8169] Endianness update (original idea from Alexandra N. Kossovsky):
    - descriptors status (bitfields enumerated as _DescStatusBit);
    - address of buffers stored in Rx/Tx descriptors.

commit e59070451f70e5307b2a3f172eacdf6e0e3a02f8
Author: Fran√ßois Romieu <romieu@fr.zoreil.com>
Date:   Sat Jan 10 06:01:37 2004 -0500

    [netdrvr r8169] fix RX
    
    Brown paper bag time: the Rx descriptors are contiguous and EORbit only
    marks the last descriptor in the array. OWNbit implicitly marks the end
    of the Rx descriptors segment which is owned by the nic.

commit 977852e5d8b45c71f75fa74c0a74550cd1a9428b
Author: Fran√ßois Romieu <romieu@fr.zoreil.com>
Date:   Sat Jan 10 06:01:28 2004 -0500

    [netdrvr r8169] Suspend/resume code (Fernando Alencar Mar√É¬≥tica).

commit 56cb55bb7f7745215548aa775937c93810123d4d
Author: Fran√ßois Romieu <romieu@fr.zoreil.com>
Date:   Sat Jan 10 06:01:20 2004 -0500

    [netdrvr r8169] Modification of the interrupt mask (RealTek).

commit a5ffe9298660e9391f6e041f9ba96027c195a1e8
Author: Fran√ßois Romieu <romieu@fr.zoreil.com>
Date:   Sat Jan 10 06:01:11 2004 -0500

    [netdrvr r8169] Driver forgot to update the transmitted bytes counter.
    Originally done in rtl8169_start_xmit() by Realtek.

commit 5fed336ce1e9e638e58f53e41571af4aa445ccc8
Author: Fran√ßois Romieu <romieu@fr.zoreil.com>
Date:   Sat Jan 10 06:01:03 2004 -0500

    [netdrvr r8169] Merge of changes from Realtek:
    - register voodoo in rtl8169_hw_start().

commit cd68bcbfeb7d9cdf60e4419016ffd3bac61f179e
Author: Fran√ßois Romieu <romieu@fr.zoreil.com>
Date:   Sat Jan 10 06:00:54 2004 -0500

    [netdrvr r8169] Merge of timer related changes from Realtek:
    - changed their timeout value from 100 to HZ to trigger rtl8169_phy_timer();
    - s/TX_TIMEOUT/RTL8169_TX_TIMEOUT/ to have RTL8169_{TX/PHY}_TIMEOUT.

commit efdc1590d9e851ac12a64b2c877f79e1c9c5e26e
Author: Fran√ßois Romieu <romieu@fr.zoreil.com>
Date:   Sat Jan 10 06:00:46 2004 -0500

    [netdrvr r8169] Merge of changes done by Realtek to rtl8169_init_one():
    - phy capability settings allows lower or equal capability as suggested
      in Realtek's changes;
    - I/O voodoo;
    - no need to s/mdio_write/RTL8169_WRITE_GMII_REG/;
    - s/rtl8169_hw_PHY_config/rtl8169_hw_phy_config/;
    - rtl8169_hw_phy_config(): ad-hoc struct "phy_magic" to limit duplication
      of code (yep, the u16 -> int conversions should work as expected);
    - variable renames and whitepace changes ignored.

commit c69ac7bb8a51282f90fdf5b6cd7391382fcc399a
Author: Fran√ßois Romieu <romieu@fr.zoreil.com>
Date:   Sat Jan 10 06:00:37 2004 -0500

    [netdrvr r8169] Add {mac/phy}_version.
    - change of identification logic in rtl8169_init_board();
    - {chip/rtl_chip}_info are merged in rtl_chip_info;
    - misc style nits (lazy braces, SHOUTING MACROS from realtek converted to
      functions).

commit efdfea6ac2c1be06cda0cc8e1fccf0df1a607ca5
Author: Fran√ßois Romieu <romieu@fr.zoreil.com>
Date:   Sat Jan 10 05:47:04 2004 -0500

    [netdrvr r8169] Rx copybreak for small packets.
    - removal of rtl8169_unmap_rx() (unneeded as for now).

commit 70b6431660940aa8f13fc9dec63483806cc23a62
Author: Fran√ßois Romieu <romieu@fr.zoreil.com>
Date:   Sat Jan 10 05:42:42 2004 -0500

    [netdrvr r8169] Conversion of Tx data buffers to PCI DMA:
    - endianness is kept in a fscked state as it is in the original code
      (will be adressed in a later patch);
    - buf_addr of an unmapped descriptor is always set to the same value
      (cf rtl8169_unmap_tx_skb);
    - nothing fancy, really.

commit 7f69071eeebf6e2f3bc25ed1fb8e19248943d9bd
Author: Fran√ßois Romieu <romieu@fr.zoreil.com>
Date:   Sat Jan 10 05:42:34 2004 -0500

    [netdrvr r8169] rtl8169_start_xmit fixes:
    - it forgot to update stats if the skb couldn't be expanded;
    - it didn't free it either if the descriptor was not available;
    - move the spin_unlock nearer of the exit point instead of duplicating
      it in the new branch.

commit 5231873b728e1148904ff70604d84a74442e04e7
Author: Fran√ßois Romieu <romieu@fr.zoreil.com>
Date:   Sat Jan 10 05:42:25 2004 -0500

    [netdrvr r8169] Conversion of Rx data buffers to PCI DMA
    - endianness is kept in a fscked state as it is in the original code
      (will be adressed in a later patch);
    - rtl8169_rx_clear() walks the buffer ring and releases the allocated
      data buffers. It needs to be used in two places:
      - rtl8169_init_ring() failure path;
      - normal device release (i.e. rtl8169_close);
    - rtl8169_free_rx_skb() releases a Rx data buffer. Mostly an helper
      for rtl8169_rx_clear(). As such it must:
      - unmap the memory area;
      - release the skb;
      - prevent the ring descriptor from being used again;
    - rtl8169_alloc_rx_skb() prepares a Rx data buffer for use.
      As such it must:
      - allocate an skb;
      - map the memory area;
      - reflect the changes in the ring descriptor.
      This function is balanced by rtl8169_free_rx_skb().
    - rtl8169_unmap_rx() simply helps with the 80-columns limit.
    - rtl8169_rx_fill() walks a given range of the buffer ring and
      try to turn any descriptor into a ready to use one. It returns the
      count of modified descriptors and exits if an allocation fails.
      It can be seen as balanced by rtl8169_rx_clear(). Motivation:
      - partially abstract the (usually big) piece of code for the refill
        logic at the end of the Rx interrupt;
      - factorize the refill logic and the initial ring setup.
    - simple conversion of rtl8169_rx_interrupt() without rx_copybreak
      (will be adressed in a later patch).

commit 902f3218a74eaddcb43c5aadc30de4039fcb60b4
Author: Fran√ßois Romieu <romieu@fr.zoreil.com>
Date:   Sat Jan 10 05:41:42 2004 -0500

    [netdrvr r8169] Conversion of Rx/Tx descriptors to consistent DMA:
    - use pci_alloc_consistent() for Rx/Tx descriptors in rtl8169_open()
      (balanced by pci_free_consistent() on error path as well as in
      rtl8169_close());
    - removal of the fields {Rx/Tx}DescArrays in struct rtl8169_private
      as there is no need to store a non-256 bytes aligned address any more;
    - fix for rtl8169_open() leak when RxBufferRings allocation fails.
      Said allocation is pushed to rtl8169_init_ring() as part of an evil
      cunning plan.

commit b190669eebc166c7ff454da1c64c74a0d4fc0942
Merge: bf76971... 4576b4f...
Author: Steve French <cifs.adm@hostme.bitkeeper.com>
Date:   Fri Jan 9 21:48:53 2004 -0800

    Merge bk://linux.bkbits.net/linux-2.5
    into hostme.bitkeeper.com:/repos/c/cifs/linux-2.5cifs

commit bf7697113ddb350a5c05e8b612368a4ea00b8f04
Author: Steve French <stevef@stevef95.austin.ibm.com>
Date:   Thu Jan 8 05:17:13 2004 -0600

    Fix global kernel name space pollution

commit 711b35d0d9f2045f52bc0867ca3cabf576f667d0
Merge: 27f2baf... f6fd6a0...
Author: Steve French <cifs.adm@hostme.bitkeeper.com>
Date:   Wed Jan 7 17:35:10 2004 -0800

    Merge bk://linux.bkbits.net/linux-2.5
    into hostme.bitkeeper.com:/repos/c/cifs/linux-2.5cifs

commit 27f2baf9ce4af0c179a27d345a00763a2e7a52dd
Author: Steve French <stevef@stevef95.austin.ibm.com>
Date:   Wed Jan 7 04:58:55 2004 -0600

    fix failed mounts to win98 part II

commit 14fbd6ba5ea5db54388c00917dc3bfb1645d6a47
Author: Steve French <stevef@stevef95.austin.ibm.com>
Date:   Tue Jan 6 05:55:00 2004 -0600

    gracefully exit on failed mounts to win98 (which closes tcp session rather than erroring on smb protocol negotiation)

commit 8ad64d002f98ac748857b0a349726f8cc3b89791
Author: Steve French <stevef@steveft21.ltcsamba>
Date:   Mon Jan 5 22:05:09 2004 -0600

    fix cifs readme

commit 4934db06db4d9dbad540706efac6cf433059b1a4
Merge: 2582933... 67215df...
Author: Steve French <cifs.adm@hostme.bitkeeper.com>
Date:   Mon Jan 5 19:29:48 2004 -0800

    Merge bk://linux.bkbits.net/linux-2.5
    into hostme.bitkeeper.com:/repos/c/cifs/linux-2.5cifs

commit 2582933f39e0adfbceba47e49d22a2c6da924261
Merge: 076a584... f73e9f0...
Author: Steve French <cifs.adm@hostme.bitkeeper.com>
Date:   Sun Jan 4 22:02:13 2004 -0800

    Merge bk://linux.bkbits.net/linux-2.5
    into hostme.bitkeeper.com:/repos/c/cifs/linux-2.5cifs

commit 076a58410107a16f3cf52648f15264600658f188
Merge: 21ef7f0... 4da120f...
Author: Steve French <cifs.adm@hostme.bitkeeper.com>
Date:   Wed Dec 31 01:49:38 2003 -0800

    Merge bk://linux.bkbits.net/linux-2.5
    into hostme.bitkeeper.com:/repos/c/cifs/linux-2.5cifs

commit 21ef7f070e288719455da99544387fcb302166de
Merge: 3adc4f5... 67e9bb6...
Author: Steve French <cifs.adm@hostme.bitkeeper.com>
Date:   Wed Dec 17 22:25:40 2003 -0800

    Merge bk://linux.bkbits.net/linux-2.5
    into hostme.bitkeeper.com:/repos/c/cifs/linux-2.5cifs

commit 3adc4f5699008503f709642e613b3b3e732f30d4
Merge: a7e7ee7... e1f936a...
Author: Steve French <cifs.adm@hostme.bitkeeper.com>
Date:   Mon Dec 15 04:50:29 2003 -0800

    Merge bk://linux.bkbits.net/linux-2.5
    into hostme.bitkeeper.com:/repos/c/cifs/linux-2.5cifs

commit a7e7ee716d3446b62ba81757740bc1416011cb12
Merge: cc74359... 5895675...
Author: Steve French <stevef@steveft21.ltcsamba>
Date:   Wed Dec 10 21:22:22 2003 -0600

    Merge bk://cifs.bkbits.net/linux-2.5cifs
    into steveft21.ltcsamba:/usr/src/bk/linux-2.5cifs

commit 58956759e405e85f0408252a98eac852f7e1c36d
Author: Steve French <stevef@steveft21.ltcsamba>
Date:   Wed Dec 10 21:14:24 2003 -0600

    set byte range locktimeouts properly

commit cc7435976c3a565366828ae60288bc2f362258ef
Merge: 84ebf85... 8cc86c0...
Author: Steve French <cifs.adm@hostme.bitkeeper.com>
Date:   Tue Dec 9 21:18:58 2003 -0800

    Merge bk://linux.bkbits.net/linux-2.5
    into hostme.bitkeeper.com:/repos/c/cifs/linux-2.5cifs

commit 84ebf85c169c1ecfcdde9a34acd4c4ef8c0e8324
Author: Steve French <stevef@steveft21.ltcsamba>
Date:   Sun Dec 7 23:00:47 2003 -0600

    Fix an incorrect mapping of open flags to cifs open disposition.  Fix blocking byte range locks.  These fix breakages that were notice running lock tests 1 and 7 of the connectathon posix file api tests

commit 9f6f16d00f5ca31dd64b17e2ca25139019e85916
Merge: 83f868d... 6f781f0...
Author: Steve French <cifs.adm@hostme.bitkeeper.com>
Date:   Sun Dec 7 17:32:02 2003 -0800

    Merge bk://linux.bkbits.net/linux-2.5
    into hostme.bitkeeper.com:/repos/c/cifs/linux-2.5cifs

commit 83f868da8b3f386e0dbad6c076ce02b53aeae4e6
Merge: 3a9cb2d... 8255b24...
Author: Steve French <cifs.adm@hostme.bitkeeper.com>
Date:   Sat Dec 6 02:57:45 2003 -0800

    Merge bk://linux.bkbits.net/linux-2.5
    into hostme.bitkeeper.com:/repos/c/cifs/linux-2.5cifs

commit 3a9cb2d9a95f1729fc81f798d7973d3df87bcab8
Author: Steve French <stevef@steveft21.ltcsamba>
Date:   Fri Dec 5 23:21:50 2003 -0600

    allow disabling cifs Linux extensions via proc

commit cad2376ea7980e0a2e9c226397402e001258caf2
Author: Steve French <stevef@steveft21.ltcsamba>
Date:   Thu Dec 4 22:46:56 2003 -0600

    Fix check of filldir return code during readdir to avoid incomplete search results displayed on very large directories. Fix cleanup of proc entries.  Add config parm to allow disabling negotiating Linux extensions

commit db62a2bdc2985816dee2a77ed8ddbd75992e158c
Merge: 1f69b47... fcc1359...
Author: Steve French <cifs.adm@hostme.bitkeeper.com>
Date:   Thu Dec 4 22:01:24 2003 -0800

    Merge bk://linux.bkbits.net/linux-2.5
    into hostme.bitkeeper.com:/repos/c/cifs/linux-2.5cifs

commit 1f69b47b1b09338d59f596a53dc29469807c499c
Author: Steve French <stevef@steveft21.ltcsamba>
Date:   Mon Dec 1 20:11:41 2003 -0600

    fix double incrementing of transaction counter

commit 85964d7db59e2a64e14441998fb1852d89808068
Author: Steve French <stevef@steveft21.ltcsamba>
Date:   Mon Dec 1 04:36:38 2003 -0600

    invalidate cached pages when last local instance closed so we do
    not use stale data while someone may be modifying the file on the
    server.

commit 847c71fb5610fa3cee69f5c18192941596c5d46e
Author: Steve French <stevef@steveft21.ltcsamba>
Date:   Mon Dec 1 03:43:13 2003 -0600

    Oops on reopen files when dentry already freed

commit 981e550dcb66f7fcdfd00e00e020240859211a87
Author: Steve French <stevef@steveft21.ltcsamba>
Date:   Wed Nov 26 16:50:46 2003 -0600

    invalidate locally cached pages when server breaks oplock.  Do not loop reconnecting for servers that drop tcp session rather than sending smb negprot response

commit 0b3ade0817109a389b04e6d80465d7a5625f4399
Merge: 35b516e... e689bf5...
Author: Steve French <cifs.adm@hostme.bitkeeper.com>
Date:   Wed Nov 26 16:43:29 2003 -0800

    Merge bk://linux.bkbits.net/linux-2.5
    into hostme.bitkeeper.com:/repos/c/cifs/linux-2.5cifs

commit 35b516ed41590109a8432783d6d16e94e029c0d2
Author: Steve French <stevef@stevef95.austin.ibm.com>
Date:   Tue Nov 25 05:09:03 2003 -0600

    rcvtimeout set improperly for some cifs servers

commit ad7a647c1dfd18f77eb6df30ab8764a39b4e6db7
Merge: eafd602... a3d93eb...
Author: Steve French <cifs.adm@hostme.bitkeeper.com>
Date:   Sun Nov 23 02:39:14 2003 -0800

    Merge bk://linux.bkbits.net/linux-2.5
    into hostme.bitkeeper.com:/repos/c/cifs/linux-2.5cifs

commit eafd6020bd4614e104a3e24d9b2cbc925b0adcea
Merge: 35ae52a... f6967f9...
Author: Steve French <cifs.adm@hostme.bitkeeper.com>
Date:   Fri Nov 21 21:33:38 2003 -0800

    Merge bk://linux.bkbits.net/linux-2.5
    into hostme.bitkeeper.com:/repos/c/cifs/linux-2.5cifs

commit 35ae52a51e1dad1f8e0990746ca2a2e80eb4533b
Merge: fec4f23... 5237662...
Author: Steve French <cifs.adm@hostme.bitkeeper.com>
Date:   Thu Nov 20 23:31:49 2003 -0800

    Merge bk://linux.bkbits.net/linux-2.5
    into hostme.bitkeeper.com:/repos/c/cifs/linux-2.5cifs

commit fec4f23a2b98a72ff616471dad61f0c3e4fb7a7e
Author: Steve French <stevef@stevef95.austin.ibm.com>
Date:   Fri Nov 21 05:26:27 2003 -0600

    missing message on timed out requests

commit 4f98309643d0b8fcf86b58a3f75b98a7bf32aaeb
Author: Steve French <stevef@stevef95.austin.ibm.com>
Date:   Thu Nov 20 07:27:13 2003 -0600

    Avoid smb data corruption under heavy stress

commit cfc71961c73554dcac1bf5182c85018b01df71e8
Author: Steve French <stevef@linux-udp14619769uds.austin.ibm.com>
Date:   Tue Nov 18 23:24:43 2003 -0600

    Fix oops in mount error path when unload_nls called with bad pointer.

commit 3c59d320416e5132a1337f457248d1a077db16b2
Author: Steve French <stevef@stevef95.austin.ibm.com>
Date:   Wed Nov 19 05:32:27 2003 -0600

    Do not grab i_sem (already taken in filemap.c across commit write calls) during reopen of invalidated file handle.

commit 4024c0588423db846cabe23695775fd26f738e7e
Merge: 720ecfe... 44cb023...
Author: Steve French <cifs.adm@hostme.bitkeeper.com>
Date:   Tue Nov 18 16:57:13 2003 -0800

    Merge bk://linux.bkbits.net/linux-2.5
    into hostme.bitkeeper.com:/repos/c/cifs/linux-2.5cifs

commit 720ecfed182f6f15e2d5d53f545b0003c5e9c97b
Author: Steve French <stevef@stevef95.austin.ibm.com>
Date:   Tue Nov 18 05:48:08 2003 -0600

    Missing soft vs. hard retry mount option

commit cb8baa9c89bdc4eb0a1c17088124bd240baeab14
Author: Steve French <stevef@steveft21.austin.ibm.com>
Date:   Sun Nov 16 09:52:41 2003 -0600

    Fix compile error

commit 8f6e29c0c20fd9957e931c859e2eee122e4b4276
Merge: 10fafa3... 5ada03a...
Author: Steve French <cifs.adm@hostme.bitkeeper.com>
Date:   Sat Nov 15 03:43:41 2003 -0800

    Merge bk://linux.bkbits.net/linux-2.5
    into hostme.bitkeeper.com:/repos/c/cifs/linux-2.5cifs

commit 10fafa39df5ca1d085e8ae07380b09e338c9e3b9
Merge: cdd29bc... 43b69e6...
Author: Steve French <stevef@stevef95.austin.ibm.com>
Date:   Fri Nov 14 04:43:19 2003 -0600

    Merge bk://cifs.bkbits.net/linux-2.5cifs
    into stevef95.austin.ibm.com:/home/stevef/bk/linux-2.5cifs

commit cdd29bc22db1fb5d04b81d4f5c9c7398ded0f7c1
Author: Steve French <stevef@stevef95.austin.ibm.com>
Date:   Fri Nov 14 04:42:04 2003 -0600

    correct retry on remaining handles based calls

commit 43b69e68372e2a739f43812ff53d7f7b53493b8b
Merge: cf24118... 05c8545...
Author: Steve French <cifs.adm@hostme.bitkeeper.com>
Date:   Thu Nov 13 23:16:59 2003 -0800

    Merge bk://linux.bkbits.net/linux-2.5
    into hostme.bitkeeper.com:/repos/c/cifs/linux-2.5cifs

commit cf24118b01ec82eb51502763a7873c0b892c326c
Merge: a093070... 4776d26...
Author: Steve French <cifs.adm@hostme.bitkeeper.com>
Date:   Wed Nov 12 18:38:03 2003 -0800

    Merge bk://linux.bkbits.net/linux-2.5
    into hostme.bitkeeper.com:/repos/c/cifs/linux-2.5cifs

commit a093070be53ff2c6781e9b97fd4b63556addfa3b
Author: Steve French <stevef@stevef95.austin.ibm.com>
Date:   Wed Nov 12 01:10:10 2003 -0600

    finish off move from reopening all files on reconnection (which takes too long under heavy stress) to reopen file as needed after reconnection to server.

commit 1915ad848ca90de140970306907048ca260d04b3
Author: Steve French <stevef@stevef95.austin.ibm.com>
Date:   Tue Nov 11 05:51:40 2003 -0600

    have to reconnect open files safely, one at a time, as needed

commit c0426ae34a2a10adc51605a43a86cc16482699f6
Author: Steve French <stevef@steveft21.austin.ibm.com>
Date:   Sun Nov 9 12:57:19 2003 -0600

    fix endian bug in lockingX and add retry on EAGAIN

commit 70c40eb93c2c6be8b726b329f3217bd57c32fe03
Merge: c8eefeb... ae40e4b...
Author: Steve French <cifs.adm@hostme.bitkeeper.com>
Date:   Sat Nov 8 04:20:40 2003 -0800

    Merge bk://linux.bkbits.net/linux-2.5
    into hostme.bitkeeper.com:/repos/c/cifs/linux-2.5cifs

commit c8eefebae7639995affd61390cc0f52f17985fef
Merge: 256ac6f... 59ccfc4...
Author: Steve French <cifs.adm@hostme.bitkeeper.com>
Date:   Fri Nov 7 06:54:55 2003 -0800

    Merge bk://linux.bkbits.net/linux-2.5
    into hostme.bitkeeper.com:/repos/c/cifs/linux-2.5cifs

commit 256ac6fa2093ad8f77841ac5d01a08f6d619288c
Merge: 8cf7497... d659419...
Author: Steve French <cifs.adm@hostme.bitkeeper.com>
Date:   Thu Nov 6 17:55:46 2003 -0800

    Merge bk://linux.bkbits.net/linux-2.5
    into hostme.bitkeeper.com:/repos/c/cifs/linux-2.5cifs

commit 8cf7497f5a2c3ae32c58b064da2f61d3c2ed70ff
Merge: 9948c6d... 8274adf...
Author: Steve French <cifs.adm@hostme.bitkeeper.com>
Date:   Wed Nov 5 17:05:11 2003 -0800

    Merge bk://linux.bkbits.net/linux-2.5
    into hostme.bitkeeper.com:/repos/c/cifs/linux-2.5cifs

commit 9948c6d35e6b4089f6568062a960a50826bd17d0
Merge: dbd4e27... 434f812...
Author: Steve French <cifs.adm@hostme.bitkeeper.com>
Date:   Tue Nov 4 17:41:54 2003 -0800

    Merge bk://linux.bkbits.net/linux-2.5
    into hostme.bitkeeper.com:/repos/c/cifs/linux-2.5cifs

commit dbd4e27fd9d8e13aa76fe9971e1cf5cffae839a9
Merge: f87c615... 4154ceb...
Author: Steve French <cifs.adm@hostme.bitkeeper.com>
Date:   Tue Nov 4 03:17:15 2003 -0800

    Merge bk://linux.bkbits.net/linux-2.5
    into hostme.bitkeeper.com:/repos/c/cifs/linux-2.5cifs

commit f87c615d12748f55369cd00bf41b968758f02ddc
Author: Steve French <stevef@stevef95.austin.ibm.com>
Date:   Tue Nov 4 05:46:07 2003 -0600

    move bad smb session retry to correct location, up one level in cifs vfs code

commit a72b6776e7b7f9452b4021371b3ed3e0dd2ca943
Author: Steve French <stevef@smfhome.smfdom>
Date:   Mon Nov 3 11:17:47 2003 -0600

    Do not return buffer if request has already timed out.

commit 42dbb05a08136887a09ab2e893db68b5f168e52b
Merge: a6f63f7... b84d18a...
Author: Steve French <stevef@stevef95.austin.ibm.com>
Date:   Mon Nov 3 06:36:00 2003 -0600

    Merge bk://cifs.bkbits.net/linux-2.5cifs
    into stevef95.austin.ibm.com:/home/stevef/bk/linux-2.5cifs

commit b84d18a6bda07a68739869a758b56332e3065453
Author: Steve French <stevef@stevef95.austin.ibm.com>
Date:   Mon Nov 3 06:30:25 2003 -0600

    fix to not retime out the same session twice since it can invalidate the newly reestablished session unnecessarily

commit a6f63f7a1e78dd96d476d6b65bb5d4d8cd393cf1
Author: Steve French <stevef@linux.local>
Date:   Sun Nov 2 11:44:48 2003 -0600

    Fix EIO caused by network timeouts on changing file size.
    To avoid spurious oplock breaks from server, in the case
    of inodes that we already have open, avoid doing path
    based setting of file size if we can do it by handle.
    This keeps our caching token (oplock) and avoids
    timeouts when the local oplock break takes longer to flush
    writebehind data than the SMB timeout for the SetPathInfo
    request would allow

commit 9baf76e94583b53fc7046812c228084ebffa882f
Author: Steve French <stevef@linux.local>
Date:   Sun Nov 2 02:58:15 2003 -0600

    fix oops in send_sig on unmount of cifs vfs due to sending signal to demultiplex thread after it has exited.
    Do not treat invalid handle warning in response to oplock break (of file that is now closed) as an error.

commit 3ea7f24554b7a9e1ca375e77953ae6e4fbcfa25b
Merge: c85c39e... 3f5ae09...
Author: Steve French <cifs.adm@hostme.bitkeeper.com>
Date:   Sat Nov 1 02:11:44 2003 -0800

    Merge bk://linux.bkbits.net/linux-2.5
    into hostme.bitkeeper.com:/repos/c/cifs/linux-2.5cifs

commit c85c39e7c2f1310b31b6824bc21d8da5b755037f
Author: Steve French <stevef@stevef95.austin.ibm.com>
Date:   Thu Oct 30 04:39:04 2003 -0600

    Fix invalid dentry when race in mkdir between two clients

commit 84205632d3ead5768642d56ca5180c9051230212
Merge: 047ef2f... a8f9759...
Author: Steve French <cifs.adm@hostme.bitkeeper.com>
Date:   Wed Oct 29 02:05:32 2003 -0800

    Merge bk://linux.bkbits.net/linux-2.5
    into hostme.bitkeeper.com:/repos/c/cifs/linux-2.5cifs

commit 047ef2f3a328de3960950254fe0c622a026aa9ee
Merge: dd28673... dd866d4...
Author: Steve French <stevef@linux.local>
Date:   Tue Oct 28 05:49:10 2003 -0600

    Merge bk://cifs.bkbits.net/linux-2.5cifs
    into linux.local:/home/stevef/linux-2.5cifs

commit dd286735717132dbfd2240debfccc5a8b2e4cf9a
Author: Steve French <stevef@linux.local>
Date:   Tue Oct 28 05:44:29 2003 -0600

    Fix problem reconnecting additional mounts to the same server after
    session failure.

commit dd866d4a3426311dff55e6417a06419a07bf0974
Merge: 4fc0798... 19fb7a0...
Author: Steve French <cifs.adm@hostme.bitkeeper.com>
Date:   Tue Oct 28 01:20:29 2003 -0800

    Merge bk://linux.bkbits.net/linux-2.5
    into hostme.bitkeeper.com:/repos/c/cifs/linux-2.5cifs

commit 4fc07981088b4ef7532c5b24e4fa19d904c1efcb
Author: Steve French <stevef@linux.local>
Date:   Mon Oct 27 04:50:37 2003 -0600

    Can not mount from cifs vfs client built with gcc 3.3.1 due to compiler optimization of unsafe global variable. Remove unsafe global variable.
